OBJECT Table 27 Item
{
  OBJECT-PROPERTIES
  {
    Date=19.10.16;
    Time=12:00:00;
    Modified=Yes;
    Version List=NAVW110.00;
  }
  PROPERTIES
  {
    Permissions=;
    DataCaptionFields=No.,Description;
    OnInsert=VAR
               DocumentNoVisibility@1000 : Codeunit 1400;
             BEGIN
               IF "No." = '' THEN
                 IF DocumentNoVisibility.ItemNoSeriesIsDefault THEN BEGIN
                   GetInvtSetup;
                   NoSeriesMgt.InitSeries(InvtSetup."Item Nos.",xRec."No. Series",0D,"No.","No. Series");
                 END;

               DimMgt.UpdateDefaultDim(
                 DATABASE::Item,"No.",
                 "Global Dimension 1 Code","Global Dimension 2 Code");

               SetLastDateTimeModified;
             END;

    OnModify=BEGIN
               SetLastDateTimeModified;
               PlanningAssignment.ItemChange(Rec,xRec);
             END;

    OnDelete=BEGIN
               ApprovalsMgmt.OnCancelItemApprovalRequest(Rec);

               CheckJournalsAndWorksheets(0);
               CheckDocuments(0);

               MoveEntries.MoveItemEntries(Rec);

               ServiceItem.RESET;
               ServiceItem.SETRANGE("Item No.","No.");
               IF ServiceItem.FIND('-') THEN
                 REPEAT
                   ServiceItem.VALIDATE("Item No.",'');
                   ServiceItem.MODIFY(TRUE);
                 UNTIL ServiceItem.NEXT = 0;

               DeleteRelatedData;
             END;

    OnRename=BEGIN
               ApprovalsMgmt.RenameApprovalEntries(xRec.RECORDID,RECORDID);
               SetLastDateTimeModified;
             END;

    CaptionML=[ENU=Item;
               NOR=Vare];
    LookupPageID=Page31;
    DrillDownPageID=Page31;
  }
  FIELDS
  {
    { 1   ;   ;No.                 ;Code20        ;OnValidate=BEGIN
                                                                IF "No." <> xRec."No." THEN BEGIN
                                                                  GetInvtSetup;
                                                                  NoSeriesMgt.TestManual(InvtSetup."Item Nos.");
                                                                  "No. Series" := '';
                                                                END;
                                                              END;

                                                   AltSearchField=Search Description;
                                                   CaptionML=[ENU=No.;
                                                              NOR=Nr.] }
    { 2   ;   ;No. 2               ;Code20        ;CaptionML=[ENU=No. 2;
                                                              NOR=Nr. 2] }
    { 3   ;   ;Description         ;Text50        ;OnValidate=BEGIN
                                                                IF ("Search Description" = UPPERCASE(xRec.Description)) OR ("Search Description" = '') THEN
                                                                  "Search Description" := Description;

                                                                IF "Created From Nonstock Item" THEN BEGIN
                                                                  NonstockItem.SETCURRENTKEY("Item No.");
                                                                  NonstockItem.SETRANGE("Item No.","No.");
                                                                  IF NonstockItem.FINDFIRST THEN
                                                                    IF NonstockItem.Description = '' THEN BEGIN
                                                                      NonstockItem.Description := Description;
                                                                      NonstockItem.MODIFY;
                                                                    END;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Description;
                                                              NOR=Beskrivelse] }
    { 4   ;   ;Search Description  ;Code50        ;CaptionML=[ENU=Search Description;
                                                              NOR=S›kebeskrivelse] }
    { 5   ;   ;Description 2       ;Text50        ;CaptionML=[ENU=Description 2;
                                                              NOR=Beskrivelse 2] }
    { 6   ;   ;Assembly BOM        ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("BOM Component" WHERE (Parent Item No.=FIELD(No.)));
                                                   CaptionML=[ENU=Assembly BOM;
                                                              NOR=Monteringsstykkliste];
                                                   Editable=No }
    { 8   ;   ;Base Unit of Measure;Code10        ;TableRelation="Unit of Measure";
                                                   OnValidate=VAR
                                                                UnitOfMeasure@1000 : Record 204;
                                                              BEGIN
                                                                IF "Base Unit of Measure" <> xRec."Base Unit of Measure" THEN BEGIN
                                                                  TestNoOpenEntriesExist(FIELDCAPTION("Base Unit of Measure"));

                                                                  "Sales Unit of Measure" := "Base Unit of Measure";
                                                                  "Purch. Unit of Measure" := "Base Unit of Measure";
                                                                  IF "Base Unit of Measure" <> '' THEN BEGIN
                                                                    UnitOfMeasure.GET("Base Unit of Measure");

                                                                    IF NOT ItemUnitOfMeasure.GET("No.","Base Unit of Measure") THEN BEGIN
                                                                      ItemUnitOfMeasure.INIT;
                                                                      ItemUnitOfMeasure.VALIDATE("Item No.","No.");
                                                                      ItemUnitOfMeasure.VALIDATE(Code,"Base Unit of Measure");
                                                                      ItemUnitOfMeasure."Qty. per Unit of Measure" := 1;
                                                                      ItemUnitOfMeasure.INSERT;
                                                                    END ELSE BEGIN
                                                                      IF ItemUnitOfMeasure."Qty. per Unit of Measure" <> 1 THEN
                                                                        ERROR(STRSUBSTNO(BaseUnitOfMeasureQtyMustBeOneErr,"Base Unit of Measure",ItemUnitOfMeasure."Qty. per Unit of Measure"));
                                                                    END;
                                                                  END;
                                                                END;
                                                              END;

                                                   ValidateTableRelation=No;
                                                   CaptionML=[ENU=Base Unit of Measure;
                                                              NOR=Lagerenhet] }
    { 9   ;   ;Price Unit Conversion;Integer      ;CaptionML=[ENU=Price Unit Conversion;
                                                              NOR=Prisfaktor] }
    { 10  ;   ;Type                ;Option        ;OnValidate=VAR
                                                                ItemLedgEntry@1000 : Record 32;
                                                              BEGIN
                                                                ItemLedgEntry.RESET;
                                                                ItemLedgEntry.SETCURRENTKEY("Item No.");
                                                                ItemLedgEntry.SETRANGE("Item No.","No.");
                                                                IF NOT ItemLedgEntry.ISEMPTY THEN
                                                                  ERROR(CannotChangeFieldErr,FIELDCAPTION(Type),TABLECAPTION,"No.",ItemLedgEntry.TABLECAPTION);

                                                                CheckJournalsAndWorksheets(FIELDNO(Type));
                                                                CheckDocuments(FIELDNO(Type));
                                                                IF Type = Type::Service THEN BEGIN
                                                                  CALCFIELDS("Assembly BOM");
                                                                  TESTFIELD("Assembly BOM",FALSE);

                                                                  CALCFIELDS("Stockkeeping Unit Exists");
                                                                  TESTFIELD("Stockkeeping Unit Exists",FALSE);

                                                                  VALIDATE("Assembly Policy","Assembly Policy"::"Assemble-to-Stock");
                                                                  VALIDATE("Replenishment System","Replenishment System"::Purchase);
                                                                  VALIDATE(Reserve,Reserve::Never);
                                                                  VALIDATE("Inventory Posting Group",'');
                                                                  VALIDATE("Item Tracking Code",'');
                                                                  VALIDATE("Costing Method","Costing Method"::FIFO);
                                                                  VALIDATE("Production BOM No.",'');
                                                                  VALIDATE("Routing No.",'');
                                                                  VALIDATE("Reordering Policy","Reordering Policy"::" ");
                                                                  VALIDATE("Order Tracking Policy","Order Tracking Policy"::None);
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Type;
                                                              NOR=Type];
                                                   OptionCaptionML=[ENU=Inventory,Service;
                                                                    NOR=Lager,Service];
                                                   OptionString=Inventory,Service }
    { 11  ;   ;Inventory Posting Group;Code10     ;TableRelation="Inventory Posting Group";
                                                   OnValidate=BEGIN
                                                                IF "Inventory Posting Group" <> '' THEN
                                                                  TESTFIELD(Type,Type::Inventory);
                                                              END;

                                                   CaptionML=[ENU=Inventory Posting Group;
                                                              NOR=Bokf›ringsgruppe - lager] }
    { 12  ;   ;Shelf No.           ;Code10        ;CaptionML=[ENU=Shelf No.;
                                                              NOR=Hyllenr.] }
    { 14  ;   ;Item Disc. Group    ;Code20        ;TableRelation="Item Discount Group";
                                                   CaptionML=[ENU=Item Disc. Group;
                                                              NOR=Varerabattgruppe] }
    { 15  ;   ;Allow Invoice Disc. ;Boolean       ;InitValue=Yes;
                                                   CaptionML=[ENU=Allow Invoice Disc.;
                                                              NOR=Tillat fakturarabatt] }
    { 16  ;   ;Statistics Group    ;Integer       ;CaptionML=[ENU=Statistics Group;
                                                              NOR=Statistikkgruppe] }
    { 17  ;   ;Commission Group    ;Integer       ;CaptionML=[ENU=Commission Group;
                                                              NOR=Provisjonsgruppe] }
    { 18  ;   ;Unit Price          ;Decimal       ;OnValidate=BEGIN
                                                                VALIDATE("Price/Profit Calculation");
                                                              END;

                                                   CaptionML=[ENU=Unit Price;
                                                              NOR=Salgspris];
                                                   MinValue=0;
                                                   AutoFormatType=2 }
    { 19  ;   ;Price/Profit Calculation;Option    ;OnValidate=BEGIN
                                                                CASE "Price/Profit Calculation" OF
                                                                  "Price/Profit Calculation"::"Profit=Price-Cost":
                                                                    IF "Unit Price" <> 0 THEN
                                                                      IF "Unit Cost" = 0 THEN
                                                                        "Profit %" := 0
                                                                      ELSE
                                                                        "Profit %" :=
                                                                          ROUND(
                                                                            100 * (1 - "Unit Cost" /
                                                                                   ("Unit Price" / (1 + CalcVAT))),0.00001)
                                                                    ELSE
                                                                      "Profit %" := 0;
                                                                  "Price/Profit Calculation"::"Price=Cost+Profit":
                                                                    IF "Profit %" < 100 THEN BEGIN
                                                                      GetGLSetup;
                                                                      "Unit Price" :=
                                                                        ROUND(
                                                                          ("Unit Cost" / (1 - "Profit %" / 100)) *
                                                                          (1 + CalcVAT),
                                                                          GLSetup."Unit-Amount Rounding Precision");
                                                                    END;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Price/Profit Calculation;
                                                              NOR=Beregning av fortjeneste-%];
                                                   OptionCaptionML=[ENU="Profit=Price-Cost,Price=Cost+Profit,No Relationship";
                                                                    NOR="Bruttofortjeneste=Salgspris-Kostpris,Salgspris=Kostpris+Bruttofortjeneste,Ingen"];
                                                   OptionString=Profit=Price-Cost,Price=Cost+Profit,No Relationship }
    { 20  ;   ;Profit %            ;Decimal       ;OnValidate=BEGIN
                                                                VALIDATE("Price/Profit Calculation");
                                                              END;

                                                   CaptionML=[ENU=Profit %;
                                                              NOR=Bruttofortjeneste-%];
                                                   DecimalPlaces=0:5 }
    { 21  ;   ;Costing Method      ;Option        ;OnValidate=BEGIN
                                                                IF "Costing Method" = xRec."Costing Method" THEN
                                                                  EXIT;

                                                                IF "Costing Method" <> "Costing Method"::FIFO THEN
                                                                  TESTFIELD(Type,Type::Inventory);

                                                                IF "Costing Method" = "Costing Method"::Specific THEN BEGIN
                                                                  TESTFIELD("Item Tracking Code");

                                                                  ItemTrackingCode.GET("Item Tracking Code");
                                                                  IF NOT ItemTrackingCode."SN Specific Tracking" THEN
                                                                    ERROR(
                                                                      Text018,
                                                                      ItemTrackingCode.FIELDCAPTION("SN Specific Tracking"),
                                                                      FORMAT(TRUE),ItemTrackingCode.TABLECAPTION,ItemTrackingCode.Code,
                                                                      FIELDCAPTION("Costing Method"),"Costing Method");
                                                                END;

                                                                TestNoEntriesExist(FIELDCAPTION("Costing Method"));

                                                                ItemCostMgt.UpdateUnitCost(Rec,'','',0,0,FALSE,FALSE,TRUE,FIELDNO("Costing Method"));
                                                              END;

                                                   CaptionML=[ENU=Costing Method;
                                                              NOR=Lagermetode];
                                                   OptionCaptionML=[ENU=FIFO,LIFO,Specific,Average,Standard;
                                                                    NOR=FIFO,LIFO,Serienummer,Gjennomsnitt,Standard];
                                                   OptionString=FIFO,LIFO,Specific,Average,Standard }
    { 22  ;   ;Unit Cost           ;Decimal       ;OnValidate=BEGIN
                                                                IF "Costing Method" = "Costing Method"::Standard THEN
                                                                  VALIDATE("Standard Cost","Unit Cost")
                                                                ELSE
                                                                  TestNoEntriesExist(FIELDCAPTION("Unit Cost"));
                                                                VALIDATE("Price/Profit Calculation");
                                                              END;

                                                   CaptionML=[ENU=Unit Cost;
                                                              NOR=Enhetskost];
                                                   MinValue=0;
                                                   AutoFormatType=2 }
    { 24  ;   ;Standard Cost       ;Decimal       ;OnValidate=BEGIN
                                                                IF ("Costing Method" = "Costing Method"::Standard) AND (CurrFieldNo <> 0) THEN
                                                                  IF NOT GUIALLOWED THEN BEGIN
                                                                    "Standard Cost" := xRec."Standard Cost";
                                                                    EXIT;
                                                                  END ELSE
                                                                    IF NOT
                                                                       CONFIRM(
                                                                         Text020 +
                                                                         Text021 +
                                                                         Text022,FALSE,
                                                                         FIELDCAPTION("Standard Cost"))
                                                                    THEN BEGIN
                                                                      "Standard Cost" := xRec."Standard Cost";
                                                                      EXIT;
                                                                    END;

                                                                ItemCostMgt.UpdateUnitCost(Rec,'','',0,0,FALSE,FALSE,TRUE,FIELDNO("Standard Cost"));
                                                              END;

                                                   CaptionML=[ENU=Standard Cost;
                                                              NOR=Kostpris (standard)];
                                                   MinValue=0;
                                                   AutoFormatType=2 }
    { 25  ;   ;Last Direct Cost    ;Decimal       ;CaptionML=[ENU=Last Direct Cost;
                                                              NOR=Siste kj›pspris/prod.kost];
                                                   MinValue=0;
                                                   AutoFormatType=2 }
    { 28  ;   ;Indirect Cost %     ;Decimal       ;OnValidate=BEGIN
                                                                ItemCostMgt.UpdateUnitCost(Rec,'','',0,0,FALSE,FALSE,TRUE,FIELDNO("Indirect Cost %"));
                                                              END;

                                                   CaptionML=[ENU=Indirect Cost %;
                                                              NOR=Indirekte kost-%];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
    { 29  ;   ;Cost is Adjusted    ;Boolean       ;InitValue=Yes;
                                                   CaptionML=[ENU=Cost is Adjusted;
                                                              NOR=Kost er justert];
                                                   Editable=No }
    { 30  ;   ;Allow Online Adjustment;Boolean    ;InitValue=Yes;
                                                   CaptionML=[ENU=Allow Online Adjustment;
                                                              NOR=Tillat webjustering];
                                                   Editable=No }
    { 31  ;   ;Vendor No.          ;Code20        ;TableRelation=Vendor;
                                                   OnValidate=BEGIN
                                                                IF (xRec."Vendor No." <> "Vendor No.") AND
                                                                   ("Vendor No." <> '')
                                                                THEN
                                                                  IF Vend.GET("Vendor No.") THEN
                                                                    "Lead Time Calculation" := Vend."Lead Time Calculation";
                                                              END;

                                                   ValidateTableRelation=Yes;
                                                   TestTableRelation=Yes;
                                                   CaptionML=[ENU=Vendor No.;
                                                              NOR=Leverand›rnr.] }
    { 32  ;   ;Vendor Item No.     ;Text20        ;CaptionML=[ENU=Vendor Item No.;
                                                              NOR=Leverand›rs varenr.] }
    { 33  ;   ;Lead Time Calculation;DateFormula  ;AccessByPermission=TableData 120=R;
                                                   CaptionML=[ENU=Lead Time Calculation;
                                                              NOR=Beregning av leveringstid] }
    { 34  ;   ;Reorder Point       ;Decimal       ;AccessByPermission=TableData 244=R;
                                                   CaptionML=[ENU=Reorder Point;
                                                              NOR=Gjenbestillingspunkt];
                                                   DecimalPlaces=0:5 }
    { 35  ;   ;Maximum Inventory   ;Decimal       ;AccessByPermission=TableData 244=R;
                                                   CaptionML=[ENU=Maximum Inventory;
                                                              NOR=Maks. beholdning];
                                                   DecimalPlaces=0:5 }
    { 36  ;   ;Reorder Quantity    ;Decimal       ;AccessByPermission=TableData 244=R;
                                                   CaptionML=[ENU=Reorder Quantity;
                                                              NOR=Gjenbestillingsantall];
                                                   DecimalPlaces=0:5 }
    { 37  ;   ;Alternative Item No.;Code20        ;TableRelation=Item;
                                                   CaptionML=[ENU=Alternative Item No.;
                                                              NOR=Alternativt varenr.] }
    { 38  ;   ;Unit List Price     ;Decimal       ;CaptionML=[ENU=Unit List Price;
                                                              NOR=Veiledende pris];
                                                   MinValue=0;
                                                   AutoFormatType=2 }
    { 39  ;   ;Duty Due %          ;Decimal       ;CaptionML=[ENU=Duty Due %;
                                                              NOR=Avgifts-%];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0;
                                                   MaxValue=100 }
    { 40  ;   ;Duty Code           ;Code10        ;CaptionML=[ENU=Duty Code;
                                                              NOR=Avgiftskode] }
    { 41  ;   ;Gross Weight        ;Decimal       ;CaptionML=[ENU=Gross Weight;
                                                              NOR=Bruttovekt];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
    { 42  ;   ;Net Weight          ;Decimal       ;CaptionML=[ENU=Net Weight;
                                                              NOR=Nettovekt];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
    { 43  ;   ;Units per Parcel    ;Decimal       ;CaptionML=[ENU=Units per Parcel;
                                                              NOR=Antall per kolli];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
    { 44  ;   ;Unit Volume         ;Decimal       ;CaptionML=[ENU=Unit Volume;
                                                              NOR=Volum];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
    { 45  ;   ;Durability          ;Code10        ;CaptionML=[ENU=Durability;
                                                              NOR=Holdbarhet] }
    { 46  ;   ;Freight Type        ;Code10        ;CaptionML=[ENU=Freight Type;
                                                              NOR=Fraktype] }
    { 47  ;   ;Tariff No.          ;Code20        ;TableRelation="Tariff Number";
                                                   CaptionML=[ENU=Tariff No.;
                                                              NOR=Tariffnr.] }
    { 48  ;   ;Duty Unit Conversion;Decimal       ;CaptionML=[ENU=Duty Unit Conversion;
                                                              NOR=Tollfaktor];
                                                   DecimalPlaces=0:5 }
    { 49  ;   ;Country/Region Purchased Code;Code10;
                                                   TableRelation=Country/Region;
                                                   CaptionML=[ENU=Country/Region Purchased Code;
                                                              NOR=Kj›psland/-region - kode] }
    { 50  ;   ;Budget Quantity     ;Decimal       ;CaptionML=[ENU=Budget Quantity;
                                                              NOR=Budsjett (antall)];
                                                   DecimalPlaces=0:5 }
    { 51  ;   ;Budgeted Amount     ;Decimal       ;CaptionML=[ENU=Budgeted Amount;
                                                              NOR=Budsjettert bel›p];
                                                   AutoFormatType=1 }
    { 52  ;   ;Budget Profit       ;Decimal       ;CaptionML=[ENU=Budget Profit;
                                                              NOR=Budsjettbruttofortjeneste];
                                                   AutoFormatType=1 }
    { 53  ;   ;Comment             ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Comment Line" WHERE (Table Name=CONST(Item),
                                                                                           No.=FIELD(No.)));
                                                   CaptionML=[ENU=Comment;
                                                              NOR=Merknad];
                                                   Editable=No }
    { 54  ;   ;Blocked             ;Boolean       ;CaptionML=[ENU=Blocked;
                                                              NOR=Sperret] }
    { 55  ;   ;Cost is Posted to G/L;Boolean      ;FieldClass=FlowField;
                                                   CalcFormula=-Exist("Post Value Entry to G/L" WHERE (Item No.=FIELD(No.)));
                                                   CaptionML=[ENU=Cost is Posted to G/L;
                                                              NOR=Kost er bokf›rt i Finans];
                                                   Editable=No }
    { 62  ;   ;Last Date Modified  ;Date          ;CaptionML=[ENU=Last Date Modified;
                                                              NOR=Endret den];
                                                   Editable=No }
    { 63  ;   ;Last Time Modified  ;Time          ;CaptionML=[ENU=Last Time Modified;
                                                              NOR=Last Time Modified];
                                                   Editable=No }
    { 64  ;   ;Date Filter         ;Date          ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Date Filter;
                                                              NOR=Datofilter] }
    { 65  ;   ;Global Dimension 1 Filter;Code20   ;FieldClass=FlowFilter;
                                                   TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(1));
                                                   CaptionML=[ENU=Global Dimension 1 Filter;
                                                              NOR=Filter for global dimensjon 1];
                                                   CaptionClass='1,3,1' }
    { 66  ;   ;Global Dimension 2 Filter;Code20   ;FieldClass=FlowFilter;
                                                   TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(2));
                                                   CaptionML=[ENU=Global Dimension 2 Filter;
                                                              NOR=Filter for global dimensjon 2];
                                                   CaptionClass='1,3,2' }
    { 67  ;   ;Location Filter     ;Code10        ;FieldClass=FlowFilter;
                                                   TableRelation=Location;
                                                   CaptionML=[ENU=Location Filter;
                                                              NOR=Lokasjonsfilter] }
    { 68  ;   ;Inventory           ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Item Ledger Entry".Quantity WHERE (Item No.=FIELD(No.),
                                                                                                       Global Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                       Global Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                       Location Code=FIELD(Location Filter),
                                                                                                       Drop Shipment=FIELD(Drop Shipment Filter),
                                                                                                       Variant Code=FIELD(Variant Filter),
                                                                                                       Lot No.=FIELD(Lot No. Filter),
                                                                                                       Serial No.=FIELD(Serial No. Filter)));
                                                   CaptionML=[ENU=Inventory;
                                                              NOR=Beholdning];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 69  ;   ;Net Invoiced Qty.   ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Item Ledger Entry"."Invoiced Quantity" WHERE (Item No.=FIELD(No.),
                                                                                                                  Global Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                                  Global Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                                  Location Code=FIELD(Location Filter),
                                                                                                                  Drop Shipment=FIELD(Drop Shipment Filter),
                                                                                                                  Variant Code=FIELD(Variant Filter),
                                                                                                                  Lot No.=FIELD(Lot No. Filter),
                                                                                                                  Serial No.=FIELD(Serial No. Filter)));
                                                   CaptionML=[ENU=Net Invoiced Qty.;
                                                              NOR=Fakturert beholdn.];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 70  ;   ;Net Change          ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Item Ledger Entry".Quantity WHERE (Item No.=FIELD(No.),
                                                                                                       Global Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                       Global Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                       Location Code=FIELD(Location Filter),
                                                                                                       Drop Shipment=FIELD(Drop Shipment Filter),
                                                                                                       Posting Date=FIELD(Date Filter),
                                                                                                       Variant Code=FIELD(Variant Filter),
                                                                                                       Lot No.=FIELD(Lot No. Filter),
                                                                                                       Serial No.=FIELD(Serial No. Filter)));
                                                   CaptionML=[ENU=Net Change;
                                                              NOR=Bevegelse];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 71  ;   ;Purchases (Qty.)    ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Item Ledger Entry"."Invoiced Quantity" WHERE (Entry Type=CONST(Purchase),
                                                                                                                  Item No.=FIELD(No.),
                                                                                                                  Global Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                                  Global Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                                  Location Code=FIELD(Location Filter),
                                                                                                                  Drop Shipment=FIELD(Drop Shipment Filter),
                                                                                                                  Variant Code=FIELD(Variant Filter),
                                                                                                                  Posting Date=FIELD(Date Filter),
                                                                                                                  Lot No.=FIELD(Lot No. Filter),
                                                                                                                  Serial No.=FIELD(Serial No. Filter)));
                                                   CaptionML=[ENU=Purchases (Qty.);
                                                              NOR=Kj›p (antall)];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 72  ;   ;Sales (Qty.)        ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Value Entry"."Invoiced Quantity" WHERE (Item Ledger Entry Type=CONST(Sale),
                                                                                                             Item No.=FIELD(No.),
                                                                                                             Global Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                             Global Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                             Location Code=FIELD(Location Filter),
                                                                                                             Drop Shipment=FIELD(Drop Shipment Filter),
                                                                                                             Variant Code=FIELD(Variant Filter),
                                                                                                             Posting Date=FIELD(Date Filter)));
                                                   CaptionML=[ENU=Sales (Qty.);
                                                              NOR=Salg (antall)];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 73  ;   ;Positive Adjmt. (Qty.);Decimal     ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Item Ledger Entry"."Invoiced Quantity" WHERE (Entry Type=CONST(Positive Adjmt.),
                                                                                                                  Item No.=FIELD(No.),
                                                                                                                  Global Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                                  Global Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                                  Location Code=FIELD(Location Filter),
                                                                                                                  Drop Shipment=FIELD(Drop Shipment Filter),
                                                                                                                  Variant Code=FIELD(Variant Filter),
                                                                                                                  Posting Date=FIELD(Date Filter),
                                                                                                                  Lot No.=FIELD(Lot No. Filter),
                                                                                                                  Serial No.=FIELD(Serial No. Filter)));
                                                   CaptionML=[ENU=Positive Adjmt. (Qty.);
                                                              NOR=Oppjustering (antall)];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 74  ;   ;Negative Adjmt. (Qty.);Decimal     ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Item Ledger Entry"."Invoiced Quantity" WHERE (Entry Type=CONST(Negative Adjmt.),
                                                                                                                   Item No.=FIELD(No.),
                                                                                                                   Global Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                                   Global Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                                   Location Code=FIELD(Location Filter),
                                                                                                                   Drop Shipment=FIELD(Drop Shipment Filter),
                                                                                                                   Variant Code=FIELD(Variant Filter),
                                                                                                                   Posting Date=FIELD(Date Filter),
                                                                                                                   Lot No.=FIELD(Lot No. Filter),
                                                                                                                   Serial No.=FIELD(Serial No. Filter)));
                                                   CaptionML=[ENU=Negative Adjmt. (Qty.);
                                                              NOR=Nedjustering (antall)];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 77  ;   ;Purchases (LCY)     ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Value Entry"."Purchase Amount (Actual)" WHERE (Item Ledger Entry Type=CONST(Purchase),
                                                                                                                   Item No.=FIELD(No.),
                                                                                                                   Global Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                                   Global Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                                   Location Code=FIELD(Location Filter),
                                                                                                                   Drop Shipment=FIELD(Drop Shipment Filter),
                                                                                                                   Variant Code=FIELD(Variant Filter),
                                                                                                                   Posting Date=FIELD(Date Filter)));
                                                   CaptionML=[ENU=Purchases (LCY);
                                                              NOR=Kj›p (NOK)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 78  ;   ;Sales (LCY)         ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Value Entry"."Sales Amount (Actual)" WHERE (Item Ledger Entry Type=CONST(Sale),
                                                                                                                Item No.=FIELD(No.),
                                                                                                                Global Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                                Global Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                                Location Code=FIELD(Location Filter),
                                                                                                                Drop Shipment=FIELD(Drop Shipment Filter),
                                                                                                                Variant Code=FIELD(Variant Filter),
                                                                                                                Posting Date=FIELD(Date Filter)));
                                                   CaptionML=[ENU=Sales (LCY);
                                                              NOR=Salg (NOK)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 79  ;   ;Positive Adjmt. (LCY);Decimal      ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Value Entry"."Cost Amount (Actual)" WHERE (Item Ledger Entry Type=CONST(Positive Adjmt.),
                                                                                                               Item No.=FIELD(No.),
                                                                                                               Global Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                               Global Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                               Location Code=FIELD(Location Filter),
                                                                                                               Drop Shipment=FIELD(Drop Shipment Filter),
                                                                                                               Variant Code=FIELD(Variant Filter),
                                                                                                               Posting Date=FIELD(Date Filter)));
                                                   CaptionML=[ENU=Positive Adjmt. (LCY);
                                                              NOR=Oppjustering (bel›p)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 80  ;   ;Negative Adjmt. (LCY);Decimal      ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Value Entry"."Cost Amount (Actual)" WHERE (Item Ledger Entry Type=CONST(Negative Adjmt.),
                                                                                                               Item No.=FIELD(No.),
                                                                                                               Global Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                               Global Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                               Location Code=FIELD(Location Filter),
                                                                                                               Drop Shipment=FIELD(Drop Shipment Filter),
                                                                                                               Variant Code=FIELD(Variant Filter),
                                                                                                               Posting Date=FIELD(Date Filter)));
                                                   CaptionML=[ENU=Negative Adjmt. (LCY);
                                                              NOR=Nedjustering (bel›p)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 83  ;   ;COGS (LCY)          ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Value Entry"."Cost Amount (Actual)" WHERE (Item Ledger Entry Type=CONST(Sale),
                                                                                                                Item No.=FIELD(No.),
                                                                                                                Global Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                                Global Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                                Location Code=FIELD(Location Filter),
                                                                                                                Drop Shipment=FIELD(Drop Shipment Filter),
                                                                                                                Variant Code=FIELD(Variant Filter),
                                                                                                                Posting Date=FIELD(Date Filter)));
                                                   CaptionML=[ENU=COGS (LCY);
                                                              NOR=Vareforbruk (NOK)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 84  ;   ;Qty. on Purch. Order;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Purchase Line"."Outstanding Qty. (Base)" WHERE (Document Type=CONST(Order),
                                                                                                                    Type=CONST(Item),
                                                                                                                    No.=FIELD(No.),
                                                                                                                    Shortcut Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                                    Shortcut Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                                    Location Code=FIELD(Location Filter),
                                                                                                                    Drop Shipment=FIELD(Drop Shipment Filter),
                                                                                                                    Variant Code=FIELD(Variant Filter),
                                                                                                                    Expected Receipt Date=FIELD(Date Filter)));
                                                   AccessByPermission=TableData 120=R;
                                                   CaptionML=[ENU=Qty. on Purch. Order;
                                                              NOR=Antall i bestilling];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 85  ;   ;Qty. on Sales Order ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Sales Line"."Outstanding Qty. (Base)" WHERE (Document Type=CONST(Order),
                                                                                                                 Type=CONST(Item),
                                                                                                                 No.=FIELD(No.),
                                                                                                                 Shortcut Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                                 Shortcut Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                                 Location Code=FIELD(Location Filter),
                                                                                                                 Drop Shipment=FIELD(Drop Shipment Filter),
                                                                                                                 Variant Code=FIELD(Variant Filter),
                                                                                                                 Shipment Date=FIELD(Date Filter)));
                                                   AccessByPermission=TableData 110=R;
                                                   CaptionML=[ENU=Qty. on Sales Order;
                                                              NOR=Antall i ordre];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 87  ;   ;Price Includes VAT  ;Boolean       ;OnValidate=VAR
                                                                VATPostingSetup@1000 : Record 325;
                                                                SalesSetup@1001 : Record 311;
                                                              BEGIN
                                                                IF "Price Includes VAT" THEN BEGIN
                                                                  SalesSetup.GET;
                                                                  IF SalesSetup."VAT Bus. Posting Gr. (Price)" <> '' THEN
                                                                    "VAT Bus. Posting Gr. (Price)" := SalesSetup."VAT Bus. Posting Gr. (Price)";
                                                                  VATPostingSetup.GET("VAT Bus. Posting Gr. (Price)","VAT Prod. Posting Group");
                                                                END;
                                                                VALIDATE("Price/Profit Calculation");
                                                              END;

                                                   CaptionML=[ENU=Price Includes VAT;
                                                              NOR=Pris inkl. mva.] }
    { 89  ;   ;Drop Shipment Filter;Boolean       ;FieldClass=FlowFilter;
                                                   AccessByPermission=TableData 223=R;
                                                   CaptionML=[ENU=Drop Shipment Filter;
                                                              NOR=Filter for direkte levering] }
    { 90  ;   ;VAT Bus. Posting Gr. (Price);Code10;TableRelation="VAT Business Posting Group";
                                                   OnValidate=BEGIN
                                                                VALIDATE("Price/Profit Calculation");
                                                              END;

                                                   CaptionML=[ENU=VAT Bus. Posting Gr. (Price);
                                                              NOR=Mva-bokf.gruppe - firma (pris)] }
    { 91  ;   ;Gen. Prod. Posting Group;Code10    ;TableRelation="Gen. Product Posting Group";
                                                   OnValidate=BEGIN
                                                                IF xRec."Gen. Prod. Posting Group" <> "Gen. Prod. Posting Group" THEN BEGIN
                                                                  IF CurrFieldNo <> 0 THEN
                                                                    IF ProdOrderExist THEN
                                                                      IF NOT CONFIRM(
                                                                           Text024 +
                                                                           Text022,FALSE,
                                                                           FIELDCAPTION("Gen. Prod. Posting Group"))
                                                                      THEN BEGIN
                                                                        "Gen. Prod. Posting Group" := xRec."Gen. Prod. Posting Group";
                                                                        EXIT;
                                                                      END;

                                                                  IF GenProdPostingGrp.ValidateVatProdPostingGroup(GenProdPostingGrp,"Gen. Prod. Posting Group") THEN
                                                                    VALIDATE("VAT Prod. Posting Group",GenProdPostingGrp."Def. VAT Prod. Posting Group");
                                                                END;

                                                                VALIDATE("Price/Profit Calculation");
                                                              END;

                                                   CaptionML=[ENU=Gen. Prod. Posting Group;
                                                              NOR=Bokf›ringsgruppe - vare] }
    { 92  ;   ;Picture             ;MediaSet      ;CaptionML=[ENU=Picture;
                                                              NOR=Bilde] }
    { 93  ;   ;Transferred (Qty.)  ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Item Ledger Entry"."Invoiced Quantity" WHERE (Entry Type=CONST(Transfer),
                                                                                                                  Item No.=FIELD(No.),
                                                                                                                  Global Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                                  Global Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                                  Location Code=FIELD(Location Filter),
                                                                                                                  Drop Shipment=FIELD(Drop Shipment Filter),
                                                                                                                  Variant Code=FIELD(Variant Filter),
                                                                                                                  Posting Date=FIELD(Date Filter),
                                                                                                                  Lot No.=FIELD(Lot No. Filter),
                                                                                                                  Serial No.=FIELD(Serial No. Filter)));
                                                   CaptionML=[ENU=Transferred (Qty.);
                                                              NOR=Overf›rt (ant.)];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 94  ;   ;Transferred (LCY)   ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Value Entry"."Sales Amount (Actual)" WHERE (Item Ledger Entry Type=CONST(Transfer),
                                                                                                                Item No.=FIELD(No.),
                                                                                                                Global Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                                Global Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                                Location Code=FIELD(Location Filter),
                                                                                                                Drop Shipment=FIELD(Drop Shipment Filter),
                                                                                                                Variant Code=FIELD(Variant Filter),
                                                                                                                Posting Date=FIELD(Date Filter)));
                                                   CaptionML=[ENU=Transferred (LCY);
                                                              NOR=Overf›rt (NOK)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 95  ;   ;Country/Region of Origin Code;Code10;
                                                   TableRelation=Country/Region;
                                                   CaptionML=[ENU=Country/Region of Origin Code;
                                                              NOR=Opprinnelsesland/-region - kode] }
    { 96  ;   ;Automatic Ext. Texts;Boolean       ;CaptionML=[ENU=Automatic Ext. Texts;
                                                              NOR=Automatisk utv. tekster] }
    { 97  ;   ;No. Series          ;Code10        ;TableRelation="No. Series";
                                                   CaptionML=[ENU=No. Series;
                                                              NOR=Nr.serie];
                                                   Editable=No }
    { 98  ;   ;Tax Group Code      ;Code10        ;TableRelation="Tax Group";
                                                   CaptionML=[ENU=Tax Group Code;
                                                              NOR=Mva-gruppekode] }
    { 99  ;   ;VAT Prod. Posting Group;Code10     ;TableRelation="VAT Product Posting Group";
                                                   OnValidate=BEGIN
                                                                VALIDATE("Price/Profit Calculation");
                                                              END;

                                                   CaptionML=[ENU=VAT Prod. Posting Group;
                                                              NOR=Mva-bokf›ringsgruppe - vare] }
    { 100 ;   ;Reserve             ;Option        ;InitValue=Optional;
                                                   OnValidate=BEGIN
                                                                IF Reserve <> Reserve::Never THEN
                                                                  TESTFIELD(Type,Type::Inventory);
                                                              END;

                                                   AccessByPermission=TableData 120=R;
                                                   CaptionML=[ENU=Reserve;
                                                              NOR=Reserver];
                                                   OptionCaptionML=[ENU=Never,Optional,Always;
                                                                    NOR=Aldri,Alternativt,Alltid];
                                                   OptionString=Never,Optional,Always }
    { 101 ;   ;Reserved Qty. on Inventory;Decimal ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Reservation Entry"."Quantity (Base)" WHERE (Item No.=FIELD(No.),
                                                                                                                Source Type=CONST(32),
                                                                                                                Source Subtype=CONST(0),
                                                                                                                Reservation Status=CONST(Reservation),
                                                                                                                Serial No.=FIELD(Serial No. Filter),
                                                                                                                Lot No.=FIELD(Lot No. Filter),
                                                                                                                Location Code=FIELD(Location Filter),
                                                                                                                Variant Code=FIELD(Variant Filter)));
                                                   AccessByPermission=TableData 120=R;
                                                   CaptionML=[ENU=Reserved Qty. on Inventory;
                                                              NOR=Reservert antall p† lager];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 102 ;   ;Reserved Qty. on Purch. Orders;Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Reservation Entry"."Quantity (Base)" WHERE (Item No.=FIELD(No.),
                                                                                                                Source Type=CONST(39),
                                                                                                                Source Subtype=CONST(1),
                                                                                                                Reservation Status=CONST(Reservation),
                                                                                                                Location Code=FIELD(Location Filter),
                                                                                                                Variant Code=FIELD(Variant Filter),
                                                                                                                Expected Receipt Date=FIELD(Date Filter)));
                                                   AccessByPermission=TableData 120=R;
                                                   CaptionML=[ENU=Reserved Qty. on Purch. Orders;
                                                              NOR=Reservert antall i bestilling];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 103 ;   ;Reserved Qty. on Sales Orders;Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=-Sum("Reservation Entry"."Quantity (Base)" WHERE (Item No.=FIELD(No.),
                                                                                                                 Source Type=CONST(37),
                                                                                                                 Source Subtype=CONST(1),
                                                                                                                 Reservation Status=CONST(Reservation),
                                                                                                                 Location Code=FIELD(Location Filter),
                                                                                                                 Variant Code=FIELD(Variant Filter),
                                                                                                                 Shipment Date=FIELD(Date Filter)));
                                                   AccessByPermission=TableData 110=R;
                                                   CaptionML=[ENU=Reserved Qty. on Sales Orders;
                                                              NOR=Reservert antall i ordrer];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 105 ;   ;Global Dimension 1 Code;Code20     ;TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(1));
                                                   OnValidate=BEGIN
                                                                ValidateShortcutDimCode(1,"Global Dimension 1 Code");
                                                              END;

                                                   CaptionML=[ENU=Global Dimension 1 Code;
                                                              NOR=Global dimensjon 1 - kode];
                                                   CaptionClass='1,1,1' }
    { 106 ;   ;Global Dimension 2 Code;Code20     ;TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(2));
                                                   OnValidate=BEGIN
                                                                ValidateShortcutDimCode(2,"Global Dimension 2 Code");
                                                              END;

                                                   CaptionML=[ENU=Global Dimension 2 Code;
                                                              NOR=Global dimensjon 2 - kode];
                                                   CaptionClass='1,1,2' }
    { 107 ;   ;Res. Qty. on Outbound Transfer;Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=-Sum("Reservation Entry"."Quantity (Base)" WHERE (Item No.=FIELD(No.),
                                                                                                                 Source Type=CONST(5741),
                                                                                                                 Source Subtype=CONST(0),
                                                                                                                 Reservation Status=CONST(Reservation),
                                                                                                                 Location Code=FIELD(Location Filter),
                                                                                                                 Variant Code=FIELD(Variant Filter),
                                                                                                                 Shipment Date=FIELD(Date Filter)));
                                                   AccessByPermission=TableData 5740=R;
                                                   CaptionML=[ENU=Res. Qty. on Outbound Transfer;
                                                              NOR=Res. ant. p† utg†ende overf›r.];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 108 ;   ;Res. Qty. on Inbound Transfer;Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Reservation Entry"."Quantity (Base)" WHERE (Item No.=FIELD(No.),
                                                                                                                Source Type=CONST(5741),
                                                                                                                Source Subtype=CONST(1),
                                                                                                                Reservation Status=CONST(Reservation),
                                                                                                                Location Code=FIELD(Location Filter),
                                                                                                                Variant Code=FIELD(Variant Filter),
                                                                                                                Expected Receipt Date=FIELD(Date Filter)));
                                                   AccessByPermission=TableData 5740=R;
                                                   CaptionML=[ENU=Res. Qty. on Inbound Transfer;
                                                              NOR=Res. ant. p† inng†. overf›r.];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 109 ;   ;Res. Qty. on Sales Returns;Decimal ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Reservation Entry"."Quantity (Base)" WHERE (Item No.=FIELD(No.),
                                                                                                                Source Type=CONST(37),
                                                                                                                Source Subtype=CONST(5),
                                                                                                                Reservation Status=CONST(Reservation),
                                                                                                                Location Code=FIELD(Location Filter),
                                                                                                                Variant Code=FIELD(Variant Filter),
                                                                                                                Shipment Date=FIELD(Date Filter)));
                                                   AccessByPermission=TableData 6660=R;
                                                   CaptionML=[ENU=Res. Qty. on Sales Returns;
                                                              NOR=Res. ant. i ordrereturer];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 110 ;   ;Res. Qty. on Purch. Returns;Decimal;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Reservation Entry"."Quantity (Base)" WHERE (Item No.=FIELD(No.),
                                                                                                                 Source Type=CONST(39),
                                                                                                                 Source Subtype=CONST(5),
                                                                                                                 Reservation Status=CONST(Reservation),
                                                                                                                 Location Code=FIELD(Location Filter),
                                                                                                                 Variant Code=FIELD(Variant Filter),
                                                                                                                 Expected Receipt Date=FIELD(Date Filter)));
                                                   AccessByPermission=TableData 6650=R;
                                                   CaptionML=[ENU=Res. Qty. on Purch. Returns;
                                                              NOR=Res. ant. i kj›psreturer];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 120 ;   ;Stockout Warning    ;Option        ;CaptionML=[ENU=Stockout Warning;
                                                              NOR=Lagerbeholdningsadvarsel];
                                                   OptionCaptionML=[ENU=Default,No,Yes;
                                                                    NOR=Standard,Nei,Ja];
                                                   OptionString=Default,No,Yes }
    { 121 ;   ;Prevent Negative Inventory;Option  ;CaptionML=[ENU=Prevent Negative Inventory;
                                                              NOR=Forhindre negativ beholdning];
                                                   OptionCaptionML=[ENU=Default,No,Yes;
                                                                    NOR=Standard,Nei,Ja];
                                                   OptionString=Default,No,Yes }
    { 200 ;   ;Cost of Open Production Orders;Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Prod. Order Line"."Cost Amount" WHERE (Status=FILTER(Planned|Firm Planned|Released),
                                                                                                           Item No.=FIELD(No.)));
                                                   CaptionML=[ENU=Cost of Open Production Orders;
                                                              NOR=Kostnad for †pne produksjonsordrer] }
    { 521 ;   ;Application Wksh. User ID;Code128  ;CaptionML=[ENU=Application Wksh. User ID;
                                                              NOR=Bruker-ID for utligningsforslag] }
    { 910 ;   ;Assembly Policy     ;Option        ;OnValidate=BEGIN
                                                                IF "Assembly Policy" = "Assembly Policy"::"Assemble-to-Order" THEN
                                                                  TESTFIELD("Replenishment System","Replenishment System"::Assembly);
                                                                IF Type = Type::Service THEN
                                                                  TESTFIELD("Assembly Policy","Assembly Policy"::"Assemble-to-Stock");
                                                              END;

                                                   AccessByPermission=TableData 90=R;
                                                   CaptionML=[ENU=Assembly Policy;
                                                              NOR=Monteringsprinsipp];
                                                   OptionCaptionML=[ENU=Assemble-to-Stock,Assemble-to-Order;
                                                                    NOR=Monter til lager,Monter til ordre];
                                                   OptionString=Assemble-to-Stock,Assemble-to-Order }
    { 929 ;   ;Res. Qty. on Assembly Order;Decimal;FieldClass=FlowField;
                                                   CalcFormula=Sum("Reservation Entry"."Quantity (Base)" WHERE (Item No.=FIELD(No.),
                                                                                                                Source Type=CONST(900),
                                                                                                                Source Subtype=CONST(1),
                                                                                                                Reservation Status=CONST(Reservation),
                                                                                                                Location Code=FIELD(Location Filter),
                                                                                                                Variant Code=FIELD(Variant Filter),
                                                                                                                Expected Receipt Date=FIELD(Date Filter)));
                                                   AccessByPermission=TableData 90=R;
                                                   CaptionML=[ENU=Res. Qty. on Assembly Order;
                                                              NOR=Res. ant. p† monteringsordre];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 930 ;   ;Res. Qty. on  Asm. Comp.;Decimal   ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Reservation Entry"."Quantity (Base)" WHERE (Item No.=FIELD(No.),
                                                                                                                 Source Type=CONST(901),
                                                                                                                 Source Subtype=CONST(1),
                                                                                                                 Reservation Status=CONST(Reservation),
                                                                                                                 Location Code=FIELD(Location Filter),
                                                                                                                 Variant Code=FIELD(Variant Filter),
                                                                                                                 Shipment Date=FIELD(Date Filter)));
                                                   AccessByPermission=TableData 90=R;
                                                   CaptionML=[ENU=Res. Qty. on  Asm. Comp.;
                                                              NOR=Res. ant. p† mont.komp.];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 977 ;   ;Qty. on Assembly Order;Decimal     ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Assembly Header"."Remaining Quantity (Base)" WHERE (Document Type=CONST(Order),
                                                                                                                        Item No.=FIELD(No.),
                                                                                                                        Shortcut Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                                        Shortcut Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                                        Location Code=FIELD(Location Filter),
                                                                                                                        Variant Code=FIELD(Variant Filter),
                                                                                                                        Due Date=FIELD(Date Filter)));
                                                   CaptionML=[ENU=Qty. on Assembly Order;
                                                              NOR=Ant. p† monteringsordre];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 978 ;   ;Qty. on Asm. Component;Decimal     ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Assembly Line"."Remaining Quantity (Base)" WHERE (Document Type=CONST(Order),
                                                                                                                      Type=CONST(Item),
                                                                                                                      No.=FIELD(No.),
                                                                                                                      Shortcut Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                                      Shortcut Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                                      Location Code=FIELD(Location Filter),
                                                                                                                      Variant Code=FIELD(Variant Filter),
                                                                                                                      Due Date=FIELD(Date Filter)));
                                                   CaptionML=[ENU=Qty. on Asm. Component;
                                                              NOR=Ant. p† monteringskomponent];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 1001;   ;Qty. on Job Order   ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Job Planning Line"."Remaining Qty. (Base)" WHERE (Status=CONST(Order),
                                                                                                                      Type=CONST(Item),
                                                                                                                      No.=FIELD(No.),
                                                                                                                      Location Code=FIELD(Location Filter),
                                                                                                                      Variant Code=FIELD(Variant Filter),
                                                                                                                      Planning Date=FIELD(Date Filter)));
                                                   CaptionML=[ENU=Qty. on Job Order;
                                                              NOR=Ant. p† jobbordre];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 1002;   ;Res. Qty. on Job Order;Decimal     ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Reservation Entry"."Quantity (Base)" WHERE (Item No.=FIELD(No.),
                                                                                                                 Source Type=CONST(1003),
                                                                                                                 Source Subtype=CONST(2),
                                                                                                                 Reservation Status=CONST(Reservation),
                                                                                                                 Location Code=FIELD(Location Filter),
                                                                                                                 Variant Code=FIELD(Variant Filter),
                                                                                                                 Shipment Date=FIELD(Date Filter)));
                                                   AccessByPermission=TableData 167=R;
                                                   CaptionML=[ENU=Res. Qty. on Job Order;
                                                              NOR=Res. ant. p† jobbordre];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 1217;   ;GTIN                ;Code14        ;CaptionML=[ENU=GTIN;
                                                              NOR=GTIN];
                                                   Numeric=Yes }
    { 1700;   ;Default Deferral Template Code;Code10;
                                                   TableRelation="Deferral Template"."Deferral Code";
                                                   CaptionML=[ENU=Default Deferral Template Code;
                                                              NOR=Standard kode for periodiseringsmal] }
    { 5400;   ;Low-Level Code      ;Integer       ;CaptionML=[ENU=Low-Level Code;
                                                              NOR=Lavniv†kode];
                                                   Editable=No }
    { 5401;   ;Lot Size            ;Decimal       ;AccessByPermission=TableData 5405=R;
                                                   CaptionML=[ENU=Lot Size;
                                                              NOR=Partist›rrelse];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
    { 5402;   ;Serial Nos.         ;Code10        ;TableRelation="No. Series";
                                                   OnValidate=BEGIN
                                                                IF "Serial Nos." <> '' THEN
                                                                  TESTFIELD("Item Tracking Code");
                                                              END;

                                                   CaptionML=[ENU=Serial Nos.;
                                                              NOR=Serienr.] }
    { 5403;   ;Last Unit Cost Calc. Date;Date     ;CaptionML=[ENU=Last Unit Cost Calc. Date;
                                                              NOR=Dato for siste enhetskostberegning];
                                                   Editable=No }
    { 5404;   ;Rolled-up Material Cost;Decimal    ;CaptionML=[ENU=Rolled-up Material Cost;
                                                              NOR=Opprullert materialkost];
                                                   DecimalPlaces=2:5;
                                                   Editable=No;
                                                   AutoFormatType=2 }
    { 5405;   ;Rolled-up Capacity Cost;Decimal    ;CaptionML=[ENU=Rolled-up Capacity Cost;
                                                              NOR=Opprullert kapasitetskost];
                                                   DecimalPlaces=2:5;
                                                   Editable=No;
                                                   AutoFormatType=2 }
    { 5407;   ;Scrap %             ;Decimal       ;AccessByPermission=TableData 5405=R;
                                                   CaptionML=[ENU=Scrap %;
                                                              NOR=Vrak-%];
                                                   DecimalPlaces=0:2;
                                                   MinValue=0;
                                                   MaxValue=100 }
    { 5409;   ;Inventory Value Zero;Boolean       ;OnValidate=BEGIN
                                                                CheckForProductionOutput("No.");
                                                              END;

                                                   CaptionML=[ENU=Inventory Value Zero;
                                                              NOR=Lagerverdi er null] }
    { 5410;   ;Discrete Order Quantity;Integer    ;CaptionML=[ENU=Discrete Order Quantity;
                                                              NOR=Separat ordreantall];
                                                   MinValue=0 }
    { 5411;   ;Minimum Order Quantity;Decimal     ;AccessByPermission=TableData 244=R;
                                                   CaptionML=[ENU=Minimum Order Quantity;
                                                              NOR=Min. bestillingsantall];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
    { 5412;   ;Maximum Order Quantity;Decimal     ;AccessByPermission=TableData 244=R;
                                                   CaptionML=[ENU=Maximum Order Quantity;
                                                              NOR=Maks. bestillingsantall];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
    { 5413;   ;Safety Stock Quantity;Decimal      ;AccessByPermission=TableData 244=R;
                                                   CaptionML=[ENU=Safety Stock Quantity;
                                                              NOR=Sikkerhetslagerantall];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
    { 5414;   ;Order Multiple      ;Decimal       ;AccessByPermission=TableData 244=R;
                                                   CaptionML=[ENU=Order Multiple;
                                                              NOR=Bestillingsfaktor];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
    { 5415;   ;Safety Lead Time    ;DateFormula   ;AccessByPermission=TableData 244=R;
                                                   CaptionML=[ENU=Safety Lead Time;
                                                              NOR=Sikkerhetsleveringstid] }
    { 5417;   ;Flushing Method     ;Option        ;AccessByPermission=TableData 5405=R;
                                                   CaptionML=[ENU=Flushing Method;
                                                              NOR=Trekkmetode];
                                                   OptionCaptionML=[ENU=Manual,Forward,Backward,Pick + Forward,Pick + Backward;
                                                                    NOR=Manuell,Fremover,Bakover,Plukk + Fremover,Plukk + Bakover];
                                                   OptionString=Manual,Forward,Backward,Pick + Forward,Pick + Backward }
    { 5419;   ;Replenishment System;Option        ;OnValidate=BEGIN
                                                                IF "Replenishment System" <> "Replenishment System"::Assembly THEN
                                                                  TESTFIELD("Assembly Policy","Assembly Policy"::"Assemble-to-Stock");
                                                                IF "Replenishment System" <> "Replenishment System"::Purchase THEN
                                                                  TESTFIELD(Type,Type::Inventory);
                                                              END;

                                                   AccessByPermission=TableData 244=R;
                                                   CaptionML=[ENU=Replenishment System;
                                                              NOR=Etterfyllingssystem];
                                                   OptionCaptionML=[ENU=Purchase,Prod. Order,,Assembly;
                                                                    NOR=Kj›p,Prod.ordre,,Montering];
                                                   OptionString=Purchase,Prod. Order,,Assembly }
    { 5420;   ;Scheduled Receipt (Qty.);Decimal   ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Prod. Order Line"."Remaining Qty. (Base)" WHERE (Status=FILTER(Firm Planned|Released),
                                                                                                                     Item No.=FIELD(No.),
                                                                                                                     Variant Code=FIELD(Variant Filter),
                                                                                                                     Shortcut Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                                     Shortcut Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                                     Location Code=FIELD(Location Filter),
                                                                                                                     Due Date=FIELD(Date Filter)));
                                                   CaptionML=[ENU=Scheduled Receipt (Qty.);
                                                              NOR=Planlagt mottak (ant.)];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 5421;   ;Scheduled Need (Qty.);Decimal      ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Prod. Order Component"."Remaining Qty. (Base)" WHERE (Status=FILTER(Planned..Released),
                                                                                                                          Item No.=FIELD(No.),
                                                                                                                          Variant Code=FIELD(Variant Filter),
                                                                                                                          Shortcut Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                                          Shortcut Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                                          Location Code=FIELD(Location Filter),
                                                                                                                          Due Date=FIELD(Date Filter)));
                                                   CaptionML=[ENU=Scheduled Need (Qty.);
                                                              NOR=Planlagt behov (ant.)];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 5422;   ;Rounding Precision  ;Decimal       ;InitValue=1;
                                                   OnValidate=BEGIN
                                                                IF "Rounding Precision" <= 0 THEN
                                                                  FIELDERROR("Rounding Precision",Text027);
                                                              END;

                                                   AccessByPermission=TableData 5405=R;
                                                   CaptionML=[ENU=Rounding Precision;
                                                              NOR=Avrundingspresisjon];
                                                   DecimalPlaces=0:5 }
    { 5423;   ;Bin Filter          ;Code20        ;FieldClass=FlowFilter;
                                                   TableRelation=Bin.Code WHERE (Location Code=FIELD(Location Filter));
                                                   CaptionML=[ENU=Bin Filter;
                                                              NOR=Hyllefilter] }
    { 5424;   ;Variant Filter      ;Code10        ;FieldClass=FlowFilter;
                                                   TableRelation="Item Variant".Code WHERE (Item No.=FIELD(No.));
                                                   CaptionML=[ENU=Variant Filter;
                                                              NOR=Variantfilter] }
    { 5425;   ;Sales Unit of Measure;Code10       ;TableRelation=IF (No.=FILTER(<>'')) "Item Unit of Measure".Code WHERE (Item No.=FIELD(No.))
                                                                 ELSE "Unit of Measure";
                                                   CaptionML=[ENU=Sales Unit of Measure;
                                                              NOR=Salgsenhet] }
    { 5426;   ;Purch. Unit of Measure;Code10      ;TableRelation=IF (No.=FILTER(<>'')) "Item Unit of Measure".Code WHERE (Item No.=FIELD(No.))
                                                                 ELSE "Unit of Measure";
                                                   CaptionML=[ENU=Purch. Unit of Measure;
                                                              NOR=Kj›psenhet] }
    { 5428;   ;Time Bucket         ;DateFormula   ;OnValidate=BEGIN
                                                                CalendarMgt.CheckDateFormulaPositive("Time Bucket");
                                                              END;

                                                   AccessByPermission=TableData 244=R;
                                                   CaptionML=[ENU=Time Bucket;
                                                              NOR=Tidsperiode] }
    { 5429;   ;Reserved Qty. on Prod. Order;Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Reservation Entry"."Quantity (Base)" WHERE (Item No.=FIELD(No.),
                                                                                                                Source Type=CONST(5406),
                                                                                                                Source Subtype=FILTER(1..3),
                                                                                                                Reservation Status=CONST(Reservation),
                                                                                                                Location Code=FIELD(Location Filter),
                                                                                                                Variant Code=FIELD(Variant Filter),
                                                                                                                Expected Receipt Date=FIELD(Date Filter)));
                                                   AccessByPermission=TableData 5405=R;
                                                   CaptionML=[ENU=Reserved Qty. on Prod. Order;
                                                              NOR=Reservert antall i prod.ordre];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 5430;   ;Res. Qty. on Prod. Order Comp.;Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=-Sum("Reservation Entry"."Quantity (Base)" WHERE (Item No.=FIELD(No.),
                                                                                                                 Source Type=CONST(5407),
                                                                                                                 Source Subtype=FILTER(1..3),
                                                                                                                 Reservation Status=CONST(Reservation),
                                                                                                                 Location Code=FIELD(Location Filter),
                                                                                                                 Variant Code=FIELD(Variant Filter),
                                                                                                                 Shipment Date=FIELD(Date Filter)));
                                                   AccessByPermission=TableData 5405=R;
                                                   CaptionML=[ENU=Res. Qty. on Prod. Order Comp.;
                                                              NOR=Res. antall i prod.ordrekomp.];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 5431;   ;Res. Qty. on Req. Line;Decimal     ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Reservation Entry"."Quantity (Base)" WHERE (Item No.=FIELD(No.),
                                                                                                                Source Type=CONST(246),
                                                                                                                Source Subtype=FILTER(0),
                                                                                                                Reservation Status=CONST(Reservation),
                                                                                                                Location Code=FIELD(Location Filter),
                                                                                                                Variant Code=FIELD(Variant Filter),
                                                                                                                Expected Receipt Date=FIELD(Date Filter)));
                                                   AccessByPermission=TableData 244=R;
                                                   CaptionML=[ENU=Res. Qty. on Req. Line;
                                                              NOR=Reserv. ant. p† forsl.linje];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 5440;   ;Reordering Policy   ;Option        ;OnValidate=BEGIN
                                                                "Include Inventory" :=
                                                                  "Reordering Policy" IN ["Reordering Policy"::"Lot-for-Lot",
                                                                                          "Reordering Policy"::"Maximum Qty.",
                                                                                          "Reordering Policy"::"Fixed Reorder Qty."];

                                                                IF "Reordering Policy" <> "Reordering Policy"::" " THEN
                                                                  TESTFIELD(Type,Type::Inventory);
                                                              END;

                                                   AccessByPermission=TableData 244=R;
                                                   CaptionML=[ENU=Reordering Policy;
                                                              NOR=Gjenbestillingsprinsipp];
                                                   OptionCaptionML=[ENU=" ,Fixed Reorder Qty.,Maximum Qty.,Order,Lot-for-Lot";
                                                                    NOR=" ,Fast gjenbest.ant.,Maks.ant.,Ordre,Parti for parti"];
                                                   OptionString=[ ,Fixed Reorder Qty.,Maximum Qty.,Order,Lot-for-Lot] }
    { 5441;   ;Include Inventory   ;Boolean       ;AccessByPermission=TableData 244=R;
                                                   CaptionML=[ENU=Include Inventory;
                                                              NOR=Ta med lagerbeholdning] }
    { 5442;   ;Manufacturing Policy;Option        ;AccessByPermission=TableData 244=R;
                                                   CaptionML=[ENU=Manufacturing Policy;
                                                              NOR=Produksjonsprinsipp];
                                                   OptionCaptionML=[ENU=Make-to-Stock,Make-to-Order;
                                                                    NOR=Produser til lager,Produser til ordre];
                                                   OptionString=Make-to-Stock,Make-to-Order }
    { 5443;   ;Rescheduling Period ;DateFormula   ;OnValidate=BEGIN
                                                                CalendarMgt.CheckDateFormulaPositive("Rescheduling Period");
                                                              END;

                                                   AccessByPermission=TableData 244=R;
                                                   CaptionML=[ENU=Rescheduling Period;
                                                              NOR=Periode for ny planlegging] }
    { 5444;   ;Lot Accumulation Period;DateFormula;OnValidate=BEGIN
                                                                CalendarMgt.CheckDateFormulaPositive("Lot Accumulation Period");
                                                              END;

                                                   AccessByPermission=TableData 244=R;
                                                   CaptionML=[ENU=Lot Accumulation Period;
                                                              NOR=Akkumuleringsperiode for parti] }
    { 5445;   ;Dampener Period     ;DateFormula   ;OnValidate=BEGIN
                                                                CalendarMgt.CheckDateFormulaPositive("Dampener Period");
                                                              END;

                                                   AccessByPermission=TableData 244=R;
                                                   CaptionML=[ENU=Dampener Period;
                                                              NOR=Avdempingsperiode] }
    { 5446;   ;Dampener Quantity   ;Decimal       ;AccessByPermission=TableData 244=R;
                                                   CaptionML=[ENU=Dampener Quantity;
                                                              NOR=Avdempingsantall];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
    { 5447;   ;Overflow Level      ;Decimal       ;AccessByPermission=TableData 244=R;
                                                   CaptionML=[ENU=Overflow Level;
                                                              NOR=Overflytniv†];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
    { 5449;   ;Planning Transfer Ship. (Qty).;Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Requisition Line"."Quantity (Base)" WHERE (Replenishment System=CONST(Transfer),
                                                                                                               Type=CONST(Item),
                                                                                                               No.=FIELD(No.),
                                                                                                               Variant Code=FIELD(Variant Filter),
                                                                                                               Transfer-from Code=FIELD(Location Filter),
                                                                                                               Transfer Shipment Date=FIELD(Date Filter)));
                                                   CaptionML=[ENU=Planning Transfer Ship. (Qty).;
                                                              NOR=Planleggingsoverf›ringsseddel (antall).];
                                                   Editable=No }
    { 5450;   ;Planning Worksheet (Qty.);Decimal  ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Requisition Line"."Quantity (Base)" WHERE (Planning Line Origin=CONST(Planning),
                                                                                                               Type=CONST(Item),
                                                                                                               No.=FIELD(No.),
                                                                                                               Location Code=FIELD(Location Filter),
                                                                                                               Variant Code=FIELD(Variant Filter),
                                                                                                               Due Date=FIELD(Date Filter),
                                                                                                               Shortcut Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                               Shortcut Dimension 2 Code=FIELD(Global Dimension 2 Filter)));
                                                   CaptionML=[ENU=Planning Worksheet (Qty.);
                                                              NOR=Planleggingsforslag (antall)];
                                                   Editable=No }
    { 5700;   ;Stockkeeping Unit Exists;Boolean   ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Stockkeeping Unit" WHERE (Item No.=FIELD(No.)));
                                                   CaptionML=[ENU=Stockkeeping Unit Exists;
                                                              NOR=Lagerf›ringsenhet finnes];
                                                   Editable=No }
    { 5701;   ;Manufacturer Code   ;Code10        ;TableRelation=Manufacturer;
                                                   CaptionML=[ENU=Manufacturer Code;
                                                              NOR=Produsentkode] }
    { 5702;   ;Item Category Code  ;Code10        ;TableRelation="Item Category";
                                                   CaptionML=[ENU=Item Category Code;
                                                              NOR=Varekategorikode] }
    { 5703;   ;Created From Nonstock Item;Boolean ;AccessByPermission=TableData 5718=R;
                                                   CaptionML=[ENU=Created From Nonstock Item;
                                                              NOR=Opprettet fra katalogvare];
                                                   Editable=No }
    { 5704;   ;Product Group Code  ;Code10        ;TableRelation="Product Group".Code WHERE (Item Category Code=FIELD(Item Category Code));
                                                   CaptionML=[ENU=Product Group Code;
                                                              NOR=Produktgruppekode] }
    { 5706;   ;Substitutes Exist   ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Item Substitution" WHERE (Type=CONST(Item),
                                                                                                No.=FIELD(No.)));
                                                   CaptionML=[ENU=Substitutes Exist;
                                                              NOR=Erstatning finnes];
                                                   Editable=No }
    { 5707;   ;Qty. in Transit     ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Transfer Line"."Qty. in Transit (Base)" WHERE (Derived From Line No.=CONST(0),
                                                                                                                   Item No.=FIELD(No.),
                                                                                                                   Transfer-to Code=FIELD(Location Filter),
                                                                                                                   Variant Code=FIELD(Variant Filter),
                                                                                                                   Shortcut Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                                   Shortcut Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                                   Receipt Date=FIELD(Date Filter)));
                                                   CaptionML=[ENU=Qty. in Transit;
                                                              NOR=Ant. i transitt];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 5708;   ;Trans. Ord. Receipt (Qty.);Decimal ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Transfer Line"."Outstanding Qty. (Base)" WHERE (Derived From Line No.=CONST(0),
                                                                                                                    Item No.=FIELD(No.),
                                                                                                                    Transfer-to Code=FIELD(Location Filter),
                                                                                                                    Variant Code=FIELD(Variant Filter),
                                                                                                                    Shortcut Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                                    Shortcut Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                                    Receipt Date=FIELD(Date Filter)));
                                                   CaptionML=[ENU=Trans. Ord. Receipt (Qty.);
                                                              NOR=Overf.ordremottak (ant.)];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 5709;   ;Trans. Ord. Shipment (Qty.);Decimal;FieldClass=FlowField;
                                                   CalcFormula=Sum("Transfer Line"."Outstanding Qty. (Base)" WHERE (Derived From Line No.=CONST(0),
                                                                                                                    Item No.=FIELD(No.),
                                                                                                                    Transfer-from Code=FIELD(Location Filter),
                                                                                                                    Variant Code=FIELD(Variant Filter),
                                                                                                                    Shortcut Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                                    Shortcut Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                                    Shipment Date=FIELD(Date Filter)));
                                                   CaptionML=[ENU=Trans. Ord. Shipment (Qty.);
                                                              NOR=Overf.ordreseddel (ant.)];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 5776;   ;Qty. Assigned to ship;Decimal      ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Warehouse Shipment Line"."Qty. Outstanding (Base)" WHERE (Item No.=FIELD(No.),
                                                                                                                              Location Code=FIELD(Location Filter),
                                                                                                                              Variant Code=FIELD(Variant Filter),
                                                                                                                              Due Date=FIELD(Date Filter)));
                                                   CaptionML=[ENU=Qty. Assigned to ship;
                                                              NOR=Ant. som skal leveres];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 5777;   ;Qty. Picked         ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Warehouse Shipment Line"."Qty. Picked (Base)" WHERE (Item No.=FIELD(No.),
                                                                                                                         Location Code=FIELD(Location Filter),
                                                                                                                         Variant Code=FIELD(Variant Filter),
                                                                                                                         Due Date=FIELD(Date Filter)));
                                                   CaptionML=[ENU=Qty. Picked;
                                                              NOR=Plukket ant.];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 5900;   ;Service Item Group  ;Code10        ;TableRelation="Service Item Group".Code;
                                                   OnValidate=VAR
                                                                ResSkill@1000 : Record 5956;
                                                              BEGIN
                                                                IF xRec."Service Item Group" <> "Service Item Group" THEN BEGIN
                                                                  IF NOT ResSkillMgt.ChangeRelationWithGroup(
                                                                       ResSkill.Type::Item,
                                                                       "No.",
                                                                       ResSkill.Type::"Service Item Group",
                                                                       "Service Item Group",
                                                                       xRec."Service Item Group")
                                                                  THEN
                                                                    "Service Item Group" := xRec."Service Item Group";
                                                                END ELSE
                                                                  ResSkillMgt.RevalidateRelation(
                                                                    ResSkill.Type::Item,
                                                                    "No.",
                                                                    ResSkill.Type::"Service Item Group",
                                                                    "Service Item Group")
                                                              END;

                                                   CaptionML=[ENU=Service Item Group;
                                                              NOR=Servicevaregruppe] }
    { 5901;   ;Qty. on Service Order;Decimal      ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Service Line"."Outstanding Qty. (Base)" WHERE (Document Type=CONST(Order),
                                                                                                                   Type=CONST(Item),
                                                                                                                   No.=FIELD(No.),
                                                                                                                   Shortcut Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                                   Shortcut Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                                   Location Code=FIELD(Location Filter),
                                                                                                                   Variant Code=FIELD(Variant Filter),
                                                                                                                   Needed by Date=FIELD(Date Filter)));
                                                   CaptionML=[ENU=Qty. on Service Order;
                                                              NOR=Ant. i serviceordre];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 5902;   ;Res. Qty. on Service Orders;Decimal;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Reservation Entry"."Quantity (Base)" WHERE (Item No.=FIELD(No.),
                                                                                                                 Source Type=CONST(5902),
                                                                                                                 Source Subtype=CONST(1),
                                                                                                                 Reservation Status=CONST(Reservation),
                                                                                                                 Location Code=FIELD(Location Filter),
                                                                                                                 Variant Code=FIELD(Variant Filter),
                                                                                                                 Shipment Date=FIELD(Date Filter)));
                                                   AccessByPermission=TableData 5900=R;
                                                   CaptionML=[ENU=Res. Qty. on Service Orders;
                                                              NOR=Res. ant. i serviceordrer];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 6500;   ;Item Tracking Code  ;Code10        ;TableRelation="Item Tracking Code";
                                                   OnValidate=BEGIN
                                                                IF "Item Tracking Code" <> '' THEN
                                                                  TESTFIELD(Type,Type::Inventory);
                                                                IF "Item Tracking Code" = xRec."Item Tracking Code" THEN
                                                                  EXIT;

                                                                IF NOT ItemTrackingCode.GET("Item Tracking Code") THEN
                                                                  CLEAR(ItemTrackingCode);

                                                                IF NOT ItemTrackingCode2.GET(xRec."Item Tracking Code") THEN
                                                                  CLEAR(ItemTrackingCode2);

                                                                IF (ItemTrackingCode."SN Specific Tracking" <> ItemTrackingCode2."SN Specific Tracking") OR
                                                                   (ItemTrackingCode."Lot Specific Tracking" <> ItemTrackingCode2."Lot Specific Tracking")
                                                                THEN
                                                                  TestNoEntriesExist(FIELDCAPTION("Item Tracking Code"));

                                                                IF "Costing Method" = "Costing Method"::Specific THEN BEGIN
                                                                  TestNoEntriesExist(FIELDCAPTION("Item Tracking Code"));

                                                                  TESTFIELD("Item Tracking Code");

                                                                  ItemTrackingCode.GET("Item Tracking Code");
                                                                  IF NOT ItemTrackingCode."SN Specific Tracking" THEN
                                                                    ERROR(
                                                                      Text018,
                                                                      ItemTrackingCode.FIELDCAPTION("SN Specific Tracking"),
                                                                      FORMAT(TRUE),ItemTrackingCode.TABLECAPTION,ItemTrackingCode.Code,
                                                                      FIELDCAPTION("Costing Method"),"Costing Method");
                                                                END;

                                                                TestNoOpenDocumentsWithTrackingExist;
                                                              END;

                                                   CaptionML=[ENU=Item Tracking Code;
                                                              NOR=Varesporingskode] }
    { 6501;   ;Lot Nos.            ;Code10        ;TableRelation="No. Series";
                                                   OnValidate=BEGIN
                                                                IF "Lot Nos." <> '' THEN
                                                                  TESTFIELD("Item Tracking Code");
                                                              END;

                                                   CaptionML=[ENU=Lot Nos.;
                                                              NOR=Partinr.] }
    { 6502;   ;Expiration Calculation;DateFormula ;CaptionML=[ENU=Expiration Calculation;
                                                              NOR=Beregn. av utl›psdato] }
    { 6503;   ;Lot No. Filter      ;Code20        ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Lot No. Filter;
                                                              NOR=Partinr.filter] }
    { 6504;   ;Serial No. Filter   ;Code20        ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Serial No. Filter;
                                                              NOR=Serienr.filter] }
    { 6650;   ;Qty. on Purch. Return;Decimal      ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Purchase Line"."Outstanding Qty. (Base)" WHERE (Document Type=CONST(Return Order),
                                                                                                                    Type=CONST(Item),
                                                                                                                    No.=FIELD(No.),
                                                                                                                    Shortcut Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                                    Shortcut Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                                    Location Code=FIELD(Location Filter),
                                                                                                                    Drop Shipment=FIELD(Drop Shipment Filter),
                                                                                                                    Variant Code=FIELD(Variant Filter),
                                                                                                                    Expected Receipt Date=FIELD(Date Filter)));
                                                   AccessByPermission=TableData 6660=R;
                                                   CaptionML=[ENU=Qty. on Purch. Return;
                                                              NOR=Antall i bestillingsretur];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 6660;   ;Qty. on Sales Return;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Sales Line"."Outstanding Qty. (Base)" WHERE (Document Type=CONST(Return Order),
                                                                                                                 Type=CONST(Item),
                                                                                                                 No.=FIELD(No.),
                                                                                                                 Shortcut Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                                 Shortcut Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                                 Location Code=FIELD(Location Filter),
                                                                                                                 Drop Shipment=FIELD(Drop Shipment Filter),
                                                                                                                 Variant Code=FIELD(Variant Filter),
                                                                                                                 Shipment Date=FIELD(Date Filter)));
                                                   AccessByPermission=TableData 6650=R;
                                                   CaptionML=[ENU=Qty. on Sales Return;
                                                              NOR=Antall i ordretur];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 7171;   ;No. of Substitutes  ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Item Substitution" WHERE (Type=CONST(Item),
                                                                                                No.=FIELD(No.)));
                                                   CaptionML=[ENU=No. of Substitutes;
                                                              NOR=Antall erstatninger];
                                                   Editable=No }
    { 7300;   ;Warehouse Class Code;Code10        ;TableRelation="Warehouse Class";
                                                   CaptionML=[ENU=Warehouse Class Code;
                                                              NOR=Lagerklassekode] }
    { 7301;   ;Special Equipment Code;Code10      ;TableRelation="Special Equipment";
                                                   CaptionML=[ENU=Special Equipment Code;
                                                              NOR=Spesialutstyrskode] }
    { 7302;   ;Put-away Template Code;Code10      ;TableRelation="Put-away Template Header";
                                                   CaptionML=[ENU=Put-away Template Code;
                                                              NOR=Lagerplasseringsmal - kode] }
    { 7307;   ;Put-away Unit of Measure Code;Code10;
                                                   TableRelation=IF (No.=FILTER(<>'')) "Item Unit of Measure".Code WHERE (Item No.=FIELD(No.))
                                                                 ELSE "Unit of Measure";
                                                   AccessByPermission=TableData 7340=R;
                                                   CaptionML=[ENU=Put-away Unit of Measure Code;
                                                              NOR=Lagerplassering  - enhetskode] }
    { 7380;   ;Phys Invt Counting Period Code;Code10;
                                                   TableRelation="Phys. Invt. Counting Period";
                                                   OnValidate=VAR
                                                                PhysInvtCountPeriod@1000 : Record 7381;
                                                                PhysInvtCountPeriodMgt@1001 : Codeunit 7380;
                                                              BEGIN
                                                                IF "Phys Invt Counting Period Code" <> '' THEN BEGIN
                                                                  PhysInvtCountPeriod.GET("Phys Invt Counting Period Code");
                                                                  PhysInvtCountPeriod.TESTFIELD("Count Frequency per Year");
                                                                  IF "Phys Invt Counting Period Code" <> xRec."Phys Invt Counting Period Code" THEN BEGIN
                                                                    IF CurrFieldNo <> 0 THEN
                                                                      IF NOT CONFIRM(
                                                                           Text7380,
                                                                           FALSE,
                                                                           FIELDCAPTION("Phys Invt Counting Period Code"),
                                                                           FIELDCAPTION("Next Counting Start Date"),
                                                                           FIELDCAPTION("Next Counting End Date"))
                                                                      THEN
                                                                        ERROR(Text7381);

                                                                    PhysInvtCountPeriodMgt.CalcPeriod(
                                                                      "Last Counting Period Update","Next Counting Start Date","Next Counting End Date",
                                                                      PhysInvtCountPeriod."Count Frequency per Year",
                                                                      ("Last Counting Period Update" = 0D) OR
                                                                      ("Phys Invt Counting Period Code" <> xRec."Phys Invt Counting Period Code"));
                                                                  END;
                                                                END ELSE BEGIN
                                                                  IF CurrFieldNo <> 0 THEN
                                                                    IF NOT CONFIRM(Text003,FALSE,FIELDCAPTION("Phys Invt Counting Period Code")) THEN
                                                                      ERROR(Text7381);
                                                                  "Next Counting Start Date" := 0D;
                                                                  "Next Counting End Date" := 0D;
                                                                  "Last Counting Period Update" := 0D;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Phys Invt Counting Period Code;
                                                              NOR=Vareopptell.periode - kode] }
    { 7381;   ;Last Counting Period Update;Date   ;AccessByPermission=TableData 7380=R;
                                                   CaptionML=[ENU=Last Counting Period Update;
                                                              NOR=Oppdat. av siste opptell.per.];
                                                   Editable=No }
    { 7383;   ;Last Phys. Invt. Date;Date         ;FieldClass=FlowField;
                                                   CalcFormula=Max("Phys. Inventory Ledger Entry"."Posting Date" WHERE (Item No.=FIELD(No.),
                                                                                                                        Phys Invt Counting Period Type=FILTER(' '|Item)));
                                                   CaptionML=[ENU=Last Phys. Invt. Date;
                                                              NOR=Siste vareopptellingsdato];
                                                   Editable=No }
    { 7384;   ;Use Cross-Docking   ;Boolean       ;InitValue=Yes;
                                                   AccessByPermission=TableData 7302=R;
                                                   CaptionML=[ENU=Use Cross-Docking;
                                                              NOR=Bruk kryssoverf›ring] }
    { 7385;   ;Next Counting Start Date;Date      ;CaptionML=[ENU=Next Counting Start Date;
                                                              NOR=Startdato for neste opptelling];
                                                   Editable=No }
    { 7386;   ;Next Counting End Date;Date        ;CaptionML=[ENU=Next Counting End Date;
                                                              NOR=Sluttdato for neste opptelling];
                                                   Editable=No }
    { 7700;   ;Identifier Code     ;Code20        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Item Identifier".Code WHERE (Item No.=FIELD(No.)));
                                                   CaptionML=[ENU=Identifier Code;
                                                              NOR=ID-kode];
                                                   Editable=No }
    { 75000;  ;Workshop            ;Text100        }
    { 99000750;;Routing No.        ;Code20        ;TableRelation="Routing Header";
                                                   OnValidate=BEGIN
                                                                IF "Routing No." <> '' THEN
                                                                  TESTFIELD(Type,Type::Inventory);

                                                                PlanningAssignment.RoutingReplace(Rec,xRec."Routing No.");

                                                                IF "Routing No." <> xRec."Routing No." THEN
                                                                  ItemCostMgt.UpdateUnitCost(Rec,'','',0,0,FALSE,FALSE,TRUE,FIELDNO("Routing No."));
                                                              END;

                                                   CaptionML=[ENU=Routing No.;
                                                              NOR=Rutenr.] }
    { 99000751;;Production BOM No. ;Code20        ;TableRelation="Production BOM Header";
                                                   OnValidate=VAR
                                                                MfgSetup@1000 : Record 99000765;
                                                                ProdBOMHeader@1001 : Record 99000771;
                                                                ItemUnitOfMeasure@1003 : Record 5404;
                                                                CalcLowLevel@1002 : Codeunit 99000793;
                                                              BEGIN
                                                                IF "Production BOM No." <> '' THEN
                                                                  TESTFIELD(Type,Type::Inventory);

                                                                PlanningAssignment.BomReplace(Rec,xRec."Production BOM No.");

                                                                IF "Production BOM No." <> xRec."Production BOM No." THEN
                                                                  ItemCostMgt.UpdateUnitCost(Rec,'','',0,0,FALSE,FALSE,TRUE,FIELDNO("Production BOM No."));

                                                                IF ("Production BOM No." <> '') AND ("Production BOM No." <> xRec."Production BOM No.") THEN BEGIN
                                                                  ProdBOMHeader.GET("Production BOM No.");
                                                                  ItemUnitOfMeasure.GET("No.",ProdBOMHeader."Unit of Measure Code");
                                                                  IF ProdBOMHeader.Status = ProdBOMHeader.Status::Certified THEN BEGIN
                                                                    MfgSetup.GET;
                                                                    IF MfgSetup."Dynamic Low-Level Code" THEN
                                                                      CalcLowLevel.RUN(Rec);
                                                                  END;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Production BOM No.;
                                                              NOR=Produksjonsstykklistenr.] }
    { 99000752;;Single-Level Material Cost;Decimal;CaptionML=[ENU=Single-Level Material Cost;
                                                              NOR=Materialkostn. - enkeltniv†];
                                                   Editable=No;
                                                   AutoFormatType=2 }
    { 99000753;;Single-Level Capacity Cost;Decimal;CaptionML=[ENU=Single-Level Capacity Cost;
                                                              NOR=Kapasitetskostn. - enkeltniv†];
                                                   Editable=No;
                                                   AutoFormatType=2 }
    { 99000754;;Single-Level Subcontrd. Cost;Decimal;
                                                   CaptionML=[ENU=Single-Level Subcontrd. Cost;
                                                              NOR=Underlevrd.kostn - enkeltniv†];
                                                   Editable=No;
                                                   AutoFormatType=2 }
    { 99000755;;Single-Level Cap. Ovhd Cost;Decimal;
                                                   CaptionML=[ENU=Single-Level Cap. Ovhd Cost;
                                                              NOR=Indir. kap.kostn - enkeltniv†];
                                                   Editable=No;
                                                   AutoFormatType=2 }
    { 99000756;;Single-Level Mfg. Ovhd Cost;Decimal;
                                                   CaptionML=[ENU=Single-Level Mfg. Ovhd Cost;
                                                              NOR=Indir. prod.kostn - enkeltniv†];
                                                   Editable=No;
                                                   AutoFormatType=2 }
    { 99000757;;Overhead Rate      ;Decimal       ;AccessByPermission=TableData 5405=R;
                                                   CaptionML=[ENU=Overhead Rate;
                                                              NOR=Sats for indirekte kostnader];
                                                   AutoFormatType=2 }
    { 99000758;;Rolled-up Subcontracted Cost;Decimal;
                                                   AccessByPermission=TableData 5405=R;
                                                   CaptionML=[ENU=Rolled-up Subcontracted Cost;
                                                              NOR=Underlever.kostn. - opprullert];
                                                   Editable=No;
                                                   AutoFormatType=2 }
    { 99000759;;Rolled-up Mfg. Ovhd Cost;Decimal  ;CaptionML=[ENU=Rolled-up Mfg. Ovhd Cost;
                                                              NOR=Opprullert indir. prod.kostn.];
                                                   Editable=No;
                                                   AutoFormatType=2 }
    { 99000760;;Rolled-up Cap. Overhead Cost;Decimal;
                                                   CaptionML=[ENU=Rolled-up Cap. Overhead Cost;
                                                              NOR=Opprullert indir. kap.kostn.];
                                                   Editable=No;
                                                   AutoFormatType=2 }
    { 99000761;;Planning Issues (Qty.);Decimal    ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Planning Component"."Expected Quantity (Base)" WHERE (Item No.=FIELD(No.),
                                                                                                                          Due Date=FIELD(Date Filter),
                                                                                                                          Location Code=FIELD(Location Filter),
                                                                                                                          Variant Code=FIELD(Variant Filter),
                                                                                                                          Shortcut Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                                          Shortcut Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                                          Planning Line Origin=CONST(" ")));
                                                   CaptionML=[ENU=Planning Issues (Qty.);
                                                              NOR=Planl. utstedelser (ant.)];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 99000762;;Planning Receipt (Qty.);Decimal   ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Requisition Line"."Quantity (Base)" WHERE (Type=CONST(Item),
                                                                                                               No.=FIELD(No.),
                                                                                                               Due Date=FIELD(Date Filter),
                                                                                                               Location Code=FIELD(Location Filter),
                                                                                                               Variant Code=FIELD(Variant Filter),
                                                                                                               Shortcut Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                               Shortcut Dimension 2 Code=FIELD(Global Dimension 2 Filter)));
                                                   CaptionML=[ENU=Planning Receipt (Qty.);
                                                              NOR=Planl. mottak (ant.)];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 99000765;;Planned Order Receipt (Qty.);Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Prod. Order Line"."Remaining Qty. (Base)" WHERE (Status=CONST(Planned),
                                                                                                                     Item No.=FIELD(No.),
                                                                                                                     Variant Code=FIELD(Variant Filter),
                                                                                                                     Shortcut Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                                     Shortcut Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                                     Location Code=FIELD(Location Filter),
                                                                                                                     Due Date=FIELD(Date Filter)));
                                                   CaptionML=[ENU=Planned Order Receipt (Qty.);
                                                              NOR=Planl. ordremottak (ant.)];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 99000766;;FP Order Receipt (Qty.);Decimal   ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Prod. Order Line"."Remaining Qty. (Base)" WHERE (Status=CONST(Firm Planned),
                                                                                                                     Item No.=FIELD(No.),
                                                                                                                     Variant Code=FIELD(Variant Filter),
                                                                                                                     Shortcut Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                                     Shortcut Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                                     Location Code=FIELD(Location Filter),
                                                                                                                     Due Date=FIELD(Date Filter)));
                                                   CaptionML=[ENU=FP Order Receipt (Qty.);
                                                              NOR=Fast planl. ordremott. (ant.)];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 99000767;;Rel. Order Receipt (Qty.);Decimal ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Prod. Order Line"."Remaining Qty. (Base)" WHERE (Status=CONST(Released),
                                                                                                                     Item No.=FIELD(No.),
                                                                                                                     Variant Code=FIELD(Variant Filter),
                                                                                                                     Shortcut Dimension 1 Code=FIELD(Global Dimension 2 Filter),
                                                                                                                     Shortcut Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                                     Location Code=FIELD(Location Filter),
                                                                                                                     Due Date=FIELD(Date Filter)));
                                                   CaptionML=[ENU=Rel. Order Receipt (Qty.);
                                                              NOR=Tilh. ordremottak (ant.)];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 99000768;;Planning Release (Qty.);Decimal   ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Requisition Line"."Quantity (Base)" WHERE (Type=CONST(Item),
                                                                                                               No.=FIELD(No.),
                                                                                                               Starting Date=FIELD(Date Filter),
                                                                                                               Location Code=FIELD(Location Filter),
                                                                                                               Variant Code=FIELD(Variant Filter),
                                                                                                               Shortcut Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                               Shortcut Dimension 2 Code=FIELD(Global Dimension 2 Filter)));
                                                   CaptionML=[ENU=Planning Release (Qty.);
                                                              NOR=Planl. frigivelse (ant.)];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 99000769;;Planned Order Release (Qty.);Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Prod. Order Line"."Remaining Qty. (Base)" WHERE (Status=CONST(Planned),
                                                                                                                     Item No.=FIELD(No.),
                                                                                                                     Variant Code=FIELD(Variant Filter),
                                                                                                                     Shortcut Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                                     Shortcut Dimension 2 Code=FIELD(Global Dimension 1 Filter),
                                                                                                                     Location Code=FIELD(Location Filter),
                                                                                                                     Starting Date=FIELD(Date Filter)));
                                                   CaptionML=[ENU=Planned Order Release (Qty.);
                                                              NOR=Planl. ordrefrigivelse (ant.)];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 99000770;;Purch. Req. Receipt (Qty.);Decimal;FieldClass=FlowField;
                                                   CalcFormula=Sum("Requisition Line"."Quantity (Base)" WHERE (Type=CONST(Item),
                                                                                                               No.=FIELD(No.),
                                                                                                               Variant Code=FIELD(Variant Filter),
                                                                                                               Location Code=FIELD(Location Filter),
                                                                                                               Shortcut Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                               Shortcut Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                               Due Date=FIELD(Date Filter),
                                                                                                               Planning Line Origin=CONST(" ")));
                                                   CaptionML=[ENU=Purch. Req. Receipt (Qty.);
                                                              NOR=Best.forslag - mottak (ant.)];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 99000771;;Purch. Req. Release (Qty.);Decimal;FieldClass=FlowField;
                                                   CalcFormula=Sum("Requisition Line"."Quantity (Base)" WHERE (Type=CONST(Item),
                                                                                                               No.=FIELD(No.),
                                                                                                               Location Code=FIELD(Location Filter),
                                                                                                               Variant Code=FIELD(Variant Filter),
                                                                                                               Shortcut Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                               Shortcut Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                               Order Date=FIELD(Date Filter)));
                                                   CaptionML=[ENU=Purch. Req. Release (Qty.);
                                                              NOR=Best.forslag - frigi (ant.)];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 99000773;;Order Tracking Policy;Option      ;OnValidate=VAR
                                                                ReservEntry@1000 : Record 337;
                                                                ActionMessageEntry@1001 : Record 99000849;
                                                                TempReservationEntry@1002 : TEMPORARY Record 337;
                                                              BEGIN
                                                                IF "Order Tracking Policy" <> "Order Tracking Policy"::None THEN
                                                                  TESTFIELD(Type,Type::Inventory);
                                                                IF xRec."Order Tracking Policy" = "Order Tracking Policy" THEN
                                                                  EXIT;
                                                                IF "Order Tracking Policy" > xRec."Order Tracking Policy" THEN BEGIN
                                                                  MESSAGE(Text99000000 +
                                                                    Text99000001,
                                                                    SELECTSTR("Order Tracking Policy",Text99000002));
                                                                END ELSE BEGIN
                                                                  ActionMessageEntry.SETCURRENTKEY("Reservation Entry");
                                                                  ReservEntry.SETCURRENTKEY("Item No.","Variant Code","Location Code","Reservation Status");
                                                                  ReservEntry.SETRANGE("Item No.","No.");
                                                                  ReservEntry.SETRANGE("Reservation Status",ReservEntry."Reservation Status"::Tracking,ReservEntry."Reservation Status"::Surplus);
                                                                  IF ReservEntry.FIND('-') THEN
                                                                    REPEAT
                                                                      ActionMessageEntry.SETRANGE("Reservation Entry",ReservEntry."Entry No.");
                                                                      ActionMessageEntry.DELETEALL;
                                                                      IF "Order Tracking Policy" = "Order Tracking Policy"::None THEN
                                                                        IF ReservEntry.TrackingExists THEN BEGIN
                                                                          TempReservationEntry := ReservEntry;
                                                                          TempReservationEntry."Reservation Status" := TempReservationEntry."Reservation Status"::Surplus;
                                                                          TempReservationEntry.INSERT;
                                                                        END ELSE
                                                                          ReservEntry.DELETE;
                                                                    UNTIL ReservEntry.NEXT = 0;

                                                                  IF TempReservationEntry.FIND('-') THEN
                                                                    REPEAT
                                                                      ReservEntry := TempReservationEntry;
                                                                      ReservEntry.MODIFY;
                                                                    UNTIL TempReservationEntry.NEXT = 0;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Order Tracking Policy;
                                                              NOR=Sporingsprinsipp];
                                                   OptionCaptionML=[ENU=None,Tracking Only,Tracking & Action Msg.;
                                                                    NOR=Ingen,Bare sporing,Sporing og handl.meld.];
                                                   OptionString=None,Tracking Only,Tracking & Action Msg. }
    { 99000774;;Prod. Forecast Quantity (Base);Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Production Forecast Entry"."Forecast Quantity (Base)" WHERE (Item No.=FIELD(No.),
                                                                                                                                 Production Forecast Name=FIELD(Production Forecast Name),
                                                                                                                                 Forecast Date=FIELD(Date Filter),
                                                                                                                                 Location Code=FIELD(Location Filter),
                                                                                                                                 Component Forecast=FIELD(Component Forecast)));
                                                   CaptionML=[ENU=Prod. Forecast Quantity (Base);
                                                              NOR=Prod.prognoseantall (lagerenh.)];
                                                   DecimalPlaces=0:5 }
    { 99000775;;Production Forecast Name;Code10   ;FieldClass=FlowFilter;
                                                   TableRelation="Production Forecast Name";
                                                   CaptionML=[ENU=Production Forecast Name;
                                                              NOR=Navn p† prod.prognose] }
    { 99000776;;Component Forecast ;Boolean       ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Component Forecast;
                                                              NOR=Komponentprognose] }
    { 99000777;;Qty. on Prod. Order;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Prod. Order Line"."Remaining Qty. (Base)" WHERE (Status=FILTER(Planned..Released),
                                                                                                                     Item No.=FIELD(No.),
                                                                                                                     Shortcut Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                                     Shortcut Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                                     Location Code=FIELD(Location Filter),
                                                                                                                     Variant Code=FIELD(Variant Filter),
                                                                                                                     Due Date=FIELD(Date Filter)));
                                                   CaptionML=[ENU=Qty. on Prod. Order;
                                                              NOR=Antall i prod.ordre];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 99000778;;Qty. on Component Lines;Decimal   ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Prod. Order Component"."Remaining Qty. (Base)" WHERE (Status=FILTER(Planned..Released),
                                                                                                                          Item No.=FIELD(No.),
                                                                                                                          Shortcut Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                                          Shortcut Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                                          Location Code=FIELD(Location Filter),
                                                                                                                          Variant Code=FIELD(Variant Filter),
                                                                                                                          Due Date=FIELD(Date Filter)));
                                                   CaptionML=[ENU=Qty. on Component Lines;
                                                              NOR=Ant. p† komponentlinjer];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 99000875;;Critical           ;Boolean       ;CaptionML=[ENU=Critical;
                                                              NOR=Kritisk] }
    { 99008500;;Common Item No.    ;Code20        ;CaptionML=[ENU=Common Item No.;
                                                              NOR=Felles varenr.] }
  }
  KEYS
  {
    {    ;No.                                     ;Clustered=Yes }
    {    ;Search Description                       }
    {    ;Inventory Posting Group                  }
    {    ;Shelf No.                                }
    {    ;Vendor No.                               }
    {    ;Gen. Prod. Posting Group                 }
    {    ;Low-Level Code                           }
    {    ;Production BOM No.                       }
    {    ;Routing No.                              }
    {    ;Vendor Item No.,Vendor No.               }
    {    ;Common Item No.                          }
    {    ;Service Item Group                       }
    {    ;Cost is Adjusted,Allow Online Adjustment }
    {    ;Description                              }
    {    ;Base Unit of Measure                     }
    {    ;Type                                     }
  }
  FIELDGROUPS
  {
    { 1   ;DropDown            ;No.,Description,Base Unit of Measure,Unit Price }
    { 2   ;Brick               ;No.,Description,Inventory,Unit Price,Base Unit of Measure,Description 2,Picture }
  }
  CODE
  {
    VAR
      Text000@1000 : TextConst 'ENU=You cannot delete %1 %2 because there is at least one outstanding Purchase %3 that includes this item.;NOR=Du kan ikke slette %1 %2 fordi det finnes minst ‚n †pen kj›ps%3 som inkluderer denne varen.';
      Text001@1001 : TextConst 'ENU=You cannot delete %1 %2 because there is at least one outstanding Sales %3 that includes this item.;NOR=Du kan ikke slette %1 %2 fordi det finnes minst ‚n †pen salg %3 som inkluderer denne varen.';
      Text002@1002 : TextConst 'ENU=You cannot delete %1 %2 because there are one or more outstanding production orders that include this item.;NOR=Du kan ikke slette %1 %2 fordi det finnes ‚n eller flere †pne produksjonsordrer som inneholder denne varen.';
      Text003@1057 : TextConst 'ENU=Do you want to change %1?;NOR=Vil du endre %1?';
      Text004@1064 : TextConst 'ENU=You cannot delete %1 %2 because there are one or more certified Production BOM that include this item.;NOR=Du kan ikke slette %1 %2 fordi ‚n eller flere sertifiserte produksjonsstykklister inneholder denne varen.';
      Text006@1003 : TextConst 'ENU=Prices including VAT cannot be calculated when %1 is %2.;NOR=Priser inkl. mva. kan ikke beregnes n†r %1 er %2.';
      Text007@1004 : TextConst 'ENU=You cannot change %1 because there are one or more ledger entries for this item.;NOR=Du kan ikke endre %1 fordi det finnes ‚n eller flere poster for denne varen.';
      Text008@1005 : TextConst 'ENU=You cannot change %1 because there is at least one outstanding Purchase %2 that include this item.;NOR=Du kan ikke endre %1 fordi det finnes minst ‚n †pen %2 for kj›p som inkluderer denne varen.';
      Text014@1006 : TextConst 'ENU=You cannot delete %1 %2 because there are one or more production order component lines that include this item with a remaining quantity that is not 0.;NOR=Du kan ikke slette %1 %2 fordi det finnes ‚n eller flere komponentlinjer for produksjonsordrer som inneholder et restantall for varen som ikke er 0.';
      Text016@1008 : TextConst 'ENU=You cannot delete %1 %2 because there are one or more outstanding transfer orders that include this item.;NOR=Du kan ikke slette %1 %2 fordi det finnes ‚n eller flere linjer †pne overf›ringsordrer som inneholder denne varen.';
      Text017@1009 : TextConst 'ENU=You cannot delete %1 %2 because there is at least one outstanding Service %3 that includes this item.;NOR=Du kan ikke slette %1 %2 fordi det finnes minst ‚n utest†ende service %3 som inkluderer denne varen.';
      Text018@1010 : TextConst 'ENU=%1 must be %2 in %3 %4 when %5 is %6.;NOR=%1 m† v‘re %2 i %3 %4 n†r %5 er %6.';
      Text019@1011 : TextConst 'ENU=You cannot change %1 because there are one or more open ledger entries for this item.;NOR=Du kan ikke slette %1 fordi det finnes ‚n eller flere †pne poster for denne varen.';
      Text020@1012 : TextConst 'ENU="There may be orders and open ledger entries for the item. ";NOR="Det kan finnes ordrer og †pne poster for denne varen. "';
      Text021@1013 : TextConst 'ENU=If you change %1 it may affect new orders and entries.\\;NOR=Hvis du endrer %1 kan det p†virke nye ordrer og poster.\\';
      Text022@1014 : TextConst 'ENU=Do you want to change %1?;NOR=Vil du endre %1?';
      GLSetup@1053 : Record 98;
      InvtSetup@1015 : Record 313;
      Text023@1066 : TextConst 'ENU=You cannot delete %1 %2 because there is at least one %3 that includes this item.;NOR=Du kan ikke slette %1 %2 fordi det finnes minst ‚n %3 som inkluderer varen.';
      Text024@1072 : TextConst 'ENU=If you change %1 it may affect existing production orders.\;NOR=Hvis du endrer %1, kan det ha innvirkning p† eksisterende produksjonsordrer.\';
      Text025@1055 : TextConst 'ENU=%1 must be an integer because %2 %3 is set up to use %4.;NOR=%1 m† v‘re et heltall fordi %2 %3 er konfigurert til † bruke %4.';
      Text026@1077 : TextConst 'ENU=%1 cannot be changed because the %2 has work in process (WIP). Changing the value may offset the WIP account.;NOR=%1 kan ikke endres ettersom %2 har varer i arbeid (VIA). Hvis du endrer verdien, kan VIA-kontoen bli motregnet.';
      Text7380@1058 : TextConst '@@@=If you change the Phys Invt Counting Period Code, the Next Counting Start Date and Next Counting End Date are calculated.\Do you still want to change the Phys Invt Counting Period Code?;ENU=If you change the %1, the %2 and %3 are calculated.\Do you still want to change the %1?;NOR=Hvis du endrer %1, beregnes %2 og %3.\Vil du fortsatt endre %1?';
      Text7381@1056 : TextConst 'ENU=Cancelled.;NOR=Avbrutt.';
      Text99000000@1017 : TextConst 'ENU=The change will not affect existing entries.\;NOR=Endringen p†virker ikke eksisterende poster.\';
      CommentLine@1018 : Record 97;
      Text99000001@1019 : TextConst 'ENU=If you want to generate %1 for existing entries, you must run a regenerative planning.;NOR=Hvis du vil generere %1 for eksisterende poster, m† du planlegge p† nytt.';
      ItemVend@1020 : Record 99;
      Text99000002@1021 : TextConst 'ENU=tracking,tracking and action messages;NOR=sporing,sporings- og handlingsmeldinger';
      SalesPrice@1022 : Record 7002;
      SalesLineDisc@1059 : Record 7004;
      SalesPrepmtPct@1051 : Record 459;
      PurchPrice@1060 : Record 7012;
      PurchLineDisc@1061 : Record 7014;
      PurchPrepmtPct@1076 : Record 460;
      ItemTranslation@1023 : Record 30;
      BOMComp@1024 : Record 90;
      PurchOrderLine@1025 : Record 39;
      SalesOrderLine@1026 : Record 37;
      VATPostingSetup@1027 : Record 325;
      ExtTextHeader@1028 : Record 279;
      GenProdPostingGrp@1029 : Record 251;
      ItemUnitOfMeasure@1030 : Record 5404;
      ItemVariant@1031 : Record 5401;
      ItemJnlLine@1007 : Record 83;
      ProdOrderLine@1032 : Record 5406;
      ProdOrderComp@1033 : Record 5407;
      PlanningAssignment@1035 : Record 99000850;
      SKU@1036 : Record 5700;
      ItemTrackingCode@1037 : Record 6502;
      ItemTrackingCode2@1038 : Record 6502;
      ServInvLine@1039 : Record 5902;
      ItemSub@1040 : Record 5715;
      TransLine@1042 : Record 5741;
      Vend@1016 : Record 23;
      NonstockItem@1034 : Record 5718;
      ProdBOMHeader@1062 : Record 99000771;
      ProdBOMLine@1063 : Record 99000772;
      ItemIdent@1065 : Record 7704;
      RequisitionLine@1067 : Record 246;
      ItemBudgetEntry@1075 : Record 7134;
      ItemAnalysisViewEntry@1074 : Record 7154;
      ItemAnalysisBudgViewEntry@1073 : Record 7156;
      TroubleshSetup@1050 : Record 5945;
      ServiceItem@1068 : Record 5940;
      ServiceContractLine@1069 : Record 5964;
      ServiceItemComponent@1070 : Record 5941;
      NoSeriesMgt@1043 : Codeunit 396;
      MoveEntries@1044 : Codeunit 361;
      DimMgt@1045 : Codeunit 408;
      NonstockItemMgt@1046 : Codeunit 5703;
      ItemCostMgt@1047 : Codeunit 5804;
      ResSkillMgt@1071 : Codeunit 5931;
      CalendarMgt@1054 : Codeunit 7600;
      ApprovalsMgmt@1085 : Codeunit 1535;
      HasInvtSetup@1049 : Boolean;
      GLSetupRead@1052 : Boolean;
      Text027@1078 : TextConst '@@@=starts with "Rounding Precision";ENU=must be greater than 0.;NOR=m† v‘re st›rre enn 0.';
      Text028@1080 : TextConst 'ENU=You cannot perform this action because entries for item %1 are unapplied in %2 by user %3.;NOR=Du kan ikke utf›re denne handlingen ettersom utligningen av poster for varen %1 er opphevet i %2 av brukeren %3.';
      CannotChangeFieldErr@1079 : TextConst '@@@="%1 = Field Caption, %2 = Item Table Name, %3 = Item No., %4 = Table Name";ENU=You cannot change the %1 field on %2 %3 because at least one %4 exists for this item.;NOR=Du kan ikke endre feltet %1 i %2 %3 fordi det finnes minst ‚n %4 for denne varen.';
      BaseUnitOfMeasureQtyMustBeOneErr@1081 : TextConst '@@@="%1 Name of Unit of measure (e.g. BOX, PCS, KG...), %2 Qty. of %1 per base unit of measure ";ENU=The quantity per base unit of measure must be 1. %1 is set up with %2 per unit of measure.\\You can change this setup in the Item Units of Measure window.;NOR=Antall per lagerenhet m† v‘re 1. %1 er definert med %2 per m†lenhet.\\Du kan endre dette oppsettet i Vareenheter-vinduet.';
      OpenDocumentTrackingErr@1082 : TextConst 'ENU="You cannot change ""Item Tracking Code"" because there is at least one open document that includes this item with specified tracking: Source Type = %1, Document No. = %2.";NOR="Du kan ikke endre varesporingskoden fordi det finnes minst ett †pent dokument som inneholder denne varen med angitt sporing: Kildetype = %1, dokumentnummer = %2."';
      SelectItemErr@1083 : TextConst 'ENU=You must select an existing item.;NOR=Du m† velge en eksisterende vare.';
      CreateNewItemTxt@1187 : TextConst '@@@="%1 is the name to be used to create the customer. ";ENU=Create a new item card for %1.;NOR=Opprett et nytt varekort for %1.';
      ItemNotRegisteredTxt@1186 : TextConst 'ENU=This item is not registered. To continue, choose one of the following options:;NOR=Denne varen er ikke registrert. Velg ett av f›lgende alternativer for † fortsette:';
      SelectItemTxt@1185 : TextConst 'ENU=Select an existing item.;NOR=Velg en eksisterende vare.';

    LOCAL PROCEDURE DeleteRelatedData@12();
    VAR
      BinContent@1002 : Record 7302;
      ItemCrossReference@1001 : Record 5717;
      SocialListeningSearchTopic@1000 : Record 871;
      MyItem@1003 : Record 9152;
    BEGIN
      ItemBudgetEntry.SETCURRENTKEY("Analysis Area","Budget Name","Item No.");
      ItemBudgetEntry.SETRANGE("Item No.","No.");
      ItemBudgetEntry.DELETEALL(TRUE);

      ItemSub.RESET;
      ItemSub.SETRANGE(Type,ItemSub.Type::Item);
      ItemSub.SETRANGE("No.","No.");
      ItemSub.DELETEALL;

      ItemSub.RESET;
      ItemSub.SETRANGE("Substitute Type",ItemSub."Substitute Type"::Item);
      ItemSub.SETRANGE("Substitute No.","No.");
      ItemSub.DELETEALL;

      SKU.RESET;
      SKU.SETCURRENTKEY("Item No.");
      SKU.SETRANGE("Item No.","No.");
      SKU.DELETEALL;

      NonstockItemMgt.NonstockItemDel(Rec);
      CommentLine.SETRANGE("Table Name",CommentLine."Table Name"::Item);
      CommentLine.SETRANGE("No.","No.");
      CommentLine.DELETEALL;

      ItemVend.SETCURRENTKEY("Item No.");
      ItemVend.SETRANGE("Item No.","No.");
      ItemVend.DELETEALL;

      SalesPrice.SETRANGE("Item No.","No.");
      SalesPrice.DELETEALL;

      SalesLineDisc.SETRANGE(Type,SalesLineDisc.Type::Item);
      SalesLineDisc.SETRANGE(Code,"No.");
      SalesLineDisc.DELETEALL;

      SalesPrepmtPct.SETRANGE("Item No.","No.");
      SalesPrepmtPct.DELETEALL;

      PurchPrice.SETRANGE("Item No.","No.");
      PurchPrice.DELETEALL;

      PurchLineDisc.SETRANGE("Item No.","No.");
      PurchLineDisc.DELETEALL;

      PurchPrepmtPct.SETRANGE("Item No.","No.");
      PurchPrepmtPct.DELETEALL;

      ItemTranslation.SETRANGE("Item No.","No.");
      ItemTranslation.DELETEALL;

      ItemUnitOfMeasure.SETRANGE("Item No.","No.");
      ItemUnitOfMeasure.DELETEALL;

      ItemVariant.SETRANGE("Item No.","No.");
      ItemVariant.DELETEALL;

      ExtTextHeader.SETRANGE("Table Name",ExtTextHeader."Table Name"::Item);
      ExtTextHeader.SETRANGE("No.","No.");
      ExtTextHeader.DELETEALL(TRUE);

      ItemAnalysisViewEntry.SETRANGE("Item No.","No.");
      ItemAnalysisViewEntry.DELETEALL;

      ItemAnalysisBudgViewEntry.SETRANGE("Item No.","No.");
      ItemAnalysisBudgViewEntry.DELETEALL;

      PlanningAssignment.SETRANGE("Item No.","No.");
      PlanningAssignment.DELETEALL;

      BOMComp.RESET;
      BOMComp.SETRANGE("Parent Item No.","No.");
      BOMComp.DELETEALL;

      TroubleshSetup.RESET;
      TroubleshSetup.SETRANGE(Type,TroubleshSetup.Type::Item);
      TroubleshSetup.SETRANGE("No.","No.");
      TroubleshSetup.DELETEALL;

      ResSkillMgt.DeleteItemResSkills("No.");
      DimMgt.DeleteDefaultDim(DATABASE::Item,"No.");

      ItemIdent.RESET;
      ItemIdent.SETCURRENTKEY("Item No.");
      ItemIdent.SETRANGE("Item No.","No.");
      ItemIdent.DELETEALL;

      ServiceItemComponent.RESET;
      ServiceItemComponent.SETRANGE(Type,ServiceItemComponent.Type::Item);
      ServiceItemComponent.SETRANGE("No.","No.");
      ServiceItemComponent.MODIFYALL("No.",'');

      BinContent.SETCURRENTKEY("Item No.");
      BinContent.SETRANGE("Item No.","No.");
      BinContent.DELETEALL;

      ItemCrossReference.SETRANGE("Item No.","No.");
      ItemCrossReference.DELETEALL;

      MyItem.SETRANGE("Item No.","No.");
      MyItem.DELETEALL;

      IF NOT SocialListeningSearchTopic.ISEMPTY THEN BEGIN
        SocialListeningSearchTopic.FindSearchTopic(SocialListeningSearchTopic."Source Type"::Item,"No.");
        SocialListeningSearchTopic.DELETEALL;
      END;
    END;

    PROCEDURE AssistEdit@2() : Boolean;
    BEGIN
      GetInvtSetup;
      InvtSetup.TESTFIELD("Item Nos.");
      IF NoSeriesMgt.SelectSeries(InvtSetup."Item Nos.",xRec."No. Series","No. Series") THEN BEGIN
        NoSeriesMgt.SetSeries("No.");
        EXIT(TRUE);
      END;
    END;

    PROCEDURE FindItemVend@5(VAR ItemVend@1000 : Record 99;LocationCode@1002 : Code[10]);
    VAR
      GetPlanningParameters@1004 : Codeunit 99000855;
    BEGIN
      TESTFIELD("No.");
      ItemVend.RESET;
      ItemVend.SETRANGE("Item No.","No.");
      ItemVend.SETRANGE("Vendor No.",ItemVend."Vendor No.");
      ItemVend.SETRANGE("Variant Code",ItemVend."Variant Code");

      IF NOT ItemVend.FIND('+') THEN BEGIN
        ItemVend."Item No." := "No.";
        ItemVend."Vendor Item No." := '';
        GetPlanningParameters.AtSKU(SKU,"No.",ItemVend."Variant Code",LocationCode);
        IF ItemVend."Vendor No." = '' THEN
          ItemVend."Vendor No." := SKU."Vendor No.";
        IF ItemVend."Vendor Item No." = '' THEN
          ItemVend."Vendor Item No." := SKU."Vendor Item No.";
        ItemVend."Lead Time Calculation" := SKU."Lead Time Calculation";
      END;
      IF FORMAT(ItemVend."Lead Time Calculation") = '' THEN
        IF Vend.GET(ItemVend."Vendor No.") THEN
          ItemVend."Lead Time Calculation" := Vend."Lead Time Calculation";
      ItemVend.RESET;
    END;

    LOCAL PROCEDURE ValidateShortcutDimCode@8(FieldNumber@1000 : Integer;VAR ShortcutDimCode@1001 : Code[20]);
    BEGIN
      DimMgt.ValidateDimValueCode(FieldNumber,ShortcutDimCode);
      DimMgt.SaveDefaultDim(DATABASE::Item,"No.",FieldNumber,ShortcutDimCode);
      MODIFY;
    END;

    LOCAL PROCEDURE TestNoEntriesExist@1006(CurrentFieldName@1000 : Text[100]);
    VAR
      ItemLedgEntry@1001 : Record 32;
    BEGIN
      ItemLedgEntry.SETCURRENTKEY("Item No.");
      ItemLedgEntry.SETRANGE("Item No.","No.");
      IF NOT ItemLedgEntry.ISEMPTY THEN
        ERROR(
          Text007,
          CurrentFieldName);

      PurchOrderLine.SETCURRENTKEY("Document Type",Type,"No.");
      PurchOrderLine.SETFILTER(
        "Document Type",'%1|%2',
        PurchOrderLine."Document Type"::Order,
        PurchOrderLine."Document Type"::"Return Order");
      PurchOrderLine.SETRANGE(Type,PurchOrderLine.Type::Item);
      PurchOrderLine.SETRANGE("No.","No.");
      IF PurchOrderLine.FINDFIRST THEN
        ERROR(
          Text008,
          CurrentFieldName,
          PurchOrderLine."Document Type");
    END;

    LOCAL PROCEDURE TestNoOpenEntriesExist@4(CurrentFieldName@1000 : Text[100]);
    VAR
      ItemLedgEntry@1001 : Record 32;
    BEGIN
      ItemLedgEntry.SETCURRENTKEY("Item No.",Open);
      ItemLedgEntry.SETRANGE("Item No.","No.");
      ItemLedgEntry.SETRANGE(Open,TRUE);
      IF NOT ItemLedgEntry.ISEMPTY THEN
        ERROR(
          Text019,
          CurrentFieldName);
    END;

    LOCAL PROCEDURE TestNoOpenDocumentsWithTrackingExist@42();
    VAR
      TrackingSpecification@1000 : Record 336;
      ReservationEntry@1001 : Record 337;
      RecRef@1004 : RecordRef;
      SourceType@1002 : Integer;
      SourceID@1003 : Code[20];
    BEGIN
      IF ItemTrackingCode2.Code = '' THEN
        EXIT;

      TrackingSpecification.SETRANGE("Item No.","No.");
      IF TrackingSpecification.FINDFIRST THEN BEGIN
        SourceType := TrackingSpecification."Source Type";
        SourceID := TrackingSpecification."Source ID";
      END ELSE BEGIN
        ReservationEntry.SETRANGE("Item No.","No.");
        ReservationEntry.SETFILTER("Item Tracking",'<>%1',ReservationEntry."Item Tracking"::None);
        IF ReservationEntry.FINDFIRST THEN BEGIN
          SourceType := ReservationEntry."Source Type";
          SourceID := ReservationEntry."Source ID";
        END;
      END;

      IF SourceType = 0 THEN
        EXIT;

      RecRef.OPEN(SourceType);
      ERROR(OpenDocumentTrackingErr,RecRef.CAPTION,SourceID);
    END;

    PROCEDURE ItemSKUGet@11(VAR Item@1000 : Record 27;LocationCode@1001 : Code[10];VariantCode@1002 : Code[10]);
    VAR
      SKU@1003 : Record 5700;
    BEGIN
      IF Item.GET("No.") THEN BEGIN
        IF SKU.GET(LocationCode,Item."No.",VariantCode) THEN
          Item."Shelf No." := SKU."Shelf No.";
      END;
    END;

    LOCAL PROCEDURE GetInvtSetup@14();
    BEGIN
      IF NOT HasInvtSetup THEN BEGIN
        InvtSetup.GET;
        HasInvtSetup := TRUE;
      END;
    END;

    PROCEDURE IsMfgItem@1() : Boolean;
    BEGIN
      EXIT("Replenishment System" = "Replenishment System"::"Prod. Order");
    END;

    PROCEDURE IsAssemblyItem@24() : Boolean;
    BEGIN
      EXIT("Replenishment System" = "Replenishment System"::Assembly);
    END;

    PROCEDURE HasBOM@18() : Boolean;
    BEGIN
      CALCFIELDS("Assembly BOM");
      EXIT("Assembly BOM" OR ("Production BOM No." <> ''));
    END;

    LOCAL PROCEDURE GetGLSetup@6();
    BEGIN
      IF NOT GLSetupRead THEN
        GLSetup.GET;
      GLSetupRead := TRUE;
    END;

    LOCAL PROCEDURE ProdOrderExist@7() : Boolean;
    BEGIN
      ProdOrderLine.SETCURRENTKEY(Status,"Item No.");
      ProdOrderLine.SETFILTER(Status,'..%1',ProdOrderLine.Status::Released);
      ProdOrderLine.SETRANGE("Item No.","No.");
      IF NOT ProdOrderLine.ISEMPTY THEN
        EXIT(TRUE);

      EXIT(FALSE);
    END;

    PROCEDURE CheckSerialNoQty@15(ItemNo@1000 : Code[20];FieldName@1001 : Text[30];Quantity@1002 : Decimal);
    VAR
      ItemRec@1003 : Record 27;
      ItemTrackingCode3@1004 : Record 6502;
    BEGIN
      IF Quantity = ROUND(Quantity,1) THEN
        EXIT;
      IF NOT ItemRec.GET(ItemNo) THEN
        EXIT;
      IF ItemRec."Item Tracking Code" = '' THEN
        EXIT;
      IF NOT ItemTrackingCode3.GET(ItemRec."Item Tracking Code") THEN
        EXIT;
      IF ItemTrackingCode3."SN Specific Tracking" THEN
        ERROR(Text025,
          FieldName,
          TABLECAPTION,
          ItemNo,
          ItemTrackingCode3.FIELDCAPTION("SN Specific Tracking"));
    END;

    LOCAL PROCEDURE CheckForProductionOutput@17(ItemNo@1000 : Code[20]);
    VAR
      ItemLedgEntry@1001 : Record 32;
    BEGIN
      CLEAR(ItemLedgEntry);
      ItemLedgEntry.SETCURRENTKEY("Item No.","Entry Type","Variant Code","Drop Shipment","Location Code","Posting Date");
      ItemLedgEntry.SETRANGE("Item No.",ItemNo);
      ItemLedgEntry.SETRANGE("Entry Type",ItemLedgEntry."Entry Type"::Output);
      IF NOT ItemLedgEntry.ISEMPTY THEN
        ERROR(Text026,FIELDCAPTION("Inventory Value Zero"),TABLECAPTION);
    END;

    PROCEDURE CheckBlockedByApplWorksheet@19();
    VAR
      ApplicationWorksheet@1000 : Page 521;
    BEGIN
      IF "Application Wksh. User ID" <> '' THEN
        ERROR(Text028,"No.",ApplicationWorksheet.CAPTION,"Application Wksh. User ID");
    END;

    PROCEDURE ShowTimelineFromItem@20(VAR Item@1000 : Record 27);
    VAR
      ItemAvailByTimeline@1001 : Page 5540;
    BEGIN
      ItemAvailByTimeline.SetItem(Item);
      ItemAvailByTimeline.RUN;
    END;

    PROCEDURE ShowTimelineFromSKU@21(ItemNo@1000 : Code[20];LocationCode@1001 : Code[10];VariantCode@1002 : Code[10]);
    VAR
      Item@1003 : Record 27;
    BEGIN
      Item.GET(ItemNo);
      Item.SETRANGE("No.",Item."No.");
      Item.SETRANGE("Variant Filter",VariantCode);
      Item.SETRANGE("Location Filter",LocationCode);
      ShowTimelineFromItem(Item);
    END;

    LOCAL PROCEDURE CheckJournalsAndWorksheets@22(CurrFieldNo@1001 : Integer);
    BEGIN
      CheckItemJnlLine(CurrFieldNo);
      CheckStdCostWksh(CurrFieldNo);
      CheckReqLine(CurrFieldNo);
    END;

    LOCAL PROCEDURE CheckItemJnlLine@44(CurrFieldNo@1000 : Integer);
    BEGIN
      ItemJnlLine.SETRANGE("Item No.","No.");
      IF NOT ItemJnlLine.ISEMPTY THEN BEGIN
        IF CurrFieldNo = 0 THEN
          ERROR(Text023,TABLECAPTION,"No.",ItemJnlLine.TABLECAPTION);
        IF CurrFieldNo = FIELDNO(Type) THEN
          ERROR(CannotChangeFieldErr,FIELDCAPTION(Type),TABLECAPTION,"No.",ItemJnlLine.TABLECAPTION);
      END;
    END;

    LOCAL PROCEDURE CheckStdCostWksh@45(CurrFieldNo@1000 : Integer);
    VAR
      StdCostWksh@1001 : Record 5841;
    BEGIN
      StdCostWksh.RESET;
      StdCostWksh.SETRANGE(Type,StdCostWksh.Type::Item);
      StdCostWksh.SETRANGE("No.","No.");
      IF NOT StdCostWksh.ISEMPTY THEN
        IF CurrFieldNo = 0 THEN
          ERROR(Text023,TABLECAPTION,"No.",StdCostWksh.TABLECAPTION);
    END;

    LOCAL PROCEDURE CheckReqLine@46(CurrFieldNo@1000 : Integer);
    BEGIN
      RequisitionLine.SETCURRENTKEY(Type,"No.");
      RequisitionLine.SETRANGE(Type,RequisitionLine.Type::Item);
      RequisitionLine.SETRANGE("No.","No.");
      IF NOT RequisitionLine.ISEMPTY THEN BEGIN
        IF CurrFieldNo = 0 THEN
          ERROR(Text023,TABLECAPTION,"No.",RequisitionLine.TABLECAPTION);
        IF CurrFieldNo = FIELDNO(Type) THEN
          ERROR(CannotChangeFieldErr,FIELDCAPTION(Type),TABLECAPTION,"No.",RequisitionLine.TABLECAPTION);
      END;
    END;

    LOCAL PROCEDURE CheckDocuments@23(CurrFieldNo@1002 : Integer);
    BEGIN
      CheckBOM(CurrFieldNo);
      CheckPurchLine(CurrFieldNo);
      CheckSalesLine(CurrFieldNo);
      CheckProdOrderLine(CurrFieldNo);
      CheckProdOrderCompLine(CurrFieldNo);
      CheckPlanningCompLine(CurrFieldNo);
      CheckTransLine(CurrFieldNo);
      CheckServLine(CurrFieldNo);
      CheckProdBOMLine(CurrFieldNo);
      CheckServContractLine(CurrFieldNo);
      CheckAsmHeader(CurrFieldNo);
      CheckAsmLine(CurrFieldNo);
      CheckJobPlanningLine(CurrFieldNo);
    END;

    LOCAL PROCEDURE CheckBOM@25(CurrFieldNo@1000 : Integer);
    BEGIN
      BOMComp.RESET;
      BOMComp.SETCURRENTKEY(Type,"No.");
      BOMComp.SETRANGE(Type,BOMComp.Type::Item);
      BOMComp.SETRANGE("No.","No.");
      IF NOT BOMComp.ISEMPTY THEN BEGIN
        IF CurrFieldNo = 0 THEN
          ERROR(Text023,TABLECAPTION,"No.",BOMComp.TABLECAPTION);
        IF CurrFieldNo = FIELDNO(Type) THEN
          ERROR(CannotChangeFieldErr,FIELDCAPTION(Type),TABLECAPTION,"No.",BOMComp.TABLECAPTION);
      END;
    END;

    LOCAL PROCEDURE CheckPurchLine@26(CurrFieldNo@1000 : Integer);
    BEGIN
      PurchOrderLine.SETCURRENTKEY(Type,"No.");
      PurchOrderLine.SETRANGE(Type,PurchOrderLine.Type::Item);
      PurchOrderLine.SETRANGE("No.","No.");
      IF NOT PurchOrderLine.ISEMPTY THEN BEGIN
        IF CurrFieldNo = 0 THEN
          ERROR(Text000,TABLECAPTION,"No.",PurchOrderLine."Document Type");
        IF CurrFieldNo = FIELDNO(Type) THEN
          ERROR(CannotChangeFieldErr,FIELDCAPTION(Type),TABLECAPTION,"No.",PurchOrderLine.TABLECAPTION);
      END;
    END;

    LOCAL PROCEDURE CheckSalesLine@28(CurrFieldNo@1000 : Integer);
    BEGIN
      SalesOrderLine.SETCURRENTKEY(Type,"No.");
      SalesOrderLine.SETRANGE(Type,SalesOrderLine.Type::Item);
      SalesOrderLine.SETRANGE("No.","No.");
      IF NOT SalesOrderLine.ISEMPTY THEN BEGIN
        IF CurrFieldNo = 0 THEN
          ERROR(Text001,TABLECAPTION,"No.",SalesOrderLine."Document Type");
        IF CurrFieldNo = FIELDNO(Type) THEN
          ERROR(CannotChangeFieldErr,FIELDCAPTION(Type),TABLECAPTION,"No.",SalesOrderLine.TABLECAPTION);
      END;
    END;

    LOCAL PROCEDURE CheckProdOrderLine@39(CurrFieldNo@1000 : Integer);
    BEGIN
      IF ProdOrderExist THEN BEGIN
        IF CurrFieldNo = 0 THEN
          ERROR(Text002,TABLECAPTION,"No.");
        IF CurrFieldNo = FIELDNO(Type) THEN
          ERROR(CannotChangeFieldErr,FIELDCAPTION(Type),TABLECAPTION,"No.",ProdOrderLine.TABLECAPTION);
      END;
    END;

    LOCAL PROCEDURE CheckProdOrderCompLine@31(CurrFieldNo@1000 : Integer);
    BEGIN
      ProdOrderComp.SETCURRENTKEY(Status,"Item No.");
      ProdOrderComp.SETFILTER(Status,'..%1',ProdOrderComp.Status::Released);
      ProdOrderComp.SETRANGE("Item No.","No.");
      IF NOT ProdOrderComp.ISEMPTY THEN BEGIN
        IF CurrFieldNo = 0 THEN
          ERROR(Text014,TABLECAPTION,"No.");
        IF CurrFieldNo = FIELDNO(Type) THEN
          ERROR(CannotChangeFieldErr,FIELDCAPTION(Type),TABLECAPTION,"No.",ProdOrderComp.TABLECAPTION);
      END;
    END;

    LOCAL PROCEDURE CheckPlanningCompLine@38(CurrFieldNo@1000 : Integer);
    VAR
      PlanningComponent@1005 : Record 99000829;
    BEGIN
      PlanningComponent.SETCURRENTKEY("Item No.","Variant Code","Location Code","Due Date","Planning Line Origin");
      PlanningComponent.SETRANGE("Item No.","No.");
      IF NOT PlanningComponent.ISEMPTY THEN BEGIN
        IF CurrFieldNo = 0 THEN
          ERROR(Text023,TABLECAPTION,"No.",PlanningComponent.TABLECAPTION);
        IF CurrFieldNo = FIELDNO(Type) THEN
          ERROR(CannotChangeFieldErr,FIELDCAPTION(Type),TABLECAPTION,"No.",PlanningComponent.TABLECAPTION);
      END;
    END;

    LOCAL PROCEDURE CheckTransLine@37(CurrFieldNo@1000 : Integer);
    BEGIN
      TransLine.SETCURRENTKEY("Item No.");
      TransLine.SETRANGE("Item No.","No.");
      IF NOT TransLine.ISEMPTY THEN BEGIN
        IF CurrFieldNo = 0 THEN
          ERROR(Text016,TABLECAPTION,"No.");
        IF CurrFieldNo = FIELDNO(Type) THEN
          ERROR(CannotChangeFieldErr,FIELDCAPTION(Type),TABLECAPTION,"No.",TransLine.TABLECAPTION);
      END;
    END;

    LOCAL PROCEDURE CheckServLine@36(CurrFieldNo@1000 : Integer);
    BEGIN
      ServInvLine.RESET;
      ServInvLine.SETCURRENTKEY(Type,"No.");
      ServInvLine.SETRANGE(Type,ServInvLine.Type::Item);
      ServInvLine.SETRANGE("No.","No.");
      IF NOT ServInvLine.ISEMPTY THEN BEGIN
        IF CurrFieldNo = 0 THEN
          ERROR(Text017,TABLECAPTION,"No.",ServInvLine."Document Type");
        IF CurrFieldNo = FIELDNO(Type) THEN
          ERROR(CannotChangeFieldErr,FIELDCAPTION(Type),TABLECAPTION,"No.",ServInvLine.TABLECAPTION);
      END;
    END;

    LOCAL PROCEDURE CheckProdBOMLine@30(CurrFieldNo@1000 : Integer);
    BEGIN
      ProdBOMLine.RESET;
      ProdBOMLine.SETCURRENTKEY(Type,"No.");
      ProdBOMLine.SETRANGE(Type,ProdBOMLine.Type::Item);
      ProdBOMLine.SETRANGE("No.","No.");
      IF ProdBOMLine.FIND('-') THEN BEGIN
        IF CurrFieldNo = FIELDNO(Type) THEN
          ERROR(CannotChangeFieldErr,FIELDCAPTION(Type),TABLECAPTION,"No.",ProdBOMLine.TABLECAPTION);
        IF CurrFieldNo = 0 THEN
          REPEAT
            IF ProdBOMHeader.GET(ProdBOMLine."Production BOM No.") AND
               (ProdBOMHeader.Status = ProdBOMHeader.Status::Certified)
            THEN
              ERROR(Text004,TABLECAPTION,"No.");
          UNTIL ProdBOMLine.NEXT = 0;
      END;
    END;

    LOCAL PROCEDURE CheckServContractLine@35(CurrFieldNo@1000 : Integer);
    BEGIN
      ServiceContractLine.RESET;
      ServiceContractLine.SETRANGE("Item No.","No.");
      IF NOT ServiceContractLine.ISEMPTY THEN BEGIN
        IF CurrFieldNo = 0 THEN
          ERROR(Text023,TABLECAPTION,"No.",ServiceContractLine.TABLECAPTION);
        IF CurrFieldNo = FIELDNO(Type) THEN
          ERROR(CannotChangeFieldErr,FIELDCAPTION(Type),TABLECAPTION,"No.",ServiceContractLine.TABLECAPTION);
      END;
    END;

    LOCAL PROCEDURE CheckAsmHeader@32(CurrFieldNo@1000 : Integer);
    VAR
      AsmHeader@1004 : Record 900;
    BEGIN
      AsmHeader.SETCURRENTKEY("Document Type","Item No.");
      AsmHeader.SETRANGE("Item No.","No.");
      IF NOT AsmHeader.ISEMPTY THEN BEGIN
        IF CurrFieldNo = 0 THEN
          ERROR(Text023,TABLECAPTION,"No.",AsmHeader.TABLECAPTION);
        IF CurrFieldNo = FIELDNO(Type) THEN
          ERROR(CannotChangeFieldErr,FIELDCAPTION(Type),TABLECAPTION,"No.",AsmHeader.TABLECAPTION);
      END;
    END;

    LOCAL PROCEDURE CheckAsmLine@27(CurrFieldNo@1000 : Integer);
    VAR
      AsmLine@1003 : Record 901;
    BEGIN
      AsmLine.SETCURRENTKEY(Type,"No.");
      AsmLine.SETRANGE(Type,AsmLine.Type::Item);
      AsmLine.SETRANGE("No.","No.");
      IF NOT AsmLine.ISEMPTY THEN BEGIN
        IF CurrFieldNo = 0 THEN
          ERROR(Text023,TABLECAPTION,"No.",AsmLine.TABLECAPTION);
        IF CurrFieldNo = FIELDNO(Type) THEN
          ERROR(CannotChangeFieldErr,FIELDCAPTION(Type),TABLECAPTION,"No.",AsmLine.TABLECAPTION);
      END;
    END;

    PROCEDURE PreventNegativeInventory@33() : Boolean;
    VAR
      InventorySetup@1000 : Record 313;
    BEGIN
      CASE "Prevent Negative Inventory" OF
        "Prevent Negative Inventory"::Yes:
          EXIT(TRUE);
        "Prevent Negative Inventory"::No:
          EXIT(FALSE);
        "Prevent Negative Inventory"::Default:
          BEGIN
            InventorySetup.GET;
            EXIT(InventorySetup."Prevent Negative Inventory");
          END;
      END;
    END;

    LOCAL PROCEDURE CheckJobPlanningLine@34(CurrFieldNo@1000 : Integer);
    VAR
      JobPlanningLine@1001 : Record 1003;
    BEGIN
      JobPlanningLine.SETCURRENTKEY(Type,"No.");
      JobPlanningLine.SETRANGE(Type,JobPlanningLine.Type::Item);
      JobPlanningLine.SETRANGE("No.","No.");
      IF NOT JobPlanningLine.ISEMPTY THEN BEGIN
        IF CurrFieldNo = 0 THEN
          ERROR(Text023,TABLECAPTION,"No.",JobPlanningLine.TABLECAPTION);
        IF CurrFieldNo = FIELDNO(Type) THEN
          ERROR(CannotChangeFieldErr,FIELDCAPTION(Type),TABLECAPTION,"No.",JobPlanningLine.TABLECAPTION);
      END;
    END;

    LOCAL PROCEDURE CalcVAT@40() : Decimal;
    BEGIN
      IF "Price Includes VAT" THEN BEGIN
        VATPostingSetup.GET("VAT Bus. Posting Gr. (Price)","VAT Prod. Posting Group");
        CASE VATPostingSetup."VAT Calculation Type" OF
          VATPostingSetup."VAT Calculation Type"::"Reverse Charge VAT":
            VATPostingSetup."VAT %" := 0;
          VATPostingSetup."VAT Calculation Type"::"Sales Tax":
            ERROR(
              Text006,
              VATPostingSetup.FIELDCAPTION("VAT Calculation Type"),
              VATPostingSetup."VAT Calculation Type");
        END;
      END ELSE
        CLEAR(VATPostingSetup);

      EXIT(VATPostingSetup."VAT %" / 100);
    END;

    PROCEDURE CalcUnitPriceExclVAT@41() : Decimal;
    BEGIN
      GetGLSetup;
      IF 1 + CalcVAT = 0 THEN
        EXIT(0);
      EXIT(ROUND("Unit Price" / (1 + CalcVAT),GLSetup."Unit-Amount Rounding Precision"));
    END;

    PROCEDURE GetItemNo@10(ItemText@1000 : Text) : Code[20];
    VAR
      ItemNo@1001 : Text[50];
    BEGIN
      TryGetItemNo(ItemNo,ItemText,TRUE);
      EXIT(COPYSTR(ItemNo,1,MAXSTRLEN("No.")));
    END;

    PROCEDURE TryGetItemNo@9(VAR ReturnValue@1007 : Text[50];ItemText@1000 : Text;DefaultCreate@1006 : Boolean) : Boolean;
    VAR
      Item@1001 : Record 27;
      ItemNo@1002 : Code[20];
      ItemWithoutQuote@1005 : Text;
      ItemFilterFromStart@1004 : Text;
      ItemFilterContains@1003 : Text;
    BEGIN
      ReturnValue := COPYSTR(ItemText,1,MAXSTRLEN(ReturnValue));
      IF ItemText = '' THEN
        EXIT(DefaultCreate);

      IF STRLEN(ItemText) <= MAXSTRLEN(Item."No.") THEN
        IF Item.GET(COPYSTR(ItemText,1,MAXSTRLEN(Item."No."))) THEN BEGIN
          ReturnValue := Item."No.";
          EXIT(TRUE);
        END;

      ItemWithoutQuote := CONVERTSTR(ItemText,'''','?');

      Item.SETFILTER(Description,'''@' + ItemWithoutQuote + '''');
      IF Item.FINDFIRST THEN BEGIN
        ReturnValue := Item."No.";
        EXIT(TRUE);
      END;
      Item.SETRANGE(Description);

      ItemFilterFromStart := '''@' + ItemWithoutQuote + '*''';

      Item.FILTERGROUP := -1;
      Item.SETFILTER("No.",ItemFilterFromStart);
      Item.SETFILTER(Description,ItemFilterFromStart);
      IF Item.FINDFIRST THEN BEGIN
        ReturnValue := Item."No.";
        EXIT(TRUE);
      END;

      ItemFilterContains := '''@*' + ItemWithoutQuote + '*''';

      Item.SETFILTER("No.",ItemFilterContains);
      Item.SETFILTER(Description,ItemFilterContains);
      Item.SETFILTER("Base Unit of Measure",ItemFilterContains);

      IF Item.COUNT = 0 THEN
        MarkItemsWithSimilarName(Item,ItemText);

      IF Item.COUNT = 1 THEN BEGIN
        Item.FINDFIRST;
        ReturnValue := Item."No.";
        EXIT(TRUE);
      END;

      IF Item.COUNT = 0 THEN BEGIN
        IF NOT DefaultCreate THEN
          EXIT(FALSE);

        IF NOT GUIALLOWED THEN
          ERROR(SelectItemErr);

        IF Item.WRITEPERMISSION THEN
          CASE STRMENU(
                 STRSUBSTNO('%1,%2',STRSUBSTNO(CreateNewItemTxt,CONVERTSTR(ItemText,',','.')),SelectItemTxt),1,ItemNotRegisteredTxt)
          OF
            0:
              ERROR(SelectItemErr);
            1:
              BEGIN
                ReturnValue := CreateNewItem(COPYSTR(ItemText,1,MAXSTRLEN(Item.Description)));
                EXIT(TRUE);
              END;
          END;
        Item.RESET;
      END;

      IF NOT GUIALLOWED THEN
        ERROR(SelectItemErr);

      ItemNo := PickItem(Item);
      IF ItemNo <> '' THEN BEGIN
        ReturnValue := ItemNo;
        EXIT(TRUE);
      END;

      IF NOT DefaultCreate THEN
        EXIT(FALSE);
      ERROR(SelectItemErr);
    END;

    LOCAL PROCEDURE MarkItemsWithSimilarName@13(VAR Item@1001 : Record 27;ItemText@1000 : Text);
    VAR
      TypeHelper@1002 : Codeunit 10;
      ItemCount@1003 : Integer;
      ItemTextLenght@1004 : Integer;
      Treshold@1005 : Integer;
    BEGIN
      IF ItemText = '' THEN
        EXIT;
      IF STRLEN(ItemText) > MAXSTRLEN(Item.Description) THEN
        EXIT;
      ItemTextLenght := STRLEN(ItemText);
      Treshold := ItemTextLenght DIV 5;
      IF Treshold = 0 THEN
        EXIT;

      Item.RESET;
      Item.ASCENDING(FALSE); // most likely to search for newest Items
      IF Item.FINDSET THEN
        REPEAT
          ItemCount += 1;
          IF ABS(ItemTextLenght - STRLEN(Item.Description)) <= Treshold THEN
            IF TypeHelper.TextDistance(UPPERCASE(ItemText),UPPERCASE(Item.Description)) <= Treshold THEN
              Item.MARK(TRUE);
        UNTIL Item.MARK OR (Item.NEXT = 0) OR (ItemCount > 1000);
      Item.MARKEDONLY(TRUE);
    END;

    LOCAL PROCEDURE CreateNewItem@3(ItemName@1000 : Text[50]) : Code[20];
    VAR
      Item@1005 : Record 27;
      ItemTemplate@1006 : Record 1301;
      ItemCard@1002 : Page 30;
    BEGIN
      IF NOT ItemTemplate.NewItemFromTemplate(Item) THEN
        ERROR(SelectItemErr);

      Item.Description := ItemName;
      Item.MODIFY(TRUE);
      COMMIT;
      Item.SETRANGE("No.",Item."No.");
      ItemCard.SETTABLEVIEW(Item);
      IF NOT (ItemCard.RUNMODAL = ACTION::OK) THEN
        ERROR(SelectItemErr);

      EXIT(Item."No.");
    END;

    LOCAL PROCEDURE PickItem@51(VAR Item@1000 : Record 27) : Code[20];
    VAR
      ItemList@1001 : Page 31;
    BEGIN
      IF Item.FINDSET THEN
        REPEAT
          Item.MARK(TRUE);
        UNTIL Item.NEXT = 0;
      IF Item.FINDFIRST THEN;
      Item.MARKEDONLY := TRUE;

      ItemList.SETTABLEVIEW(Item);
      ItemList.SETRECORD(Item);
      ItemList.LOOKUPMODE := TRUE;
      IF ItemList.RUNMODAL = ACTION::LookupOK THEN
        ItemList.GETRECORD(Item)
      ELSE
        CLEAR(Item);

      EXIT(Item."No.");
    END;

    LOCAL PROCEDURE SetLastDateTimeModified@16();
    VAR
      DateFilterCalc@1000 : Codeunit 358;
      Now@1001 : DateTime;
    BEGIN
      Now := DateFilterCalc.ConvertToUtcDateTime(CURRENTDATETIME);
      "Last Date Modified" := DT2DATE(Now);
      "Last Time Modified" := DT2TIME(Now);
    END;

    PROCEDURE SetLastDateTimeFilter@29(DateFilter@1001 : DateTime);
    VAR
      DateFilterCalc@1004 : Codeunit 358;
      SyncDateTimeUtc@1002 : DateTime;
      CurrentFilterGroup@1003 : Integer;
    BEGIN
      SyncDateTimeUtc := DateFilterCalc.ConvertToUtcDateTime(DateFilter);
      CurrentFilterGroup := FILTERGROUP;
      SETFILTER("Last Date Modified",'>=%1',DT2DATE(SyncDateTimeUtc));
      FILTERGROUP(-1);
      SETFILTER("Last Date Modified",'>%1',DT2DATE(SyncDateTimeUtc));
      SETFILTER("Last Time Modified",'>%1',DT2TIME(SyncDateTimeUtc));
      FILTERGROUP(CurrentFilterGroup);
    END;

    BEGIN
    END.
  }
}

OBJECT Table 53200 Document Module Setup
{
  OBJECT-PROPERTIES
  {
    Date=27.10.16;
    Time=10:23:27;
    Modified=Yes;
    Version List=DOC1.0;
  }
  PROPERTIES
  {
  }
  FIELDS
  {
    { 1   ;   ;Primary Key         ;Code10        ;CaptionML=[ENU=Primary Key;
                                                              NOR=Primrnkkel] }
    { 2   ;   ;Filename No. Series ;Code20        ;TableRelation="No. Series";
                                                   CaptionML=[ENU=Filename No. Series;
                                                              NOR=Filnavn nr.serie] }
    { 3   ;   ;Storage Location    ;Text250       ;CaptionML=[ENU=Storage Location;
                                                              NOR=Filsti] }
    { 10  ;   ;Storage Type        ;Option        ;CaptionML=[ENU=Storage Type;
                                                              NOR=Lagringstype];
                                                   OptionCaptionML=[ENU=Disk File,Embedded;
                                                                    NOR=Fil p disk,I database];
                                                   OptionString=Disk File,Embedded }
    { 20  ;   ;Add To Record Link  ;Boolean       ;OnValidate=BEGIN
                                                                IF Rec."Add To Record Link" THEN BEGIN
                                                                  TESTFIELD("Use Attachment Table", FALSE);
                                                                  TESTFIELD("Storage Type", Rec."Storage Type"::"Disk File");
                                                                  TESTFIELD("Storage Location");
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Add To Record Link;
                                                              NOR=Legge fil til Koblinger] }
    { 30  ;   ;Use Attachment Table;Boolean       ;OnValidate=BEGIN
                                                                IF "Use Attachment Table" THEN
                                                                  TESTFIELD("Storage Type", Rec."Storage Type"::Embedded);
                                                              END;

                                                   CaptionML=[ENU=Use Attachment Table;
                                                              NOR=Bruke Vedlegg tabellen] }
    { 40  ;   ;Add To Interaction Log;Boolean     ;CaptionML=[ENU=Add Interaction Log Entry;
                                                              NOR=Legg til Samhandlingspost] }
    { 50  ;   ;Add Line To Support Task;Boolean   ;CaptionML=[ENU=Add Line To Support Task;
                                                              NOR=Legg til Supportlinje] }
    { 60  ;   ;Interaction Template Code;Code10   ;TableRelation="Interaction Template";
                                                   CaptionML=[ENU=Interaction Template Code;
                                                              NOR=Samhandlingsmal - kode] }
  }
  KEYS
  {
    {    ;Primary Key                             ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Table 53201 Document Module Documents
{
  OBJECT-PROPERTIES
  {
    Date=25.10.16;
    Time=15:35:16;
    Modified=Yes;
    Version List=DOC1.0;
  }
  PROPERTIES
  {
    OnDelete=VAR
               RecRef@1101103000 : RecordRef;
             BEGIN
               RecRef.OPEN("Table No.");
               IF RecRef.GET(RecordID) THEN
                 RecRef.DELETELINK("Link ID");
             END;

    CaptionML=[ENU=Document Module Documents;
               NOR=Dokumentmodul dokumenter];
  }
  FIELDS
  {
    { 1   ;   ;Table No.           ;Integer       ;TableRelation=Object.ID WHERE (Type=CONST(Table)) }
    { 2   ;   ;Line No.            ;Integer       ;CaptionML=[ENU=Line No.;
                                                              NOR=Linjenr.] }
    { 3   ;   ;RecordID            ;RecordID      ;CaptionML=[ENU=Record ID;
                                                              NOR=Record ID] }
    { 7   ;   ;Description         ;Text250       ;CaptionML=[ENU=Description;
                                                              NOR=Beskrivelse] }
    { 10  ;   ;Storage Type        ;Option        ;CaptionML=[ENU=Storage Type;
                                                              NOR=Lagringstype];
                                                   OptionCaptionML=[ENU=Disk File,Embedded;
                                                                    NOR=Fil p disk,I database];
                                                   OptionString=Disk File,Embedded }
    { 11  ;   ;Attachment          ;BLOB          ;CaptionML=[ENU=Attachment;
                                                              NOR=Vedlegg] }
    { 12  ;   ;Filename No.        ;Code100       ;CaptionML=[ENU=Filename No.;
                                                              NOR=Filnavn nr.] }
    { 13  ;   ;File Extension      ;Text30        ;CaptionML=[ENU=File Extension;
                                                              NOR=Filtype] }
    { 14  ;   ;Date                ;Date          ;CaptionML=[ENU=Date;
                                                              NOR=Dato];
                                                   Editable=No }
    { 15  ;   ;Time                ;Time          ;CaptionML=[ENU=Time;
                                                              NOR=Tid];
                                                   Editable=No }
    { 16  ;   ;Size                ;Integer       ;CaptionML=[ENU=Size;
                                                              NOR=Strrelse] }
    { 17  ;   ;Storage Pointer     ;Text250       ;OnValidate=BEGIN
                                                                IF COPYSTR("Storage Pointer", STRLEN("Storage Pointer"), 1) <> '\' THEN
                                                                BEGIN
                                                                  "Storage Pointer" += '\';
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Storage Pointer;
                                                              NOR=Lagringssti] }
    { 18  ;   ;Read Only           ;Boolean       ;CaptionML=[ENU=Read Only;
                                                              NOR=Skrivebeskyttet] }
    { 30  ;   ;Link ID             ;Integer        }
    { 200 ;   ;Attachment No.      ;Integer       ;CaptionML=[ENU=Attachment No.;
                                                              NOR=Vedleggnr.] }
  }
  KEYS
  {
    {    ;Table No.,RecordID,Line No.             ;Clustered=Yes }
    {    ;Link ID                                  }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      DocumentModuleSetupG@1101103003 : Record 53200;
      FileMgt@1101103001 : Codeunit 419;
      DocModuleMgt@1101103000 : Codeunit 53201;
      Text002@1101103016 : TextConst 'ENU=The attachment is empty.;NOR=Vedlegget er tomt.';
      Text003@1101103015 : TextConst 'ENU=Attachment is already in use on this machine.;NOR=Vedlegget er allerede i bruk p denne maskinen.';
      Text004@1101103014 : TextConst 'ENU=When you have saved your document, click Yes to import the document.;NOR=Nr du har lagret dokumentet, klikker du p Ja for  lese det inn.';
      Text005@1101103013 : TextConst 'ENU=Export Attachment;NOR=Les ut vedlegg';
      Text006@1101103012 : TextConst 'ENU=Import Attachment;NOR=Importer vedlegg';
      Text007@1101103011 : TextConst 'ENU=All Files (*.*)|*.*;NOR=Alle filer (*.*)|*.*';
      Text008@1101103010 : TextConst 'ENU=Error during copying file: %1.;NOR=Feil ved kopiering av fil: %1';
      Text009@1101103009 : TextConst 'ENU=Do you want to remove %1?;NOR=Vil du fjerne %1?';
      Text010@1101103008 : TextConst 'ENU=External file could not be removed.;NOR=Ekstern fil kunne ikke fjernes.';
      NoSeriesMgt@1101103004 : Codeunit 396;

    PROCEDURE ImportAttachmentFromClientFile@5(RecordRefP@1101103003 : RecordRef;ClientFileNameP@1000 : Text;IsTemporaryP@1001 : Boolean;VAR AttachmentNoP@1101103004 : Integer;VAR InteractionLogEntryNoP@1101103002 : Integer) : Boolean;
    VAR
      FileNameL@1005 : Text;
      ServerFileNameL@1010 : Text;
      NewServerFileNameL@1101103001 : Text;
      DocModuleSetupL@1101103000 : Record 53200;
    BEGIN
      IF IsTemporaryP THEN
        EXIT(ImportTemporaryAttachmentFromClientFile(ClientFileNameP));

      DocModuleSetupL.GET;
      IF DocModuleSetupL."Storage Type" = DocModuleSetupL."Storage Type"::"Disk File" THEN
        DocModuleSetupL.TESTFIELD("Storage Location");
      ServerFileNameL := FileMgt.UploadFileSilent(ClientFileNameP);
      FileNameL := FileMgt.GetFileName(ClientFileNameP);
      NewServerFileNameL := FileMgt.CombinePath(TEMPORARYPATH, FileNameL);
      FileMgt.CopyServerFile(ServerFileNameL, NewServerFileNameL, TRUE);
      FileMgt.DeleteServerFile(ServerFileNameL);
      EXIT(ImportAttachmentFromServerFile(RecordRefP, NewServerFileNameL, FALSE, TRUE, FileNameL, AttachmentNoP, InteractionLogEntryNoP));
    END;

    PROCEDURE ConnectAttachmentFromClientFile@1101103000(RecRef@1101103003 : RecordRef;ImportFromFile@1000 : Text;IsTemporary@1001 : Boolean) : Boolean;
    VAR
      FileName@1005 : Text;
      ServerFileName@1010 : Text;
      FilePath@1101103000 : Text;
    BEGIN
      IF IsTemporary THEN
        EXIT(ImportTemporaryAttachmentFromClientFile(ImportFromFile));
      // passing to UPLOAD function when only server path is specified, not ALSO the file name,
      // then function updates the server file path with the actual client name
      ServerFileName := TEMPORARYPATH;
      FileName := ImportFromFile;
      FileName := FileMgt.OpenFileDialog(Text006, '', Text007);
      FilePath := FileMgt.GetDirectoryName(FileName);

      EXIT(ConnectAttachmentFromServerFile(RecRef, FileName , FilePath, FALSE,TRUE));
    END;

    PROCEDURE ImportAttachmentFromServerFile@19(RecRef@1101103001 : RecordRef;ImportFromFile@1000 : Text;IsTemporary@1002 : Boolean;Overwrite@1001 : Boolean;SubjectP@1101103009 : Text[250];VAR AttachmentNoP@1101103007 : Integer;VAR InteractionLogEntryNoP@1101103008 : Integer) : Boolean;
    VAR
      NewDocumentLineNo@1101103000 : Integer;
      DocModuleSetup@1101103002 : Record 53200;
      TempBlob@1101103003 : Record 99008535;
      FileExtensionL@1101103004 : Text[30];
      FileNameL@1101103005 : Text;
      ImportedL@1101103006 : Boolean;
    BEGIN
      ImportedL := FALSE;
      IF ImportFromFile = '' THEN
        EXIT(FALSE);

      IF IsTemporary THEN BEGIN
        ImportTemporaryAttachmentFromServerFile(ImportFromFile);
        EXIT(TRUE);
      END;

      DocModuleSetup.GET;
      IF DocModuleSetup."Storage Type" = DocModuleSetup."Storage Type"::"Disk File" THEN
        DocModuleSetup.TESTFIELD("Storage Location");
      DocModuleSetup.TESTFIELD("Filename No. Series");

      NewDocumentLineNo := InsertNewDocumentRecord(RecRef);
      GET(RecRef.RECORDID.TABLENO, RecRef.RECORDID, NewDocumentLineNo);
      FileExtensionL := COPYSTR(FileMgt.GetExtension(ImportFromFile),1,250);
      FileNameL := FileMgt.GetFileName(ImportFromFile);
      CASE DocModuleSetup."Storage Type" OF
        DocModuleSetup."Storage Type"::Embedded:
          BEGIN
            Date := TODAY;
            Time := Time;
            "Storage Pointer" := '';
            "Storage Type" := "Storage Type"::Embedded;
            "File Extension" := FileExtensionL;
            Description := FileNameL;
            "Filename No." := NoSeriesMgt.GetNextNo(DocModuleSetup."Filename No. Series",TODAY,TRUE);
            IF DocModuleSetup."Use Attachment Table" THEN
              "Attachment No." := DocModuleMgt.InsertAttachment(ImportFromFile, FileExtensionL)
            ELSE BEGIN
              CLEAR(TempBlob);
              FileMgt.BLOBImportFromServerFile(TempBlob,ImportFromFile);
              Attachment := TempBlob.Blob;
            END;
            IF MODIFY(TRUE) AND DocModuleSetup."Add To Record Link" THEN
            BEGIN
              "Link ID" := RecRef.ADDLINK(ConstDiskFileName, Description);
              MODIFY(TRUE) ;
            END;
            FileMgt.DeleteServerFile(ImportFromFile);
            ImportedL := TRUE;
          END;
        "Storage Type"::"Disk File":
          BEGIN
            Date := TODAY;
            Time := Time;
            "Storage Type" := "Storage Type"::"Disk File";
            "Storage Pointer" := DocModuleSetup."Storage Location";
            "File Extension" := FileExtensionL;
            Description := FileNameL;
            "Filename No." := NoSeriesMgt.GetNextNo(DocModuleSetup."Filename No. Series",TODAY,TRUE);
            FileMgt.CopyServerFile(ImportFromFile, ConstDiskFileName, Overwrite); // Copy from UNC location to another UNC location
            IF MODIFY(TRUE) AND DocModuleSetup."Add To Record Link" THEN
            BEGIN
              "Link ID" := RecRef.ADDLINK(ConstDiskFileName, Description);
              MODIFY(TRUE);
            END;
            ImportedL := TRUE;
          END;
      END;
      AttachmentNoP := Rec."Attachment No.";
      IF ImportedL AND DocModuleSetup."Add To Interaction Log" THEN BEGIN
        InteractionLogEntryNoP := InsertInteractionLogEntry(RecRef, FileExtensionL, Rec."Attachment No.", SubjectP);
      END;

      EXIT(ImportedL);
    END;

    PROCEDURE ConnectAttachmentFromServerFile@1101103001(RecRef@1101103002 : RecordRef;ImportFromFile@1000 : Text;FilePath@1101103000 : Text;IsTemporary@1002 : Boolean;Overwrite@1001 : Boolean) : Boolean;
    VAR
      NewDocumentLineNo@1101103001 : Integer;
      DocModuleSetup@1101103003 : Record 53200;
      TempBlob@1101103004 : Record 99008535;
      FileNameL@1101103005 : Text;
      FileExtensionL@1101103006 : Text[30];
    BEGIN

      IF ImportFromFile = '' THEN
        EXIT(FALSE);

      IF IsTemporary THEN BEGIN
        ImportTemporaryAttachmentFromServerFile(ImportFromFile);
        EXIT(TRUE);
      END;

      DocModuleSetup.GET;
      IF DocModuleSetup."Storage Type" = DocModuleSetup."Storage Type"::"Disk File" THEN
        DocModuleSetup.TESTFIELD("Storage Location");
      DocModuleSetup.TESTFIELD("Filename No. Series");

      NewDocumentLineNo := InsertNewDocumentRecord(RecRef);
      GET(RecRef.RECORDID.TABLENO, RecRef.RECORDID, NewDocumentLineNo);
      FileExtensionL := COPYSTR(FileMgt.GetExtension(ImportFromFile),1,250);
      FileNameL := FileMgt.GetFileName(ImportFromFile);
      CASE DocModuleSetup."Storage Type" OF
        DocModuleSetup."Storage Type"::Embedded:
          BEGIN
            Date := TODAY;
            Time := Time;
            "Storage Pointer" := '';
            "Storage Type" := "Storage Type"::Embedded;
            "File Extension" := FileExtensionL;
            Description := FileNameL;
            "Filename No." := FileMgt.GetFileName(ImportFromFile);
            IF DocModuleSetup."Use Attachment Table" THEN
              "Attachment No." := DocModuleMgt.InsertAttachment(ImportFromFile, FileExtensionL)
            ELSE BEGIN
              CLEAR(TempBlob);
              FileMgt.BLOBImportFromServerFile(TempBlob,ImportFromFile);
              Attachment := TempBlob.Blob;
            END;

            IF MODIFY(TRUE) AND DocModuleSetup."Add To Record Link" THEN
            BEGIN
              "Link ID" := RecRef.ADDLINK(ConstDiskFileName, Description);
              MODIFY(TRUE);
            END;
            EXIT(TRUE);
          END;
        "Storage Type"::"Disk File":
          BEGIN
            Date := TODAY;
            Time := Time;
            "Storage Type" := "Storage Type"::"Disk File";
            "Storage Pointer" := FilePath;
            "File Extension" := FileExtensionL;
            Description := FileNameL;
            "Filename No." := FileMgt.GetFileNameWithoutExtension(ImportFromFile);
           // FileMgt.CopyServerFile(ImportFromFile,ConstDiskFileName,Overwrite); // Copy from UNC location to another UNC location
            IF MODIFY(TRUE) AND DocModuleSetup."Add To Record Link" THEN
            BEGIN
              "Link ID" := RecRef.ADDLINK(ConstDiskFileName, Description);
              MODIFY(TRUE);
            END;
            EXIT(TRUE);
          END;
      END;

      EXIT(FALSE);
    END;

    LOCAL PROCEDURE ImportTemporaryAttachmentFromClientFile@21(ImportFromFile@1000 : Text) : Boolean;
    VAR
      FileName@1001 : Text;
      TempBlob@1101103000 : Record 99008535;
    BEGIN
      FileName := FileMgt.BLOBImport(TempBlob,ImportFromFile);

      IF FileName <> '' THEN BEGIN
        Attachment := TempBlob.Blob;
        "Storage Type" := "Storage Type"::Embedded;
        "Storage Pointer" := '';
        "File Extension" := COPYSTR(UPPERCASE(FileMgt.GetExtension(FileName)),1,250);
        EXIT(TRUE);
      END;

      EXIT(FALSE);
    END;

    LOCAL PROCEDURE ImportTemporaryAttachmentFromServerFile@22(ImportFromFile@1000 : Text);
    VAR
      TempBlob@1101103000 : Record 99008535;
    BEGIN
      FileMgt.BLOBImportFromServerFile(TempBlob,ImportFromFile);
      Attachment := TempBlob.Blob;
      "Storage Type" := "Storage Type"::Embedded;
      "Storage Pointer" := '';
      "File Extension" := COPYSTR(UPPERCASE(FileMgt.GetExtension(ImportFromFile)),1,250);
    END;

    PROCEDURE DeleteFile@10(FilePath@1001 : Text[250]) : Boolean;
    VAR
      I@1002 : Integer;
    BEGIN
      IF FilePath = '' THEN
        EXIT(FALSE);

      IF NOT FileMgt.ClientFileExists(FilePath) THEN
        EXIT(TRUE);

      REPEAT
        SLEEP(250);
        I := I + 1;
      UNTIL FileMgt.DeleteClientFile(FilePath) OR (I = 25);
      EXIT(NOT FileMgt.ClientFileExists(FilePath));
    END;

    PROCEDURE ConstFilename@9() FileName@1000 : Text;
    BEGIN
      FileName := FileMgt.ClientTempFileName("File Extension");
    END;

    PROCEDURE ConstDiskFileName@3() DiskFileName@1000 : Text;
    BEGIN
      IF COPYSTR("Storage Pointer", STRLEN("Storage Pointer"), 1) <> '\' THEN
        DiskFileName := "Storage Pointer" + '\' + FORMAT("Filename No.") + '.' + "File Extension"
      ELSE
        DiskFileName := "Storage Pointer" + FORMAT("Filename No.") + '.' + "File Extension";
    END;

    PROCEDURE InsertNewDocumentRecord@1101103002(RecRef@1101103002 : RecordRef) : Integer;
    VAR
      Document@1101103001 : Record 53201;
    BEGIN
      Document.INIT;
      Document."Table No." := RecRef.RECORDID.TABLENO;
      Document."Line No." := GetNextLineNo(RecRef);
      Document.RecordID := RecRef.RECORDID;
      Document.INSERT;

      EXIT(Document."Line No.");
    END;

    PROCEDURE GetNextLineNo@1101103003(RecRef@1101103000 : RecordRef) : Integer;
    VAR
      Document@1101103001 : Record 53201;
    BEGIN
      Document.SETRANGE("Table No.", RecRef.RECORDID.TABLENO);
      Document.SETRANGE(RecordID, RecRef.RECORDID);
      IF Document.FINDLAST THEN
        EXIT(Document."Line No." + 1)
      ELSE
        EXIT(0);
    END;

    PROCEDURE InsertInteractionLogEntry@1101103004(VAR RecordRefP@1101103000 : RecordRef;FileExtP@1101103002 : Text[30];VAR AttachmentNoP@1101103001 : Integer;DescriptionP@1101103004 : Text[250]) : Integer;
    VAR
      SalesHeaderL@1101103003 : Record 36;
      InteractionLogEntryNoL@1101103005 : Integer;
    BEGIN
      InteractionLogEntryNoL := 0;
      DocumentModuleSetupG.GET;
      CASE RecordRefP.RECORDID.TABLENO OF
        DATABASE::"Sales Header":
        BEGIN
          RecordRefP.SETTABLE(SalesHeaderL);
          InteractionLogEntryNoL := DocModuleMgt.InsertInteractionLogEntry(SalesHeaderL."Sell-to Contact No.", DescriptionP, FileExtP, AttachmentNoP, DocumentModuleSetupG."Interaction Template Code")
        END;
      END;
      EXIT(InteractionLogEntryNoL);
    END;

    BEGIN
    {
      +---------------------------------------------+
      | SI-Data                                     |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 12.11.14 JAL Created the object
    }
    END.
  }
}

OBJECT Table 75000 Workshop
{
  OBJECT-PROPERTIES
  {
    Date=19.10.16;
    Time=20:45:00;
    Modified=Yes;
    Version List=;
  }
  PROPERTIES
  {
    DataPerCompany=No;
  }
  FIELDS
  {
    { 1   ;   ;Code                ;Code10         }
    { 2   ;   ;Description         ;Text50         }
  }
  KEYS
  {
    {    ;Code                                    ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Codeunit 53200 Document Module Files
{
  OBJECT-PROPERTIES
  {
    Date=27.10.16;
    Time=10:14:18;
    Modified=Yes;
    Version List=DOC1.0;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      DocumentModuleSetupG@1101103004 : Record 53200;
      FileManagementG@1101103000 : Codeunit 419;
      Text001@1101103002 : TextConst 'ENU=Import document from file;NOR=Importer dokument fra fil';
      DocumentModuleManagementG@1101103003 : Codeunit 53201;
      DocumentPageG@1101103001 : Page 53201;

    PROCEDURE ShowDocuments@1101103001(RecordRefP@1101103002 : RecordRef);
    VAR
      Documents@1101103001 : Record 53201;
      RecId@1101103003 : RecordID;
    BEGIN
      RecId := RecordRefP.RECORDID;

      Documents.SETCURRENTKEY("Table No.", RecordID, "Line No.");
      Documents.SETRANGE("Table No.", RecId.TABLENO);
      Documents.SETRANGE(RecordID, RecId);

      DocumentPageG.SetRecordRef(RecordRefP);
      DocumentPageG.SETTABLEVIEW(Documents);
      DocumentPageG.RUN;
    END;

    PROCEDURE ShowDocument@1101103006(VAR DocumentModuleDocumentsP@1101103004 : Record 53201);
    VAR
      AttachmentL@1101103001 : Record 5062;
      FileNameL@1101103000 : Text[250];
    BEGIN
      IF DocumentModuleDocumentsP."Attachment No." = 0 THEN BEGIN
        DocumentModuleSetupG.GET;
        IF DocumentModuleSetupG."Storage Type" = DocumentModuleSetupG."Storage Type"::"Disk File" THEN
          HYPERLINK(DocumentModuleDocumentsP.ConstDiskFileName);
        EXIT;
      END;
      IF AttachmentL.GET(DocumentModuleDocumentsP."Attachment No.") THEN
        AttachmentL.OpenAttachment('Attachment', TRUE, '');
    END;

    PROCEDURE ImportDocument@1101103000(RecRef@1101103003 : RecordRef);
    VAR
      DocumentModuleDocumentsL@1101103002 : Record 53201;
      FileNameL@1101103001 : Text[250];
      AttachmentNoL@1101103000 : Integer;
      InteractionLogEntryNoL@1101103004 : Integer;
    BEGIN
      DocumentModuleDocumentsL.ImportAttachmentFromClientFile(RecRef, FileNameL, FALSE, AttachmentNoL, InteractionLogEntryNoL);
    END;

    PROCEDURE ImportDocumentFromFile@1101103004(RecordRefP@1101103003 : RecordRef;FileNameP@1101103000 : Text[250]);
    VAR
      DocumentModuleDocumentsL@1101103002 : Record 53201;
      AttachmentNoL@1101103004 : Integer;
      InteractionLogEntryNoL@1101103001 : Integer;
    BEGIN
      DocumentModuleDocumentsL.ImportAttachmentFromClientFile(RecordRefP, FileNameP, FALSE, AttachmentNoL, InteractionLogEntryNoL);
    END;

    PROCEDURE SaveFileToClient@1101103007(VAR DocumentModuleDocumentsP@1101103000 : Record 53201);
    VAR
      DocModDocumentsL@1101103002 : Record 53201;
    BEGIN
      DocumentModuleManagementG.SaveFileToClient(DocumentModuleDocumentsP);
    END;

    PROCEDURE ConnectDocument@1101103002(RecRef@1101103003 : RecordRef);
    VAR
      Documents@1101103002 : Record 53201;
      FileName@1101103001 : Text[250];
    BEGIN
      Documents.ConnectAttachmentFromClientFile(RecRef, FileName, FALSE);
    END;

    PROCEDURE DeleteDocument@1101103003(FileName@1101103000 : Text[250]);
    VAR
      Documents@1101103001 : Record 53201;
    BEGIN
      Documents.DeleteFile(FileName);
    END;

    PROCEDURE DeleteDocumentByAttachmentNo@1101103009(AttachmentNoP@1101103000 : Integer);
    VAR
      Documents@1101103001 : Record 53201;
    BEGIN
      IF AttachmentNoP <= 0 THEN
        EXIT;
      Documents.SETRANGE("Attachment No.", AttachmentNoP);
      IF Documents.FINDSET THEN
        Documents.DELETEALL(TRUE);
    END;

    PROCEDURE RenameDocuments@1101103005(NewRecRef@1101103002 : RecordRef;OldRecRef@1101103000 : RecordRef);
    VAR
      Documents@1101103001 : Record 53201;
      RecId@1101103003 : RecordID;
      DocumentRec@1101103004 : Record 53201;
    BEGIN
      RecId := OldRecRef.RECORDID;
      Documents.SETRANGE("Table No.", RecId.TABLENO);
      Documents.SETRANGE(RecordID, RecId);
      IF Documents.FINDSET THEN
      REPEAT
        DocumentRec.GET(Documents."Table No.", OldRecRef.RECORDID, Documents."Line No.");
        DocumentRec.RENAME(Documents."Table No.", NewRecRef.RECORDID, Documents."Line No.");
      UNTIL Documents.NEXT <= 0;
    END;

    BEGIN
    {
      +---------------------------------------------+
      | SI-Data                                     |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 12.11.14 JAL Created the object
    }
    END.
  }
}

OBJECT Codeunit 53201 Document Module Management
{
  OBJECT-PROPERTIES
  {
    Date=25.10.16;
    Time=15:40:06;
    Modified=Yes;
    Version List=DOC1.0;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      Text000@1000 : TextConst 'ENU=Send attachments...\\;NOR=Send vedlegg...\\';
      Text001@1001 : TextConst 'ENU=Preparing;NOR=Forbereder';
      Text002@1002 : TextConst 'ENU=Deliver misc.;NOR=Lever div.';
      Text008@1003 : TextConst 'ENU=You must select an interaction template with an attachment.;NOR=Du m velge en samhandlingsmal med et vedlegg.';
      Text003@1101103000 : TextConst 'ENU=Save File;NOR=Lagre fil';

    PROCEDURE InsertAttachmentNo@14(AttachmentNo@1000 : Integer) : Integer;
    VAR
      Attachment@1001 : Record 5062;
      Attachment3@1003 : Record 5062;
    BEGIN
      IF AttachmentNo <> 0 THEN BEGIN
        Attachment.GET(AttachmentNo);
        IF Attachment."Storage Type" = Attachment."Storage Type"::Embedded THEN
          Attachment.CALCFIELDS("Attachment File");
        Attachment3 := Attachment; // Remember "from" attachment
      END;

      Attachment.INSERT(TRUE);

      IF AttachmentNo <> 0 THEN
        // New attachment is based on old attachment
        TransferAttachment(Attachment3,Attachment); // Transfer attachments of different types.

      EXIT(Attachment."No.");
    END;

    PROCEDURE Send@1(VAR DeliverySorter@1000 : Record 5074);
    VAR
      Attachment@1001 : Record 5062;
      TempDeliverySorterWord@1002 : TEMPORARY Record 5074;
      TempDeliverySorterOther@1003 : TEMPORARY Record 5074;
      InteractLogEntry@1004 : Record 5065;
      Contact@1005 : Record 5050;
      FileMgt@1012 : Codeunit 419;
      WordManagement@1006 : Codeunit 5054;
      Mail@1007 : Codeunit 397;
      FileName@1008 : Text;
      Window@1009 : Dialog;
      NoOfAttachments@1010 : Integer;
      I@1011 : Integer;
    BEGIN
      Window.OPEN(
        Text000 +
        '#1############ @2@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@\' +
        '#3############ @4@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@');

      Window.UPDATE(1,Text001);
      Window.UPDATE(3,Text002);

      IF DeliverySorter.FIND('-') THEN BEGIN
        NoOfAttachments := DeliverySorter.COUNT;
        REPEAT
          DeliverySorter.TESTFIELD("Correspondence Type");
          IF NOT Attachment.GET(DeliverySorter."Attachment No.") THEN
            ERROR(Text008);

          IF WordManagement.IsWordDocumentExtension(Attachment."File Extension")
          THEN BEGIN
            TempDeliverySorterWord := DeliverySorter;
            TempDeliverySorterWord.INSERT;
          END ELSE BEGIN
            TempDeliverySorterOther := DeliverySorter;
            TempDeliverySorterOther.INSERT;
          END;
          I := I + 1;
          Window.UPDATE(2,ROUND(I / NoOfAttachments * 10000,1));
        UNTIL DeliverySorter.NEXT = 0;
      END;

      // MS Word merge
      IF TempDeliverySorterWord.FINDFIRST THEN
        WordManagement.Merge(TempDeliverySorterWord);

      // Deliver other types
      IF TempDeliverySorterOther.FIND('-') THEN BEGIN
        I := 0;
        NoOfAttachments := TempDeliverySorterOther.COUNT;
        REPEAT
          InteractLogEntry.LOCKTABLE;
          InteractLogEntry.GET(TempDeliverySorterOther."No.");
          IF TempDeliverySorterOther."Correspondence Type" = TempDeliverySorterOther."Correspondence Type"::Email THEN BEGIN
            Attachment.GET(TempDeliverySorterOther."Attachment No.");
            Attachment.TESTFIELD("File Extension");
            FileName := FileMgt.ServerTempFileName(Attachment."File Extension");
            Attachment.ExportAttachmentToServerFile(FileName);
            Contact.GET(InteractLogEntry."Contact No.");
            //NAV 2013R2 Mail.NewMessage(InteractionEMail(InteractLogEntry),'',TempDeliverySorterOther.Subject,'',FileName,FALSE);
            Mail.NewMessage(InteractionEMail(InteractLogEntry),'', '', TempDeliverySorterOther.Subject,'',FileName,FALSE);
            InteractLogEntry."Delivery Status" := InteractLogEntry."Delivery Status"::" ";
            InteractLogEntry.MODIFY;
          END ELSE BEGIN
            InteractLogEntry."Delivery Status" := InteractLogEntry."Delivery Status"::Error;
            InteractLogEntry.MODIFY;
          END;
          COMMIT;
          I := I + 1;
          Window.UPDATE(4,ROUND(I / NoOfAttachments * 10000,1));
        UNTIL TempDeliverySorterOther.NEXT = 0;
      END;
      Window.CLOSE;
    END;

    LOCAL PROCEDURE TransferAttachment@5(FromAttachment@1000 : Record 5062;VAR ToAttachment@1001 : Record 5062);
    VAR
      RMSetup@1002 : Record 5079;
      FileName@1003 : Text;
    BEGIN
      // Transfer attachments of different types

      IF (FromAttachment."Storage Type" = FromAttachment."Storage Type"::Embedded) AND
         (ToAttachment."Storage Type" = ToAttachment."Storage Type"::"Disk File")
      THEN BEGIN
        FileName := ToAttachment.ConstDiskFileName;
        FromAttachment.ExportAttachmentToServerFile(FileName); // Export blob to UNC location
        WITH ToAttachment DO BEGIN
          CLEAR("Attachment File");
          RMSetup.GET;
          RMSetup.TESTFIELD("Attachment Storage Location");
          "Storage Pointer" := RMSetup."Attachment Storage Location";
          MODIFY;
        END;
      END;

      IF (FromAttachment."Storage Type" = FromAttachment."Storage Type"::"Disk File") AND
         (ToAttachment."Storage Type" = ToAttachment."Storage Type"::"Disk File")
      THEN BEGIN
        // Copy external attachment (to new storage)
        RMSetup.GET;
        RMSetup.TESTFIELD("Attachment Storage Location");
        ToAttachment."Storage Pointer" := RMSetup."Attachment Storage Location";
        ToAttachment.MODIFY;
        FILE.COPY(FromAttachment.ConstDiskFileName,ToAttachment.ConstDiskFileName);
      END;

      IF (FromAttachment."Storage Type" = FromAttachment."Storage Type"::"Disk File") AND
         (ToAttachment."Storage Type" = ToAttachment."Storage Type"::Embedded)
      THEN
        // Transfer External to Embedded attachment
        WITH ToAttachment DO BEGIN
          ImportAttachmentFromServerFile(FromAttachment.ConstDiskFileName,TRUE,FALSE); // Import file from UNC location
          "File Extension" := FromAttachment."File Extension";
          "Storage Pointer" := '';
          MODIFY;
        END;
    END;

    PROCEDURE InteractionEMail@6(VAR InteractLogEntry@1000 : Record 5065) : Text[80];
    VAR
      Cont@1001 : Record 5050;
      ContAltAddr@1002 : Record 5051;
    BEGIN
      IF InteractLogEntry."Contact Alt. Address Code" = '' THEN BEGIN
        Cont.GET(InteractLogEntry."Contact No.");
        EXIT(Cont."E-Mail");
      END;
      ContAltAddr.GET(InteractLogEntry."Contact No.",InteractLogEntry."Contact Alt. Address Code");
      IF ContAltAddr."E-Mail" <> '' THEN
        EXIT(ContAltAddr."E-Mail");

      Cont.GET(InteractLogEntry."Contact No.");
      EXIT(Cont."E-Mail");
    END;

    PROCEDURE InteractionFax@7(VAR InteractLogEntry@1000 : Record 5065) : Text[30];
    VAR
      Cont@1001 : Record 5050;
      ContAltAddr@1002 : Record 5051;
    BEGIN
      IF InteractLogEntry."Contact Alt. Address Code" = '' THEN BEGIN
        Cont.GET(InteractLogEntry."Contact No.");
        EXIT(Cont."Fax No.");
      END;
      ContAltAddr.GET(InteractLogEntry."Contact No.",InteractLogEntry."Contact Alt. Address Code");
      IF ContAltAddr."Fax No." <> '' THEN
        EXIT(ContAltAddr."Fax No.");

      Cont.GET(InteractLogEntry."Contact No.");
      EXIT(Cont."Fax No.");
    END;

    PROCEDURE DownloadFileToClient@1000000015(VAR DocumentModuleDocumentsP@1000000002 : Record 53201;ClientFileNameP@1000000001 : Text) : Text[250];
    VAR
      FileNameL@1000000000 : Text;
      FileManagementL@1101103000 : Codeunit 419;
    BEGIN
      IF ClientFileNameP = '' THEN
        ClientFileNameP := FileManagementL.ClientTempFileName(DocumentModuleDocumentsP."File Extension");
      FileNameL := FileManagementL.ServerTempFileName(DocumentModuleDocumentsP."File Extension");
      DocumentModuleDocumentsP.CALCFIELDS(Attachment);
      DocumentModuleDocumentsP.Attachment.EXPORT(FileNameL);
      FileManagementL.DownloadToFile(FileNameL, ClientFileNameP);
      FileManagementL.DeleteServerFile(FileNameL);
      EXIT(ClientFileNameP);
    END;

    PROCEDURE SaveFileToClient@1101103000(VAR DocumentModuleDocumentsP@1101103000 : Record 53201);
    VAR
      FileManagementL@1101103001 : Codeunit 419;
      FileNameL@1101103002 : Text;
    BEGIN
      FileNameL := FileManagementL.SaveFileDialog(Text003, DocumentModuleDocumentsP.Description,'');
      DownloadFileToClient(DocumentModuleDocumentsP, FileNameL);
    END;

    PROCEDURE InsertAttachment@1101390361(FileNameP@1101390367 : Text;FileExtensionP@1101103000 : Text[30]) : Integer;
    VAR
      Attachment@1101390361 : Record 5062;
      Attachment2@1101390360 : Record 5062;
      NextNo@1101390362 : Integer;
      TempFile@1101390366 : File;
    BEGIN
      Attachment2.RESET;
      IF Attachment2.FINDLAST THEN
        NextNo :=  Attachment2."No." + 1
      ELSE
         NextNo := 0;
      Attachment.INIT;
      Attachment."No." := NextNo;
      Attachment."Attachment File".IMPORT(FileNameP);
      Attachment."Storage Type" := Attachment."Storage Type"::Embedded;
      Attachment."File Extension" := FileExtensionP;
      Attachment."Read Only" := TRUE;
      Attachment."Last Date Modified" := TODAY;
      Attachment."Last Time Modified" := TIME;
      Attachment.INSERT(TRUE);

      EXIT(NextNo);
    END;

    PROCEDURE InsertInteractionLogEntry@1101103002(ContactNoP@1101390361 : Code[20];SubjectP@1101390362 : Text[250];FileExtP@1101390363 : Text[30];AttachmentNoP@1101103003 : Integer;TemplateCodeP@1101103001 : Code[10]) : Integer;
    VAR
      Contact@1101390367 : Record 5050;
      InteractionLogEntryL@1101390365 : Record 5065;
      NextEntryNo@1101390366 : Integer;
    BEGIN
      Contact.GET(ContactNoP);
      InteractionLogEntryL.RESET;
      IF InteractionLogEntryL.FINDLAST THEN
        NextEntryNo :=  InteractionLogEntryL."Entry No." + 1
      ELSE
         NextEntryNo := 0;
      InteractionLogEntryL.INIT;
      InteractionLogEntryL."Entry No." := NextEntryNo;
      InteractionLogEntryL.VALIDATE("Contact Company No.", Contact."Company No.");
      InteractionLogEntryL.VALIDATE("Contact No.", ContactNoP);
      InteractionLogEntryL.VALIDATE("Interaction Template Code", TemplateCodeP);
      InteractionLogEntryL.Date := TODAY;
      InteractionLogEntryL.Description := COPYSTR(SubjectP, 1, MAXSTRLEN(InteractionLogEntryL.Description));
      InteractionLogEntryL.Subject := COPYSTR(SubjectP, 1, MAXSTRLEN(InteractionLogEntryL.Subject));
      InteractionLogEntryL."Attachment No." := AttachmentNoP;
      InteractionLogEntryL.INSERT(TRUE);
      EXIT(InteractionLogEntryL."Entry No.");
    END;

    BEGIN
    {
      +---------------------------------------------+
      | SI-Data                                     |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 12.11.14 JAL Created the object
    }
    END.
  }
}

OBJECT Codeunit 75000 MyWorkshop
{
  OBJECT-PROPERTIES
  {
    Date=19.10.16;
    Time=20:45:00;
    Modified=Yes;
    Version List=;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    [EventSubscriber(Page,30,OnBeforeValidateEvent,Workshop)]
    LOCAL PROCEDURE CheckOnValidateWorkshopField@1(VAR Rec@1000 : Record 27;VAR xRec@1001 : Record 27);
    BEGIN
      MESSAGE('Workshop');
    END;

    PROCEDURE OnNavAppUpgradePerDatabase@2();
    VAR
      ArchiveRecRef@1000 : RecordRef;
    BEGIN
      // Variables:
      // ArchiveRecRef RecordRef
         BEGIN
           IF NAVAPP.GETARCHIVERECORDREF(75000, ArchiveRecRef)
         THEN
              NAVAPP.RESTOREARCHIVEDATA(75000)
         ELSE
              NAVAPP.LOADPACKAGEDATA(75000)
         END;
    END;

    PROCEDURE OnNavAppUpgradePerCompany@3();
    BEGIN
      // OnNavAppUpgradePerCompany()
      NAVAPP.RESTOREARCHIVEDATA(27);
    END;

    BEGIN
    END.
  }
}

OBJECT MenuSuite 1090 Dept - Company
{
  OBJECT-PROPERTIES
  {
    Date=26.10.16;
    Time=09:05:52;
    Modified=Yes;
    Version List=;
  }
  PROPERTIES
  {
  }
  MENUNODES
  {
    {                ;[{8B53F309-FB1D-47BA-A2FE-1460E0D5ECDB}] ;NextNodeID=[{7D84E2C7-9D7A-4DA2-87C1-DDBB9435B63C}] }
    { MenuItem       ;[{7D84E2C7-9D7A-4DA2-87C1-DDBB9435B63C}] ;Name=Item Tracking Codes;
                                                                CaptionML=[ENU=Item Tracking Codes;
                                                                           NOR=Varesporingskoder];
                                                                RunObjectType=Page;
                                                                RunObjectID=6502;
                                                                Visible=Yes;
                                                                DepartmentCategory=Lists }
    { MenuItem       ;[{49448471-4DCE-4BAC-B6A9-BD8614D01A48}] ;Name=Transfer Routes;
                                                                CaptionML=[ENU=Transfer Routes;
                                                                           NOR=Overfringsruter];
                                                                RunObjectType=Page;
                                                                RunObjectID=5747;
                                                                Visible=Yes;
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{81D2CE2C-6499-43ED-9A0B-398248B6B87B}] ;Name=Item Journal Templates;
                                                                CaptionML=[ENU=Item Journal Templates;
                                                                           NOR=Varekladdemaler];
                                                                RunObjectType=Page;
                                                                RunObjectID=102;
                                                                Visible=Yes;
                                                                DepartmentCategory=Lists }
    { MenuItem       ;[{7CEA59FF-A695-44FD-A274-BF6178760FD7}] ;Name=Report Selections Inventory;
                                                                CaptionML=[ENU=Report Selections Inventory;
                                                                           NOR=Rapportvalg - beholdning];
                                                                RunObjectType=Page;
                                                                RunObjectID=5754;
                                                                Visible=Yes;
                                                                NextNodeID=[{00000000-0000-0000-0000-000000000000}];
                                                                DepartmentCategory=Tasks }
    {                ;[{502E3FFC-A7CC-48F7-88A4-89A841F0C628}] ;NextNodeID=[{F17F96B7-D5DF-4C82-B90E-D172A36E4942}] }
    { MenuItem       ;[{F17F96B7-D5DF-4C82-B90E-D172A36E4942}] ;Name=Incoming Documents Setup;
                                                                CaptionML=[ENU=Incoming Documents Setup;
                                                                           NOR=Oppsett for inngende dokumenter];
                                                                ApplicationArea=#Suite;
                                                                RunObjectType=Page;
                                                                RunObjectID=191;
                                                                Visible=Yes;
                                                                DepartmentCategory=Tasks }
    {                ;[{BAD8AF38-254A-4266-AF07-EDC55674B5FA}] ;NextNodeID=[{A2E2F2F9-5AB0-4C65-9A60-F9BAE2B24023}] }
    { MenuItem       ;[{A2E2F2F9-5AB0-4C65-9A60-F9BAE2B24023}] ;Name=VAT Clauses;
                                                                CaptionML=[ENU=VAT Clauses;
                                                                           NOR=Mva-setninger];
                                                                ApplicationArea=#Basic,#Suite;
                                                                RunObjectType=Page;
                                                                RunObjectID=747;
                                                                Visible=Yes;
                                                                DepartmentCategory=Administration }
    {                ;[{9474DF8C-B0E7-4FED-AF54-367E0639F7B0}] ;NextNodeID=[{C68C0462-288A-42CC-8BC7-6F224D8846CE}] }
    { MenuItem       ;[{C68C0462-288A-42CC-8BC7-6F224D8846CE}] ;Name=VAT Clauses;
                                                                CaptionML=[ENU=VAT Clauses;
                                                                           NOR=Mva-setninger];
                                                                ApplicationArea=#Basic,#Suite;
                                                                RunObjectType=Page;
                                                                RunObjectID=747;
                                                                Visible=Yes;
                                                                DepartmentCategory=Tasks }
    {                ;[{44DC36A4-3D38-427C-B37D-02811193E52A}] ;NextNodeID=[{E0433AFB-5B38-4E2F-ADE7-0317B7ADE93D}] }
    { MenuItem       ;[{E0433AFB-5B38-4E2F-ADE7-0317B7ADE93D}] ;Name=Application Area;
                                                                CaptionML=[ENU=Application Area;
                                                                           NOR=Modul];
                                                                ApplicationArea=#All;
                                                                RunObjectType=Page;
                                                                RunObjectID=9179;
                                                                Visible=Yes;
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{9CBA63AC-73D3-438F-818D-476B76D5DB75}] ;Name=Data Exchange Definition;
                                                                CaptionML=[ENU=Data Exchange Definitions;
                                                                           NOR=Datautvekslingsdefinisjoner];
                                                                ApplicationArea=#Basic,#Suite;
                                                                RunObjectType=Page;
                                                                RunObjectID=1211;
                                                                Visible=Yes;
                                                                DepartmentCategory=Lists }
    { MenuItem       ;[{BB2D12FC-2EEB-4165-869B-098BBB42C6F6}] ;Name=Bank Export/Import Setup;
                                                                CaptionML=[ENU=Bank Export/Import Setup;
                                                                           NOR=Konfigurasjon av bankeksport/-import];
                                                                ApplicationArea=#Basic,#Suite;
                                                                RunObjectType=Page;
                                                                RunObjectID=1200;
                                                                Visible=Yes;
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{C0BECAC0-F100-4C39-BBCA-714333A54406}] ;Name=SEPA Schema Viewer;
                                                                CaptionML=[ENU=SEPA Schema Viewer;
                                                                           NOR=Visningsprogram for SEPA-skjema];
                                                                ApplicationArea=#Basic,#Suite;
                                                                RunObjectType=Page;
                                                                RunObjectID=9610;
                                                                Visible=Yes;
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{7FD6154D-F047-4A31-B857-0DA1E0BA97D8}] ;Name=XML Schemas;
                                                                CaptionML=[ENU=XML Schemas;
                                                                           NOR=XML-skjemaer];
                                                                ApplicationArea=#Basic,#Suite;
                                                                RunObjectType=Page;
                                                                RunObjectID=9600;
                                                                Visible=Yes;
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{E55ED739-BBB9-4063-AF58-225E99C5FE72}] ;Name=Document Sending Profiles;
                                                                CaptionML=[ENU=Document Sending Profiles;
                                                                           NOR=Profiler for dokumentsending];
                                                                ApplicationArea=#Basic,#Suite;
                                                                RunObjectType=Page;
                                                                RunObjectID=359;
                                                                Visible=Yes;
                                                                DepartmentCategory=Lists }
    { MenuItem       ;[{379BBC3B-5EBB-4617-8419-8D76352F8337}] ;Name=Electronic Document Formats;
                                                                CaptionML=[ENU=Electronic Document Formats;
                                                                           NOR=Elektroniske dokumentformater];
                                                                ApplicationArea=#Suite;
                                                                RunObjectType=Page;
                                                                RunObjectID=363;
                                                                Visible=Yes;
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{8A3934DD-BE0A-4851-B8E0-50A64106B98A}] ;Name=Data Exchange Types;
                                                                CaptionML=[ENU=Data Exchange Types;
                                                                           NOR=Datautvekslingstyper];
                                                                ApplicationArea=#Basic,#Suite;
                                                                RunObjectType=Page;
                                                                RunObjectID=1213;
                                                                Visible=Yes;
                                                                DepartmentCategory=Administration }
    { MenuItem       ;[{0D3D0EB4-59D7-4D3E-95AC-49CD269C6C04}] ;Name=Data Migration Settings;
                                                                AccessByPermission=TableData 1806=R;
                                                                CaptionML=[ENU=Data Migration Settings;
                                                                           NOR=Innstillinger for datamigrering];
                                                                ApplicationArea=#Basic,#Suite;
                                                                RunObjectType=Page;
                                                                RunObjectID=1807;
                                                                Visible=Yes;
                                                                NextNodeID=[{88D45E95-A3EF-4E43-9E35-CA622BAECD6A}];
                                                                DepartmentCategory=Administration }
    {                ;[{387B2D8D-4249-4D63-BE9C-850416EA6E81}] ;NextNodeID=[{34E4BEA4-29EB-4579-8568-973A8449A4A1}] }
    { MenuItem       ;[{34E4BEA4-29EB-4579-8568-973A8449A4A1}] ;Name=Certificates of Supply;
                                                                CaptionML=[ENU=Certificates of Supply;
                                                                           NOR=Mottaksdeklarasjoner];
                                                                RunObjectType=Page;
                                                                RunObjectID=780;
                                                                Visible=Yes;
                                                                NextNodeID=[{3E2FEC16-BE73-41A6-94E5-BAFFDE0CFB12}];
                                                                DepartmentCategory=Lists }
    {                ;[{A07A2127-D15F-4AF6-8301-EC0DA819FAE6}] ;NextNodeID=[{B0697E0F-6AD6-425A-9E5C-F0BD41F9BC72}] }
    { MenuGroup      ;[{B0697E0F-6AD6-425A-9E5C-F0BD41F9BC72}] ;Name=New Group;
                                                                CaptionML=[ENU=Employee Portal;
                                                                           NOR=Employee Portal];
                                                                Visible=Yes }
    { MenuItem       ;[{88D45E95-A3EF-4E43-9E35-CA622BAECD6A}] ;Name=Document Module Setup;
                                                                CaptionML=[ENU=Document Module Setup;
                                                                           NOR=Dokumentmodul oppsett];
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{19A352FE-D90D-424E-B85F-CF3B8E98CF0E}];
                                                                RunObjectType=Page;
                                                                RunObjectID=53200;
                                                                ParentNodeID=[{8777433F-97D7-457C-ACDD-2E2620FDC182}];
                                                                Visible=Yes;
                                                                NextNodeID=[{4D3D68E9-6A4A-4F4A-8D33-747D76821EC8}];
                                                                DepartmentCategory=Administration }
  }
}
OBJECT Page 30 Item Card
{
  OBJECT-PROPERTIES
  {
    Date=19.10.16;
    Time=21:15:04;
    Modified=Yes;
    Version List=NAVW110.00;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Item Card;
               NOR=Varekort];
    SourceTable=Table27;
    PageType=Card;
    RefreshOnActivate=Yes;
    PromotedActionCategoriesML=[ENU=New,Process,Report,Item,History,Special Prices & Discounts,Approve,Request Approval;
                                NOR=Ny,Prosess,Rapport,Vare,Historikk,Spesialpriser og -rabatter,Godkjenn,Be om godkjenning];
    OnInit=BEGIN
             InitControls
           END;

    OnOpenPage=BEGIN
                 EnableControls
               END;

    OnAfterGetRecord=BEGIN
                       EnableControls
                     END;

    OnNewRecord=BEGIN
                  OnNewRec
                END;

    OnInsertRecord=BEGIN
                     InsertItemUnitOfMeasure;
                   END;

    OnAfterGetCurrRecord=VAR
                           CRMCouplingManagement@1001 : Codeunit 5331;
                           WorkflowManagement@1000 : Codeunit 1501;
                           WorkflowEventHandling@1002 : Codeunit 1520;
                         BEGIN
                           CRMIsCoupledToRecord := CRMIntegrationEnabled AND CRMCouplingManagement.IsRecordCoupledToCRM(RECORDID);
                           OpenApprovalEntriesExistCurrUser := ApprovalsMgmt.HasOpenApprovalEntriesForCurrentUser(RECORDID);
                           OpenApprovalEntriesExist := ApprovalsMgmt.HasOpenApprovalEntries(RECORDID);
                           ShowWorkflowStatus := CurrPage.WorkflowStatus.PAGE.SetFilterOnWorkflowRecord(RECORDID);

                           EventFilter := WorkflowEventHandling.RunWorkflowOnSendItemForApprovalCode + '|' +
                             WorkflowEventHandling.RunWorkflowOnItemChangedCode;

                           EnabledApprovalWorkflowsExist := WorkflowManagement.EnabledWorkflowExist(DATABASE::Item,EventFilter);

                           CurrPage.ItemAttributesFactbox.PAGE.LoadItemAttributesData("No.");
                         END;

    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 123     ;1   ;ActionGroup;
                      CaptionML=[ENU=Item;
                                 NOR=Vare];
                      Image=DataEntry }
      { 114     ;2   ;Action    ;
                      CaptionML=[ENU=&Units of Measure;
                                 NOR=&Enheter];
                      ToolTipML=[ENU=Set up the different units that the item can be traded in, such as piece, box, or hour.;
                                 NOR=Definer de forskjellige enhetene som varen kan handles i, for eksempel stykk, kasse eller time.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 5404;
                      RunPageLink=Item No.=FIELD(No.);
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=UnitOfMeasure;
                      PromotedCategory=Category4 }
      { 199     ;2   ;Action    ;
                      Name=Attributes;
                      AccessByPermission=TableData 7500=R;
                      CaptionML=[ENU=Attributes;
                                 NOR=Attributter];
                      ToolTipML=[ENU=View or edit the item's attributes, such as color, size, or other characteristics that help to describe the item.;
                                 NOR=Vis eller rediger varens attributter, for eksempel farge, strrelse eller andre egenskaper som beskriver varen.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Image=Category;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 ItemAttributeValueMapping@1000 : Record 7505;
                               BEGIN
                                 ItemAttributeValueMapping.EditAttributes(DATABASE::Item,"No.");
                                 CurrPage.SAVERECORD;
                                 CurrPage.ItemAttributesFactbox.PAGE.LoadItemAttributesData("No.");
                               END;
                                }
      { 161     ;2   ;Action    ;
                      CaptionML=[ENU=Cross Re&ferences;
                                 NOR=Kr&yssreferanser];
                      ToolTipML=[ENU=Set up a customer's or vendor's own identification of the item. Cross-references to the customer's item number means that the item number is automatically shown on sales documents instead of the number that you use.;
                                 NOR=Set up a customer's or vendor's own identification of the item. Cross-references to the customer's item number means that the item number is automatically shown on sales documents instead of the number that you use.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 5721;
                      RunPageLink=Item No.=FIELD(No.);
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Change;
                      PromotedCategory=Category4 }
      { 117     ;2   ;Action    ;
                      CaptionML=[ENU=E&xtended Texts;
                                 NOR=&Utvidete tekster];
                      ToolTipML=[ENU=Set up additional text for the description of the item. Extended text can be inserted under the Description field on document lines for the item.;
                                 NOR=Definer mer tekst for varebeskrivelsen. Utvidet tekst kan settes inn under feltet Beskrivelse p dokumentlinjer for varen.];
                      ApplicationArea=#Suite;
                      RunObject=Page 391;
                      RunPageView=SORTING(Table Name,No.,Language Code,All Language Codes,Starting Date,Ending Date);
                      RunPageLink=Table Name=CONST(Item),
                                  No.=FIELD(No.);
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Text;
                      PromotedCategory=Category4 }
      { 116     ;2   ;Action    ;
                      CaptionML=[ENU=Translations;
                                 NOR=Oversettelser];
                      ToolTipML=[ENU=View or edit translated item descriptions. Translated item descriptions are automatically inserted on documents according to the language code.;
                                 NOR=Vis eller rediger oversatte varebeskrivelser. Oversatte varebeskrivelser settes inn automatisk i dokumenter i henhold til sprkkoden.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 35;
                      RunPageLink=Item No.=FIELD(No.);
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Translations;
                      PromotedCategory=Category4 }
      { 186     ;2   ;Action    ;
                      Name=AdjustInventory;
                      CaptionML=[ENU=Adjust Inventory;
                                 NOR=Juster lagerbeholdning];
                      ToolTipML=[ENU=Increase or decrease the item's inventory quantity manually by entering a new quantity. Adjusting the inventory quantity manually may be relevant after a physical count or if you do not record purchased quantities.;
                                 NOR=k eller reduser lagerantallet for varen manuelt ved  angi et nytt antall. Det kan bli aktuelt  justere lagerantallet manuelt etter en fysisk opptelling eller hvis du ikke registrerer kjpt antall.];
                      ApplicationArea=#Basic,#Suite;
                      Enabled=InventoryItemEditable;
                      Image=InventoryCalculation;
                      OnAction=BEGIN
                                 COMMIT;
                                 PAGE.RUNMODAL(PAGE::"Adjust Inventory",Rec)
                               END;
                                }
      { 184     ;2   ;Action    ;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 NOR=Dimensjoner];
                      ToolTipML=[ENU=View or edits dimensions, such as area, project, or department, that you can assign to sales and purchase documents to distribute costs and analyze transaction history.;
                                 NOR=Vis eller rediger dimensjoner, for eksempel omrde, prosjekt eller avdeling, som du kan tilordne til salgs- og kjpsdokumenter for  distribuere kostnader og analysere transaksjonshistorikk.];
                      ApplicationArea=#Suite;
                      RunObject=Page 540;
                      RunPageLink=Table ID=CONST(27),
                                  No.=FIELD(No.);
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Dimensions;
                      PromotedCategory=Category4 }
      { 119     ;2   ;Action    ;
                      CaptionML=[ENU=Va&riants;
                                 NOR=V&arianter];
                      RunObject=Page 5401;
                      RunPageLink=Item No.=FIELD(No.);
                      Image=ItemVariant }
      { 158     ;2   ;Action    ;
                      CaptionML=[ENU=Substituti&ons;
                                 NOR=Erstat&ninger];
                      ApplicationArea=#Suite;
                      RunObject=Page 5716;
                      RunPageLink=Type=CONST(Item),
                                  No.=FIELD(No.);
                      Image=ItemSubstitution }
      { 218     ;2   ;Action    ;
                      CaptionML=[ENU=Identifiers;
                                 NOR=Identifikatorer];
                      RunObject=Page 7706;
                      RunPageView=SORTING(Item No.,Variant Code,Unit of Measure Code);
                      RunPageLink=Item No.=FIELD(No.);
                      Image=BarCode }
      { 178     ;2   ;Action    ;
                      Name=Templates;
                      CaptionML=[ENU=Templates;
                                 NOR=Maler];
                      ToolTipML=[ENU=View or edit item templates.;
                                 NOR=Vis eller rediger varemaler.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 1340;
                      RunPageLink=Table ID=CONST(27);
                      Image=Template }
      { 126     ;1   ;ActionGroup;
                      CaptionML=[ENU=History;
                                 NOR=Historikk];
                      Image=History }
      { 101     ;2   ;ActionGroup;
                      CaptionML=[ENU=E&ntries;
                                 NOR=P&oster];
                      Image=Entries }
      { 105     ;3   ;Action    ;
                      ShortCutKey=Ctrl+F7;
                      CaptionML=[ENU=Ledger E&ntries;
                                 NOR=P&oster];
                      ToolTipML=[ENU=View the history of transactions that have been posted for the selected record.;
                                 NOR=Vis transaksjonshistorikken som har blitt bokfrt for den valgte posten.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 38;
                      RunPageView=SORTING(Item No.)
                                  ORDER(Descending);
                      RunPageLink=Item No.=FIELD(No.);
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=ItemLedger;
                      PromotedCategory=Category5 }
      { 112     ;3   ;Action    ;
                      CaptionML=[ENU=&Phys. Inventory Ledger Entries;
                                 NOR=Vareoppte&llingsposter];
                      ToolTipML=[ENU=View how many units of the item you had in stock at the last physical count.;
                                 NOR=Vis antall enheter av varen som du hadde p lager ved siste fysiske opptelling.];
                      RunObject=Page 390;
                      RunPageView=SORTING(Item No.);
                      RunPageLink=Item No.=FIELD(No.);
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PhysicalInventoryLedger;
                      PromotedCategory=Category5 }
      { 75      ;3   ;Action    ;
                      CaptionML=[ENU=&Reservation Entries;
                                 NOR=Re&servasjonsposter];
                      RunObject=Page 497;
                      RunPageView=SORTING(Item No.,Variant Code,Location Code,Reservation Status);
                      RunPageLink=Reservation Status=CONST(Reservation),
                                  Item No.=FIELD(No.);
                      Image=ReservationLedger }
      { 5800    ;3   ;Action    ;
                      CaptionML=[ENU=&Value Entries;
                                 NOR=&Verdiposter];
                      RunObject=Page 5802;
                      RunPageView=SORTING(Item No.);
                      RunPageLink=Item No.=FIELD(No.);
                      Image=ValueLedger }
      { 6500    ;3   ;Action    ;
                      CaptionML=[ENU=Item &Tracking Entries;
                                 NOR=Varesporingspos&ter];
                      Image=ItemTrackingLedger;
                      OnAction=VAR
                                 ItemTrackingDocMgt@1000 : Codeunit 6503;
                               BEGIN
                                 ItemTrackingDocMgt.ShowItemTrackingForMasterData(3,'',"No.",'','','','');
                               END;
                                }
      { 11      ;3   ;Action    ;
                      CaptionML=[ENU=&Warehouse Entries;
                                 NOR=&Lagerposter];
                      RunObject=Page 7318;
                      RunPageView=SORTING(Item No.,Bin Code,Location Code,Variant Code,Unit of Measure Code,Lot No.,Serial No.,Entry Type,Dedicated);
                      RunPageLink=Item No.=FIELD(No.);
                      Image=BinLedger }
      { 237     ;3   ;Action    ;
                      CaptionML=[ENU=Application Worksheet;
                                 NOR=Utligningsforslag];
                      RunObject=Page 521;
                      RunPageLink=Item No.=FIELD(No.);
                      Image=ApplicationWorksheet }
      { 182     ;1   ;ActionGroup;
                      Name=PricesandDiscounts;
                      CaptionML=[ENU=Special Prices & Discounts;
                                 NOR=Spesialpriser og -rabatter] }
      { 82      ;2   ;Action    ;
                      CaptionML=[ENU=Set Special Prices;
                                 NOR=Definer spesialpriser];
                      ToolTipML=[ENU=Set up different prices for the item. An item price is automatically granted on invoice lines when the specified criteria are met, such as customer, quantity, or ending date.;
                                 NOR=Definer forskjellige priser for varen. En varepris gis automatisk p fakturalinjer nr de angitte kriteriene er oppfylt, for eksempel kunde, antall eller sluttdato.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 7002;
                      RunPageLink=Item No.=FIELD(No.);
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Price;
                      PromotedCategory=Category6 }
      { 80      ;2   ;Action    ;
                      CaptionML=[ENU=Set Special Discounts;
                                 NOR=Definer spesialrabatter];
                      ToolTipML=[ENU=Set up different discounts for the item. An item discount is automatically granted on invoice lines when the specified criteria are met, such as customer, quantity, or ending date.;
                                 NOR=Definer forskjellige rabatter for varen. En varerabatt gis automatisk p fakturalinjer nr de angitte kriteriene er oppfylt, for eksempel kunde, antall eller sluttdato.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 7004;
                      RunPageView=SORTING(Type,Code);
                      RunPageLink=Type=CONST(Item),
                                  Code=FIELD(No.);
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=LineDiscount;
                      PromotedCategory=Category6 }
      { 165     ;2   ;Action    ;
                      Name=PricesDiscountsOverview;
                      CaptionML=[ENU=Special Prices & Discounts Overview;
                                 NOR=Oversikt over spesialpriser og -rabatter];
                      ToolTipML=[ENU=View the special prices and line discounts that you grant for this item when certain criteria are met, such as customer, quantity, or ending date.;
                                 NOR=Vis spesialprisene og linjerabattene du gir for denne varen nr bestemte kriterier er oppfylt, for eksempel kunde, antall eller sluttdato.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PriceWorksheet;
                      PromotedCategory=Category6;
                      OnAction=VAR
                                 SalesPriceAndLineDiscounts@1000 : Page 1345;
                               BEGIN
                                 SalesPriceAndLineDiscounts.InitPage(TRUE);
                                 SalesPriceAndLineDiscounts.LoadItem(Rec);
                                 SalesPriceAndLineDiscounts.RUNMODAL;
                               END;
                                }
      { 160     ;1   ;ActionGroup;
                      CaptionML=[ENU=Approval;
                                 NOR=Godkjenning] }
      { 159     ;2   ;Action    ;
                      Name=Approve;
                      CaptionML=[ENU=Approve;
                                 NOR=Godkjenn];
                      ToolTipML=[ENU=Approve the requested changes.;
                                 NOR=Godkjenn de forespurte endringene.];
                      ApplicationArea=#All;
                      Promoted=Yes;
                      Visible=OpenApprovalEntriesExistCurrUser;
                      PromotedIsBig=Yes;
                      Image=Approve;
                      PromotedCategory=Category7;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.ApproveRecordApprovalRequest(RECORDID);
                               END;
                                }
      { 156     ;2   ;Action    ;
                      Name=Reject;
                      CaptionML=[ENU=Reject;
                                 NOR=Avvis];
                      ToolTipML=[ENU=Reject the approval request.;
                                 NOR=Avvis godkjenningsforesprselen.];
                      ApplicationArea=#All;
                      Promoted=Yes;
                      Visible=OpenApprovalEntriesExistCurrUser;
                      PromotedIsBig=Yes;
                      Image=Reject;
                      PromotedCategory=Category7;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.RejectRecordApprovalRequest(RECORDID);
                               END;
                                }
      { 154     ;2   ;Action    ;
                      Name=Delegate;
                      CaptionML=[ENU=Delegate;
                                 NOR=Deleger];
                      ToolTipML=[ENU=Delegate the approval to a substitute approver.;
                                 NOR=Deleger godkjenningen til en stedfortredende godkjenner.];
                      ApplicationArea=#All;
                      Promoted=Yes;
                      Visible=OpenApprovalEntriesExistCurrUser;
                      Image=Delegate;
                      PromotedCategory=Category7;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.DelegateRecordApprovalRequest(RECORDID);
                               END;
                                }
      { 503     ;2   ;Action    ;
                      Name=Comment;
                      CaptionML=[ENU=Comments;
                                 NOR=Merknader];
                      ToolTipML=[ENU=View or add comments.;
                                 NOR=Vis eller legg til merknader.];
                      ApplicationArea=#All;
                      Promoted=Yes;
                      Visible=OpenApprovalEntriesExistCurrUser;
                      Image=ViewComments;
                      PromotedCategory=Category7;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.GetApprovalComment(Rec);
                               END;
                                }
      { 150     ;1   ;ActionGroup;
                      CaptionML=[ENU=Request Approval;
                                 NOR=Be om godkjenning];
                      Image=SendApprovalRequest }
      { 149     ;2   ;Action    ;
                      Name=SendApprovalRequest;
                      CaptionML=[ENU=Send A&pproval Request;
                                 NOR=&Send godkjenningsforesprsel];
                      ToolTipML=[ENU=Send an approval request.;
                                 NOR=Send en godkjenningsforesprsel.];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      Enabled=(NOT OpenApprovalEntriesExist) AND EnabledApprovalWorkflowsExist;
                      Image=SendApprovalRequest;
                      PromotedCategory=Category8;
                      OnAction=VAR
                                 ApprovalsMgmt@1001 : Codeunit 1535;
                               BEGIN
                                 IF ApprovalsMgmt.CheckItemApprovalsWorkflowEnabled(Rec) THEN
                                   ApprovalsMgmt.OnSendItemForApproval(Rec);
                               END;
                                }
      { 148     ;2   ;Action    ;
                      Name=CancelApprovalRequest;
                      CaptionML=[ENU=Cancel Approval Re&quest;
                                 NOR=&Annuller godkjenningsforesprsel];
                      ToolTipML=[ENU=Cancel the approval request.;
                                 NOR=Annuller godkjenningsforesprselen.];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      Enabled=OpenApprovalEntriesExist;
                      Image=CancelApprovalRequest;
                      PromotedCategory=Category8;
                      OnAction=VAR
                                 ApprovalsMgmt@1001 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.OnCancelItemApprovalRequest(Rec);
                               END;
                                }
      { 193     ;1   ;ActionGroup;
                      CaptionML=[ENU=Workflow;
                                 NOR=Arbeidsflyt] }
      { 197     ;2   ;Action    ;
                      Name=CreateApprovalWorkflow;
                      CaptionML=[ENU=Create Approval Workflow;
                                 NOR=Opprett arbeidsflyt for godkjenning];
                      ToolTipML=[ENU=Set up an approval workflow for creating or changing items, by going through a few pages that will guide you.;
                                 NOR=Konfigurer en arbeidsflyt for godkjenning for oppretting eller endring av varer, ved  lese gjennom et par sider med veiledning.];
                      ApplicationArea=#Suite;
                      Enabled=NOT EnabledApprovalWorkflowsExist;
                      Image=CreateWorkflow;
                      OnAction=BEGIN
                                 PAGE.RUNMODAL(PAGE::"Item Approval WF Setup Wizard");
                               END;
                                }
      { 195     ;2   ;Action    ;
                      Name=ManageApprovalWorkflow;
                      CaptionML=[ENU=Manage Approval Workflow;
                                 NOR=Administrer arbeidsflyt for godkjenning];
                      ToolTipML=[ENU=View or edit existing approval workflows for creating or changing items.;
                                 NOR=Vis eller rediger eksisterende arbeidsflyter for godkjenning for oppretting eller endring av varer.];
                      ApplicationArea=#Suite;
                      Enabled=EnabledApprovalWorkflowsExist;
                      Image=WorkflowSetup;
                      OnAction=VAR
                                 WorkflowManagement@1000 : Codeunit 1501;
                               BEGIN
                                 WorkflowManagement.NavigateToWorkflows(DATABASE::Item,EventFilter);
                               END;
                                }
      { 91      ;1   ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 NOR=F&unksjoner];
                      Image=Action }
      { 92      ;2   ;Action    ;
                      AccessByPermission=TableData 5700=R;
                      CaptionML=[ENU=&Create Stockkeeping Unit;
                                 NOR=&Opprett lagerfringsenhet];
                      Image=CreateSKU;
                      OnAction=VAR
                                 Item@1001 : Record 27;
                               BEGIN
                                 Item.SETRANGE("No.","No.");
                                 REPORT.RUNMODAL(REPORT::"Create Stockkeeping Unit",TRUE,FALSE,Item);
                               END;
                                }
      { 7380    ;2   ;Action    ;
                      Name=CalculateCountingPeriod;
                      AccessByPermission=TableData 7380=R;
                      CaptionML=[ENU=C&alculate Counting Period;
                                 NOR=&Beregn opptellingsperiode];
                      Image=CalculateCalendar;
                      OnAction=VAR
                                 Item@1001 : Record 27;
                                 PhysInvtCountMgt@1000 : Codeunit 7380;
                               BEGIN
                                 Item.SETRANGE("No.","No.");
                                 PhysInvtCountMgt.UpdateItemPhysInvtCount(Item);
                               END;
                                }
      { 241     ;2   ;Separator  }
      { 242     ;2   ;Action    ;
                      Name=ApplyTemplate;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Apply Template;
                                 NOR=Bruk mal];
                      ToolTipML=[ENU=Use a template to quickly create a new item card.;
                                 NOR=Bruk en mal til raskt  opprette et nytt varekort.];
                      ApplicationArea=#Basic,#Suite;
                      Image=ApplyTemplate;
                      OnAction=VAR
                                 ItemTemplate@1002 : Record 1301;
                               BEGIN
                                 ItemTemplate.UpdateItemFromTemplate(Rec);
                               END;
                                }
      { 179     ;2   ;Action    ;
                      Name=SaveAsTemplate;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Save as Template;
                                 NOR=Lagre som mal];
                      ToolTipML=[ENU=Save the item card as a template that can be reused to create new item cards. Item templates contain preset information to help you fill in fields on item cards.;
                                 NOR=Lagre varekortet som en mal som kan brukes p nytt for  opprette nye varekort. Varemaler inneholder forhndsdefinert informasjon som gjr det enklere  fylle ut felt p varekort.];
                      ApplicationArea=#Basic,#Suite;
                      Image=Save;
                      OnAction=VAR
                                 TempItemTemplate@1002 : TEMPORARY Record 1301;
                               BEGIN
                                 TempItemTemplate.SaveAsTemplate(Rec);
                               END;
                                }
      { 1905370404;1 ;Action    ;
                      CaptionML=[ENU=Requisition Worksheet;
                                 NOR=Bestillingsforslag];
                      RunObject=Page 291;
                      Image=Worksheet }
      { 1904344904;1 ;Action    ;
                      CaptionML=[ENU=Item Journal;
                                 NOR=Varekladd];
                      RunObject=Page 40;
                      Promoted=Yes;
                      Image=Journals;
                      PromotedCategory=Process }
      { 1906716204;1 ;Action    ;
                      CaptionML=[ENU=Item Reclassification Journal;
                                 NOR=Varereklassifiseringskladd];
                      RunObject=Page 393;
                      Promoted=Yes;
                      Image=Journals;
                      PromotedCategory=Process }
      { 1902532604;1 ;Action    ;
                      CaptionML=[ENU=Item Tracing;
                                 NOR=Varesporing];
                      RunObject=Page 6520;
                      Image=ItemTracing }
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 190     ;1   ;ActionGroup;
                      CaptionML=[ENU=Item;
                                 NOR=Vare] }
      { 129     ;2   ;Action    ;
                      Name=ApprovalEntries;
                      AccessByPermission=TableData 454=R;
                      CaptionML=[ENU=Approvals;
                                 NOR=Godkjenninger];
                      ToolTipML=[ENU=View a list of the records that are waiting to be approved. For example, you can see who requested the record to be approved, when it was sent, and when it is due to be approved.;
                                 NOR=Vis en liste med poster dom venter p  bli godkjent. Du kan for eksempel se hvem som har bedt om godkjenning av posten, nr den ble sendt og nr den forfaller til godkjenning.];
                      ApplicationArea=#Suite;
                      Image=Approvals;
                      OnAction=BEGIN
                                 ApprovalsMgmt.OpenApprovalEntriesPage(RECORDID);
                               END;
                                }
      { 147     ;1   ;ActionGroup;
                      Name=ActionGroupCRM;
                      CaptionML=[ENU=Dynamics CRM;
                                 NOR=Dynamics CRM];
                      Visible=CRMIntegrationEnabled }
      { 146     ;2   ;Action    ;
                      Name=CRMGoToProduct;
                      CaptionML=[ENU=Product;
                                 NOR=Produkt];
                      ToolTipML=[ENU=Open the coupled Microsoft Dynamics CRM product.;
                                 NOR=pne det koblede Microsoft Dynamics CRM-produktet.];
                      ApplicationArea=#All;
                      Image=CoupledItem;
                      OnAction=VAR
                                 CRMIntegrationManagement@1000 : Codeunit 5330;
                               BEGIN
                                 CRMIntegrationManagement.ShowCRMEntityFromRecordID(RECORDID);
                               END;
                                }
      { 144     ;2   ;Action    ;
                      Name=CRMSynchronizeNow;
                      AccessByPermission=TableData 5331=IM;
                      CaptionML=[ENU=Synchronize Now;
                                 NOR=Synkroniser n];
                      ToolTipML=[ENU=Send updated data to Microsoft Dynamics CRM.;
                                 NOR=Send oppdaterte data til Microsoft Dynamics CRM.];
                      ApplicationArea=#All;
                      Image=Refresh;
                      OnAction=VAR
                                 CRMIntegrationManagement@1001 : Codeunit 5330;
                               BEGIN
                                 CRMIntegrationManagement.UpdateOneNow(RECORDID);
                               END;
                                }
      { 142     ;2   ;ActionGroup;
                      Name=Coupling;
                      CaptionML=[@@@=Coupling is a noun;
                                 ENU=Coupling;
                                 NOR=Kobling];
                      ToolTipML=[ENU=Create, change, or delete a coupling between the Microsoft Dynamics NAV record and a Microsoft Dynamics CRM record.;
                                 NOR=Opprett, endre eller slett en kobling mellom Microsoft Dynamics NAV-posten og en Microsoft Dynamics CRM-post.];
                      Image=LinkAccount }
      { 140     ;3   ;Action    ;
                      Name=ManageCRMCoupling;
                      AccessByPermission=TableData 5331=IM;
                      CaptionML=[ENU=Set Up Coupling;
                                 NOR=Konfigurer kobling];
                      ToolTipML=[ENU=Create or modify the coupling to a Microsoft Dynamics CRM product.;
                                 NOR=Opprett eller endre koblingen til et Microsoft Dynamics CRM-produkt.];
                      ApplicationArea=#All;
                      Image=LinkAccount;
                      OnAction=VAR
                                 CRMIntegrationManagement@1000 : Codeunit 5330;
                               BEGIN
                                 CRMIntegrationManagement.DefineCoupling(RECORDID);
                               END;
                                }
      { 138     ;3   ;Action    ;
                      Name=DeleteCRMCoupling;
                      AccessByPermission=TableData 5331=IM;
                      CaptionML=[ENU=Delete Coupling;
                                 NOR=Slett kobling];
                      ToolTipML=[ENU=Delete the coupling to a Microsoft Dynamics CRM product.;
                                 NOR=Slett koblingen til et Microsoft Dynamics CRM-produkt.];
                      ApplicationArea=#All;
                      Enabled=CRMIsCoupledToRecord;
                      Image=UnLinkAccount;
                      OnAction=VAR
                                 CRMCouplingManagement@1000 : Codeunit 5331;
                               BEGIN
                                 CRMCouplingManagement.RemoveCoupling(RECORDID);
                               END;
                                }
      { 124     ;1   ;ActionGroup;
                      CaptionML=[ENU=Availability;
                                 NOR=Disponibelt];
                      Image=ItemAvailability }
      { 68      ;2   ;Action    ;
                      Name=ItemsByLocation;
                      AccessByPermission=TableData 14=R;
                      CaptionML=[ENU=Items b&y Location;
                                 NOR=Varer per lokas&jon];
                      ToolTipML=[ENU=Show a list of items grouped by location.;
                                 NOR=Vis en liste over varer gruppert etter lokasjon.];
                      Image=ItemAvailbyLoc;
                      OnAction=BEGIN
                                 PAGE.RUN(PAGE::"Items by Location",Rec);
                               END;
                                }
      { 76      ;2   ;ActionGroup;
                      CaptionML=[ENU=&Item Availability by;
                                 NOR=Varet&ilgjengelighet per];
                      Image=ItemAvailability }
      { 3       ;3   ;Action    ;
                      Name=<Action110>;
                      CaptionML=[ENU=Event;
                                 NOR=Hendelse];
                      ToolTipML=[ENU=View how the actual and projected inventory level of an item will develop over time according to supply and demand events.;
                                 NOR=Vis hvordan det aktuelle og forventede lagernivet for en vare vil utvikle seg over tid i henhold til forsynings- og behovshendelser.];
                      ApplicationArea=#Basic,#Suite;
                      Image=Event;
                      OnAction=BEGIN
                                 ItemAvailFormsMgt.ShowItemAvailFromItem(Rec,ItemAvailFormsMgt.ByEvent);
                               END;
                                }
      { 110     ;3   ;Action    ;
                      CaptionML=[ENU=Period;
                                 NOR=Periode];
                      ToolTipML=[ENU=Show the actual and projected quantity of an item over time according to a specified time interval, such as by day, week or month.;
                                 NOR=Viser faktisk og beregnet antall av en vare over tid i henhold til et angitt tidsintervall, for eksempel etter dag, uke eller mned.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 157;
                      RunPageLink=No.=FIELD(No.),
                                  Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),
                                  Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter),
                                  Location Filter=FIELD(Location Filter),
                                  Drop Shipment Filter=FIELD(Drop Shipment Filter),
                                  Variant Filter=FIELD(Variant Filter);
                      Image=Period }
      { 77      ;3   ;Action    ;
                      CaptionML=[ENU=Variant;
                                 NOR=Variant];
                      ToolTipML=[ENU=View how the inventory level of an item will develop over time according to the variant that you select.;
                                 NOR=Vis hvordan lagerniv for en vare vil utvikle seg over tid i henhold til varianten du velger.];
                      RunObject=Page 5414;
                      RunPageLink=No.=FIELD(No.),
                                  Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),
                                  Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter),
                                  Location Filter=FIELD(Location Filter),
                                  Drop Shipment Filter=FIELD(Drop Shipment Filter),
                                  Variant Filter=FIELD(Variant Filter);
                      Image=ItemVariant }
      { 69      ;3   ;Action    ;
                      CaptionML=[ENU=Location;
                                 NOR=Lokasjon];
                      RunObject=Page 492;
                      RunPageLink=No.=FIELD(No.),
                                  Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),
                                  Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter),
                                  Location Filter=FIELD(Location Filter),
                                  Drop Shipment Filter=FIELD(Drop Shipment Filter),
                                  Variant Filter=FIELD(Variant Filter);
                      Image=Warehouse }
      { 67      ;3   ;Action    ;
                      CaptionML=[ENU=BOM Level;
                                 NOR=Stykklisteniv];
                      ToolTipML=[ENU=View availability figures for BOM items that indicate how many units of a parent you can make based on the availability of child items on underlying lines.;
                                 NOR=Vis tilgjengelighetstall for stykklistevarer som angir hvor mange enheter av en overordnet vare du kan lage basert p tilgjengeligheten av underordnede varer p underliggende linjer.];
                      Image=BOMLevel;
                      OnAction=BEGIN
                                 ItemAvailFormsMgt.ShowItemAvailFromItem(Rec,ItemAvailFormsMgt.ByBOM);
                               END;
                                }
      { 74      ;3   ;Action    ;
                      CaptionML=[ENU=Timeline;
                                 NOR=Tidslinje];
                      ToolTipML=[ENU=View a graphical view of an items projected inventory based on future supply and demand events, with or without planning suggestions.;
                                 NOR=Vis en grafisk visning av beregnet lager for en vare, basert p fremtidige forsynings- og behovshendelser, med eller uten planleggingsforslag.];
                      Image=Timeline;
                      OnAction=BEGIN
                                 ShowTimelineFromItem(Rec);
                               END;
                                }
      { 102     ;2   ;ActionGroup;
                      CaptionML=[ENU=Statistics;
                                 NOR=Statistikk];
                      Image=Statistics }
      { 107     ;3   ;Action    ;
                      Name=Statistics;
                      ShortCutKey=F7;
                      CaptionML=[ENU=Statistics;
                                 NOR=Statistikk];
                      ToolTipML=[ENU=View statistical information, such as the value of posted entries, for the record.;
                                 NOR=Vis statistikkinformasjon, for eksempel verdien for bokfrte poster, for posten.];
                      ApplicationArea=#Basic,#Suite;
                      Image=Statistics;
                      OnAction=VAR
                                 ItemStatistics@1001 : Page 5827;
                               BEGIN
                                 ItemStatistics.SetItem(Rec);
                                 ItemStatistics.RUNMODAL;
                               END;
                                }
      { 108     ;3   ;Action    ;
                      CaptionML=[ENU=Entry Statistics;
                                 NOR=Poststatistikk];
                      ToolTipML=[ENU=View statistics for item ledger entries.;
                                 NOR=Vis statistikk for vareposter.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 304;
                      RunPageLink=No.=FIELD(No.),
                                  Date Filter=FIELD(Date Filter),
                                  Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),
                                  Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter),
                                  Location Filter=FIELD(Location Filter),
                                  Drop Shipment Filter=FIELD(Drop Shipment Filter),
                                  Variant Filter=FIELD(Variant Filter);
                      Image=EntryStatistics }
      { 111     ;3   ;Action    ;
                      CaptionML=[ENU=T&urnover;
                                 NOR=Omsetnin&g];
                      ToolTipML=[ENU=View a detailed account of item turnover by periods after you have set the relevant filters for location and variant.;
                                 NOR=Vis en detaljert fremstilling av vareomsetning per periode, etter at du har definert de aktuelle lokasjons- og variantfiltrene.];
                      ApplicationArea=#Suite;
                      RunObject=Page 158;
                      RunPageLink=No.=FIELD(No.),
                                  Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),
                                  Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter),
                                  Location Filter=FIELD(Location Filter),
                                  Drop Shipment Filter=FIELD(Drop Shipment Filter),
                                  Variant Filter=FIELD(Variant Filter);
                      Image=Turnover }
      { 106     ;2   ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 NOR=&Merknader];
                      ToolTipML=[ENU=View or add comments.;
                                 NOR=Vis eller legg til merknader.];
                      RunObject=Page 124;
                      RunPageLink=Table Name=CONST(Item),
                                  No.=FIELD(No.);
                      Image=ViewComments }
      { 84      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Purchases;
                                 NOR=Kj&p];
                      Image=Purchasing }
      { 81      ;2   ;Action    ;
                      CaptionML=[ENU=Ven&dors;
                                 NOR=Leveran&drer];
                      RunObject=Page 114;
                      RunPageView=SORTING(Item No.);
                      RunPageLink=Item No.=FIELD(No.);
                      Image=Vendor }
      { 85      ;2   ;Action    ;
                      CaptionML=[ENU=Set Special Prices;
                                 NOR=Definer spesialpriser];
                      RunObject=Page 7012;
                      RunPageView=SORTING(Item No.);
                      RunPageLink=Item No.=FIELD(No.);
                      Image=Price }
      { 86      ;2   ;Action    ;
                      CaptionML=[ENU=Set Special Discounts;
                                 NOR=Definer spesialrabatter];
                      RunObject=Page 7014;
                      RunPageLink=Item No.=FIELD(No.);
                      Image=LineDiscount }
      { 240     ;2   ;Action    ;
                      CaptionML=[ENU=Prepa&yment Percentages;
                                 NOR=&Forskuddsprosenter];
                      RunObject=Page 665;
                      RunPageLink=Item No.=FIELD(No.);
                      Image=PrepaymentPercentages }
      { 47      ;2   ;Separator  }
      { 87      ;2   ;Action    ;
                      CaptionML=[ENU=Orders;
                                 NOR=Bestillinger];
                      ApplicationArea=#Suite;
                      RunObject=Page 56;
                      RunPageView=SORTING(Document Type,Type,No.);
                      RunPageLink=Type=CONST(Item),
                                  No.=FIELD(No.);
                      Image=Document }
      { 191     ;2   ;Action    ;
                      CaptionML=[ENU=Return Orders;
                                 NOR=Bestillingsreturer];
                      RunObject=Page 6643;
                      RunPageView=SORTING(Document Type,Type,No.);
                      RunPageLink=Type=CONST(Item),
                                  No.=FIELD(No.);
                      Image=ReturnOrder }
      { 70      ;2   ;Action    ;
                      CaptionML=[ENU=Nonstoc&k Items;
                                 NOR=Katalo&gvarer];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 5726;
                      Image=NonStockItem }
      { 79      ;1   ;ActionGroup;
                      CaptionML=[ENU=S&ales;
                                 NOR=&Salg];
                      Image=Sales }
      { 300     ;2   ;Action    ;
                      CaptionML=[ENU=Prepa&yment Percentages;
                                 NOR=&Forskuddsprosenter];
                      RunObject=Page 664;
                      RunPageLink=Item No.=FIELD(No.);
                      Image=PrepaymentPercentages }
      { 46      ;2   ;Separator  }
      { 83      ;2   ;Action    ;
                      CaptionML=[ENU=Orders;
                                 NOR=Ordrer];
                      RunObject=Page 48;
                      RunPageView=SORTING(Document Type,Type,No.);
                      RunPageLink=Type=CONST(Item),
                                  No.=FIELD(No.);
                      Image=Document }
      { 163     ;2   ;Action    ;
                      CaptionML=[ENU=Return Orders;
                                 NOR=Ordrereturer];
                      RunObject=Page 6633;
                      RunPageView=SORTING(Document Type,Type,No.);
                      RunPageLink=Type=CONST(Item),
                                  No.=FIELD(No.);
                      Image=ReturnOrder }
      { 128     ;1   ;ActionGroup;
                      CaptionML=[ENU=Assembly/Production;
                                 NOR=Montering/produksjon];
                      Image=Production }
      { 121     ;2   ;Action    ;
                      CaptionML=[ENU=Structure;
                                 NOR=Struktur];
                      Image=Hierarchy;
                      OnAction=VAR
                                 BOMStructure@1000 : Page 5870;
                               BEGIN
                                 BOMStructure.InitItem(Rec);
                                 BOMStructure.RUN;
                               END;
                                }
      { 104     ;2   ;Action    ;
                      CaptionML=[ENU=Cost Shares;
                                 NOR=Kostandeler];
                      Image=CostBudget;
                      OnAction=VAR
                                 BOMCostShares@1000 : Page 5872;
                               BEGIN
                                 BOMCostShares.InitItem(Rec);
                                 BOMCostShares.RUN;
                               END;
                                }
      { 100     ;2   ;ActionGroup;
                      CaptionML=[ENU=Assemb&ly;
                                 NOR=&Montering];
                      Image=AssemblyBOM }
      { 98      ;3   ;Action    ;
                      CaptionML=[ENU=Assembly BOM;
                                 NOR=Monteringsstykkliste];
                      RunObject=Page 36;
                      RunPageLink=Parent Item No.=FIELD(No.);
                      Image=BOM }
      { 96      ;3   ;Action    ;
                      CaptionML=[ENU=Where-Used;
                                 NOR=Inngr i];
                      RunObject=Page 37;
                      RunPageView=SORTING(Type,No.);
                      RunPageLink=Type=CONST(Item),
                                  No.=FIELD(No.);
                      Image=Track }
      { 94      ;3   ;Action    ;
                      AccessByPermission=TableData 90=R;
                      CaptionML=[ENU=Calc. Stan&dard Cost;
                                 NOR=&Beregn standardkost];
                      Image=CalculateCost;
                      OnAction=BEGIN
                                 CLEAR(CalculateStdCost);
                                 CalculateStdCost.CalcItem("No.",TRUE);
                               END;
                                }
      { 90      ;3   ;Action    ;
                      AccessByPermission=TableData 90=R;
                      CaptionML=[ENU=Calc. Unit Price;
                                 NOR=Beregn salgspris];
                      Image=SuggestItemPrice;
                      OnAction=BEGIN
                                 CLEAR(CalculateStdCost);
                                 CalculateStdCost.CalcAssemblyItemPrice("No.")
                               END;
                                }
      { 89      ;2   ;ActionGroup;
                      CaptionML=[ENU=Production;
                                 NOR=Produksjon];
                      Image=Production }
      { 88      ;3   ;Action    ;
                      CaptionML=[ENU=Production BOM;
                                 NOR=Produksjonsstykkliste];
                      RunObject=Page 99000786;
                      RunPageLink=No.=FIELD(Production BOM No.);
                      Image=BOM }
      { 78      ;3   ;Action    ;
                      AccessByPermission=TableData 99000771=R;
                      CaptionML=[ENU=Where-Used;
                                 NOR=Inngr i];
                      Image=Where-Used;
                      OnAction=VAR
                                 ProdBOMWhereUsed@1001 : Page 99000811;
                               BEGIN
                                 ProdBOMWhereUsed.SetItem(Rec,WORKDATE);
                                 ProdBOMWhereUsed.RUNMODAL;
                               END;
                                }
      { 5       ;3   ;Action    ;
                      AccessByPermission=TableData 99000771=R;
                      CaptionML=[ENU=Calc. Stan&dard Cost;
                                 NOR=&Beregn standardkost];
                      Image=CalculateCost;
                      OnAction=BEGIN
                                 CLEAR(CalculateStdCost);
                                 CalculateStdCost.CalcItem("No.",FALSE);
                               END;
                                }
      { 103     ;1   ;ActionGroup;
                      CaptionML=[ENU=Warehouse;
                                 NOR=Lager];
                      Image=Warehouse }
      { 212     ;2   ;Action    ;
                      CaptionML=[ENU=&Bin Contents;
                                 NOR=&Hylleinnhold];
                      RunObject=Page 7379;
                      RunPageView=SORTING(Item No.);
                      RunPageLink=Item No.=FIELD(No.);
                      Image=BinContent }
      { 157     ;2   ;Action    ;
                      CaptionML=[ENU=Stockkeepin&g Units;
                                 NOR=&Lagerfringsenheter];
                      RunObject=Page 5701;
                      RunPageView=SORTING(Item No.);
                      RunPageLink=Item No.=FIELD(No.);
                      Image=SKU }
      { 122     ;1   ;ActionGroup;
                      CaptionML=[ENU=Service;
                                 NOR=Service];
                      Image=ServiceItem }
      { 183     ;2   ;Action    ;
                      CaptionML=[ENU=Ser&vice Items;
                                 NOR=Servi&cevarer];
                      RunObject=Page 5988;
                      RunPageView=SORTING(Item No.);
                      RunPageLink=Item No.=FIELD(No.);
                      Image=ServiceItem }
      { 17      ;2   ;Action    ;
                      AccessByPermission=TableData 5900=R;
                      CaptionML=[ENU=Troubleshooting;
                                 NOR=Feilsking];
                      Image=Troubleshoot;
                      OnAction=VAR
                                 TroubleshootingHeader@1000 : Record 5943;
                               BEGIN
                                 TroubleshootingHeader.ShowForItem(Rec);
                               END;
                                }
      { 185     ;2   ;Action    ;
                      CaptionML=[ENU=Troubleshooting Setup;
                                 NOR=Feilskingsoppsett];
                      RunObject=Page 5993;
                      RunPageLink=Type=CONST(Item),
                                  No.=FIELD(No.);
                      Image=Troubleshoot }
      { 127     ;1   ;ActionGroup;
                      CaptionML=[ENU=Resources;
                                 NOR=Ressurser];
                      Image=Resource }
      { 151     ;2   ;ActionGroup;
                      CaptionML=[ENU=R&esource;
                                 NOR=&Ressurs];
                      Image=Resource }
      { 187     ;3   ;Action    ;
                      CaptionML=[ENU=Resource Skills;
                                 NOR=Ressurskompetanse];
                      ToolTipML=[ENU=View the assignment of skills to resources, items, service item groups, and service items. You can use skill codes to allocate skilled resources to service items or items that need special skills for servicing.;
                                 NOR=Vis tilordningen av kompetanse til ressurser, varer, servicevaregrupper og servicevarer. Du kan bruke kompetansekoder til  tildele kompetente ressurser til servicevarer som trenger spesialkompetanse for vedlikehold.];
                      ApplicationArea=#Jobs;
                      RunObject=Page 6019;
                      RunPageLink=Type=CONST(Item),
                                  No.=FIELD(No.);
                      Image=ResourceSkills }
      { 188     ;3   ;Action    ;
                      AccessByPermission=TableData 5900=R;
                      CaptionML=[ENU=Skilled Resources;
                                 NOR=Kvalifiserte ressurser];
                      ToolTipML=[ENU=View a list of all registered resources with information about whether they have the skills required to service the particular service item group, item, or service item.;
                                 NOR=Vis en oversikt over alle registrerte ressurser, med opplysninger om de har den ndvendige kompetansen til  gi service til en bestemt servicevaregruppe, vare eller servicevare.];
                      ApplicationArea=#Jobs;
                      Image=ResourceSkills;
                      OnAction=VAR
                                 ResourceSkill@1001 : Record 5956;
                               BEGIN
                                 CLEAR(SkilledResourceList);
                                 SkilledResourceList.Initialize(ResourceSkill.Type::Item,"No.",Description);
                                 SkilledResourceList.RUNMODAL;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                Name=Item;
                CaptionML=[ENU=Item;
                           NOR=Vare];
                GroupType=Group }

    { 2   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the item.;
                           NOR=Angir nummeret p varen.];
                ApplicationArea=#All;
                SourceExpr="No.";
                Importance=Additional;
                Visible=NoFieldVisible;
                OnAssistEdit=BEGIN
                               IF AssistEdit THEN
                                 CurrPage.UPDATE;
                             END;
                              }

    { 82100;2  ;Field     ;
                SourceExpr=Workshop }

    { 4   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a description of the item.;
                           NOR=Angir en beskrivelse av varen.];
                ApplicationArea=#All;
                SourceExpr=Description;
                Visible=false;
                ShowMandatory=TRUE }

    { 20  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies if transactions with the item should be blocked, for example, because the item is in quarantine.;
                           NOR=Angir om transaksjoner med varen skal blokkeres, for eksempel fordi varen er i karantene.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Blocked }

    { 166 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies if the item card represents a physical item (Inventory) or a service (Service).;
                           NOR=Angir om varekortet representerer en fysisk vare (Lager) eller en tjeneste (Tjeneste)];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Type;
                OnValidate=BEGIN
                             EnableControls;
                           END;
                            }

    { 6   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the unit in which the item is held in inventory.;
                           NOR=Angir betegnelsen p varens lagerenhet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Base Unit of Measure";
                Importance=Promoted;
                OnValidate=BEGIN
                             CurrPage.UPDATE(TRUE);
                             GET("No.");
                           END;

                ShowMandatory=TRUE }

    { 22  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies when the item card was last modified.;
                           NOR=Angir nr varekortet sist ble endret.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Last Date Modified";
                Importance=Additional }

    { 135 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the item in connection with electronic document sending and receiving.;
                           NOR=Angir varen i forbindelse med sending og mottak av elektroniske dokumenter.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=GTIN;
                Importance=Additional }

    { 171 ;1   ;Group     ;
                Name=InventoryGrp;
                CaptionML=[ENU=Inventory;
                           NOR=Lager];
                GroupType=Group }

    { 8   ;2   ;Field     ;
                ToolTipML=[ENU=Indicates if the item is an assembly BOM.;
                           NOR=Angir om varen er en monteringsstykkliste.];
                SourceExpr="Assembly BOM" }

    { 10  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies where to find the item in the warehouse.;
                           NOR=Angir hvor du finner varen i lageret.];
                SourceExpr="Shelf No." }

    { 164 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies that the item was created from a nonstock item.;
                           NOR=Angir at varen ble opprettet fra en katalogvare.];
                SourceExpr="Created From Nonstock Item";
                Importance=Additional }

    { 170 ;2   ;Field     ;
                ToolTipML=[ENU=Contains the item category code for the item.;
                           NOR=Inneholder varekategorikoden.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Item Category Code";
                OnValidate=VAR
                             ItemAttributeManagement@1000 : Codeunit 7500;
                           BEGIN
                             ItemAttributeManagement.InheritAttributesFromItemCategory(Rec,"Item Category Code",xRec."Item Category Code");
                             CurrPage.ItemAttributesFactbox.PAGE.LoadItemAttributesData("No.");
                             EnableCostingControls;
                           END;
                            }

    { 168 ;2   ;Field     ;
                ToolTipML=[ENU=Contains a product group code associated with the item category.;
                           NOR=Inneholder en produktgruppekode som er knyttet til varekategorien.];
                SourceExpr="Product Group Code" }

    { 180 ;2   ;Field     ;
                ToolTipML=[ENU=Contains the code of the service item group that the item belongs to.;
                           NOR=Inneholder koden til servicevaregruppen som varen tilhrer.];
                SourceExpr="Service Item Group";
                Importance=Additional }

    { 12  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a search description.;
                           NOR=Angir en skebeskrivelse.];
                SourceExpr="Search Description";
                Importance=Additional }

    { 14  ;2   ;Field     ;
                DrillDown=No;
                ToolTipML=[ENU=Specifies how many units, such as pieces, boxes, or cans, of the item are in inventory.;
                           NOR=Angir hvor mange enheter, for eksempel stykk, bokser eller tonn, av varer som er p lager.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Inventory;
                Importance=Promoted;
                Enabled=InventoryItemEditable;
                OnAssistEdit=BEGIN
                               MODIFY(TRUE);
                               COMMIT;
                               IF PAGE.RUNMODAL(PAGE::"Adjust Inventory",Rec) = ACTION::LookupOK THEN
                                 FIND;
                               CurrPage.UPDATE
                             END;
                              }

    { 16  ;2   ;Field     ;
                ToolTipML=[ENU=Shows how many units of the item are inbound on purchase orders, meaning listed on outstanding purchase order lines.;
                           NOR=Viser hvor mange enheter av varen som er inngende i bestillinger, det vil si hvor mange enheter som er oppfrt p pne bestillingslinjer.];
                SourceExpr="Qty. on Purch. Order" }

    { 172 ;2   ;Field     ;
                ToolTipML=[ENU=Shows how many units of the item are allocated to production orders, meaning listed on outstanding production order lines.;
                           NOR=Viser hvor mange enheter av varen som er tildelt til produksjonsordrer, det vil si oppfrt p pne produksjonsordrelinjer.];
                SourceExpr="Qty. on Prod. Order" }

    { 174 ;2   ;Field     ;
                ToolTipML=[ENU=Shows how many units of the item are allocated as production order components, meaning listed under outstanding production order lines.;
                           NOR=Viser hvor mange enheter av varen som er tildelt som produksjonsordrekomponenter, det vil si oppfrt under pne produksjonsordrelinjer.];
                SourceExpr="Qty. on Component Lines" }

    { 18  ;2   ;Field     ;
                ToolTipML=[ENU=Shows how many units of the item are allocated to sales orders, meaning listed on outstanding sales orders lines.;
                           NOR=Viser hvor mange enheter av varen som er tildelt til ordrer, det vil si oppfrt p pne ordrelinjer.];
                SourceExpr="Qty. on Sales Order" }

    { 189 ;2   ;Field     ;
                ToolTipML=[ENU=Shows how many units of the item are allocated to service orders, meaning listed on outstanding service order lines.;
                           NOR=Viser hvor mange enheter av varen som er tildelt til serviceordrer, det vil si oppfrt p pne serviceordrelinjer.];
                SourceExpr="Qty. on Service Order";
                Importance=Additional }

    { 152 ;2   ;Field     ;
                ToolTipML=[ENU=Shows how many units of the item are allocated to jobs, meaning listed on outstanding job planning lines.;
                           NOR=Viser hvor mange enheter av varen som er tildelt til prosjekter, det vil si oppfrt p pne prosjektplanleggingslinjer.];
                SourceExpr="Qty. on Job Order";
                Importance=Additional }

    { 7   ;2   ;Field     ;
                ToolTipML=[ENU=Shows how many units of the item are allocated to assembly orders, which is how many are listed on outstanding assembly order headers.;
                           NOR=Viser hvor mange enheter av varen som er fordelt til monteringsordrer, det vil si hvor mange enheter som er oppfrt p pne monteringsordrehoder.];
                SourceExpr="Qty. on Assembly Order";
                Importance=Additional }

    { 9   ;2   ;Field     ;
                ToolTipML=[ENU=Shows how many units of the item are allocated as assembly components, which means how many are listed on outstanding assembly order lines.;
                           NOR=Viser hvor mange enheter av varen som er fordelt som monteringskomponenter, det vil si hvor mange enheter som er oppfrt p pne monteringsordrelinjer.];
                SourceExpr="Qty. on Asm. Component";
                Importance=Additional }

    { 113 ;2   ;Field     ;
                Name=StockoutWarningDefaultYes;
                CaptionML=[ENU=Stockout Warning;
                           NOR=Lagerbeholdningsadvarsel];
                ToolTipML=[ENU=Specifies if a warning is displayed when you enter a quantity on a sales document that brings the item's inventory below zero.;
                           NOR=Angir om det vises en advarsel nr du angir et antall i et salgsdokument som bringer varens lager under null.];
                OptionCaptionML=[ENU=Default (Yes),No,Yes;
                                 NOR=Standard (Ja),Nei,Ja];
                ApplicationArea=#All;
                SourceExpr="Stockout Warning";
                Visible=ShowStockoutWarningDefaultYes }

    { 115 ;2   ;Field     ;
                Name=StockoutWarningDefaultNo;
                CaptionML=[ENU=Stockout Warning;
                           NOR=Lagerbeholdningsadvarsel];
                ToolTipML=[ENU=Specifies if a warning is displayed when you enter a quantity on a sales document that brings the item's inventory below zero.;
                           NOR=Angir om det vises en advarsel nr du angir et antall i et salgsdokument som bringer varens lager under null.];
                OptionCaptionML=[ENU=Default (No),No,Yes;
                                 NOR=Standard (Nei),Nei,Ja];
                ApplicationArea=#All;
                SourceExpr="Stockout Warning";
                Visible=ShowStockoutWarningDefaultNo }

    { 120 ;2   ;Field     ;
                Name=PreventNegInventoryDefaultYes;
                CaptionML=[ENU=Prevent Negative Inventory;
                           NOR=Forhindre negativ beholdning];
                ToolTipML=[ENU=Specifies if you can post a transaction that will bring the item's inventory below zero.;
                           NOR=Angir om du kan bokfre en transaksjon som bringer varens beholdning under null.];
                OptionCaptionML=[ENU=Default (Yes),No,Yes;
                                 NOR=Standard (Ja),Nei,Ja];
                ApplicationArea=#All;
                SourceExpr="Prevent Negative Inventory";
                Importance=Additional;
                Visible=ShowPreventNegInventoryDefaultYes }

    { 130 ;2   ;Field     ;
                Name=PreventNegInventoryDefaultNo;
                CaptionML=[ENU=Prevent Negative Inventory;
                           NOR=Forhindre negativ beholdning];
                ToolTipML=[ENU=Specifies if you can post a transaction that will bring the item's inventory below zero.;
                           NOR=Angir om du kan bokfre en transaksjon som bringer varens beholdning under null.];
                OptionCaptionML=[ENU=Default (No),No,Yes;
                                 NOR=Standard (Nei),Nei,Ja];
                ApplicationArea=#All;
                SourceExpr="Prevent Negative Inventory";
                Importance=Additional;
                Visible=ShowPreventNegInventoryDefaultNo }

    { 196 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the net weight of the item.;
                           NOR=Angir nettovekten p varen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Net Weight";
                Importance=Additional }

    { 235 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the gross weight of the item.;
                           NOR=Angir bruttovekten p varen.];
                SourceExpr="Gross Weight";
                Importance=Additional }

    { 97  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies that an extended text that you have set up will be added automatically on sales or purchase documents for this item.;
                           NOR=Angir at en utvidet tekst som du har definert, skal legges til i salgs- og kjpsdokumenter for denne varen automatisk.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Automatic Ext. Texts";
                Importance=Additional }

    { 169 ;1   ;Group     ;
                Name=Price & Posting;
                CaptionML=[ENU=Price & Posting;
                           NOR=Pris og bokfring];
                GroupType=Group }

    { 38  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the price for one unit of the item, in LCY.;
                           NOR=Angir prisen for n enhet av varen i NOK.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Unit Price";
                Importance=Promoted;
                Editable=PriceEditable }

    { 173 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the unit price excluding VAT.;
                           NOR=Angir salgsprisen uten mva.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=CalcUnitPriceExclVAT;
                CaptionClass='2,0,' + FIELDCAPTION("Unit Price");
                Importance=Additional }

    { 175 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies if the Unit Price and Line Amount fields on sales document lines for this item should be shown with or without VAT.;
                           NOR=Angi om feltene Salgspris og Linjebelp p salgsdokumentlinjer for denne varen skal vises med eller uten mva.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Price Includes VAT";
                Importance=Additional;
                OnValidate=BEGIN
                             IF "Price Includes VAT" = xRec."Price Includes VAT" THEN
                               EXIT;
                           END;
                            }

    { 34  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies if the Profit Percentage field, the Unit Price field, or neither field is calculated and filled.;
                           NOR=Angir om feltet Fortjenesteprosent, feltet Salgspris eller ingen av feltene er beregnet og fylt ut.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Price/Profit Calculation";
                Importance=Additional;
                OnValidate=BEGIN
                             EnableControls;
                           END;
                            }

    { 181 ;2   ;Field     ;
                CaptionML=[ENU=Special Prices & Discounts;
                           NOR=Spesialpriser og -rabatter];
                ToolTipML=[ENU=Specifies special prices and line discounts for the item.;
                           NOR=Angir spesialpriser og linjerabatter for varen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=SpecialPricesAndDiscountsTxt;
                Importance=Promoted;
                Editable=FALSE;
                OnDrillDown=VAR
                              SalesPrice@1001 : Record 7002;
                              SalesLineDiscount@1002 : Record 7004;
                              SalesPriceAndLineDiscounts@1000 : Page 1345;
                            BEGIN
                              IF SpecialPricesAndDiscountsTxt = ViewOrChangeExistingTxt THEN BEGIN
                                SalesPriceAndLineDiscounts.InitPage(TRUE);
                                SalesPriceAndLineDiscounts.LoadItem(Rec);
                                SalesPriceAndLineDiscounts.RUNMODAL;
                                EXIT;
                              END;

                              CASE STRMENU(STRSUBSTNO('%1,%2',CreateNewSpecialPriceTxt,CreateNewSpecialDiscountTxt),1,'') OF
                                1:
                                  BEGIN
                                    SalesPrice.SETRANGE("Item No.","No.");
                                    PAGE.RUNMODAL(PAGE::"Sales Prices",SalesPrice);
                                  END;
                                2:
                                  BEGIN
                                    SalesLineDiscount.SETRANGE(Type,SalesLineDiscount.Type::Item);
                                    SalesLineDiscount.SETRANGE(Code,"No.");
                                    PAGE.RUNMODAL(PAGE::"Sales Line Discounts",SalesLineDiscount);
                                  END;
                              END;
                            END;
                             }

    { 36  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the profit margin you want to sell the item at.;
                           NOR=Angir fortjenestemarginen du vil selge varen for.];
                ApplicationArea=#Basic,#Suite;
                DecimalPlaces=2:2;
                SourceExpr="Profit %";
                Editable=ProfitEditable }

    { 30  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the cost per unit of the item.;
                           NOR=Angir kostnaden per enhet for varen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Unit Cost";
                Enabled=UnitCostEnable;
                Editable=UnitCostEditable;
                OnDrillDown=VAR
                              ShowAvgCalcItem@1000 : Codeunit 5803;
                            BEGIN
                              ShowAvgCalcItem.DrillDownAvgCostAdjmtPoint(Rec)
                            END;
                             }

    { 153 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the item's indirect cost as an absolute amount.;
                           NOR=Angir den indirekte kostnaden for varen som et absolutt belp.];
                SourceExpr="Overhead Rate";
                Importance=Additional }

    { 44  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies if the item should be included in the calculation of an invoice discount on documents where the item is traded.;
                           NOR=Angir om varen skal inkluderes i beregningen av fakturarabatt p dokumenter hvor varen selges.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Allow Invoice Disc.";
                Importance=Additional }

    { 48  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies an item group code that can be used as a criterion to grant a discount when the item is sold to a certain customer.;
                           NOR=Angir en gruppekode for vare som kan brukes som et kriterium for  gi en rabatt nr varen selges til en bestemt kunde.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Item Disc. Group";
                Importance=Additional }

    { 167 ;2   ;Group     ;
                Name=Cost Details;
                CaptionML=[ENU=Cost Details;
                           NOR=Kostdetaljer];
                GroupType=Group }

    { 24  ;3   ;Field     ;
                ToolTipML=[ENU=Specifies how the item's cost flow is recorded and whether an actual or budgeted value is capitalized and used in the cost calculation.;
                           NOR=Angir hvordan varens kostnadsflyt registreres, og om en faktisk eller budsjettert verdi kapitaliseres og brukes i kostnadsberegningen.];
                SourceExpr="Costing Method";
                Importance=Additional;
                OnValidate=BEGIN
                             EnableCostingControls;
                           END;
                            }

    { 155 ;3   ;Field     ;
                ToolTipML=[ENU=Specifies the percentage of the item's direct unit cost that makes up indirect costs, such as freight and warehouse handling.;
                           NOR=Angir prosentandelen av varens direkte enhetskost som utgjr indirekte kostnader, for eksempel frakt- og lagerhndtering.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Indirect Cost %";
                Importance=Additional }

    { 32  ;3   ;Field     ;
                CaptionML=[ENU=Last Purchase Cost;
                           NOR=Siste kjpskost];
                ToolTipML=[ENU=Specifies the most recent direct unit cost of the item.;
                           NOR=Angir den nyeste direkte enhetskosten for varen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Last Direct Cost";
                Importance=Additional }

    { 176 ;2   ;Group     ;
                Name=Financial Details;
                CaptionML=[ENU=Financial Details;
                           NOR=konomisk informasjon];
                GroupType=Group }

    { 95  ;3   ;Field     ;
                ToolTipML=[ENU=Specifies the item's general product posting group. It links business transactions made for this item with the general ledger to account for the value of trade with the item.;
                           NOR=Angir varebokfringsgruppen. Den kobler forretningstransaksjoner som er utfrt for denne varen, med finans for  gjenspeile verdien av handel med varen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Gen. Prod. Posting Group";
                Importance=Additional;
                ShowMandatory=TRUE }

    { 66  ;3   ;Field     ;
                ToolTipML=[ENU=Specifies the VAT product posting group. Links business transactions made for this item with the general ledger, to account for VAT amounts resulting from trade with the item.;
                           NOR=Angir mva-bokfringsgruppen - vare. Kobler forretningstransaksjoner som er utfrt for denne varen, med finans for  gjenspeile mva-belpene fra handel med varen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="VAT Prod. Posting Group";
                Importance=Additional;
                ShowMandatory=TRUE }

    { 40  ;3   ;Field     ;
                ToolTipML=[ENU=Specifies the inventory posting group. Links business transactions made for the item with an inventory account in the general ledger, to group amounts for that item type.;
                           NOR=Angir lagerbokfringsgruppen. Kobler forretningstransaksjoner gjort for varen med en lagerkonto i finans for  gruppere belp for denne elementtypen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Inventory Posting Group";
                Importance=Additional;
                Editable=InventoryItemEditable;
                ShowMandatory=InventoryItemEditable }

    { 177 ;2   ;Group     ;
                Name=ForeignTrade;
                CaptionML=[ENU=Foreign Trade;
                           NOR=Utenrikshandel];
                GroupType=Group }

    { 62  ;3   ;Field     ;
                ToolTipML=[ENU=Specifies a code for the item's tariff number.;
                           NOR=Angir en kode for varens tariffnummer.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Tariff No.";
                Importance=Additional }

    { 93  ;3   ;Field     ;
                ToolTipML=[ENU=Specifies a code for the country/region where the item was produced or processed.;
                           NOR=Angir en kode for landet/regionen der varen ble produsert eller behandlet.];
                SourceExpr="Country/Region of Origin Code";
                Importance=Additional }

    { 1905885101;1;Group  ;
                CaptionML=[ENU=Invoicing;
                           NOR=Fakturering] }

    { 238 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies whether the item's unit cost has been adjusted, either automatically or manually.;
                           NOR=Angir om enhetskosten for varen er justert, enten automatisk eller manuelt.];
                SourceExpr="Cost is Adjusted" }

    { 26  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies that all the inventory costs for this item have been posted to the general ledger.;
                           NOR=Angir at alle lagerkostnadene for denne varen er bokfrt i finans.];
                SourceExpr="Cost is Posted to G/L" }

    { 28  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the unit cost that is used as a standard measure.;
                           NOR=Angir enhetskosten som blir brukt som standardml.];
                SourceExpr="Standard Cost";
                Enabled=StandardCostEnable;
                OnDrillDown=VAR
                              ShowAvgCalcItem@1000 : Codeunit 5803;
                            BEGIN
                              ShowAvgCalcItem.DrillDownAvgCostAdjmtPoint(Rec)
                            END;
                             }

    { 136 ;2   ;Field     ;
                CaptionML=[ENU=Default Deferral Template;
                           NOR=Standard mal for periodisering];
                ToolTipML=[ENU=Specifies how revenue or expenses for the item are deferred to other accounting periods by default.;
                           NOR=Angir hvordan inntekter eller utgifter for varen blir periodisert til andre regnskapsperioder som standard.];
                ApplicationArea=#Suite;
                SourceExpr="Default Deferral Template Code" }

    { 42  ;2   ;Field     ;
                ToolTipML=[ENU=Shows how many units of the item in inventory have been invoiced.;
                           NOR=Viser hvor mange enheter av varen p lager som er fakturert.];
                SourceExpr="Net Invoiced Qty." }

    { 73  ;2   ;Field     ;
                ToolTipML=[ENU=Contains the unit of measure code used when you sell the item.;
                           NOR=Inneholder enhetskoden som brukes nr du selger varen.];
                SourceExpr="Sales Unit of Measure" }

    { 19  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the ID of a user who is working in the Application Worksheet window.;
                           NOR=Angir ID-en til en bruker som arbeider, i Utligningsforslag-vinduet.];
                SourceExpr="Application Wksh. User ID";
                Importance=Additional;
                Visible=FALSE }

    { 1904731401;1;Group  ;
                CaptionML=[ENU=Replenishment;
                           NOR=Etterfylling] }

    { 133 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the type of supply order created by the planning system when the item needs to be replenished.;
                           NOR=Angir hvilken type forsyningsordre som opprettes av planleggingssystemet nr varen m etterfylles.];
                SourceExpr="Replenishment System";
                Importance=Promoted }

    { 54  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a date formula for the amount of time it takes to replenish the item.;
                           NOR=Angir en datoformel for tiden det tar  etterfylle varen.];
                SourceExpr="Lead Time Calculation" }

    { 229 ;2   ;Group     ;
                CaptionML=[ENU=Purchase;
                           NOR=Kjp] }

    { 50  ;3   ;Field     ;
                ToolTipML=[ENU=Specifies the vendor code of who supplies this item by default.;
                           NOR=Angir leverandrkoden for den som leverer denne varen som standard.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Vendor No." }

    { 52  ;3   ;Field     ;
                ToolTipML=[ENU=Specifies the number that the vendor uses for this item.;
                           NOR=Angir nummeret som leverandren bruker for varen.];
                SourceExpr="Vendor Item No." }

    { 99  ;3   ;Field     ;
                ToolTipML=[ENU=Contains the unit of measure code used when you purchase the item.;
                           NOR=Inneholder enhetskoden som brukes nr du kjper varen.];
                SourceExpr="Purch. Unit of Measure" }

    { 230 ;2   ;Group     ;
                CaptionML=[ENU=Production;
                           NOR=Produksjon] }

    { 227 ;3   ;Field     ;
                ToolTipML=[ENU=Defines whether additional orders for any related components are calculated.;
                           NOR=Definerer om ekstra ordrer for beslektede komponenter skal beregnes.];
                SourceExpr="Manufacturing Policy" }

    { 137 ;3   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the routing.;
                           NOR=Angir nummeret p ruten.];
                SourceExpr="Routing No." }

    { 139 ;3   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the production BOM.;
                           NOR=Angir nummeret p produksjonsstykklisten.];
                SourceExpr="Production BOM No." }

    { 141 ;3   ;Field     ;
                ToolTipML=[ENU=Defines how calculated consumption quantities are rounded when entered on consumption journal lines.;
                           NOR=Definerer hvordan beregnet forbruksantall avrundes nr de er angitt p forbrukskladdelinjer.];
                SourceExpr="Rounding Precision" }

    { 143 ;3   ;Field     ;
                ToolTipML=[ENU=Specifies the method used to calculate and handle the consumption of the item as a component in production processes.;
                           NOR=Angir metoden som brukes til  beregne og hndtere forbruket av varen som en komponent i produksjonsprosesser.];
                SourceExpr="Flushing Method" }

    { 118 ;3   ;Field     ;
                ToolTipML=[ENU=Specifies the percentage of the item that you expect to be scrapped in the production process.;
                           NOR=Angir hvor stor andel av varen du forventer vil bli vraket i produksjonsprosessen.];
                SourceExpr="Scrap %" }

    { 145 ;3   ;Field     ;
                ToolTipML=[ENU=Specifies how many units of the item are processed in one production operation by default.;
                           NOR=Angir hvor mange enheter av varen som behandles i n produksjonsoperasjon som standard.];
                SourceExpr="Lot Size" }

    { 13  ;2   ;Group     ;
                CaptionML=[ENU=Assembly;
                           NOR=Montering];
                GroupType=Group }

    { 15  ;3   ;Field     ;
                ToolTipML=[ENU=Specifies which default order flow is used to supply this assembly item.;
                           NOR=Angir hvilken standard ordreflyt som brukes til  levere denne monteringsvaren.];
                SourceExpr="Assembly Policy" }

    { 1901343701;1;Group  ;
                CaptionML=[ENU=Planning;
                           NOR=Planlegging] }

    { 125 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the reordering policy.;
                           NOR=Angir gjenbestillingsprinsippet.];
                SourceExpr="Reordering Policy";
                Importance=Promoted;
                OnValidate=BEGIN
                             EnablePlanningControls
                           END;
                            }

    { 59  ;2   ;Field     ;
                ToolTipML=[ENU=Indicates whether the program will allow reservations to be made for this item.;
                           NOR=Angir om programmet skal tillate reservasjoner for denne varen.];
                SourceExpr=Reserve;
                Importance=Additional }

    { 58  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies if and how order tracking entries are created and maintained between supply and its corresponding demand.;
                           NOR=Angir om og hvordan sporingsposter skal opprettes og opprettholdes mellom forsyning og tilhrende behov.];
                SourceExpr="Order Tracking Policy";
                Importance=Promoted }

    { 57  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies that a SKU exists for this item.;
                           NOR=Angir at en SKU finnes for denne varen.];
                SourceExpr="Stockkeeping Unit Exists" }

    { 56  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a period of time during which you do not want the planning system to propose to reschedule existing supply orders.;
                           NOR=Angir en tidsperiode der du ikke vil at planleggingssystemet skal foresl  tidsplanlegge eksisterende forsyningsordrer p nytt.];
                SourceExpr="Dampener Period";
                Importance=Additional;
                Enabled=DampenerPeriodEnable }

    { 55  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a dampener quantity to block insignificant change suggestions for an existing supply, if the change quantity is lower than the dampener quantity.;
                           NOR=Angir et avdempingsantall for  blokkere ubetydelige endringsforslag for en eksisterende forsyning, hvis det endrede antallet er lavere enn avdempingsantallet.];
                SourceExpr="Dampener Quantity";
                Importance=Additional;
                Enabled=DampenerQtyEnable }

    { 53  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies if the item is included in availability calculations to promise a shipment date for its parent item.;
                           NOR=Angir om varen skal tas med i beregninger av tilgjengelighet for  bekrefte en forsendelsesdato for den overordnede varen.];
                SourceExpr=Critical }

    { 51  ;2   ;Field     ;
                ToolTipML=[ENU=Defines a date formula to indicate a safety lead time that can be used as a buffer period for production and other delays.;
                           NOR=Definerer en datoformel for  anvise en sikkerhetsleveringstid som kan brukes som bufferperiode for produksjonsforsinkelser og andre forsinkelser.];
                SourceExpr="Safety Lead Time";
                Enabled=SafetyLeadTimeEnable }

    { 49  ;2   ;Field     ;
                ToolTipML=[ENU=Defines a quantity of stock to have in inventory to protect against supply-and-demand fluctuations during replenishment lead time.;
                           NOR=Definerer et antall som du vil ha p lager, som sikkerhet mot svingninger i tilbud og ettersprsel under etterfyllingsleveringstiden.];
                SourceExpr="Safety Stock Quantity";
                Enabled=SafetyStockQtyEnable }

    { 43  ;2   ;Group     ;
                CaptionML=[ENU=Lot-for-Lot Parameters;
                           NOR=Parti for parti - parametre];
                GroupType=Group }

    { 45  ;3   ;Field     ;
                ToolTipML=[ENU=Includes inventory in the projected available balance when replenishment orders are calculated.;
                           NOR=Inkluderer lager i beregnet disponibel saldo nr etterfyllingsordrer beregnes.];
                SourceExpr="Include Inventory";
                Enabled=IncludeInventoryEnable;
                OnValidate=BEGIN
                             EnablePlanningControls
                           END;
                            }

    { 27  ;3   ;Field     ;
                ToolTipML=[ENU=Defines a period in which multiple demands are accumulated into one supply order when you use the Lot-for-Lot reordering policy.;
                           NOR=Definerer en periode der flere behov er akkumulert i n forsyningsordre, nr du bruker gjenbestillingsprinsippet Parti for parti.];
                SourceExpr="Lot Accumulation Period";
                Enabled=LotAccumulationPeriodEnable }

    { 41  ;3   ;Field     ;
                ToolTipML=[ENU=Defines a period within which any suggestion to change a supply date always consists of a Reschedule action and never a Cancel + New action.;
                           NOR=Definerer en periode der alle forslag om  endre en forsyningsdato alltid bestr av en Tidsplanlegg p nytt-handling, og aldri bestr av en Avbryt + Ny-handling.];
                SourceExpr="Rescheduling Period";
                Enabled=ReschedulingPeriodEnable }

    { 39  ;2   ;Group     ;
                CaptionML=[ENU=Reorder-Point Parameters;
                           NOR=Gjenbestillingspunkt - parametre];
                GroupType=Group }

    { 65  ;3   ;Group     ;
                GroupType=GridLayout;
                Layout=Rows }

    { 64  ;4   ;Group     ;
                GroupType=Group }

    { 37  ;5   ;Field     ;
                ToolTipML=[ENU=Specifies a stock quantity that sets the inventory below the level that you must replenish the item.;
                           NOR=Angir et lagerantall som definerer lagernivet til lavere enn nivet som frer til at du m etterfylle varen.];
                SourceExpr="Reorder Point";
                Enabled=ReorderPointEnable }

    { 35  ;5   ;Field     ;
                ToolTipML=[ENU=Specifies a standard lot size quantity to be used for all order proposals.;
                           NOR=Angir en standard partistrrelse som skal brukes for alle ordreforslag.];
                SourceExpr="Reorder Quantity";
                Enabled=ReorderQtyEnable }

    { 33  ;5   ;Field     ;
                ToolTipML=[ENU=Specifies a quantity that you want to use as a maximum inventory level.;
                           NOR=Angir et antall du vil bruke som niv for maksimumsbeholdning.];
                SourceExpr="Maximum Inventory";
                Enabled=MaximumInventoryEnable }

    { 31  ;3   ;Field     ;
                ToolTipML=[ENU=Specifies a quantity you allow projected inventory to exceed the reorder point, before the system suggests to decrease supply orders.;
                           NOR=Angir et antall som du tillater prosjektert beholdning  overskride gjenbestillingspunktet med, fr systemet foreslr  redusere forsyningsordrer.];
                SourceExpr="Overflow Level";
                Importance=Additional;
                Enabled=OverflowLevelEnable }

    { 29  ;3   ;Field     ;
                ToolTipML=[ENU=Specifies a time period that defines the recurring planning horizon used with Fixed Reorder Qty. or Maximum Qty. reordering policies.;
                           NOR=Angir en tidsperiode som definerer den gjentakende planleggingsgrensen som brukes med gjenbestillingsprinsippene Fast gjenbest.ant. eller Maks.ant.];
                SourceExpr="Time Bucket";
                Importance=Additional;
                Enabled=TimeBucketEnable }

    { 63  ;2   ;Group     ;
                CaptionML=[ENU=Order Modifiers;
                           NOR=Ordremodifikatorer];
                GroupType=Group }

    { 60  ;3   ;Group     ;
                GroupType=GridLayout;
                Layout=Rows }

    { 61  ;4   ;Group     ;
                GroupType=Group }

    { 25  ;5   ;Field     ;
                ToolTipML=[ENU=Defines a minimum allowable quantity for an item order proposal.;
                           NOR=Definerer minste tillatte antall for et vareordreforslag.];
                SourceExpr="Minimum Order Quantity";
                Enabled=MinimumOrderQtyEnable }

    { 23  ;5   ;Field     ;
                ToolTipML=[ENU=Specifies a maximum allowable quantity for an item order proposal.;
                           NOR=Angir strste tillatte antall for et vareordreforslag.];
                SourceExpr="Maximum Order Quantity";
                Enabled=MaximumOrderQtyEnable }

    { 21  ;5   ;Field     ;
                ToolTipML=[ENU=Defines a parameter used by the planning system to modify the quantity of planned supply orders.;
                           NOR=Definerer en parameter som brukes av planleggingssystemet til  endre antallet for planlagte forsyningsordrer.];
                SourceExpr="Order Multiple";
                Enabled=OrderMultipleEnable }

    { 1904830201;1;Group  ;
                CaptionML=[ENU=Item Tracking;
                           NOR=Varesporing] }

    { 225 ;2   ;Field     ;
                ToolTipML=[ENU=Contains the code that indicates how the program will track the item in inventory.;
                           NOR=Inneholder koden som angir hvordan varen vil bli sporet p lageret.];
                SourceExpr="Item Tracking Code";
                Importance=Promoted }

    { 210 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a number series code to assign consecutive serial numbers to items produced.;
                           NOR=Angir en nummerseriekode for  tilordne fortlpende serienumre til varer som er produsert.];
                SourceExpr="Serial Nos." }

    { 72  ;2   ;Field     ;
                ToolTipML=[ENU=Contains the number series code that will be used when assigning lot numbers.;
                           NOR=Inneholder nummerseriekoden som blir brukt for  tilordne partinumre.];
                SourceExpr="Lot Nos." }

    { 71  ;2   ;Field     ;
                ToolTipML=[ENU=Contains the formula for calculating the expiration date on the item tracking line.;
                           NOR=Inneholder formelen for  beregne utlpsdatoen p varesporingslinjen.];
                SourceExpr="Expiration Calculation" }

    { 1907509201;1;Group  ;
                CaptionML=[ENU=Warehouse;
                           NOR=Lager] }

    { 215 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the warehouse class code for the item.;
                           NOR=Angir lagerklassekoden for varen.];
                SourceExpr="Warehouse Class Code" }

    { 213 ;2   ;Field     ;
                ToolTipML=[ENU=Contains the code of the equipment that warehouse employees must use when handling the item.;
                           NOR=Inneholder koden for det utstyret som de lageransatte m bruke ved hndtering av varen.];
                SourceExpr="Special Equipment Code";
                Importance=Additional }

    { 206 ;2   ;Field     ;
                ToolTipML=[ENU=Contains the code of the put-away template by which the program determines the most appropriate zone and bin for storage of the item after receipt.;
                           NOR=Inneholder koden til plasseringsmalen som programmet bruker til  bestemme den best egnede sonen og hyllen for lagring av varen etter mottak.];
                SourceExpr="Put-away Template Code" }

    { 204 ;2   ;Field     ;
                ToolTipML=[ENU=Contains the code of the item unit of measure in which the program will put the item away.;
                           NOR=Inneholder enhetskoden som programmet plasserer varen i.];
                SourceExpr="Put-away Unit of Measure Code";
                Importance=Promoted }

    { 202 ;2   ;Field     ;
                ToolTipML=[ENU=Contains the code of the counting period that indicates how often you want to count the item in a physical inventory.;
                           NOR=Inneholder koden for opptellingsperioden som angir hvor ofte du vil foreta vareopptelling for denne varen.];
                SourceExpr="Phys Invt Counting Period Code";
                Importance=Promoted }

    { 200 ;2   ;Field     ;
                ToolTipML=[ENU=Contains the date on which you last posted the results of a physical inventory for the item to the item ledger.;
                           NOR=Inneholder datoen da du forrige gang bokfrte resultatene av en vareopptelling av denne varen til vareposten.];
                SourceExpr="Last Phys. Invt. Date" }

    { 198 ;2   ;Field     ;
                ToolTipML=[ENU=Contains the last date on which you calculated the counting period. It is updated when you use the function Calculate Counting Period.;
                           NOR=Inneholder datoen da opptellingsperioden sist ble beregnet. Det oppdateres nr du bruker funksjonen Beregn opptellingsperiode.];
                SourceExpr="Last Counting Period Update" }

    { 194 ;2   ;Field     ;
                SourceExpr="Next Counting Start Date" }

    { 131 ;2   ;Field     ;
                SourceExpr="Next Counting End Date" }

    { 192 ;2   ;Field     ;
                ToolTipML=[ENU=Contains a unique code for the item in terms that are useful for automatic data capture.;
                           NOR=Inneholder en unik kode for varen, og denne koden er nyttig for automatisk dataregistrering.];
                SourceExpr="Identifier Code";
                Importance=Additional }

    { 208 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies if this item can be cross-docked.;
                           NOR=Angir om denne varen kan kryssoverfres.];
                SourceExpr="Use Cross-Docking";
                Importance=Additional }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 109 ;1   ;Part      ;
                Name=ItemPicture;
                CaptionML=[ENU=Picture;
                           NOR=Bilde];
                ApplicationArea=#All;
                SubPageLink=No.=FIELD(No.),
                            Date Filter=FIELD(Date Filter),
                            Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),
                            Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter),
                            Location Filter=FIELD(Location Filter),
                            Drop Shipment Filter=FIELD(Drop Shipment Filter),
                            Variant Filter=FIELD(Variant Filter);
                PagePartID=Page346;
                PartType=Page }

    { 201 ;1   ;Part      ;
                Name=ItemAttributesFactbox;
                ApplicationArea=#Basic,#Suite;
                PagePartID=Page9110;
                PartType=Page }

    { 132 ;1   ;Part      ;
                ApplicationArea=#All;
                SubPageLink=Source Type=CONST(Item),
                            Source No.=FIELD(No.);
                PagePartID=Page875;
                Visible=SocialListeningVisible;
                PartType=Page }

    { 134 ;1   ;Part      ;
                ApplicationArea=#All;
                SubPageLink=Source Type=CONST(Item),
                            Source No.=FIELD(No.);
                PagePartID=Page876;
                Visible=SocialListeningSetupVisible;
                PartType=Page;
                UpdatePropagation=Both }

    { 162 ;1   ;Part      ;
                Name=WorkflowStatus;
                ApplicationArea=#Suite;
                PagePartID=Page1528;
                Visible=ShowWorkflowStatus;
                Enabled=FALSE;
                Editable=FALSE;
                PartType=Page;
                ShowFilter=No }

    { 1900383207;1;Part   ;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      SkilledResourceList@1001 : Page 6023;
      CalculateStdCost@1005 : Codeunit 5812;
      ItemAvailFormsMgt@1000 : Codeunit 353;
      ApprovalsMgmt@1013 : Codeunit 1535;
      ShowStockoutWarningDefaultYes@1006 : Boolean;
      ShowStockoutWarningDefaultNo@1004 : Boolean;
      ShowPreventNegInventoryDefaultYes@1003 : Boolean;
      ShowPreventNegInventoryDefaultNo@1002 : Boolean;
      TimeBucketEnable@19054765 : Boolean INDATASET;
      SafetyLeadTimeEnable@19079647 : Boolean INDATASET;
      SafetyStockQtyEnable@19036196 : Boolean INDATASET;
      ReorderPointEnable@19067744 : Boolean INDATASET;
      ReorderQtyEnable@19013534 : Boolean INDATASET;
      MaximumInventoryEnable@19059424 : Boolean INDATASET;
      MinimumOrderQtyEnable@19021857 : Boolean INDATASET;
      MaximumOrderQtyEnable@19007977 : Boolean INDATASET;
      OrderMultipleEnable@19004365 : Boolean INDATASET;
      IncludeInventoryEnable@19061544 : Boolean INDATASET;
      ReschedulingPeriodEnable@19049766 : Boolean INDATASET;
      LotAccumulationPeriodEnable@19019376 : Boolean INDATASET;
      DampenerPeriodEnable@19045210 : Boolean INDATASET;
      DampenerQtyEnable@19051814 : Boolean INDATASET;
      OverflowLevelEnable@19033283 : Boolean INDATASET;
      StandardCostEnable@19016419 : Boolean INDATASET;
      UnitCostEnable@19054429 : Boolean INDATASET;
      SocialListeningSetupVisible@1008 : Boolean INDATASET;
      SocialListeningVisible@1007 : Boolean INDATASET;
      CRMIntegrationEnabled@1010 : Boolean;
      CRMIsCoupledToRecord@1009 : Boolean;
      OpenApprovalEntriesExistCurrUser@1012 : Boolean;
      OpenApprovalEntriesExist@1011 : Boolean;
      ShowWorkflowStatus@1014 : Boolean;
      InventoryItemEditable@1015 : Boolean INDATASET;
      UnitCostEditable@1022 : Boolean INDATASET;
      ProfitEditable@1017 : Boolean;
      PriceEditable@1018 : Boolean;
      SpecialPricesAndDiscountsTxt@1019 : Text;
      CreateNewTxt@1020 : TextConst 'ENU=Create New...;NOR=Opprett ny...';
      ViewOrChangeExistingTxt@1021 : TextConst 'ENU=View or Change Existing...;NOR=Vis eller endre eksisterende...';
      CreateNewSpecialPriceTxt@1023 : TextConst 'ENU=Create New Special Price...;NOR=Opprett ny spesialpris...';
      CreateNewSpecialDiscountTxt@1024 : TextConst 'ENU=Create New Special Discount...;NOR=Opprett ny spesialrabatt...';
      EnabledApprovalWorkflowsExist@1025 : Boolean;
      EventFilter@1026 : Text;
      NoFieldVisible@1016 : Boolean;

    LOCAL PROCEDURE EnableControls@6();
    VAR
      ItemLedgerEntry@1000 : Record 32;
      CRMIntegrationManagement@1001 : Codeunit 5330;
      DocumentNoVisibility@1002 : Codeunit 1400;
    BEGIN
      InventoryItemEditable := Type = Type::Inventory;

      IF Type = Type::Inventory THEN BEGIN
        ItemLedgerEntry.SETRANGE("Item No.","No.");
        UnitCostEditable := ItemLedgerEntry.ISEMPTY;
      END ELSE
        UnitCostEditable := TRUE;

      ProfitEditable := "Price/Profit Calculation" <> "Price/Profit Calculation"::"Profit=Price-Cost";
      PriceEditable := "Price/Profit Calculation" <> "Price/Profit Calculation"::"Price=Cost+Profit";

      EnablePlanningControls;
      EnableCostingControls;

      EnableShowStockOutWarning;

      SetSocialListeningFactboxVisibility;
      NoFieldVisible := DocumentNoVisibility.ItemNoIsVisible;
      EnableShowShowEnforcePositivInventory;
      CRMIntegrationEnabled := CRMIntegrationManagement.IsCRMIntegrationEnabled;

      UpdateSpecialPricesAndDiscountsTxt;
    END;

    LOCAL PROCEDURE OnNewRec@16();
    VAR
      ItemTemplate@1001 : Record 1301;
      Item@1000 : Record 27;
      ApplicationAreaSetup@1003 : Record 9178;
      DocumentNoVisibility@1002 : Codeunit 1400;
    BEGIN
      IF GUIALLOWED THEN BEGIN
        EnableControls;
        IF "No." = '' THEN BEGIN
          IF NOT DocumentNoVisibility.ItemNoSeriesIsDefault THEN
            EXIT;

          IF NOT ItemTemplate.NewItemFromTemplate(Item) THEN BEGIN
            CurrPage.CLOSE;
            EXIT;
          END;
        END;

        // Enforce FIFO costing method for Foundation
        IF ApplicationAreaSetup.IsFoundationEnabled THEN
          Item.VALIDATE("Costing Method","Costing Method"::FIFO);

        CurrPage.CLOSE;
        PAGE.RUN(PAGE::"Item Card",Item);
      END;
    END;

    LOCAL PROCEDURE EnableShowStockOutWarning@4();
    VAR
      SalesSetup@1000 : Record 311;
    BEGIN
      SalesSetup.GET;
      ShowStockoutWarningDefaultYes := SalesSetup."Stockout Warning";
      ShowStockoutWarningDefaultNo := NOT ShowStockoutWarningDefaultYes;

      EnableShowShowEnforcePositivInventory
    END;

    LOCAL PROCEDURE InsertItemUnitOfMeasure@8();
    VAR
      ItemUnitOfMeasure@1000 : Record 5404;
    BEGIN
      IF "Base Unit of Measure" <> '' THEN BEGIN
        ItemUnitOfMeasure.INIT;
        ItemUnitOfMeasure."Item No." := "No.";
        ItemUnitOfMeasure.VALIDATE(Code,"Base Unit of Measure");
        ItemUnitOfMeasure."Qty. per Unit of Measure" := 1;
        ItemUnitOfMeasure.INSERT;
      END;
    END;

    LOCAL PROCEDURE EnableShowShowEnforcePositivInventory@2();
    VAR
      InventorySetup@1000 : Record 313;
    BEGIN
      InventorySetup.GET;
      ShowPreventNegInventoryDefaultYes := InventorySetup."Prevent Negative Inventory";
      ShowPreventNegInventoryDefaultNo := NOT ShowPreventNegInventoryDefaultYes;
    END;

    LOCAL PROCEDURE EnablePlanningControls@1();
    VAR
      PlanningGetParam@1000 : Codeunit 99000855;
      TimeBucketEnabled@1010 : Boolean;
      SafetyLeadTimeEnabled@1009 : Boolean;
      SafetyStockQtyEnabled@1008 : Boolean;
      ReorderPointEnabled@1007 : Boolean;
      ReorderQtyEnabled@1006 : Boolean;
      MaximumInventoryEnabled@1005 : Boolean;
      MinimumOrderQtyEnabled@1004 : Boolean;
      MaximumOrderQtyEnabled@1003 : Boolean;
      OrderMultipleEnabled@1002 : Boolean;
      IncludeInventoryEnabled@1001 : Boolean;
      ReschedulingPeriodEnabled@1015 : Boolean;
      LotAccumulationPeriodEnabled@1014 : Boolean;
      DampenerPeriodEnabled@1013 : Boolean;
      DampenerQtyEnabled@1012 : Boolean;
      OverflowLevelEnabled@1011 : Boolean;
    BEGIN
      PlanningGetParam.SetUpPlanningControls("Reordering Policy","Include Inventory",
        TimeBucketEnabled,SafetyLeadTimeEnabled,SafetyStockQtyEnabled,
        ReorderPointEnabled,ReorderQtyEnabled,MaximumInventoryEnabled,
        MinimumOrderQtyEnabled,MaximumOrderQtyEnabled,OrderMultipleEnabled,IncludeInventoryEnabled,
        ReschedulingPeriodEnabled,LotAccumulationPeriodEnabled,
        DampenerPeriodEnabled,DampenerQtyEnabled,OverflowLevelEnabled);

      TimeBucketEnable := TimeBucketEnabled;
      SafetyLeadTimeEnable := SafetyLeadTimeEnabled;
      SafetyStockQtyEnable := SafetyStockQtyEnabled;
      ReorderPointEnable := ReorderPointEnabled;
      ReorderQtyEnable := ReorderQtyEnabled;
      MaximumInventoryEnable := MaximumInventoryEnabled;
      MinimumOrderQtyEnable := MinimumOrderQtyEnabled;
      MaximumOrderQtyEnable := MaximumOrderQtyEnabled;
      OrderMultipleEnable := OrderMultipleEnabled;
      IncludeInventoryEnable := IncludeInventoryEnabled;
      ReschedulingPeriodEnable := ReschedulingPeriodEnabled;
      LotAccumulationPeriodEnable := LotAccumulationPeriodEnabled;
      DampenerPeriodEnable := DampenerPeriodEnabled;
      DampenerQtyEnable := DampenerQtyEnabled;
      OverflowLevelEnable := OverflowLevelEnabled;
    END;

    LOCAL PROCEDURE EnableCostingControls@3();
    BEGIN
      StandardCostEnable := "Costing Method" = "Costing Method"::Standard;
      UnitCostEnable := "Costing Method" <> "Costing Method"::Standard;
    END;

    LOCAL PROCEDURE SetSocialListeningFactboxVisibility@5();
    VAR
      SocialListeningMgt@1000 : Codeunit 871;
    BEGIN
      SocialListeningMgt.GetItemFactboxVisibility(Rec,SocialListeningSetupVisible,SocialListeningVisible);
    END;

    LOCAL PROCEDURE InitControls@12();
    BEGIN
      UnitCostEnable := TRUE;
      StandardCostEnable := TRUE;
      OverflowLevelEnable := TRUE;
      DampenerQtyEnable := TRUE;
      DampenerPeriodEnable := TRUE;
      LotAccumulationPeriodEnable := TRUE;
      ReschedulingPeriodEnable := TRUE;
      IncludeInventoryEnable := TRUE;
      OrderMultipleEnable := TRUE;
      MaximumOrderQtyEnable := TRUE;
      MinimumOrderQtyEnable := TRUE;
      MaximumInventoryEnable := TRUE;
      ReorderQtyEnable := TRUE;
      ReorderPointEnable := TRUE;
      SafetyStockQtyEnable := TRUE;
      SafetyLeadTimeEnable := TRUE;
      TimeBucketEnable := TRUE;

      InventoryItemEditable := Type = Type::Inventory;
      "Costing Method" := "Costing Method"::FIFO;
      UnitCostEditable := TRUE;
    END;

    LOCAL PROCEDURE UpdateSpecialPricesAndDiscountsTxt@7();
    VAR
      TempSalesPriceAndLineDiscBuff@1000 : TEMPORARY Record 1304;
    BEGIN
      SpecialPricesAndDiscountsTxt := CreateNewTxt;
      TempSalesPriceAndLineDiscBuff.LoadDataForItem(Rec);
      IF NOT TempSalesPriceAndLineDiscBuff.ISEMPTY THEN
        SpecialPricesAndDiscountsTxt := ViewOrChangeExistingTxt;
    END;

    BEGIN
    END.
  }
}

OBJECT Page 42 Sales Order
{
  OBJECT-PROPERTIES
  {
    Date=26.10.16;
    Time=14:05:43;
    Modified=Yes;
    Version List=NAVW110.00,NAVNO10.00,DOC1.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Sales Order;
               NOR=Ordre];
    SourceTable=Table36;
    SourceTableView=WHERE(Document Type=FILTER(Order));
    PageType=Document;
    RefreshOnActivate=Yes;
    PromotedActionCategoriesML=[ENU=New,Process,Report,Approve,Release,Posting,Prepare,Invoice,Request Approval;
                                NOR=Ny,Prosess,Rapport,Godkjenn,Frigi,Bokfring,Klargjr,Faktura,Be om godkjenning];
    OnInit=VAR
             SalesReceivablesSetup@1000 : Record 311;
           BEGIN
             SetExtDocNoMandatoryCondition;

             JobQueuesUsed := SalesReceivablesSetup."Post & Print with Job Queue" OR SalesReceivablesSetup."Post with Job Queue";
             SellToCustomerUsesEInvoicing := CustomerUsesEInvoicing("Sell-to Customer No.")
           END;

    OnOpenPage=VAR
                 CRMIntegrationManagement@1000 : Codeunit 5330;
                 OfficeMgt@1001 : Codeunit 1630;
               BEGIN
                 IF UserMgt.GetSalesFilter <> '' THEN BEGIN
                   FILTERGROUP(2);
                   SETRANGE("Responsibility Center",UserMgt.GetSalesFilter);
                   FILTERGROUP(0);
                 END;

                 SETRANGE("Date Filter",0D,WORKDATE - 1);

                 SetDocNoVisible;

                 CRMIntegrationEnabled := CRMIntegrationManagement.IsCRMIntegrationEnabled;
                 IsOfficeHost := OfficeMgt.IsAvailable;

                 IF "Quote No." <> '' THEN
                   ShowQuoteNo := TRUE;
               END;

    OnAfterGetRecord=BEGIN
                       SetControlVisibility;
                       UpdateShipToBillToGroupVisibility;
                     END;

    OnNewRecord=BEGIN
                  "Responsibility Center" := UserMgt.GetSalesFilter;
                  IF (NOT DocNoVisible) AND ("No." = '') THEN
                    SetSellToCustomerFromFilter;

                  SetDefaultPaymentServices;
                END;

    OnInsertRecord=BEGIN
                     IF DocNoVisible THEN
                       CheckCreditMaxBeforeInsert;
                   END;

    OnDeleteRecord=BEGIN
                     CurrPage.SAVERECORD;
                     EXIT(ConfirmDeletion);
                   END;

    OnQueryClosePage=BEGIN
                       IF NOT DocumentIsPosted THEN
                         EXIT(ConfirmCloseUnposted);
                     END;

    OnAfterGetCurrRecord=VAR
                           CRMCouplingManagement@1000 : Codeunit 5331;
                         BEGIN
                           DynamicEditable := CurrPage.EDITABLE;
                           SellToCustomerUsesEInvoicing := CustomerUsesEInvoicing("Sell-to Customer No.");
                           CurrPage.IncomingDocAttachFactBox.PAGE.LoadDataFromRecord(Rec);
                           CRMIsCoupledToRecord := CRMIntegrationEnabled AND CRMCouplingManagement.IsRecordCoupledToCRM(RECORDID);
                           ShowWorkflowStatus := CurrPage.WorkflowStatus.PAGE.SetFilterOnWorkflowRecord(RECORDID);

                           UpdatePaymentService;
                           CurrPage.DocumentFileFactBox.PAGE.LoadDataFromRecord(Rec);
                         END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 59      ;1   ;ActionGroup;
                      CaptionML=[ENU=O&rder;
                                 NOR=&Ordre];
                      Image=Order }
      { 61      ;2   ;Action    ;
                      Name=Statistics;
                      ShortCutKey=F7;
                      CaptionML=[ENU=Statistics;
                                 NOR=Statistikk];
                      ToolTipML=[ENU=View statistical information, such as the value of posted entries, for the record.;
                                 NOR=Vis statistikkinformasjon, for eksempel verdien for bokfrte poster, for posten.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Image=Statistics;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 OpenSalesOrderStatistics;
                                 SalesCalcDiscountByType.ResetRecalculateInvoiceDisc(Rec);
                               END;
                                }
      { 62      ;2   ;Action    ;
                      ShortCutKey=Shift+F7;
                      CaptionML=[ENU=Card;
                                 NOR=Kort];
                      ToolTipML=[ENU=View or create the standard sales lines that are represented by the code on the recurring sales line.;
                                 NOR=Vis eller opprett standardsalgslinjene som representeres av koden p den gjentakende salgslinjen.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 21;
                      RunPageLink=No.=FIELD(Sell-to Customer No.);
                      Image=EditLines }
      { 122     ;2   ;Action    ;
                      Name=Dimensions;
                      AccessByPermission=TableData 348=R;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 NOR=Dimensjoner];
                      ToolTipML=[ENU=View or edits dimensions, such as area, project, or department, that you can assign to sales and purchase documents to distribute costs and analyze transaction history.;
                                 NOR=Vis eller rediger dimensjoner, for eksempel omrde, prosjekt eller avdeling, som du kan tilordne til salgs- og kjpsdokumenter for  distribuere kostnader og analysere transaksjonshistorikk.];
                      ApplicationArea=#Suite;
                      Enabled="No." <> '';
                      Image=Dimensions;
                      OnAction=BEGIN
                                 ShowDocDim;
                                 CurrPage.SAVERECORD;
                               END;
                                }
      { 78      ;2   ;Action    ;
                      Name=Approvals;
                      AccessByPermission=TableData 454=R;
                      CaptionML=[ENU=Approvals;
                                 NOR=Godkjenninger];
                      ToolTipML=[ENU=View a list of the records that are waiting to be approved. For example, you can see who requested the record to be approved, when it was sent, and when it is due to be approved.;
                                 NOR=Vis en liste med poster dom venter p  bli godkjent. Du kan for eksempel se hvem som har bedt om godkjenning av posten, nr den ble sendt og nr den forfaller til godkjenning.];
                      ApplicationArea=#Suite;
                      Image=Approvals;
                      OnAction=VAR
                                 ApprovalEntries@1001 : Page 658;
                               BEGIN
                                 ApprovalEntries.Setfilters(DATABASE::"Sales Header","Document Type","No.");
                                 ApprovalEntries.RUN;
                               END;
                                }
      { 63      ;2   ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 NOR=&Merknader];
                      RunObject=Page 67;
                      RunPageLink=Document Type=FIELD(Document Type),
                                  No.=FIELD(No.),
                                  Document Line No.=CONST(0);
                      Image=ViewComments }
      { 11      ;2   ;Action    ;
                      AccessByPermission=TableData 90=R;
                      CaptionML=[ENU=Assembly Orders;
                                 NOR=Monteringsordrer];
                      Image=AssemblyOrder;
                      OnAction=VAR
                                 AssembleToOrderLink@1000 : Record 904;
                               BEGIN
                                 AssembleToOrderLink.ShowAsmOrders(Rec);
                               END;
                                }
      { 79      ;1   ;ActionGroup;
                      Name=ActionGroupCRM;
                      CaptionML=[ENU=Dynamics CRM;
                                 NOR=Dynamics CRM];
                      Visible=CRMIntegrationEnabled }
      { 71      ;2   ;Action    ;
                      Name=CRMGoToSalesOrder;
                      CaptionML=[ENU=Sales Order;
                                 NOR=Ordre];
                      ToolTipML=[ENU=View the selected sales order.;
                                 NOR=Vis den valgte ordren.];
                      ApplicationArea=#Basic,#Suite;
                      Enabled=CRMIntegrationEnabled AND CRMIsCoupledToRecord;
                      Image=CoupledOrder;
                      OnAction=VAR
                                 CRMIntegrationManagement@1000 : Codeunit 5330;
                               BEGIN
                                 CRMIntegrationManagement.ShowCRMEntityFromRecordID(RECORDID);
                               END;
                                }
      { 13      ;1   ;ActionGroup;
                      CaptionML=[ENU=Documents;
                                 NOR=Dokumenter];
                      Image=Documents }
      { 64      ;2   ;Action    ;
                      CaptionML=[ENU=S&hipments;
                                 NOR=F&lgesedler];
                      ToolTipML=[ENU=View a list of the sales shipments you have posted.;
                                 NOR=Vis en liste over flgesedlene du har bokfrt.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 142;
                      RunPageView=SORTING(Order No.);
                      RunPageLink=Order No.=FIELD(No.);
                      Image=Shipment }
      { 65      ;2   ;Action    ;
                      CaptionML=[ENU=Invoices;
                                 NOR=Fakturaer];
                      ToolTipML=[ENU=View the history of posted sales invoices that have been posted for the document.;
                                 NOR=Vis historikken for bokfrte salgsfakturaer som har blitt bokfrt for dokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 143;
                      RunPageView=SORTING(Order No.);
                      RunPageLink=Order No.=FIELD(No.);
                      Image=Invoice }
      { 15      ;1   ;ActionGroup;
                      CaptionML=[ENU=Warehouse;
                                 NOR=Lager];
                      Image=Warehouse }
      { 150     ;2   ;Action    ;
                      CaptionML=[ENU=In&vt. Put-away/Pick Lines;
                                 NOR=Lagerp&lass.-/-plukklinjer];
                      RunObject=Page 5774;
                      RunPageView=SORTING(Source Document,Source No.,Location Code);
                      RunPageLink=Source Document=CONST(Sales Order),
                                  Source No.=FIELD(No.);
                      Image=PickLines }
      { 168     ;2   ;Action    ;
                      CaptionML=[ENU=Whse. Shipment Lines;
                                 NOR=Lagerleveringslinjer];
                      RunObject=Page 7341;
                      RunPageView=SORTING(Source Type,Source Subtype,Source No.,Source Line No.);
                      RunPageLink=Source Type=CONST(37),
                                  Source Subtype=FIELD(Document Type),
                                  Source No.=FIELD(No.);
                      Image=ShipmentLines }
      { 17      ;1   ;ActionGroup;
                      CaptionML=[ENU=Prepayment;
                                 NOR=Forskudd];
                      Image=Prepayment }
      { 234     ;2   ;Action    ;
                      Name=PagePostedSalesPrepaymentInvoices;
                      CaptionML=[ENU=Prepa&yment Invoices;
                                 NOR=F&orskuddsfakturaer];
                      RunObject=Page 143;
                      RunPageView=SORTING(Prepayment Order No.);
                      RunPageLink=Prepayment Order No.=FIELD(No.);
                      Image=PrepaymentInvoice }
      { 235     ;2   ;Action    ;
                      Name=PagePostedSalesPrepaymentCrMemos;
                      CaptionML=[ENU=Prepayment Credi&t Memos;
                                 NOR=Kredi&tnotaer for forskudd];
                      RunObject=Page 144;
                      RunPageView=SORTING(Prepayment Order No.);
                      RunPageLink=Prepayment Order No.=FIELD(No.);
                      Image=PrepaymentCreditMemo }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 47      ;1   ;ActionGroup;
                      CaptionML=[ENU=Approval;
                                 NOR=Godkjenning] }
      { 43      ;2   ;Action    ;
                      Name=Approve;
                      CaptionML=[ENU=Approve;
                                 NOR=Godkjenn];
                      ToolTipML=[ENU=Approve the requested changes.;
                                 NOR=Godkjenn de forespurte endringene.];
                      ApplicationArea=#All;
                      Promoted=Yes;
                      Visible=OpenApprovalEntriesExistForCurrUser;
                      PromotedIsBig=Yes;
                      Image=Approve;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.ApproveRecordApprovalRequest(RECORDID);
                               END;
                                }
      { 41      ;2   ;Action    ;
                      Name=Reject;
                      CaptionML=[ENU=Reject;
                                 NOR=Avvis];
                      ToolTipML=[ENU=Reject the approval request.;
                                 NOR=Avvis godkjenningsforesprselen.];
                      ApplicationArea=#All;
                      Promoted=Yes;
                      Visible=OpenApprovalEntriesExistForCurrUser;
                      PromotedIsBig=Yes;
                      Image=Reject;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.RejectRecordApprovalRequest(RECORDID);
                               END;
                                }
      { 39      ;2   ;Action    ;
                      Name=Delegate;
                      CaptionML=[ENU=Delegate;
                                 NOR=Deleger];
                      ToolTipML=[ENU=Delegate the approval to a substitute approver.;
                                 NOR=Deleger godkjenningen til en stedfortredende godkjenner.];
                      ApplicationArea=#All;
                      Promoted=Yes;
                      Visible=OpenApprovalEntriesExistForCurrUser;
                      Image=Delegate;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.DelegateRecordApprovalRequest(RECORDID);
                               END;
                                }
      { 37      ;2   ;Action    ;
                      Name=Comment;
                      CaptionML=[ENU=Comments;
                                 NOR=Merknader];
                      ToolTipML=[ENU=View or add comments.;
                                 NOR=Vis eller legg til merknader.];
                      ApplicationArea=#All;
                      Promoted=Yes;
                      Visible=OpenApprovalEntriesExistForCurrUser;
                      Image=ViewComments;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.GetApprovalComment(Rec);
                               END;
                                }
      { 21      ;1   ;ActionGroup;
                      CaptionML=[ENU=Release;
                                 NOR=Frigi];
                      Image=ReleaseDoc }
      { 133     ;2   ;Action    ;
                      Name=Release;
                      ShortCutKey=Ctrl+F9;
                      CaptionML=[ENU=Re&lease;
                                 NOR=&Frigi];
                      Promoted=Yes;
                      Image=ReleaseDoc;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ReleaseSalesDoc@1000 : Codeunit 414;
                               BEGIN
                                 ReleaseSalesDoc.PerformManualRelease(Rec);
                               END;
                                }
      { 134     ;2   ;Action    ;
                      Name=Reopen;
                      CaptionML=[ENU=Re&open;
                                 NOR=&pne p nytt];
                      ToolTipML=[ENU=Reopen the document to change it after it has been approved. Approved documents have the Released status and must be opened before they can be changed.;
                                 NOR=pne dokumentet p nytt for  endre det etter at det har blitt godkjent. Godkjente dokumenter har statusen Frigitt, og de m pnes fr de kan endres.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Enabled=Status <> Status::Open;
                      Image=ReOpen;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ReleaseSalesDoc@1001 : Codeunit 414;
                               BEGIN
                                 ReleaseSalesDoc.PerformManualReopen(Rec);
                               END;
                                }
      { 66      ;1   ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 NOR=F&unksjoner];
                      Image=Action }
      { 87      ;2   ;Action    ;
                      Name=CreatePurchaseInvoice;
                      CaptionML=[ENU=Create Purchase Invoice;
                                 NOR=Opprett kjpsfaktura];
                      ToolTipML=[ENU=Create a new purchase invoice so you can buy items from a vendor.;
                                 NOR=Opprett en ny kjpsfaktura slik at du kan kjpe varer fra en leverandr.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=No;
                      PromotedIsBig=Yes;
                      Image=NewPurchaseInvoice;
                      PromotedCategory=Category8;
                      OnAction=VAR
                                 SelectedSalesLine@1001 : Record 37;
                                 PurchInvFromSalesInvoice@1000 : Codeunit 1314;
                               BEGIN
                                 CurrPage.SalesLines.PAGE.SETSELECTIONFILTER(SelectedSalesLine);
                                 PurchInvFromSalesInvoice.CreatePurchaseInvoice(Rec,SelectedSalesLine);
                               END;
                                }
      { 67      ;2   ;Action    ;
                      Name=CalculateInvoiceDiscount;
                      AccessByPermission=TableData 19=R;
                      CaptionML=[ENU=Calculate &Invoice Discount;
                                 NOR=Beregn fakt&urarabatt];
                      ToolTipML=[ENU=Calculate the invoice discount that applies to the sales order.;
                                 NOR=Beregn fakturarabatten som gjelder for ordren.];
                      ApplicationArea=#Basic,#Suite;
                      Image=CalculateInvoiceDiscount;
                      OnAction=BEGIN
                                 ApproveCalcInvDisc;
                                 SalesCalcDiscountByType.ResetRecalculateInvoiceDisc(Rec);
                               END;
                                }
      { 167     ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Get St&d. Cust. Sales Codes;
                                 NOR=Hent st&d. salgskoder for kunde];
                      ToolTipML=[ENU=View a list of the standard sales codes that have been assigned to the current customer.;
                                 NOR=Vis en liste over standard salgskoder som er tilordnet den aktuelle kunden.];
                      ApplicationArea=#Suite;
                      Image=CustomerCode;
                      OnAction=VAR
                                 StdCustSalesCode@1000 : Record 172;
                               BEGIN
                                 StdCustSalesCode.InsertSalesLines(Rec);
                               END;
                                }
      { 68      ;2   ;Action    ;
                      Name=CopyDocument;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Copy Document;
                                 NOR=Kopier dokument];
                      ToolTipML=[ENU=Copy document lines and header information from another sales document to this document. You can copy a posted sales invoice into a new sales invoice to quickly create a similar document.;
                                 NOR=Kopier dokumentlinjer og hodeopplysninger fra et annet salgsdokument til dette dokumentet. Du kan kopiere en bokfrt salgsfaktura til en ny salgsfaktura for  opprette et lignende dokument raskt.];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      Image=CopyDocument;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CopySalesDoc.SetSalesHeader(Rec);
                                 CopySalesDoc.RUNMODAL;
                                 CLEAR(CopySalesDoc);
                                 IF GET("Document Type","No.") THEN;
                               END;
                                }
      { 154     ;2   ;Action    ;
                      Name=MoveNegativeLines;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Move Negative Lines;
                                 NOR=Flytt negative linjer];
                      Image=MoveNegativeLines;
                      OnAction=BEGIN
                                 CLEAR(MoveNegSalesLines);
                                 MoveNegSalesLines.SetSalesHeader(Rec);
                                 MoveNegSalesLines.RUNMODAL;
                                 MoveNegSalesLines.ShowDocument;
                               END;
                                }
      { 196     ;2   ;Action    ;
                      Name=Archive Document;
                      CaptionML=[ENU=Archi&ve Document;
                                 NOR=Arki&ver dokument];
                      Image=Archive;
                      OnAction=BEGIN
                                 ArchiveManagement.ArchiveSalesDocument(Rec);
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 204     ;2   ;Action    ;
                      AccessByPermission=TableData 410=R;
                      CaptionML=[ENU=Send IC Sales Order Cnfmn.;
                                 NOR=Send bekreftelse p KI-ordre];
                      Image=IntercompanyOrder;
                      OnAction=VAR
                                 ICInOutboxMgt@1000 : Codeunit 427;
                                 ApprovalsMgmt@1003 : Codeunit 1535;
                               BEGIN
                                 IF ApprovalsMgmt.PrePostApprovalCheckSales(Rec) THEN
                                   ICInOutboxMgt.SendSalesDoc(Rec,FALSE);
                               END;
                                }
      { 69      ;2   ;ActionGroup;
                      Name=IncomingDocument;
                      CaptionML=[ENU=Incoming Document;
                                 NOR=Inngende dokument];
                      ActionContainerType=NewDocumentItems;
                      Image=Documents }
      { 60      ;3   ;Action    ;
                      Name=IncomingDocCard;
                      CaptionML=[ENU=View Incoming Document;
                                 NOR=Vis inngende dokument];
                      ToolTipML=[ENU=View any incoming document records and file attachments that exist for the entry or document.;
                                 NOR=Vis poster og filvedlegg for innkommende dokument som finnes for oppfringen eller dokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      Enabled=HasIncomingDocument;
                      Image=ViewOrder;
                      OnAction=VAR
                                 IncomingDocument@1000 : Record 130;
                               BEGIN
                                 IncomingDocument.ShowCardFromEntryNo("Incoming Document Entry No.");
                               END;
                                }
      { 57      ;3   ;Action    ;
                      Name=SelectIncomingDoc;
                      AccessByPermission=TableData 130=R;
                      CaptionML=[ENU=Select Incoming Document;
                                 NOR=Velg inngende dokument];
                      ToolTipML=[ENU=Select an incoming document record and file attachment that you want to link to the entry or document.;
                                 NOR=Velg en post og et filvedlegg for innkommende dokument som du vil koble til oppfringen eller dokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      Image=SelectLineToApply;
                      OnAction=VAR
                                 IncomingDocument@1000 : Record 130;
                               BEGIN
                                 VALIDATE("Incoming Document Entry No.",IncomingDocument.SelectIncomingDocument("Incoming Document Entry No.",RECORDID));
                               END;
                                }
      { 55      ;3   ;Action    ;
                      Name=IncomingDocAttachFile;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Create Incoming Document from File;
                                 NOR=Opprett inngende dokument fra fil];
                      ToolTipML=[ENU=Create an incoming document record by selecting a file to attach, and then link the incoming document record to the entry or document.;
                                 NOR=Opprett en post for innkommende dokument ved  velge en fil som skal legges ved, og koble deretter posten for det innkommende dokumentet til oppfringen eller dokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      Enabled=NOT HasIncomingDocument;
                      Image=Attach;
                      OnAction=VAR
                                 IncomingDocumentAttachment@1000 : Record 133;
                               BEGIN
                                 IncomingDocumentAttachment.NewAttachmentFromSalesDocument(Rec);
                               END;
                                }
      { 53      ;3   ;Action    ;
                      Name=RemoveIncomingDoc;
                      CaptionML=[ENU=Remove Incoming Document;
                                 NOR=Fjern inngende dokument];
                      ToolTipML=[ENU=Remove incoming document records and file attachments.;
                                 NOR=Fjern innkommende dokumentposter og filvedlegg.];
                      ApplicationArea=#Basic,#Suite;
                      Enabled=HasIncomingDocument;
                      Image=RemoveLine;
                      OnAction=BEGIN
                                 "Incoming Document Entry No." := 0;
                               END;
                                }
      { 23      ;1   ;ActionGroup;
                      CaptionML=[ENU=Plan;
                                 NOR=Planlegging];
                      Image=Planning }
      { 197     ;2   ;Action    ;
                      AccessByPermission=TableData 99000880=R;
                      CaptionML=[ENU=Order &Promising;
                                 NOR=Ordr&ebekreftelse];
                      Image=OrderPromising;
                      OnAction=VAR
                                 OrderPromisingLine@1000 : TEMPORARY Record 99000880;
                               BEGIN
                                 OrderPromisingLine.SETRANGE("Source Type","Document Type");
                                 OrderPromisingLine.SETRANGE("Source ID","No.");
                                 PAGE.RUNMODAL(PAGE::"Order Promising Lines",OrderPromisingLine);
                               END;
                                }
      { 248     ;2   ;Action    ;
                      CaptionML=[ENU=Demand Overview;
                                 NOR=Behovsoversikt];
                      Image=Forecast;
                      OnAction=VAR
                                 DemandOverview@1000 : Page 5830;
                               BEGIN
                                 DemandOverview.SetCalculationParameter(TRUE);
                                 DemandOverview.Initialize(0D,1,"No.",'','');
                                 DemandOverview.RUNMODAL;
                               END;
                                }
      { 121     ;2   ;Action    ;
                      CaptionML=[ENU=Pla&nning;
                                 NOR=Pla&nlegging];
                      Image=Planning;
                      OnAction=VAR
                                 SalesPlanForm@1001 : Page 99000883;
                               BEGIN
                                 SalesPlanForm.SetSalesOrder("No.");
                                 SalesPlanForm.RUNMODAL;
                               END;
                                }
      { 25      ;1   ;ActionGroup;
                      CaptionML=[ENU=Request Approval;
                                 NOR=Be om godkjenning];
                      Image=SendApprovalRequest }
      { 250     ;2   ;Action    ;
                      Name=SendApprovalRequest;
                      CaptionML=[ENU=Send A&pproval Request;
                                 NOR=&Send godkjenningsforesprsel];
                      ToolTipML=[ENU=Send an approval request.;
                                 NOR=Send en godkjenningsforesprsel.];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      Enabled=NOT OpenApprovalEntriesExist;
                      Image=SendApprovalRequest;
                      PromotedCategory=Category9;
                      PromotedOnly=Yes;
                      OnAction=VAR
                                 ApprovalsMgmt@1001 : Codeunit 1535;
                               BEGIN
                                 IF ApprovalsMgmt.CheckSalesApprovalPossible(Rec) THEN
                                   ApprovalsMgmt.OnSendSalesDocForApproval(Rec);
                               END;
                                }
      { 251     ;2   ;Action    ;
                      Name=CancelApprovalRequest;
                      CaptionML=[ENU=Cancel Approval Re&quest;
                                 NOR=&Annuller godkjenningsforesprsel];
                      ToolTipML=[ENU=Cancel the approval request.;
                                 NOR=Annuller godkjenningsforesprselen.];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      Enabled=CanCancelApprovalForRecord;
                      Image=CancelApprovalRequest;
                      PromotedCategory=Category9;
                      PromotedOnly=Yes;
                      OnAction=VAR
                                 ApprovalsMgmt@1001 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.OnCancelSalesApprovalRequest(Rec);
                               END;
                                }
      { 3       ;1   ;ActionGroup;
                      CaptionML=[ENU=Warehouse;
                                 NOR=Lager];
                      Image=Warehouse }
      { 148     ;2   ;Action    ;
                      AccessByPermission=TableData 7342=R;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Create Inventor&y Put-away/Pick;
                                 NOR=Opprett lagerplas&sering/-plukk];
                      Promoted=Yes;
                      Image=CreateInventoryPickup;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CreateInvtPutAwayPick;

                                 IF NOT FIND('=><') THEN
                                   INIT;
                               END;
                                }
      { 149     ;2   ;Action    ;
                      AccessByPermission=TableData 7320=R;
                      CaptionML=[ENU=Create &Whse. Shipment;
                                 NOR=Opprett la&gerlevering];
                      Image=NewShipment;
                      OnAction=VAR
                                 GetSourceDocOutbound@1001 : Codeunit 5752;
                               BEGIN
                                 GetSourceDocOutbound.CreateFromSalesOrder(Rec);

                                 IF NOT FIND('=><') THEN
                                   INIT;
                               END;
                                }
      { 73      ;1   ;ActionGroup;
                      CaptionML=[ENU=P&osting;
                                 NOR=&Bokfring];
                      Image=Post }
      { 75      ;2   ;Action    ;
                      Name=Post;
                      ShortCutKey=F9;
                      Ellipsis=Yes;
                      CaptionML=[ENU=P&ost;
                                 NOR=B&okfr];
                      ToolTipML=[ENU=Finalize the document or journal by posting the amounts and quantities to the related accounts in your company books.;
                                 NOR=Fullfr dokumentet eller kladden ved  bokfre belpene og antallene til de relaterte kontoene i firmatablene.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PostOrder;
                      PromotedCategory=Category6;
                      OnAction=BEGIN
                                 Post(CODEUNIT::"Sales-Post (Yes/No)",NavigateAfterPost::"Posted Document");
                               END;
                                }
      { 19      ;2   ;Action    ;
                      Name=PostAndNew;
                      ShortCutKey=Shift+F9;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Post and New;
                                 NOR=Bokfr og ny];
                      Promoted=Yes;
                      Image=PostOrder;
                      PromotedCategory=Category6;
                      OnAction=BEGIN
                                 Post(CODEUNIT::"Sales-Post (Yes/No)",NavigateAfterPost::"New Document");
                               END;
                                }
      { 29      ;2   ;Action    ;
                      Name=PostAndSend;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Post and Send;
                                 NOR=Bokfr og Send];
                      ToolTipML=[ENU=Finalize and prepare to send the document according to the customer's sending profile, such as attached to an email. The Send document to window opens first so you can confirm or select a sending profile.;
                                 NOR=Fullfr og klargjr for  sende dokumentet i henhold til kundens sendingsprofil, for eksempel vedlagt i en e-post. Vinduet Send dokument til pnes slik at du kan bekrefte eller velge en sendingsprofil.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Image=PostMail;
                      PromotedCategory=Category6;
                      OnAction=BEGIN
                                 Post(CODEUNIT::"Sales-Post and Send",NavigateAfterPost::Nowhere);
                               END;
                                }
      { 74      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Test Report;
                                 NOR=Kontrollrapport];
                      ToolTipML=[ENU=View a test report so that you can find and correct any errors before you perform the actual posting of the journal or document.;
                                 NOR=Vis en kontrollrapport slik at du kan finne og rette eventuelle feil fr du bokfrer kladden eller dokumentet.];
                      Image=TestReport;
                      OnAction=BEGIN
                                 ReportPrint.PrintSalesHeader(Rec);
                               END;
                                }
      { 7       ;2   ;Action    ;
                      CaptionML=[ENU=Remove From Job Queue;
                                 NOR=Fjern fra jobbk];
                      ToolTipML=[ENU=Remove the scheduled processing of this record from the job queue.;
                                 NOR=Fjern den planlagte behandlingen av denne posten fra prosjektken.];
                      ApplicationArea=#All;
                      Visible=JobQueueVisible;
                      Image=RemoveLine;
                      OnAction=BEGIN
                                 CancelBackgroundPosting;
                               END;
                                }
      { 51      ;2   ;Action    ;
                      Name=PreviewPosting;
                      CaptionML=[ENU=Preview Posting;
                                 NOR=Forhndsvis bokfring];
                      ToolTipML=[ENU=Review the different types of entries that will be created when you post the document or journal.;
                                 NOR=Se gjennom de ulike typene poster som blir opprettet nr du bokfrer dokumentet eller kladden.];
                      ApplicationArea=#Basic,#Suite;
                      Image=ViewPostedOrder;
                      OnAction=BEGIN
                                 ShowPreview;
                               END;
                                }
      { 236     ;2   ;ActionGroup;
                      CaptionML=[ENU=Prepa&yment;
                                 NOR=&Forskudd];
                      Image=Prepayment }
      { 231     ;3   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Prepayment &Test Report;
                                 NOR=&Testrapport for forskudd];
                      Image=PrepaymentSimulation;
                      OnAction=BEGIN
                                 ReportPrint.PrintSalesHeaderPrepmt(Rec);
                               END;
                                }
      { 232     ;3   ;Action    ;
                      Name=PostPrepaymentInvoice;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Post Prepayment &Invoice;
                                 NOR=Bo&kfr forskuddsfaktura];
                      Image=PrepaymentPost;
                      OnAction=VAR
                                 SalesPostYNPrepmt@1000 : Codeunit 443;
                               BEGIN
                                 IF ApprovalsMgmt.PrePostApprovalCheckSales(Rec) THEN
                                   SalesPostYNPrepmt.PostPrepmtInvoiceYN(Rec,FALSE);
                               END;
                                }
      { 237     ;3   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Post and Print Prepmt. Invoic&e;
                                 NOR=Bokf&r og skriv ut forskuddsfaktura];
                      Image=PrepaymentPostPrint;
                      OnAction=VAR
                                 SalesPostYNPrepmt@1000 : Codeunit 443;
                               BEGIN
                                 IF ApprovalsMgmt.PrePostApprovalCheckSales(Rec) THEN
                                   SalesPostYNPrepmt.PostPrepmtInvoiceYN(Rec,TRUE);
                               END;
                                }
      { 233     ;3   ;Action    ;
                      Name=PostPrepaymentCreditMemo;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Post Prepayment &Credit Memo;
                                 NOR=Bokfr kredit&nota for forskudd];
                      Image=PrepaymentPost;
                      OnAction=VAR
                                 SalesPostYNPrepmt@1000 : Codeunit 443;
                               BEGIN
                                 IF ApprovalsMgmt.PrePostApprovalCheckSales(Rec) THEN
                                   SalesPostYNPrepmt.PostPrepmtCrMemoYN(Rec,FALSE);
                               END;
                                }
      { 238     ;3   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Post and Print Prepmt. Cr. Mem&o;
                                 NOR=Bokfr og skriv &ut kreditnota for forskudd];
                      Image=PrepaymentPostPrint;
                      OnAction=VAR
                                 SalesPostYNPrepmt@1000 : Codeunit 443;
                               BEGIN
                                 IF ApprovalsMgmt.PrePostApprovalCheckSales(Rec) THEN
                                   SalesPostYNPrepmt.PostPrepmtCrMemoYN(Rec,TRUE);
                               END;
                                }
      { 223     ;1   ;ActionGroup;
                      CaptionML=[ENU=&Print;
                                 NOR=&Skriv ut];
                      Image=Print }
      { 225     ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Work Order;
                                 NOR=Arbeidsordre];
                      Image=Print;
                      OnAction=BEGIN
                                 DocPrint.PrintSalesOrder(Rec,Usage::"Work Order");
                               END;
                                }
      { 5       ;2   ;Action    ;
                      CaptionML=[ENU=Pick Instruction;
                                 NOR=Plukkinstruksjon];
                      Image=Print;
                      OnAction=BEGIN
                                 DocPrint.PrintSalesOrder(Rec,Usage::"Pick Instruction");
                               END;
                                }
      { 31      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Order Confirmation;
                                 NOR=&Ordrebekreftelse];
                      Image=Email }
      { 33      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Email Confirmation;
                                 NOR=Send bekreftelse p e-post];
                      ToolTipML=[ENU=Send a sales order confirmation by email. The attachment is sent as a .pdf.;
                                 NOR=Send en ordrebekreftelse via e-post. Vedlegget sendes i PDF-format.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Image=Email;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 DocPrint.EmailSalesHeader(Rec);
                               END;
                                }
      { 224     ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Print Confirmation;
                                 NOR=Skriv ut bekreftelse];
                      ToolTipML=[ENU=Print a sales order confirmation.;
                                 NOR=Skriv ut en ordrebekreftelse.];
                      ApplicationArea=#Basic,#Suite;
                      Visible=NOT IsOfficeHost;
                      Image=Print;
                      OnAction=BEGIN
                                 DocPrint.PrintSalesOrder(Rec,Usage::"Order Confirmation");
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=[ENU=General;
                           NOR=Generelt] }

    { 2   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the sales document. The field can be filled automatically or manually and can be set up to be invisible.;
                           NOR=Angir antall salgsdokumenter. Feltet kan fylles ut automatisk eller manuelt, og kan settes opp til  vre usynlig.];
                ApplicationArea=#All;
                SourceExpr="No.";
                Visible=DocNoVisible;
                OnAssistEdit=BEGIN
                               IF AssistEdit(xRec) THEN
                                 CurrPage.UPDATE;
                             END;
                              }

    { 6   ;2   ;Field     ;
                CaptionML=[ENU=Customer;
                           NOR=Kunde];
                ToolTipML=[ENU=Specifies the name of the customer who will receive the products and be billed by default.;
                           NOR=Angir navnet p kunden som mottar produktene og faktureres som standard.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Sell-to Customer Name";
                OnValidate=BEGIN
                             IF GETFILTER("Sell-to Customer No.") = xRec."Sell-to Customer No." THEN
                               IF "Sell-to Customer No." <> xRec."Sell-to Customer No." THEN
                                 SETRANGE("Sell-to Customer No.");

                             IF ApplicationAreaSetup.IsFoundationEnabled THEN
                               SalesCalcDiscountByType.ApplyDefaultInvoiceDiscount(0,Rec);

                             SellToCustomerUsesEInvoicing := CustomerUsesEInvoicing("Sell-to Customer No.");

                             CurrPage.UPDATE;
                           END;

                ShowMandatory=TRUE;
                QuickEntry=FALSE }

    { 190 ;2   ;Group     ;
                CaptionML=[ENU=Sell-to;
                           NOR=Salg til];
                GroupType=Group }

    { 81  ;3   ;Field     ;
                CaptionML=[ENU=Address;
                           NOR=Adresse];
                ToolTipML=[ENU=Specifies the address where the customer is located.;
                           NOR=Angir adressen der kunden befinner seg.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Sell-to Address";
                Importance=Additional }

    { 83  ;3   ;Field     ;
                CaptionML=[ENU=Address 2;
                           NOR=Adresse 2];
                ToolTipML=[ENU=Specifies additional address information.;
                           NOR=Angir ekstra adresseinformasjon.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Sell-to Address 2";
                Importance=Additional }

    { 72  ;3   ;Field     ;
                CaptionML=[ENU=Post Code;
                           NOR=Postnr.];
                ToolTipML=[ENU=Specifies the postal code.;
                           NOR=Angir postnummeret.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Sell-to Post Code";
                Importance=Additional }

    { 86  ;3   ;Field     ;
                CaptionML=[ENU=City;
                           NOR=Sted];
                ToolTipML=[ENU=Specifies the city where the customer is located.;
                           NOR=Angir poststedet der kunden befinner seg.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Sell-to City";
                Importance=Additional }

    { 157 ;3   ;Field     ;
                CaptionML=[ENU=Contact No.;
                           NOR=Kontaktnr.];
                ToolTipML=[ENU=Specifies the number of the contact that the sales document will be sent to.;
                           NOR=Angir nummeret til kontakten som salgsdokumentet vil bli sendt til.];
                SourceExpr="Sell-to Contact No.";
                Importance=Additional;
                OnValidate=BEGIN
                             IF GETFILTER("Sell-to Contact No.") = xRec."Sell-to Contact No." THEN
                               IF "Sell-to Contact No." <> xRec."Sell-to Contact No." THEN
                                 SETRANGE("Sell-to Contact No.");
                           END;
                            }

    { 8   ;2   ;Field     ;
                CaptionML=[ENU=Contact;
                           NOR=Kontakt];
                ToolTipML=[ENU=Specifies the name of the person to contact at the customer.;
                           NOR=Angir navnet p kontaktpersonen hos kunden.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Sell-to Contact" }

    { 198 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of archived versions for this sales document.;
                           NOR=Angir antall arkiverte versjoner for dette salgsdokumentet.];
                SourceExpr="No. of Archived Versions";
                Importance=Additional }

    { 1080016;2;Field     ;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Your Reference";
                ShowMandatory=SellToCustomerUsesEInvoicing }

    { 45  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date on which you created the sales document.;
                           NOR=Angir datoen da du opprettet salgsdokumentet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Document Date";
                Importance=Additional }

    { 12  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date when the posting of the sales document will be recorded.;
                           NOR=Angir datoen nr bokfringen av salgsdokumentet blir registrert.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Posting Date";
                Importance=Promoted }

    { 14  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date on which the exchange rate applies to prices listed in a foreign currency on the sales order.;
                           NOR=Angir datoen for gjeldende valutakurs for priser som er oppfrt i en fremmed valuta p ordren.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Order Date";
                Importance=Promoted;
                QuickEntry=FALSE }

    { 30  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies when the sales invoice must be paid.;
                           NOR=Angir nr salgsfakturaen m betales.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Due Date";
                Importance=Promoted }

    { 135 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date that the customer has asked for the order to be delivered.;
                           NOR=Angir p hvilken dato kunden har bedt om at ordren skal leveres.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Requested Delivery Date" }

    { 137 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date that you have promised to deliver the order, as a result of the Order Promising function.;
                           NOR=Angir datoen da du har lovet  levere ordren som et resultat av funksjonen Ordrebekreftelse.];
                SourceExpr="Promised Delivery Date";
                Importance=Additional }

    { 155 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number that the customer uses in their own system to refer to this sales document.;
                           NOR=Angir nummeret som kunden bruker i sitt eget system for  referere til dette salgsdokumentet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="External Document No.";
                Importance=Promoted;
                ShowMandatory=ExternalDocNoMandatory OR SellToCustomerUsesEInvoicing }

    { 10  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the name of the salesperson who is assigned to the customer.;
                           NOR=Angir navnet p selgeren som er knyttet til kunden.];
                ApplicationArea=#Suite;
                SourceExpr="Salesperson Code";
                Importance=Additional;
                OnValidate=BEGIN
                             SalespersonCodeOnAfterValidate;
                           END;

                QuickEntry=FALSE }

    { 1148;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the campaign that the document is linked to.;
                           NOR=Angir nummeret p kampanjen som dokumentet er knyttet til.];
                SourceExpr="Campaign No.";
                Importance=Additional }

    { 245 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the opportunity that the sales quote is assigned to.;
                           NOR=Angir nummeret for salgsmuligheten som tilbudet er tilordnet til.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Opportunity No.";
                Importance=Additional }

    { 124 ;2   ;Field     ;
                AccessByPermission=TableData 5714=R;
                ToolTipML=[ENU=Specifies the code of the responsibility center that is associated with the user, company, or vendor.;
                           NOR=Angir koden for ansvarssentret som er knyttet til brukeren, firmaet eller leverandren.];
                SourceExpr="Responsibility Center";
                Importance=Additional }

    { 241 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the ID of the user who is responsible for the document.;
                           NOR=Angir ID-en til brukeren som er ansvarlig for dokumentet.];
                SourceExpr="Assigned User ID";
                Importance=Additional }

    { 9   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the status of a job queue entry or task that handles the posting of sales orders.;
                           NOR=Angir status for en jobbkpost eller oppgave som hndterer bokfring av ordrer.];
                ApplicationArea=#All;
                SourceExpr="Job Queue Status";
                Importance=Additional;
                Visible=JobQueuesUsed }

    { 129 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies whether the document is open, waiting to be approved, has been invoiced for prepayment, or has been released to the next stage of processing.;
                           NOR=Angir om dokumentet er pent, om det venter p godkjenning, om det er fakturert for forskudd eller om det er frigitt til neste fase i behandlingen.];
                SourceExpr=Status;
                Importance=Promoted;
                QuickEntry=FALSE }

    { 58  ;1   ;Part      ;
                Name=SalesLines;
                ApplicationArea=#Basic,#Suite;
                SubPageLink=Document No.=FIELD(No.);
                PagePartID=Page46;
                Enabled="Sell-to Customer No." <> '';
                Editable=DynamicEditable;
                UpdatePropagation=Both }

    { 1905885101;1;Group  ;
                CaptionML=[ENU=Invoice Details;
                           NOR=Fakturadetaljer];
                GroupType=Group }

    { 111 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the currency of amounts on the sales document.;
                           NOR=Angir valutaen til belpene p salgsdokumentet.];
                ApplicationArea=#Suite;
                SourceExpr="Currency Code";
                Importance=Promoted;
                OnValidate=BEGIN
                             CurrPage.UPDATE;
                             SalesCalcDiscountByType.ApplyDefaultInvoiceDiscount(0,Rec);
                           END;

                OnAssistEdit=BEGIN
                               CLEAR(ChangeExchangeRate);
                               IF "Posting Date" <> 0D THEN
                                 ChangeExchangeRate.SetParameter("Currency Code","Currency Factor","Posting Date")
                               ELSE
                                 ChangeExchangeRate.SetParameter("Currency Code","Currency Factor",WORKDATE);
                               IF ChangeExchangeRate.RUNMODAL = ACTION::OK THEN BEGIN
                                 VALIDATE("Currency Factor",ChangeExchangeRate.GetParameter);
                                 CurrPage.UPDATE;
                               END;
                               CLEAR(ChangeExchangeRate);
                             END;
                              }

    { 50  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date you expect to ship items on the sales document.;
                           NOR=Angir datoen du forventer  levere varer, p salgsdokumentet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Shipment Date";
                Importance=Promoted }

    { 243 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the sales quote that the sales order was created from. You can track the number to sales quote documents that you have printed, saved, or emailed.;
                           NOR=Angir nummeret p tilbudet som ordren ble opprettet fra. Du kan spore nummeret til tilbudsdokumenter du har skrevet ut, lagret eller sendt via e-post.];
                ApplicationArea=#All;
                SourceExpr="Quote No.";
                Visible=ShowQuoteNo }

    { 131 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies whether the unit price on the line should be displayed including or excluding VAT.;
                           NOR=Angir om salgsprisen p linjen skal vises inklusiv eller eksklusiv mva.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Prices Including VAT";
                OnValidate=BEGIN
                             PricesIncludingVATOnAfterValid;
                           END;
                            }

    { 221 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the customer's VAT specification to link transactions made for this customer to.;
                           NOR=Angir kundens mva-spesifikasjon for  koble transaksjoner som er gjort for kunden, til.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="VAT Bus. Posting Group";
                OnValidate=BEGIN
                             IF ApplicationAreaSetup.IsFoundationEnabled THEN
                               SalesCalcDiscountByType.ApplyDefaultInvoiceDiscount(0,Rec);

                             CurrPage.UPDATE;
                           END;
                            }

    { 28  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a formula that calculates the payment due date, payment discount date, and payment discount amount on the sales document.;
                           NOR=Angir en formel som beregner forfallsdatoen for betalingen, kontantrabattdatoen og kontantrabattbelpet, p salgsdokumentet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Payment Terms Code";
                Importance=Promoted }

    { 105 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies how the customer must pay for products on the sales document.;
                           NOR=Angir hvordan kunden m betale for produkter p salgsdokumentet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Payment Method Code";
                Importance=Additional;
                OnValidate=BEGIN
                             UpdatePaymentService;
                           END;
                            }

    { 76  ;2   ;Group     ;
                Visible=PaymentServiceVisible;
                GroupType=Group }

    { 16  ;3   ;Field     ;
                Name=SelectedPayments;
                CaptionML=[ENU=Payment Service;
                           NOR=Betalingstjeneste];
                ToolTipML=[ENU=Specifies the online payment service, such as PayPal, that customers can use to pay the sales document.;
                           NOR=Angir den elektroniske betalingstjenesten, for eksempel PayPal, som kunder kan bruke til  betale salgsdokumentet.];
                ApplicationArea=#All;
                SourceExpr=GetSelectedPaymentServicesText;
                Enabled=PaymentServiceEnabled;
                Editable=FALSE;
                MultiLine=Yes;
                OnAssistEdit=BEGIN
                               ChangePaymentServiceSetting;
                             END;
                              }

    { 54  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the type of transaction that the sales document represents, for the purpose of reporting to INTRASTAT.;
                           NOR=Angir transaksjonstypen som salgsdokumentet representerer ved rapportering til INTRASTAT.];
                SourceExpr="Transaction Type" }

    { 84  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the dimension value code associated with the sales header.;
                           NOR=Angir dimensjonsverdikoden som er knyttet til salgshodet.];
                SourceExpr="Shortcut Dimension 1 Code";
                OnValidate=BEGIN
                             ShortcutDimension1CodeOnAfterV;
                           END;
                            }

    { 92  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the dimension value code associated with the sales header.;
                           NOR=Angir dimensjonsverdikoden som er knyttet til salgshodet.];
                SourceExpr="Shortcut Dimension 2 Code";
                OnValidate=BEGIN
                             ShortcutDimension2CodeOnAfterV;
                           END;
                            }

    { 32  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the payment discount percentage granted if the customer pays on or before the date entered in the Pmt. Discount Date field.;
                           NOR=Angir kontantrabattprosenten som gis hvis kunden betaler innen den datoen som er satt inn i feltet Kont.rabattdato.];
                SourceExpr="Payment Discount %" }

    { 34  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the last date the customer can pay the invoice and still receive a payment discount.;
                           NOR=Angir den datoen som fakturaen senest skal betales, hvis kunden skal oppn kontantrabatt.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pmt. Discount Date";
                Importance=Additional }

    { 27  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the direct-debit mandate that the customer has signed to allow direct debit collection of payments.;
                           NOR=Angir Direct Debit-belastningsfullmakten som kunden har signert for  tillate Direct Debit-oppkreving av utbetalinger.];
                SourceExpr="Direct Debit Mandate ID" }

    { 94  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the location from where inventory items to the customer on the sales document are to be shipped by default.;
                           NOR=Angir plasseringen der lagervarer til kunden p salgsdokumentet leveres fra som standard.];
                SourceExpr="Location Code" }

    { 143 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies how long it takes from when the sales order is shipped from the warehouse to when the order is delivered.;
                           NOR=Angir hvor lang tid det tar fra ordren leveres fra lageret til ordren er levert til kundens adresse.];
                SourceExpr="Shipping Time";
                Importance=Additional }

    { 145 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies that the shipment of one or more lines has been delayed, or that the shipment date is before the work date.;
                           NOR=Angir at leveringen av n eller flere linjer er forsinket, eller at leveringsdatoen er fr arbeidsdatoen.];
                SourceExpr="Late Order Shipping";
                Importance=Additional }

    { 119 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies if the customer accepts partial shipment of orders.;
                           NOR=Angir om kunden godtar dellevering av ordrer.];
                SourceExpr="Shipping Advice";
                Importance=Additional;
                OnValidate=BEGIN
                             IF "Shipping Advice" <> xRec."Shipping Advice" THEN
                               IF NOT CONFIRM(Text001,FALSE,FIELDCAPTION("Shipping Advice")) THEN
                                 ERROR(Text002);
                           END;
                            }

    { 141 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the outbound warehouse handling time.;
                           NOR=Angir utgende lagerbehandlingstid.];
                SourceExpr="Outbound Whse. Handling Time";
                Importance=Additional }

    { 1906801201;1;Group  ;
                CaptionML=[ENU=Shipping and Billing;
                           NOR=Levering og fakturering];
                GroupType=Group }

    { 91  ;2   ;Group     ;
                GroupType=Group }

    { 90  ;3   ;Group     ;
                GroupType=Group }

    { 88  ;4   ;Field     ;
                Name=ShippingOptions;
                CaptionML=[ENU=Ship-to;
                           NOR=Ship-to];
                ToolTipML=[ENU=Specifies the address that the products on the sales document are shipped to. Default (Sell-to Address): The same as the customer's sell-to address. Alternate Ship-to Address: One of the customer's alternate ship-to addresses. Custom Address: Any ship-to address that you specify in the fields below.;
                           NOR=Specifies the address that the products on the sales document are shipped to. Default (Sell-to Address): The same as the customer's sell-to address. Alternate Ship-to Address: One of the customer's alternate ship-to addresses. Custom Address: Any ship-to address that you specify in the fields below.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=ShipToOptions;
                OnValidate=VAR
                             ShipToAddress@1001 : Record 222;
                             ShipToAddressList@1000 : Page 301;
                           BEGIN
                             CASE ShipToOptions OF
                               ShipToOptions::"Default (Sell-to Address)":
                                 BEGIN
                                   VALIDATE("Ship-to Code",'');
                                   CopySellToAddressToShipToAddress;
                                 END;
                               ShipToOptions::"Alternate Shipping Address":
                                 BEGIN
                                   ShipToAddress.SETRANGE("Customer No.","Sell-to Customer No.");
                                   ShipToAddressList.LOOKUPMODE := TRUE;
                                   ShipToAddressList.SETTABLEVIEW(ShipToAddress);

                                   IF ShipToAddressList.RUNMODAL = ACTION::LookupOK THEN BEGIN
                                     ShipToAddressList.GETRECORD(ShipToAddress);
                                     VALIDATE("Ship-to Code",ShipToAddress.Code);
                                   END ELSE
                                     ShipToOptions := ShipToOptions::"Custom Address";
                                 END;
                               ShipToOptions::"Custom Address":
                                 VALIDATE("Ship-to Code",'');
                             END;
                           END;
                            }

    { 4   ;4   ;Group     ;
                Visible=NOT (ShipToOptions = ShipToOptions::"Default (Sell-to Address)");
                GroupType=Group }

    { 36  ;5   ;Field     ;
                CaptionML=[ENU=Code;
                           NOR=Kode];
                ToolTipML=[ENU=Specifies the code for another shipment address than the customer's own address, which is entered by default.;
                           NOR=Angir koden for en annen leveringsadresse enn kundens egen adresse, som er angitt som standard.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Code";
                Importance=Promoted;
                Editable=ShipToOptions = ShipToOptions::"Alternate Shipping Address";
                OnValidate=BEGIN
                             IF (xRec."Ship-to Code" <> '') AND ("Ship-to Code" = '') THEN
                               ERROR(EmptyShipToCodeErr);
                           END;
                            }

    { 38  ;5   ;Field     ;
                CaptionML=[ENU=Name;
                           NOR=Navn];
                ToolTipML=[ENU=Specifies the name that products on the sales document will be shipped to.;
                           NOR=Angir navnet som produkter p salgsdokumentet skal leveres til.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Name";
                Editable=ShipToOptions = ShipToOptions::"Custom Address" }

    { 40  ;5   ;Field     ;
                CaptionML=[ENU=Address;
                           NOR=Adresse];
                ToolTipML=[ENU=Specifies the address that products on the sales document will be shipped to.;
                           NOR=Angir adressen som produkter p salgsdokumentet skal leveres til.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Address";
                Editable=ShipToOptions = ShipToOptions::"Custom Address" }

    { 42  ;5   ;Field     ;
                CaptionML=[ENU=Address 2;
                           NOR=Adresse 2];
                ToolTipML=[ENU=Specifies additional address information.;
                           NOR=Angir ekstra adresseinformasjon.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Address 2";
                Editable=ShipToOptions = ShipToOptions::"Custom Address" }

    { 97  ;5   ;Field     ;
                CaptionML=[ENU=Post Code;
                           NOR=Postnr.];
                ToolTipML=[ENU=Specifies the postal code.;
                           NOR=Angir postnummeret.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Post Code";
                Editable=ShipToOptions = ShipToOptions::"Custom Address" }

    { 44  ;5   ;Field     ;
                CaptionML=[ENU=City;
                           NOR=Sted];
                ToolTipML=[ENU=Specifies the city that products on the sales document will be shipped to.;
                           NOR=Angir poststedet som produkter p salgsdokumentet skal leveres til.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to City";
                Editable=ShipToOptions = ShipToOptions::"Custom Address" }

    { 95  ;5   ;Field     ;
                CaptionML=[ENU=Country/Region;
                           NOR=Country/Region];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Country/Region Code";
                Importance=Additional;
                Editable=ShipToOptions = ShipToOptions::"Custom Address" }

    { 46  ;5   ;Field     ;
                CaptionML=[ENU=Contact;
                           NOR=Kontakt];
                ToolTipML=[ENU=Specifies the name of the contact person at the address that products on the sales document will be shipped to.;
                           NOR=Angir navnet p kontaktpersonen i adressen som produkter p salgsdokumentet skal leveres til.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Contact";
                Editable=ShipToOptions = ShipToOptions::"Custom Address" }

    { 77  ;3   ;Group     ;
                CaptionML=[ENU=Shipment Method;
                           NOR=Leveringsmte];
                GroupType=Group }

    { 48  ;4   ;Field     ;
                CaptionML=[ENU=Code;
                           NOR=Kode];
                ToolTipML=[ENU=Specifies how items on the sales document are shipped to the customer.;
                           NOR=Angir hvordan varer p salgsdokumentet leveres til kunden.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Shipment Method Code";
                Importance=Additional }

    { 107 ;4   ;Field     ;
                CaptionML=[ENU=Agent;
                           NOR=Selger];
                ToolTipML=[ENU=Specifies which shipping agent is used to transport the items on the sales document to the customer.;
                           NOR=Angir hvilken transportr som skal brukes til  transportere varene p salgsdokumentet til kunden.];
                ApplicationArea=#Suite;
                SourceExpr="Shipping Agent Code";
                Importance=Additional }

    { 139 ;4   ;Field     ;
                CaptionML=[ENU=Agent Service;
                           NOR=Selgertjeneste];
                ToolTipML=[ENU=Specifies the code that represents the default shipping agent service you are using for this sales order.;
                           NOR=Angir koden som representerer standard transportrservice som du bruker for denne ordren.];
                ApplicationArea=#Suite;
                SourceExpr="Shipping Agent Service Code";
                Importance=Additional }

    { 109 ;4   ;Field     ;
                ToolTipML=[ENU=Specifies the shipping agent's package number.;
                           NOR=Angir transportrens pakkenummer.];
                ApplicationArea=#Suite;
                SourceExpr="Package Tracking No.";
                Importance=Additional }

    { 85  ;2   ;Group     ;
                GroupType=Group }

    { 93  ;3   ;Field     ;
                CaptionML=[ENU=Bill-to;
                           NOR=Bill-to];
                ToolTipML=[ENU=Specifies the customer that the sales invoice will be sent to. Default (Customer): The same as the customer on the sales invoice. Another Customer: Any customer that you specify in the fields below.;
                           NOR=Specifies the customer that the sales invoice will be sent to. Default (Customer): The same as the customer on the sales invoice. Another Customer: Any customer that you specify in the fields below.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=BillToOptions;
                OnValidate=BEGIN
                             IF BillToOptions = BillToOptions::"Default (Customer)" THEN
                               VALIDATE("Bill-to Customer No.","Sell-to Customer No.");
                           END;
                            }

    { 82  ;3   ;Group     ;
                Visible=BillToOptions = BillToOptions::"Another Customer";
                GroupType=Group }

    { 18  ;4   ;Field     ;
                CaptionML=[ENU=Name;
                           NOR=Navn];
                ToolTipML=[ENU=Specifies the customer to whom you will send the sales invoice, when different from the customer that you are selling to.;
                           NOR=Angir kunden som du sender salgsfakturaen til, nr det er en annen enn kunden som du selger til.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Bill-to Name";
                Importance=Promoted;
                OnValidate=BEGIN
                             IF GETFILTER("Bill-to Customer No.") = xRec."Bill-to Customer No." THEN
                               IF "Bill-to Customer No." <> xRec."Bill-to Customer No." THEN
                                 SETRANGE("Bill-to Customer No.");

                             IF ApplicationAreaSetup.IsFoundationEnabled THEN
                               SalesCalcDiscountByType.ApplyDefaultInvoiceDiscount(0,Rec);

                             CurrPage.UPDATE;
                           END;
                            }

    { 20  ;4   ;Field     ;
                CaptionML=[ENU=Address;
                           NOR=Adresse];
                ToolTipML=[ENU=Specifies the address of the customer that you will send the invoice to.;
                           NOR=Angir adressen til kunden som fakturaen skal sendes til.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Bill-to Address";
                Importance=Additional }

    { 22  ;4   ;Field     ;
                CaptionML=[ENU=Address 2;
                           NOR=Adresse 2];
                ToolTipML=[ENU=Specifies additional address information.;
                           NOR=Angir ekstra adresseinformasjon.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Bill-to Address 2";
                Importance=Additional }

    { 89  ;4   ;Field     ;
                CaptionML=[ENU=Post Code;
                           NOR=Postnr.];
                ToolTipML=[ENU=Specifies the postal code.;
                           NOR=Angir postnummeret.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Bill-to Post Code";
                Importance=Additional }

    { 24  ;4   ;Field     ;
                CaptionML=[ENU=City;
                           NOR=Sted];
                ToolTipML=[ENU=Specifies the city you will send the invoice to.;
                           NOR=Angir poststedet som fakturaen skal sendes til.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Bill-to City";
                Importance=Additional }

    { 159 ;4   ;Field     ;
                CaptionML=[ENU=Contact No.;
                           NOR=Kontaktnr.];
                ToolTipML=[ENU=Specifies the number of the contact the invoice will be sent to.;
                           NOR=Angir nummeret til kontakten som fakturaen vil bli sendt til.];
                SourceExpr="Bill-to Contact No.";
                Importance=Additional }

    { 26  ;4   ;Field     ;
                CaptionML=[ENU=Contact;
                           NOR=Kontakt];
                ToolTipML=[ENU=Specifies the name of the person you should contact at the customer who you are sending the invoice to.;
                           NOR=Angir navnet p kontaktperson hos kunden som fakturaen blir sendt til.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Bill-to Contact" }

    { 1080006;2;Field     ;
                ToolTipML=[ENU=Specifies the GLN for the customer.;
                           NOR=Specifies the GLN for the customer.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=GLN }

    { 1080012;2;Field     ;
                ToolTipML=[ENU=Specifies the account code of the customer.;
                           NOR=Specifies the account code of the customer.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Account Code";
                OnValidate=BEGIN
                             AccountCodeOnAfterValidate;
                           END;
                            }

    { 1080008;2;Field     ;
                ToolTipML=[ENU=Specifies whether the customer is part of the EHF system and requires an electronic sales order.;
                           NOR=Specifies whether the customer is part of the EHF system and requires an electronic sales order.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="E-Invoice" }

    { 1907468901;1;Group  ;
                CaptionML=[ENU=Foreign Trade;
                           NOR=Utenrikshandel] }

    { 52  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies whether the sales document is part of a three-party trade.;
                           NOR=Angir om salgsdokumentet er en del av en tredjepartshandel.];
                SourceExpr="EU 3-Party Trade" }

    { 103 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a code for the sales document's transaction specification, for the purpose of reporting to INTRASTAT.;
                           NOR=Angir en kode for salgsdokumentets transaksjonsspesifikasjon ved rapportering til INTRASTAT.];
                SourceExpr="Transaction Specification" }

    { 56  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the transport method, for the purpose of reporting to INTRASTAT.;
                           NOR=Angir transportmten ved rapportering til INTRASTAT.];
                SourceExpr="Transport Method" }

    { 99  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the point of exit through which you ship the items out of your country/region, for reporting to Intrastat.;
                           NOR=Angir utskipningshavnen du sender varene ut av landet/regionen fra ved rapportering til Intrastat.];
                SourceExpr="Exit Point" }

    { 101 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the area of the customer's address, for the purpose of reporting to INTRASTAT.;
                           NOR=Angir omrdet i kundens adresse for rapportering til INTRASTAT.];
                SourceExpr=Area }

    { 1900201301;1;Group  ;
                CaptionML=[ENU=Prepayment;
                           NOR=Forskudd] }

    { 228 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the prepayment percentage if you want to apply a prepayment to all lines on the sales order.;
                           NOR=Angir forskuddsprosenten hvis du vil bruke et forskudd p alle linjer p ordren.];
                SourceExpr="Prepayment %";
                Importance=Promoted;
                OnValidate=BEGIN
                             Prepayment37OnAfterValidate;
                           END;
                            }

    { 229 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies that prepayments on the sales order are combined if they have the same general ledger account for prepayments or the same dimensions.;
                           NOR=Angir at forskudd p ordren er kombinert hvis de har samme finanskonto for forskudd eller de samme dimensjonene.];
                SourceExpr="Compress Prepayment" }

    { 162 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code that represents the payment terms for prepayment invoices related to the sales document.;
                           NOR=Angir koden som representerer betalingsbetingelsene for forskuddsfakturaer som er knyttet til salgsdokumentet.];
                SourceExpr="Prepmt. Payment Terms Code" }

    { 239 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies when the prepayment invoice for this sales order is due.;
                           NOR=Angir nr forskuddsfakturaen for denne ordren forfaller.];
                SourceExpr="Prepayment Due Date";
                Importance=Promoted }

    { 164 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the payment discount percent granted on the prepayment if the customer pays on or before the date entered in the Prepmt. Pmt. Discount Date field.;
                           NOR=Angir kontantrabattprosenten som gis for forskuddet hvis kunden betaler innen den datoen som er satt inn i feltet Rabattdato for betaling for forskudd.];
                SourceExpr="Prepmt. Payment Discount %" }

    { 70  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the last date the customer can pay the prepayment invoice and still receive a payment discount on the prepayment amount.;
                           NOR=Angir den siste datoen for nr kunden kan betale forskuddsfakturaen og likevel motta kontantrabatt p forskuddsbelpet.];
                SourceExpr="Prepmt. Pmt. Discount Date" }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1101103000;1;Part   ;
                Name=DocumentFileFactBox;
                PagePartID=Page53202;
                PartType=Page }

    { 35  ;1   ;Part      ;
                ApplicationArea=#All;
                SubPageLink=Table ID=CONST(36),
                            Document Type=FIELD(Document Type),
                            Document No.=FIELD(No.);
                PagePartID=Page9103;
                Visible=OpenApprovalEntriesExistForCurrUser;
                PartType=Page }

    { 1903720907;1;Part   ;
                SubPageLink=No.=FIELD(Sell-to Customer No.);
                PagePartID=Page9080;
                PartType=Page }

    { 1902018507;1;Part   ;
                SubPageLink=No.=FIELD(Bill-to Customer No.);
                PagePartID=Page9082;
                Visible=FALSE;
                PartType=Page }

    { 1900316107;1;Part   ;
                SubPageLink=No.=FIELD(Sell-to Customer No.);
                PagePartID=Page9084;
                PartType=Page }

    { 1906127307;1;Part   ;
                ApplicationArea=#Suite;
                SubPageLink=Document Type=FIELD(Document Type),
                            Document No.=FIELD(Document No.),
                            Line No.=FIELD(Line No.);
                PagePartID=Page9087;
                ProviderID=58;
                PartType=Page }

    { 1901314507;1;Part   ;
                SubPageLink=No.=FIELD(No.);
                PagePartID=Page9089;
                ProviderID=58;
                PartType=Page }

    { 1906354007;1;Part   ;
                SubPageLink=Table ID=CONST(36),
                            Document Type=FIELD(Document Type),
                            Document No.=FIELD(No.);
                PagePartID=Page9092;
                Visible=FALSE;
                PartType=Page }

    { 49  ;1   ;Part      ;
                Name=IncomingDocAttachFactBox;
                PagePartID=Page193;
                Visible=FALSE;
                PartType=Page;
                ShowFilter=No }

    { 1907012907;1;Part   ;
                SubPageLink=No.=FIELD(No.);
                PagePartID=Page9108;
                ProviderID=58;
                Visible=FALSE;
                PartType=Page }

    { 1901796907;1;Part   ;
                SubPageLink=No.=FIELD(No.);
                PagePartID=Page9109;
                ProviderID=58;
                Visible=FALSE;
                PartType=Page }

    { 1907234507;1;Part   ;
                SubPageLink=No.=FIELD(Bill-to Customer No.);
                PagePartID=Page9081;
                Visible=FALSE;
                PartType=Page }

    { 80  ;1   ;Part      ;
                Name=WorkflowStatus;
                ApplicationArea=#All;
                PagePartID=Page1528;
                Visible=ShowWorkflowStatus;
                Enabled=FALSE;
                Editable=FALSE;
                PartType=Page;
                ShowFilter=No }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      ApplicationAreaSetup@1022 : Record 9178;
      CopySalesDoc@1001 : Report 292;
      MoveNegSalesLines@1007 : Report 6699;
      ApprovalsMgmt@1012 : Codeunit 1535;
      ReportPrint@1002 : Codeunit 228;
      DocPrint@1003 : Codeunit 229;
      ArchiveManagement@1008 : Codeunit 5063;
      SalesCalcDiscountByType@1014 : Codeunit 56;
      ChangeExchangeRate@1005 : Page 511;
      UserMgt@1006 : Codeunit 5700;
      Usage@1010 : 'Order Confirmation,Work Order,Pick Instruction';
      NavigateAfterPost@1029 : 'Posted Document,New Document,Nowhere';
      JobQueueVisible@1004 : Boolean INDATASET;
      Text001@1015 : TextConst 'ENU=Do you want to change %1 in all related records in the warehouse?;NOR=Vil du endre %1 i alle tilhrende poster p lager?';
      Text002@1011 : TextConst 'ENU=The update has been interrupted to respect the warning.;NOR=Oppdateringen er avbrutt som en reaksjon p advarselen.';
      DynamicEditable@1009 : Boolean;
      HasIncomingDocument@1020 : Boolean;
      DocNoVisible@1013 : Boolean;
      SellToCustomerUsesEInvoicing@1080000 : Boolean;
      ExternalDocNoMandatory@1016 : Boolean;
      OpenApprovalEntriesExistForCurrUser@1024 : Boolean;
      OpenApprovalEntriesExist@1023 : Boolean;
      CRMIntegrationEnabled@1000 : Boolean;
      CRMIsCoupledToRecord@1017 : Boolean;
      ShowWorkflowStatus@1018 : Boolean;
      IsOfficeHost@1019 : Boolean;
      CanCancelApprovalForRecord@1021 : Boolean;
      JobQueuesUsed@1026 : Boolean;
      ShowQuoteNo@1025 : Boolean;
      DocumentIsPosted@1027 : Boolean;
      OpenPostedSalesOrderQst@1028 : TextConst 'ENU=The order has been posted and moved to the Posted Sales Invoices window.\\Do you want to open the posted invoice?;NOR=Ordren er bokfrt og flyttet til vinduet Bokfrte salgsfakturaer.\\Vil du pne den bokfrte fakturaen?';
      PaymentServiceVisible@1030 : Boolean;
      PaymentServiceEnabled@1031 : Boolean;
      ShipToOptions@1033 : 'Default (Sell-to Address),Alternate Shipping Address,Custom Address';
      BillToOptions@1032 : 'Default (Customer),Another Customer';
      EmptyShipToCodeErr@1034 : TextConst 'ENU=The Code field can only be empty if you select Custom Address in the Ship-to field.;NOR=The Code field can only be empty if you select Custom Address in the Ship-to field.';

    LOCAL PROCEDURE Post@4(PostingCodeunitID@1000 : Integer;Navigate@1004 : Option);
    VAR
      SalesHeader@1001 : Record 36;
      LinesInstructionMgt@1002 : Codeunit 1320;
      InstructionMgt@1003 : Codeunit 1330;
    BEGIN
      IF ApplicationAreaSetup.IsFoundationEnabled THEN
        LinesInstructionMgt.SalesCheckAllLinesHaveQuantityAssigned(Rec);

      SendToPosting(PostingCodeunitID);
      DocumentIsPosted := NOT SalesHeader.GET("Document Type","No.");

      IF "Job Queue Status" = "Job Queue Status"::"Scheduled for Posting" THEN
        CurrPage.CLOSE;
      CurrPage.UPDATE(FALSE);

      IF PostingCodeunitID <> CODEUNIT::"Sales-Post (Yes/No)" THEN
        EXIT;

      CASE Navigate OF
        NavigateAfterPost::"Posted Document":
          IF InstructionMgt.IsEnabled(InstructionMgt.ShowPostedConfirmationMessageCode) THEN
            ShowPostedConfirmationMessage;
        NavigateAfterPost::"New Document":
          IF DocumentIsPosted THEN BEGIN
            SalesHeader.INIT;
            SalesHeader.VALIDATE("Document Type",SalesHeader."Document Type"::Order);
            SalesHeader.INSERT(TRUE);
            PAGE.RUN(PAGE::"Sales Order",SalesHeader);
          END;
      END;
    END;

    LOCAL PROCEDURE ApproveCalcInvDisc@3();
    BEGIN
      CurrPage.SalesLines.PAGE.ApproveCalcInvDisc;
    END;

    LOCAL PROCEDURE SalespersonCodeOnAfterValidate@19011896();
    BEGIN
      CurrPage.SalesLines.PAGE.UpdateForm(TRUE);
    END;

    LOCAL PROCEDURE ShortcutDimension1CodeOnAfterV@19029405();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE ShortcutDimension2CodeOnAfterV@19008725();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE PricesIncludingVATOnAfterValid@19009096();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE AccountCodeOnAfterValidate@19007267();
    BEGIN
      CurrPage.SalesLines.PAGE.UpdateForm(TRUE)
    END;

    LOCAL PROCEDURE Prepayment37OnAfterValidate@19040510();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE SetDocNoVisible@2();
    VAR
      DocumentNoVisibility@1000 : Codeunit 1400;
      DocType@1003 : 'Quote,Order,Invoice,Credit Memo,Blanket Order,Return Order,Reminder,FinChMemo';
    BEGIN
      DocNoVisible := DocumentNoVisibility.SalesDocumentNoIsVisible(DocType::Order,"No.");
    END;

    LOCAL PROCEDURE CustomerUsesEInvoicing@1060002(CustomerNo@1060000 : Code[20]) : Boolean;
    VAR
      Customer@1060001 : Record 18;
    BEGIN
      IF Customer.GET(CustomerNo) THEN
        EXIT (Customer."E-Invoice");
      EXIT(FALSE)
    END;

    LOCAL PROCEDURE SetExtDocNoMandatoryCondition@5();
    VAR
      SalesReceivablesSetup@1000 : Record 311;
    BEGIN
      SalesReceivablesSetup.GET;
      ExternalDocNoMandatory := SalesReceivablesSetup."Ext. Doc. No. Mandatory"
    END;

    LOCAL PROCEDURE ShowPreview@6();
    VAR
      SalesPostYesNo@1000 : Codeunit 81;
    BEGIN
      SalesPostYesNo.Preview(Rec);
    END;

    LOCAL PROCEDURE SetControlVisibility@7();
    VAR
      ApprovalsMgmt@1002 : Codeunit 1535;
    BEGIN
      JobQueueVisible := "Job Queue Status" = "Job Queue Status"::"Scheduled for Posting";
      HasIncomingDocument := "Incoming Document Entry No." <> 0;
      SetExtDocNoMandatoryCondition;

      OpenApprovalEntriesExistForCurrUser := ApprovalsMgmt.HasOpenApprovalEntriesForCurrentUser(RECORDID);
      OpenApprovalEntriesExist := ApprovalsMgmt.HasOpenApprovalEntries(RECORDID);
      CanCancelApprovalForRecord := ApprovalsMgmt.CanCancelApprovalForRecord(RECORDID);
    END;

    LOCAL PROCEDURE ShowPostedConfirmationMessage@17();
    VAR
      OrderSalesHeader@1003 : Record 36;
      SalesInvoiceHeader@1000 : Record 112;
      InstructionMgt@1002 : Codeunit 1330;
    BEGIN
      IF NOT OrderSalesHeader.GET("Document Type","No.") THEN BEGIN
        SalesInvoiceHeader.SETRANGE("No.","Last Posting No.");
        IF SalesInvoiceHeader.FINDFIRST THEN
          IF InstructionMgt.ShowConfirm(OpenPostedSalesOrderQst,InstructionMgt.ShowPostedConfirmationMessageCode) THEN
            PAGE.RUN(PAGE::"Posted Sales Invoice",SalesInvoiceHeader);
      END;
    END;

    LOCAL PROCEDURE UpdatePaymentService@1();
    VAR
      PaymentServiceSetup@1000 : Record 1060;
    BEGIN
      PaymentServiceVisible := PaymentServiceSetup.IsPaymentServiceVisible;
      PaymentServiceEnabled := PaymentServiceSetup.CanChangePaymentService(Rec);
    END;

    LOCAL PROCEDURE UpdateShipToBillToGroupVisibility@9();
    BEGIN
      CASE TRUE OF
        ("Ship-to Code" = '') AND ShipToAddressEqualsSellToAddress:
          ShipToOptions := ShipToOptions::"Default (Sell-to Address)";
        ("Ship-to Code" = '') AND (NOT ShipToAddressEqualsSellToAddress):
          ShipToOptions := ShipToOptions::"Custom Address";
        "Ship-to Code" <> '':
          ShipToOptions := ShipToOptions::"Alternate Shipping Address";
      END;

      IF "Bill-to Customer No." = "Sell-to Customer No." THEN
        BillToOptions := BillToOptions::"Default (Customer)"
      ELSE
        BillToOptions := BillToOptions::"Another Customer";
    END;

    BEGIN
    END.
  }
}

OBJECT Page 50 Purchase Order
{
  OBJECT-PROPERTIES
  {
    Date=26.10.16;
    Time=14:06:29;
    Modified=Yes;
    Version List=NAVW110.00,NAVNO10.00,DOC1.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Purchase Order;
               NOR=Bestilling];
    SourceTable=Table38;
    SourceTableView=WHERE(Document Type=FILTER(Order));
    PageType=Document;
    RefreshOnActivate=Yes;
    PromotedActionCategoriesML=[ENU=New,Process,Report,Approve,Release,Posting,Prepare,Invoice,Request Approval;
                                NOR=Ny,Prosess,Rapport,Godkjenn,Frigi,Bokfring,Klargjr,Faktura,Be om godkjenning];
    OnInit=BEGIN
             SetExtDocNoMandatoryCondition;
           END;

    OnOpenPage=BEGIN
                 SetDocNoVisible;

                 IF UserMgt.GetPurchasesFilter <> '' THEN BEGIN
                   FILTERGROUP(2);
                   SETRANGE("Responsibility Center",UserMgt.GetPurchasesFilter);
                   FILTERGROUP(0);
                 END;
               END;

    OnNewRecord=BEGIN
                  "Responsibility Center" := UserMgt.GetPurchasesFilter;

                  IF (NOT DocNoVisible) AND ("No." = '') THEN
                    SetBuyFromVendorFromFilter;
                END;

    OnDeleteRecord=BEGIN
                     CurrPage.SAVERECORD;
                     EXIT(ConfirmDeletion);
                   END;

    OnQueryClosePage=BEGIN
                       IF NOT DocumentIsPosted THEN
                         EXIT(ConfirmCloseUnposted);
                     END;

    OnAfterGetCurrRecord=BEGIN
                           SetControlAppearance;
                           CurrPage.IncomingDocAttachFactBox.PAGE.LoadDataFromRecord(Rec);
                           ShowWorkflowStatus := CurrPage.WorkflowStatus.PAGE.SetFilterOnWorkflowRecord(RECORDID);
                           CurrPage.DocumentFileFactBox.PAGE.LoadDataFromRecord(Rec);
                         END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 61      ;1   ;ActionGroup;
                      CaptionML=[ENU=O&rder;
                                 NOR=&Bestilling];
                      Image=Order }
      { 129     ;2   ;Action    ;
                      Name=Dimensions;
                      AccessByPermission=TableData 348=R;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 NOR=Dimensjoner];
                      ToolTipML=[ENU=View or edits dimensions, such as area, project, or department, that you can assign to sales and purchase documents to distribute costs and analyze transaction history.;
                                 NOR=View or edits dimensions, such as area, project, or department, that you can assign to sales and purchase documents to distribute costs and analyze transaction history.];
                      ApplicationArea=#Suite;
                      Promoted=No;
                      Enabled="No." <> '';
                      PromotedIsBig=No;
                      Image=Dimensions;
                      OnAction=BEGIN
                                 ShowDocDim;
                                 CurrPage.SAVERECORD;
                               END;
                                }
      { 63      ;2   ;Action    ;
                      Name=Statistics;
                      ShortCutKey=F7;
                      CaptionML=[ENU=Statistics;
                                 NOR=Statistikk];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Statistics;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 OpenPurchaseOrderStatistics;
                                 PurchCalcDiscByType.ResetRecalculateInvoiceDisc(Rec);
                               END;
                                }
      { 64      ;2   ;Action    ;
                      ShortCutKey=Shift+F7;
                      CaptionML=[ENU=Card;
                                 NOR=Kort];
                      ToolTipML=[ENU=View or change detailed information about the vendor.;
                                 NOR=View or change detailed information about the vendor.];
                      ApplicationArea=#Suite;
                      RunObject=Page 26;
                      RunPageLink=No.=FIELD(Buy-from Vendor No.);
                      Promoted=No;
                      PromotedIsBig=No;
                      Image=EditLines }
      { 53      ;2   ;Action    ;
                      Name=Approvals;
                      AccessByPermission=TableData 454=R;
                      CaptionML=[ENU=Approvals;
                                 NOR=Godkjenninger];
                      ToolTipML=[ENU=View a list of the records that are waiting to be approved. For example, you can see who requested the record to be approved, when it was sent, and when it is due to be approved.;
                                 NOR=Vis en liste med poster dom venter p  bli godkjent. Du kan for eksempel se hvem som har bedt om godkjenning av posten, nr den ble sendt og nr den forfaller til godkjenning.];
                      ApplicationArea=#Suite;
                      Image=Approvals;
                      OnAction=VAR
                                 ApprovalEntries@1001 : Page 658;
                               BEGIN
                                 ApprovalEntries.Setfilters(DATABASE::"Purchase Header","Document Type","No.");
                                 ApprovalEntries.RUN;
                               END;
                                }
      { 65      ;2   ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 NOR=&Merknader];
                      RunObject=Page 66;
                      RunPageLink=Document Type=FIELD(Document Type),
                                  No.=FIELD(No.),
                                  Document Line No.=CONST(0);
                      Image=ViewComments }
      { 9       ;1   ;ActionGroup;
                      CaptionML=[ENU=Documents;
                                 NOR=Dokumenter];
                      Image=Documents }
      { 66      ;2   ;Action    ;
                      CaptionML=[ENU=Receipts;
                                 NOR=Mottak];
                      ApplicationArea=#Suite;
                      RunObject=Page 145;
                      RunPageView=SORTING(Order No.);
                      RunPageLink=Order No.=FIELD(No.);
                      Image=PostedReceipts }
      { 67      ;2   ;Action    ;
                      CaptionML=[ENU=Invoices;
                                 NOR=Fakturaer];
                      ApplicationArea=#Suite;
                      RunObject=Page 146;
                      RunPageView=SORTING(Order No.);
                      RunPageLink=Order No.=FIELD(No.);
                      Promoted=No;
                      PromotedIsBig=No;
                      Image=Invoice }
      { 205     ;2   ;Action    ;
                      Name=PostedPrepaymentInvoices;
                      CaptionML=[ENU=Prepa&yment Invoices;
                                 NOR=F&orskuddsfakturaer];
                      RunObject=Page 146;
                      RunPageView=SORTING(Prepayment Order No.);
                      RunPageLink=Prepayment Order No.=FIELD(No.);
                      Image=PrepaymentInvoice }
      { 206     ;2   ;Action    ;
                      Name=PostedPrepaymentCrMemos;
                      CaptionML=[ENU=Prepayment Credi&t Memos;
                                 NOR=Kredi&tnotaer for forskudd];
                      RunObject=Page 147;
                      RunPageView=SORTING(Prepayment Order No.);
                      RunPageLink=Prepayment Order No.=FIELD(No.);
                      Image=PrepaymentCreditMemo }
      { 11      ;1   ;ActionGroup;
                      CaptionML=[ENU=Warehouse;
                                 NOR=Lager];
                      Image=Warehouse }
      { 181     ;2   ;Separator  }
      { 180     ;2   ;Action    ;
                      CaptionML=[ENU=In&vt. Put-away/Pick Lines;
                                 NOR=&Lagerplass.-/-plukklinjer];
                      RunObject=Page 5774;
                      RunPageView=SORTING(Source Document,Source No.,Location Code);
                      RunPageLink=Source Document=CONST(Purchase Order),
                                  Source No.=FIELD(No.);
                      Image=PickLines }
      { 148     ;2   ;Action    ;
                      CaptionML=[ENU=Whse. Receipt Lines;
                                 NOR=Lagermottakslinjer];
                      RunObject=Page 7342;
                      RunPageView=SORTING(Source Type,Source Subtype,Source No.,Source Line No.);
                      RunPageLink=Source Type=CONST(39),
                                  Source Subtype=FIELD(Document Type),
                                  Source No.=FIELD(No.);
                      Image=ReceiptLines }
      { 182     ;2   ;Separator  }
      { 183     ;2   ;ActionGroup;
                      CaptionML=[ENU=Dr&op Shipment;
                                 NOR=Dire&kte levering];
                      Image=Delivery }
      { 226     ;3   ;Action    ;
                      Name=Warehouse_GetSalesOrder;
                      CaptionML=[ENU=Get &Sales Order;
                                 NOR=Hent &ordre];
                      ToolTipML=[ENU="Select the sales order that must be linked to the purchase order, for drop shipment. ";
                                 NOR="Select the sales order that must be linked to the purchase order, for drop shipment. "];
                      ApplicationArea=#Suite;
                      RunObject=Codeunit 76;
                      Image=Order }
      { 227     ;2   ;ActionGroup;
                      CaptionML=[ENU=Speci&al Order;
                                 NOR=Spesi&albestilling];
                      Image=SpecialOrder }
      { 228     ;3   ;Action    ;
                      AccessByPermission=TableData 110=R;
                      CaptionML=[ENU=Get &Sales Order;
                                 NOR=Hent &ordre];
                      Image=Order;
                      OnAction=VAR
                                 PurchHeader@1000 : Record 38;
                                 DistIntegration@1001 : Codeunit 5702;
                               BEGIN
                                 PurchHeader.COPY(Rec);
                                 DistIntegration.GetSpecialOrders(PurchHeader);
                                 Rec := PurchHeader;
                               END;
                                }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 37      ;1   ;ActionGroup;
                      CaptionML=[ENU=Approval;
                                 NOR=Godkjenning] }
      { 35      ;2   ;Action    ;
                      Name=Approve;
                      CaptionML=[ENU=Approve;
                                 NOR=Godkjenn];
                      ToolTipML=[ENU=Approve the requested changes.;
                                 NOR=Approve the requested changes.];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      Visible=OpenApprovalEntriesExistForCurrUser;
                      PromotedIsBig=Yes;
                      Image=Approve;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.ApproveRecordApprovalRequest(RECORDID);
                               END;
                                }
      { 33      ;2   ;Action    ;
                      Name=Reject;
                      CaptionML=[ENU=Reject;
                                 NOR=Avvis];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      Visible=OpenApprovalEntriesExistForCurrUser;
                      PromotedIsBig=Yes;
                      Image=Reject;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.RejectRecordApprovalRequest(RECORDID);
                               END;
                                }
      { 31      ;2   ;Action    ;
                      Name=Delegate;
                      CaptionML=[ENU=Delegate;
                                 NOR=Deleger];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      Visible=OpenApprovalEntriesExistForCurrUser;
                      Image=Delegate;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.DelegateRecordApprovalRequest(RECORDID);
                               END;
                                }
      { 29      ;2   ;Action    ;
                      Name=Comment;
                      CaptionML=[ENU=Comments;
                                 NOR=Merknader];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      Visible=OpenApprovalEntriesExistForCurrUser;
                      Image=ViewComments;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.GetApprovalComment(Rec);
                               END;
                                }
      { 13      ;1   ;ActionGroup;
                      CaptionML=[ENU=Release;
                                 NOR=Frigi];
                      Image=ReleaseDoc }
      { 73      ;2   ;Separator  }
      { 137     ;2   ;Action    ;
                      Name=Release;
                      ShortCutKey=Ctrl+F9;
                      CaptionML=[ENU=Re&lease;
                                 NOR=&Frigi];
                      Promoted=Yes;
                      Image=ReleaseDoc;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ReleasePurchDoc@1000 : Codeunit 415;
                               BEGIN
                                 ReleasePurchDoc.PerformManualRelease(Rec);
                               END;
                                }
      { 138     ;2   ;Action    ;
                      Name=Reopen;
                      CaptionML=[ENU=Re&open;
                                 NOR=pne p &nytt];
                      ToolTipML=[ENU=Reopen the document to change it after it has been approved. Approved documents have the Released status and must be opened before they can be changed;
                                 NOR=pne dokumentet p nytt for  endre det etter at det har blitt godkjent. Godkjente dokumenter har statusen Frigitt, og de m pnes fr de kan endres];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      Enabled=Status <> Status::Open;
                      Image=ReOpen;
                      PromotedCategory=Category5;
                      OnAction=VAR
                                 ReleasePurchDoc@1001 : Codeunit 415;
                               BEGIN
                                 ReleasePurchDoc.PerformManualReopen(Rec);
                               END;
                                }
      { 611     ;2   ;Separator  }
      { 68      ;1   ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 NOR=F&unksjoner];
                      Image=Action }
      { 69      ;2   ;Action    ;
                      Name=CalculateInvoiceDiscount;
                      AccessByPermission=TableData 24=R;
                      CaptionML=[ENU=Calculate &Invoice Discount;
                                 NOR=Beregn &fakturarabatt];
                      ToolTipML=[ENU=Calculate the discount that can be granted based on all lines in the purchase document.;
                                 NOR=Calculate the discount that can be granted based on all lines in the purchase document.];
                      ApplicationArea=#Suite;
                      Image=CalculateInvoiceDiscount;
                      OnAction=BEGIN
                                 ApproveCalcInvDisc;
                                 PurchCalcDiscByType.ResetRecalculateInvoiceDisc(Rec);
                               END;
                                }
      { 190     ;2   ;Separator  }
      { 179     ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Get St&d. Vend. Purchase Codes;
                                 NOR=Hent st&d. kjpskode for lev.];
                      ApplicationArea=#Suite;
                      Image=VendorCode;
                      OnAction=VAR
                                 StdVendPurchCode@1000 : Record 175;
                               BEGIN
                                 StdVendPurchCode.InsertPurchLines(Rec);
                               END;
                                }
      { 75      ;2   ;Separator  }
      { 70      ;2   ;Action    ;
                      Name=CopyDocument;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Copy Document;
                                 NOR=Kopier dokument];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      Image=CopyDocument;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CopyPurchDoc.SetPurchHeader(Rec);
                                 CopyPurchDoc.RUNMODAL;
                                 CLEAR(CopyPurchDoc);
                                 IF GET("Document Type","No.") THEN;
                               END;
                                }
      { 142     ;2   ;Action    ;
                      Name=MoveNegativeLines;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Move Negative Lines;
                                 NOR=Flytt negative linjer];
                      Image=MoveNegativeLines;
                      OnAction=BEGIN
                                 CLEAR(MoveNegPurchLines);
                                 MoveNegPurchLines.SetPurchHeader(Rec);
                                 MoveNegPurchLines.RUNMODAL;
                                 MoveNegPurchLines.ShowDocument;
                               END;
                                }
      { 225     ;2   ;ActionGroup;
                      CaptionML=[ENU=Dr&op Shipment;
                                 NOR=Dire&kte levering];
                      Image=Delivery }
      { 184     ;3   ;Action    ;
                      Name=Functions_GetSalesOrder;
                      CaptionML=[ENU=Get &Sales Order;
                                 NOR=Hent &ordre];
                      ToolTipML=[ENU="Select the sales order that must be linked to the purchase order, for drop shipment. ";
                                 NOR="Select the sales order that must be linked to the purchase order, for drop shipment. "];
                      ApplicationArea=#Suite;
                      RunObject=Codeunit 76;
                      Image=Order }
      { 186     ;2   ;ActionGroup;
                      CaptionML=[ENU=Speci&al Order;
                                 NOR=Spesi&albestilling];
                      Image=SpecialOrder }
      { 187     ;3   ;Action    ;
                      AccessByPermission=TableData 110=R;
                      CaptionML=[ENU=Get &Sales Order;
                                 NOR=Hent &ordre];
                      Image=Order;
                      OnAction=VAR
                                 DistIntegration@1001 : Codeunit 5702;
                                 PurchHeader@1000 : Record 38;
                               BEGIN
                                 PurchHeader.COPY(Rec);
                                 DistIntegration.GetSpecialOrders(PurchHeader);
                                 Rec := PurchHeader;
                               END;
                                }
      { 173     ;2   ;Action    ;
                      Name=Archive Document;
                      CaptionML=[ENU=Archi&ve Document;
                                 NOR=Arki&ver dokument];
                      Image=Archive;
                      OnAction=BEGIN
                                 ArchiveManagement.ArchivePurchDocument(Rec);
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 195     ;2   ;Action    ;
                      AccessByPermission=TableData 410=R;
                      CaptionML=[ENU=Send IC Purchase Order;
                                 NOR=Send KI-bestilling];
                      Image=IntercompanyOrder;
                      OnAction=VAR
                                 ICInOutboxMgt@1000 : Codeunit 427;
                                 ApprovalsMgmt@1003 : Codeunit 1535;
                               BEGIN
                                 IF ApprovalsMgmt.PrePostApprovalCheckPurch(Rec) THEN
                                   ICInOutboxMgt.SendPurchDoc(Rec,FALSE);
                               END;
                                }
      { 189     ;2   ;Separator  }
      { 51      ;2   ;ActionGroup;
                      Name=IncomingDocument;
                      CaptionML=[ENU=Incoming Document;
                                 NOR=Inngende dokument];
                      ActionContainerType=NewDocumentItems;
                      Image=Documents }
      { 47      ;3   ;Action    ;
                      Name=IncomingDocCard;
                      CaptionML=[ENU=View Incoming Document;
                                 NOR=Vis inngende dokument];
                      ToolTipML=[ENU=View any incoming document records and file attachments that exist for the entry or document, for example for auditing purposes;
                                 NOR=Vis poster og filvedlegg for innkommende dokument som finnes for posten eller dokumentet, for eksempel for revisjonsforml];
                      ApplicationArea=#Suite;
                      Enabled=HasIncomingDocument;
                      Image=ViewOrder;
                      OnAction=VAR
                                 IncomingDocument@1000 : Record 130;
                               BEGIN
                                 IncomingDocument.ShowCardFromEntryNo("Incoming Document Entry No.");
                               END;
                                }
      { 45      ;3   ;Action    ;
                      Name=SelectIncomingDoc;
                      AccessByPermission=TableData 130=R;
                      CaptionML=[ENU=Select Incoming Document;
                                 NOR=Velg inngende dokument];
                      ToolTipML=;
                      ApplicationArea=#Suite;
                      Image=SelectLineToApply;
                      OnAction=VAR
                                 IncomingDocument@1000 : Record 130;
                               BEGIN
                                 VALIDATE("Incoming Document Entry No.",IncomingDocument.SelectIncomingDocument("Incoming Document Entry No.",RECORDID));
                               END;
                                }
      { 43      ;3   ;Action    ;
                      Name=IncomingDocAttachFile;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Create Incoming Document from File;
                                 NOR=Opprett inngende dokument fra fil];
                      ToolTipML=[ENU=Create an incoming document from a file that you select from the disk. The file will be attached to the incoming document record.;
                                 NOR=Create an incoming document from a file that you select from the disk. The file will be attached to the incoming document record.];
                      ApplicationArea=#Suite;
                      Enabled=CreateIncomingDocumentEnabled;
                      Image=Attach;
                      OnAction=VAR
                                 IncomingDocumentAttachment@1000 : Record 133;
                               BEGIN
                                 IncomingDocumentAttachment.NewAttachmentFromPurchaseDocument(Rec);
                               END;
                                }
      { 41      ;3   ;Action    ;
                      Name=RemoveIncomingDoc;
                      CaptionML=[ENU=Remove Incoming Document;
                                 NOR=Fjern inngende dokument];
                      ToolTipML=;
                      ApplicationArea=#Suite;
                      Enabled=HasIncomingDocument;
                      Image=RemoveLine;
                      OnAction=BEGIN
                                 "Incoming Document Entry No." := 0;
                               END;
                                }
      { 15      ;1   ;ActionGroup;
                      CaptionML=[ENU=Request Approval;
                                 NOR=Be om godkjenning] }
      { 57      ;2   ;Action    ;
                      Name=SendApprovalRequest;
                      CaptionML=[ENU=Send A&pproval Request;
                                 NOR=&Send godkjenningsforesprsel];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      Enabled=NOT OpenApprovalEntriesExist;
                      PromotedIsBig=Yes;
                      Image=SendApprovalRequest;
                      PromotedCategory=Category9;
                      PromotedOnly=Yes;
                      OnAction=VAR
                                 ApprovalsMgmt@1001 : Codeunit 1535;
                               BEGIN
                                 IF ApprovalsMgmt.CheckPurchaseApprovalPossible(Rec) THEN
                                   ApprovalsMgmt.OnSendPurchaseDocForApproval(Rec);
                               END;
                                }
      { 55      ;2   ;Action    ;
                      Name=CancelApprovalRequest;
                      CaptionML=[ENU=Cancel Approval Re&quest;
                                 NOR=&Annuller godkjenningsforesprsel];
                      ToolTipML=[ENU=Cancel the approval request.;
                                 NOR=Cancel the approval request.];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      Enabled=CanCancelApprovalForRecord;
                      PromotedIsBig=Yes;
                      Image=CancelApprovalRequest;
                      PromotedCategory=Category9;
                      PromotedOnly=Yes;
                      OnAction=VAR
                                 ApprovalsMgmt@1001 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.OnCancelPurchaseApprovalRequest(Rec);
                               END;
                                }
      { 17      ;1   ;ActionGroup;
                      CaptionML=[ENU=Warehouse;
                                 NOR=Lager];
                      Image=Warehouse }
      { 149     ;2   ;Action    ;
                      AccessByPermission=TableData 7316=R;
                      CaptionML=[ENU=Create &Whse. Receipt;
                                 NOR=Opprett &lagermottak];
                      Image=NewReceipt;
                      OnAction=VAR
                                 GetSourceDocInbound@1001 : Codeunit 5751;
                               BEGIN
                                 GetSourceDocInbound.CreateFromPurchOrder(Rec);

                                 IF NOT FIND('=><') THEN
                                   INIT;
                               END;
                                }
      { 150     ;2   ;Action    ;
                      AccessByPermission=TableData 7340=R;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Create Inventor&y Put-away/Pick;
                                 NOR=Opprett lagerplas&sering/-plukk];
                      Promoted=Yes;
                      Image=CreateInventoryPickup;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CreateInvtPutAwayPick;

                                 IF NOT FIND('=><') THEN
                                   INIT;
                               END;
                                }
      { 74      ;2   ;Separator  }
      { 77      ;1   ;ActionGroup;
                      CaptionML=[ENU=P&osting;
                                 NOR=B&okfring];
                      Image=Post }
      { 79      ;2   ;Action    ;
                      Name=Post;
                      ShortCutKey=F9;
                      Ellipsis=Yes;
                      CaptionML=[ENU=P&ost;
                                 NOR=B&okfr];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PostOrder;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Post(CODEUNIT::"Purch.-Post (Yes/No)");
                               END;
                                }
      { 21      ;2   ;Action    ;
                      Name=Preview;
                      CaptionML=[ENU=Preview Posting;
                                 NOR=Forhndsvis bokfring];
                      ToolTipML=[ENU=Review the different types of entries that will be created when you post the document or journal.;
                                 NOR=Review the different types of entries that will be created when you post the document or journal.];
                      ApplicationArea=#Suite;
                      Image=ViewPostedOrder;
                      OnAction=VAR
                                 PurchPostYesNo@1000 : Codeunit 91;
                               BEGIN
                                 PurchPostYesNo.Preview(Rec);
                               END;
                                }
      { 80      ;2   ;Action    ;
                      ShortCutKey=Shift+F9;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Post and &Print;
                                 NOR=Bokfr og &skriv ut];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PostPrint;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Post(CODEUNIT::"Purch.-Post + Print");
                               END;
                                }
      { 78      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Test Report;
                                 NOR=Kontrollrapport];
                      Image=TestReport;
                      OnAction=BEGIN
                                 ReportPrint.PrintPurchHeader(Rec);
                               END;
                                }
      { 81      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Post &Batch;
                                 NOR=&Massebokfr];
                      Image=PostBatch;
                      OnAction=BEGIN
                                 REPORT.RUNMODAL(REPORT::"Batch Post Purchase Orders",TRUE,TRUE,Rec);
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 5       ;2   ;Action    ;
                      CaptionML=[ENU=Remove From Job Queue;
                                 NOR=Fjern fra jobbk];
                      ApplicationArea=#Suite;
                      Visible=JobQueueVisible;
                      Image=RemoveLine;
                      OnAction=BEGIN
                                 CancelBackgroundPosting;
                               END;
                                }
      { 201     ;2   ;Separator  }
      { 209     ;2   ;ActionGroup;
                      CaptionML=[ENU=Prepa&yment;
                                 NOR=&Forskudd];
                      Image=Prepayment }
      { 202     ;3   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Prepayment Test &Report;
                                 NOR=&Testrapport for forskudd];
                      Image=PrepaymentSimulation;
                      OnAction=BEGIN
                                 ReportPrint.PrintPurchHeaderPrepmt(Rec);
                               END;
                                }
      { 203     ;3   ;Action    ;
                      Name=PostPrepaymentInvoice;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Post Prepayment &Invoice;
                                 NOR=Bo&kfr forskuddsfaktura];
                      Image=PrepaymentPost;
                      OnAction=VAR
                                 ApprovalsMgmt@1002 : Codeunit 1535;
                                 PurchPostYNPrepmt@1000 : Codeunit 445;
                               BEGIN
                                 IF ApprovalsMgmt.PrePostApprovalCheckPurch(Rec) THEN
                                   PurchPostYNPrepmt.PostPrepmtInvoiceYN(Rec,FALSE);
                               END;
                                }
      { 210     ;3   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Post and Print Prepmt. Invoic&e;
                                 NOR=Bokf&r og skriv ut forskuddsfaktura];
                      Image=PrepaymentPostPrint;
                      OnAction=VAR
                                 ApprovalsMgmt@1002 : Codeunit 1535;
                                 PurchPostYNPrepmt@1000 : Codeunit 445;
                               BEGIN
                                 IF ApprovalsMgmt.PrePostApprovalCheckPurch(Rec) THEN
                                   PurchPostYNPrepmt.PostPrepmtInvoiceYN(Rec,TRUE);
                               END;
                                }
      { 204     ;3   ;Action    ;
                      Name=PostPrepaymentCreditMemo;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Post Prepayment &Credit Memo;
                                 NOR=Bokfr kredit&nota for forskudd];
                      Image=PrepaymentPost;
                      OnAction=VAR
                                 ApprovalsMgmt@1002 : Codeunit 1535;
                                 PurchPostYNPrepmt@1000 : Codeunit 445;
                               BEGIN
                                 IF ApprovalsMgmt.PrePostApprovalCheckPurch(Rec) THEN
                                   PurchPostYNPrepmt.PostPrepmtCrMemoYN(Rec,FALSE);
                               END;
                                }
      { 211     ;3   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Post and Print Prepmt. Cr. Mem&o;
                                 NOR=Bokfr og skriv &ut kreditnota for forskudd];
                      Image=PrepaymentPostPrint;
                      OnAction=VAR
                                 ApprovalsMgmt@1002 : Codeunit 1535;
                                 PurchPostYNPrepmt@1000 : Codeunit 445;
                               BEGIN
                                 IF ApprovalsMgmt.PrePostApprovalCheckPurch(Rec) THEN
                                   PurchPostYNPrepmt.PostPrepmtCrMemoYN(Rec,TRUE);
                               END;
                                }
      { 19      ;1   ;ActionGroup;
                      CaptionML=[ENU=Print;
                                 NOR=Skriv ut];
                      Image=Print }
      { 82      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=&Print;
                                 NOR=&Skriv ut];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      Image=Print;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 DocPrint.PrintPurchHeader(Rec);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=[ENU=General;
                           NOR=Generelt] }

    { 2   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of a general ledger account, item, additional cost, or fixed asset, depending on what you selected in the Type field.;
                           NOR=Specifies the number of a general ledger account, item, additional cost, or fixed asset, depending on what you selected in the Type field.];
                ApplicationArea=#Suite;
                SourceExpr="No.";
                Importance=Promoted;
                Visible=DocNoVisible;
                OnAssistEdit=BEGIN
                               IF AssistEdit(xRec) THEN
                                 CurrPage.UPDATE;
                             END;
                              }

    { 4   ;2   ;Field     ;
                SourceExpr="Buy-from Vendor No.";
                OnValidate=BEGIN
                             IF GETFILTER("Buy-from Vendor No.") = xRec."Buy-from Vendor No." THEN
                               IF "Buy-from Vendor No." <> xRec."Buy-from Vendor No." THEN
                                 SETRANGE("Buy-from Vendor No.");

                             CurrPage.UPDATE;
                           END;
                            }

    { 6   ;2   ;Field     ;
                CaptionML=[ENU=Vendor;
                           NOR=Leverandr];
                ApplicationArea=#Suite;
                SourceExpr="Buy-from Vendor Name";
                Importance=Promoted;
                OnValidate=BEGIN
                             IF GETFILTER("Buy-from Vendor No.") = xRec."Buy-from Vendor No." THEN
                               IF "Buy-from Vendor No." <> xRec."Buy-from Vendor No." THEN
                                 SETRANGE("Buy-from Vendor No.");

                             CurrPage.UPDATE;
                           END;

                ShowMandatory=TRUE }

    { 62  ;2   ;Group     ;
                CaptionML=[ENU=Buy-from;
                           NOR=Kjp fra];
                GroupType=Group }

    { 89  ;3   ;Field     ;
                CaptionML=[ENU=Address;
                           NOR=Adresse];
                ApplicationArea=#Suite;
                SourceExpr="Buy-from Address";
                Importance=Additional }

    { 91  ;3   ;Field     ;
                CaptionML=[ENU=Address 2;
                           NOR=Adresse 2];
                ApplicationArea=#Suite;
                SourceExpr="Buy-from Address 2";
                Importance=Additional }

    { 76  ;3   ;Field     ;
                CaptionML=[ENU=Post Code;
                           NOR=Postnr.];
                ApplicationArea=#Suite;
                SourceExpr="Buy-from Post Code";
                Importance=Additional }

    { 93  ;3   ;Field     ;
                CaptionML=[ENU=City;
                           NOR=Sted];
                ApplicationArea=#Suite;
                SourceExpr="Buy-from City";
                Importance=Additional }

    { 174 ;3   ;Field     ;
                CaptionML=[ENU=Contact No.;
                           NOR=Kontaktnr.];
                SourceExpr="Buy-from Contact No.";
                Importance=Additional }

    { 8   ;2   ;Field     ;
                CaptionML=[ENU=Contact;
                           NOR=Kontakt];
                ApplicationArea=#Suite;
                SourceExpr="Buy-from Contact" }

    { 49  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date of the vendor's invoice.;
                           NOR=Specifies the date of the vendor's invoice.];
                ApplicationArea=#Suite;
                SourceExpr="Document Date" }

    { 12  ;2   ;Field     ;
                ApplicationArea=#Suite;
                SourceExpr="Posting Date" }

    { 36  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies when the purchase invoice is due for payment.;
                           NOR=Specifies when the purchase invoice is due for payment.];
                ApplicationArea=#Suite;
                SourceExpr="Due Date";
                Importance=Promoted }

    { 20  ;2   ;Field     ;
                ApplicationArea=#Suite;
                SourceExpr="Vendor Invoice No.";
                ShowMandatory=VendorInvoiceNoMandatory }

    { 10  ;2   ;Field     ;
                ApplicationArea=#Suite;
                SourceExpr="Purchaser Code";
                Importance=Additional;
                OnValidate=BEGIN
                             PurchaserCodeOnAfterValidate;
                           END;
                            }

    { 171 ;2   ;Field     ;
                SourceExpr="No. of Archived Versions";
                Importance=Additional }

    { 14  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date when the item is ordered. It is calculated backwards from the Planned Receipt Date field in combination with the Lead Time Calculation field.;
                           NOR=Specifies the date when the item is ordered. It is calculated backwards from the Planned Receipt Date field in combination with the Lead Time Calculation field.];
                ApplicationArea=#Suite;
                SourceExpr="Order Date";
                Importance=Promoted }

    { 237 ;2   ;Field     ;
                SourceExpr="Quote No.";
                Importance=Additional }

    { 16  ;2   ;Field     ;
                ApplicationArea=#Suite;
                SourceExpr="Vendor Order No." }

    { 18  ;2   ;Field     ;
                SourceExpr="Vendor Shipment No." }

    { 96  ;2   ;Field     ;
                SourceExpr="Order Address Code";
                Importance=Additional }

    { 131 ;2   ;Field     ;
                SourceExpr="Responsibility Center";
                Importance=Additional }

    { 72  ;2   ;Field     ;
                SourceExpr="Assigned User ID";
                Importance=Additional }

    { 133 ;2   ;Field     ;
                SourceExpr=Status;
                Importance=Promoted }

    { 7   ;2   ;Field     ;
                SourceExpr="Job Queue Status";
                Importance=Additional }

    { 60  ;1   ;Part      ;
                Name=PurchLines;
                ApplicationArea=#Suite;
                SubPageLink=Document No.=FIELD(No.);
                PagePartID=Page54;
                PartType=Page;
                UpdatePropagation=Both }

    { 1905885101;1;Group  ;
                CaptionML=[ENU=Invoice Details;
                           NOR=Fakturadetaljer];
                GroupType=Group }

    { 119 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the currency of amounts on the purchase document.;
                           NOR=Specifies the currency of amounts on the purchase document.];
                ApplicationArea=#Suite;
                SourceExpr="Currency Code";
                Importance=Promoted;
                OnValidate=BEGIN
                             CurrPage.UPDATE;
                             PurchCalcDiscByType.ApplyDefaultInvoiceDiscount(0,Rec);
                           END;

                OnAssistEdit=BEGIN
                               CLEAR(ChangeExchangeRate);
                               IF "Posting Date" <> 0D THEN
                                 ChangeExchangeRate.SetParameter("Currency Code","Currency Factor","Posting Date")
                               ELSE
                                 ChangeExchangeRate.SetParameter("Currency Code","Currency Factor",WORKDATE);
                               IF ChangeExchangeRate.RUNMODAL = ACTION::OK THEN BEGIN
                                 VALIDATE("Currency Factor",ChangeExchangeRate.GetParameter);
                                 CurrPage.UPDATE;
                               END;
                               CLEAR(ChangeExchangeRate);
                             END;
                              }

    { 54  ;2   ;Field     ;
                ToolTipML=[ENU="Specifies the date you expect the items to be available in your warehouse. If you leave the field blank, it will be calculated as follows: Planned Receipt Date + Safety Lead Time + Inbound Warehouse Handling Time = Expected Receipt Date.";
                           NOR="Specifies the date you expect the items to be available in your warehouse. If you leave the field blank, it will be calculated as follows: Planned Receipt Date + Safety Lead Time + Inbound Warehouse Handling Time = Expected Receipt Date."];
                ApplicationArea=#Suite;
                SourceExpr="Expected Receipt Date";
                Importance=Promoted }

    { 135 ;2   ;Field     ;
                ApplicationArea=#Suite;
                SourceExpr="Prices Including VAT";
                OnValidate=BEGIN
                             PricesIncludingVATOnAfterValid;
                           END;
                            }

    { 191 ;2   ;Field     ;
                ApplicationArea=#Suite;
                SourceExpr="VAT Bus. Posting Group" }

    { 34  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code that represents the payment terms that apply to the purchase order.;
                           NOR=Specifies the code that represents the payment terms that apply to the purchase order.];
                ApplicationArea=#Suite;
                SourceExpr="Payment Terms Code";
                Importance=Promoted }

    { 117 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies how payment for the purchase document must be submitted.;
                           NOR=Specifies how payment for the purchase document must be submitted.];
                ApplicationArea=#Suite;
                SourceExpr="Payment Method Code";
                Importance=Additional }

    { 56  ;2   ;Field     ;
                SourceExpr="Transaction Type" }

    { 100 ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 1 Code";
                OnValidate=BEGIN
                             ShortcutDimension1CodeOnAfterV;
                           END;
                            }

    { 102 ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 2 Code";
                OnValidate=BEGIN
                             ShortcutDimension2CodeOnAfterV;
                           END;
                            }

    { 38  ;2   ;Field     ;
                SourceExpr="Payment Discount %" }

    { 40  ;2   ;Field     ;
                ApplicationArea=#Suite;
                SourceExpr="Pmt. Discount Date";
                Importance=Additional }

    { 104 ;2   ;Field     ;
                SourceExpr="Location Code";
                Importance=Promoted }

    { 52  ;2   ;Field     ;
                SourceExpr="Shipment Method Code" }

    { 27  ;2   ;Field     ;
                SourceExpr="Payment Reference" }

    { 25  ;2   ;Field     ;
                SourceExpr="Creditor No." }

    { 106 ;2   ;Field     ;
                SourceExpr="On Hold" }

    { 144 ;2   ;Field     ;
                SourceExpr="Inbound Whse. Handling Time";
                Importance=Additional }

    { 146 ;2   ;Field     ;
                SourceExpr="Lead Time Calculation";
                Importance=Additional }

    { 127 ;2   ;Field     ;
                SourceExpr="Requested Receipt Date" }

    { 139 ;2   ;Field     ;
                SourceExpr="Promised Receipt Date" }

    { 87  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the customer that the items are shipped to directly from your vendor, as a drop shipment.;
                           NOR=Specifies the number of the customer that the items are shipped to directly from your vendor, as a drop shipment.];
                ApplicationArea=#Suite;
                SourceExpr="Sell-to Customer No." }

    { 1906801201;1;Group  ;
                CaptionML=[ENU=Shipping and Payment;
                           NOR=Levering og betaling];
                GroupType=Group }

    { 83  ;2   ;Group     ;
                CaptionML=[ENU=Ship-to;
                           NOR=Lever til];
                GroupType=Group }

    { 85  ;3   ;Field     ;
                CaptionML=[ENU=Code;
                           NOR=Kode];
                ApplicationArea=#Suite;
                SourceExpr="Ship-to Code" }

    { 42  ;3   ;Field     ;
                CaptionML=[ENU=Name;
                           NOR=Navn];
                ApplicationArea=#Suite;
                SourceExpr="Ship-to Name";
                Importance=Additional }

    { 44  ;3   ;Field     ;
                CaptionML=[ENU=Address;
                           NOR=Adresse];
                ApplicationArea=#Suite;
                SourceExpr="Ship-to Address";
                Importance=Additional }

    { 46  ;3   ;Field     ;
                CaptionML=[ENU=Address 2;
                           NOR=Adresse 2];
                ApplicationArea=#Suite;
                SourceExpr="Ship-to Address 2";
                Importance=Additional }

    { 109 ;3   ;Field     ;
                CaptionML=[ENU=Post Code;
                           NOR=Postnr.];
                ApplicationArea=#Suite;
                SourceExpr="Ship-to Post Code";
                Importance=Additional }

    { 48  ;3   ;Field     ;
                CaptionML=[ENU=City;
                           NOR=Sted];
                ApplicationArea=#Suite;
                SourceExpr="Ship-to City";
                Importance=Additional }

    { 50  ;3   ;Field     ;
                CaptionML=[ENU=Contact;
                           NOR=Kontakt];
                ApplicationArea=#Suite;
                SourceExpr="Ship-to Contact";
                Importance=Additional }

    { 71  ;2   ;Group     ;
                CaptionML=[ENU=Pay-to;
                           NOR=Betal til];
                GroupType=Group }

    { 24  ;3   ;Field     ;
                CaptionML=[ENU=Name;
                           NOR=Navn];
                ApplicationArea=#Suite;
                SourceExpr="Pay-to Name";
                Importance=Promoted }

    { 26  ;3   ;Field     ;
                CaptionML=[ENU=Address;
                           NOR=Adresse];
                ApplicationArea=#Suite;
                SourceExpr="Pay-to Address";
                Importance=Additional }

    { 28  ;3   ;Field     ;
                CaptionML=[ENU=Address 2;
                           NOR=Adresse 2];
                ApplicationArea=#Suite;
                SourceExpr="Pay-to Address 2";
                Importance=Additional }

    { 97  ;3   ;Field     ;
                CaptionML=[ENU=Post Code;
                           NOR=Postnr.];
                ApplicationArea=#Suite;
                SourceExpr="Pay-to Post Code";
                Importance=Additional }

    { 30  ;3   ;Field     ;
                CaptionML=[ENU=City;
                           NOR=Sted];
                ApplicationArea=#Suite;
                SourceExpr="Pay-to City";
                Importance=Additional }

    { 176 ;3   ;Field     ;
                CaptionML=[ENU=Contact No.;
                           NOR=Kontaktnr.];
                SourceExpr="Pay-to Contact No.";
                Importance=Additional }

    { 32  ;3   ;Field     ;
                CaptionML=[ENU=Contact;
                           NOR=Kontakt];
                ApplicationArea=#Suite;
                SourceExpr="Pay-to Contact";
                Importance=Additional }

    { 1080000;2;Field     ;
                ToolTipML=[ENU=Specifies the Kunde ID (KID) associated with purchase header.;
                           NOR=Specifies the Kunde ID (KID) associated with purchase header.];
                SourceExpr=KID }

    { 1907468901;1;Group  ;
                CaptionML=[ENU=Foreign Trade;
                           NOR=Utenrikshandel] }

    { 115 ;2   ;Field     ;
                SourceExpr="Transaction Specification" }

    { 58  ;2   ;Field     ;
                SourceExpr="Transport Method" }

    { 111 ;2   ;Field     ;
                SourceExpr="Entry Point" }

    { 113 ;2   ;Field     ;
                SourceExpr=Area }

    { 1080002;2;Field     ;
                ToolTipML=[ENU=Specifies a two-digit code for the payment type.;
                           NOR=Specifies a two-digit code for the payment type.];
                SourceExpr="Payment Type Code Abroad" }

    { 1080004;2;Field     ;
                ToolTipML=[ENU=Specifies information for your local government bank. Contact your bank for additional information.;
                           NOR=Specifies information for your local government bank. Contact your bank for additional information.];
                SourceExpr="Specification (Norges Bank)" }

    { 1900201301;1;Group  ;
                CaptionML=[ENU=Prepayment;
                           NOR=Forskudd] }

    { 197 ;2   ;Field     ;
                SourceExpr="Prepayment %";
                Importance=Promoted;
                OnValidate=BEGIN
                             Prepayment37OnAfterValidate;
                           END;
                            }

    { 199 ;2   ;Field     ;
                SourceExpr="Compress Prepayment" }

    { 215 ;2   ;Field     ;
                SourceExpr="Prepmt. Payment Terms Code" }

    { 212 ;2   ;Field     ;
                SourceExpr="Prepayment Due Date";
                Importance=Promoted }

    { 217 ;2   ;Field     ;
                SourceExpr="Prepmt. Payment Discount %" }

    { 196 ;2   ;Field     ;
                SourceExpr="Prepmt. Pmt. Discount Date" }

    { 207 ;2   ;Field     ;
                SourceExpr="Vendor Cr. Memo No." }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1101103000;1;Part   ;
                Name=DocumentFileFactBox;
                PagePartID=Page53202;
                PartType=Page }

    { 23  ;1   ;Part      ;
                ApplicationArea=#Suite;
                SubPageLink=Table ID=CONST(38),
                            Document Type=FIELD(Document Type),
                            Document No.=FIELD(No.);
                PagePartID=Page9103;
                Visible=OpenApprovalEntriesExistForCurrUser;
                PartType=Page }

    { 1903326807;1;Part   ;
                SubPageLink=No.=FIELD(No.);
                PagePartID=Page9090;
                ProviderID=60;
                Visible=FALSE;
                PartType=Page }

    { 1906354007;1;Part   ;
                SubPageLink=Table ID=CONST(38),
                            Document Type=FIELD(Document Type),
                            Document No.=FIELD(No.);
                PagePartID=Page9092;
                Visible=FALSE;
                PartType=Page }

    { 1901138007;1;Part   ;
                SubPageLink=No.=FIELD(Buy-from Vendor No.);
                PagePartID=Page9093;
                Visible=FALSE;
                PartType=Page }

    { 1904651607;1;Part   ;
                SubPageLink=No.=FIELD(Pay-to Vendor No.);
                PagePartID=Page9094;
                PartType=Page }

    { 39  ;1   ;Part      ;
                Name=IncomingDocAttachFactBox;
                PagePartID=Page193;
                Visible=FALSE;
                PartType=Page;
                ShowFilter=No }

    { 1903435607;1;Part   ;
                SubPageLink=No.=FIELD(Buy-from Vendor No.);
                PagePartID=Page9095;
                PartType=Page }

    { 1906949207;1;Part   ;
                SubPageLink=No.=FIELD(Pay-to Vendor No.);
                PagePartID=Page9096;
                Visible=FALSE;
                PartType=Page }

    { 3   ;1   ;Part      ;
                ApplicationArea=#Suite;
                SubPageLink=Document Type=FIELD(Document Type),
                            Document No.=FIELD(Document No.),
                            Line No.=FIELD(Line No.);
                PagePartID=Page9100;
                ProviderID=60;
                PartType=Page }

    { 59  ;1   ;Part      ;
                Name=WorkflowStatus;
                ApplicationArea=#Suite;
                PagePartID=Page1528;
                Visible=ShowWorkflowStatus;
                Enabled=FALSE;
                Editable=FALSE;
                PartType=Page;
                ShowFilter=No }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      ChangeExchangeRate@1001 : Page 511;
      CopyPurchDoc@1002 : Report 492;
      MoveNegPurchLines@1006 : Report 6698;
      ReportPrint@1003 : Codeunit 228;
      DocPrint@1004 : Codeunit 229;
      UserMgt@1005 : Codeunit 5700;
      ArchiveManagement@1007 : Codeunit 5063;
      PurchCalcDiscByType@1009 : Codeunit 66;
      JobQueueVisible@1000 : Boolean INDATASET;
      HasIncomingDocument@1012 : Boolean;
      DocNoVisible@1008 : Boolean;
      VendorInvoiceNoMandatory@1010 : Boolean;
      OpenApprovalEntriesExistForCurrUser@1011 : Boolean;
      OpenApprovalEntriesExist@1014 : Boolean;
      ShowWorkflowStatus@1013 : Boolean;
      CanCancelApprovalForRecord@1015 : Boolean;
      DocumentIsPosted@1016 : Boolean;
      OpenPostedPurchaseOrderQst@1017 : TextConst 'ENU=The order has been posted and moved to the Posted Purchase Invoices window.\\Do you want to open the posted invoice?;NOR=Ordren er bokfrt og flyttet til vinduet Bokfrte kjpsfakturaer.\\Vil du pne den bokfrte fakturaen?';
      CreateIncomingDocumentEnabled@1018 : Boolean;

    LOCAL PROCEDURE Post@4(PostingCodeunitID@1000 : Integer);
    VAR
      PurchaseHeader@1001 : Record 38;
      InstructionMgt@1002 : Codeunit 1330;
    BEGIN
      SendToPosting(PostingCodeunitID);

      DocumentIsPosted := NOT PurchaseHeader.GET("Document Type","No.");

      IF "Job Queue Status" = "Job Queue Status"::"Scheduled for Posting" THEN
        CurrPage.CLOSE;
      CurrPage.UPDATE(FALSE);

      IF PostingCodeunitID <> CODEUNIT::"Purch.-Post (Yes/No)" THEN
        EXIT;

      IF InstructionMgt.IsEnabled(InstructionMgt.ShowPostedConfirmationMessageCode) THEN
        ShowPostedConfirmationMessage;
    END;

    LOCAL PROCEDURE ApproveCalcInvDisc@1();
    BEGIN
      CurrPage.PurchLines.PAGE.ApproveCalcInvDisc;
    END;

    LOCAL PROCEDURE PurchaserCodeOnAfterValidate@19046120();
    BEGIN
      CurrPage.PurchLines.PAGE.UpdateForm(TRUE);
    END;

    LOCAL PROCEDURE ShortcutDimension1CodeOnAfterV@19029405();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE ShortcutDimension2CodeOnAfterV@19008725();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE PricesIncludingVATOnAfterValid@19009096();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE Prepayment37OnAfterValidate@19040510();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE SetDocNoVisible@2();
    VAR
      DocumentNoVisibility@1000 : Codeunit 1400;
      DocType@1003 : 'Quote,Order,Invoice,Credit Memo,Blanket Order,Return Order,Reminder,FinChMemo';
    BEGIN
      DocNoVisible := DocumentNoVisibility.PurchaseDocumentNoIsVisible(DocType::Order,"No.");
    END;

    LOCAL PROCEDURE SetExtDocNoMandatoryCondition@3();
    VAR
      PurchasesPayablesSetup@1000 : Record 312;
    BEGIN
      PurchasesPayablesSetup.GET;
      VendorInvoiceNoMandatory := PurchasesPayablesSetup."Ext. Doc. No. Mandatory"
    END;

    LOCAL PROCEDURE SetControlAppearance@5();
    VAR
      ApprovalsMgmt@1002 : Codeunit 1535;
    BEGIN
      JobQueueVisible := "Job Queue Status" = "Job Queue Status"::"Scheduled for Posting";
      HasIncomingDocument := "Incoming Document Entry No." <> 0;
      CreateIncomingDocumentEnabled := (NOT HasIncomingDocument) AND ("No." <> '');
      SetExtDocNoMandatoryCondition;

      OpenApprovalEntriesExistForCurrUser := ApprovalsMgmt.HasOpenApprovalEntriesForCurrentUser(RECORDID);
      OpenApprovalEntriesExist := ApprovalsMgmt.HasOpenApprovalEntries(RECORDID);
      CanCancelApprovalForRecord := ApprovalsMgmt.CanCancelApprovalForRecord(RECORDID);
    END;

    LOCAL PROCEDURE ShowPostedConfirmationMessage@17();
    VAR
      OrderPurchaseHeader@1003 : Record 38;
      PurchInvHeader@1000 : Record 122;
      InstructionMgt@1002 : Codeunit 1330;
    BEGIN
      IF NOT OrderPurchaseHeader.GET("Document Type","No.") THEN BEGIN
        PurchInvHeader.SETRANGE("No.","Last Posting No.");
        IF PurchInvHeader.FINDFIRST THEN
          IF InstructionMgt.ShowConfirm(OpenPostedPurchaseOrderQst,InstructionMgt.ShowPostedConfirmationMessageCode) THEN
            PAGE.RUN(PAGE::"Posted Purchase Invoice",PurchInvHeader);
      END;
    END;

    BEGIN
    END.
  }
}

OBJECT Page 9305 Sales Order List
{
  OBJECT-PROPERTIES
  {
    Date=26.10.16;
    Time=14:05:25;
    Modified=Yes;
    Version List=NAVW110.00,NAVNO10.00,DOC1.0;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Sales Orders;
               NOR=Ordrer];
    SourceTable=Table36;
    SourceTableView=WHERE(Document Type=CONST(Order));
    DataCaptionFields=Sell-to Customer No.;
    PageType=List;
    CardPageID=Sales Order;
    PromotedActionCategoriesML=[ENU=New,Process,Report,Request Approval;
                                NOR=Ny,Prosess,Rapport,Foresprselsgodkjenning];
    OnOpenPage=VAR
                 SalesSetup@1000 : Record 311;
                 CRMIntegrationManagement@1001 : Codeunit 5330;
                 OfficeMgt@1002 : Codeunit 1630;
               BEGIN
                 IF UserMgt.GetSalesFilter <> '' THEN BEGIN
                   FILTERGROUP(2);
                   SETRANGE("Responsibility Center",UserMgt.GetSalesFilter);
                   FILTERGROUP(0);
                 END;

                 SETRANGE("Date Filter",0D,WORKDATE - 1);

                 JobQueueActive := SalesSetup.JobQueueActive;
                 CRMIntegrationEnabled := CRMIntegrationManagement.IsCRMIntegrationEnabled;
                 IsOfficeAddin := OfficeMgt.IsAvailable;

                 CopySellToCustomerFilter;
               END;

    OnAfterGetCurrRecord=BEGIN
                           SetControlVisibility;
                           CurrPage.IncomingDocAttachFactBox.PAGE.LoadDataFromRecord(Rec);
                           CurrPage.DocumentFileFactBox.PAGE.LoadDataFromRecord(Rec);
                         END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1102601000;1 ;ActionGroup;
                      CaptionML=[ENU=O&rder;
                                 NOR=O&rdre];
                      Image=Order }
      { 1102601013;2 ;Action    ;
                      AccessByPermission=TableData 348=R;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 NOR=Dimensjoner];
                      ToolTipML=[ENU=View or edits dimensions, such as area, project, or department, that you can assign to sales and purchase documents to distribute costs and analyze transaction history.;
                                 NOR=Vis eller rediger dimensjoner, for eksempel omrde, prosjekt eller avdeling, som du kan tilordne til salgs- og kjpsdokumenter for  distribuere kostnader og analysere transaksjonshistorikk.];
                      ApplicationArea=#Suite;
                      Image=Dimensions;
                      OnAction=BEGIN
                                 ShowDocDim;
                               END;
                                }
      { 1102601006;2 ;Action    ;
                      Name=Statistics;
                      ShortCutKey=F7;
                      CaptionML=[ENU=Statistics;
                                 NOR=Statistikk];
                      Promoted=Yes;
                      Image=Statistics;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 OpenSalesOrderStatistics;
                               END;
                                }
      { 1102601014;2 ;Action    ;
                      Name=Approvals;
                      CaptionML=[ENU=Approvals;
                                 NOR=Godkjenninger];
                      ToolTipML=[ENU=View a list of the records that are waiting to be approved. For example, you can see who requested the record to be approved, when it was sent, and when it is due to be approved.;
                                 NOR=Vis en liste med poster dom venter p  bli godkjent. Du kan for eksempel se hvem som har bedt om godkjenning av posten, nr den ble sendt og nr den forfaller til godkjenning.];
                      ApplicationArea=#Suite;
                      Image=Approvals;
                      OnAction=VAR
                                 ApprovalEntries@1001 : Page 658;
                               BEGIN
                                 ApprovalEntries.Setfilters(DATABASE::"Sales Header","Document Type","No.");
                                 ApprovalEntries.RUN;
                               END;
                                }
      { 1102601008;2 ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 NOR=&Merknader];
                      RunObject=Page 67;
                      RunPageLink=Document Type=FIELD(Document Type),
                                  No.=FIELD(No.),
                                  Document Line No.=CONST(0);
                      Image=ViewComments }
      { 9       ;1   ;ActionGroup;
                      CaptionML=[ENU=Documents;
                                 NOR=Dokumenter];
                      Image=Documents }
      { 1102601009;2 ;Action    ;
                      CaptionML=[ENU=S&hipments;
                                 NOR=F&lgesedler];
                      ToolTipML=[ENU=View the history of posted sales shipments that have been posted for the document.;
                                 NOR=Vis historikken for bokfrte flgesedler som har blitt bokfrt for dokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 142;
                      RunPageView=SORTING(Order No.);
                      RunPageLink=Order No.=FIELD(No.);
                      Image=Shipment }
      { 1102601010;2 ;Action    ;
                      Name=PostedSalesInvoices;
                      CaptionML=[ENU=Invoices;
                                 NOR=Fakturaer];
                      ToolTipML=[ENU=View the history of posted sales invoices that have been posted for the document.;
                                 NOR=Vis historikken for bokfrte salgsfakturaer som har blitt bokfrt for dokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 143;
                      RunPageView=SORTING(Order No.);
                      RunPageLink=Order No.=FIELD(No.);
                      Image=Invoice }
      { 1102601011;2 ;Action    ;
                      Name=PostedSalesPrepmtInvoices;
                      CaptionML=[ENU=Prepa&yment Invoices;
                                 NOR=F&orskuddsfakturaer];
                      RunObject=Page 143;
                      RunPageView=SORTING(Prepayment Order No.);
                      RunPageLink=Prepayment Order No.=FIELD(No.);
                      Image=PrepaymentInvoice }
      { 1102601012;2 ;Action    ;
                      CaptionML=[ENU=Prepayment Credi&t Memos;
                                 NOR=Kredi&tnotaer for forskudd];
                      RunObject=Page 144;
                      RunPageView=SORTING(Prepayment Order No.);
                      RunPageLink=Prepayment Order No.=FIELD(No.);
                      Image=PrepaymentCreditMemo }
      { 10      ;1   ;ActionGroup;
                      CaptionML=[ENU=Warehouse;
                                 NOR=Lager];
                      Image=Warehouse }
      { 1102601016;2 ;Action    ;
                      CaptionML=[ENU=Whse. Shipment Lines;
                                 NOR=Lagerleveringslinjer];
                      RunObject=Page 7341;
                      RunPageView=SORTING(Source Type,Source Subtype,Source No.,Source Line No.);
                      RunPageLink=Source Type=CONST(37),
                                  Source Subtype=FIELD(Document Type),
                                  Source No.=FIELD(No.);
                      Image=ShipmentLines }
      { 1102601017;2 ;Action    ;
                      CaptionML=[ENU=In&vt. Put-away/Pick Lines;
                                 NOR=&Lagerplass.-/-plukklinjer];
                      RunObject=Page 5774;
                      RunPageView=SORTING(Source Document,Source No.,Location Code);
                      RunPageLink=Source Document=CONST(Sales Order),
                                  Source No.=FIELD(No.);
                      Image=PickLines }
      { 32      ;1   ;ActionGroup;
                      Name=ActionGroupCRM;
                      CaptionML=[ENU=Dynamics CRM;
                                 NOR=Dynamics CRM];
                      Visible=CRMIntegrationEnabled }
      { 31      ;2   ;Action    ;
                      Name=CRMGoToSalesOrderListInNAV;
                      CaptionML=[ENU=Sales Order List;
                                 NOR=Ordreoversikt];
                      ToolTipML=[ENU=Open the Dynamics CRM Sales Order List page in Dynamics NAV;
                                 NOR=pne siden for Dynamics CRM-ordreoversikt i Dynamics NAV];
                      ApplicationArea=#Basic,#Suite;
                      Visible=CRMIntegrationEnabled;
                      Enabled=CRMIntegrationEnabled;
                      Image=Order;
                      OnAction=VAR
                                 CRMSalesorder@1000 : Record 5353;
                               BEGIN
                                 PAGE.RUN(PAGE::"CRM Sales Order List",CRMSalesorder);
                               END;
                                }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 12      ;1   ;ActionGroup;
                      CaptionML=[ENU=Release;
                                 NOR=Frigi];
                      Image=ReleaseDoc }
      { 1102601049;2 ;Action    ;
                      Name=Release;
                      ShortCutKey=Ctrl+F9;
                      CaptionML=[ENU=Re&lease;
                                 NOR=Fri&gi];
                      Promoted=Yes;
                      Image=ReleaseDoc;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ReleaseSalesDoc@1000 : Codeunit 414;
                               BEGIN
                                 ReleaseSalesDoc.PerformManualRelease(Rec);
                               END;
                                }
      { 1102601050;2 ;Action    ;
                      Name=Reopen;
                      CaptionML=[ENU=Re&open;
                                 NOR=&pne p nytt];
                      ToolTipML=[ENU=Reopen the document to change it after it has been approved. Approved documents have the Released status and must be opened before they can be changed.;
                                 NOR=pne dokumentet p nytt for  endre det etter at det har blitt godkjent. Godkjente dokumenter har statusen Frigitt, og de m pnes fr de kan endres.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Image=ReOpen;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ReleaseSalesDoc@1001 : Codeunit 414;
                               BEGIN
                                 ReleaseSalesDoc.PerformManualReopen(Rec);
                               END;
                                }
      { 1102601001;1 ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 NOR=F&unksjoner];
                      Image=Action }
      { 102     ;2   ;Action    ;
                      CaptionML=[ENU=Pla&nning;
                                 NOR=Pla&nlegging];
                      Image=Planning;
                      OnAction=VAR
                                 SalesOrderPlanningForm@1001 : Page 99000883;
                               BEGIN
                                 SalesOrderPlanningForm.SetSalesOrder("No.");
                                 SalesOrderPlanningForm.RUNMODAL;
                               END;
                                }
      { 1102601020;2 ;Action    ;
                      AccessByPermission=TableData 99000880=R;
                      CaptionML=[ENU=Order &Promising;
                                 NOR=Ordr&ebekreftelse];
                      Image=OrderPromising;
                      OnAction=VAR
                                 OrderPromisingLine@1000 : TEMPORARY Record 99000880;
                               BEGIN
                                 OrderPromisingLine.SETRANGE("Source Type","Document Type");
                                 OrderPromisingLine.SETRANGE("Source ID","No.");
                                 PAGE.RUNMODAL(PAGE::"Order Promising Lines",OrderPromisingLine);
                               END;
                                }
      { 1102601053;2 ;Action    ;
                      AccessByPermission=TableData 410=R;
                      CaptionML=[ENU=Send IC Sales Order Cnfmn.;
                                 NOR=Send bekreftelse p KI-ordre];
                      Image=IntercompanyOrder;
                      OnAction=VAR
                                 ICInOutboxMgt@1000 : Codeunit 427;
                                 ApprovalsMgmt@1003 : Codeunit 1535;
                               BEGIN
                                 IF ApprovalsMgmt.PrePostApprovalCheckSales(Rec) THEN
                                   ICInOutboxMgt.SendSalesDoc(Rec,FALSE);
                               END;
                                }
      { 24      ;1   ;ActionGroup;
                      CaptionML=[ENU=Request Approval;
                                 NOR=Be om godkjenning] }
      { 1102601046;2 ;Action    ;
                      Name=SendApprovalRequest;
                      CaptionML=[ENU=Send A&pproval Request;
                                 NOR=&Send godkjenningsforesprsel];
                      ToolTipML=[ENU=Send an approval request.;
                                 NOR=Send en godkjenningsforesprsel.];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      Enabled=NOT OpenApprovalEntriesExist;
                      PromotedIsBig=Yes;
                      Image=SendApprovalRequest;
                      PromotedCategory=Category4;
                      PromotedOnly=Yes;
                      OnAction=VAR
                                 ApprovalsMgmt@1001 : Codeunit 1535;
                               BEGIN
                                 IF ApprovalsMgmt.CheckSalesApprovalPossible(Rec) THEN
                                   ApprovalsMgmt.OnSendSalesDocForApproval(Rec);
                               END;
                                }
      { 1102601047;2 ;Action    ;
                      Name=CancelApprovalRequest;
                      CaptionML=[ENU=Cancel Approval Re&quest;
                                 NOR=&Annuller godkjenningsforesprsel];
                      ToolTipML=[ENU=Cancel the approval request.;
                                 NOR=Annuller godkjenningsforesprselen.];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      Enabled=CanCancelApprovalForRecord;
                      PromotedIsBig=Yes;
                      Image=CancelApprovalRequest;
                      PromotedCategory=Category4;
                      PromotedOnly=Yes;
                      OnAction=VAR
                                 ApprovalsMgmt@1001 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.OnCancelSalesApprovalRequest(Rec);
                               END;
                                }
      { 3       ;1   ;ActionGroup;
                      CaptionML=[ENU=Warehouse;
                                 NOR=Lager];
                      Image=Warehouse }
      { 100     ;2   ;Action    ;
                      AccessByPermission=TableData 7342=R;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Create Inventor&y Put-away/Pick;
                                 NOR=Opprett lagerplas&sering/-plukk];
                      Image=CreatePutawayPick;
                      OnAction=BEGIN
                                 CreateInvtPutAwayPick;

                                 IF NOT FIND('=><') THEN
                                   INIT;
                               END;
                                }
      { 1102601043;2 ;Action    ;
                      AccessByPermission=TableData 7320=R;
                      CaptionML=[ENU=Create &Whse. Shipment;
                                 NOR=Opprett la&gerlevering];
                      Image=NewShipment;
                      OnAction=VAR
                                 GetSourceDocOutbound@1001 : Codeunit 5752;
                               BEGIN
                                 GetSourceDocOutbound.CreateFromSalesOrder(Rec);

                                 IF NOT FIND('=><') THEN
                                   INIT;
                               END;
                                }
      { 49      ;1   ;ActionGroup;
                      CaptionML=[ENU=P&osting;
                                 NOR=B&okfring];
                      Image=Post }
      { 1102601003;2 ;Action    ;
                      Name=Post;
                      ShortCutKey=F9;
                      Ellipsis=Yes;
                      CaptionML=[ENU=P&ost;
                                 NOR=B&okfr];
                      ToolTipML=[ENU=Finalize the document or journal by posting the amounts and quantities to the related accounts in your company books.;
                                 NOR=Fullfr dokumentet eller kladden ved  bokfre belpene og antallene til de relaterte kontoene i firmatablene.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PostOrder;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Post(CODEUNIT::"Sales-Post (Yes/No)");
                               END;
                                }
      { 25      ;2   ;Action    ;
                      Name=PostAndSend;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Post and Send;
                                 NOR=Bokfr og send];
                      ToolTipML=[ENU=Finalize and prepare to send the document according to the customer's sending profile, such as attached to an email. The Send document to window opens where you can confirm or select a sending profile.;
                                 NOR=Fullfr og klargjr for  sende dokumentet i henhold til kundens sendingsprofil, for eksempel vedlagt i en e-post. Vinduet Send dokument til pnes, og der kan du bekrefte eller velge en sendingsprofil.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PostMail;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Post(CODEUNIT::"Sales-Post and Send");
                               END;
                                }
      { 1102601002;2 ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Test Report;
                                 NOR=Kontrollrapport];
                      ToolTipML=[ENU=View a test report so that you can find and correct any errors before you perform the actual posting of the journal or document.;
                                 NOR=Vis en kontrollrapport slik at du kan finne og rette eventuelle feil fr du bokfrer kladden eller dokumentet.];
                      Image=TestReport;
                      OnAction=BEGIN
                                 ReportPrint.PrintSalesHeader(Rec);
                               END;
                                }
      { 50      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Post &Batch;
                                 NOR=Masse&bokfr];
                      Promoted=Yes;
                      Image=PostBatch;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 REPORT.RUNMODAL(REPORT::"Batch Post Sales Orders",TRUE,TRUE,Rec);
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 8       ;2   ;Action    ;
                      CaptionML=[ENU=Remove From Job Queue;
                                 NOR=Fjern fra jobbk];
                      ToolTipML=[ENU=Remove the scheduled processing of this record from the job queue.;
                                 NOR=Fjern den planlagte behandlingen av denne posten fra prosjektken.];
                      ApplicationArea=#All;
                      Visible=JobQueueActive;
                      Image=RemoveLine;
                      OnAction=BEGIN
                                 CancelBackgroundPosting;
                               END;
                                }
      { 22      ;2   ;Action    ;
                      CaptionML=[ENU=Preview Posting;
                                 NOR=Forhndsvis bokfring];
                      ToolTipML=[ENU=Review the different types of entries that will be created when you post the document or journal.;
                                 NOR=Se gjennom de ulike typene poster som blir opprettet nr du bokfrer dokumentet eller kladden.];
                      ApplicationArea=#Basic,#Suite;
                      Image=ViewPostedOrder;
                      OnAction=BEGIN
                                 ShowPreview
                               END;
                                }
      { 150     ;1   ;ActionGroup;
                      CaptionML=[ENU=&Print;
                                 NOR=&Skriv ut];
                      Image=Print }
      { 152     ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Work Order;
                                 NOR=Arbeidsordre];
                      Image=Print;
                      OnAction=BEGIN
                                 DocPrint.PrintSalesOrder(Rec,Usage::"Work Order");
                               END;
                                }
      { 7       ;2   ;Action    ;
                      CaptionML=[ENU=Pick Instruction;
                                 NOR=Plukkinstruksjon];
                      Image=Print;
                      OnAction=BEGIN
                                 DocPrint.PrintSalesOrder(Rec,Usage::"Pick Instruction");
                               END;
                                }
      { 1080000 ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Print Picking List;
                                 NOR=Skriv ut plukkliste];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Image=Print;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 DocPrint.PrintSalesOrder(Rec,Usage::"Sales Order Picking List");
                               END;
                                }
      { 19      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Order Confirmation;
                                 NOR=&Ordrebekreftelse];
                      Image=Email }
      { 18      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Email Confirmation;
                                 NOR=Send bekreftelse p e-post];
                      ToolTipML=[ENU=Send an order confirmation by email. The Send Email window opens prefilled for the customer so you can add or change information before you send the email.;
                                 NOR=Send en ordrebekreftelse via e-post. Vinduet Send e-post pnes forhndsutfylt for kunder, slik at du kan legge til eller endre informasjon fr du sender e-posten.];
                      ApplicationArea=#Basic,#Suite;
                      Image=Email;
                      OnAction=BEGIN
                                 DocPrint.EmailSalesHeader(Rec);
                               END;
                                }
      { 151     ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Print Confirmation;
                                 NOR=Skriv ut bekreftelse];
                      ToolTipML=[ENU=Print an order confirmation. A report request window opens where you can specify what to include on the print-out.;
                                 NOR=Skriv ut en ordrebekreftelse. Et rapportforesprselsvindu vises, der du kan angi hva som skal inkluderes p utskriften.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Visible=NOT IsOfficeAddin;
                      Image=Print;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 DocPrint.PrintSalesOrder(Rec,Usage::"Order Confirmation");
                               END;
                                }
      { 1900000006;0 ;ActionContainer;
                      ActionContainerType=Reports }
      { 1904702706;1 ;Action    ;
                      CaptionML=[ENU=Sales Reservation Avail.;
                                 NOR=Salgsreserv. tilgjengelighet];
                      RunObject=Report 209;
                      Promoted=Yes;
                      Image=Report;
                      PromotedCategory=Report }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the sales document.;
                           NOR=Angir nummeret p salgsdokumentet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="No." }

    { 4   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the customer who will receive the products and be billed by default.;
                           NOR=Angir nummeret p kunden som mottar produktene og faktureres som standard.];
                SourceExpr="Sell-to Customer No." }

    { 6   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the name of the customer who will receive the products and be billed by default.;
                           NOR=Angir navnet p kunden som mottar produktene og faktureres som standard.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Sell-to Customer Name" }

    { 17  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number that the customer uses in their own system to refer to this sales document.;
                           NOR=Angir nummeret som kunden bruker i sitt eget system for  referere til dette salgsdokumentet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="External Document No." }

    { 33  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the postal code of the address.;
                           NOR=Angir postnummeret for adressen.];
                SourceExpr="Sell-to Post Code";
                Visible=FALSE }

    { 29  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the country/region code of the address.;
                           NOR=Angir lands-/omrdekoden for adressen.];
                SourceExpr="Sell-to Country/Region Code";
                Visible=FALSE }

    { 41  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the name of the person to contact at the customer.;
                           NOR=Angir navnet p kontaktpersonen hos kunden.];
                SourceExpr="Sell-to Contact";
                Visible=FALSE }

    { 13  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the customer to whom you will send the sales invoice when this customer is different from the sell-to customer.;
                           NOR=Angir kunden som du sender salgsfakturaen til, nr denne kunden ikke er den samme personen som du selger til.];
                SourceExpr="Bill-to Customer No.";
                Visible=FALSE }

    { 15  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the customer to whom you will send the sales invoice, when different from the customer that you are selling to.;
                           NOR=Angir kunden som du sender salgsfakturaen til, nr det er en annen enn kunden som du selger til.];
                SourceExpr="Bill-to Name";
                Visible=FALSE }

    { 39  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the postal code of the address.;
                           NOR=Angir postnummeret for adressen.];
                SourceExpr="Bill-to Post Code";
                Visible=FALSE }

    { 35  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the country/region code of the address.;
                           NOR=Angir lands-/omrdekoden for adressen.];
                SourceExpr="Bill-to Country/Region Code";
                Visible=FALSE }

    { 159 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the name of the person you should contact at the customer who you are sending the invoice to.;
                           NOR=Angir navnet p kontaktperson hos kunden som fakturaen blir sendt til.];
                SourceExpr="Bill-to Contact";
                Visible=FALSE }

    { 155 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for another shipment address than the customer's own address, which is entered by default.;
                           NOR=Angir koden for en annen leveringsadresse enn kundens egen adresse, som er angitt som standard.];
                SourceExpr="Ship-to Code";
                Visible=FALSE }

    { 153 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the name that products on the sales document will be shipped to.;
                           NOR=Angir navnet som produkter p salgsdokumentet skal leveres til.];
                SourceExpr="Ship-to Name";
                Visible=FALSE }

    { 27  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the postal code of the address.;
                           NOR=Angir postnummeret for adressen.];
                SourceExpr="Ship-to Post Code";
                Visible=FALSE }

    { 23  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the country/region code of the address.;
                           NOR=Angir lands-/omrdekoden for adressen.];
                SourceExpr="Ship-to Country/Region Code";
                Visible=FALSE }

    { 143 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the name of the contact person at the address that products will be shipped to.;
                           NOR=Angir navnet p kontaktpersonen i adressen som produkter skal leveres til.];
                SourceExpr="Ship-to Contact";
                Visible=FALSE }

    { 139 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date when the posting of the sales document will be recorded.;
                           NOR=Angir datoen nr bokfringen av salgsdokumentet blir registrert.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Posting Date";
                Visible=FALSE }

    { 121 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the dimension value code for the sales header.;
                           NOR=Angir dimensjonsverdikoden for salgshodet.];
                ApplicationArea=#Suite;
                SourceExpr="Shortcut Dimension 1 Code";
                Visible=FALSE }

    { 119 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the dimension value code for the sales header.;
                           NOR=Angir dimensjonsverdikoden for salgshodet.];
                ApplicationArea=#Suite;
                SourceExpr="Shortcut Dimension 2 Code";
                Visible=FALSE }

    { 123 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the location from where inventory items to the customer on the sales document are to be shipped by default.;
                           NOR=Angir plasseringen der lagervarer til kunden p salgsdokumentet leveres fra som standard.];
                SourceExpr="Location Code" }

    { 99  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the name of the salesperson who is assigned to the customer.;
                           NOR=Angir navnet p selgeren som er knyttet til kunden.];
                ApplicationArea=#Suite;
                SourceExpr="Salesperson Code";
                Visible=FALSE }

    { 21  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the ID of the user who is responsible for the document.;
                           NOR=Angir ID-en til brukeren som er ansvarlig for dokumentet.];
                SourceExpr="Assigned User ID" }

    { 11  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the currency of amounts on the sales document.;
                           NOR=Angir valutaen til belpene p salgsdokumentet.];
                ApplicationArea=#Suite;
                SourceExpr="Currency Code";
                Visible=FALSE }

    { 1102601025;2;Field  ;
                ToolTipML=[ENU=Specifies the date on which you created the sales document.;
                           NOR=Angir datoen da du opprettet salgsdokumentet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Document Date";
                Visible=FALSE }

    { 1102601027;2;Field  ;
                ToolTipML=[ENU=Specifies the date that the customer has asked for the order to be delivered.;
                           NOR=Angir p hvilken dato kunden har bedt om at ordren skal leveres.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Requested Delivery Date";
                Visible=FALSE }

    { 1102601005;2;Field  ;
                ToolTipML=[ENU=Specifies the campaign number the document is linked to.;
                           NOR=Angir kampanjenummeret som dokumentet er koblet til.];
                SourceExpr="Campaign No.";
                Visible=FALSE }

    { 1102601029;2;Field  ;
                ToolTipML=[ENU=Specifies whether the document is open, waiting to be approved, has been invoiced for prepayment, or has been released to the next stage of processing.;
                           NOR=Angir om dokumentet er pent, om det venter p godkjenning, om det er fakturert for forskudd eller om det er frigitt til neste fase i behandlingen.];
                SourceExpr=Status }

    { 1102601039;2;Field  ;
                ToolTipML=[ENU=Specifies a formula that calculates the payment due date, payment discount date, and payment discount amount on the sales document.;
                           NOR=Angir en formel som beregner forfallsdatoen for betalingen, kontantrabattdatoen og kontantrabattbelpet, p salgsdokumentet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Payment Terms Code";
                Visible=FALSE }

    { 1102601041;2;Field  ;
                ToolTipML=[ENU=Specifies when the sales invoice must be paid.;
                           NOR=Angir nr salgsfakturaen m betales.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Due Date";
                Visible=FALSE }

    { 1102601054;2;Field  ;
                ToolTipML=[ENU=Specifies the payment discount percentage that is granted if the customer pays on or before the date entered in the Pmt. Discount Date field. The discount percentage is specified in the Payment Terms Code field.;
                           NOR=Angir kontantrabattprosenten som gis hvis kunden betaler p eller fr datoen som er angitt i feltet Kont.rabattdato. Rabattprosenten er angitt i feltet Betalingsbet.kode.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Payment Discount %";
                Visible=FALSE }

    { 1102601035;2;Field  ;
                ToolTipML=[ENU=Specifies how items on the sales document are shipped to the customer.;
                           NOR=Angir hvordan varer p salgsdokumentet leveres til kunden.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Shipment Method Code";
                Visible=FALSE }

    { 1102601033;2;Field  ;
                ToolTipML=[ENU=Specifies which shipping agent is used to transport the items on the sales document to the customer.;
                           NOR=Angir hvilken transportr som skal brukes til  transportere varene p salgsdokumentet til kunden.];
                ApplicationArea=#Suite;
                SourceExpr="Shipping Agent Code";
                Visible=FALSE }

    { 14  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies which shipping agent service is used to transport the items on the sales document to the customer.;
                           NOR=Angir hvilken transportrtjeneste som skal brukes til  transportere varene p salgsdokumentet til kunden.];
                ApplicationArea=#Suite;
                SourceExpr="Shipping Agent Service Code";
                Visible=FALSE }

    { 26  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the shipping agent's package number.;
                           NOR=Angir transportrens pakkenummer.];
                ApplicationArea=#Suite;
                SourceExpr="Package Tracking No.";
                Visible=FALSE }

    { 1102601031;2;Field  ;
                ToolTipML=[ENU=Specifies the date you expect to ship items on the sales document.;
                           NOR=Angir datoen du forventer  levere varer, p salgsdokumentet.];
                SourceExpr="Shipment Date";
                Visible=FALSE }

    { 1102601037;2;Field  ;
                ToolTipML=[ENU=Specifies if the customer accepts partial shipment of orders.;
                           NOR=Angir om kunden godtar dellevering av ordrer.];
                SourceExpr="Shipping Advice";
                Visible=FALSE }

    { 16  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies whether all the items on the order have been shipped or, in the case of inbound items, completely received.;
                           NOR=Angir om alle varene i ordren er levert eller, i tilfelle inngende varer, er fullstendig mottatt.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Completely Shipped" }

    { 5   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the status of a job queue entry or task that handles the posting of sales orders.;
                           NOR=Angir status for en jobbkpost eller oppgave som hndterer bokfring av ordrer.];
                ApplicationArea=#All;
                SourceExpr="Job Queue Status";
                Visible=JobQueueActive }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1101103001;1;Part   ;
                Name=DocumentFileFactBox;
                PagePartID=Page53202;
                PartType=Page }

    { 1902018507;1;Part   ;
                ApplicationArea=#Basic,#Suite;
                SubPageLink=No.=FIELD(Bill-to Customer No.),
                            Date Filter=FIELD(Date Filter);
                PagePartID=Page9082;
                PartType=Page }

    { 1900316107;1;Part   ;
                ApplicationArea=#Basic,#Suite;
                SubPageLink=No.=FIELD(Bill-to Customer No.),
                            Date Filter=FIELD(Date Filter);
                PagePartID=Page9084;
                PartType=Page }

    { 20  ;1   ;Part      ;
                Name=IncomingDocAttachFactBox;
                ApplicationArea=#Basic,#Suite;
                PagePartID=Page193;
                Visible=FALSE;
                PartType=Page;
                ShowFilter=No }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      ApplicationAreaSetup@1007 : Record 9178;
      DocPrint@1102601000 : Codeunit 229;
      ReportPrint@1102601002 : Codeunit 228;
      UserMgt@1000 : Codeunit 5700;
      Usage@1001 : 'Order Confirmation,Work Order,Pick Instruction,Sales Order Picking List';
      JobQueueActive@1004 : Boolean INDATASET;
      OpenApprovalEntriesExist@1006 : Boolean;
      CRMIntegrationEnabled@1002 : Boolean;
      IsOfficeAddin@1003 : Boolean;
      CanCancelApprovalForRecord@1005 : Boolean;

    PROCEDURE ShowPreview@1();
    VAR
      SalesPostYesNo@1001 : Codeunit 81;
    BEGIN
      SalesPostYesNo.Preview(Rec);
    END;

    LOCAL PROCEDURE SetControlVisibility@5();
    VAR
      ApprovalsMgmt@1000 : Codeunit 1535;
    BEGIN
      OpenApprovalEntriesExist := ApprovalsMgmt.HasOpenApprovalEntries(RECORDID);

      CanCancelApprovalForRecord := ApprovalsMgmt.CanCancelApprovalForRecord(RECORDID);
    END;

    LOCAL PROCEDURE Post@4(PostingCodeunitID@1000 : Integer);
    VAR
      LinesInstructionMgt@1002 : Codeunit 1320;
    BEGIN
      IF ApplicationAreaSetup.IsFoundationEnabled THEN
        LinesInstructionMgt.SalesCheckAllLinesHaveQuantityAssigned(Rec);

      SendToPosting(PostingCodeunitID);

      CurrPage.UPDATE(FALSE);
    END;

    BEGIN
    END.
  }
}

OBJECT Page 9307 Purchase Order List
{
  OBJECT-PROPERTIES
  {
    Date=26.10.16;
    Time=14:46:54;
    Modified=Yes;
    Version List=NAVW110.00,DOC1.0;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Purchase Orders;
               NOR=Bestillinger];
    SourceTable=Table38;
    SourceTableView=WHERE(Document Type=CONST(Order));
    DataCaptionFields=Buy-from Vendor No.;
    PageType=List;
    CardPageID=Purchase Order;
    PromotedActionCategoriesML=[ENU=New,Process,Report,Request Approval;
                                NOR=Ny,Prosess,Rapport,Foresprselsgodkjenning];
    OnOpenPage=VAR
                 PurchasesPayablesSetup@1000 : Record 312;
               BEGIN
                 SetSecurityFilterOnRespCenter;

                 JobQueueActive := PurchasesPayablesSetup.JobQueueActive;

                 CopyBuyFromVendorFilter;
               END;

    OnAfterGetCurrRecord=BEGIN
                           SetControlAppearance;
                           CurrPage.IncomingDocAttachFactBox.PAGE.LoadDataFromRecord(Rec);
                           CurrPage.DocumentFileFactBox.PAGE.LoadDataFromRecord(Rec);
                         END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1102601026;1 ;ActionGroup;
                      CaptionML=[ENU=O&rder;
                                 NOR=O&rdre];
                      Image=Order }
      { 1102601035;2 ;Action    ;
                      AccessByPermission=TableData 348=R;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 NOR=Dimensjoner];
                      ToolTipML=[ENU=View or edits dimensions, such as area, project, or department, that you can assign to sales and purchase documents to distribute costs and analyze transaction history.;
                                 NOR=View or edits dimensions, such as area, project, or department, that you can assign to sales and purchase documents to distribute costs and analyze transaction history.];
                      ApplicationArea=#Suite;
                      Promoted=No;
                      PromotedIsBig=No;
                      Image=Dimensions;
                      OnAction=BEGIN
                                 ShowDocDim;
                               END;
                                }
      { 1102601028;2 ;Action    ;
                      Name=Statistics;
                      ShortCutKey=F7;
                      CaptionML=[ENU=Statistics;
                                 NOR=Statistikk];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Statistics;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 OpenPurchaseOrderStatistics;
                               END;
                                }
      { 18      ;2   ;Action    ;
                      Name=Approvals;
                      AccessByPermission=TableData 454=R;
                      CaptionML=[ENU=Approvals;
                                 NOR=Godkjenninger];
                      ToolTipML=[ENU=View a list of the records that are waiting to be approved. For example, you can see who requested the record to be approved, when it was sent, and when it is due to be approved.;
                                 NOR=Vis en liste med poster dom venter p  bli godkjent. Du kan for eksempel se hvem som har bedt om godkjenning av posten, nr den ble sendt og nr den forfaller til godkjenning.];
                      ApplicationArea=#Suite;
                      Image=Approvals;
                      OnAction=VAR
                                 ApprovalEntries@1001 : Page 658;
                               BEGIN
                                 ApprovalEntries.Setfilters(DATABASE::"Purchase Header","Document Type","No.");
                                 ApprovalEntries.RUN;
                               END;
                                }
      { 1102601030;2 ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 NOR=&Merknader];
                      RunObject=Page 66;
                      RunPageLink=Document Type=FIELD(Document Type),
                                  No.=FIELD(No.),
                                  Document Line No.=CONST(0);
                      Image=ViewComments }
      { 7       ;1   ;ActionGroup;
                      CaptionML=[ENU=Documents;
                                 NOR=Dokumenter];
                      Image=Documents }
      { 1102601031;2 ;Action    ;
                      CaptionML=[ENU=Receipts;
                                 NOR=Mottak];
                      ApplicationArea=#Suite;
                      RunObject=Page 145;
                      RunPageView=SORTING(Order No.);
                      RunPageLink=Order No.=FIELD(No.);
                      Promoted=No;
                      PromotedIsBig=No;
                      Image=PostedReceipts }
      { 1102601032;2 ;Action    ;
                      Name=PostedPurchaseInvoices;
                      CaptionML=[ENU=Invoices;
                                 NOR=Fakturaer];
                      ApplicationArea=#Suite;
                      RunObject=Page 146;
                      RunPageView=SORTING(Order No.);
                      RunPageLink=Order No.=FIELD(No.);
                      Promoted=No;
                      PromotedIsBig=No;
                      Image=Invoice }
      { 1102601033;2 ;Action    ;
                      Name=PostedPurchasePrepmtInvoices;
                      CaptionML=[ENU=Prepa&yment Invoices;
                                 NOR=F&orskuddsfakturaer];
                      RunObject=Page 146;
                      RunPageView=SORTING(Prepayment Order No.);
                      RunPageLink=Prepayment Order No.=FIELD(No.);
                      Image=PrepaymentInvoice }
      { 1102601034;2 ;Action    ;
                      CaptionML=[ENU=Prepayment Credi&t Memos;
                                 NOR=Kredi&tnotaer for forskudd];
                      RunObject=Page 147;
                      RunPageView=SORTING(Prepayment Order No.);
                      RunPageLink=Prepayment Order No.=FIELD(No.);
                      Image=PrepaymentCreditMemo }
      { 1102601037;2 ;Separator  }
      { 8       ;1   ;ActionGroup;
                      CaptionML=[ENU=Warehouse;
                                 NOR=Lager];
                      Image=Warehouse }
      { 1102601039;2 ;Action    ;
                      CaptionML=[ENU=In&vt. Put-away/Pick Lines;
                                 NOR=&Lagerplass.-/-plukklinjer];
                      RunObject=Page 5774;
                      RunPageView=SORTING(Source Document,Source No.,Location Code);
                      RunPageLink=Source Document=CONST(Purchase Order),
                                  Source No.=FIELD(No.);
                      Image=PickLines }
      { 1102601038;2 ;Action    ;
                      CaptionML=[ENU=Whse. Receipt Lines;
                                 NOR=Lagermottakslinjer];
                      RunObject=Page 7342;
                      RunPageView=SORTING(Source Type,Source Subtype,Source No.,Source Line No.);
                      RunPageLink=Source Type=CONST(39),
                                  Source Subtype=FIELD(Document Type),
                                  Source No.=FIELD(No.);
                      Image=ReceiptLines }
      { 1102601040;2 ;Separator  }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 9       ;1   ;ActionGroup;
                      CaptionML=[ENU=General;
                                 NOR=Generelt];
                      Image=Print }
      { 55      ;2   ;Action    ;
                      Name=Print;
                      Ellipsis=Yes;
                      CaptionML=[ENU=&Print;
                                 NOR=&Skriv ut];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      Image=Print;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 DocPrint.PrintPurchHeader(Rec);
                               END;
                                }
      { 10      ;1   ;ActionGroup;
                      CaptionML=[ENU=Release;
                                 NOR=Frigi];
                      Image=ReleaseDoc }
      { 1102601021;2 ;Action    ;
                      Name=Release;
                      ShortCutKey=Ctrl+F9;
                      CaptionML=[ENU=Re&lease;
                                 NOR=Fri&gi];
                      Image=ReleaseDoc;
                      OnAction=VAR
                                 ReleasePurchDoc@1000 : Codeunit 415;
                               BEGIN
                                 ReleasePurchDoc.PerformManualRelease(Rec);
                               END;
                                }
      { 1102601022;2 ;Action    ;
                      Name=Reopen;
                      CaptionML=[ENU=Re&open;
                                 NOR=&pne p nytt];
                      ApplicationArea=#Suite;
                      Image=ReOpen;
                      OnAction=VAR
                                 ReleasePurchDoc@1001 : Codeunit 415;
                               BEGIN
                                 ReleasePurchDoc.PerformManualReopen(Rec);
                               END;
                                }
      { 1102601023;2 ;Separator  }
      { 1102601000;1 ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 NOR=F&unksjoner];
                      Image=Action }
      { 1102601025;2 ;Action    ;
                      AccessByPermission=TableData 410=R;
                      CaptionML=[ENU=Send IC Purchase Order;
                                 NOR=Send KI-bestilling];
                      Image=IntercompanyOrder;
                      OnAction=VAR
                                 ICInOutboxMgt@1000 : Codeunit 427;
                                 ApprovalsMgmt@1003 : Codeunit 1535;
                               BEGIN
                                 IF ApprovalsMgmt.PrePostApprovalCheckPurch(Rec) THEN
                                   ICInOutboxMgt.SendPurchDoc(Rec,FALSE);
                               END;
                                }
      { 19      ;1   ;ActionGroup;
                      CaptionML=[ENU=Request Approval;
                                 NOR=Be om godkjenning] }
      { 1102601018;2 ;Action    ;
                      Name=SendApprovalRequest;
                      CaptionML=[ENU=Send A&pproval Request;
                                 NOR=&Send godkjenningsforesprsel];
                      ToolTipML=[ENU=Send an approval request.;
                                 NOR=Send en godkjenningsforesprsel.];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      Enabled=NOT OpenApprovalEntriesExist;
                      PromotedIsBig=Yes;
                      Image=SendApprovalRequest;
                      PromotedCategory=Category4;
                      PromotedOnly=Yes;
                      OnAction=VAR
                                 ApprovalsMgmt@1001 : Codeunit 1535;
                               BEGIN
                                 IF ApprovalsMgmt.CheckPurchaseApprovalPossible(Rec) THEN
                                   ApprovalsMgmt.OnSendPurchaseDocForApproval(Rec);
                               END;
                                }
      { 1102601019;2 ;Action    ;
                      Name=CancelApprovalRequest;
                      CaptionML=[ENU=Cancel Approval Re&quest;
                                 NOR=&Annuller godkjenningsforesprsel];
                      ToolTipML=[ENU=Cancel the approval request.;
                                 NOR=Annuller godkjenningsforesprselen.];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      Enabled=CanCancelApprovalForRecord;
                      PromotedIsBig=Yes;
                      Image=CancelApprovalRequest;
                      PromotedCategory=Category4;
                      PromotedOnly=Yes;
                      OnAction=VAR
                                 ApprovalsMgmt@1001 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.OnCancelPurchaseApprovalRequest(Rec);
                               END;
                                }
      { 12      ;1   ;ActionGroup;
                      CaptionML=[ENU=Warehouse;
                                 NOR=Lager];
                      Image=Warehouse }
      { 1102601015;2 ;Action    ;
                      AccessByPermission=TableData 7316=R;
                      CaptionML=[ENU=Create &Whse. Receipt;
                                 NOR=Opprett &lagermottak];
                      Image=NewReceipt;
                      OnAction=VAR
                                 GetSourceDocInbound@1001 : Codeunit 5751;
                               BEGIN
                                 GetSourceDocInbound.CreateFromPurchOrder(Rec);

                                 IF NOT FIND('=><') THEN
                                   INIT;
                               END;
                                }
      { 1102601016;2 ;Action    ;
                      AccessByPermission=TableData 7340=R;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Create Inventor&y Put-away/Pick;
                                 NOR=Opprett lagerplas&sering/-plukk];
                      Image=CreatePutawayPick;
                      OnAction=BEGIN
                                 CreateInvtPutAwayPick;

                                 IF NOT FIND('=><') THEN
                                   INIT;
                               END;
                                }
      { 1102601017;2 ;Separator  }
      { 50      ;1   ;ActionGroup;
                      CaptionML=[ENU=P&osting;
                                 NOR=B&okfring];
                      Image=Post }
      { 51      ;2   ;Action    ;
                      Name=TestReport;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Test Report;
                                 NOR=Kontrollrapport];
                      Image=TestReport;
                      OnAction=BEGIN
                                 ReportPrint.PrintPurchHeader(Rec);
                               END;
                                }
      { 52      ;2   ;Action    ;
                      Name=Post;
                      ShortCutKey=F9;
                      Ellipsis=Yes;
                      CaptionML=[ENU=P&ost;
                                 NOR=B&okfr];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PostOrder;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 SendToPosting(CODEUNIT::"Purch.-Post (Yes/No)");
                               END;
                                }
      { 16      ;2   ;Action    ;
                      Name=Preview;
                      CaptionML=[ENU=Preview Posting;
                                 NOR=Forhndsvis bokfring];
                      ToolTipML=[ENU=Review the different types of entries that will be created when you post the document or journal.;
                                 NOR=Review the different types of entries that will be created when you post the document or journal.];
                      ApplicationArea=#Suite;
                      Image=ViewPostedOrder;
                      OnAction=VAR
                                 PurchPostYesNo@1001 : Codeunit 91;
                               BEGIN
                                 PurchPostYesNo.Preview(Rec);
                               END;
                                }
      { 53      ;2   ;Action    ;
                      Name=PostAndPrint;
                      ShortCutKey=Shift+F9;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Post and &Print;
                                 NOR=Bokfr og &skriv ut];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PostPrint;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 SendToPosting(CODEUNIT::"Purch.-Post + Print");
                               END;
                                }
      { 54      ;2   ;Action    ;
                      Name=PostBatch;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Post &Batch;
                                 NOR=Masse&bokfr];
                      Promoted=Yes;
                      Image=PostBatch;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 REPORT.RUNMODAL(REPORT::"Batch Post Purchase Orders",TRUE,TRUE,Rec);
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 3       ;2   ;Action    ;
                      Name=RemoveFromJobQueue;
                      CaptionML=[ENU=Remove From Job Queue;
                                 NOR=Fjern fra jobbk];
                      ApplicationArea=#Suite;
                      Visible=JobQueueActive;
                      Image=RemoveLine;
                      OnAction=BEGIN
                                 CancelBackgroundPosting;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the purchase document.;
                           NOR=Angir nummeret p kjpsdokumentet.];
                ApplicationArea=#Suite;
                SourceExpr="No." }

    { 4   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the vendor you buy from.;
                           NOR=Angir nummeret for leverandren du kjper fra.];
                SourceExpr="Buy-from Vendor No." }

    { 13  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the order address code linked to the relevant vendor's order address.;
                           NOR=Angir bestillingsadressekoden som er knyttet til den relevante leverandrens bestillingsadresse.];
                SourceExpr="Order Address Code";
                Visible=FALSE }

    { 6   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the name of the vendor who sends the items.;
                           NOR=Angir navnet p leverandren som sender varene.];
                ApplicationArea=#Suite;
                SourceExpr="Buy-from Vendor Name" }

    { 15  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the compensation agreement identification number, sometimes referred to as the RMA No. (Returns Materials Authorization).;
                           NOR=Angir ID-nummeret for kompensasjonsavtale. Dette nummeret kalles noen ganger RMA-nummeret (returmaterialeautorisasjon).];
                SourceExpr="Vendor Authorization No." }

    { 27  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the postal code of the address.;
                           NOR=Angir postnummeret for adressen.];
                SourceExpr="Buy-from Post Code";
                Visible=FALSE }

    { 23  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the country/region code of the address.;
                           NOR=Angir lands-/omrdekoden for adressen.];
                SourceExpr="Buy-from Country/Region Code";
                Visible=FALSE }

    { 35  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the name of the person to contact about shipment of the item from this vendor.;
                           NOR=Angir navnet p kontaktpersonen som kan kontaktes angende varelevering fra denne leverandren.];
                SourceExpr="Buy-from Contact";
                Visible=FALSE }

    { 163 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the vendor who is sending the invoice.;
                           NOR=Angir leverandren som sender fakturaen.];
                SourceExpr="Pay-to Vendor No.";
                Visible=FALSE }

    { 161 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the name of the vendor sending the invoice.;
                           NOR=Angir navnet p leverandren som sender fakturaen.];
                SourceExpr="Pay-to Name";
                Visible=FALSE }

    { 33  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the postal code of the address.;
                           NOR=Angir postnummeret for adressen.];
                SourceExpr="Pay-to Post Code";
                Visible=FALSE }

    { 29  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the country/region code of the address.;
                           NOR=Angir lands-/omrdekoden for adressen.];
                SourceExpr="Pay-to Country/Region Code";
                Visible=FALSE }

    { 151 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the name of the person to contact about an invoice from this vendor.;
                           NOR=Angir navnet p den personen som skal kontaktes hvis det oppstr sprsml til en faktura fra denne leverandren.];
                SourceExpr="Pay-to Contact";
                Visible=FALSE }

    { 147 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a ship-to code if you want a different shipment address from the one that has been automatically entered.;
                           NOR=Angir en lever til-kode hvis du vil ha en annen lever til-adresse enn den som automatisk er satt inn.];
                SourceExpr="Ship-to Code";
                Visible=FALSE }

    { 145 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the name of the company at the address to which you want the items to be shipped.;
                           NOR=Angir navnet p firmaet med adressen som du vil at varene skal leveres til.];
                SourceExpr="Ship-to Name";
                Visible=FALSE }

    { 21  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the postal code of the address.;
                           NOR=Angir postnummeret for adressen.];
                SourceExpr="Ship-to Post Code";
                Visible=FALSE }

    { 17  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the country/region code of the address.;
                           NOR=Angir lands-/omrdekoden for adressen.];
                SourceExpr="Ship-to Country/Region Code";
                Visible=FALSE }

    { 135 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the name of a contact person for the address where the items should be shipped.;
                           NOR=Angir navnet p en kontaktperson for adressen som varene skal leveres til.];
                SourceExpr="Ship-to Contact";
                Visible=FALSE }

    { 131 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date when the posting of the purchase document will be recorded.;
                           NOR=Angir datoen nr bokfringen av kjpsdokumentet blir registrert.];
                ApplicationArea=#Suite;
                SourceExpr="Posting Date";
                Visible=FALSE }

    { 113 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the dimension value code associated with the purchase header.;
                           NOR=Angir dimensjonsverdikoden som er knyttet til kjpshodet.];
                ApplicationArea=#Suite;
                SourceExpr="Shortcut Dimension 1 Code";
                Visible=FALSE }

    { 111 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the dimension value code associated with the purchase header.;
                           NOR=Angir dimensjonsverdikoden som er knyttet til kjpshodet.];
                ApplicationArea=#Suite;
                SourceExpr="Shortcut Dimension 2 Code";
                Visible=FALSE }

    { 115 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a code for the location where you want the items to be placed when they are received.;
                           NOR=Angir en kode for lokasjonen der du vil at de bestilte varene skal plasseres.];
                SourceExpr="Location Code" }

    { 99  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies which purchaser is assigned to the vendor.;
                           NOR=Angir hvilken innkjper som er knyttet til leverandren.];
                ApplicationArea=#Suite;
                SourceExpr="Purchaser Code";
                Visible=FALSE }

    { 31  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the ID of the user who is responsible for the document.;
                           NOR=Angir ID-en til brukeren som er ansvarlig for dokumentet.];
                SourceExpr="Assigned User ID" }

    { 11  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code of the currency of the amounts on the purchase lines.;
                           NOR=Angir valutakoden for belpene p kjpslinjene.];
                ApplicationArea=#Suite;
                SourceExpr="Currency Code";
                Visible=FALSE }

    { 1102601001;2;Field  ;
                ToolTipML=[ENU=Specifies the date of the vendor's invoice.;
                           NOR=Angir datoen for leverandrens faktura.];
                ApplicationArea=#Suite;
                SourceExpr="Document Date";
                Visible=FALSE }

    { 1102601003;2;Field  ;
                ToolTipML=[ENU=Specifies whether the record is open, waiting to be approved, invoiced for prepayment, or released to the next stage of processing.;
                           NOR=Angir om posten er pen, om den venter p godkjenning, om den er fakturert for forskudd eller om den er frigitt til neste fase i behandlingen.];
                SourceExpr=Status;
                Visible=FALSE }

    { 1102601005;2;Field  ;
                ToolTipML=[ENU=Specifies a formula that calculates the payment due date, payment discount date, and payment discount amount on the purchase document.;
                           NOR=Angir en formel som beregner forfallsdatoen for betalingen, kontantrabattdatoen og kontantrabattbelpet, p kjpsdokumentet.];
                ApplicationArea=#Suite;
                SourceExpr="Payment Terms Code";
                Visible=FALSE }

    { 1102601007;2;Field  ;
                ToolTipML=[ENU=Specifies when the purchase invoice is due for payment.;
                           NOR=Specifies when the purchase invoice is due for payment.];
                ApplicationArea=#Suite;
                SourceExpr="Due Date";
                Visible=FALSE }

    { 1102601009;2;Field  ;
                ToolTipML=[ENU=Specifies the payment discount percent granted if payment is made on or before the date in the Pmt. Discount Date field.;
                           NOR=Angir kontantrabattprosenten som gis hvis betaling utfres innen datoen i feltet Kont.rabattdato.];
                SourceExpr="Payment Discount %";
                Visible=FALSE }

    { 1102601011;2;Field  ;
                ToolTipML=[ENU=Specifies how payment for the purchase document must be submitted.;
                           NOR=Angir hvordan betaling for kjpsdokumentet m sendes.];
                ApplicationArea=#Suite;
                SourceExpr="Payment Method Code";
                Visible=FALSE }

    { 1102601013;2;Field  ;
                ToolTipML=[ENU=Specifies the code that represents the shipment method for this purchase.;
                           NOR=Angir koden for leveringsmten som gjelder for kjpet.];
                SourceExpr="Shipment Method Code";
                Visible=FALSE }

    { 1102601027;2;Field  ;
                ToolTipML=[ENU=Specifies the date that you want the vendor to deliver to the ship-to address. The value in the field is used to calculate the latest date you can order the items to have them delivered on the requested receipt date. If you do not need delivery on a specific date, you can leave the field blank.;
                           NOR=Specifies the date that you want the vendor to deliver to the ship-to address. The value in the field is used to calculate the latest date you can order the items to have them delivered on the requested receipt date. If you do not need delivery on a specific date, you can leave the field blank.];
                ApplicationArea=#Suite;
                SourceExpr="Requested Receipt Date";
                Visible=FALSE }

    { 5   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the status of a job queue entry that handles the posting of purchase orders.;
                           NOR=Angir status for en jobbkpost som hndterer bokfring av bestillinger.];
                ApplicationArea=#Suite;
                SourceExpr="Job Queue Status";
                Visible=JobQueueActive }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1101103000;1;Part   ;
                Name=DocumentFileFactBox;
                PagePartID=Page53202;
                PartType=Page }

    { 14  ;1   ;Part      ;
                Name=IncomingDocAttachFactBox;
                ApplicationArea=#Suite;
                PagePartID=Page193;
                Visible=FALSE;
                PartType=Page;
                ShowFilter=No }

    { 1901138007;1;Part   ;
                ApplicationArea=#Suite;
                SubPageLink=No.=FIELD(Buy-from Vendor No.),
                            Date Filter=FIELD(Date Filter);
                PagePartID=Page9093;
                PartType=Page }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      ReportPrint@1102601001 : Codeunit 228;
      DocPrint@1102601000 : Codeunit 229;
      JobQueueActive@1003 : Boolean INDATASET;
      OpenApprovalEntriesExist@1002 : Boolean;
      CanCancelApprovalForRecord@1001 : Boolean;

    LOCAL PROCEDURE SetControlAppearance@5();
    VAR
      ApprovalsMgmt@1000 : Codeunit 1535;
    BEGIN
      OpenApprovalEntriesExist := ApprovalsMgmt.HasOpenApprovalEntries(RECORDID);

      CanCancelApprovalForRecord := ApprovalsMgmt.CanCancelApprovalForRecord(RECORDID);
    END;

    BEGIN
    END.
  }
}

OBJECT Page 53200 Document Module Setup
{
  OBJECT-PROPERTIES
  {
    Date=25.10.16;
    Time=15:26:09;
    Modified=Yes;
    Version List=DOC1.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Document Module Setup;
               NOR=Dokumentmodul oppsett];
    InsertAllowed=Yes;
    DeleteAllowed=No;
    SourceTable=Table53200;
    PageType=Card;
  }
  CONTROLS
  {
    { 1101103000;0;Container;
                ContainerType=ContentArea }

    { 1101103001;1;Group  ;
                Name=General;
                CaptionML=[ENU=General;
                           NOR=Generelt];
                GroupType=Group }

    { 1101103002;2;Field  ;
                SourceExpr="Filename No. Series" }

    { 1101103003;2;Field  ;
                SourceExpr="Storage Location";
                OnValidate=BEGIN
                             IF COPYSTR("Storage Location", STRLEN("Storage Location"), 1) <> '\' THEN
                             BEGIN
                               "Storage Location" += '\';
                             END;
                           END;
                            }

    { 1101103004;2;Field  ;
                SourceExpr="Storage Type" }

    { 1101103005;2;Field  ;
                SourceExpr="Add To Record Link" }

    { 1101103006;2;Field  ;
                SourceExpr="Use Attachment Table" }

    { 1101103007;2;Field  ;
                SourceExpr="Add To Interaction Log" }

    { 1101103008;2;Field  ;
                SourceExpr="Add Line To Support Task" }

    { 1101103009;2;Field  ;
                SourceExpr="Interaction Template Code" }

  }
  CODE
  {

    BEGIN
    {
      +---------------------------------------------+
      | SI-Data                                     |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 12.11.14 JAL Created the object
    }
    END.
  }
}

OBJECT Page 53201 Document Module Documents
{
  OBJECT-PROPERTIES
  {
    Date=28.09.16;
    Time=20:24:34;
    Modified=Yes;
    Version List=DOC1.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Document Module Documents;
               NOR=Dokumentmodul Dokumenter];
    InsertAllowed=No;
    SourceTable=Table53201;
    PageType=List;
    OnInit=VAR
             RecIdFilter@1101103000 : Text[250];
           BEGIN
           END;

    OnDeleteRecord=VAR
                     DocumentModuleFiles@1101103000 : Codeunit 53200;
                   BEGIN
                     IF GUIALLOWED AND  CONFIRM (TextDeleteFile, FALSE, FIELDCAPTION("Filename No."), "Filename No.") THEN
                     BEGIN
                       DocumentModuleFiles.DeleteDocument(ConstDiskFileName);
                     END;
                   END;

    ActionList=ACTIONS
    {
      { 1101103010;  ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1101103012;1 ;ActionGroup;
                      CaptionML=[ENU=Documents;
                                 NOR=Dokumenter];
                      Description=Documents;
                      Image=Setup }
      { 1101103011;2 ;Action    ;
                      Name=Import document;
                      CaptionML=[ENU=Import document;
                                 NOR=Importere dokument];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Add;
                      PromotedCategory=New;
                      OnAction=VAR
                                 DocumentModuleFiles@1101103000 : Codeunit 53200;
                               BEGIN
                                 DocumentModuleFiles.ImportDocument(RelatedRecRef);
                               END;
                                }
      { 1101103016;2 ;Action    ;
                      Name=Connect document;
                      CaptionML=[ENU=Connect document;
                                 NOR=Koble dokument];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Attach;
                      OnAction=VAR
                                 DocumentModuleFiles@1101103000 : Codeunit 53200;
                               BEGIN
                                 DocumentModuleFiles.ConnectDocument(RelatedRecRef);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1101103000;0;Container;
                ContainerType=ContentArea }

    { 1101103001;1;Group  ;
                Name=Group;
                GroupType=Repeater }

    { 1101103002;2;Field  ;
                SourceExpr=Description }

    { 1101103003;2;Field  ;
                AssistEdit=Yes;
                SourceExpr="Filename No.";
                Editable=False;
                OnAssistEdit=BEGIN
                               HYPERLINK(ConstDiskFileName);
                             END;
                              }

    { 1101103004;2;Field  ;
                SourceExpr=Date }

    { 1101103005;2;Field  ;
                SourceExpr=Time }

    { 1101103013;2;Field  ;
                Name=RecordID;
                SourceExpr=FORMAT(RecordID);
                Editable=False }

    { 1101103006;2;Field  ;
                SourceExpr=Size;
                Visible=False;
                Editable=False }

    { 1101103015;2;Field  ;
                SourceExpr="File Extension";
                Editable=False }

    { 1101103014;2;Field  ;
                SourceExpr="Storage Pointer";
                Editable=False }

    { 1101103007;0;Container;
                ContainerType=FactBoxArea }

    { 1101103008;1;Part   ;
                Visible=False;
                PartType=System;
                SystemPartID=Notes }

    { 1101103009;1;Part   ;
                Visible=False;
                PartType=System;
                SystemPartID=MyNotes }

  }
  CODE
  {
    VAR
      RelatedRecRef@1101103000 : RecordRef;
      TextDeleteFile@1101103001 : TextConst 'ENU=Do you want to delete the file?;NOR=Vil du ogs slette den underliggende filen?';

    PROCEDURE SetRecordRef@1101103000(RecRef@1101103000 : RecordRef);
    BEGIN
        RelatedRecRef.OPEN(RecRef.RECORDID.TABLENO);
        RelatedRecRef.GET(RecRef.RECORDID);
    END;

    BEGIN
    {
      +---------------------------------------------+
      | SI-Data                                     |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 12.11.14 JAL Created the object
    }
    END.
  }
}

OBJECT Page 53202 Document File FactBox
{
  OBJECT-PROPERTIES
  {
    Date=26.10.16;
    Time=09:03:20;
    Modified=Yes;
    Version List=DOC1.0;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Attached Files;
               NOR=Vedlagte filer];
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=No;
    LinksAllowed=No;
    SourceTable=Table53201;
    SourceTableView=SORTING(Table No.,RecordID,Line No.)
                    ORDER(Ascending);
    PageType=ListPart;
    OnInit=BEGIN
             IsFilterSetG := FALSE;
           END;

    OnFindRecord=BEGIN
                   IF IsFilterSetG THEN
                     EXIT(FIND(Which));
                   EXIT(FALSE);
                 END;

    ActionList=ACTIONS
    {
      { 1000000004;  ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000007;1 ;ActionGroup;
                      Name=Action;
                      CaptionML=[ENU=Actions;
                                 NOR=Handlinger];
                      Image=Action }
      { 1000000005;2 ;Action    ;
                      Name=Add Attached File;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Add;
                                 NOR=Legg til];
                      Image=Add;
                      OnAction=BEGIN
                                 DocumentModuleFilesG.ImportDocument(RecordRefG);
                               END;
                                }
      { 1000000006;2 ;Action    ;
                      Name=Save Attached File;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Save;
                                 NOR=Lagre];
                      Image=Save;
                      OnAction=VAR
                                 DocumentModuleDocumentsL@1000000000 : Record 53201;
                               BEGIN
                                 CurrPage.SETSELECTIONFILTER(DocumentModuleDocumentsL);
                                 IF DocumentModuleDocumentsL.FINDSET THEN
                                   REPEAT
                                     DocumentModuleFilesG.SaveFileToClient(DocumentModuleDocumentsL)
                                   UNTIL DocumentModuleDocumentsL.NEXT = 0;
                               END;
                                }
      { 1000000009;2 ;Separator  }
      { 1000000010;2 ;Action    ;
                      Name=Delete Attached File;
                      CaptionML=[ENU=Delete;
                                 NOR=Slett];
                      Image=Delete;
                      OnAction=VAR
                                 DocumentModuleDocumentsL@1000000000 : Record 53201;
                               BEGIN
                                 CurrPage.SETSELECTIONFILTER(DocumentModuleDocumentsL);
                                 IF DocumentModuleDocumentsL.FINDSET THEN
                                   REPEAT
                                     DocumentModuleDocumentsL.DELETE(TRUE);
                                   UNTIL DocumentModuleDocumentsL.NEXT = 0;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1000000000;;Container;
                ContainerType=ContentArea }

    { 1000000002;1;Group  ;
                GroupType=Repeater }

    { 1101103001;2;Field  ;
                SourceExpr=Description;
                OnAssistEdit=BEGIN
                               DocumentModuleFilesG.ShowDocument(Rec);
                               CurrPage.UPDATE(FALSE);
                             END;
                              }

    { 1101103002;2;Field  ;
                SourceExpr="File Extension" }

    { 1101103003;2;Field  ;
                SourceExpr=Date }

    { 1101103000;1;Field  ;
                Name=DragAndDrop;
                ControlAddIn=[Incadea.DropAreaControlAddIn;PublicKeyToken=c7fbc976bcfb9a00];
                ShowCaption=No }

  }
  CODE
  {
    VAR
      Text001@1000000002 : TextConst 'ENU=Drag and drop files or e-mails here!;NOR=Dra og slipp filer eller e-poster her!';
      DocumentModuleFilesG@1101103002 : Codeunit 53200;
      ControlAddInReadyG@1000000003 : Boolean;
      Text002@1000000004 : TextConst 'ENU=Refresh the page after the record is inserted.;NOR=Forny siden etter at posten er satt inn.';
      Text003@1000000005 : TextConst 'ENU=Then try again.;NOR=Deretter prv igjen.';
      Text004@1000000008 : TextConst 'ENU=Control add-in is missing.;NOR=Kontrolltillegg mangler.';
      Text005@1101103001 : TextConst 'ENU=Insert a line.;NOR=Sett inn en linje.';
      RecordIDG@1101103000 : RecordID;
      RecordRefG@1101103003 : RecordRef;
      IsFilterSetG@1101103004 : Boolean;

    PROCEDURE LoadDataFromRecord@1101103000(VariantP@1101103000 : Variant);
    BEGIN
      RecordRefG.GETTABLE(VariantP);
      IF NOT RecordRefG.GET(RecordRefG.RECORDID) THEN
        EXIT;
      RecordIDG := RecordRefG.RECORDID;
      Rec.SETCURRENTKEY("Table No.", RecordID, "Line No.");
      Rec.SETRANGE("Table No.", RecordIDG.TABLENO);
      Rec.SETRANGE(RecordID, RecordIDG);
      IsFilterSetG := TRUE;
      CurrPage.UPDATE(FALSE)
    END;

    EVENT DragAndDrop@-1101103000::ControlAddInReady@2();
    BEGIN
      ControlAddInReadyG := TRUE;
    END;

    EVENT DragAndDrop@-1101103000::FileDropBegin@3(filename@1101103000 : Text);
    BEGIN
    END;

    EVENT DragAndDrop@-1101103000::FileDrop@4(data@1101103000 : Text);
    BEGIN
    END;

    EVENT DragAndDrop@-1101103000::FileAdded@5(FilePathAndName@1101103000 : Text);
    BEGIN
      IF ControlAddInReadyG THEN BEGIN
        DocumentModuleFilesG.ImportDocumentFromFile(RecordRefG, FilePathAndName);
      END;
    END;

    EVENT DragAndDrop@-1101103000::FileDropEnd@6();
    BEGIN
    END;

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 20.09.16 JAL Document Module Factbox
    }
    END.
  }
}

