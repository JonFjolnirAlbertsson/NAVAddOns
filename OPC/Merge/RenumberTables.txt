OBJECT Table 83001 OPC Setup
{
  OBJECT-PROPERTIES
  {
    Date=20.04.17;
    Time=16:08:18;
    Modified=Yes;
    Version List=OPC1.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=OPC Setup;
               NOR=OPC Oppsett];
  }
  FIELDS
  {
    { 1   ;   ;Primary Key         ;Code10        ;CaptionML=[ENU=Primary Key;
                                                              NOR=Prim‘r n›kkel] }
    { 10  ;   ;Output Template Name Qty;Code10    ;TableRelation="Item Journal Template".Name;
                                                   CaptionML=[ENU=Output Template Name Qty;
                                                              NOR=Ferdigmeld.kladd mal - antall] }
    { 20  ;   ;Output Jrn Batch Name Qty;Code10   ;TableRelation="Item Journal Batch".Name WHERE (Journal Template Name=FIELD(Output Template Name Qty));
                                                   CaptionML=[ENU=Output Jrn Batch Name Qty;
                                                              NOR=Ferdigmeld.kladdnavn - antall] }
    { 30  ;   ;Output Batch Name Time;Code10      ;TableRelation="Item Journal Template".Name;
                                                   CaptionML=[ENU=Output Batch Name Time;
                                                              NOR=Ferdigmeld.kladd mal - tid] }
    { 40  ;   ;Output Jrn Name Time;Code10        ;TableRelation="Item Journal Batch".Name WHERE (Journal Template Name=FIELD(Output Batch Name Time));
                                                   CaptionML=[ENU=Output Jrn Name Time;
                                                              NOR=Ferdigmeld.kladdnavn - tid] }
    { 100 ;   ;Document No. Ind.Time;Code10       ;CaptionML=[ENU=Document No. Ind.Time;
                                                              NOR=Bilagsnr. Ind.Tid] }
    { 200 ;   ;Item Reclass. Journal (templ.);Code10;
                                                   TableRelation="Item Journal Template".Name;
                                                   CaptionML=[ENU=Item Reclass. Journal;
                                                              NOR=Vareoverf›ringskladd mal (flytting)] }
    { 201 ;   ;Item Reclass. Journal (Name);Code10;TableRelation="Item Journal Batch".Name WHERE (Journal Template Name=FIELD("Item Reclass. Journal (templ.)"));
                                                   CaptionML=NOR=Vareoverf›ringskladdnavn }
    { 202 ;   ;OPC-Move Location Code;Code10      ;TableRelation=Location.Code;
                                                   CaptionML=NOR=Lokasjonskode - OPC-flytt fra }
    { 300 ;   ;Warning Picture     ;BLOB          ;CaptionML=[ENU=Warning Picture;
                                                              NOR=Advarsler bilde];
                                                   SubType=Bitmap }
    { 400 ;   ;Item Journal Template Name;Code10  ;TableRelation="Item Journal Template";
                                                   CaptionML=[ENU=Item Journal Template Name;
                                                              NOR=Varekladdemalnavn] }
    { 410 ;   ;Item Journal Batch Name;Code10     ;TableRelation="Item Journal Batch".Name WHERE (Journal Template Name=FIELD(Item Journal Template Name));
                                                   CaptionML=[ENU=Item Journal Batch Name;
                                                              NOR=Varekladdenavn] }
    { 500 ;   ;Show Error Log Message;Boolean     ;CaptionML=[ENU=Show Error Log Message;
                                                              NOR=Vis feilmelding fra feillogg] }
  }
  KEYS
  {
    {    ;Primary Key                             ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    {
      ----------------------------------------------
      SI-DATA AS

      OPC
      ----------------------------------------------
      No  Date      ID      Description
      ----------------------------------------------
      001 06.12.05  ASL     Tabell oppgrader 4.0SP1
      002 29.03.06  ASL     Lagt til felt Document No. Ind.Time, brukes til tidsbokf›ring
                            uten tilknyttning til Prod.Ordre.
      003 17.08.10  HHE     Nytt felt:"Item Reclass. Journal (templ.)" (brukes i OPC - flytt komponent)
                            Nytt felt:"Item Reclass. Journal (Name)"   (brukes i OPC - flytt komponent)
      004 19.08.10  HHE     Nytt felt "OPC-Move Location Code". Brukes i OPC-flytt som "Fra lokasjon"
    }
    END.
  }
}

OBJECT Table 83002 OPC - Information Message
{
  OBJECT-PROPERTIES
  {
    Date=20.04.17;
    Time=16:08:18;
    Modified=Yes;
    Version List=OPC2.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=OPC - Information Message;
               NOR=OPC - Oppslagstavle];
  }
  FIELDS
  {
    { 1   ;   ;Entry No.           ;Integer       ;CaptionML=[ENU=Entry No.;
                                                              NOR=L›penr.] }
    { 10  ;   ;Description         ;Text250       ;Width=250;
                                                   CaptionML=[ENU=Description;
                                                              NOR=Beskrivelse] }
    { 20  ;   ;Last Modified       ;DateTime      ;CaptionML=[ENU=Last Modified;
                                                              NOR=Sist oppdatert] }
  }
  KEYS
  {
    {    ;Entry No.                               ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    PROCEDURE GetNextEntryNo@1101103001() : Integer;
    VAR
      OPCInformationMessageL@1101103000 : Record 83002;
    BEGIN
      IF OPCInformationMessageL.FINDLAST THEN BEGIN
        IF OPCInformationMessageL."Entry No." = 0 THEN
          EXIT(1);
        EXIT((OPCInformationMessageL."Entry No." + 1));
      END
      ELSE
        EXIT(1);
    END;

    BEGIN
    {
      +---------------------------------------+
      | SI-Data                               |
      +---------------------------------------+
      Nr. Dato     Id    Beskrivelse
      01. mar06    HHE   Opprettet tabell (tekstlinjer 1-10)
      02. 15.12.06 HHE   Opprettet Tekstlinje 11-15 (›nske fra Odd)
    }
    END.
  }
}

OBJECT Table 83003 Work Time
{
  OBJECT-PROPERTIES
  {
    Date=20.04.17;
    Time=16:08:18;
    Modified=Yes;
    Version List=OPC (RSI);
  }
  PROPERTIES
  {
    CaptionML=[ENU=Work Time;
               NOR=Arbeidstid];
    LookupPageID=Page71008;
    DrillDownPageID=Page71008;
  }
  FIELDS
  {
    { 1   ;   ;Code                ;Code10        ;CaptionML=NOR=Kode }
    { 2   ;   ;Day Type            ;Option        ;CaptionML=NOR=Dagtype;
                                                   OptionCaptionML=NOR=Normal dag,Helligdag,L›rdag;
                                                   OptionString=Normal Day,Holiday,Saturday }
    { 3   ;   ;Description         ;Text30        ;CaptionML=NOR=Beskrivelse }
    { 7   ;   ;Time Type           ;Option        ;CaptionML=NOR=Tidstype;
                                                   OptionCaptionML=NOR=Dagtid,Overtid 50%,Overtid 100%;
                                                   OptionString=Daytime,Overtime 50%,Overtime 100% }
    { 8   ;   ;From Time           ;Time          ;OnValidate=BEGIN
                                                                CalulateDuration;
                                                              END;

                                                   CaptionML=NOR=Fra klokken }
    { 9   ;   ;To Time             ;Time          ;OnValidate=BEGIN
                                                                CalulateDuration;
                                                              END;

                                                   CaptionML=NOR=Til klokken }
    { 10  ;   ;Duration            ;Decimal       ;CaptionML=NOR=Timer;
                                                   Editable=No }
  }
  KEYS
  {
    {    ;Code,Day Type                           ;Clustered=Yes }
    {    ;Time Type                                }
    {    ;From Time,To Time,Day Type,Time Type     }
    {    ;Day Type,Time Type                       }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    PROCEDURE CalulateDuration@1117700000();
    BEGIN
      IF (("From Time" <> 0T) AND ("To Time" <> 0T)) THEN
        Duration := (("To Time" - "From Time") / 3600000);
    END;

    BEGIN
    END.
  }
}

OBJECT Table 83004 Work Type Code
{
  OBJECT-PROPERTIES
  {
    Date=20.04.17;
    Time=16:08:18;
    Modified=Yes;
    Version List=OPC (RSI);
  }
  PROPERTIES
  {
    CaptionML=[ENU=Work Type Code;
               NOR=Arbeidstypekode];
    LookupPageID=Page83012;
    DrillDownPageID=Page83012;
  }
  FIELDS
  {
    { 1   ;   ;Code                ;Code10        ;CaptionML=[ENU=Code;
                                                              NOR=Kode] }
    { 2   ;   ;Description         ;Text30        ;CaptionML=[ENU=Description;
                                                              NOR=Beskrivelse] }
    { 6   ;   ;Payment Type        ;Code10        ;CaptionML=[ENU=Payment Type;
                                                              NOR=L›nnsart] }
    { 7   ;   ;Time Type           ;Option        ;CaptionML=NOR=Tidstype;
                                                   OptionCaptionML=NOR=Dagtid,Overtid 50%,Overtid 100%;
                                                   OptionString=Daytime,Overtime 50%,Overtime 100% }
    { 10  ;   ;Absence             ;Boolean       ;CaptionML=[ENU=Absence;
                                                              NOR=Frav‘r] }
    { 15  ;   ;Time Registered     ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Time Register".Quantity WHERE (Work Type Code=FIELD(Code),
                                                                                                   Machine Center=FIELD(Machine Center Filter),
                                                                                                   Start Date=FIELD(Date Filter)));
                                                   CaptionML=[ENU=Time Registered;
                                                              NOR=Tid registrert] }
    { 16  ;   ;Machine Center Filter;Code20       ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Machine Center Filter;
                                                              NOR=Produksjonsressursfilter] }
    { 17  ;   ;Date Filter         ;Date          ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Date Filter;
                                                              NOR=Datofilter] }
  }
  KEYS
  {
    {    ;Code                                    ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Table 83005 Holyday
{
  OBJECT-PROPERTIES
  {
    Date=20.04.17;
    Time=16:08:18;
    Modified=Yes;
    Version List=OPC (RSI);
  }
  PROPERTIES
  {
    CaptionML=[ENU=Holyday;
               NOR=Helligdag];
  }
  FIELDS
  {
    { 1   ;   ;Date                ;Date          ;CaptionML=[ENU=Date;
                                                              NOR=Dato] }
    { 2   ;   ;Description         ;Text30        ;CaptionML=[ENU=Description;
                                                              NOR=Beskrivelse] }
    { 3   ;   ;Type                ;Option        ;CaptionML=[ENU=Type;
                                                              NOR=Type];
                                                   OptionCaptionML=[ENU=Fixed,Floating;
                                                                    NOR=Fast,Flytende];
                                                   OptionString=Fixed,Floating }
  }
  KEYS
  {
    {    ;Date                                    ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Table 83006 Payment Temp. Register
{
  OBJECT-PROPERTIES
  {
    Date=20.04.17;
    Time=16:08:18;
    Modified=Yes;
    Version List=OPC (RSI);
  }
  PROPERTIES
  {
    CaptionML=[ENU=Payment Temp. Register;
               NOR=L›nns temp. register];
  }
  FIELDS
  {
    { 1   ;   ;Machine Center No.  ;Code20        ;CaptionML=[ENU=Machine Center No.;
                                                              NOR=Produksjonsressursnr.] }
    { 2   ;   ;Employee No.        ;Code20        ;CaptionML=[ENU=Employee No. (H&L);
                                                              NOR=Ansattnr. (H&L)] }
    { 3   ;   ;Employee Name       ;Text30        ;CaptionML=[ENU=Employee Name;
                                                              NOR=Ansattnavn] }
    { 5   ;   ;Work Type Code      ;Code10        ;TableRelation="Work Type Code";
                                                   CaptionML=[ENU=Work Type Code;
                                                              NOR=Arbeidstypekode] }
    { 7   ;   ;Payment Type        ;Code20        ;CaptionML=[ENU=Payment Type (H&L);
                                                              NOR=L›nnsart (H&L)] }
    { 9   ;   ;Quantity            ;Decimal       ;CaptionML=[ENU=Quantity;
                                                              NOR=Antall] }
  }
  KEYS
  {
    {    ;Machine Center No.,Work Type Code       ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Table 83007 Time Register
{
  OBJECT-PROPERTIES
  {
    Date=20.04.17;
    Time=16:08:18;
    Modified=Yes;
    Version List=OPC (RSI);
  }
  PROPERTIES
  {
    OnInsert=BEGIN
               IF "Work Type Code" = '' THEN BEGIN
                 WorkTypeCode.RESET;
                 WorkTypeCode.SETRANGE("Time Type", WorkTypeCode."Time Type"::Daytime);
                 IF WorkTypeCode.FIND('-') THEN
                    VALIDATE("Work Type Code", WorkTypeCode.Code);
               END;
             END;

    OnModify=BEGIN
               //02. ->
               IF "Date exported to Tempus" <> 0D THEN
                 ERROR('Denne posten er allerede eksportert til Tempus, og kan ikke lenger rettes her. Rett i Tempus');
               //02.<-
             END;

    OnDelete=BEGIN
               //02. ->
               IF "Date exported to Tempus" <> 0D THEN
                 ERROR('Denne posten er allerede eksportert til Tempus, og kan ikke lenger rettes her. Rett i Tempus');
               //02.<-
             END;

    OnRename=BEGIN
               //02. ->
               IF "Date exported to Tempus" <> 0D THEN
                 ERROR('Denne posten er allerede eksportert til Tempus, og kan ikke lenger rettes her. Rett i Tempus');
               //02.<-
             END;

    LookupPageID=Page83018;
    DrillDownPageID=Page83018;
  }
  FIELDS
  {
    { 1   ;   ;Machine Center      ;Code20        ;TableRelation="Machine Center";
                                                   CaptionML=[ENU=Machine Center;
                                                              NOR=Produksjonsressurs];
                                                   NotBlank=Yes }
    { 2   ;   ;Start Date          ;Date          ;OnValidate=BEGIN
                                                                CalcQty;
                                                              END;

                                                   CaptionML=[ENU=Start Date;
                                                              NOR=Startdato] }
    { 3   ;   ;Start Time          ;Time          ;OnValidate=BEGIN
                                                                CalcQty;
                                                              END;

                                                   CaptionML=[ENU=Start Time;
                                                              NOR=Starttid] }
    { 5   ;   ;End Date            ;Date          ;OnValidate=BEGIN
                                                                CalcQty;
                                                              END;

                                                   CaptionML=[ENU=End Date;
                                                              NOR=Sluttdato] }
    { 6   ;   ;End Time            ;Time          ;OnValidate=BEGIN
                                                                CalcQty;
                                                              END;

                                                   CaptionML=[ENU=End Time;
                                                              NOR=Sluttid] }
    { 7   ;   ;Quantity            ;Decimal       ;CaptionML=[ENU=Quantity;
                                                              NOR=Antall];
                                                   BlankZero=Yes;
                                                   Editable=No }
    { 9   ;   ;Work Type Code      ;Code10        ;TableRelation="Work Type Code";
                                                   OnValidate=BEGIN
                                                                WorkTypeCode.GET("Work Type Code");
                                                                "Time Type" := WorkTypeCode."Time Type";
                                                              END;

                                                   CaptionML=[ENU=Work Type Code;
                                                              NOR=Arbeidstypekode] }
    { 11  ;   ;Time Type           ;Option        ;CaptionML=NOR=Tidstype;
                                                   OptionCaptionML=NOR=Dagtid,Overtid 50%,Overtid 100%;
                                                   OptionString=Daytime,Overtime 50%,Overtime 100%;
                                                   Editable=No }
    { 12  ;   ;Machine Center Name ;Text30        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Machine Center".Name WHERE (No.=FIELD(Machine Center)));
                                                   CaptionML=[ENU=Machine Center Name;
                                                              NOR=Produksjonsressursnavn];
                                                   Editable=No }
    { 13  ;   ;Absence             ;Boolean       ;CaptionML=[ENU=Absence;
                                                              NOR=Frav‘r] }
    { 14  ;   ;Date exported to Tempus;Date        }
    { 15  ;   ;Actual Start Time   ;Time          ;CaptionML=NOR=Faktisk starttid }
    { 20  ;   ;Starting day        ;Text10        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Date."Period Name" WHERE (Period Type=CONST(Date),
                                                                                                Period Start=FIELD(Start Date)));
                                                   CaptionML=NOR=Ukedag (start);
                                                   Editable=No }
    { 30  ;   ;Description         ;Text50        ;CaptionML=NOR=Beskrivelse }
    { 31  ;   ;Deduction Type      ;Option        ;CaptionML=[ENU=Deduction Type;
                                                              NOR=Type fratrekk];
                                                   OptionCaptionML=[ENU=,Lunch,Dinner,Other;
                                                                    NOR=" ,Lunch,Middag,Annet"];
                                                   OptionString=[ ,Lunch,Dinner,Other];
                                                   Description=03. BVM }
  }
  KEYS
  {
    {    ;Machine Center,Start Date,Start Time    ;Clustered=Yes }
    {    ;Machine Center,Work Type Code,Start Date;SumIndexFields=Quantity }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      WorkTypeCode@1101104000 : Record 83004;

    PROCEDURE CalcQty@1101104000();
    BEGIN
      IF (("Start Date" <> 0D) AND ("Start Time" <> 0T)
        AND ("End Date" <> 0D) AND ("End Time" <> 0T)) THEN BEGIN

        Quantity := ( (("End Date" - "Start Date") * 24) +
          (("End Time" - "Start Time") / 3600000))
      END ELSE
        Quantity := 0;
    END;

    BEGIN
    {
      01. 15.06.06 HHE Lagt inn feltet "Date exported to Tempus"
      02. 15.06.06 HHE Kode som hindrer endring dersom "Date exported to Tempus" <> ''
    }
    END.
  }
}

OBJECT Table 83008 Change Status Comment Line
{
  OBJECT-PROPERTIES
  {
    Date=20.04.17;
    Time=16:08:18;
    Modified=Yes;
    Version List=OPC5.01;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Routing Comment Line;
               NOR=Rutemerknadslinje];
  }
  FIELDS
  {
    { 1   ;   ;Routing No.         ;Code20        ;TableRelation="Routing Header";
                                                   CaptionML=[ENU=Routing No.;
                                                              NOR=Rutenr.];
                                                   NotBlank=Yes }
    { 2   ;   ;Operation No.       ;Code10        ;CaptionML=[ENU=Operation No.;
                                                              NOR=Operasjonsnr.];
                                                   NotBlank=Yes }
    { 3   ;   ;Prod. Order No.     ;Code20        ;CaptionML=[ENU=Line No.;
                                                              NOR=Linjenr.] }
    { 4   ;   ;Routing reference No.;Integer      ;TableRelation="Routing Version"."Version Code" WHERE (Routing No.=FIELD(Routing No.));
                                                   CaptionML=[ENU=Version Code;
                                                              NOR=Versjonskode] }
    { 5   ;   ;Line No.            ;Integer        }
    { 10  ;   ;Date                ;Date          ;CaptionML=[ENU=Date;
                                                              NOR=Dato] }
    { 12  ;   ;Comment             ;Text80        ;CaptionML=[ENU=Comment;
                                                              NOR=Merknad] }
    { 13  ;   ;Entry No.           ;Integer       ;CaptionML=NOR=l›penummer }
  }
  KEYS
  {
    {    ;Routing No.,Routing reference No.,Operation No.,Prod. Order No.,Line No.;
                                                   Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    PROCEDURE SetUpNewLine@1();
    VAR
      RtngComment@1000 : Record 83008;
    BEGIN
      RtngComment.SETRANGE("Routing No.","Routing No.");
      RtngComment.SETRANGE("Routing reference No.","Routing reference No.");
      RtngComment.SETRANGE("Operation No.","Operation No.");
      RtngComment.SETRANGE(Date,WORKDATE);
      IF NOT RtngComment.FIND('-') THEN
        Date := WORKDATE;
    END;

    PROCEDURE Caption@2() : Text[100];
    VAR
      RtngHeader@1000 : Record 99000763;
    BEGIN
      IF GETFILTERS = '' THEN
        EXIT('');

      IF "Routing No." = '' THEN
        EXIT('');

      RtngHeader.GET("Routing No.");

      EXIT(
        STRSUBSTNO('%1 %2 %3',
          "Routing No.",RtngHeader.Description,"Operation No."));
    END;

    BEGIN
    END.
  }
}

OBJECT Table 83009 Time Registration
{
  OBJECT-PROPERTIES
  {
    Date=20.04.17;
    Time=16:08:18;
    Modified=Yes;
    Version List=OPC1.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Time Registration;
               NOR=M›nstringstider];
  }
  FIELDS
  {
    { 10  ;   ;Machine Center No.  ;Code20        ;TableRelation="Machine Center".No.;
                                                   CaptionML=[ENU=Machine Center No.;
                                                              NOR=Produksjonsressurs Nr.];
                                                   Description=hhe 24okt05: endret fra 10 }
    { 15  ;   ;Navn                ;Text30        ;TableRelation="Machine Center".Name;
                                                   CaptionML=[ENU=Name;
                                                              NOR=Navn] }
    { 20  ;   ;Starting Date       ;Date          ;OnValidate=BEGIN
                                                                BeregnTid();
                                                              END;

                                                   CaptionML=[ENU=Starting Date;
                                                              NOR=Startdato] }
    { 30  ;   ;Starting Time       ;Time          ;OnValidate=BEGIN
                                                                BeregnTid();
                                                              END;

                                                   CaptionML=[ENU=Starting Time;
                                                              NOR=Start tidspunkt] }
    { 40  ;   ;Ending Date         ;Date          ;OnValidate=BEGIN
                                                                BeregnTid();
                                                              END;

                                                   CaptionML=[ENU=Ending Date;
                                                              NOR=Sluttdato] }
    { 50  ;   ;Ending Time         ;Time          ;OnValidate=BEGIN
                                                                BeregnTid();
                                                              END;

                                                   CaptionML=[ENU=Ending Time;
                                                              NOR=Slutt tidspunkt] }
    { 55  ;   ;Total Time (Minutes);Integer       ;CaptionML=[ENU=Total Time (Minutes);
                                                              NOR=Totaltid (minutter)] }
    { 60  ;   ;Workstatus          ;Option        ;CaptionML=[ENU=Workstatus;
                                                              NOR=Arbeidsstatus];
                                                   OptionCaptionML=[ENU=Not Registrated,Registrated,Direct Production,Indirect Time,Completed;
                                                                    NOR=Ikke fremm›t,Tilstede,Direkte Produksjon,Indirekte produksjon,Avsluttet];
                                                   OptionString=Not Registrated,Registrated,Direct Production,Indirect Time,Completed }
    { 70  ;   ;Machine Center Filter;Code20       ;FieldClass=FlowFilter;
                                                   TableRelation="Machine Center".No.;
                                                   CaptionML=[ENU=Machine Center Filter;
                                                              NOR=Produksjonsressurs filter];
                                                   Description=hhe 24okt05: endret fra 10 }
    { 80  ;   ;Exported to File    ;Boolean       ;CaptionML=[ENU=Exported to File;
                                                              NOR=Eksportert til fil] }
  }
  KEYS
  {
    {    ;Machine Center No.,Starting Date,Starting Time;
                                                   Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    PROCEDURE BeregnTid@1();
    VAR
      AntallDager@1000000000 : Integer;
      AntallTimer@1000000001 : Integer;
    BEGIN
      IF ("Ending Time" <> 0T) AND ("Starting Time" <> 0T)
        AND ("Ending Date" <> 0D) AND ("Starting Date" <> 0D) THEN BEGIN
          AntallTimer := "Ending Time" - "Starting Time";
          AntallDager := "Ending Date" - "Starting Date";
          "Total Time (Minutes)" := (AntallDager*1440) + (AntallTimer/60000);
          MODIFY;
      END;
    END;

    BEGIN
    {
      ----------------------------------------------
      SI-DATA AS

      OPC
      ----------------------------------------------
      No  Date      ID      Description
      ----------------------------------------------
      001 06.12.05  ASL     Tabell oppgrader 4.0SP1
    }
    END.
  }
}

OBJECT Table 83010 Run Times
{
  OBJECT-PROPERTIES
  {
    Date=20.04.17;
    Time=16:08:18;
    Modified=Yes;
    Version List=OPC1.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Run Times;
               NOR=Operasjonstider];
  }
  FIELDS
  {
    { 1   ;   ;Entry No.           ;Integer       ;CaptionML=[ENU=Entry No.;
                                                              NOR=L›penummer] }
    { 10  ;   ;Prod. Order No.     ;Code20        ;TableRelation="Production Order".No.;
                                                   CaptionML=[ENU=Prod. Order No.;
                                                              NOR=Prod.ordrenr.];
                                                   NotBlank=No;
                                                   Editable=No }
    { 20  ;   ;Routing No.         ;Code20        ;CaptionML=[ENU=Routing No.;
                                                              NOR=Rute nr.] }
    { 30  ;   ;Operation No.       ;Code10        ;CaptionML=[ENU=Operation No.;
                                                              NOR=Operasjonsnr.];
                                                   NotBlank=No }
    { 40  ;   ;Machine Center      ;Code20        ;TableRelation="Machine Center";
                                                   OnValidate=VAR
                                                                ProdRessurs@1000000000 : Record 99000758;
                                                              BEGIN
                                                                IF ProdRessurs.GET("Machine Center") THEN
                                                                  Description := ProdRessurs.Name;
                                                              END;

                                                   CaptionML=[ENU=Machine Center;
                                                              NOR=Produksjonsressurs] }
    { 45  ;   ;Description         ;Text30        ;CaptionML=[ENU=Description;
                                                              NOR=Beskrivelse] }
    { 50  ;   ;Starting Date       ;Date          ;CaptionML=[ENU=Starting Date;
                                                              NOR=Start dato] }
    { 60  ;   ;Starting Time       ;Time          ;CaptionML=[ENU=Starting Time;
                                                              NOR=Start tidspunkt] }
    { 70  ;   ;Ending Date         ;Date          ;CaptionML=[ENU=Ending Date;
                                                              NOR=Slutt dato] }
    { 80  ;   ;Ending Time         ;Time          ;CaptionML=[ENU=Ending Time;
                                                              NOR=Slutt tidspunkt] }
    { 100 ;   ;Finish Now          ;Boolean       ;OnValidate=BEGIN
                                                                TESTFIELD("Machine Center");
                                                                TESTFIELD("Starting Date");
                                                                TESTFIELD("Starting Time");
                                                              END;

                                                   CaptionML=[ENU=Finish Now;
                                                              NOR=Avslutt n†] }
    { 110 ;   ;Post                ;Boolean       ;CaptionML=[ENU=Post;
                                                              NOR=Bokf›r] }
    { 200 ;   ;Work done at M.C.   ;Code10        ;TableRelation="Machine Center".No. }
    { 300 ;   ;Stop Code           ;Code20        ;TableRelation=Stop.Code;
                                                   CaptionML=NOR=Indirekte tid (kode);
                                                   Description=//OPC - ny 22.jan10 }
  }
  KEYS
  {
    {    ;Entry No.,Prod. Order No.,Routing No.,Operation No.,Machine Center;
                                                   Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    {
      ----------------------------------------------
      SI-DATA AS

      OPC
      ----------------------------------------------
      No  Date      ID      Description
      ----------------------------------------------
      001 06.12.05  ASL     Tabell oppgrader 4.0SP1
      002 14.12.05  HHE     Legger inn "Work done at"
      003 29.03.06  ASL     Endret slik at det tillates blanke verdier for "Prod. Order No.",
                            "Routing No.","Operation No.", for bokf›ring av ikke produktiv tid
      005 22.01.10  HHE     Nytt felt = "Stop Code" (viser hvilken ind.tid.kode man er innstemplet p†)
    }
    END.
  }
}

OBJECT Table 83011 Non producing time
{
  OBJECT-PROPERTIES
  {
    Date=20.04.17;
    Time=16:08:18;
    Modified=Yes;
    Version List=indir.tid OPC;
  }
  PROPERTIES
  {
    OnInsert=VAR
               Stop@1000000000 : Record 99000761;
             BEGIN
               CLEAR(Stop);
               IF NOT Stop.GET(Kode) THEN BEGIN
                 Stop.INIT;
                 Stop.Code := Kode;
                 Stop."OPC-Non producing time" := TRUE;
                 Stop.INSERT;
               END;
             END;

    CaptionML=[ENU=Non producing time;
               NOR=Ikke produktiv tid];
    LookupPageID=Page83027;
  }
  FIELDS
  {
    { 1   ;   ;Kode                ;Code15         }
    { 2   ;   ;Beskrivelse         ;Text30         }
  }
  KEYS
  {
    {    ;Kode                                    ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    {
      ----------------------------------------------
      SI-DATA AS

      OPC
      ----------------------------------------------
      No  Date      ID      Description
      ----------------------------------------------
      001 29.03.06  ASL     Oppretter ogs† kodene som stopp†rsaker for †
                            bruke standard stokkkoder i tidsbokf›ring
    }
    END.
  }
}

OBJECT Table 83012 Run Times Deduction
{
  OBJECT-PROPERTIES
  {
    Date=20.04.17;
    Time=16:08:18;
    Modified=Yes;
    Version List=OPC1.0;
  }
  PROPERTIES
  {
    LookupPageID=Page83022;
  }
  FIELDS
  {
    { 1   ;   ;Code                ;Code10        ;CaptionML=[ENU=Code;
                                                              NOR=Kode] }
    { 2   ;   ;Description         ;Text30        ;CaptionML=[ENU=Description;
                                                              NOR=Beskrivelse] }
    { 3   ;   ;From Time           ;Time          ;CaptionML=[ENU=From Time;
                                                              NOR=Fra klokken] }
    { 4   ;   ;To Time             ;Time          ;CaptionML=[ENU=To Time;
                                                              NOR=Til klokken] }
    { 9   ;   ;Deduct Prod.Order   ;Boolean       ;CaptionML=[ENU=Deduct Prod.Order;
                                                              NOR=Trekkfra p† prod.ordre] }
  }
  KEYS
  {
    {    ;Code                                    ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Table 83013 OPC Cue
{
  OBJECT-PROPERTIES
  {
    Date=20.04.17;
    Time=16:08:18;
    Modified=Yes;
    Version List=OPC;
  }
  PROPERTIES
  {
    CaptionML=[ENU=OPC Cue;
               NOR=OPC bunke-ikon];
  }
  FIELDS
  {
    { 1   ;   ;Primary Key         ;Code10        ;CaptionML=[ENU=Primary Key;
                                                              NOR=Prim‘rn›kkel] }
    { 10  ;   ;Production Order- Released;Integer ;FieldClass=FlowField;
                                                   CalcFormula=Count("Production Order" WHERE (Status=CONST(Released)));
                                                   CaptionML=[ENU=Production Order - Released;
                                                              NOR=Produksjonordre - Frigitt];
                                                   Editable=No }
    { 20  ;   ;Resource Status     ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Run Times" WHERE (Ending Date=FILTER(''),
                                                                                        Starting Date=FILTER(>01.01.00),
                                                                                        Machine Center=FILTER(<>'')));
                                                   CaptionML=[ENU=Resource Status;
                                                              NOR=Ressursstatus];
                                                   Editable=No }
    { 30  ;   ;Firm planned tasks  ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Prod. Order Routing Line" WHERE (Type=CONST(Machine Center),
                                                                                                       Routing Status=FILTER(<>Finished),
                                                                                                       Status=CONST(Firm Planned)));
                                                   CaptionML=[ENU=Firm planned tasks;
                                                              NOR=Fast planlagte oppgaver];
                                                   Editable=No }
    { 220 ;   ;Date Filter         ;Date          ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Date Filter;
                                                              NOR=Datofilter];
                                                   Editable=No }
    { 240 ;   ;Responsibility Center Filter;Code10;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Responsibility Center Filter;
                                                              NOR=Filter for ansvarssenter];
                                                   Editable=No }
  }
  KEYS
  {
    {    ;Primary Key                             ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Table 99000758 Machine Center
{
  OBJECT-PROPERTIES
  {
    Date=20.04.17;
    Time=16:08:18;
    Modified=Yes;
    Version List=NAVW110.00,OPC1.0;
  }
  PROPERTIES
  {
    DataCaptionFields=No.,Name;
    OnInsert=BEGIN
               MfgSetup.GET;
               IF "No." = '' THEN BEGIN
                 MfgSetup.TESTFIELD("Machine Center Nos.");
                 NoSeriesMgt.InitSeries(MfgSetup."Machine Center Nos.",xRec."No. Series",0D,"No.","No. Series");
               END;
             END;

    OnModify=BEGIN
               "Last Date Modified" := TODAY;
             END;

    OnDelete=VAR
               ProdOrderRtngLine@1000 : Record 5409;
               StdCostWksh@1001 : Record 5841;
               CapLedgEntry@1002 : Record 5832;
             BEGIN
               CapLedgEntry.SETRANGE(Type,CapLedgEntry.Type::"Machine Center");
               CapLedgEntry.SETRANGE("No.","No.");
               IF NOT CapLedgEntry.ISEMPTY THEN
                 ERROR(Text007,TABLECAPTION,"No.",CapLedgEntry.TABLECAPTION);

               StdCostWksh.RESET;
               StdCostWksh.SETRANGE(Type,StdCostWksh.Type::"Machine Center");
               StdCostWksh.SETRANGE("No.","No.");
               IF NOT StdCostWksh.ISEMPTY THEN
                 ERROR(Text007,TABLECAPTION,"No.",StdCostWksh.TABLECAPTION);

               CalendarEntry.SETRANGE("Capacity Type",CalendarEntry."Capacity Type"::"Machine Center");
               CalendarEntry.SETRANGE("No.","No.");
               CalendarEntry.DELETEALL;

               CalAbsentEntry.SETRANGE("Capacity Type",CalendarEntry."Capacity Type"::"Machine Center");
               CalAbsentEntry.SETRANGE("No.","No.");
               CalAbsentEntry.DELETEALL;

               MfgCommentLine.SETRANGE("Table Name",MfgCommentLine."Table Name"::"Machine Center");
               MfgCommentLine.SETRANGE("No.","No.");
               MfgCommentLine.DELETEALL;

               ProdOrderRtngLine.SETRANGE(Type,ProdOrderRtngLine.Type::"Machine Center");
               ProdOrderRtngLine.SETRANGE("No.","No.");
               IF NOT ProdOrderRtngLine.ISEMPTY THEN
                 ERROR(Text000);
             END;

    OnRename=BEGIN
               "Last Date Modified" := TODAY;
             END;

    CaptionML=[ENU=Machine Center;
               NOR=Maskinsenter];
    LookupPageID=Page99000761;
    DrillDownPageID=Page99000761;
  }
  FIELDS
  {
    { 1   ;   ;No.                 ;Code20        ;AltSearchField=Search Name;
                                                   CaptionML=[ENU=No.;
                                                              NOR=Nr.] }
    { 3   ;   ;Name                ;Text50        ;OnValidate=BEGIN
                                                                "Search Name" := Name;
                                                              END;

                                                   CaptionML=[ENU=Name;
                                                              NOR=Navn] }
    { 4   ;   ;Search Name         ;Code50        ;CaptionML=[ENU=Search Name;
                                                              NOR=S›kenavn] }
    { 5   ;   ;Name 2              ;Text50        ;CaptionML=[ENU=Name 2;
                                                              NOR=Navn 2] }
    { 6   ;   ;Address             ;Text50        ;CaptionML=[ENU=Address;
                                                              NOR=Adresse] }
    { 7   ;   ;Address 2           ;Text50        ;CaptionML=[ENU=Address 2;
                                                              NOR=Adresse 2] }
    { 8   ;   ;City                ;Text30        ;TableRelation=IF (Country/Region Code=CONST()) "Post Code".City
                                                                 ELSE IF (Country/Region Code=FILTER(<>'')) "Post Code".City WHERE (Country/Region Code=FIELD(Country/Region Code));
                                                   OnValidate=BEGIN
                                                                PostCode.ValidateCity(City,"Post Code",County,"Country/Region Code",(CurrFieldNo <> 0) AND GUIALLOWED);
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=City;
                                                              NOR=Sted] }
    { 9   ;   ;Post Code           ;Code20        ;TableRelation=IF (Country/Region Code=CONST()) "Post Code"
                                                                 ELSE IF (Country/Region Code=FILTER(<>'')) "Post Code" WHERE (Country/Region Code=FIELD(Country/Region Code));
                                                   OnValidate=BEGIN
                                                                PostCode.ValidatePostCode(City,"Post Code",County,"Country/Region Code",(CurrFieldNo <> 0) AND GUIALLOWED);
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Post Code;
                                                              NOR=Postnr.] }
    { 14  ;   ;Work Center No.     ;Code20        ;TableRelation="Work Center";
                                                   OnValidate=VAR
                                                                WorkCenter@1000 : Record 99000754;
                                                                ProdOrderRtngLine@1001 : Record 5409;
                                                                ProdOrderCapNeed@1002 : Record 5410;
                                                                PlanningRtngLine@1003 : Record 99000830;
                                                              BEGIN
                                                                IF "Work Center No." = xRec."Work Center No." THEN
                                                                  EXIT;

                                                                IF "Work Center No." <> '' THEN BEGIN
                                                                  WorkCenter.GET("Work Center No.");
                                                                  WorkCenter.TESTFIELD("Unit of Measure Code");
                                                                  "Queue Time Unit of Meas. Code" := WorkCenter."Queue Time Unit of Meas. Code";
                                                                  "Setup Time Unit of Meas. Code" := WorkCenter."Unit of Measure Code";
                                                                  "Wait Time Unit of Meas. Code" := WorkCenter."Unit of Measure Code";
                                                                  "Move Time Unit of Meas. Code" := WorkCenter."Unit of Measure Code";
                                                                END;
                                                                VALIDATE("Location Code",WorkCenter."Location Code");

                                                                CalendarEntry.SETCURRENTKEY("Capacity Type","No.");
                                                                CalendarEntry.SETRANGE("Capacity Type",CalendarEntry."Capacity Type"::"Machine Center");
                                                                CalendarEntry.SETRANGE("No.","No.");
                                                                IF NOT CalendarEntry.FIND('-') THEN
                                                                  EXIT;

                                                                IF CurrFieldNo <> 0 THEN
                                                                  IF NOT CONFIRM(Text001,FALSE,FIELDCAPTION("Work Center No."))
                                                                  THEN BEGIN
                                                                    "Work Center No." := xRec."Work Center No.";
                                                                    EXIT;
                                                                  END;

                                                                Window.OPEN(
                                                                  Text002 +
                                                                  Text003 +
                                                                  Text004 +
                                                                  Text006);

                                                                i := 0;
                                                                NoOfRecords := CalendarEntry.COUNT;
                                                                IF CalendarEntry.FIND('-') THEN
                                                                  REPEAT
                                                                    i := i + 1;
                                                                    Window.UPDATE(1,i);
                                                                    Window.UPDATE(2,ROUND(i / NoOfRecords * 10000,1));
                                                                    CalendarEntry.VALIDATE("Work Center No.","Work Center No.");
                                                                    CalendarEntry.MODIFY;
                                                                  UNTIL CalendarEntry.NEXT = 0;

                                                                i := 0;
                                                                CalAbsentEntry.SETCURRENTKEY("Capacity Type","No.");
                                                                CalAbsentEntry.SETRANGE("Capacity Type",CalendarEntry."Capacity Type"::"Machine Center");
                                                                CalAbsentEntry.SETRANGE("No.","No.");
                                                                NoOfRecords := CalAbsentEntry.COUNT;
                                                                IF CalAbsentEntry.FIND('-') THEN
                                                                  REPEAT
                                                                    i := i + 1;
                                                                    Window.UPDATE(3,i);
                                                                    Window.UPDATE(4,ROUND(i / NoOfRecords * 10000,1));
                                                                    CalAbsentEntry.VALIDATE("Work Center No.","Work Center No.");
                                                                    CalAbsentEntry.MODIFY;
                                                                  UNTIL CalAbsentEntry.NEXT = 0;

                                                                i := 0;
                                                                ProdOrderCapNeed.SETCURRENTKEY(Type,"No.");
                                                                ProdOrderCapNeed.SETRANGE(Type,ProdOrderCapNeed.Type::"Machine Center");
                                                                ProdOrderCapNeed.SETRANGE("No.","No.");
                                                                NoOfRecords := ProdOrderCapNeed.COUNT;
                                                                IF ProdOrderCapNeed.FIND('-') THEN
                                                                  REPEAT
                                                                    i := i + 1;
                                                                    Window.UPDATE(7,i);
                                                                    Window.UPDATE(8,ROUND(i / NoOfRecords * 10000,1));
                                                                    ProdOrderCapNeed.VALIDATE("Work Center No.","Work Center No.");
                                                                    ProdOrderCapNeed.MODIFY;
                                                                  UNTIL ProdOrderCapNeed.NEXT = 0;

                                                                MODIFY;

                                                                RtngLine.SETCURRENTKEY(Type,"No.");
                                                                RtngLine.SETRANGE(Type,RtngLine.Type::"Machine Center");
                                                                RtngLine.SETRANGE("No.","No.");
                                                                IF RtngLine.FIND('-') THEN
                                                                  REPEAT
                                                                    RtngLine.VALIDATE("Work Center No.","Work Center No.");
                                                                    RtngLine.MODIFY;
                                                                  UNTIL RtngLine.NEXT = 0;

                                                                PlanningRtngLine.SETCURRENTKEY(Type,"No.");
                                                                PlanningRtngLine.SETRANGE(Type,PlanningRtngLine.Type::"Machine Center");
                                                                PlanningRtngLine.SETRANGE("No.","No.");
                                                                IF PlanningRtngLine.FIND('-') THEN
                                                                  REPEAT
                                                                    PlanningRtngLine.VALIDATE("Work Center No.","Work Center No.");
                                                                    PlanningRtngLine.MODIFY;
                                                                  UNTIL PlanningRtngLine.NEXT = 0;

                                                                ProdOrderRtngLine.SETCURRENTKEY(Type,"No.");
                                                                ProdOrderRtngLine.SETRANGE(Type,PlanningRtngLine.Type::"Machine Center");
                                                                ProdOrderRtngLine.SETRANGE("No.","No.");
                                                                IF ProdOrderRtngLine.FIND('-') THEN
                                                                  REPEAT
                                                                    ProdOrderRtngLine.VALIDATE("Work Center No.","Work Center No.");
                                                                    ProdOrderRtngLine.MODIFY;
                                                                  UNTIL ProdOrderRtngLine.NEXT = 0;

                                                                Window.CLOSE;
                                                              END;

                                                   CaptionML=[ENU=Work Center No.;
                                                              NOR=Arbeidssenternr.] }
    { 19  ;   ;Direct Unit Cost    ;Decimal       ;OnValidate=BEGIN
                                                                VALIDATE("Indirect Cost %");
                                                              END;

                                                   CaptionML=[ENU=Direct Unit Cost;
                                                              NOR=Direkte enhetskost];
                                                   MinValue=0;
                                                   AutoFormatType=2 }
    { 20  ;   ;Indirect Cost %     ;Decimal       ;OnValidate=BEGIN
                                                                GetGLSetup;
                                                                "Unit Cost" :=
                                                                  ROUND(
                                                                    "Direct Unit Cost" * (1 + "Indirect Cost %" / 100) + "Overhead Rate",
                                                                    GLSetup."Unit-Amount Rounding Precision");
                                                              END;

                                                   CaptionML=[ENU=Indirect Cost %;
                                                              NOR=Indirekte kost-%];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
    { 21  ;   ;Unit Cost           ;Decimal       ;OnValidate=BEGIN
                                                                GetGLSetup;
                                                                "Direct Unit Cost" :=
                                                                  ROUND(("Unit Cost" - "Overhead Rate") / (1 + "Indirect Cost %" / 100),
                                                                    GLSetup."Unit-Amount Rounding Precision");
                                                              END;

                                                   CaptionML=[ENU=Unit Cost;
                                                              NOR=Enhetskost];
                                                   DecimalPlaces=2:5;
                                                   MinValue=0;
                                                   AutoFormatType=2 }
    { 22  ;   ;Queue Time          ;Decimal       ;CaptionML=[ENU=Queue Time;
                                                              NOR=K›tid];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
    { 23  ;   ;Queue Time Unit of Meas. Code;Code10;
                                                   TableRelation="Capacity Unit of Measure";
                                                   CaptionML=[ENU=Queue Time Unit of Meas. Code;
                                                              NOR=K›tidsenhetskode] }
    { 26  ;   ;Last Date Modified  ;Date          ;CaptionML=[ENU=Last Date Modified;
                                                              NOR=Endret den];
                                                   Editable=No }
    { 27  ;   ;Comment             ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Manufacturing Comment Line" WHERE (Table Name=CONST(Machine Center),
                                                                                                         No.=FIELD(No.)));
                                                   CaptionML=[ENU=Comment;
                                                              NOR=Merknad];
                                                   Editable=No }
    { 31  ;   ;Capacity            ;Decimal       ;CaptionML=[ENU=Capacity;
                                                              NOR=Kapasitet];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
    { 32  ;   ;Efficiency          ;Decimal       ;InitValue=100;
                                                   CaptionML=[ENU=Efficiency;
                                                              NOR=Effektivitet];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
    { 33  ;   ;Maximum Efficiency  ;Decimal       ;CaptionML=[ENU=Maximum Efficiency;
                                                              NOR=Maks. effektivitet];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
    { 34  ;   ;Minimum Efficiency  ;Decimal       ;CaptionML=[ENU=Minimum Efficiency;
                                                              NOR=Min. effektivitet];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
    { 38  ;   ;Blocked             ;Boolean       ;CaptionML=[ENU=Blocked;
                                                              NOR=Sperret] }
    { 39  ;   ;Date Filter         ;Date          ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Date Filter;
                                                              NOR=Datofilter] }
    { 40  ;   ;Work Shift Filter   ;Code10        ;FieldClass=FlowFilter;
                                                   TableRelation="Work Shift";
                                                   CaptionML=[ENU=Work Shift Filter;
                                                              NOR=Arbeidsskiftfilter] }
    { 41  ;   ;Capacity (Total)    ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Calendar Entry"."Capacity (Total)" WHERE (Capacity Type=CONST(Machine Center),
                                                                                                              No.=FIELD(No.),
                                                                                                              Work Shift Code=FIELD(Work Shift Filter),
                                                                                                              Date=FIELD(Date Filter)));
                                                   CaptionML=[ENU=Capacity (Total);
                                                              NOR=Kapasitet (total)];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 42  ;   ;Capacity (Effective);Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Calendar Entry"."Capacity (Effective)" WHERE (Capacity Type=CONST(Machine Center),
                                                                                                                  No.=FIELD(No.),
                                                                                                                  Work Shift Code=FIELD(Work Shift Filter),
                                                                                                                  Date=FIELD(Date Filter)));
                                                   CaptionML=[ENU=Capacity (Effective);
                                                              NOR=Kapasitet (effektiv)];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 44  ;   ;Prod. Order Need (Qty.);Decimal    ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Prod. Order Capacity Need"."Allocated Time" WHERE (Type=CONST(Machine Center),
                                                                                                                       No.=FIELD(No.),
                                                                                                                       Status=FIELD(Prod. Order Status Filter),
                                                                                                                       Date=FIELD(Date Filter),
                                                                                                                       Requested Only=CONST(No)));
                                                   CaptionML=[ENU=Prod. Order Need (Qty.);
                                                              NOR=Prod.ordrebehov (ant.)];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 45  ;   ;Prod. Order Need Amount;Decimal    ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Prod. Order Routing Line"."Expected Operation Cost Amt." WHERE (Type=CONST(Machine Center),
                                                                                                                                    No.=FIELD(No.),
                                                                                                                                    Status=FIELD(Prod. Order Status Filter)));
                                                   CaptionML=[ENU=Prod. Order Need Amount;
                                                              NOR=Prod.ordrebehov - bel›p];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 47  ;   ;Prod. Order Status Filter;Option   ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Prod. Order Status Filter;
                                                              NOR=Prod.ordrestatusfilter];
                                                   OptionCaptionML=[ENU=Simulated,Planned,Firm Planned,Released,Finished;
                                                                    NOR=Simulert,Planlagt,Fast planlagt,Frigitt,Ferdig];
                                                   OptionString=Simulated,Planned,Firm Planned,Released,Finished }
    { 50  ;   ;Setup Time          ;Decimal       ;CaptionML=[ENU=Setup Time;
                                                              NOR=Oppstillingstid];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
    { 52  ;   ;Wait Time           ;Decimal       ;CaptionML=[ENU=Wait Time;
                                                              NOR=Ventetid];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
    { 53  ;   ;Move Time           ;Decimal       ;CaptionML=[ENU=Move Time;
                                                              NOR=Transporttid];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
    { 54  ;   ;Fixed Scrap Quantity;Decimal       ;CaptionML=[ENU=Fixed Scrap Quantity;
                                                              NOR=Fast vrakantall];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
    { 55  ;   ;Scrap %             ;Decimal       ;CaptionML=[ENU=Scrap %;
                                                              NOR=Vrak-%];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
    { 56  ;   ;Setup Time Unit of Meas. Code;Code10;
                                                   TableRelation="Capacity Unit of Measure";
                                                   CaptionML=[ENU=Setup Time Unit of Meas. Code;
                                                              NOR=Oppstillingstid - enhetskode] }
    { 57  ;   ;Wait Time Unit of Meas. Code;Code10;TableRelation="Capacity Unit of Measure";
                                                   CaptionML=[ENU=Wait Time Unit of Meas. Code;
                                                              NOR=Ventetid - enhetskode] }
    { 58  ;   ;Send-Ahead Quantity ;Decimal       ;CaptionML=[ENU=Send-Ahead Quantity;
                                                              NOR=Overlappantall];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
    { 59  ;   ;Move Time Unit of Meas. Code;Code10;TableRelation="Capacity Unit of Measure";
                                                   CaptionML=[ENU=Move Time Unit of Meas. Code;
                                                              NOR=Transporttid - enhetskode] }
    { 60  ;   ;Flushing Method     ;Option        ;InitValue=Manual;
                                                   CaptionML=[ENU=Flushing Method;
                                                              NOR=Trekkmetode];
                                                   OptionCaptionML=[ENU=Manual,Forward,Backward;
                                                                    NOR=Manuell,Forlengs,Baklengs];
                                                   OptionString=Manual,Forward,Backward }
    { 62  ;   ;Minimum Process Time;Decimal       ;CaptionML=[ENU=Minimum Process Time;
                                                              NOR=Minimum behandlingstid];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
    { 63  ;   ;Maximum Process Time;Decimal       ;CaptionML=[ENU=Maximum Process Time;
                                                              NOR=Maksimal behandlingstid];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
    { 64  ;   ;Concurrent Capacities;Decimal      ;CaptionML=[ENU=Concurrent Capacities;
                                                              NOR=Samtidige kapasiteter];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
    { 65  ;   ;Item Filter         ;Code20        ;FieldClass=FlowFilter;
                                                   TableRelation=Item;
                                                   CaptionML=[ENU=Item Filter;
                                                              NOR=Varefilter] }
    { 66  ;   ;Stop Code Filter    ;Code10        ;FieldClass=FlowFilter;
                                                   TableRelation=Stop;
                                                   CaptionML=[ENU=Stop Code Filter;
                                                              NOR=Stoppkodefilter] }
    { 67  ;   ;Scrap Code Filter   ;Code10        ;FieldClass=FlowFilter;
                                                   TableRelation=Scrap;
                                                   CaptionML=[ENU=Scrap Code Filter;
                                                              NOR=Vrakkodefilter] }
    { 80  ;   ;No. Series          ;Code10        ;TableRelation="No. Series";
                                                   CaptionML=[ENU=No. Series;
                                                              NOR=Nr.serie];
                                                   Editable=No }
    { 81  ;   ;Overhead Rate       ;Decimal       ;OnValidate=BEGIN
                                                                VALIDATE("Indirect Cost %");
                                                              END;

                                                   CaptionML=[ENU=Overhead Rate;
                                                              NOR=Sats for indirekte kostnader];
                                                   AutoFormatType=2 }
    { 82  ;   ;Gen. Prod. Posting Group;Code10    ;TableRelation="Gen. Product Posting Group";
                                                   CaptionML=[ENU=Gen. Prod. Posting Group;
                                                              NOR=Bokf›ringsgruppe - vare] }
    { 83  ;   ;County              ;Text30        ;CaptionML=[ENU=County;
                                                              NOR=Fylke/delstat] }
    { 84  ;   ;Country/Region Code ;Code10        ;TableRelation=Country/Region;
                                                   CaptionML=[ENU=Country/Region Code;
                                                              NOR=Lands-/regionkode] }
    { 7300;   ;Location Code       ;Code10        ;TableRelation=Location.Code WHERE (Use As In-Transit=CONST(No),
                                                                                      Bin Mandatory=CONST(Yes));
                                                   OnValidate=VAR
                                                                WorkCenter@1000 : Record 99000754;
                                                                AutoUpdate@1001 : Boolean;
                                                              BEGIN
                                                                IF "Location Code" <> xRec."Location Code" THEN BEGIN
                                                                  IF ("Work Center No." = '') AND ("Location Code" <> '') THEN
                                                                    ERROR(Text008,FIELDCAPTION("Location Code"),TABLECAPTION,WorkCenter.TABLECAPTION);

                                                                  IF "Open Shop Floor Bin Code" <> '' THEN BEGIN
                                                                    IF ConfirmAutoRemovalOfBinCode(AutoUpdate) THEN
                                                                      VALIDATE("Open Shop Floor Bin Code",'')
                                                                    ELSE
                                                                      TESTFIELD("Open Shop Floor Bin Code",'');
                                                                  END;
                                                                  IF "To-Production Bin Code" <> '' THEN BEGIN
                                                                    IF ConfirmAutoRemovalOfBinCode(AutoUpdate) THEN
                                                                      VALIDATE("To-Production Bin Code",'')
                                                                    ELSE
                                                                      TESTFIELD("To-Production Bin Code",'');
                                                                  END;
                                                                  IF "From-Production Bin Code" <> '' THEN BEGIN
                                                                    IF ConfirmAutoRemovalOfBinCode(AutoUpdate) THEN
                                                                      VALIDATE("From-Production Bin Code",'')
                                                                    ELSE
                                                                      TESTFIELD("From-Production Bin Code",'');
                                                                  END;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Location Code;
                                                              NOR=Lokasjonskode];
                                                   Editable=No }
    { 7301;   ;Open Shop Floor Bin Code;Code20    ;TableRelation=Bin.Code WHERE (Location Code=FIELD(Location Code));
                                                   OnValidate=VAR
                                                                WhseIntegrationMgt@1000 : Codeunit 7317;
                                                              BEGIN
                                                                WhseIntegrationMgt.CheckBinCode("Location Code",
                                                                  "Open Shop Floor Bin Code",
                                                                  FIELDCAPTION("Open Shop Floor Bin Code"),
                                                                  DATABASE::"Machine Center","No.");
                                                              END;

                                                   CaptionML=[ENU=Open Shop Floor Bin Code;
                                                              NOR=pen prod.hyllekode] }
    { 7302;   ;To-Production Bin Code;Code20      ;TableRelation=Bin.Code WHERE (Location Code=FIELD(Location Code));
                                                   OnValidate=VAR
                                                                WhseIntegrationMgt@1000 : Codeunit 7317;
                                                              BEGIN
                                                                WhseIntegrationMgt.CheckBinCode("Location Code",
                                                                  "To-Production Bin Code",
                                                                  FIELDCAPTION("To-Production Bin Code"),
                                                                  DATABASE::"Machine Center","No.");
                                                              END;

                                                   CaptionML=[ENU=To-Production Bin Code;
                                                              NOR=Til-Hyllekode for produksjon] }
    { 7303;   ;From-Production Bin Code;Code20    ;TableRelation=Bin.Code WHERE (Location Code=FIELD(Location Code));
                                                   OnValidate=VAR
                                                                WhseIntegrationMgt@1000 : Codeunit 7317;
                                                              BEGIN
                                                                WhseIntegrationMgt.CheckBinCode("Location Code",
                                                                  "From-Production Bin Code",
                                                                  FIELDCAPTION("From-Production Bin Code"),
                                                                  DATABASE::"Machine Center","No.");
                                                              END;

                                                   CaptionML=[ENU=From-Production Bin Code;
                                                              NOR=Fra-Hyllekode for produksjon] }
    { 83001;  ;Show in OPC         ;Boolean       ;CaptionML=[ENU=Show in OPC;
                                                              NOR=Vises i OPC];
                                                   Description=OPC }
    { 83002;  ;Clocking            ;Boolean       ;CaptionML=[ENU=Clocking;
                                                              NOR=M›nstring];
                                                   Description=OPC }
    { 83003;  ;Employee No.        ;Code20        ;CaptionML=[ENU=Employee No. (H and L);
                                                              NOR=Ansattnr. (H og L)];
                                                   Description=OPC }
    { 83004;  ;Time registrations  ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Time Register".Quantity WHERE (Machine Center=FIELD(No.),
                                                                                                   Start Date=FIELD(Date Filter)));
                                                   Description=OPC }
    { 83005;  ;Earliest Time Reg.  ;Time          ;FieldClass=FlowField;
                                                   CalcFormula=Min("Time Register"."Start Time" WHERE (Machine Center=FIELD(No.),
                                                                                                       Start Date=FIELD(Date Filter)));
                                                   Description=OPC }
    { 83006;  ;Latest Time Reg.    ;Time          ;FieldClass=FlowField;
                                                   CalcFormula=Max("Time Register"."End Time" WHERE (Machine Center=FIELD(No.),
                                                                                                     Start Date=FIELD(Date Filter)));
                                                   Description=OPC }
    { 83007;  ;Deduct - Lunch      ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Time Register" WHERE (Deduction Type=CONST(Lunch),
                                                                                            Start Date=FIELD(Date Filter),
                                                                                            Machine Center=FIELD(No.)));
                                                   Description=OPC }
    { 83008;  ;Invoiced Qty.       ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Capacity Ledger Entry"."Invoiced Quantity" WHERE (No.=FIELD(No.),
                                                                                                                      Type=FILTER(Machine Center),
                                                                                                                      Posting Date=FIELD(Date Filter)));
                                                   Description=OPC }
    { 83009;  ;Birth Date          ;Date          ;CaptionML=[ENU=Birth Date;
                                                              NOR=F›dselsdato];
                                                   Description=OPC }
    { 83010;  ;Allow OPC Move      ;Boolean       ;CaptionML=NOR=Tillat flytting av komponenter via OPC;
                                                   Description=OPC }
  }
  KEYS
  {
    {    ;No.                                     ;Clustered=Yes }
    {    ;Search Name                              }
    {    ;Work Center No.                          }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      Text000@1000 : TextConst 'ENU=The Machine Center is being used on production orders.;NOR=Maskinsenteret brukes i forbindelse med produksjonsordrer.';
      Text001@1001 : TextConst 'ENU=Do you want to change %1?;NOR=Vil du endre %1?';
      Text002@1002 : TextConst 'ENU=Work Center No. is corrected on\\;NOR=Arbeidssenternr. er korrigert\\';
      Text003@1003 : TextConst 'ENU=Calendar Entry    #1###### @2@@@@@@@@@@@@@\;NOR=Kalenderpost      #1###### @2@@@@@@@@@@@@@\';
      Text004@1004 : TextConst 'ENU=Calendar Absent.  #3###### @4@@@@@@@@@@@@@\;NOR=Kalenderfrav‘r    #3###### @4@@@@@@@@@@@@@\';
      Text006@1005 : TextConst 'ENU=Prod. Order Need  #7###### @8@@@@@@@@@@@@@;NOR=Prod.ordrebehov   #7###### @8@@@@@@@@@@@@@';
      PostCode@1020 : Record 225;
      MfgSetup@1006 : Record 99000765;
      MachineCenter@1007 : Record 99000758;
      CalendarEntry@1008 : Record 99000757;
      CalAbsentEntry@1009 : Record 99000760;
      MfgCommentLine@1010 : Record 99000770;
      RtngLine@1011 : Record 99000764;
      GLSetup@1017 : Record 98;
      NoSeriesMgt@1013 : Codeunit 396;
      Window@1014 : Dialog;
      i@1015 : Integer;
      NoOfRecords@1016 : Integer;
      GLSetupRead@1018 : Boolean;
      Text007@1019 : TextConst '@@@="%1 = Table caption; %2 = Field Value; %3 = Table Caption";ENU=You cannot delete %1 %2 because there is at least one %3 associated with it.;NOR=Du kan ikke slette %1 %2 fordi det finnes minst ‚n %3 tilknyttet.';
      Text008@1021 : TextConst 'ENU=You cannot change the %1 on %2 unless it is linked to a %3.;NOR=Du kan ikke endre %1 p† %2 med mindre koblet til %3.';
      Text009@1022 : TextConst 'ENU=If you change the %1, then all bin codes on the %2 will be removed. Are you sure that you want to continue?;NOR=Hvis du endrer %1, vil alle hyllekoder p† %2 bli fjernet. Er du sikker p† at du vil fortsette ?';

    PROCEDURE AssistEdit@2(OldMachineCenter@1000 : Record 99000758) : Boolean;
    BEGIN
      WITH MachineCenter DO BEGIN
        MachineCenter := Rec;
        MfgSetup.GET;
        MfgSetup.TESTFIELD("Machine Center Nos.");
        IF NoSeriesMgt.SelectSeries(MfgSetup."Machine Center Nos.",OldMachineCenter."No. Series","No. Series") THEN BEGIN
          NoSeriesMgt.SetSeries("No.");
          Rec := MachineCenter;
          EXIT(TRUE);
        END;
      END;
    END;

    LOCAL PROCEDURE GetGLSetup@14();
    BEGIN
      IF NOT GLSetupRead THEN
        GLSetup.GET;
      GLSetupRead := TRUE;
    END;

    LOCAL PROCEDURE ConfirmAutoRemovalOfBinCode@1(VAR AutoUpdate@1000 : Boolean) : Boolean;
    BEGIN
      IF AutoUpdate THEN
        EXIT(TRUE);

      IF CONFIRM(Text009,FALSE,FIELDCAPTION("Location Code"),TABLECAPTION) THEN
        AutoUpdate := TRUE;

      EXIT(AutoUpdate);
    END;

    PROCEDURE GetBinCode@9(UseFlushingMethod@1000 : Boolean;FlushingMethod@1001 : 'Manual,Forward,Backward,Pick + Forward,Pick + Backward') : Code[20];
    BEGIN
      IF NOT UseFlushingMethod THEN
        EXIT("From-Production Bin Code");

      CASE FlushingMethod OF
        FlushingMethod::Manual,
        FlushingMethod::"Pick + Forward",
        FlushingMethod::"Pick + Backward":
          EXIT("To-Production Bin Code");
        FlushingMethod::Forward,
        FlushingMethod::Backward:
          EXIT("Open Shop Floor Bin Code");
      END;
    END;

    BEGIN
    {
      +----------------------------------------------+
      OPC 5.01 (=5.0 SP1)
      ------------------------------------------------
      No  Date     ID  Description
      01. 04.11.09 HHE Opprettet feltene: 83001 "Show in OPC", 83470 Clocking, 83471 "Employee No."
      02. 21.01.10 BVM Nytt felt: Flowfelt Invoiced Qty, .
      03. 17.12.10 HHE Nytt felt: Birth date (›nsket av FRSK. Brukes i m›nstringstider->l›nnsgrunnlag)
      04. 04.03.10 HHE Nye  felt: Timeregistrations (brukes for summering av faktisk m›nstringstid)
                                  "Earilest start time" (tidspkt. for innstempling)
                                  "Latest end time" (tidspkt. for utstempling)
      05. 19.03.10 HHE Nytt felt "Deduct - Lunch" (for † se om det finnes fradrag-lunch for dagen)
    }
    END.
  }
}

OBJECT Table 99000760 Calendar Absence Entry
{
  OBJECT-PROPERTIES
  {
    Date=20.04.17;
    Time=16:08:18;
    Modified=Yes;
    Version List=NAVW110.00,OPC1.0;
  }
  PROPERTIES
  {
    OnDelete=BEGIN
               CalAbsenceMgt.RemoveAbsence(Rec);
             END;

    OnRename=BEGIN
               CalAbsenceMgt.RemoveAbsence(xRec);
               Updated := FALSE;
             END;

    CaptionML=[ENU=Calendar Absence Entry;
               NOR=Kalenderfrav‘rspost];
    LookupPageID=Page99000772;
    DrillDownPageID=Page99000772;
  }
  FIELDS
  {
    { 1   ;   ;Capacity Type       ;Option        ;CaptionML=[ENU=Capacity Type;
                                                              NOR=Kapasitetstype];
                                                   OptionCaptionML=[ENU=Work Center,Machine Center;
                                                                    NOR=Arbeidssenter,Maskinsenter];
                                                   OptionString=Work Center,Machine Center;
                                                   Editable=No }
    { 2   ;   ;No.                 ;Code20        ;TableRelation=IF (Capacity Type=CONST(Work Center)) "Work Center"
                                                                 ELSE IF (Capacity Type=CONST(Machine Center)) "Machine Center";
                                                   OnValidate=BEGIN
                                                                IF "No." = '' THEN
                                                                  EXIT;

                                                                CASE "Capacity Type" OF
                                                                  "Capacity Type"::"Work Center":
                                                                    BEGIN
                                                                      Workcenter.GET("No.");
                                                                      Workcenter.TESTFIELD("Work Center Group Code");
                                                                      "Work Center No." := Workcenter."No.";
                                                                      "Work Center Group Code" := Workcenter."Work Center Group Code";
                                                                      Capacity := Workcenter.Capacity;
                                                                    END;
                                                                  "Capacity Type"::"Machine Center":
                                                                    BEGIN
                                                                      Machinecenter.GET("No.");
                                                                      Machinecenter.TESTFIELD("Work Center No.");
                                                                      Workcenter.GET(Machinecenter."Work Center No.");
                                                                      Workcenter.TESTFIELD("Work Center Group Code");
                                                                      "Work Center No." := Workcenter."No.";
                                                                      "Work Center Group Code" := Workcenter."Work Center Group Code";
                                                                      Capacity := Machinecenter.Capacity;
                                                                    END;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=No.;
                                                              NOR=Nr.];
                                                   NotBlank=Yes }
    { 4   ;   ;Date                ;Date          ;OnValidate=BEGIN
                                                                UpdateDatetime;
                                                              END;

                                                   CaptionML=[ENU=Date;
                                                              NOR=Dato];
                                                   NotBlank=Yes }
    { 6   ;   ;Starting Time       ;Time          ;OnValidate=BEGIN
                                                                IF ("Ending Time" = 0T) OR
                                                                   ("Ending Time" < "Starting Time" )
                                                                THEN
                                                                  VALIDATE("Ending Time","Starting Time")
                                                              END;

                                                   CaptionML=[ENU=Starting Time;
                                                              NOR=Starttidspunkt] }
    { 7   ;   ;Ending Time         ;Time          ;OnValidate=BEGIN
                                                                IF "Ending Time" < "Starting Time" THEN
                                                                  ERROR(Text000,FIELDCAPTION("Ending Time"),FIELDCAPTION("Starting Time"));

                                                                UpdateDatetime;
                                                              END;

                                                   CaptionML=[ENU=Ending Time;
                                                              NOR=Sluttidspunkt] }
    { 8   ;   ;Work Center No.     ;Code20        ;TableRelation="Work Center";
                                                   CaptionML=[ENU=Work Center No.;
                                                              NOR=Arbeidssenternr.];
                                                   Editable=No }
    { 9   ;   ;Work Center Group Code;Code10      ;TableRelation="Work Center Group";
                                                   CaptionML=[ENU=Work Center Group Code;
                                                              NOR=Arbeidssentergruppekode];
                                                   Editable=No }
    { 21  ;   ;Capacity            ;Decimal       ;OnValidate=BEGIN
                                                                IF Capacity <> xRec.Capacity THEN BEGIN
                                                                  CalAbsenceMgt.RemoveAbsence(xRec);
                                                                  Updated := FALSE;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Capacity;
                                                              NOR=Kapasitet];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
    { 24  ;   ;Starting Date-Time  ;DateTime      ;OnValidate=BEGIN
                                                                "Starting Time" := DT2TIME("Starting Date-Time");
                                                                Date := DT2DATE("Starting Date-Time");
                                                                VALIDATE("Starting Time");
                                                              END;

                                                   CaptionML=[ENU=Starting Date-Time;
                                                              NOR=Startdato-tidsp.] }
    { 25  ;   ;Ending Date-Time    ;DateTime      ;OnValidate=BEGIN
                                                                "Ending Time" := DT2TIME("Ending Date-Time");
                                                                Date := DT2DATE("Ending Date-Time");
                                                                VALIDATE("Ending Time");
                                                              END;

                                                   CaptionML=[ENU=Ending Date-Time;
                                                              NOR=Sluttdato-tidsp.] }
    { 31  ;   ;Description         ;Text50        ;CaptionML=[ENU=Description;
                                                              NOR=Beskrivelse] }
    { 32  ;   ;Updated             ;Boolean       ;CaptionML=[ENU=Updated;
                                                              NOR=Oppdatert];
                                                   Editable=No }
    { 50000;  ;Work Type Code      ;Code10        ;TableRelation="Work Type Code" WHERE (Absence=CONST(Yes));
                                                   CaptionML=[ENU=Work Type Code;
                                                              NOR=Arbeidstypekode] }
  }
  KEYS
  {
    {    ;Capacity Type,No.,Date,Starting Time,Ending Time;
                                                   Clustered=Yes }
    {    ;Work Center No.                          }
    {    ;Capacity Type,No.,Date,Starting Date-Time,Ending Date-Time }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      Text000@1000 : TextConst 'ENU=%1 must be higher than %2.;NOR=%1 m† v‘re st›rre enn %2.';
      Workcenter@1001 : Record 99000754;
      Machinecenter@1002 : Record 99000758;
      CalAbsenceMgt@1003 : Codeunit 99000759;

    PROCEDURE Caption@3() : Text[100];
    BEGIN
      IF "Capacity Type" = "Capacity Type"::"Machine Center" THEN BEGIN
        IF NOT Machinecenter.GET(GETFILTER("No.")) THEN
          EXIT('');
        EXIT(
          STRSUBSTNO('%1 %2',
            Machinecenter."No.",Machinecenter.Name));
      END;
      IF NOT Workcenter.GET(GETFILTER("No.")) THEN
        EXIT('');
      EXIT(
        STRSUBSTNO('%1 %2',
          Workcenter."No.",Workcenter.Name));
    END;

    LOCAL PROCEDURE UpdateDatetime@11();
    BEGIN
      "Starting Date-Time" := CREATEDATETIME(Date,"Starting Time");
      "Ending Date-Time" := CREATEDATETIME(Date,"Ending Time");
    END;

    BEGIN
    {
      +-------------------------------------------------+
      | OPC                                             |
      +-------------------------------------------------+
      Dato     ID  Beskrivelse
      16.11.09 HHE Nytt felt "Work Type Code"
    }
    END.
  }
}

OBJECT Codeunit 83001 Clocking Mgt
{
  OBJECT-PROPERTIES
  {
    Date=20.04.17;
    Time=16:08:18;
    Modified=Yes;
    Version List=OPC2.0;
  }
  PROPERTIES
  {
    TableNo=99000758;
    OnRun=BEGIN
            RegisterTime("No.", WORKDATE, TIME);
          END;

  }
  CODE
  {
    VAR
      OPC_StartDateTime@1101104000 : DateTime;
      OPC_EndDateTime@1101104001 : DateTime;
      C_ErrorInQty@1101103000 : TextConst 'ENU=Scrap can only be posted together with output quantity.;NOR=Vrak kan kun bokf›res sammen med ferdigantall.';

    PROCEDURE RegisterTime@1000000000(MachineCenter@1000000002 : Code[20];RegisterDate@1000000000 : Date;RegisterTime@1000000001 : Time);
    VAR
      TimeRegister@1000000003 : Record 83007;
    BEGIN
      TimeRegister.RESET;
      TimeRegister.SETRANGE("Machine Center", MachineCenter);
      TimeRegister.SETRANGE("End Time", 0T);
      IF TimeRegister.FINDFIRST THEN BEGIN
        REPEAT
          IF TimeRegister."Start Date" < WORKDATE THEN BEGIN
            //nytt 16.06.06->
            TimeRegister.VALIDATE("End Date",WORKDATE-1);
            TimeRegister."End Time" := 235959T;
            OPC_StartDateTime := CREATEDATETIME(TimeRegister."Start Date", TimeRegister."Start Time");
            OPC_EndDateTime := CREATEDATETIME(TimeRegister."End Date", TimeRegister."End Time");
            TimeRegister.Quantity :=( (OPC_EndDateTime - OPC_StartDateTime) / 3600000);
            TimeRegister.MODIFY;
            TimeRegister.INIT;
            TimeRegister.VALIDATE("Machine Center",MachineCenter);
            TimeRegister.VALIDATE("Start Date",WORKDATE);
            TimeRegister.VALIDATE("Start Time",000000T);
            TimeRegister.VALIDATE("End Date", WORKDATE);
            TimeRegister.VALIDATE("End Time", TIME);
            TimeRegister.INSERT;
            END ELSE
            ClockOut(TimeRegister, RegisterDate, RegisterTime);
            //nytt 16.06.06<-

        UNTIL TimeRegister.NEXT = 0;
      END ELSE
        ClockIn(MachineCenter, RegisterDate, RegisterTime);
    END;

    PROCEDURE ClockIn@1000000001(MachineCenter@1000000002 : Code[20];RegisterDate@1000000001 : Date;RegisterTime@1000000000 : Time);
    VAR
      TimeRegister@1000000003 : Record 83007;
    BEGIN
      WITH TimeRegister DO BEGIN
        INIT;
        "Machine Center" := MachineCenter;
        "Start Date" := RegisterDate;
        "Start Time" := RegisterTime;
        "End Date" := 0D;
        "End Time" := 0T;
        INSERT;
      END;
    END;

    PROCEDURE ClockOut@1000000002(VAR TimeRegister@1000000002 : Record 83007;RegisterDate@1000000001 : Date;RegisterTime@1000000000 : Time);
    VAR
      Overtime@1000000003 : Codeunit 83002;
      PostOutput@1000000004 : Codeunit 83004;
    BEGIN
      WITH TimeRegister DO BEGIN
        "End Date" := RegisterDate;
        "End Time" := RegisterTime;
        CalcQty;
        MODIFY;
        // Find Overtime
        Overtime.ClockOvertime(TimeRegister);
        // Find unfinished run times
        PostOutput.RUN(TimeRegister);
      END;
    END;

    PROCEDURE GetDefaultTimeOut@1000000003() : Time;
    BEGIN
      EXIT(160000T);
    END;

    PROCEDURE Absence@1000000004(VAR CalendarAbsenceEntry@1000000000 : Record 99000760;Remove@1000000003 : Boolean);
    VAR
      TimeRegister@1000000001 : Record 83007;
      TimeRegister2@1000000002 : Record 83007;
    BEGIN
      TimeRegister2.RESET;
      TimeRegister2.SETRANGE("Machine Center", CalendarAbsenceEntry."No.");
      TimeRegister2.SETRANGE("Start Date", CalendarAbsenceEntry.Date);
      TimeRegister2.SETRANGE("Start Time", CalendarAbsenceEntry."Starting Time");
      IF TimeRegister2.FIND('-') THEN BEGIN
        TimeRegister := TimeRegister2;
        IF NOT Remove THEN BEGIN
          TimeRegister."Machine Center" := CalendarAbsenceEntry."No.";
          TimeRegister."Start Date" := CalendarAbsenceEntry.Date;
          TimeRegister."Start Time" := CalendarAbsenceEntry."Starting Time";
          TimeRegister."End Date" := CalendarAbsenceEntry.Date;
          TimeRegister."End Time" := CalendarAbsenceEntry."Ending Time";
          TimeRegister."Work Type Code" := CalendarAbsenceEntry."Work Type Code";
          TimeRegister.Absence := TRUE;
          TimeRegister.CalcQty;
          TimeRegister.MODIFY;
        END ELSE
          TimeRegister.DELETE;
      END ELSE BEGIN
        TimeRegister.INIT;
        TimeRegister."Machine Center" := CalendarAbsenceEntry."No.";
        TimeRegister."Start Date" := CalendarAbsenceEntry.Date;
        TimeRegister."Start Time" := CalendarAbsenceEntry."Starting Time";
        TimeRegister."End Date" := CalendarAbsenceEntry.Date;
        TimeRegister."End Time" := CalendarAbsenceEntry."Ending Time";
        TimeRegister."Work Type Code" := CalendarAbsenceEntry."Work Type Code";
        TimeRegister.Absence := TRUE;
        TimeRegister.CalcQty;
        TimeRegister.INSERT;
      END;
    END;

    PROCEDURE RegisterTimeInJournal@1101103000(VAR RunTimesP@1101103000 : Record 83010;VAR OutPutQtyP@1101103013 : Decimal;VAR ScrapQtyP@1101103012 : Decimal;VAR ScrapCodeP@1101103011 : Code[20];VAR ScrapQty2P@1101103010 : Decimal;VAR ScrapCode2P@1101103009 : Code[20];VAR ScrapQty3P@1101103018 : Decimal;VAR ScrapCode3P@1101103017 : Code[20];VAR ScrapCommentP@1101103016 : Text[50];VAR ScrapComment2P@1101103015 : Text[50];VAR ScrapComment3P@1101103014 : Text[50]);
    VAR
      recOperasjonstider@1101103007 : Record 83010;
      OPCOppsett@1101103006 : Record 83001;
      ProdOrdreLinje@1101103005 : Record 5406;
      Vare@1101103004 : Record 27;
      FerdigMeldKladdLinje@1101103003 : Record 83;
      StemplTid@1101103002 : Record 83009;
      ProdO_ruteLinje@1101103001 : Record 5409;
      FirstRecOpLineL@1101103008 : Boolean;
    BEGIN
      //hhe 16.06.06->  Sletter blanke linjer f›r bokf›ring for † unng† feilmelding
      recOperasjonstider.RESET;
      recOperasjonstider.SETRANGE("Machine Center", '');
      IF recOperasjonstider.FINDFIRST THEN
        recOperasjonstider.DELETEALL;
      //hhe 16.06.06<-
      // Setter inn startdato og starttid
      recOperasjonstider.RESET;
      recOperasjonstider.SETRANGE(recOperasjonstider."Prod. Order No.",  RunTimesP."Prod. Order No.");
      recOperasjonstider.SETRANGE(recOperasjonstider."Routing No.",  RunTimesP."Routing No.");
      recOperasjonstider.SETRANGE(recOperasjonstider."Operation No.",  RunTimesP."Operation No.");
      recOperasjonstider.SETRANGE(Post, FALSE); //02. 28.07.16 JAL
      IF recOperasjonstider.FINDFIRST THEN
      REPEAT
        recOperasjonstider.TESTFIELD(recOperasjonstider."Machine Center");
        IF (recOperasjonstider."Starting Date" = 0D) THEN
          recOperasjonstider."Starting Date" := TODAY;
        IF (recOperasjonstider."Starting Time" = 0T) THEN BEGIN
          recOperasjonstider."Starting Time" := TIME;
          ProdO_ruteLinje.SETRANGE(Status, ProdO_ruteLinje.Status::Released);
          ProdO_ruteLinje.SETRANGE("Prod. Order No.", RunTimesP."Prod. Order No.");
          ProdO_ruteLinje.SETRANGE("Routing No.", RunTimesP."Routing No.");
          ProdO_ruteLinje.SETRANGE("Operation No.", RunTimesP."Operation No.");
          ProdO_ruteLinje.SETRANGE(Type, ProdO_ruteLinje.Type::"Machine Center");
          IF ProdO_ruteLinje.FINDFIRST THEN
            recOperasjonstider."Work done at M.C." := ProdO_ruteLinje."No.";
          END;
        recOperasjonstider.MODIFY;
      UNTIL recOperasjonstider.NEXT = 0;

      StemplTid.SETRANGE(StemplTid."Machine Center No.", RunTimesP."Machine Center");
      IF StemplTid.FINDFIRST THEN
      REPEAT
        StemplTid.TESTFIELD(StemplTid."Machine Center No.");
        StemplTid.VALIDATE(StemplTid.Workstatus, StemplTid.Workstatus::"Direct Production");
        StemplTid.MODIFY;
      UNTIL StemplTid.NEXT = 0;

      // Setter inn sluttdato og sluttid
      recOperasjonstider.RESET;
      recOperasjonstider.SETRANGE(recOperasjonstider."Prod. Order No.", RunTimesP."Prod. Order No.");
      recOperasjonstider.SETRANGE(recOperasjonstider."Routing No.", RunTimesP."Routing No.");
      recOperasjonstider.SETRANGE(recOperasjonstider."Operation No.", RunTimesP."Operation No.");
      recOperasjonstider.SETRANGE(recOperasjonstider."Finish Now", TRUE);
      recOperasjonstider.SETRANGE(recOperasjonstider.Post, FALSE);
      IF recOperasjonstider.FINDFIRST THEN
      REPEAT
        IF (recOperasjonstider."Starting Date" <> 0D) AND (recOperasjonstider."Ending Date" = 0D) THEN
          recOperasjonstider."Ending Date" := TODAY;
        IF (recOperasjonstider."Starting Time" <> 0T) AND (recOperasjonstider."Ending Time" = 0T)THEN
          recOperasjonstider."Ending Time" := TIME;
        recOperasjonstider.MODIFY;
        SearchDeductions(recOperasjonstider);
      UNTIL recOperasjonstider.NEXT = 0;

      StemplTid.SETRANGE(StemplTid."Machine Center No.", RunTimesP."Machine Center");
      IF StemplTid.FINDFIRST THEN
      REPEAT
        StemplTid.TESTFIELD(StemplTid."Machine Center No.");
        StemplTid.VALIDATE(StemplTid.Workstatus, StemplTid.Workstatus::Registrated);
        StemplTid.MODIFY;
      UNTIL StemplTid.NEXT = 0;

      // Post "Run Times" (Bokf›rer tidlinjer)
      FirstRecOpLineL := TRUE;

      recOperasjonstider.RESET;
      recOperasjonstider.SETRANGE(recOperasjonstider."Prod. Order No.", RunTimesP."Prod. Order No.");
      recOperasjonstider.SETRANGE(recOperasjonstider."Routing No.", RunTimesP."Routing No.");
      recOperasjonstider.SETRANGE(recOperasjonstider."Operation No.", RunTimesP."Operation No.");
      recOperasjonstider.SETRANGE(recOperasjonstider."Finish Now", TRUE);
      recOperasjonstider.SETRANGE(recOperasjonstider.Post, FALSE);
      recOperasjonstider.SETFILTER(recOperasjonstider."Starting Date", '<>%1', 0D);
      recOperasjonstider.SETFILTER(recOperasjonstider."Starting Time", '<>%1', 0T);
      recOperasjonstider.SETFILTER(recOperasjonstider."Ending Date", '<>%1', 0D);
      recOperasjonstider.SETFILTER(recOperasjonstider."Ending Time", '<>%1', 0T);
      IF recOperasjonstider.FINDFIRST THEN BEGIN
        OPCOppsett.GET();
        OPCOppsett.TESTFIELD("Output Batch Name Time");
        OPCOppsett.TESTFIELD("Output Jrn Name Time");
        FerdigMeldKladdLinje.SETRANGE(FerdigMeldKladdLinje."Journal Template Name", OPCOppsett."Output Batch Name Time");
        FerdigMeldKladdLinje.SETRANGE(FerdigMeldKladdLinje."Journal Batch Name", OPCOppsett."Output Jrn Name Time");
        IF FerdigMeldKladdLinje.FIND('-') THEN
          FerdigMeldKladdLinje.DELETEALL;

        ProdOrdreLinje.SETRANGE(ProdOrdreLinje.Status, ProdOrdreLinje.Status::Released);
        ProdOrdreLinje.SETRANGE(ProdOrdreLinje."Prod. Order No.", RunTimesP."Prod. Order No.");
        ProdOrdreLinje.SETRANGE(ProdOrdreLinje."Routing No.", RunTimesP."Routing No.");
        IF ProdOrdreLinje.FINDFIRST THEN BEGIN
          IF Vare.GET(ProdOrdreLinje."Item No.") THEN BEGIN
            ProdOrdreLinje.TESTFIELD(ProdOrdreLinje."Routing No.");
          END ELSE
            ERROR('Fant ikke vare %1!', ProdOrdreLinje."Item No.");
        END;
        REPEAT
          FerdigMeldKladdLinje.INIT;
          FerdigMeldKladdLinje.VALIDATE(FerdigMeldKladdLinje."Journal Template Name", OPCOppsett."Output Batch Name Time");
          FerdigMeldKladdLinje.VALIDATE(FerdigMeldKladdLinje."Journal Batch Name", OPCOppsett."Output Jrn Name Time");
          FerdigMeldKladdLinje."Line No." := FerdigMeldKladdLinje."Line No." + 10000;
          FerdigMeldKladdLinje.VALIDATE(FerdigMeldKladdLinje."Entry Type", FerdigMeldKladdLinje."Entry Type"::Output);
          FerdigMeldKladdLinje.INSERT(TRUE);

          IF ProdOrdreLinje."Prod. Order No." <> '' THEN BEGIN
            FerdigMeldKladdLinje.VALIDATE("Order Type", FerdigMeldKladdLinje."Order Type"::Production);
            FerdigMeldKladdLinje.VALIDATE(FerdigMeldKladdLinje."Order No.", RunTimesP."Prod. Order No.");
            FerdigMeldKladdLinje.VALIDATE(FerdigMeldKladdLinje."Item No.", Vare."No.");
            FerdigMeldKladdLinje.VALIDATE("Operation No.", RunTimesP."Operation No.");

            IF FirstRecOpLineL THEN BEGIN
            FerdigMeldKladdLinje.VALIDATE(FerdigMeldKladdLinje."Output Quantity", OutPutQtyP);
            FerdigMeldKladdLinje.VALIDATE(FerdigMeldKladdLinje."Scrap Quantity", ScrapQtyP);
            FerdigMeldKladdLinje.VALIDATE(FerdigMeldKladdLinje."Scrap Code", ScrapCodeP);
            END;

            FerdigMeldKladdLinje."Posting Date" := recOperasjonstider."Ending Date";
            FerdigMeldKladdLinje."Document Date" := TODAY;
            FerdigMeldKladdLinje.VALIDATE(FerdigMeldKladdLinje.Type, FerdigMeldKladdLinje.Type::"Machine Center");
            FerdigMeldKladdLinje.VALIDATE(FerdigMeldKladdLinje."No.", recOperasjonstider."Machine Center");
            FerdigMeldKladdLinje.VALIDATE("Order Type", FerdigMeldKladdLinje."Order Type"::Production);
            FerdigMeldKladdLinje."Order Line No." :=  ProdOrdreLinje."Line No.";
            FerdigMeldKladdLinje."Starting Time" := recOperasjonstider."Starting Time";
            FerdigMeldKladdLinje."Ending Time" := recOperasjonstider."Ending Time";
            FerdigMeldKladdLinje.VALIDATE(FerdigMeldKladdLinje."Run Time",GetHours(recOperasjonstider."Starting Date",
              recOperasjonstider."Starting Time", recOperasjonstider."Ending Date", recOperasjonstider."Ending Time"));
            //hhe 23.10.07->
            FerdigMeldKladdLinje.VALIDATE("Scrap Comment", ScrapCommentP);
            //hhe 23.10.07<-
            //hhe 20.04.06->
            //sl†r her over flagget slik at ferdig-/vrak-antall ikke bokf›res p† alle p.ress. som avsluttes
            FirstRecOpLineL := FALSE;
            //hhe 20.04.06<-
            FerdigMeldKladdLinje.MODIFY(TRUE);
          END ELSE BEGIN
            FerdigMeldKladdLinje."Document No." := OPCOppsett."Document No. Ind.Time";
            FerdigMeldKladdLinje."Posting Date" := recOperasjonstider."Ending Date";
            FerdigMeldKladdLinje."Document Date" := TODAY;
            FerdigMeldKladdLinje.VALIDATE(FerdigMeldKladdLinje.Type,
              FerdigMeldKladdLinje.Type::"Machine Center");
            FerdigMeldKladdLinje.VALIDATE(FerdigMeldKladdLinje."No.", recOperasjonstider."Machine Center");
            FerdigMeldKladdLinje."Starting Time" := recOperasjonstider."Starting Time";
            FerdigMeldKladdLinje."Ending Time" := recOperasjonstider."Ending Time";
            FerdigMeldKladdLinje.VALIDATE(FerdigMeldKladdLinje."Stop Time", GetHours(recOperasjonstider."Starting Date",
              recOperasjonstider."Starting Time", recOperasjonstider."Ending Date", recOperasjonstider."Ending Time"));
            //22.01.10->
            //FerdigMeldKladdLinje."Stop Code" := NoneProducingTimeCode;
            FerdigMeldKladdLinje."Stop Code" := recOperasjonstider."Stop Code";
            //22.01.10<-
            FerdigMeldKladdLinje.MODIFY(TRUE);
          END;
        // 002 START
          recOperasjonstider.Post := TRUE;
          recOperasjonstider.MODIFY;
        UNTIL recOperasjonstider.NEXT = 0;
        //hhe 12.10.07->bokf. vrakkode2
        IF ScrapQty2P <> 0 THEN BEGIN
          FerdigMeldKladdLinje.INIT;
          FerdigMeldKladdLinje.VALIDATE(FerdigMeldKladdLinje."Journal Template Name", OPCOppsett."Output Batch Name Time");
          FerdigMeldKladdLinje.VALIDATE(FerdigMeldKladdLinje."Journal Batch Name", OPCOppsett."Output Jrn Name Time");
          FerdigMeldKladdLinje."Line No." := FerdigMeldKladdLinje."Line No." + 10000;
          FerdigMeldKladdLinje.VALIDATE(FerdigMeldKladdLinje."Entry Type", FerdigMeldKladdLinje."Entry Type"::Output);
          FerdigMeldKladdLinje.INSERT(TRUE);

          IF ProdOrdreLinje."Prod. Order No." <> '' THEN BEGIN
            FerdigMeldKladdLinje.VALIDATE("Order Type", FerdigMeldKladdLinje."Order Type"::Production);
            FerdigMeldKladdLinje.VALIDATE("Order No.", RunTimesP."Prod. Order No.");
            FerdigMeldKladdLinje.VALIDATE("Item No.", Vare."No.");
            FerdigMeldKladdLinje."Operation No." := RunTimesP."Operation No.";
            FerdigMeldKladdLinje.VALIDATE("Operation No.", RunTimesP."Operation No.");
            FerdigMeldKladdLinje.VALIDATE("Scrap Quantity", ScrapQty2P);
            FerdigMeldKladdLinje.VALIDATE("Scrap Code", ScrapCode2P);
          END;
          FerdigMeldKladdLinje."Document Date" := TODAY;
          FerdigMeldKladdLinje."Posting Date" := TODAY;
          FerdigMeldKladdLinje.VALIDATE(Type, FerdigMeldKladdLinje.Type::"Machine Center");
          FerdigMeldKladdLinje.VALIDATE("No.", recOperasjonstider."Machine Center");
          FerdigMeldKladdLinje.VALIDATE("Order Type", FerdigMeldKladdLinje."Order Type"::Production);
          FerdigMeldKladdLinje."Order Line No." :=  ProdOrdreLinje."Line No.";
          FerdigMeldKladdLinje.VALIDATE("Scrap Comment", ScrapComment2P);
          FerdigMeldKladdLinje.MODIFY;
        END;
        //hhe 12.10.07<-bokf. vrakkode2
        //hhe 15.10.07<- bokf. vrakkode 3 (hvis det er angitt)
        IF ScrapQty3P <> 0 THEN BEGIN
          FerdigMeldKladdLinje.INIT;
          FerdigMeldKladdLinje.VALIDATE(FerdigMeldKladdLinje."Journal Template Name", OPCOppsett."Output Batch Name Time");
          FerdigMeldKladdLinje.VALIDATE(FerdigMeldKladdLinje."Journal Batch Name", OPCOppsett."Output Jrn Name Time");
          FerdigMeldKladdLinje."Line No." := FerdigMeldKladdLinje."Line No." + 10000;
          FerdigMeldKladdLinje.VALIDATE(FerdigMeldKladdLinje."Entry Type", FerdigMeldKladdLinje."Entry Type"::Output);
          FerdigMeldKladdLinje.INSERT(TRUE);
          IF ProdOrdreLinje."Prod. Order No." <> '' THEN BEGIN
            FerdigMeldKladdLinje.VALIDATE("Order Type", FerdigMeldKladdLinje."Order Type"::Production);
            FerdigMeldKladdLinje.VALIDATE("Order No.", RunTimesP."Prod. Order No.");
            FerdigMeldKladdLinje.VALIDATE("Item No.", Vare."No.");
            FerdigMeldKladdLinje."Operation No." := RunTimesP."Operation No.";
            FerdigMeldKladdLinje.VALIDATE("Operation No.", RunTimesP."Operation No.");
            FerdigMeldKladdLinje.VALIDATE("Scrap Quantity", ScrapQty3P);
            FerdigMeldKladdLinje.VALIDATE("Scrap Code", ScrapCode3P);
          END;
          FerdigMeldKladdLinje."Document Date" := TODAY;
          FerdigMeldKladdLinje."Posting Date" := TODAY;
          FerdigMeldKladdLinje.VALIDATE(FerdigMeldKladdLinje.Type, FerdigMeldKladdLinje.Type::"Machine Center");
          FerdigMeldKladdLinje.VALIDATE(FerdigMeldKladdLinje."No.", recOperasjonstider."Machine Center");
          FerdigMeldKladdLinje.VALIDATE("Order Type", FerdigMeldKladdLinje."Order Type"::Production);
          FerdigMeldKladdLinje."Order Line No." :=  ProdOrdreLinje."Line No.";
          FerdigMeldKladdLinje.VALIDATE("Scrap Comment", ScrapComment3P);
          FerdigMeldKladdLinje.MODIFY;
        END;
        //hhe 15.10.07<- bokf. vrakkode 3 (hvis det er angitt)

        FerdigMeldKladdLinje.RESET;
        FerdigMeldKladdLinje.SETRANGE("Journal Template Name",OPCOppsett."Output Batch Name Time");
        FerdigMeldKladdLinje.SETRANGE("Journal Batch Name",OPCOppsett."Output Jrn Name Time");
        IF FerdigMeldKladdLinje.FINDFIRST THEN BEGIN
          CODEUNIT.RUN(CODEUNIT::"Item Jnl.-Post", FerdigMeldKladdLinje);
        END;
      END;
      //hhe 20.04.06->
      OutPutQtyP := 0;
      ScrapQtyP := 0;
      ScrapCodeP := '';
      //hhe 20.04.06<-
      //hhe 12.10.07->
      ScrapQty2P := 0;
      ScrapCode2P := '';
      //hhe 12.10.07
      //hhe 24.10.07->
      ScrapCommentP := '';
      ScrapComment2P := '';
      ScrapComment3P := '';
      ScrapQty3P := 0;
      ScrapCode3P := '';
      //hhe 24.10.07<-
    END;

    LOCAL PROCEDURE SearchDeductions@1101103001(VAR RunTimes@1000000000 : Record 83010);
    VAR
      RunTimeDeduction@1000000003 : Record 83012;
      RunTimes2@1000000002 : Record 83010;
    BEGIN
      RunTimeDeduction.RESET;
      IF RunTimeDeduction.FIND('-') THEN
        REPEAT
          RunTimes2.RESET;
          RunTimes2.SETRANGE("Prod. Order No.",  RunTimes."Prod. Order No.");
          RunTimes2.SETRANGE("Routing No.",  RunTimes."Routing No.");
          RunTimes2.SETRANGE("Operation No.",  RunTimes."Operation No.");
          //hhe 12.10.06->
          RunTimes2.SETRANGE("Machine Center",  RunTimes."Machine Center");
          //hhe 12.10.06<-
          RunTimes2.SETRANGE("Finish Now",  TRUE);
          RunTimes2.SETRANGE(Post,  FALSE);
          RunTimes2.SETRANGE("Starting Date", RunTimes."Starting Date");
          RunTimes2.SETFILTER("Starting Time", '<=%1', RunTimeDeduction."From Time");
          //hhe 28.09.06->  //dersom man avslutter jobben over midnatt
          IF RunTimes."Ending Date" > RunTimes."Starting Date" THEN
            RunTimes2.SETRANGE("Ending Date", RunTimes."Starting Date")
          ELSE
          //hhe 28.09.06<-
          RunTimes2.SETRANGE("Ending Date", RunTimes."Ending Date");
          RunTimes2.SETFILTER("Ending Time", '>=%1', RunTimeDeduction."To Time");
          IF RunTimes2.FINDFIRST THEN
            IF NOT ExistingDeductionLine(RunTimes, RunTimeDeduction) THEN
              InsertDeductionLine(RunTimes, RunTimeDeduction);

        UNTIL RunTimeDeduction.NEXT = 0;
    END;

    LOCAL PROCEDURE GetHours@1101104001(StartDate@1101104003 : Date;StartTime@1101104002 : Time;EndDate@1101104001 : Date;EndTime@1101104000 : Time) : Decimal;
    VAR
      StartDateTime@1101104004 : DateTime;
      EndDateTime@1101104005 : DateTime;
    BEGIN
      StartDateTime := CREATEDATETIME(StartDate, StartTime);
      EndDateTime := CREATEDATETIME(EndDate, EndTime);
      EXIT( ((EndDateTime - StartDateTime) / 3600000) );
    END;

    LOCAL PROCEDURE ExistingDeductionLine@1101103002(VAR RunTimes@1000000001 : Record 83010;VAR RunTimeDeduction@1000000000 : Record 83012) : Boolean;
    VAR
      RunTimes2@1000000002 : Record 83010;
    BEGIN
      RunTimes2.RESET;
      RunTimes2.SETRANGE("Prod. Order No.",  RunTimes."Prod. Order No.");
      RunTimes2.SETRANGE("Routing No.",  RunTimes."Routing No.");
      RunTimes2.SETRANGE("Operation No.",  RunTimes."Operation No.");
      //hhe 12.10.06->
      RunTimes2.SETRANGE("Machine Center",  RunTimes."Machine Center");
      //hhe 12.10.06<-
      RunTimes2.SETRANGE("Finish Now", RunTimes."Finish Now");
      RunTimes2.SETRANGE(Post,  RunTimes.Post);
      RunTimes2.SETRANGE("Starting Date", RunTimes."Starting Date");
      RunTimes2.SETRANGE("Starting Time", RunTimeDeduction."To Time");
      RunTimes2.SETRANGE("Ending Date", RunTimes."Ending Date");
      RunTimes2.SETRANGE("Ending Time", RunTimeDeduction."From Time");
      EXIT(RunTimes2.FIND('-'));
    END;

    LOCAL PROCEDURE InsertDeductionLine@1101103003(VAR RunTimes@1000000000 : Record 83010;VAR RunTimeDeduction@1000000004 : Record 83012);
    VAR
      RunTimes2@1000000001 : Record 83010;
      NewEntryNo@1000000002 : Integer;
    BEGIN
      RunTimes2.RESET;
      IF RunTimes2.FIND('+') THEN
        NewEntryNo := RunTimes2."Entry No." + 1
      ELSE
        NewEntryNo := 1;

      RunTimes2.INIT;
      RunTimes2."Entry No." := NewEntryNo;
      RunTimes2."Prod. Order No." := RunTimes."Prod. Order No.";
      RunTimes2."Routing No." := RunTimes."Routing No.";
      RunTimes2."Operation No." := RunTimes."Operation No.";
      RunTimes2."Machine Center" := RunTimes."Machine Center";
      RunTimes2.Description := RunTimes.Description;
      RunTimes2."Starting Date" := RunTimes."Starting Date";
      RunTimes2."Starting Time" := RunTimeDeduction."To Time";
      RunTimes2."Ending Date" := RunTimes."Starting Date";
      RunTimes2."Ending Time" := RunTimeDeduction."From Time";
      RunTimes2."Finish Now" := TRUE;
      RunTimes2.Post := FALSE;
      RunTimes2."Work done at M.C." := RunTimes."Work done at M.C.";
      RunTimes2.INSERT;
    END;

    PROCEDURE DeleteBlankRunTimes@1101103004(VAR RunTimesP@1101103000 : Record 83010);
    VAR
      RunTimesL@1000000000 : Record 83010;
    BEGIN
      ////010 BVM-->
      RunTimesL.RESET;
      RunTimesL.SETRANGE("Prod. Order No.", RunTimesP."Prod. Order No.");
      RunTimesL.SETRANGE("Routing No.", RunTimesP."Routing No.");
      RunTimesL.SETRANGE("Starting Date", 0D);
      RunTimesL.SETRANGE("Starting Time", 0T);
      RunTimesL.SETRANGE("Ending Date", 0D);
      RunTimesL.SETRANGE("Ending Time", 0T);
      IF RunTimesL.FINDFIRST THEN BEGIN
       RunTimesL.DELETEALL;
      END;
      //010 BVM--<
    END;

    PROCEDURE PostOutputItem@1101103005(ProdOrderRoutingLineP@1101103000 : Record 5409);
    VAR
      ItemL@1101103002 : Record 27;
      OPCSetupL@1101103001 : Record 83001;
      ProdOrderLineL@1101103004 : Record 5406;
      ItemJournalLineL@1101103015 : Record 83;
      OutputRegistrationL@1101103003 : Page 83010;
      FerdigmeldAntallL@1101103005 : Decimal;
      VrakAnt2@1101103014 : Decimal;
      VrakBeskr2@1101103013 : Text[50];
      VrakKode2@1101103012 : Code[20];
      VrakKode@1101103011 : Code[20];
      VrakBeskr@1101103010 : Text[50];
      VrakAnt3@1101103009 : Decimal;
      VrakBeskr3@1101103008 : Text[50];
      VrakKode3@1101103007 : Code[20];
      VrakAntallL@1101103006 : Decimal;
      PageActionL@1101103016 : Action;
      HasPostItem@1101103017 : Boolean;
    BEGIN
      HasPostItem := FALSE;
      OPCSetupL.GET();
      ProdOrderLineL.SETRANGE(Status, ProdOrderLineL.Status::Released);
      ProdOrderLineL.SETRANGE("Prod. Order No.", ProdOrderRoutingLineP."Prod. Order No.");
      ProdOrderLineL.SETRANGE("Routing No.", ProdOrderRoutingLineP."Routing No.");
      IF ProdOrderLineL.FINDFIRST THEN BEGIN
        IF ItemL.GET(ProdOrderLineL."Item No.") THEN BEGIN
          ProdOrderLineL.TESTFIELD("Routing No.");
          OPCSetupL.TESTFIELD("Output Template Name Qty");
          OPCSetupL.TESTFIELD("Output Jrn Batch Name Qty");

          OutputRegistrationL.SettTekst(ProdOrderRoutingLineP."Prod. Order No.", ItemL."No.", ItemL.Description, ProdOrderRoutingLineP.Description);
          PageActionL := OutputRegistrationL.RUNMODAL();
          IF (PageActionL = ACTION::Yes) OR (PageActionL = ACTION::LookupOK) THEN
            FerdigmeldAntallL := OutputRegistrationL.FinnAntall
          ELSE
            EXIT;

          VrakAntallL := OutputRegistrationL.VrakAnt;
          VrakKode := OutputRegistrationL.VrakID;
          VrakBeskr := OutputRegistrationL.VrakBeskrivelse;
          VrakAnt2 := OutputRegistrationL.VrakAntall2;
          VrakKode2 := OutputRegistrationL.VrakID2;
          VrakBeskr2 := OutputRegistrationL.VrakBeskrivelse2;
          VrakAnt3 := OutputRegistrationL.VrakAntall3;
          VrakKode3 := OutputRegistrationL.VrakID3;
          VrakBeskr3 := OutputRegistrationL.VrakBeskrivelse3;

          IF (FerdigmeldAntallL = 0) AND ((VrakAntallL + VrakAnt2 + VrakAnt3) > 0) THEN
            ERROR(C_ErrorInQty);

          IF (FerdigmeldAntallL > 0) OR (VrakAntallL > 0) THEN BEGIN
            ItemJournalLineL.SETRANGE("Journal Template Name", OPCSetupL."Output Template Name Qty");
            ItemJournalLineL.SETRANGE("Journal Batch Name", OPCSetupL."Output Jrn Batch Name Qty");
            IF ItemJournalLineL.FINDFIRST THEN
              ItemJournalLineL.DELETEALL;

            ItemJournalLineL.INIT;
            ItemJournalLineL.VALIDATE("Journal Template Name", OPCSetupL."Output Template Name Qty");
            ItemJournalLineL.VALIDATE("Journal Batch Name", OPCSetupL."Output Jrn Batch Name Qty");
            ItemJournalLineL."Line No." := 10000;
            ItemJournalLineL.VALIDATE("Entry Type", ItemJournalLineL."Entry Type"::Output);
            ItemJournalLineL.INSERT(TRUE);

            ItemJournalLineL.VALIDATE("Order Type", ItemJournalLineL."Order Type"::Production);
            ItemJournalLineL.VALIDATE("Order No.", ProdOrderRoutingLineP."Prod. Order No.");
            ItemJournalLineL."Operation No." := ProdOrderRoutingLineP."Operation No.";
            ItemJournalLineL.VALIDATE("Item No.", ItemL."No.");
            ItemJournalLineL."Posting Date" := TODAY;
            ItemJournalLineL."Document Date" := TODAY;
            ItemJournalLineL.VALIDATE(Type, ItemJournalLineL.Type::"Machine Center");
            ItemJournalLineL.VALIDATE("No.", ProdOrderRoutingLineP."No.");
            ItemJournalLineL.VALIDATE("Output Quantity", FerdigmeldAntallL);
            ItemJournalLineL."Order Type" := ItemJournalLineL."Order Type"::Production;
            ItemJournalLineL."Order Line No." := ProdOrderLineL."Line No.";
            ItemJournalLineL."Location Code" :=  ProdOrderLineL."Location Code";
            ItemJournalLineL.VALIDATE("Entry Type", ItemJournalLineL."Entry Type"::Output);
            ItemJournalLineL."Document No." := 'T00001';
            ItemJournalLineL.VALIDATE("Scrap Quantity", VrakAntallL);
            ItemJournalLineL.VALIDATE("Scrap Code", VrakKode);
            ItemJournalLineL.VALIDATE("Scrap Comment", VrakBeskr);
            ItemJournalLineL.MODIFY(TRUE);
            HasPostItem := TRUE;
          END;

          //008 HEI-> Bokf›rer hvis antall "Vrak 2" er registrert
          IF VrakAnt2 <> 0 THEN BEGIN
            ItemJournalLineL.INIT;
            ItemJournalLineL.VALIDATE("Journal Template Name", OPCSetupL."Output Batch Name Time");
            ItemJournalLineL.VALIDATE("Journal Batch Name", OPCSetupL."Output Jrn Name Time");
            ItemJournalLineL."Line No." := ItemJournalLineL."Line No." + 10000;
            ItemJournalLineL.VALIDATE(ItemJournalLineL."Entry Type",
            ItemJournalLineL."Entry Type"::Output);
            ItemJournalLineL.INSERT(TRUE);

            ItemJournalLineL."Order Type" := ItemJournalLineL."Order Type"::Production;
            ItemJournalLineL.VALIDATE("Order No.", ProdOrderRoutingLineP."Prod. Order No.");
            ItemJournalLineL."Operation No." := ProdOrderRoutingLineP."Operation No.";
            ItemJournalLineL.VALIDATE("Item No.", ItemL."No.");
            ItemJournalLineL."Posting Date" := TODAY;
            ItemJournalLineL."Document Date" := TODAY;
            ItemJournalLineL.VALIDATE(ItemJournalLineL.Type,
            ItemJournalLineL.Type::"Machine Center");
            ItemJournalLineL.VALIDATE("No.", ProdOrderRoutingLineP."No.");
            ItemJournalLineL.VALIDATE("Output Quantity", 0);
            ItemJournalLineL."Order Line No." :=  ProdOrderLineL."Line No.";
            ItemJournalLineL."Location Code" :=  ProdOrderLineL."Location Code";
            ItemJournalLineL.VALIDATE("Entry Type", ItemJournalLineL."Entry Type"::Output);
            ItemJournalLineL."Document No." := 'T00001';
            ItemJournalLineL.VALIDATE("Scrap Quantity", VrakAnt2);
            ItemJournalLineL.VALIDATE("Scrap Code",VrakKode2);
            ItemJournalLineL.VALIDATE("Scrap Comment",VrakBeskr2);

            ItemJournalLineL.MODIFY;
            HasPostItem := TRUE;
          END;

          IF VrakAnt3 <> 0 THEN BEGIN  //Bokf›rer hvis antall "Vrak 3" er registrert
            ItemJournalLineL.INIT;
            ItemJournalLineL.VALIDATE("Journal Template Name", OPCSetupL."Output Batch Name Time");
            ItemJournalLineL.VALIDATE("Journal Batch Name", OPCSetupL."Output Jrn Name Time");
            ItemJournalLineL."Line No." := ItemJournalLineL."Line No." + 10000;
            ItemJournalLineL.VALIDATE("Entry Type", ItemJournalLineL."Entry Type"::Output);
            ItemJournalLineL.INSERT(TRUE);

            ItemJournalLineL."Order Type" := ItemJournalLineL."Order Type"::Production;
            ItemJournalLineL.VALIDATE("Order No.", ProdOrderRoutingLineP."Prod. Order No.");
            ItemJournalLineL."Operation No." := ProdOrderRoutingLineP."Operation No.";
            ItemJournalLineL.VALIDATE("Item No.", ItemL."No.");
            ItemJournalLineL."Posting Date" := TODAY;
            ItemJournalLineL."Document Date" := TODAY;
            ItemJournalLineL.VALIDATE(Type, ItemJournalLineL.Type::"Machine Center");
            ItemJournalLineL.VALIDATE("No.", ProdOrderRoutingLineP."No.");
            ItemJournalLineL.VALIDATE("Output Quantity", 0);
            ItemJournalLineL."Order Line No." :=  ProdOrderLineL."Line No.";
            ItemJournalLineL."Location Code" :=  ProdOrderLineL."Location Code";
            ItemJournalLineL.VALIDATE("Entry Type", ItemJournalLineL."Entry Type"::Output);
            ItemJournalLineL."Document No." := 'T00001';
            ItemJournalLineL.VALIDATE("Scrap Quantity", VrakAnt3);
            ItemJournalLineL.VALIDATE("Scrap Code",VrakKode3);
            ItemJournalLineL.VALIDATE("Scrap Comment",VrakBeskr3);

            ItemJournalLineL.MODIFY;
            HasPostItem := TRUE;
          END;
          //008 HEI<-
          IF HasPostItem THEN
            CODEUNIT.RUN(CODEUNIT::"Item Jnl.-Post", ItemJournalLineL);
        END;
      END;
    END;

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 16.06.06 hhe Kode som l›ser problemet med at en person er p†logget den ene dagen, men logger ut p† neste
      02. 28.07.16 JAL Raskere innstempling p† indirekte tid.
    }
    END.
  }
}

OBJECT Codeunit 83002 Clocking Overtime
{
  OBJECT-PROPERTIES
  {
    Date=20.04.17;
    Time=16:08:18;
    Modified=Yes;
    Version List=OPC (RSI);
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    PROCEDURE ClockOvertime@1117700003(VAR TimeRegister@1117700001 : Record 83007);
    VAR
      DayType@1117700000 : 'Normal Day,Holiday,Saturday';
    BEGIN
      WITH TimeRegister DO BEGIN
        CASE TRUE OF
          IsNormalDay("Start Date"):
            DayAndOvertimeClocking(TimeRegister, DayType::"Normal Day");

          IsHoliday("Start Date"):
            DayAndOvertimeClocking(TimeRegister, DayType::Holiday);

          IsSaturday("Start Date"):
            DayAndOvertimeClocking(TimeRegister, DayType::Saturday);
        END;
      END;
    END;

    PROCEDURE DayAndOvertimeClocking@1117700000(VAR TimeRegister@1101104000 : Record 83007;DayType@1117700013 : 'Normal Day,Holiday,Saturday');
    VAR
      TimeRegister2@1101104001 : Record 83007;
      TimeRegister3@1101104002 : Record 83007;
      WorkTime@1117700003 : Record 83003;
      FilterFromTime@1117700005 : Text[50];
      RestClockTime@1117700000 : Decimal;
      WorkQty@1117700007 : Decimal;
      FirstFromTime@1117700006 : Time;
      LastTimeUntil@1117700008 : Time;
      ClockedFirstTime@1117700014 : Time;
      DayTypeChanged@1117700015 : Boolean;
      Holiday@1117700010 : Boolean;
      Saturday@1117700011 : Boolean;
      NormalDay@1117700012 : Boolean;
    BEGIN
      RestClockTime := 0;
      ClockedFirstTime := 0T;
      DayTypeChanged := FALSE;

      Holiday := DayType = DayType::Holiday;
      Saturday := DayType = DayType::Saturday;
      NormalDay := DayType = DayType::"Normal Day";

      WorkTime.RESET;
      WorkTime.SETCURRENTKEY("From Time","To Time","Day Type","Time Type");
      WorkTime.SETRANGE("Day Type", DayType);
      IF WorkTime.FIND('-') THEN REPEAT

        WorkTime.TESTFIELD("From Time");
        WorkTime.TESTFIELD("To Time");

        WorkQty := 0;
        FirstFromTime := 0T;
        LastTimeUntil := 0T;

        IF ClockedFirstTime = 0T THEN BEGIN
          ClockedFirstTime := FindFirstClockingToday(TimeRegister);

          IF ClockedFirstTime = 0T THEN
            EXIT;

          FilterFromTime := STRSUBSTNO('>=%1&<%2',
            CONVERTSTR(FORMAT(ClockedFirstTime - 36000), ':', '.'),
              CONVERTSTR(FORMAT(WorkTime."To Time"), ':', '.'));
        END ELSE
          FilterFromTime := STRSUBSTNO('>=%1&<%2',
            CONVERTSTR(FORMAT(WorkTime."From Time"), ':', '.'),
              CONVERTSTR(FORMAT(WorkTime."To Time"), ':', '.'));

        TimeRegister2.RESET;
        TimeRegister2.SETRANGE("Machine Center", TimeRegister."Machine Center");
        TimeRegister2.SETRANGE("Start Date", TimeRegister."Start Date");
        TimeRegister2.SETFILTER("Start Time", FilterFromTime);
        IF TimeRegister2.FIND('-') THEN REPEAT
          // Tar vare p† den f›rste innstemplingen som finnes f›rst
          // for † regne ut totaltiden.
          IF FirstFromTime = 0T THEN
            FirstFromTime := TimeRegister2."Start Time";

          // F›rste stempling blir rettet p†
          WorkQty += TimeRegister2.Quantity;

          IF WorkQty > WorkTime.Duration THEN BEGIN
            RestClockTime := WorkQty - WorkTime.Duration;

            // Tar vare p† "Time Until" for † bruke den
            // i neste splittet post.
            IF LastTimeUntil = 0T THEN
              LastTimeUntil := TimeRegister2."End Time";

            IF ClockedFirstTime < WorkTime."From Time" THEN
              TimeRegister2.VALIDATE("End Time",
                WorkTime."To Time")
            ELSE
              TimeRegister2.VALIDATE("End Time",
                (FirstFromTime + (WorkTime.Duration * 3600000)));

          END ELSE
            RestClockTime := 0;

          TimeRegister2.VALIDATE("Work Type Code",
            GetWorkTypeCode(TimeRegister2."Work Type Code", WorkTime."Time Type"));
          TimeRegister2.MODIFY;

          // Sette inn ny stempling hvis RestClockTime har en restverdi
          // Slutttiden til den forrige stemplingen blir n† starttiden tile den neste

          IF RestClockTime > 0 THEN BEGIN
            InsertTimeRegisterEntry(TimeRegister3, TimeRegister,
              TimeRegister2."End Time", LastTimeUntil);

            // Sjekker hva DayType er blitt forandret.
            CASE TRUE OF
              Holiday <> IsHoliday(TimeRegister3."Start Date"):
                DayTypeChanged := TRUE;

              Saturday <> IsSaturday(TimeRegister3."Start Date"):
                DayTypeChanged := TRUE;

              NormalDay <> IsNormalDay(TimeRegister3."Start Date"):
                DayTypeChanged := TRUE;

              ELSE
                DayTypeChanged := FALSE;
            END;

          END;

        UNTIL ((TimeRegister2.NEXT = 0) OR DayTypeChanged);

      UNTIL ((WorkTime.NEXT = 0) OR DayTypeChanged);


      IF DayTypeChanged THEN
        ClockOvertime(TimeRegister3)
      ELSE
        EXIT;
    END;

    PROCEDURE IsNormalDay@1117700002(ClockingDate@1117700000 : Date) : Boolean;
    BEGIN
      EXIT(NOT (IsHoliday(ClockingDate) OR IsSaturday(ClockingDate)));
    END;

    PROCEDURE IsHoliday@1117700006(ClockingDate@1117700000 : Date) : Boolean;
    VAR
      DateTable@1117700001 : Record 2000000007;
      Holidays@1117700002 : Record 83005;
      Found@1117700003 : Boolean;
    BEGIN
      Found := Holidays.GET(ClockingDate);

      IF NOT Found THEN BEGIN
        DateTable.RESET;
        DateTable.SETRANGE("Period Type", DateTable."Period Type"::Date);
        DateTable.SETRANGE("Period No.", 7);  // Sunday
        DateTable.SETRANGE("Period Start", ClockingDate);
        Found := DateTable.FIND('-');
      END;

      EXIT(Found);
    END;

    PROCEDURE IsSaturday@1117700008(ClockingDate@1117700000 : Date) : Boolean;
    VAR
      DateTable@1117700001 : Record 2000000007;
    BEGIN
      DateTable.RESET;
      DateTable.SETRANGE("Period Type", DateTable."Period Type"::Date);
      DateTable.SETRANGE("Period No.", 6); // Saturday
      DateTable.SETRANGE("Period Start", ClockingDate);
      EXIT(DateTable.FIND('-'));
    END;

    PROCEDURE FindFirstClockingToday@1117700005(VAR TimeRegister@1117700000 : Record 83007) : Time;
    VAR
      TimeRegister2@1101104000 : Record 83007;
    BEGIN
      WITH TimeRegister DO BEGIN
        TimeRegister2.RESET;
        TimeRegister2.SETRANGE("Machine Center", "Machine Center");
        TimeRegister2.SETRANGE("Start Date", "Start Date");
        IF TimeRegister2.FIND('-') THEN
          EXIT(TimeRegister2."Start Time")
        ELSE
          EXIT(0T);
      END;
    END;

    PROCEDURE InsertTimeRegisterEntry@1101104000(VAR TimeRegisterNew@1117700003 : Record 83007;TimeRegister@1117700000 : Record 83007;TimeFrom@1117700002 : Time;TimeUntil@1117700006 : Time);
    BEGIN
      // Ordre
      IF TimeFrom = TimeUntil THEN
        EXIT;

      WITH TimeRegister DO BEGIN
        TimeRegisterNew.RESET;
        TimeRegisterNew.INIT;
        TimeRegisterNew."Machine Center" := "Machine Center";
        TimeRegisterNew."Start Date" := "Start Date";
        TimeRegisterNew."Start Time" := TimeFrom;
        TimeRegisterNew."End Date" := "Start Date";
        TimeRegisterNew."End Time" := TimeUntil;
        TimeRegisterNew."Time Type" := "Time Type";
        TimeRegisterNew.CalcQty;
        TimeRegisterNew.INSERT;
      END;
    END;

    PROCEDURE GetWorkTypeCode@1117700001(WorkType@1117700000 : Code[10];TimeType@1117700001 : 'Normal,Overtime 50%,Overtime 100%') : Code[10];
    VAR
      WorkTypeCode@1000000000 : Record 83004;
    BEGIN
      WorkTypeCode.RESET;
      WorkTypeCode.SETRANGE("Time Type", TimeType);
      WorkTypeCode.SETRANGE(Absence, FALSE);
      WorkTypeCode.FIND('-');
      EXIT(WorkTypeCode.Code);
    END;

    BEGIN
    END.
  }
}

OBJECT Codeunit 83003 Clocking Calculation
{
  OBJECT-PROPERTIES
  {
    Date=20.04.17;
    Time=16:08:18;
    Modified=Yes;
    Version List=OPC (RSI);
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    PROCEDURE FillTable@1000000001(FromDate@1000000002 : Date;ToDate@1000000003 : Date);
    VAR
      PaymentTable@1000000000 : Record 83006;
      MachineCenter@1000000001 : Record 99000758;
      WorkTypeCode@1000000004 : Record 83004;
      Window@1000000006 : Dialog;
      Qty@1000000005 : Decimal;
    BEGIN

      PaymentTable.DELETEALL;

      Window.OPEN('Beregner for #1##########');

      MachineCenter.RESET;
      MachineCenter.SETRANGE(Clocking, TRUE);
      MachineCenter.SETRANGE("Date Filter", FromDate, ToDate);
      IF MachineCenter.FIND('-') THEN
        REPEAT

          MachineCenter.TESTFIELD("Employee No.");

          Window.UPDATE(1, MachineCenter."No.");

          WorkTypeCode.RESET;
          WorkTypeCode.SETFILTER("Payment Type", '<>%1', '');
          IF WorkTypeCode.FIND('-') THEN
            REPEAT
              Qty := GetSum( WorkTypeCode, MachineCenter);

              IF Qty <> 0 THEN BEGIN

                PaymentTable.INIT;
                PaymentTable."Machine Center No." := MachineCenter."No.";
                PaymentTable."Work Type Code" := WorkTypeCode.Code;
                PaymentTable."Employee No." := MachineCenter."Employee No.";
                PaymentTable."Employee Name" := MachineCenter.Name;
                PaymentTable."Payment Type" := WorkTypeCode."Payment Type";
                PaymentTable.Quantity := Qty;
                PaymentTable.INSERT;

              END;

            UNTIL WorkTypeCode.NEXT = 0;
        UNTIL MachineCenter.NEXT = 0;

      Window.CLOSE;
    END;

    PROCEDURE GetSum@1000000000(VAR WorkTypeCode@1000000000 : Record 83004;VAR MachineCenter@1000000001 : Record 99000758) : Decimal;
    BEGIN
      WITH WorkTypeCode DO BEGIN
        SETRANGE("Machine Center Filter", MachineCenter."No.");
        SETFILTER("Date Filter", MachineCenter.GETFILTER("Date Filter"));
        CALCFIELDS("Time Registered");

        EXIT("Time Registered");
      END;
    END;

    BEGIN
    END.
  }
}

OBJECT Codeunit 83004 Post Output
{
  OBJECT-PROPERTIES
  {
    Date=20.04.17;
    Time=16:08:18;
    Modified=Yes;
    Version List=OPC (RSI);
  }
  PROPERTIES
  {
    TableNo=83007;
    OnRun=BEGIN
            TESTFIELD("End Date");
            TESTFIELD("End Time");
            PostOutput("Machine Center", "End Date", "End Time");
          END;

  }
  CODE
  {
    VAR
      MachineCenter@1000000000 : Record 99000758;

    LOCAL PROCEDURE PostOutput@1000000000(MachineCenter@1000000002 : Code[20];EndDate@1000000004 : Date;EndTime@1000000005 : Time);
    VAR
      RunTimes@1000000001 : Record 83010;
      ProdOrderLine@1000000003 : Record 5406;
      ProdOrderRoutingLine@1000000010 : Record 5409;
      ItemJnlLine@1000000000 : Record 83;
      ItemJnlPostLine@1000000006 : Codeunit 22;
      DimMgt@1000000009 : Codeunit 408;
    BEGIN
      RunTimes.RESET;
      RunTimes.SETRANGE("Machine Center", MachineCenter);
      RunTimes.SETFILTER("Starting Date", '<>%1', 0D);
      RunTimes.SETFILTER("Starting Time", '<>%1', 0T);
      RunTimes.SETRANGE("Ending Time", 0T);
      RunTimes.SETRANGE(Post,  FALSE);
      IF RunTimes.FINDFIRST THEN
      REPEAT
        ProdOrderLine.SETRANGE(Status, ProdOrderLine.Status::Released);
        ProdOrderLine.SETRANGE("Prod. Order No.", RunTimes."Prod. Order No.");
        ProdOrderLine.SETRANGE("Routing No.", RunTimes."Routing No.");
        IF ProdOrderLine.FIND('-') THEN
          REPEAT
            ItemJnlLine.INIT;
            ItemJnlLine.CopyDim(ProdOrderLine."Dimension Set ID"); //JAL
            ItemJnlLine."Posting Date" := EndDate;
            ItemJnlLine."Document Date" := EndDate;
            ItemJnlLine."Entry Type" := ItemJnlLine."Entry Type"::Output;
            ItemJnlLine."Operation No." := RunTimes."Operation No.";
            ItemJnlLine.Type := ItemJnlLine.Type::"Machine Center";
            ItemJnlLine.VALIDATE("No.", MachineCenter);
            ItemJnlLine.VALIDATE("Order Type", ItemJnlLine."Order Type"::Production);
            ItemJnlLine.VALIDATE("Order No.", RunTimes."Prod. Order No.");
            ItemJnlLine.VALIDATE("Order Line No.", ProdOrderLine."Line No.");
            ItemJnlLine.VALIDATE("Item No.", ProdOrderLine."Item No.");
            ItemJnlLine."Starting Time" := RunTimes."Starting Time";
            ItemJnlLine."Ending Time" := EndTime;
            ItemJnlLine.VALIDATE("Run Time", ROUND(CalculateTime(RunTimes."Starting Date",
              RunTimes."Starting Time", EndDate, EndTime),0.01,'='));

            ItemJnlPostLine.RunWithCheck(ItemJnlLine);

            ProdOrderRoutingLine.RESET;
            ProdOrderRoutingLine.SETRANGE(Status, ProdOrderRoutingLine.Status::Released);
            ProdOrderRoutingLine.SETRANGE("Prod. Order No.", RunTimes."Prod. Order No.");
            ProdOrderRoutingLine.SETRANGE("Routing No.", RunTimes."Routing No.");
            ProdOrderRoutingLine.SETRANGE("Operation No.", RunTimes."Operation No.");
            ProdOrderRoutingLine.SETRANGE(Type, ProdOrderRoutingLine.Type::"Machine Center");
            IF ProdOrderRoutingLine.FIND('-') THEN
              RunTimes."Work done at M.C." := ProdOrderRoutingLine."No.";

            RunTimes."Ending Date" := EndDate;
            RunTimes."Ending Time" := EndTime;
            RunTimes."Finish Now" := TRUE;
            RunTimes.Post := TRUE;
            RunTimes.MODIFY;

          UNTIL ProdOrderLine.NEXT = 0;

      UNTIL RunTimes.NEXT = 0;
    END;

    LOCAL PROCEDURE CalculateTime@1000000001(StartDate@1000000003 : Date;StartTime@1000000002 : Time;EndDate@1000000001 : Date;EndTime@1000000000 : Time) : Decimal;
    BEGIN
      IF (EndTime <> 0T) AND (StartTime <> 0T)
        AND (EndDate <> 0D) AND (StartDate <> 0D) THEN
          EXIT(((EndDate - StartDate) * 1440) + ((EndTime - StartTime) / 60000))
      ELSE
        EXIT(0);
    END;

    BEGIN
    END.
  }
}

OBJECT Page 83001 OPC - Information board
{
  OBJECT-PROPERTIES
  {
    Date=20.04.17;
    Time=16:08:18;
    Modified=Yes;
    Version List=OPC2.0;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=OPC - Information board;
               NOR=OPC - informasjonssentral];
    SourceTable=Table99000758;
    SourceTableView=SORTING(No.)
                    ORDER(Ascending)
                    WHERE(Show in OPC=FILTER(Yes));
    PageType=List;
    TimerUpdate=2000;
    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000000;1 ;Action    ;
                      Name=Time Register Card;
                      CaptionML=[ENU=Registration Card;
                                 NOR=M›nstringskort];
                      RunObject=Page 83015;
                      RunPageOnRec=No;
                      Promoted=Yes;
                      Visible=false;
                      PromotedIsBig=Yes;
                      Image=Timesheet;
                      PromotedCategory=Process }
      { 1000000003;1 ;Action    ;
                      Name=Planlagte oppgaver;
                      CaptionML=[ENU=Planned tasks;
                                 NOR=Planlagte oppgaver];
                      RunObject=Page 83023;
                      RunPageOnRec=No;
                      RunPageLink=No.=FIELD(No.),
                                  Status=CONST(Firm Planned);
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PlanningWorksheet;
                      PromotedCategory=Process }
      { 11      ;1   ;Action    ;
                      Name=Internal activities;
                      CaptionML=[ENU=Internal activities;
                                 NOR=Ikke prod. tid];
                      RunPageOnRec=No;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=AbsenceCategory;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 NonProdTime@1101103000 : Page 83028;
                               BEGIN
                                 CLEAR(NonProdTime);
                                 NonProdTime.InitForm("No.");
                                 NonProdTime.RUN;
                               END;
                                }
      { 1000000001;1 ;Action    ;
                      Name=Tasks;
                      CaptionML=[ENU=Tasks;
                                 NOR=Oppgaver];
                      RunObject=Page 83002;
                      RunPageOnRec=No;
                      RunPageLink=No.=FIELD(No.),
                                  Status=CONST(Released);
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=TaskList;
                      PromotedCategory=Process }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1101103000;1;Group  ;
                GroupType=Group }

    { 1101103001;2;Field  ;
                Name=PingPong;
                Visible=false;
                Enabled=false;
                Editable=false;
                ControlAddIn=[Microsoft.Dynamics.Nav.Client.PingPong;PublicKeyToken=31bf3856ad364e35] }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                SourceExpr="No." }

    { 4   ;2   ;Field     ;
                SourceExpr=Name }

    { 1000000002;1;Part   ;
                Name=OPC - melding p† info.sentral;
                SubPageView=SORTING(Entry No.)
                            ORDER(Ascending);
                PagePartID=Page83003;
                ProviderID=2;
                Editable=false }

  }
  CODE
  {
    VAR
      OPCOppsett@1000000000 : Record 83001;
      FerdigMeldKladdLinje@1000000001 : Record 83;
      OPCInformationMessageG@1101103000 : Record 83002;

    EVENT PingPong@-1101103001::AddInReady@2();
    BEGIN
      CurrPage.PingPong.Ping(1000);
    END;

    EVENT PingPong@-1101103001::Pong@3();
    BEGIN
      CurrPage."OPC - melding p† info.sentral".PAGE.UpdatePage();
      CurrPage.UPDATE(FALSE);
      CurrPage.PingPong.Ping(1000);
    END;

    BEGIN
    {
      +-------------------------------------+
      | SI-Data                             |
      +-------------------------------------+
      Nr. Dato     Id  Beskrivelse
      01. 14.12.05 HHE Endret oppslag p† knapp="indirekte tid"
      02  29.03.06 ASL Endret p† oppslag Ikke produktiv tid
      03. 03.04.06 HHE sub-frm: melding p† Info.sentral - endret "glue" til right/bottom. Samme med Ress.liste (vert= Both)
      04. 15.12.06 HHE Utvidet antall tekstlinjer p† Oppslagstavle (8->15 linjer)
      05. 17.06.09 HHE Ny knapp:"Planlagte oppgaver"  (›nsket av PTL)
      06. 14.11.16 JAL Added PingPong control to refresh message every 30 seconds.
    }
    END.
  }
}

OBJECT Page 83002 OPC - Tasklist
{
  OBJECT-PROPERTIES
  {
    Date=20.04.17;
    Time=16:08:18;
    Modified=Yes;
    Version List=OPC1.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=OPC - Tasklist;
               NOR=OPC - Oppgaveliste];
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=No;
    SourceTable=Table5409;
    SourceTableView=SORTING(Type,No.,Starting Date)
                    ORDER(Ascending)
                    WHERE(Type=FILTER(Machine Center),
                          Routing Status=FILTER(<>Finished));
    DataCaptionFields=No.;
    PageType=List;
    RefreshOnActivate=Yes;
    OnAfterGetRecord=BEGIN
                       CLEAR(WarningIndex);
                       CLEAR(OrgQty);
                       ProdOrderLineG.SETRANGE(Status, ProdOrderLineG.Status::Released);
                       ProdOrderLineG.SETRANGE("Prod. Order No.", "Prod. Order No.");
                       ProdOrderLineG.SETRANGE("Routing No.", "Routing No.");

                       IF ProdOrderLineG.FINDFIRST THEN BEGIN
                         OrgQty := ProdOrderLineG.Quantity;
                         IF ItemG.GET(ProdOrderLineG."Item No.") THEN BEGIN
                           VareNr := ItemG."No.";
                           VareBesk := ItemG.Description;
                           ProdOrderComponentG.RESET;
                           ProdOrderComponentG.SETRANGE(Status,Status::Released);
                           ProdOrderComponentG.SETRANGE("Prod. Order No.", "Prod. Order No.");
                           ProdOrderComponentG.SETRANGE("Routing Link Code","Routing Link Code");

                           IF ProdOrderComponentG.FINDFIRST THEN
                             REPEAT
                               CLEAR(ItemInventory);
                               CLEAR(Item);
                               IF Item.GET(ProdOrderComponentG."Item No.") THEN BEGIN
                                 Item.SETRANGE("Location Filter", ProdOrderComponentG."Location Code");
                                 Item.CALCFIELDS(Inventory);
                                 ItemInventory := Item.Inventory;
                                 IF (ItemInventory - ProdOrderComponentG."Remaining Quantity") < 0 THEN
                                   WarningIndex := 1;
                               END;
                             UNTIL ProdOrderComponentG.NEXT = 0;
                         END;
                       END;
                       RemQty := OrgQty - "Finished Qty";
                       IF WarningIndex = 1 THEN BEGIN
                         OPCSetupG.GET;
                         OPCSetupG.CALCFIELDS("Warning Picture");
                       END
                       ELSE
                         OPCSetupG.INIT;
                       IF "Expected Capacity Need" <> 0 THEN
                         ExpectedCapacityNeedG := ("Expected Capacity Need"/1000/60/60)
                       ELSE
                         ExpectedCapacityNeedG := 0;
                     END;

    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000017;1 ;Action    ;
                      Name=Move Components;
                      CaptionML=[ENU=Move Components;
                                 NOR=Flytt komponenter];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=TransferToLines;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 OPCSetup@1000000003 : Record 83001;
                                 ProdRessurs@1000000004 : Record 99000758;
                               BEGIN
                                 //012->
                                 ProdRessurs.GET("No.");
                                 IF NOT ProdRessurs."Allow OPC Move" THEN
                                   ERROR('Denne produksjonsressursen kan ikke benytte denne funksjonen');
                                 //012<-
                                 //011->
                                 OPCSetup.GET;
                                 ProdOrderCompG.SETRANGE(Status, Status);
                                 ProdOrderCompG.SETRANGE("Prod. Order No.", "Prod. Order No.");
                                 ProdOrderCompG.SETRANGE("Location Code", OPCSetup."OPC-Move Location Code");
                                 IF ProdOrderCompG.FINDFIRST THEN
                                   ERROR('Du kan ikke bruke denne funksjonen n†r komponentene har Lokasjonskode %1',OPCSetup."OPC-Move Location Code");
                                 //011<-
                                 //bygger opp filter for hva som skal synes i "OPC-Move components"
                                 CLEAR(ProdOrderCompG);
                                 ProdOrderCompG.SETRANGE(Status, Status);
                                 ProdOrderCompG.SETRANGE("Prod. Order No.", "Prod. Order No.");
                                 PAGE.RUNMODAL(PAGE::"OPC - Move components", ProdOrderCompG);
                                 CLEAR(ProdOrderCompG); //hhe: for † l›se opp i filter som skapte feilmelding p† "Stykkliste"-knapp
                               END;
                                }
      { 1000000008;1 ;Action    ;
                      Name=Prod. Order Rtng. Comment;
                      CaptionML=[ENU=Comments;
                                 NOR=Merknader];
                      RunObject=Page 99000840;
                      RunPageLink=Status=FIELD(Status),
                                  Prod. Order No.=FIELD(Prod. Order No.),
                                  Routing Reference No.=FIELD(Routing Reference No.),
                                  Routing No.=FIELD(Routing No.),
                                  Operation No.=FIELD(Operation No.);
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Comment;
                      PromotedCategory=Process }
      { 1000000004;1 ;Action    ;
                      Name=Relationship;
                      CaptionML=NOR=&Tilknyttet dokument;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Relationship;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 HYPERLINK("Dokument Link");
                               END;
                                }
      { 1000000005;1 ;Action    ;
                      Name=Stykkliste;
                      CaptionML=[ENU=BOM List;
                                 NOR=Stykkliste];
                      RunObject=Page 83004;
                      RunPageView=WHERE(Status=FILTER(Released),
                                        Prod. Order Line No.=CONST(10000));
                      RunPageLink=Prod. Order No.=FIELD(Prod. Order No.);
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=BOM;
                      PromotedCategory=Process;
                      RunPageMode=View }
      { 1000000006;1 ;Action    ;
                      Name=Start/Stop Time;
                      CaptionML=[ENU=Start/Stop Time;
                                 NOR=Start/stopp tid];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Start;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 OPCOppsett@1000000006 : Record 83001;
                                 RunTimesL@1000000005 : Record 83010;
                                 RunTimesNewL@1101103001 : Record 83010;
                                 "--Kommentertbort--"@1000000004 : Integer;
                                 ProdOrdreLinje@1000000003 : Record 5406;
                                 Vare@1000000002 : Record 27;
                                 FerdigmeldAntall@1000000001 : Decimal;
                                 FerdigMeldKladdLinje@1000000000 : Record 83;
                                 Mach_on_Op@1101103000 : Page 83008;
                                 EntryNoL@1101103002 : Integer;
                               BEGIN
                                 //sjekker om maskinen allerede er innlogget p† operasjonen->
                                 IF RunTimesNewL.FINDLAST THEN
                                   EntryNoL :=  RunTimesNewL."Entry No." + 1
                                 ELSE
                                   EntryNoL := 1;

                                 RunTimesNewL.RESET;
                                 RunTimesNewL.SETRANGE("Prod. Order No.", Rec."Prod. Order No.");
                                 RunTimesNewL.SETRANGE("Operation No.", Rec."Operation No.");
                                 RunTimesNewL.SETRANGE("Machine Center", "No.");
                                 RunTimesNewL.SETRANGE("Ending Date", 0D);
                                 IF NOT RunTimesNewL.FINDFIRST THEN BEGIN
                                   //Set value for Machine Center it does not exists.
                                   RunTimesNewL.INIT;
                                   RunTimesNewL."Entry No." := EntryNoL;
                                   RunTimesNewL.VALIDATE("Prod. Order No.", Rec."Prod. Order No.");
                                   RunTimesNewL.VALIDATE("Routing No.", Rec."Routing No.");
                                   RunTimesNewL.VALIDATE("Operation No.", Rec."Operation No.");
                                   RunTimesNewL.VALIDATE("Machine Center", Rec."No.");
                                   RunTimesNewL.INSERT(TRUE);
                                   COMMIT;
                                 END;

                                 RunTimesL.SETRANGE("Prod. Order No.",  "Prod. Order No.");
                                 RunTimesL.SETRANGE("Routing No.",  "Routing No.");
                                 RunTimesL.SETRANGE("Operation No.",  "Operation No.");
                                 RunTimesL.SETFILTER("Ending Date", '=%1', 0D);
                                 RunTimesL.SETFILTER("Ending Time", '=%1', 0T);

                                 CLEAR(Mach_on_Op);
                                 Mach_on_Op.InitForm("No.", '');
                                 Mach_on_Op.SETTABLEVIEW(RunTimesL);
                                 Mach_on_Op.RUNMODAL;
                               END;
                                }
      { 1000000007;1 ;Action    ;
                      Name=PostOutputItem;
                      CaptionML=[ENU=Post Output;
                                 NOR=Ferdigmeld];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=ReleaseShipment;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 ClockingMgtG.PostOutputItem(Rec);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                Editable=FALSE;
                GroupType=Repeater }

    { 10  ;2   ;Field     ;
                SourceExpr="Starting Date" }

    { 16  ;2   ;Field     ;
                SourceExpr="Prod. Order No." }

    { 2   ;2   ;Field     ;
                CaptionML=[ENU=Operation No.;
                           NOR=Op.nr.];
                SourceExpr="Operation No." }

    { 1000000000;2;Field  ;
                CaptionML=NOR=Varenr.;
                SourceExpr=VareNr }

    { 1000000002;2;Field  ;
                CaptionML=NOR=Varebeskr.;
                SourceExpr=VareBesk }

    { 6   ;2   ;Field     ;
                CaptionML=[ENU=Description;
                           NOR=Operasj.beskr.];
                SourceExpr=Description }

    { 1101103001;2;Field  ;
                Name=Warning;
                CaptionML=[ENU=Warning;
                           NOR=Varsel];
                SourceExpr=OPCSetupG."Warning Picture";
                Editable=false }

    { 1000000013;2;Field  ;
                CaptionML=[ENU=Ordred qty.;
                           NOR=Ordreantall];
                DecimalPlaces=0:0;
                SourceExpr=OrgQty }

    { 18  ;2   ;Field     ;
                CaptionML=[ENU=Planned qty;
                           NOR=Planlagt];
                SourceExpr="Input Quantity";
                Visible=FALSE }

    { 22  ;2   ;Field     ;
                CaptionML=[ENU=Finished Quantity;
                           NOR=Ferdig];
                DecimalPlaces=0:2;
                SourceExpr="Finished Qty" }

    { 1000000015;2;Field  ;
                CaptionML=[ENU=Remaining Qty;
                           NOR=Restantall];
                DecimalPlaces=0:0;
                SourceExpr=RemQty;
                Style=Standard;
                StyleExpr=TRUE }

    { 1101103003;2;Field  ;
                CaptionML=[ENU=Expected Capacity Need;
                           NOR=Forventet kapasitetsbehov];
                SourceExpr=ExpectedCapacityNeedG }

    { 1101103002;2;Field  ;
                SourceExpr="Expected Capacity Need";
                Visible=false }

    { 26  ;2   ;Field     ;
                DecimalPlaces=0:2;
                SourceExpr="Actual Run Time" }

    { 24  ;2   ;Field     ;
                SourceExpr="Dokument Link" }

  }
  CODE
  {
    VAR
      ProdOrderLineG@1000000000 : Record 5406;
      ItemG@1000000001 : Record 27;
      ProdOrderComponentG@1101103002 : Record 5407;
      ProdOrderCompG@1101103001 : Record 5407;
      OPCSetupG@1101103003 : Record 83001;
      ClockingMgtG@1101103000 : Codeunit 83001;
      VareBesk@1000000002 : Text[50];
      VareNr@1000000003 : Text[50];
      WarningIndex@1000000015 : Integer;
      ItemInventory@1000000017 : Decimal;
      Item@1000000018 : Record 27;
      OrgQty@1000000020 : Decimal;
      RemQty@1000000021 : Decimal;
      ExpectedCapacityNeedG@1101103004 : Decimal;

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01 15.12.05  ASL Tar med vrakantall + vrakkode fra ferdigmelding
      02 15.12.05  HHE Fjernet kolonnen "Arb.senter", Forkortet til "Op.nr."
                            Frm:Insert/delete/modify = No
                            Satt kolonnen "Startdato" fremst
                            Knapp= Stykkliste->sl†r opp i ny BESKYTTET frm (ikke som f›r = std. stk.l. p† p.o.)
                            Ny knapp = Merknader (tekst fra stamrute->p.o.rute->OPC)
      03 01.03.06  HHE Overf›rer Lokasjonskoden fra Prod.o.linjen til f.meld.kladden
      04 05.05.06  HHE Byttet ut kode p† "Tilknyttet dokument"
      05 19.05.06  HHE Kode for auto.innlegg av maskin
      06 30.01.07  HHE Routing StatusFILTER<>Finished
      07 28.06.07  HHE Knapp=Stykkliste ->Properties=RunFormView:WHERE(Status=FILTER(Released),Prod. Order Line No.=CONST(10000))
      08 30.04.08  HEI Vrakkode 2 og 3. Henter fra FromFerdigMeld, og bokf›rer hvis de har verdi
      09 06.02.09  BVM Fremvist operasjonstid og nytt felt for Antall, endret ledetekst p† planlagtantall til restantall
      10 17.08.10  HHE Ny knapp: Flytt komponenter
      11 19.08.10  HHE Sjekker om Lokasjonskode p† komponenter er ULIK OPC-flytt-lokasjon i OPC Setup
      12 19.08.10  HHE Sjekker om det er tillatt † flytte komponenter via denne Prod.ressurs
    }
    END.
  }
}

OBJECT Page 83003 OPC - melding p† info.sentral
{
  OBJECT-PROPERTIES
  {
    Date=20.04.17;
    Time=16:08:18;
    Modified=Yes;
    Version List=OPC2.0;
  }
  PROPERTIES
  {
    SourceTable=Table83002;
    PageType=CardPart;
    TimerUpdate=60000;
    RefreshOnActivate=Yes;
    OnClosePage=BEGIN
                  IF CurrPage.EDITABLE THEN
                    Rec.MODIFYALL("Last Modified", CURRENTDATETIME);
                END;

    OnInsertRecord=BEGIN
                     Rec."Entry No." := Rec.GetNextEntryNo() ;
                   END;

  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1101103001;1;Group  ;
                GroupType=Group }

    { 1101103002;2;Field  ;
                Name=PingPong;
                ControlAddIn=[Microsoft.Dynamics.Nav.Client.PingPong;PublicKeyToken=31bf3856ad364e35] }

    { 1101103000;1;Group  ;
                GroupType=Repeater }

    { 1000000003;2;Field  ;
                SourceExpr=Description }

  }
  CODE
  {

    PROCEDURE UpdatePage@1101103000();
    VAR
      OPCInformationMessageL@1101103000 : Record 83002;
    BEGIN
      IF OPCInformationMessageL.FINDLAST THEN
        IF Rec."Last Modified" <> OPCInformationMessageL."Last Modified" THEN
          CurrPage.ACTIVATE(TRUE);
    END;

    EVENT PingPong@-1101103002::AddInReady@2();
    BEGIN
      CurrPage.PingPong.Ping(10000);
    END;

    EVENT PingPong@-1101103002::Pong@3();
    BEGIN
      IF NOT CurrPage.EDITABLE THEN
        UpdatePage();

      CurrPage.PingPong.Ping(10000);
    END;

    BEGIN
    {
      +--------------------------------------------------+
      | SI-Data                                          |
      +--------------------------------------------------+
      Nr. Dato      Id   Beskrivelse
      01. 23.03.06  HHE  Endret timer fra 5 sek. til 60 sek
      02. 15.12.06  HHE  Lagt til tekstlinje 11-15
    }
    END.
  }
}

OBJECT Page 83006 OPC Activities
{
  OBJECT-PROPERTIES
  {
    Date=20.04.17;
    Time=16:08:18;
    Modified=Yes;
    Version List=OPC;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Activities;
               NOR=Aktiviteter];
    SourceTable=Table83013;
    PageType=CardPart;
    OnOpenPage=BEGIN
                 RESET;
                 IF NOT GET THEN BEGIN
                   INIT;
                   INSERT;
                 END;

                 //SETRANGE("User ID Filter", USERID);
               END;

  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 2   ;1   ;Group     ;
                CaptionML=[ENU=OPC;
                           NOR=OPC];
                GroupType=CueGroup;
                ActionList=ACTIONS
                {
                  { 21      ;0   ;Action    ;
                                  CaptionML=[ENU=Change Production Order Status;
                                             NOR=Endre produksjonsordrestatus];
                                  RunObject=Page 99000914;
                                  Image=ChangeStatus }
                  { 12      ;0   ;Action    ;
                                  CaptionML=[ENU=New Production Order;
                                             NOR=Ny produksjonsordre];
                                  RunObject=Page 99000813;
                                  RunPageMode=Create }
                  { 28      ;0   ;Action    ;
                                  CaptionML=[ENU=Navigate;
                                             NOR=Naviger];
                                  RunObject=Page 344;
                                  Image=Navigate }
                  { 1101103001;  ;Action    ;
                                  Name=OPC - Information board;
                                  CaptionML=[ENU=OPC - Information board;
                                             NOR=OPC - informasjonssentral];
                                  RunObject=Page 83001;
                                  Promoted=Yes;
                                  PromotedIsBig=Yes;
                                  Image=Production;
                                  PromotedCategory=Process }
                }
                 }

    { 1   ;2   ;Field     ;
                SourceExpr="Resource Status";
                DrillDownPageID=OPC - ressursstatus }

    { 5   ;2   ;Field     ;
                SourceExpr="Production Order- Released";
                DrillDownPageID=Released Production Orders }

    { 1101103000;2;Field  ;
                SourceExpr="Firm planned tasks";
                DrillDownPageID=OPC - Firm planned tasks }

  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Page 83008 Machine Center on Operation
{
  OBJECT-PROPERTIES
  {
    Date=20.04.17;
    Time=16:08:18;
    Modified=Yes;
    Version List=OPC2.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Machine Center on Operation;
               NOR=Prod.ress. p† operasjonen];
    SourceTable=Table83010;
    DataCaptionFields=Description;
    PageType=Card;
    OnAfterGetRecord=BEGIN
                       //rsi/hhe 20.04.06->
                       GetItemInfo();
                       //rsi/hhe 20.04.06<-
                     END;

    OnInsertRecord=VAR
                     recOperasjonstider@1000000001 : Record 83010;
                   BEGIN
                     IF recOperasjonstider.FINDLAST THEN
                       "Entry No." := recOperasjonstider."Entry No." + 1
                     ELSE
                       "Entry No." := 1;
                     IF MachineCenterNoG <> '' THEN    // 002 ASL 29.03.06
                       "Work done at M.C." := MachineCenterNoG; // 002 ASL 29.03.06

                     //hhe 19.05.06->
                     //dersom det legges inn en ressurs p† en oppgave som ikke er Indir.prod.
                     // IF (NoneProducingTimeCodeG = '') THEN BEGIN
                     //  //sjekker om maskinen allerede er innlogget p† operasjonen->
                     //  RunTimesG.RESET;
                     //  RunTimesG.SETRANGE("Prod. Order No.", Rec."Prod. Order No.");
                     //  RunTimesG.SETRANGE("Operation No.", Rec."Operation No.");
                     //  RunTimesG.SETRANGE("Machine Center", MachineCenterNoG);
                     //  RunTimesG.SETRANGE("Ending Date", 0D);
                     //  IF NOT RunTimesG.FINDFIRST THEN BEGIN
                     //    //Set value for Machine Center it does not exists.
                     //    RunTimesG.INIT;
                     //    RunTimesG."Entry No." := Rec."Entry No.";
                     //    RunTimesG.VALIDATE("Prod. Order No.", Rec."Prod. Order No.");
                     //    RunTimesG.VALIDATE("Routing No.", Rec."Routing No.");
                     //    RunTimesG.VALIDATE("Operation No.", Rec."Operation No.");
                     //    RunTimesG.VALIDATE("Machine Center", MachineCenterNoG);
                     //    RunTimesG.INSERT(TRUE);
                     //    Rec."Entry No." := Rec."Entry No." + 1;
                     //    CurrPage.UPDATE(FALSE);
                     //  END;
                     // END;
                     //hhe 19.05.06<-
                   END;

    OnQueryClosePage=BEGIN
                       //010 BVM-->
                       ClockingMgtG.DeleteBlankRunTimes(Rec);
                       //010 BVM--<
                     END;

    OnAfterGetCurrRecord=BEGIN
                           OutPutQtyG := OutPutQtyG;
                           ScrapQtyG := ScrapQtyG;
                           ScrapQty2G := ScrapQty2G;
                           ScrapQty3G := ScrapQty3G;
                           ScrapCodeG := ScrapCodeG;
                           ScrapCode2G := ScrapCode2G;
                           ScrapCode3G := ScrapCode3G;
                           ScrapCommentG := ScrapCommentG;
                           ScrapComment2G := ScrapComment2G;
                           ScrapComment3G := ScrapComment3G;
                           OpDescriptionG := OpDescriptionG;
                           MachineNameG := MachineCenterG.Name;
                           ProdOrderNoG := ProdOrderNoG;
                           ItemNoG := ItemNoG;
                           ItemDescriptionG := ItemDescriptionG;
                         END;

    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000001;1 ;Action    ;
                      Name=RegisterTimeInJournal;
                      CaptionML=[ENU=Register;
                                 NOR=Registrer];
                      Promoted=Yes;
                      Image=Register;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 recOperasjonstider@1000000004 : Record 83010;
                                 OPCOppsett@1000000003 : Record 83001;
                                 ProdOrdreLinje@1000000002 : Record 5406;
                                 Vare@1000000001 : Record 27;
                                 FerdigMeldKladdLinje@1000000000 : Record 83;
                                 StemplTid@1000000006 : Record 83009;
                                 ProdO_ruteLinje@1000000007 : Record 5409;
                               BEGIN
                                 ClockingMgtG.RegisterTimeInJournal(Rec, OutPutQtyG, ScrapQtyG, ScrapCodeG,
                                                                    ScrapQty2G, ScrapCode2G, ScrapQty3G, ScrapCode3G,
                                                                    ScrapCommentG, ScrapComment2G, ScrapComment3G);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1101103000;1;Group  ;
                GroupType=Group }

    { 1101104016;2;Field  ;
                CaptionML=[ENU=Machine Center;
                           NOR=Produksjonsressurs];
                SourceExpr=MachineNameG;
                Enabled=FALSE;
                Editable=FALSE }

    { 1101104001;2;Field  ;
                CaptionML=[ENU=Prod. Order No.;
                           NOR=Prod.ordrenr.];
                SourceExpr=ProdOrderNoG;
                Enabled=FALSE;
                Editable=FALSE }

    { 1101104003;2;Field  ;
                CaptionML=[ENU=Item No.;
                           NOR=Varenr.];
                SourceExpr=ItemNoG;
                Enabled=FALSE;
                Editable=FALSE }

    { 1101104005;2;Field  ;
                CaptionML=[ENU=Description;
                           NOR=Varebeskrivelse];
                SourceExpr=ItemDescriptionG;
                Enabled=FALSE;
                Editable=FALSE }

    { 1101104013;2;Field  ;
                CaptionML=[ENU=Operation Description;
                           NOR=Operasjonsbeskrivelse];
                SourceExpr=OpDescriptionG;
                Enabled=FALSE;
                Editable=FALSE;
                Style=Standard;
                StyleExpr=TRUE }

    { 1101104007;2;Field  ;
                Name=FerdigMeld;
                CaptionML=[ENU=Output Quantity;
                           NOR=Ferdigmeld antall];
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=OutPutQtyG;
                Style=Standard;
                StyleExpr=TRUE;
                OnValidate=BEGIN
                             CheckQuantity();
                           END;
                            }

    { 1101104008;2;Field  ;
                Name=VrakAntall;
                CaptionML=[ENU=Scrap Quantity;
                           NOR=Vraket antall];
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=ScrapQtyG;
                OnValidate=BEGIN
                             CheckQuantity();
                           END;
                            }

    { 1101104009;2;Field  ;
                Name=Vrakkode;
                CaptionML=[ENU=Scrap Code;
                           NOR=Vrakkode];
                SourceExpr=ScrapCodeG;
                OnLookup=VAR
                           Scrap@1000000000 : Record 99000762;
                           ScrapCodes@1101103001 : Page 99000780;
                         BEGIN
                           Scrap.RESET;
                           CLEAR(Scrap);
                           ScrapCodes.SETTABLEVIEW(Scrap);
                           ScrapCodes.LOOKUPMODE(TRUE);
                           IF ScrapCodes.RUNMODAL = ACTION::LookupOK THEN BEGIN
                             ScrapCodes.GETRECORD(Scrap);
                             ScrapCodeG := Scrap.Code;
                           END;
                         END;
                          }

    { 1000000012;2;Field  ;
                Name=ScrapComment;
                CaptionML=[ENU=Scrap Code;
                           NOR=Kommentar til Vrakkode];
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=ScrapCommentG }

    { 1000000000;2;Field  ;
                Name=VrakAntall 2;
                CaptionML=[ENU=Scrap Quantity;
                           NOR=Vraket ant. (type 2)];
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=ScrapQty2G;
                Visible=false;
                OnValidate=BEGIN
                             CheckQuantity();
                           END;
                            }

    { 1000000004;2;Field  ;
                Name=Vrakkode2;
                CaptionML=[ENU=Scrap Code;
                           NOR=Vrakkode(type2)];
                SourceExpr=ScrapCode2G;
                Visible=false;
                OnLookup=VAR
                           Scrap@1000000000 : Record 99000762;
                           ScrapCodes@1101103001 : Page 99000780;
                         BEGIN
                           //hhe 12.10.07->
                           Scrap.RESET;
                           CLEAR(Scrap);
                           ScrapCodes.SETTABLEVIEW(Scrap);
                           ScrapCodes.LOOKUPMODE(TRUE);
                           IF ScrapCodes.RUNMODAL = ACTION::LookupOK THEN BEGIN
                             ScrapCodes.GETRECORD(Scrap);
                             ScrapCode2G := Scrap.Code;
                           END;
                           //hhe 12.10.07<-
                         END;
                          }

    { 1000000013;2;Field  ;
                Name=ScrapComment2;
                CaptionML=[ENU=Scrap Code;
                           NOR=Kommentar til Vrakkode(type2)];
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=ScrapComment2G;
                Visible=false }

    { 1000000007;2;Field  ;
                Name=VrakAntall 3;
                CaptionML=[ENU=Scrap Quantity;
                           NOR=Vraket ant. (type 3)];
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=ScrapQty3G;
                Visible=false;
                OnValidate=BEGIN
                             CheckQuantity();
                           END;
                            }

    { 1000000006;2;Field  ;
                Name=Vrakkode3;
                CaptionML=[ENU=Scrap Code;
                           NOR=Vrakkode(type3)];
                SourceExpr=ScrapCode3G;
                Visible=false;
                OnLookup=VAR
                           Scrap@1000000000 : Record 99000762;
                           ScrapCodes@1101103001 : Page 99000780;
                         BEGIN
                           //hhe 12.10.07->
                           Scrap.RESET;
                           CLEAR(Scrap);
                           ScrapCodes.SETTABLEVIEW(Scrap);
                           ScrapCodes.LOOKUPMODE(TRUE);
                           IF ScrapCodes.RUNMODAL = ACTION::LookupOK THEN BEGIN
                             ScrapCodes.GETRECORD(Scrap);
                             ScrapCode3G := Scrap.Code;
                           END;
                           //hhe 12.10.07<-
                         END;
                          }

    { 1000000014;2;Field  ;
                Name=ScrapComment3;
                CaptionML=[ENU=Scrap Code;
                           NOR=Kommentar til Vrakkode(type3)];
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=ScrapComment3G;
                Visible=false }

    { 1   ;1   ;Group     ;
                Editable=TRUE;
                GroupType=Repeater }

    { 10  ;2   ;Field     ;
                SourceExpr="Machine Center";
                OnValidate=BEGIN
                             MachineCenterOnAfterValidate;
                           END;
                            }

    { 12  ;2   ;Field     ;
                SourceExpr=Description;
                Editable=FALSE }

    { 1000000015;2;Field  ;
                SourceExpr="Stop Code" }

    { 14  ;2   ;Field     ;
                SourceExpr="Starting Date" }

    { 16  ;2   ;Field     ;
                SourceExpr="Starting Time" }

    { 18  ;2   ;Field     ;
                SourceExpr="Ending Date";
                Editable=FALSE }

    { 20  ;2   ;Field     ;
                SourceExpr="Ending Time";
                Editable=FALSE }

    { 22  ;2   ;Field     ;
                SourceExpr="Finish Now" }

  }
  CODE
  {
    VAR
      ClockingMgtG@1101103000 : Codeunit 83001;
      MachineCenterG@1101103002 : Record 99000758;
      RunTimesG@1101103001 : Record 83010;
      MachineCenterNoG@1000000000 : Code[20];
      ProdOrderNoG@1101103004 : Code[20];
      NoneProducingTimeCodeG@1000000001 : Code[20];
      TXT001@1000000002 : TextConst 'NOR=Startdato avviker fra dagens. Vil du bruke dagens dato?';
      ItemNoG@1101104000 : Code[20];
      ItemDescriptionG@1101104001 : Text[30];
      OutPutQtyG@1101104002 : Decimal;
      OutputQuantityG@1101103003 : Decimal;
      ScrapQtyG@1101104003 : Decimal;
      ScrapCodeG@1101104004 : Code[20];
      OpDescriptionG@1101104005 : Text[50];
      MachineNameG@1101104006 : Text[30];
      FirstRecOpLineG@1101104008 : Boolean;
      ScrapQty2G@1000000004 : Decimal;
      ScrapCode2G@1000000005 : Code[20];
      ScrapQty3G@1000000006 : Decimal;
      ScrapCode3G@1000000007 : Code[20];
      ScrapCommentG@1000000008 : Text[50];
      ScrapComment2G@1000000009 : Text[50];
      ScrapComment3G@1000000010 : Text[50];
      C_ErrorInQty@1101103005 : TextConst 'ENU=Scrap can only be posted together with output quantity.;NOR=Vrak kan kun bokf›res sammen med ferdigantall.';

    PROCEDURE InitForm@1000000001(MachineNo@1000000000 : Code[20];NoneProdTimeCode@1000000001 : Code[20]);
    BEGIN
      MachineCenterNoG := MachineNo;
      NoneProducingTimeCodeG := NoneProdTimeCode;
      //19.05->
      IF NoneProducingTimeCodeG = '' THEN
        MachineNameG :=  MachineNo;
      //19.05.<-
    END;

    PROCEDURE GetItemInfo@1101104000();
    VAR
      ProdOrdreLine@1101104000 : Record 5406;
      Item@1101104001 : Record 27;
      ProdORouteLine@1101104002 : Record 5409;
    BEGIN
      ProdOrdreLine.RESET;
      ProdOrdreLine.SETRANGE(Status, ProdOrdreLine.Status::Released);
      ProdOrdreLine.SETRANGE("Prod. Order No.", "Prod. Order No.");
      ProdOrdreLine.SETRANGE("Routing No.", "Routing No.");
      IF ProdOrdreLine.FIND('-') THEN BEGIN
        IF Item.GET(ProdOrdreLine."Item No.") THEN BEGIN
          ProdOrdreLine.TESTFIELD("Routing No.");

          ItemNoG := Item."No.";
          ItemDescriptionG := Item.Description;
        END;
      END;

      //hhe 20.04.06->
      ProdORouteLine.RESET;
      ProdORouteLine.SETRANGE(Status, ProdORouteLine.Status::Released);
      ProdORouteLine.SETRANGE("Prod. Order No.", "Prod. Order No.");
      ProdORouteLine.SETRANGE("Routing No.", "Routing No.");
      ProdORouteLine.SETRANGE("Operation No.", "Operation No.");
      IF ProdORouteLine.FIND('-') THEN BEGIN
        OpDescriptionG := ProdORouteLine.Description;
        MachineCenterG.GET(ProdORouteLine."No.");
        MachineNameG := MachineCenterG.Name;
        ProdOrderNoG := "Prod. Order No.";
        END
      ELSE
        OpDescriptionG := '';
      //hhe 20.04.06<-
    END;

    LOCAL PROCEDURE MachineCenterOnAfterValidate@19005651();
    BEGIN
      //012 hhe 26.11.09->
      IF NoneProducingTimeCodeG <>'' THEN
        "Stop Code" := NoneProducingTimeCodeG;
      //012 hhe 26.11.09<-
    END;

    LOCAL PROCEDURE CheckQuantity@1101103000();
    BEGIN
      //Because of limitation of posting scrap in standard NAV
      IF (OutPutQtyG = 0) AND ((ScrapQtyG + ScrapQty2G + ScrapQty3G) <> 0) THEN
          ERROR(C_ErrorInQty);
    END;

    BEGIN
    {
      ----------------------------------------------
      SI-DATA AS

      OPC
      ----------------------------------------------
      No  Date      ID      Description
      ----------------------------------------------
      001 14.12.05  hhe     Fjernet kolonne "Bokf›r"
      002 29.03.06  ASL     Bokf›ring av ikke produktiv tid.
      003 29.03.06  ASL     Satt inn ny Funksjon:InitForm som tar med maskin +
                            kode for ikke produktiv tid.
      004 03.04.06  hhe     Regner Operasjonstid over til timer
      005 20.04.06  hhe     Bokf›rer ferdig- og vrakantall, samt vrakkode n†r operasjonstider bokf›res
      006 18.05.06  hhe     Lagt inn "BlankZero" p† feltene "Ferdig. antall" og "Vrakantall"
      007 28.09.06  hhe     Kode som bokf›rer fradragslinjer dersom pauser/lunch
      008 28.09.07  hhe     Utvidet feltlengde p† global variabel="ScrapCode" fra 10 -> 20 tegn
      009 24.10.07  hhe     Overf›rer kommentaren til vraket ->kapasitetspost (via ItemJrnLine)
      010 09.06.09  BVM     Ekstra sjekk for † rydde opp i evt. blankelinjer som oppst†r (b†de start og sluttdato/tid er blanke)
      011 22.01.10  HHE     Fremvist kolonne "Indirekte tid (kode)"
      012 22.01.10  HHE     Kode som setter riktig kode for Indirekte tid.
    }
    END.
  }
}

OBJECT Page 83009 Registration Card
{
  OBJECT-PROPERTIES
  {
    Date=20.04.17;
    Time=16:08:18;
    Modified=Yes;
    Version List=OPC1.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Registration Card;
               NOR=Stemplingskort];
    SourceTable=Table83009;
    DataCaptionFields=Field1;
    PageType=Card;
    OnAfterGetRecord=BEGIN
                       CLEAR(ProdRess);
                       IF ProdRess.GET(GETFILTER("Machine Center Filter")) THEN
                         NavnProdRess := ProdRess.Name;

                       SETRANGE("Machine Center No.", GETFILTER("Machine Center Filter"));
                       IF NOT FIND('+') THEN
                         INIT;
                     END;

    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 15      ;1   ;Action    ;
                      Name=Registrer;
                      CaptionML=NOR=&Registrer tid;
                      Promoted=Yes;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 SETRANGE("Machine Center No.", GETFILTER("Machine Center Filter"));
                                 //SETRANGE("Ending Time",0T);
                                 IF NOT FIND('+') THEN BEGIN
                                   IF ProdRess.GET(GETFILTER("Machine Center Filter")) THEN BEGIN
                                     INIT;
                                     "Machine Center No." := ProdRess."No.";
                                     Navn := ProdRess.Name;
                                     "Starting Date" := TODAY;
                                     "Starting Time" := TIME;
                                     Workstatus := Workstatus::Registrated;
                                     INSERT;
                                   END
                                   ELSE
                                     ERROR('Fant ikke prod.ressursnr. %1', GETFILTER("Machine Center Filter"));
                                 END ELSE BEGIN
                                   IF ("Starting Date" <> 0D) AND ("Starting Time" <> 0T)
                                     AND ("Ending Date" <> 0D) AND ("Ending Time" <> 0T) THEN BEGIN
                                     IF ProdRess.GET(GETFILTER("Machine Center Filter")) THEN BEGIN
                                       INIT;
                                       "Machine Center No." := ProdRess."No.";
                                       Navn := NavnProdRess;
                                       "Starting Date" := TODAY;
                                       "Starting Time" := TIME;
                                       Workstatus := Workstatus::Registrated;
                                       INSERT;
                                     END
                                     ELSE
                                       MESSAGE('Fant ikke prod.ressursnr. %1', GETFILTER("Machine Center Filter"));
                                   END ELSE IF ("Starting Date" <> 0D) AND ("Starting Time" <> 0T)
                                     AND ("Ending Date" = 0D) AND ("Ending Time" = 0T) THEN BEGIN
                                     "Ending Date" := TODAY;
                                     "Ending Time" := TIME;
                                     Workstatus := Workstatus::Completed;
                                     MODIFY;
                                   END;
                                 END;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group      }

    { 17  ;2   ;Field     ;
                SourceExpr="Machine Center Filter";
                OnValidate=BEGIN
                             MachineCenterFilterOnAfterVali;
                           END;
                            }

    { 4   ;2   ;Field     ;
                CaptionML=NOR=Navn;
                SourceExpr=NavnProdRess;
                Editable=FALSE }

    { 6   ;2   ;Field     ;
                SourceExpr="Starting Date";
                Editable=FALSE }

    { 8   ;2   ;Field     ;
                SourceExpr="Starting Time";
                Editable=FALSE }

    { 10  ;2   ;Field     ;
                SourceExpr="Ending Date";
                Editable=FALSE }

    { 13  ;2   ;Field     ;
                SourceExpr="Ending Time";
                Editable=FALSE }

  }
  CODE
  {
    VAR
      ProdRess@1000000000 : Record 99000758;
      NavnProdRess@1000000001 : Text[30];

    LOCAL PROCEDURE MachineCenterFilterOnAfterVali@19004387();
    BEGIN
      SETRANGE("Machine Center No.", GETFILTER("Machine Center Filter"));

      CLEAR(ProdRess);
      IF ProdRess.GET(GETFILTER("Machine Center Filter")) THEN
        NavnProdRess := ProdRess.Name;
    END;

    BEGIN
    END.
  }
}

OBJECT Page 83011 OPC Setup
{
  OBJECT-PROPERTIES
  {
    Date=20.04.17;
    Time=16:08:18;
    Modified=Yes;
    Version List=OPC1.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=OPC Setup;
               NOR=OPC Oppsett];
    SourceTable=Table83001;
    PageType=Card;
    ActionList=ACTIONS
    {
      { 1101103003;  ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1101103004;1 ;ActionGroup }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=ENU=General }

    { 2   ;2   ;Field     ;
                SourceExpr="Output Template Name Qty" }

    { 5   ;2   ;Field     ;
                SourceExpr="Output Jrn Batch Name Qty" }

    { 7   ;2   ;Field     ;
                SourceExpr="Output Batch Name Time" }

    { 9   ;2   ;Field     ;
                SourceExpr="Output Jrn Name Time" }

    { 1000000000;2;Field  ;
                SourceExpr="Document No. Ind.Time" }

    { 1000000002;2;Field  ;
                SourceExpr="Item Reclass. Journal (templ.)" }

    { 1000000004;2;Field  ;
                SourceExpr="Item Reclass. Journal (Name)" }

    { 1000000006;2;Field  ;
                SourceExpr="OPC-Move Location Code" }

    { 1101103000;2;Field  ;
                SourceExpr="Warning Picture" }

    { 1101103008;1;Group  ;
                Name=Error Log Group;
                CaptionML=[ENU=Error Log;
                           NOR=Feillog];
                GroupType=Group }

    { 1101103001;2;Field  ;
                SourceExpr="Item Journal Template Name" }

    { 1101103002;2;Field  ;
                SourceExpr="Item Journal Batch Name" }

    { 1101103007;2;Field  ;
                SourceExpr="Show Error Log Message" }

  }
  CODE
  {

    BEGIN
    {
      ----------------------------------------------
      SI-DATA AS

      OPC
      ----------------------------------------------
      No  Date      ID      Description
      ----------------------------------------------
      001 29.03.06  ASL     Hentet frem felt:"Document No. Ind.Time"
      002 17.08.10  HHE     Nytt felt:"Item Reclass. Journal (templ.)" (brukes i OPC - flytt komponent)
                            Nytt felt:"Item Reclass. Journal (Name)"   (brukes i OPC - flytt komponent)
      003 19.08.10  HHE     Nytt felt: "OPC-flytt fra"
    }
    END.
  }
}

OBJECT Page 83012 Work Type Codes
{
  OBJECT-PROPERTIES
  {
    Date=20.04.17;
    Time=16:08:18;
    Modified=Yes;
    Version List=OPC (RSI);
  }
  PROPERTIES
  {
    CaptionML=[ENU=Work Type Codes;
               NOR=Arbeidstypekoder];
    SourceTable=Table83004;
    PageType=List;
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1117700000;1;Group  ;
                GroupType=Repeater }

    { 1117700001;2;Field  ;
                SourceExpr=Code }

    { 1117700003;2;Field  ;
                SourceExpr=Description }

    { 1101104002;2;Field  ;
                SourceExpr="Time Type" }

    { 1101104000;2;Field  ;
                SourceExpr="Payment Type" }

    { 1000000000;2;Field  ;
                SourceExpr=Absence }

  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Page 83013 Time Register
{
  OBJECT-PROPERTIES
  {
    Date=20.04.17;
    Time=16:08:18;
    Modified=Yes;
    Version List=OPC (RSI);
  }
  PROPERTIES
  {
    CaptionML=NOR=Registrert m›nstret tid;
    SourceTable=Table83007;
    PageType=List;
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1101104000;1;Group  ;
                GroupType=Repeater }

    { 1000000000;2;Field  ;
                SourceExpr="Machine Center" }

    { 1101104017;2;Field  ;
                SourceExpr="Machine Center Name" }

    { 1101104003;2;Field  ;
                SourceExpr="Start Date" }

    { 1101104005;2;Field  ;
                SourceExpr="Start Time" }

    { 1101104007;2;Field  ;
                SourceExpr="End Date" }

    { 1101104009;2;Field  ;
                SourceExpr="End Time" }

    { 1101104011;2;Field  ;
                SourceExpr=Quantity }

    { 1101104013;2;Field  ;
                SourceExpr="Work Type Code" }

    { 1101104015;2;Field  ;
                SourceExpr="Time Type" }

    { 1000000002;2;Field  ;
                SourceExpr=Absence }

  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Page 83014 Holyday
{
  OBJECT-PROPERTIES
  {
    Date=20.04.17;
    Time=16:08:18;
    Modified=Yes;
    Version List=OPC (RSI);
  }
  PROPERTIES
  {
    CaptionML=NOR=Helligdager;
    SourceTable=Table83005;
    PageType=List;
    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000010;1 ;Action    ;
                      CaptionML=[ENU=Copy Fixed;
                                 NOR=Kopier &faste];
                      Promoted=Yes;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CopyFixed();
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000000;1;Group  ;
                GroupType=Repeater }

    { 1000000001;2;Field  ;
                SourceExpr=Date }

    { 1000000003;2;Field  ;
                SourceExpr=Description }

    { 1000000005;2;Field  ;
                SourceExpr=Type }

  }
  CODE
  {

    PROCEDURE CopyFixed@1000000000();
    VAR
      Holidays@1000000000 : Record 83005;
      Holidays2@1000000001 : Record 83005;
      Input@1000000002 : Dialog;
      NewYear@1000000003 : Integer;
    BEGIN
      Input.OPEN('Nytt †r † kopiere faste\' +
        'hellidager til [4 siffer] #1########');
      Input.INPUT(1, NewYear);

      Holidays.RESET;
      Holidays.SETFILTER(Date, '%1..%2', DMY2DATE(1,
        1, DATE2DMY(TODAY, 3)), DMY2DATE(31,
        12, DATE2DMY(TODAY, 3)));
      Holidays.SETRANGE(Type, Holidays.Type::Fixed);
      IF Holidays.FIND('-') THEN
        REPEAT

          Holidays2.INIT;
          Holidays2.Date := DMY2DATE( DATE2DMY(Holidays.Date, 1),
            DATE2DMY(Holidays.Date, 2), NewYear);
          Holidays2.Description := Holidays.Description;
          Holidays2.Type := Holidays.Type;
          Holidays2.INSERT;

        UNTIL Holidays.NEXT = 0;
    END;

    BEGIN
    END.
  }
}

OBJECT Page 83016 Time Register Subform
{
  OBJECT-PROPERTIES
  {
    Date=20.04.17;
    Time=16:08:18;
    Modified=Yes;
    Version List=OPC (RSI);
  }
  PROPERTIES
  {
    Editable=No;
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=No;
    SourceTable=Table83007;
    PageType=ListPart;
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000000;1;Group  ;
                GroupType=Repeater }

    { 1000000001;2;Field  ;
                SourceExpr="Start Date" }

    { 1000000003;2;Field  ;
                SourceExpr="Start Time" }

    { 1000000005;2;Field  ;
                SourceExpr="End Date" }

    { 1000000007;2;Field  ;
                SourceExpr="End Time" }

    { 1000000009;2;Field  ;
                SourceExpr=Quantity }

    { 1000000011;2;Field  ;
                SourceExpr="Work Type Code" }

    { 1000000013;2;Field  ;
                SourceExpr=Absence }

  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Page 83018 Time Registered
{
  OBJECT-PROPERTIES
  {
    Date=20.04.17;
    Time=16:08:18;
    Modified=Yes;
    Version List=OPC (RSI);
  }
  PROPERTIES
  {
    CaptionML=NOR=Registrert m›nstringstid;
    SourceTable=Table83007;
    PageType=List;
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000000;1;Group  ;
                GroupType=Repeater }

    { 1000000001;2;Field  ;
                SourceExpr="Machine Center" }

    { 1000000003;2;Field  ;
                SourceExpr="Start Date" }

    { 1000000005;2;Field  ;
                SourceExpr="Start Time" }

    { 1000000007;2;Field  ;
                SourceExpr="End Date" }

    { 1000000009;2;Field  ;
                SourceExpr="End Time" }

    { 1000000011;2;Field  ;
                SourceExpr=Quantity }

    { 1000000013;2;Field  ;
                SourceExpr="Work Type Code" }

    { 1000000015;2;Field  ;
                SourceExpr="Time Type" }

    { 1000000017;2;Field  ;
                SourceExpr="Machine Center Name" }

  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Page 83019 Work time
{
  OBJECT-PROPERTIES
  {
    Date=20.04.17;
    Time=16:08:18;
    Modified=Yes;
    Version List=OPC (RSI);
  }
  PROPERTIES
  {
    CaptionML=NOR=Arbeidstid;
    SourceTable=Table83003;
    PageType=List;
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000000;1;Group  ;
                GroupType=Repeater }

    { 1000000001;2;Field  ;
                SourceExpr=Code }

    { 1000000003;2;Field  ;
                SourceExpr="Day Type" }

    { 1000000005;2;Field  ;
                SourceExpr=Description }

    { 1000000007;2;Field  ;
                SourceExpr="Time Type" }

    { 1000000009;2;Field  ;
                SourceExpr="From Time" }

    { 1000000011;2;Field  ;
                SourceExpr="To Time" }

    { 1000000013;2;Field  ;
                SourceExpr=Duration }

  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Page 83020 OPC - ressursstatus
{
  OBJECT-PROPERTIES
  {
    Date=20.04.17;
    Time=16:08:18;
    Modified=Yes;
    Version List=OPC3.10;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Direct Prod. Work;
               NOR=OPC - ressursstatus];
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=No;
    SourceTable=Table83010;
    SourceTableView=SORTING(Entry No.,Prod. Order No.,Routing No.,Operation No.,Machine Center)
                    ORDER(Ascending)
                    WHERE(Ending Date=FILTER(''),
                          Machine Center=FILTER(<>''),
                          Starting Date=FILTER(>01.01.00));
    PageType=List;
    TimerUpdate=5000;
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000000;1;Field  ;
                CaptionClass=Text19071011;
                Style=Strong;
                StyleExpr=TRUE }

    { 1   ;1   ;Group     ;
                Editable=FALSE;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                SourceExpr="Machine Center" }

    { 4   ;2   ;Field     ;
                SourceExpr=Description }

    { 1000000002;2;Field  ;
                SourceExpr="Stop Code" }

    { 1000000001;2;Field  ;
                SourceExpr="Prod. Order No.";
                OnLookup=VAR
                           ProdOrder@1101110000 : Record 5405;
                         BEGIN
                           //02.->
                           ProdOrder.SETRANGE(Status,ProdOrder.Status::Released);
                           ProdOrder.SETRANGE("No.","Prod. Order No.");
                           PAGE.RUNMODAL(PAGE::"Production Order List",ProdOrder);
                           //02.<-
                         END;
                          }

    { 8   ;2   ;Field     ;
                SourceExpr="Operation No." }

    { 10  ;2   ;Field     ;
                CaptionML=[ENU=Starting Date;
                           NOR=Startdato];
                SourceExpr="Starting Date" }

    { 12  ;2   ;Field     ;
                CaptionML=[ENU=Starting Time;
                           NOR=Starttid];
                SourceExpr="Starting Time" }

    { 1000000004;2;Field  ;
                CaptionML=NOR=P†logget ved prod.ress;
                SourceExpr="Work done at M.C." }

  }
  CODE
  {
    VAR
      Text19071011@19015358 : TextConst 'NOR=P†logget operasjon';

    BEGIN
    {
      +-------------------------------------------+
      | SI-Data                                   |
      +-------------------------------------------+
      Nr. Dato     Id  Beskrivelse
      01. 14.12.05 HHE Insert/delete/modify = no
                       Fremvist P.o.nr
      02. 24.08.09 HHE Felt "Prod.o.nr." - ved oppslag kommer man direkte inn p† frigitt p.o. (jfr. PTL)
      03. 22.01.10 HHE Fremvist kolonne for "Indirekte tid (kode)"
    }
    END.
  }
}

OBJECT Page 83021 Registrated
{
  OBJECT-PROPERTIES
  {
    Date=20.04.17;
    Time=16:08:18;
    Modified=Yes;
    Version List=OPC1.0;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Registrated;
               NOR=M›nstret];
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=No;
    SourceTable=Table83007;
    SourceTableView=SORTING(Machine Center,Start Date,Start Time)
                    ORDER(Ascending)
                    WHERE(End Date=CONST());
    PageType=List;
    TimerUpdate=5000;
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 1000000001;2;Field  ;
                SourceExpr="Machine Center" }

    { 1000000003;2;Field  ;
                SourceExpr="Machine Center Name" }

    { 1000000005;2;Field  ;
                SourceExpr="Start Date" }

    { 1000000007;2;Field  ;
                SourceExpr="Start Time" }

    { 1000000000;1;Field  ;
                CaptionClass=Text19070213;
                Style=Standard;
                StyleExpr=TRUE }

  }
  CODE
  {
    VAR
      Text19070213@19027263 : TextConst 'NOR=M›nstret';

    BEGIN
    {
      +---------------------------------+
      | SI-Data                         |
      +---------------------------------+
      Nr. Dato     Id  Beskrivelse
      01. 14.12.05 HHE Delete/Insert/Modify = No
    }
    END.
  }
}

OBJECT Page 83022 OPC - Run Times Deduction
{
  OBJECT-PROPERTIES
  {
    Date=20.04.17;
    Time=16:08:18;
    Modified=Yes;
    Version List=OPC1.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=OPC - Run Times Deduction;
               NOR=OPC - Fratrekk i operasjonstid];
    SourceTable=Table83012;
    PageType=List;
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000000;1;Group  ;
                GroupType=Repeater }

    { 1000000001;2;Field  ;
                SourceExpr=Code }

    { 1000000003;2;Field  ;
                SourceExpr=Description }

    { 1000000005;2;Field  ;
                SourceExpr="From Time" }

    { 1000000007;2;Field  ;
                SourceExpr="To Time" }

    { 1000000009;2;Field  ;
                SourceExpr="Deduct Prod.Order" }

  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Page 83023 OPC - Firm planned tasks
{
  OBJECT-PROPERTIES
  {
    Date=20.04.17;
    Time=16:08:18;
    Modified=Yes;
    Version List=OPC1.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=OPC- Firm planned tasks;
               NOR=OPC - Fast planlagte oppgaver];
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=No;
    SourceTable=Table5409;
    SourceTableView=SORTING(Type,No.,Starting Date)
                    ORDER(Ascending)
                    WHERE(Type=FILTER(Machine Center),
                          Routing Status=FILTER(<>Finished));
    DataCaptionFields=No.;
    PageType=List;
    RefreshOnActivate=Yes;
    OnAfterGetRecord=BEGIN
                       CLEAR(WarningIndex);
                       CLEAR(OrgQty);
                       ProdOrdrelinje.SETRANGE(ProdOrdrelinje.Status, ProdOrdrelinje.Status::"Firm Planned"); //hhe 17.06.09: Endret fra Released
                       ProdOrdrelinje.SETRANGE(ProdOrdrelinje."Prod. Order No.", "Prod. Order No.");
                       ProdOrdrelinje.SETRANGE(ProdOrdrelinje."Routing No.", "Routing No.");

                       IF ProdOrdrelinje.FINDFIRST THEN BEGIN
                         //BVM--->
                         OrgQty := ProdOrdrelinje.Quantity;
                         //BVM---<
                         IF Vare.GET(ProdOrdrelinje."Item No.") THEN BEGIN
                           VareNr := Vare."No.";
                           VareBesk := Vare.Description;
                           //SID.OJO ----------->
                           ProdOrdreKomponent.RESET;
                           //02 +
                           //ProdOrdreKomponent.SETRANGE(Status,Status::Released);
                           ProdOrdreKomponent.SETRANGE(Status, Status::"Firm Planned");
                           // 02-
                           ProdOrdreKomponent.SETRANGE("Prod. Order No.", "Prod. Order No.");
                           //hhe
                           ProdOrdreKomponent.SETRANGE("Routing Link Code", "Routing Link Code");
                           //hhe
                           IF ProdOrdreKomponent.FINDFIRST THEN
                             REPEAT
                               CLEAR(ItemInventory);
                               CLEAR(Item);
                               IF Item.GET(ProdOrdreKomponent."Item No.") THEN BEGIN
                                 Item.SETRANGE("Location Filter", ProdOrdreKomponent."Location Code");
                                 Item.CALCFIELDS(Inventory);
                                 ItemInventory := Item.Inventory;
                                 IF (ItemInventory - ProdOrdreKomponent."Remaining Quantity") < 0 THEN
                                   WarningIndex := 1;
                               END;
                             UNTIL ProdOrdreKomponent.NEXT = 0;
                       //<---------- SID.OJO
                         END;
                       END;
                       //BVM -->
                        RemQty := OrgQty - "Finished Qty";
                       //BVM --<
                       IF WarningIndex = 1 THEN BEGIN
                         OPCSetupG.GET;
                         OPCSetupG.CALCFIELDS("Warning Picture");
                       END
                       ELSE
                         OPCSetupG.INIT;
                     END;

    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000008;1 ;Action    ;
                      CaptionML=[ENU=Comments;
                                 NOR=Merknader];
                      RunObject=Page 99000840;
                      RunPageLink=Status=FIELD(Status),
                                  Prod. Order No.=FIELD(Prod. Order No.),
                                  Routing Reference No.=FIELD(Routing Reference No.),
                                  Routing No.=FIELD(Routing No.),
                                  Operation No.=FIELD(Operation No.);
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Comment;
                      PromotedCategory=Process }
      { 1000000004;1 ;Action    ;
                      Name=Related document;
                      CaptionML=[ENU=Related document;
                                 NOR=Tilknyttet dokument];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Relationship;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 //004.->
                                 //TESTFIELD("Dokument Link");
                                 HYPERLINK("Dokument Link");
                                 //SHELL(ENVIRON('windir')+'\'+'Explorer.exe', "Dokument Link");

                                 //004.<-
                               END;
                                }
      { 1000000005;1 ;Action    ;
                      Name=Stykkliste;
                      CaptionML=[ENU=BOM List;
                                 NOR=Stykkliste];
                      RunObject=Page 83004;
                      RunPageView=WHERE(Status=FILTER(Firm Planned),
                                        Prod. Order Line No.=CONST(10000));
                      RunPageLink=Prod. Order No.=FIELD(Prod. Order No.);
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=BOM;
                      PromotedCategory=Process }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                Editable=FALSE;
                GroupType=Repeater }

    { 10  ;2   ;Field     ;
                SourceExpr="Starting Date" }

    { 16  ;2   ;Field     ;
                SourceExpr="Prod. Order No." }

    { 2   ;2   ;Field     ;
                CaptionML=[ENU=Operation No.;
                           NOR=Op.nr.];
                SourceExpr="Operation No." }

    { 1000000000;2;Field  ;
                CaptionML=NOR=Varenr.;
                SourceExpr=VareNr }

    { 1000000002;2;Field  ;
                CaptionML=NOR=Varebeskr.;
                SourceExpr=VareBesk }

    { 6   ;2   ;Field     ;
                CaptionML=[ENU=Description;
                           NOR=Operasj.beskr.];
                SourceExpr=Description }

    { 1101103000;2;Field  ;
                Name=Warning;
                CaptionML=[ENU=Warning;
                           NOR=Varsel];
                SourceExpr=OPCSetupG."Warning Picture";
                Editable=false }

    { 1000000013;2;Field  ;
                CaptionML=[ENU=Ordred qty.;
                           NOR=Ordreantall];
                DecimalPlaces=0:0;
                SourceExpr=OrgQty }

    { 18  ;2   ;Field     ;
                CaptionML=[ENU=Planned qty;
                           NOR=Planlagt];
                SourceExpr="Input Quantity";
                Visible=FALSE }

    { 22  ;2   ;Field     ;
                CaptionML=[ENU=Finished Quantity;
                           NOR=Ferdig];
                DecimalPlaces=0:2;
                SourceExpr="Finished Qty" }

    { 1000000015;2;Field  ;
                CaptionML=[ENU=Remaining Qty;
                           NOR=Restantall];
                DecimalPlaces=0:0;
                SourceExpr=RemQty;
                Style=Standard;
                StyleExpr=TRUE }

    { 1000000011;2;Field  ;
                CaptionML=NOR=Plan ress tid;
                SourceExpr="Expected Capacity Need" }

    { 26  ;2   ;Field     ;
                DecimalPlaces=0:2;
                SourceExpr="Actual Run Time" }

    { 24  ;2   ;Field     ;
                SourceExpr="Dokument Link" }

  }
  CODE
  {
    VAR
      ProdOrdrelinje@1000000000 : Record 5406;
      Vare@1000000001 : Record 27;
      OPCOppsett@1000000004 : Record 83001;
      VareBesk@1000000002 : Text[50];
      VareNr@1000000003 : Text[50];
      FerdigmeldAntall@1000000005 : Decimal;
      FerdigMeldKladdLinje@1000000006 : Record 83;
      tilDok@1000000012 : Record 5409;
      ScrapCode@1000000009 : Code[20];
      "-Si-data-"@1000000010 : Text[30];
      VrakAnt2@1000000019 : Decimal;
      VrakBeskr2@1000000022 : Text[50];
      VrakKode2@1000000023 : Code[20];
      VrakKode@1000000024 : Code[20];
      VrakBeskr@1000000025 : Text[50];
      VrakAnt3@1000000014 : Decimal;
      VrakBeskr3@1000000013 : Text[50];
      VrakKode3@1000000011 : Code[20];
      WarningIndex@1000000015 : Integer;
      ProdOrdreKomponent@1000000016 : Record 5407;
      OPCSetupG@1101103000 : Record 83001;
      ItemInventory@1000000017 : Decimal;
      Item@1000000018 : Record 27;
      OrgQty@1000000020 : Decimal;
      RemQty@1000000021 : Decimal;

    BEGIN
    {
      ----------------------------------------------
      SI-DATA AS

      OPC
      ----------------------------------------------
      No  Date      ID      Description
      ----------------------------------------------
      01. 17.06.09  HHE    Opprettet etter ›nske fra PTL.
                           Basert p† FRM 83001. Fjernet knapper for Tidreg. + Ferdigmelding
                           Filter p† Fast planlagte operasjoner

      02. 13.08.2015 MNO   Fix Change setrange from "Released" -> "Firm Planned"
    }
    END.
  }
}

OBJECT Page 83026 Change Status On Released PO
{
  OBJECT-PROPERTIES
  {
    Date=20.04.17;
    Time=16:08:18;
    Modified=Yes;
    Version List=OPC;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Change Status On Released PO;
               NOR=Endre status p† frigitt produksjonsordre];
    SourceTable=Table5409;
    PageType=Card;
    OnInit=BEGIN
             com2Visible := TRUE;
             com1Visible := TRUE;
             OPCSetupG.GET;
           END;

    OnAfterGetRecord=BEGIN
                       OPCcom.SETRANGE(OPCcom."Prod. Order No.", "Prod. Order No.");
                       IF OPCcom.FIND('-') THEN
                           com := TRUE;

                       IF com = TRUE THEN
                         Tekst := 'Tekst';
                         com1Visible := TRUE;
                         com2Visible := TRUE;
                         IF com = FALSE THEN
                            com1Visible := FALSE;
                            com2Visible := TRUE;
                       TekstOnFormat;
                     END;

    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000044;1 ;Action    ;
                      CaptionML=[ENU=Comment;
                                 NOR=Merknad];
                      ToolTipML=[ENU=Comment;
                                 NOR=Merknad];
                      RunObject=Page 99000840;
                      RunPageLink=Prod. Order No.=FIELD(Prod. Order No.),
                                  Status=FIELD(Status),
                                  Routing No.=FIELD(Routing No.),
                                  Operation No.=FIELD(Operation No.),
                                  Routing Reference No.=FIELD(Routing Reference No.);
                      Promoted=Yes;
                      PromotedCategory=Process }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000034;1;Group  ;
                Name=Production Order;
                CaptionML=[ENU=Production Order;
                           NOR=Produksjonsordre] }

    { 1000000038;2;Field  ;
                SourceExpr=Status;
                Editable=FALSE }

    { 1000000039;2;Field  ;
                SourceExpr="Prod. Order No.";
                Editable=FALSE }

    { 1000000042;2;Field  ;
                CaptionML=[ENU=Finish Production Order;
                           NOR=Sett status til ferdig];
                SourceExpr=ChangeStatus }

    { 1000000043;2;Field  ;
                CaptionML=[ENU=Postingdate;
                           NOR=Bokf›ringsdato];
                SourceExpr=PostingDate }

    { 1000000035;2;Field  ;
                CaptionML=[ENU=Print Out;
                           NOR=Utskrift];
                SourceExpr=Utskrift }

    { 1000000032;2;Field  ;
                Name=com2;
                CaptionML=[ENU=Comments OPC;
                           NOR=Merknad fra OPC];
                SourceExpr=Tekst;
                Visible=com2Visible }

    { 1000000000;1;Group  ;
                Editable=FALSE;
                GroupType=Repeater }

    { 1000000001;2;Field  ;
                SourceExpr="Operation No." }

    { 1000000003;2;Field  ;
                SourceExpr=Type }

    { 1000000005;2;Field  ;
                SourceExpr="No." }

    { 1000000007;2;Field  ;
                SourceExpr=Description }

    { 1000000009;2;Field  ;
                SourceExpr="Expected Operation Cost Amt." }

    { 1000000011;2;Field  ;
                SourceExpr="Expected Capacity Ovhd. Cost" }

    { 1000000013;2;Field  ;
                SourceExpr="Actual Direct Cost" }

    { 1000000015;2;Field  ;
                SourceExpr="Actual Indirect Cost" }

    { 1000000020;1;Group  ;
                Name=Production Order Sum;
                CaptionML=[ENU=PO Summary;
                           NOR=PO Sammendrag] }

    { 1000000023;2;Field  ;
                CaptionML=[ENU=Actual Cost;
                           NOR=Faktisk Kost];
                SourceExpr=ActualCost;
                Editable=FALSE }

    { 1000000021;2;Field  ;
                CaptionML=[ENU=Expected Cost;
                           NOR=Forventet Kost];
                SourceExpr=ExpectedCost;
                Editable=FALSE }

    { 1000000027;2;Field  ;
                CaptionML=[ENU=Deviation;
                           NOR=Avvik];
                SourceExpr=DeviationCost;
                Editable=FALSE }

    { 1000000025;2;Field  ;
                CaptionML=[ENU=Correction Cost;
                           NOR=Korreksjonskost];
                SourceExpr=CorrectionCost;
                Editable=FALSE;
                OnValidate=BEGIN
                             IF DeviationCost > 0 THEN BEGIN
                               IF CorrectionCost > 0 THEN
                                 MESSAGE(Text003);
                             END ELSE BEGIN
                               IF CorrectionCost < 0 THEN
                                 MESSAGE(Text003);
                             END;

                             IF NOT CONFIRM(Text001, TRUE, ActualCost + CorrectionCost) THEN
                               ERROR(Text002);
                           END;
                            }

    { 1000000017;2;Field  ;
                CaptionML=NOR=Merknad;
                SourceExpr=Comment;
                OnValidate=BEGIN
                             ChgstatusCommentline.SETRANGE(ChgstatusCommentline."Prod. Order No.","Prod. Order No.");
                             ChgstatusCommentline.SETRANGE(ChgstatusCommentline."Routing reference No.","Routing Reference No.");
                             ChgstatusCommentline.SETRANGE(ChgstatusCommentline."Routing No.","Routing No.");
                             ChgstatusCommentline.SETRANGE(ChgstatusCommentline."Operation No.","Operation No.");
                             //ChgstatusCommentline.SETRANGE(ChgstatusCommentline."Entry No.",0);

                             IF ChgstatusCommentline.FIND('+') THEN BEGIN
                               IF ChgstatusCommentline."Entry No." = 0 THEN BEGIN
                                 ChgstatusCommentline.Comment := Comment;
                                 ChgstatusCommentline.MODIFY;
                               END ELSE BEGIN
                                 LineNo := 10000;
                                 ChgstatusCommentline."Prod. Order No." := "Prod. Order No.";
                                 ChgstatusCommentline."Routing reference No." := "Routing Reference No.";
                                 ChgstatusCommentline."Routing No." := "Routing No.";
                                 ChgstatusCommentline."Operation No." := "Operation No.";
                                 ChgstatusCommentline.Comment := Comment;
                                 ChgstatusCommentline.Date := WORKDATE;
                                 ChgstatusCommentline."Line No." := ChgstatusCommentline."Line No." + LineNo;
                                 ChgstatusCommentline."Entry No." := 0;
                                 ChgstatusCommentline.INSERT;
                                 END;
                             END ELSE BEGIN
                               LineNo := 10000;
                               ChgstatusCommentline."Prod. Order No." := "Prod. Order No.";
                               ChgstatusCommentline."Routing reference No." := "Routing Reference No.";
                               ChgstatusCommentline."Routing No." := "Routing No.";
                               ChgstatusCommentline."Operation No." := "Operation No.";
                               ChgstatusCommentline.Comment := Comment;
                               ChgstatusCommentline.Date := WORKDATE;
                               ChgstatusCommentline."Line No." := ChgstatusCommentline."Line No." + LineNo;
                               ChgstatusCommentline."Entry No." := 0;
                               ChgstatusCommentline.INSERT;
                             END;
                           END;
                            }

    { 1000000049;2;Field  ;
                CaptionML=[ENU=Correction Cost;
                           NOR=Korreksjon(timer)];
                SourceExpr=CorrectionHours;
                OnValidate=BEGIN
                             CorrectionCost := CorrectionHours * CorrectionUnitCost;

                             IF DeviationCost > 0 THEN BEGIN
                               IF CorrectionCost > 0 THEN
                                 MESSAGE(Text003);
                             END ELSE BEGIN
                               IF CorrectionCost < 0 THEN
                                 MESSAGE(Text003);
                             END;

                             IF NOT CONFIRM(Text001, TRUE, ActualCost + CorrectionCost) THEN
                               ERROR(Text002);
                           END;
                            }

    { 1000000048;2;Field  ;
                CaptionML=[ENU=Correction Cost;
                           NOR=Korreksjon(timepris)];
                SourceExpr=CorrectionUnitCost;
                OnValidate=BEGIN
                             CorrectionCost := CorrectionHours * CorrectionUnitCost;

                             IF DeviationCost > 0 THEN BEGIN
                               IF CorrectionCost > 0 THEN
                                 MESSAGE(Text003);
                             END ELSE BEGIN
                               IF CorrectionCost < 0 THEN
                                 MESSAGE(Text003);
                             END;

                             IF NOT CONFIRM(Text001, TRUE, ActualCost + CorrectionCost) THEN
                               ERROR(Text002);
                           END;
                            }

  }
  CODE
  {
    VAR
      ChangeStatus@1000000000 : Boolean;
      PostingDate@1000000001 : Date;
      ActualCost@1000000002 : Decimal;
      ExpectedCost@1000000003 : Decimal;
      CorrectionCost@1000000004 : Decimal;
      DeviationCost@1000000005 : Decimal;
      Text001@1000000006 : TextConst 'NOR=Ny faktisk operasjonskost vil bli %1.';
      Text002@1000000007 : TextConst 'NOR=Handlingen ble avbrutt.';
      Comment@1000000008 : Text[80];
      ChgstatusCommentline@1000000009 : Record 83008;
      LineNo@1000000010 : Integer;
      "--SI-Data--"@1000000011 : Text[30];
      OPCcom@1000000012 : Record 5415;
      com@1000000013 : Boolean;
      Tekst@1000000014 : Text[30];
      Utskrift@1000000015 : Boolean;
      r_ProdOrder@1000000016 : Record 5405;
      OPCSetupG@1101103003 : Record 83001;
      PageManagementG@1101103001 : Codeunit 700;
      CorrectionHours@1000000017 : Decimal;
      CorrectionUnitCost@1000000018 : Decimal;
      com1Visible@19041620 : Boolean INDATASET;
      com2Visible@19077332 : Boolean INDATASET;
      com2Emphasize@19002164 : Boolean INDATASET;
      Text003@1101103002 : TextConst 'ENU=The difference will increase;NOR=Du vil n† forsterke avviket';

    PROCEDURE INITForm@1000000000(ProdOrder@1000000000 : Record 5405);
    VAR
      ProdOrderRoutLine@1000000001 : Record 5409;
    BEGIN
      ChangeStatus := TRUE;
      PostingDate := WORKDATE;
      ActualCost := 0;
      ExpectedCost := 0;
      CorrectionCost := 0;
      DeviationCost := 0;
      CorrectionUnitCost := 0;
      CorrectionHours := 0;

      ProdOrderRoutLine.RESET;
      ProdOrderRoutLine.SETRANGE(Status,ProdOrder.Status);
      ProdOrderRoutLine.SETRANGE("Prod. Order No.",ProdOrder."No.");
      IF ProdOrderRoutLine.FIND('-') THEN
      REPEAT
        ExpectedCost := ExpectedCost +ProdOrderRoutLine."Expected Operation Cost Amt." + ProdOrderRoutLine.
      "Expected Capacity Ovhd. Cost";
        ActualCost := ActualCost + ProdOrderRoutLine."Actual Direct Cost" + ProdOrderRoutLine."Actual Indirect Cost";
      UNTIL ProdOrderRoutLine.NEXT=0;
      DeviationCost := ActualCost - ExpectedCost;
    END;

    PROCEDURE PrintReport@1000000002();
    BEGIN
      IF Utskrift = TRUE THEN BEGIN
        r_ProdOrder.SETRANGE(Status,Status);
        r_ProdOrder.SETFILTER("No.","Prod. Order No.");
        REPORT.RUNMODAL(99000791,TRUE,TRUE,r_ProdOrder);
      END;
    END;

    PROCEDURE ReturnPostingInfo@4(VAR Status@1000 : 'Simulated,Planned,Firm Planned,Released,Finished';VAR PostingDate2@1001 : Date;VAR UpdUnitCost@1002 : Boolean;VAR Correction@1000000000 : Decimal;VAR ChangeStatus2@1000000001 : Boolean;VAR CorrectionHours_funk@1000000002 : Decimal;VAR CorrectionUnitCost_funk@1000000003 : Decimal);
    BEGIN
      PrintReport;
      Status := Status::Finished;
      PostingDate2 := PostingDate;
      UpdUnitCost := FALSE;
      Correction := CorrectionCost;
      ChangeStatus2 := ChangeStatus;
      CorrectionUnitCost_funk := CorrectionUnitCost;
      CorrectionHours_funk := CorrectionHours;
    END;

    LOCAL PROCEDURE TekstOnFormat@19049259();
    BEGIN
      com2Emphasize := TRUE;
    END;

    BEGIN
    {
      +---------------------------------------------+
      | SI-Data                                     |
      +---------------------------------------------+
      Nr.     Dato       Id    Beskrivelse
      01.     01.04.08   HEI   Lagt til "Merknad" fra OPC til † vises i Endre P.O status
      02.     06.03.09   BVM   Lagt til Utskrift for utskrift av prod. ordre statestikk
      02.     27.04.10   BVM   Tatt bort 02. etter ›nsker fra Elas/PTL
      03.     08.09.09   HHE   Mulighet for † legge inn korreksjonen i antall timer eller antall kroner
    }
    END.
  }
}

OBJECT Page 83027 Non producing codes -adm
{
  OBJECT-PROPERTIES
  {
    Date=20.04.17;
    Time=16:08:18;
    Modified=Yes;
    Version List=indir.tid OPC;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Non producing time;
               NOR="OPC - koder for Ikke produktiv tid "];
    SourceTable=Table83011;
    PageType=List;
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1101104000;1;Group  ;
                GroupType=Repeater }

    { 1101104001;2;Field  ;
                SourceExpr=Kode }

    { 1101104003;2;Field  ;
                SourceExpr=Beskrivelse }

  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Page 83028 Non producing codes - OPC
{
  OBJECT-PROPERTIES
  {
    Date=20.04.17;
    Time=16:08:18;
    Modified=Yes;
    Version List=indir.tid OPC;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Non producing time - OPC;
               NOR=Ikke produktiv tid - OPC];
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=No;
    SourceTable=Table83011;
    PageType=List;
    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1101104008;1 ;Action    ;
                      Name=Start og Stop Time;
                      CaptionML=[ENU=Start/Stop Time;
                                 NOR=Start/stopp tid];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Start;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 OPCOppsett@1000000006 : Record 83001;
                                 OperasjonsTider@1000000005 : Record 83010;
                                 MachineCenteronOperation@1101103000 : Page 83008;
                               BEGIN
                                 // 001 START
                                 OperasjonsTider.SETRANGE(OperasjonsTider."Prod. Order No.", '');
                                 OperasjonsTider.SETRANGE(OperasjonsTider."Routing No.",  '');
                                 OperasjonsTider.SETRANGE(OperasjonsTider."Operation No.",  '');
                                 OperasjonsTider.SETFILTER(OperasjonsTider."Ending Date", '=%1', 0D);
                                 OperasjonsTider.SETFILTER(OperasjonsTider."Ending Time", '=%1', 0T);
                                 //hhe 03.04.06 OperasjonsTider.SETRANGE("Work done at M.C.","Machine Center");
                                 CLEAR(MachineCenteronOperation);
                                 MachineCenteronOperation.InitForm("Machine Center",Kode);
                                 MachineCenteronOperation.SETTABLEVIEW(OperasjonsTider);
                                 MachineCenteronOperation.RUN;
                                 // 001 STOP
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1101104000;1;Group  ;
                GroupType=Repeater }

    { 1101104001;2;Field  ;
                SourceExpr=Kode }

    { 1101104003;2;Field  ;
                SourceExpr=Beskrivelse }

  }
  CODE
  {
    VAR
      "Machine Center"@1000000000 : Code[20];

    PROCEDURE InitForm@1000000000(MachineNo@1000000000 : Code[20]);
    BEGIN
      "Machine Center" := MachineNo;
    END;

    BEGIN
    {
      ----------------------------------------------
      SI-DATA AS

      OPC
      ----------------------------------------------
      No  Date      ID      Description
      ----------------------------------------------
      001 29.03.06  ASL Endret p† kode Start / stopp tid
      002 03.04.06  HHE Fjernet filter "Work done at M.C"
    }
    END.
  }
}

OBJECT Page 83029 Merknader - endre p.o. status
{
  OBJECT-PROPERTIES
  {
    Date=20.04.17;
    Time=16:08:18;
    Modified=Yes;
    Version List=OPC;
  }
  PROPERTIES
  {
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=Yes;
    SourceTable=Table83008;
    PageType=List;
    AutoSplitKey=Yes;
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000000;1;Group  ;
                GroupType=Repeater }

    { 1000000001;2;Field  ;
                SourceExpr=Date }

    { 1000000003;2;Field  ;
                SourceExpr=Comment }

  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Page 83030 OPC - Move components
{
  OBJECT-PROPERTIES
  {
    Date=20.04.17;
    Time=16:08:18;
    Modified=Yes;
    Version List=OPC;
  }
  PROPERTIES
  {
    CaptionML=[ENU=OPC - Move components;
               NOR=OPC - flytt komponenter];
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=Yes;
    SourceTable=Table5407;
    PageType=List;
    OnInit=BEGIN
             //hhe 19.08.10->
             OPCOppsett.GET;
             //hhe 19.08.10<-
           END;

    OnAfterGetRecord=BEGIN
                       //hhe 18.08.10->
                       "Shipped qty - remaining" := "Remaining Quantity" - Shipped;
                       Beholdning := 0;
                       IF rec_Item.GET("Item No.") THEN BEGIN
                         rec_Item.SETRANGE("Location Filter",OPCOppsett."OPC-Move Location Code");
                         rec_Item.CALCFIELDS(Inventory);
                         Beholdning := rec_Item.Inventory;
                       END;
                       //hhe 18.08.10<-
                     END;

    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000026;1 ;Action    ;
                      CaptionML=NOR=Bokf›r flytting;
                      Promoted=Yes;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ProdOrderComp@1000000001 : Record 5407;
                                 ProdOrderComp2@1000000002 : Record 5407;
                               BEGIN
                                 //17.08.10->
                                 IF NewLocationCode = '' THEN
                                   ERROR('Du m† angi "Flytt til lokasjonskode"');

                                 IF NewLocationCode = OPCOppsett."OPC-Move Location Code" THEN
                                   ERROR('Du kan ikke angi %1 som "Flytt til lokasjonskode"',OPCOppsett."OPC-Move Location Code");

                                 ProdOrderComp.COPY(Rec);
                                 ProdOrderComp.SETFILTER("Ship now",'>0');
                                 IF ProdOrderComp.FIND('-') THEN BEGIN
                                   //overf›rer Prod.o.komponentlinjene inn i Overf›ringskladd
                                   OverfKladdLinje.SETRANGE(OverfKladdLinje."Journal Template Name", OPCOppsett."Item Reclass. Journal (templ.)");
                                   OverfKladdLinje.SETRANGE(OverfKladdLinje."Journal Batch Name", OPCOppsett."Item Reclass. Journal (Name)");
                                   IF OverfKladdLinje.FIND('-') THEN
                                    OverfKladdLinje.DELETEALL;
                                   OverfKladdLinje."Line No." := 0;
                                   REPEAT
                                     OverfKladdLinje.INIT;
                                     OverfKladdLinje.VALIDATE("Journal Template Name", OPCOppsett."Item Reclass. Journal (templ.)");
                                     OverfKladdLinje.VALIDATE("Journal Batch Name", OPCOppsett."Item Reclass. Journal (Name)");
                                     OverfKladdLinje."Line No." := OverfKladdLinje."Line No." +10000;
                                     OverfKladdLinje.INSERT(TRUE);

                                     OverfKladdLinje."Entry Type" := OverfKladdLinje."Entry Type"::Transfer;
                                     OverfKladdLinje."Posting Date" := TODAY;
                                     OverfKladdLinje."Document Date" := TODAY;
                                     OverfKladdLinje."Document No." := 'OPC-flytt';
                                     OverfKladdLinje.VALIDATE("Item No.", ProdOrderComp."Item No.");
                                     OverfKladdLinje.VALIDATE("Location Code",OPCOppsett."OPC-Move Location Code");
                                     OverfKladdLinje.VALIDATE(Quantity,ProdOrderComp."Ship now");
                                     OverfKladdLinje.VALIDATE("New Location Code",NewLocationCode);
                                     OverfKladdLinje.VALIDATE("Order Type", OverfKladdLinje."Order Type"::Production);
                                     OverfKladdLinje.VALIDATE("Order No.", "Prod. Order No.");
                                     OverfKladdLinje.MODIFY(TRUE);
                                     ProdOrderComp2.COPY(ProdOrderComp);
                                     ProdOrderComp2."Ship now" := 0;
                                     ProdOrderComp2.MODIFY;

                                   UNTIL ProdOrderComp.NEXT = 0;
                                 END;

                                 //bokf›rer overf›ringskladden
                                 CODEUNIT.RUN(CODEUNIT::"Item Jnl.-Post",OverfKladdLinje);

                                 //hvis vellykket bokf›ring, s† ...
                                 //ProdOrderComp2.COPY(Rec);
                                 {
                                 IF ProdOrderComp.FIND('-') THEN BEGIN
                                   ProdOrderComp2."Ship now" := 0;
                                   ProdOrderComp2.MODIFY;
                                 END;
                                 }
                                 //18.08.10<-
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000000;1;Group  ;
                Editable=TRUE;
                GroupType=Repeater }

    { 1000000005;2;Field  ;
                SourceExpr="Item No.";
                Editable=FALSE }

    { 1000000007;2;Field  ;
                SourceExpr=Description;
                Editable=FALSE }

    { 1000000031;2;Field  ;
                CaptionML=NOR=Beholdn. - Hoved;
                DecimalPlaces=0:2;
                SourceExpr=Beholdning;
                Editable=FALSE }

    { 1000000009;2;Field  ;
                SourceExpr="Unit of Measure Code";
                Editable=FALSE }

    { 1000000027;2;Field  ;
                DecimalPlaces=0:2;
                SourceExpr=Shipped;
                Editable=FALSE }

    { 1000000011;2;Field  ;
                CaptionML=NOR=Gjenst†r † flytte;
                DecimalPlaces=0:2;
                SourceExpr="Remaining Quantity" - Shipped;
                Editable=FALSE }

    { 1000000029;2;Field  ;
                DecimalPlaces=0:2;
                SourceExpr="Ship now" }

    { 1000000002;1;Field  ;
                SourceExpr=OPCOppsett."OPC-Move Location Code";
                TableRelation=Location.Code;
                Editable=FALSE }

    { 1000000024;1;Field  ;
                SourceExpr=NewLocationCode;
                TableRelation=Location.Code }

    { 1000000025;1;Field  ;
                CaptionClass=Text19028583 }

    { 1000000001;1;Field  ;
                CaptionClass=Text19076695 }

    { 1000000021;1;Field  ;
                CaptionClass=Text19042457 }

    { 1000000020;1;Field  ;
                CaptionClass=Text19028137 }

    { 1000000003;1;Field  ;
                CaptionClass=Text19027444 }

    { 1000000019;1;Field  ;
                CaptionClass=Text19015144 }

    { 1000000018;1;Field  ;
                CaptionClass=Text19006185 }

  }
  CODE
  {
    VAR
      NewLocationCode@1000000000 : Code[10];
      OverfKladdLinje@1000000001 : Record 83;
      OPCOppsett@1000000002 : Record 83001;
      Beholdning@1000000003 : Decimal;
      rec_Item@1000000004 : Record 27;
      Text19006185@19047498 : TextConst 'NOR=Dette bildet brukes for † flytte komponenter fra en lokasjon til en ny';
      Text19015144@19061235 : TextConst 'NOR="For † flytte beholdningen fra angitt lokasjon til en ny, s† skal du gj›re f›lgende: "';
      Text19027444@19029557 : TextConst 'NOR=1) For de varelinjer du vil flytte: angi enn verdi i feltet "Flytt n† (antall)"';
      Text19028137@19008317 : TextConst 'NOR=2) Angi en verdi i feltet "Flytt til lokasjonskode"';
      Text19042457@19034517 : TextConst 'NOR=3) Trykk p† knappen "Bokf›r flytting"';
      Text19076695@19025829 : TextConst 'NOR=Flytt fra lokasjonskode:';
      Text19028583@19034388 : TextConst 'NOR=Flytt til lokasjonskode:';

    BEGIN
    END.
  }
}

OBJECT Page 83031 Run Times med blanke linjer
{
  OBJECT-PROPERTIES
  {
    Date=20.04.17;
    Time=16:08:18;
    Modified=Yes;
    Version List=BVM temp;
  }
  PROPERTIES
  {
    SourceTable=Table83010;
    SourceTableView=SORTING(Entry No.,Prod. Order No.,Routing No.,Operation No.,Machine Center)
                    WHERE(Starting Date=FILTER(''),
                          Starting Time=FILTER(''));
    PageType=List;
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000000;1;Group  ;
                GroupType=Repeater }

    { 1000000001;2;Field  ;
                SourceExpr="Entry No." }

    { 1000000003;2;Field  ;
                SourceExpr="Prod. Order No." }

    { 1000000005;2;Field  ;
                SourceExpr="Routing No." }

    { 1000000007;2;Field  ;
                SourceExpr="Operation No." }

    { 1000000009;2;Field  ;
                SourceExpr="Machine Center" }

    { 1000000011;2;Field  ;
                SourceExpr=Description }

    { 1000000013;2;Field  ;
                SourceExpr="Starting Date" }

    { 1000000015;2;Field  ;
                SourceExpr="Starting Time" }

    { 1000000017;2;Field  ;
                SourceExpr="Ending Date" }

    { 1000000019;2;Field  ;
                SourceExpr="Ending Time" }

    { 1000000021;2;Field  ;
                SourceExpr="Finish Now" }

    { 1000000023;2;Field  ;
                SourceExpr=Post }

    { 1000000025;2;Field  ;
                SourceExpr="Work done at M.C." }

  }
  CODE
  {

    BEGIN
    END.
  }
}

