OBJECT Table 83 Item Journal Line
{
  OBJECT-PROPERTIES
  {
    Date=11.04.17;
    Time=16.04.43;
    Modified=Yes;
    Version List=NAVW110.00,OPC1.0;
  }
  PROPERTIES
  {
    OnInsert=BEGIN
               LOCKTABLE;
               ItemJnlTemplate.GET("Journal Template Name");
               ItemJnlBatch.GET("Journal Template Name","Journal Batch Name");

               ValidateShortcutDimCode(1,"Shortcut Dimension 1 Code");
               ValidateShortcutDimCode(2,"Shortcut Dimension 2 Code");
               ValidateNewShortcutDimCode(1,"New Shortcut Dimension 1 Code");
               ValidateNewShortcutDimCode(2,"New Shortcut Dimension 2 Code");

               CheckPlanningAssignment;
             END;

    OnModify=BEGIN
               ReserveItemJnlLine.VerifyChange(Rec,xRec);
               CheckPlanningAssignment;
             END;

    OnDelete=BEGIN
               ReserveItemJnlLine.DeleteLine(Rec);

               CALCFIELDS("Reserved Qty. (Base)");
               TESTFIELD("Reserved Qty. (Base)",0);
             END;

    OnRename=BEGIN
               ReserveItemJnlLine.RenameLine(Rec,xRec);
             END;

    CaptionML=[ENU=Item Journal Line;
               NOR=Varekladdelinje];
    LookupPageID=Page519;
    DrillDownPageID=Page519;
  }
  FIELDS
  {
    { 1   ;   ;Journal Template Name;Code10       ;TableRelation="Item Journal Template";
                                                   CaptionML=[ENU=Journal Template Name;
                                                              NOR=Kladdemalnavn] }
    { 2   ;   ;Line No.            ;Integer       ;CaptionML=[ENU=Line No.;
                                                              NOR=Linjenr.] }
    { 3   ;   ;Item No.            ;Code20        ;TableRelation=Item;
                                                   OnValidate=VAR
                                                                ProdOrderLine@1001 : Record 5406;
                                                                ProdOrderComp@1000 : Record 5407;
                                                              BEGIN
                                                                IF "Item No." <> xRec."Item No." THEN BEGIN
                                                                  "Variant Code" := '';
                                                                  "Bin Code" := '';
                                                                  IF CurrFieldNo <> 0 THEN
                                                                    WMSManagement.CheckItemJnlLineFieldChange(Rec,xRec,FIELDCAPTION("Item No."));
                                                                  IF ("Location Code" <> '') AND ("Item No." <> '') THEN BEGIN
                                                                    GetLocation("Location Code");
                                                                    IF Location."Bin Mandatory" AND NOT Location."Directed Put-away and Pick" THEN
                                                                      WMSManagement.GetDefaultBin("Item No.","Variant Code","Location Code","Bin Code")
                                                                  END;
                                                                  IF ("Entry Type" = "Entry Type"::Transfer) AND ("Location Code" = "New Location Code") THEN
                                                                    "New Bin Code" := "Bin Code";
                                                                END;

                                                                IF "Entry Type" IN ["Entry Type"::Consumption,"Entry Type"::Output] THEN
                                                                  WhseValidateSourceLine.ItemLineVerifyChange(Rec,xRec);

                                                                IF "Item No." = '' THEN BEGIN
                                                                  CreateDim(
                                                                    DATABASE::Item,"Item No.",
                                                                    DATABASE::"Salesperson/Purchaser","Salespers./Purch. Code",
                                                                    DATABASE::"Work Center","Work Center No.");
                                                                  EXIT;
                                                                END;

                                                                GetItem;
                                                                Item.TESTFIELD(Blocked,FALSE);
                                                                Item.TESTFIELD(Type,Item.Type::Inventory);
                                                                IF "Value Entry Type" = "Value Entry Type"::Revaluation THEN
                                                                  Item.TESTFIELD("Inventory Value Zero",FALSE);
                                                                Description := Item.Description;
                                                                "Inventory Posting Group" := Item."Inventory Posting Group";
                                                                "Item Category Code" := Item."Item Category Code";
                                                                "Product Group Code" := Item."Product Group Code";

                                                                IF ("Value Entry Type" <> "Value Entry Type"::"Direct Cost") OR
                                                                   ("Item Charge No." <> '')
                                                                THEN BEGIN
                                                                  IF "Item No." <> xRec."Item No." THEN BEGIN
                                                                    TESTFIELD("Partial Revaluation",FALSE);
                                                                    RetrieveCosts;
                                                                    "Indirect Cost %" := 0;
                                                                    "Overhead Rate" := 0;
                                                                    "Inventory Value Per" := "Inventory Value Per"::" ";
                                                                    VALIDATE("Applies-to Entry",0);
                                                                    "Partial Revaluation" := FALSE;
                                                                  END;
                                                                END ELSE BEGIN
                                                                  "Indirect Cost %" := Item."Indirect Cost %";
                                                                  "Overhead Rate" := Item."Overhead Rate";
                                                                  IF NOT "Phys. Inventory" OR (Item."Costing Method" = Item."Costing Method"::Standard) THEN BEGIN
                                                                    RetrieveCosts;
                                                                    "Unit Cost" := UnitCost;
                                                                  END ELSE
                                                                    UnitCost := "Unit Cost";
                                                                END;

                                                                IF (("Entry Type" = "Entry Type"::Output) AND (WorkCenter."No." = '') AND (MachineCenter."No." = '')) OR
                                                                   ("Entry Type" <> "Entry Type"::Output) OR
                                                                   ("Value Entry Type" = "Value Entry Type"::Revaluation)
                                                                THEN
                                                                  "Gen. Prod. Posting Group" := Item."Gen. Prod. Posting Group";

                                                                CASE "Entry Type" OF
                                                                  "Entry Type"::Purchase,
                                                                  "Entry Type"::Output,
                                                                  "Entry Type"::"Assembly Output":
                                                                    PurchPriceCalcMgt.FindItemJnlLinePrice(Rec,FIELDNO("Item No."));
                                                                  "Entry Type"::"Positive Adjmt.",
                                                                  "Entry Type"::"Negative Adjmt.",
                                                                  "Entry Type"::Consumption,
                                                                  "Entry Type"::"Assembly Consumption":
                                                                    "Unit Amount" := UnitCost;
                                                                  "Entry Type"::Sale:
                                                                    SalesPriceCalcMgt.FindItemJnlLinePrice(Rec,FIELDNO("Item No."));
                                                                  "Entry Type"::Transfer:
                                                                    BEGIN
                                                                      "Unit Amount" := 0;
                                                                      "Unit Cost" := 0;
                                                                      Amount := 0;
                                                                    END;
                                                                END;

                                                                CASE "Entry Type" OF
                                                                  "Entry Type"::Purchase:
                                                                    "Unit of Measure Code" := Item."Purch. Unit of Measure";
                                                                  "Entry Type"::Sale:
                                                                    "Unit of Measure Code" := Item."Sales Unit of Measure";
                                                                  "Entry Type"::Output:
                                                                    BEGIN
                                                                      Item.TESTFIELD("Inventory Value Zero",FALSE);
                                                                      ProdOrderLine.SetFilterByReleasedOrderNo("Order No.");
                                                                      ProdOrderLine.SETRANGE("Item No.","Item No.");
                                                                      IF ProdOrderLine.FINDFIRST THEN BEGIN
                                                                        "Routing No." := ProdOrderLine."Routing No.";
                                                                        "Source Type" := "Source Type"::Item;
                                                                        "Source No." := ProdOrderLine."Item No.";
                                                                      END ELSE
                                                                        IF ("Value Entry Type" <> "Value Entry Type"::Revaluation) AND
                                                                           (CurrFieldNo <> 0)
                                                                        THEN
                                                                          ERROR(Text031,"Item No.","Order No.");
                                                                      IF ProdOrderLine.COUNT = 1 THEN BEGIN
                                                                        VALIDATE("Order Line No.",ProdOrderLine."Line No.");
                                                                        "Unit of Measure Code" := ProdOrderLine."Unit of Measure Code";
                                                                        "Location Code" := ProdOrderLine."Location Code";
                                                                        VALIDATE("Variant Code",ProdOrderLine."Variant Code");
                                                                        VALIDATE("Bin Code",ProdOrderLine."Bin Code");
                                                                      END ELSE
                                                                        "Unit of Measure Code" := Item."Base Unit of Measure";
                                                                    END;
                                                                  "Entry Type"::Consumption:
                                                                    BEGIN
                                                                      ProdOrderComp.SetFilterByReleasedOrderNo("Order No.");
                                                                      ProdOrderComp.SETRANGE("Item No.","Item No.");
                                                                      IF ProdOrderComp.COUNT = 1 THEN BEGIN
                                                                        ProdOrderComp.FINDFIRST;
                                                                        VALIDATE("Order Line No.",ProdOrderComp."Prod. Order Line No.");
                                                                        VALIDATE("Prod. Order Comp. Line No.",ProdOrderComp."Line No.");
                                                                        "Unit of Measure Code" := ProdOrderComp."Unit of Measure Code";
                                                                        "Location Code" := ProdOrderComp."Location Code";
                                                                        VALIDATE("Variant Code",ProdOrderComp."Variant Code");
                                                                        VALIDATE("Bin Code",ProdOrderComp."Bin Code");
                                                                      END ELSE BEGIN
                                                                        "Unit of Measure Code" := Item."Base Unit of Measure";
                                                                        VALIDATE("Prod. Order Comp. Line No.",0);
                                                                      END;
                                                                    END;
                                                                  ELSE
                                                                    "Unit of Measure Code" := Item."Base Unit of Measure";
                                                                END;

                                                                IF "Value Entry Type" = "Value Entry Type"::Revaluation THEN
                                                                  "Unit of Measure Code" := Item."Base Unit of Measure";
                                                                VALIDATE("Unit of Measure Code");
                                                                IF "Variant Code" <> '' THEN
                                                                  VALIDATE("Variant Code");

                                                                CheckItemAvailable(FIELDNO("Item No."));

                                                                IF ((NOT ("Order Type" IN ["Order Type"::Production,"Order Type"::Assembly])) OR ("Order No." = '')) AND NOT "Phys. Inventory"
                                                                THEN
                                                                  CreateDim(
                                                                    DATABASE::Item,"Item No.",
                                                                    DATABASE::"Salesperson/Purchaser","Salespers./Purch. Code",
                                                                    DATABASE::"Work Center","Work Center No.");

                                                                ReserveItemJnlLine.VerifyChange(Rec,xRec);
                                                              END;

                                                   CaptionML=[ENU=Item No.;
                                                              NOR=Varenr.] }
    { 4   ;   ;Posting Date        ;Date          ;OnValidate=VAR
                                                                CheckDateConflict@1000 : Codeunit 99000815;
                                                              BEGIN
                                                                VALIDATE("Document Date","Posting Date");
                                                                CheckDateConflict.ItemJnlLineCheck(Rec,CurrFieldNo <> 0);
                                                              END;

                                                   CaptionML=[ENU=Posting Date;
                                                              NOR=Bokf›ringsdato] }
    { 5   ;   ;Entry Type          ;Option        ;OnValidate=BEGIN
                                                                IF NOT ("Entry Type" IN ["Entry Type"::"Positive Adjmt.","Entry Type"::"Negative Adjmt."]) THEN
                                                                  TESTFIELD("Phys. Inventory",FALSE);

                                                                IF CurrFieldNo <> 0 THEN
                                                                  WMSManagement.CheckItemJnlLineFieldChange(Rec,xRec,FIELDCAPTION("Entry Type"));

                                                                CASE "Entry Type" OF
                                                                  "Entry Type"::Purchase:
                                                                    IF UserMgt.GetRespCenter(1,'') <> '' THEN
                                                                      "Location Code" := UserMgt.GetLocation(1,'',UserMgt.GetPurchasesFilter);
                                                                  "Entry Type"::Sale:
                                                                    IF UserMgt.GetRespCenter(0,'') <> '' THEN
                                                                      "Location Code" := UserMgt.GetLocation(0,'',UserMgt.GetSalesFilter);
                                                                  "Entry Type"::Consumption,"Entry Type"::Output:
                                                                    VALIDATE("Order Type","Order Type"::Production);
                                                                  "Entry Type"::"Assembly Consumption","Entry Type"::"Assembly Output":
                                                                    VALIDATE("Order Type","Order Type"::Assembly);
                                                                END;

                                                                IF xRec."Location Code" = '' THEN
                                                                  IF Location.GET("Location Code") THEN
                                                                    IF  Location."Directed Put-away and Pick" THEN
                                                                      "Location Code" := '';

                                                                IF "Item No." <> '' THEN
                                                                  VALIDATE("Location Code");

                                                                VALIDATE("Item No.");
                                                                IF "Entry Type" <> "Entry Type"::Transfer THEN BEGIN
                                                                  "New Location Code" := '';
                                                                  "New Bin Code" := '';
                                                                END;

                                                                IF "Entry Type" <> "Entry Type"::Output THEN
                                                                  Type := Type::" ";

                                                                ReserveItemJnlLine.VerifyChange(Rec,xRec);
                                                              END;

                                                   CaptionML=[ENU=Entry Type;
                                                              NOR=Posttype];
                                                   OptionCaptionML=[ENU=Purchase,Sale,Positive Adjmt.,Negative Adjmt.,Transfer,Consumption,Output, ,Assembly Consumption,Assembly Output;
                                                                    NOR=Kj›p,Salg,Oppjust.,Nedjust.,Overf›ring,Forbruk,Avgang, ,Monteringsforbruk,Monteringsavgang];
                                                   OptionString=Purchase,Sale,Positive Adjmt.,Negative Adjmt.,Transfer,Consumption,Output, ,Assembly Consumption,Assembly Output }
    { 6   ;   ;Source No.          ;Code20        ;TableRelation=IF (Source Type=CONST(Customer)) Customer
                                                                 ELSE IF (Source Type=CONST(Vendor)) Vendor
                                                                 ELSE IF (Source Type=CONST(Item)) Item;
                                                   CaptionML=[ENU=Source No.;
                                                              NOR=Kildenr.];
                                                   Editable=No }
    { 7   ;   ;Document No.        ;Code20        ;CaptionML=[ENU=Document No.;
                                                              NOR=Bilagsnr.] }
    { 8   ;   ;Description         ;Text50        ;CaptionML=[ENU=Description;
                                                              NOR=Beskrivelse] }
    { 9   ;   ;Location Code       ;Code10        ;TableRelation=Location;
                                                   OnValidate=BEGIN
                                                                IF "Entry Type" <= "Entry Type"::Transfer THEN
                                                                  TESTFIELD("Item No.");

                                                                IF ("Value Entry Type" = "Value Entry Type"::"Direct Cost") AND
                                                                   ("Item Charge No." = '') AND
                                                                   ("No." = '')
                                                                THEN BEGIN
                                                                  GetUnitAmount(FIELDNO("Location Code"));
                                                                  "Unit Cost" := UnitCost;
                                                                  VALIDATE("Unit Amount");
                                                                  CheckItemAvailable(FIELDNO("Location Code"));
                                                                END;

                                                                IF "Entry Type" IN ["Entry Type"::Consumption,"Entry Type"::Output] THEN
                                                                  WhseValidateSourceLine.ItemLineVerifyChange(Rec,xRec);

                                                                IF "Location Code" <> xRec."Location Code" THEN BEGIN
                                                                  "Bin Code" := '';
                                                                  IF CurrFieldNo <> 0 THEN
                                                                    WMSManagement.CheckItemJnlLineFieldChange(Rec,xRec,FIELDCAPTION("Location Code"));
                                                                  IF ("Location Code" <> '') AND ("Item No." <> '') THEN BEGIN
                                                                    GetLocation("Location Code");
                                                                    IF Location."Bin Mandatory" AND NOT Location."Directed Put-away and Pick" THEN
                                                                      WMSManagement.GetDefaultBin("Item No.","Variant Code","Location Code","Bin Code");
                                                                  END;
                                                                  IF "Entry Type" = "Entry Type"::Transfer THEN BEGIN
                                                                    "New Location Code" := "Location Code";
                                                                    "New Bin Code" := "Bin Code";
                                                                  END;
                                                                END;

                                                                VALIDATE("Unit of Measure Code");

                                                                ReserveItemJnlLine.VerifyChange(Rec,xRec);
                                                              END;

                                                   CaptionML=[ENU=Location Code;
                                                              NOR=Lokasjonskode] }
    { 10  ;   ;Inventory Posting Group;Code10     ;TableRelation="Inventory Posting Group";
                                                   CaptionML=[ENU=Inventory Posting Group;
                                                              NOR=Bokf›ringsgruppe - lager];
                                                   Editable=No }
    { 11  ;   ;Source Posting Group;Code10        ;TableRelation=IF (Source Type=CONST(Customer)) "Customer Posting Group"
                                                                 ELSE IF (Source Type=CONST(Vendor)) "Vendor Posting Group"
                                                                 ELSE IF (Source Type=CONST(Item)) "Inventory Posting Group";
                                                   CaptionML=[ENU=Source Posting Group;
                                                              NOR=Kildebokf›ringsgruppe];
                                                   Editable=No }
    { 13  ;   ;Quantity            ;Decimal       ;OnValidate=VAR
                                                                CallWhseCheck@1000 : Boolean;
                                                              BEGIN
                                                                IF ("Entry Type" <= "Entry Type"::Transfer) AND (Quantity <> 0) THEN
                                                                  TESTFIELD("Item No.");

                                                                IF NOT PhysInvtEntered THEN
                                                                  TESTFIELD("Phys. Inventory",FALSE);

                                                                CallWhseCheck :=
                                                                  ("Entry Type" = "Entry Type"::"Assembly Consumption") OR
                                                                  ("Entry Type" = "Entry Type"::Consumption) OR
                                                                  ("Entry Type" = "Entry Type"::Output) AND
                                                                  LastOutputOperation(Rec);
                                                                IF CallWhseCheck THEN
                                                                  WhseValidateSourceLine.ItemLineVerifyChange(Rec,xRec);

                                                                IF CurrFieldNo <> 0 THEN
                                                                  WMSManagement.CheckItemJnlLineFieldChange(Rec,xRec,FIELDCAPTION(Quantity));

                                                                "Quantity (Base)" := CalcBaseQty(Quantity);
                                                                IF ("Entry Type" = "Entry Type"::Output) AND
                                                                   ("Value Entry Type" <> "Value Entry Type"::Revaluation)
                                                                THEN
                                                                  "Invoiced Quantity" := 0
                                                                ELSE
                                                                  "Invoiced Quantity" := Quantity;
                                                                "Invoiced Qty. (Base)" := CalcBaseQty("Invoiced Quantity");

                                                                GetUnitAmount(FIELDNO(Quantity));
                                                                UpdateAmount;

                                                                CheckItemAvailable(FIELDNO(Quantity));

                                                                IF "Entry Type" = "Entry Type"::Transfer THEN BEGIN
                                                                  "Qty. (Calculated)" := 0;
                                                                  "Qty. (Phys. Inventory)" := 0;
                                                                  "Last Item Ledger Entry No." := 0;
                                                                END;

                                                                CALCFIELDS("Reserved Qty. (Base)");
                                                                IF ABS("Quantity (Base)") < ABS("Reserved Qty. (Base)") THEN
                                                                  ERROR(Text001,FIELDCAPTION("Reserved Qty. (Base)"));

                                                                IF Item."Item Tracking Code" <> '' THEN
                                                                  ReserveItemJnlLine.VerifyQuantity(Rec,xRec);
                                                              END;

                                                   CaptionML=[ENU=Quantity;
                                                              NOR=Antall];
                                                   DecimalPlaces=0:5 }
    { 15  ;   ;Invoiced Quantity   ;Decimal       ;CaptionML=[ENU=Invoiced Quantity;
                                                              NOR=Fakturert antall];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 16  ;   ;Unit Amount         ;Decimal       ;OnValidate=BEGIN
                                                                UpdateAmount;
                                                                IF "Item No." <> '' THEN BEGIN
                                                                  IF "Value Entry Type" = "Value Entry Type"::Revaluation THEN
                                                                    "Unit Cost" := "Unit Amount"
                                                                  ELSE
                                                                    CASE "Entry Type" OF
                                                                      "Entry Type"::Purchase,
                                                                      "Entry Type"::"Positive Adjmt.",
                                                                      "Entry Type"::"Assembly Output":
                                                                        BEGIN
                                                                          IF "Entry Type" = "Entry Type"::"Positive Adjmt." THEN BEGIN
                                                                            GetItem;
                                                                            IF (CurrFieldNo = FIELDNO("Unit Amount")) AND
                                                                               (Item."Costing Method" = Item."Costing Method"::Standard)
                                                                            THEN
                                                                              ERROR(
                                                                                Text002,
                                                                                FIELDCAPTION("Unit Amount"),Item.FIELDCAPTION("Costing Method"),Item."Costing Method");
                                                                          END;

                                                                          ReadGLSetup;
                                                                          IF "Entry Type" = "Entry Type"::Purchase THEN
                                                                            "Unit Cost" := "Unit Amount";
                                                                          IF "Entry Type" = "Entry Type"::"Positive Adjmt." THEN
                                                                            "Unit Cost" :=
                                                                              ROUND(
                                                                                "Unit Amount" * (1 + "Indirect Cost %" / 100),GLSetup."Unit-Amount Rounding Precision") +
                                                                              "Overhead Rate" * "Qty. per Unit of Measure";
                                                                          IF ("Value Entry Type" = "Value Entry Type"::"Direct Cost") AND
                                                                             ("Item Charge No." = '')
                                                                          THEN
                                                                            VALIDATE("Unit Cost");
                                                                        END;
                                                                      "Entry Type"::"Negative Adjmt.",
                                                                      "Entry Type"::Consumption,
                                                                      "Entry Type"::"Assembly Consumption":
                                                                        BEGIN
                                                                          GetItem;
                                                                          IF (CurrFieldNo = FIELDNO("Unit Amount")) AND
                                                                             (Item."Costing Method" = Item."Costing Method"::Standard)
                                                                          THEN
                                                                            ERROR(
                                                                              Text002,
                                                                              FIELDCAPTION("Unit Amount"),Item.FIELDCAPTION("Costing Method"),Item."Costing Method");
                                                                          "Unit Cost" := "Unit Amount";
                                                                          IF ("Value Entry Type" = "Value Entry Type"::"Direct Cost") AND
                                                                             ("Item Charge No." = '')
                                                                          THEN
                                                                            VALIDATE("Unit Cost");
                                                                        END;
                                                                    END;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Unit Amount;
                                                              NOR=Enhetsbel›p];
                                                   AutoFormatType=2 }
    { 17  ;   ;Unit Cost           ;Decimal       ;OnValidate=BEGIN
                                                                TESTFIELD("Item No.");
                                                                RetrieveCosts;
                                                                IF "Entry Type" IN ["Entry Type"::Purchase,"Entry Type"::"Positive Adjmt.","Entry Type"::Consumption] THEN BEGIN
                                                                  IF Item."Costing Method" = Item."Costing Method"::Standard THEN BEGIN
                                                                    IF CurrFieldNo = FIELDNO("Unit Cost") THEN
                                                                      ERROR(
                                                                        Text002,
                                                                        FIELDCAPTION("Unit Cost"),Item.FIELDCAPTION("Costing Method"),Item."Costing Method");
                                                                    "Unit Cost" := ROUND(UnitCost * "Qty. per Unit of Measure",GLSetup."Unit-Amount Rounding Precision");
                                                                  END;
                                                                END;

                                                                IF ("Item Charge No." = '') AND
                                                                   ("Value Entry Type" = "Value Entry Type"::"Direct Cost") AND
                                                                   (CurrFieldNo = FIELDNO("Unit Cost"))
                                                                THEN BEGIN
                                                                  CASE "Entry Type" OF
                                                                    "Entry Type"::Purchase:
                                                                      "Unit Amount" := "Unit Cost";
                                                                    "Entry Type"::"Positive Adjmt.",
                                                                    "Entry Type"::"Assembly Output":
                                                                      BEGIN
                                                                        ReadGLSetup;
                                                                        "Unit Amount" :=
                                                                          ROUND(
                                                                            ("Unit Cost" - "Overhead Rate" * "Qty. per Unit of Measure") / (1 + "Indirect Cost %" / 100),
                                                                            GLSetup."Unit-Amount Rounding Precision")
                                                                      END;
                                                                    "Entry Type"::"Negative Adjmt.",
                                                                    "Entry Type"::Consumption,
                                                                    "Entry Type"::"Assembly Consumption":
                                                                      BEGIN
                                                                        IF Item."Costing Method" = Item."Costing Method"::Standard THEN
                                                                          ERROR(
                                                                            Text002,
                                                                            FIELDCAPTION("Unit Cost"),Item.FIELDCAPTION("Costing Method"),Item."Costing Method");
                                                                        "Unit Amount" := "Unit Cost";
                                                                      END;
                                                                  END;
                                                                  UpdateAmount;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Unit Cost;
                                                              NOR=Enhetskost];
                                                   AutoFormatType=2 }
    { 18  ;   ;Amount              ;Decimal       ;OnValidate=BEGIN
                                                                TESTFIELD(Quantity);
                                                                "Unit Amount" := Amount / Quantity;
                                                                VALIDATE("Unit Amount");
                                                                ReadGLSetup;
                                                                "Unit Amount" := ROUND("Unit Amount",GLSetup."Unit-Amount Rounding Precision");
                                                              END;

                                                   CaptionML=[ENU=Amount;
                                                              NOR=Bel›p];
                                                   AutoFormatType=1 }
    { 22  ;   ;Discount Amount     ;Decimal       ;CaptionML=[ENU=Discount Amount;
                                                              NOR=Rabattbel›p];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 23  ;   ;Salespers./Purch. Code;Code10      ;TableRelation=Salesperson/Purchaser;
                                                   OnValidate=BEGIN
                                                                IF ("Order Type" <> "Order Type"::Production) OR ("Order No." = '') THEN
                                                                  CreateDim(
                                                                    DATABASE::"Salesperson/Purchaser","Salespers./Purch. Code",
                                                                    DATABASE::Item,"Item No.",
                                                                    DATABASE::"Work Center","Work Center No.");
                                                              END;

                                                   CaptionML=[ENU=Salespers./Purch. Code;
                                                              NOR=Selger/innkj›per - kode] }
    { 26  ;   ;Source Code         ;Code10        ;TableRelation="Source Code";
                                                   CaptionML=[ENU=Source Code;
                                                              NOR=Kildespor];
                                                   Editable=No }
    { 29  ;   ;Applies-to Entry    ;Integer       ;OnValidate=VAR
                                                                ItemLedgEntry@1000 : Record 32;
                                                                ItemTrackingLines@1001 : Page 6510;
                                                              BEGIN
                                                                IF "Applies-to Entry" <> 0 THEN BEGIN
                                                                  ItemLedgEntry.GET("Applies-to Entry");

                                                                  IF "Value Entry Type" = "Value Entry Type"::Revaluation THEN BEGIN
                                                                    IF "Inventory Value Per" <> "Inventory Value Per"::" " THEN
                                                                      ERROR(Text006,FIELDCAPTION("Applies-to Entry"));

                                                                    IF "Inventory Value Per" = "Inventory Value Per"::" " THEN
                                                                      IF NOT RevaluationPerEntryAllowed(Item."No.") THEN
                                                                        ERROR(Text034);

                                                                    InitRevalJnlLine(ItemLedgEntry);
                                                                    ItemLedgEntry.TESTFIELD(Positive,TRUE);
                                                                  END ELSE BEGIN
                                                                    TESTFIELD(Quantity);
                                                                    IF Signed(Quantity) * ItemLedgEntry.Quantity > 0 THEN BEGIN
                                                                      IF Quantity > 0 THEN
                                                                        FIELDERROR(Quantity,Text030);
                                                                      IF Quantity < 0 THEN
                                                                        FIELDERROR(Quantity,Text029);
                                                                    END;
                                                                    IF ItemLedgEntry.TrackingExists THEN
                                                                      ERROR(Text033,FIELDCAPTION("Applies-to Entry"),ItemTrackingLines.CAPTION);

                                                                    IF NOT ItemLedgEntry.Open THEN
                                                                      MESSAGE(Text032,"Applies-to Entry");

                                                                    IF "Entry Type" = "Entry Type"::Output THEN BEGIN
                                                                      ItemLedgEntry.TESTFIELD("Order Type","Order Type"::Production);
                                                                      ItemLedgEntry.TESTFIELD("Order No.","Order No.");
                                                                      ItemLedgEntry.TESTFIELD("Order Line No.","Order Line No.");
                                                                      ItemLedgEntry.TESTFIELD("Entry Type","Entry Type");
                                                                    END;
                                                                  END;

                                                                  "Location Code" := ItemLedgEntry."Location Code";
                                                                  "Variant Code" := ItemLedgEntry."Variant Code";
                                                                END ELSE BEGIN
                                                                  IF "Value Entry Type" = "Value Entry Type"::Revaluation THEN BEGIN
                                                                    VALIDATE("Unit Amount",0);
                                                                    VALIDATE(Quantity,0);
                                                                    "Inventory Value (Calculated)" := 0;
                                                                    "Inventory Value (Revalued)" := 0;
                                                                    "Location Code" := '';
                                                                    "Variant Code" := '';
                                                                    "Bin Code" := '';
                                                                  END;
                                                                END;
                                                              END;

                                                   OnLookup=BEGIN
                                                              SelectItemEntry(FIELDNO("Applies-to Entry"));
                                                            END;

                                                   CaptionML=[ENU=Applies-to Entry;
                                                              NOR=Utligningspost] }
    { 32  ;   ;Item Shpt. Entry No.;Integer       ;CaptionML=[ENU=Item Shpt. Entry No.;
                                                              NOR=Varelev.l›penr.];
                                                   Editable=No }
    { 34  ;   ;Shortcut Dimension 1 Code;Code20   ;TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(1));
                                                   OnValidate=BEGIN
                                                                ValidateShortcutDimCode(1,"Shortcut Dimension 1 Code");
                                                              END;

                                                   CaptionML=[ENU=Shortcut Dimension 1 Code;
                                                              NOR=Snarveisdimensjon 1 - kode];
                                                   CaptionClass='1,2,1' }
    { 35  ;   ;Shortcut Dimension 2 Code;Code20   ;TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(2));
                                                   OnValidate=BEGIN
                                                                ValidateShortcutDimCode(2,"Shortcut Dimension 2 Code");
                                                              END;

                                                   CaptionML=[ENU=Shortcut Dimension 2 Code;
                                                              NOR=Snarveisdimensjon 2 - kode];
                                                   CaptionClass='1,2,2' }
    { 37  ;   ;Indirect Cost %     ;Decimal       ;OnValidate=BEGIN
                                                                TESTFIELD("Item No.");
                                                                TESTFIELD("Value Entry Type","Value Entry Type"::"Direct Cost");
                                                                TESTFIELD("Item Charge No.",'');
                                                                IF "Entry Type" IN ["Entry Type"::Sale,"Entry Type"::"Negative Adjmt."] THEN
                                                                  ERROR(
                                                                    Text002,
                                                                    FIELDCAPTION("Indirect Cost %"),FIELDCAPTION("Entry Type"),"Entry Type");

                                                                GetItem;
                                                                IF Item."Costing Method" = Item."Costing Method"::Standard THEN
                                                                  ERROR(
                                                                    Text002,
                                                                    FIELDCAPTION("Indirect Cost %"),Item.FIELDCAPTION("Costing Method"),Item."Costing Method");

                                                                IF "Entry Type" <> "Entry Type"::Purchase THEN
                                                                  "Unit Cost" :=
                                                                    ROUND(
                                                                      "Unit Amount" * (1 + "Indirect Cost %" / 100) +
                                                                      "Overhead Rate" * "Qty. per Unit of Measure",GLSetup."Unit-Amount Rounding Precision");
                                                              END;

                                                   CaptionML=[ENU=Indirect Cost %;
                                                              NOR=Indirekte kost-%];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
    { 39  ;   ;Source Type         ;Option        ;CaptionML=[ENU=Source Type;
                                                              NOR=Kildetype];
                                                   OptionCaptionML=[ENU=" ,Customer,Vendor,Item";
                                                                    NOR=" ,Kunde,Leverand›r,Vare"];
                                                   OptionString=[ ,Customer,Vendor,Item];
                                                   Editable=No }
    { 41  ;   ;Journal Batch Name  ;Code10        ;TableRelation="Item Journal Batch".Name WHERE (Journal Template Name=FIELD(Journal Template Name));
                                                   CaptionML=[ENU=Journal Batch Name;
                                                              NOR=Kladdenavn] }
    { 42  ;   ;Reason Code         ;Code10        ;TableRelation="Reason Code";
                                                   CaptionML=[ENU=Reason Code;
                                                              NOR=rsaksspor] }
    { 43  ;   ;Recurring Method    ;Option        ;CaptionML=[ENU=Recurring Method;
                                                              NOR=Gjentakelsesprinsipp];
                                                   OptionCaptionML=[ENU=,Fixed,Variable;
                                                                    NOR=,Fast,Variabel];
                                                   OptionString=,Fixed,Variable;
                                                   BlankZero=Yes }
    { 44  ;   ;Expiration Date     ;Date          ;CaptionML=[ENU=Expiration Date;
                                                              NOR=Utg†r den] }
    { 45  ;   ;Recurring Frequency ;DateFormula   ;CaptionML=[ENU=Recurring Frequency;
                                                              NOR=Gjentakelsesintervall] }
    { 46  ;   ;Drop Shipment       ;Boolean       ;AccessByPermission=TableData 223=R;
                                                   CaptionML=[ENU=Drop Shipment;
                                                              NOR=Direkte levering];
                                                   Editable=No }
    { 47  ;   ;Transaction Type    ;Code10        ;TableRelation="Transaction Type";
                                                   CaptionML=[ENU=Transaction Type;
                                                              NOR=Transaksjonsart] }
    { 48  ;   ;Transport Method    ;Code10        ;TableRelation="Transport Method";
                                                   CaptionML=[ENU=Transport Method;
                                                              NOR=Transportm†te] }
    { 49  ;   ;Country/Region Code ;Code10        ;TableRelation=Country/Region;
                                                   CaptionML=[ENU=Country/Region Code;
                                                              NOR=Lands-/regionkode] }
    { 50  ;   ;New Location Code   ;Code10        ;TableRelation=Location;
                                                   OnValidate=BEGIN
                                                                TESTFIELD("Entry Type","Entry Type"::Transfer);
                                                                IF "New Location Code" <> xRec."New Location Code" THEN BEGIN
                                                                  "New Bin Code" := '';
                                                                  IF ("New Location Code" <> '') AND ("Item No." <> '') THEN BEGIN
                                                                    GetLocation("New Location Code");
                                                                    IF Location."Bin Mandatory" AND NOT Location."Directed Put-away and Pick" THEN
                                                                      WMSManagement.GetDefaultBin("Item No.","Variant Code","New Location Code","New Bin Code")
                                                                  END;
                                                                END;

                                                                ReserveItemJnlLine.VerifyChange(Rec,xRec);
                                                              END;

                                                   CaptionML=[ENU=New Location Code;
                                                              NOR=Ny lokasjonskode] }
    { 51  ;   ;New Shortcut Dimension 1 Code;Code20;
                                                   TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(1));
                                                   OnValidate=BEGIN
                                                                TESTFIELD("Entry Type","Entry Type"::Transfer);
                                                                ValidateNewShortcutDimCode(1,"New Shortcut Dimension 1 Code");
                                                              END;

                                                   CaptionML=[ENU=New Shortcut Dimension 1 Code;
                                                              NOR=Ny snarveisdimensj. 1 - kode];
                                                   CaptionClass='1,2,1,' + Text007 }
    { 52  ;   ;New Shortcut Dimension 2 Code;Code20;
                                                   TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(2));
                                                   OnValidate=BEGIN
                                                                TESTFIELD("Entry Type","Entry Type"::Transfer);
                                                                ValidateNewShortcutDimCode(2,"New Shortcut Dimension 2 Code");
                                                              END;

                                                   CaptionML=[ENU=New Shortcut Dimension 2 Code;
                                                              NOR=Ny snarveisdimensj. 2 - kode];
                                                   CaptionClass='1,2,2,' + Text007 }
    { 53  ;   ;Qty. (Calculated)   ;Decimal       ;OnValidate=BEGIN
                                                                VALIDATE("Qty. (Phys. Inventory)");
                                                              END;

                                                   CaptionML=[ENU=Qty. (Calculated);
                                                              NOR=Antall (beregnet)];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 54  ;   ;Qty. (Phys. Inventory);Decimal     ;OnValidate=BEGIN
                                                                TESTFIELD("Phys. Inventory",TRUE);

                                                                IF CurrFieldNo <> 0 THEN
                                                                  WMSManagement.CheckItemJnlLineFieldChange(Rec,xRec,FIELDCAPTION("Qty. (Phys. Inventory)"));

                                                                PhysInvtEntered := TRUE;
                                                                Quantity := 0;
                                                                IF "Qty. (Phys. Inventory)" >= "Qty. (Calculated)" THEN BEGIN
                                                                  VALIDATE("Entry Type","Entry Type"::"Positive Adjmt.");
                                                                  VALIDATE(Quantity,"Qty. (Phys. Inventory)" - "Qty. (Calculated)");
                                                                END ELSE BEGIN
                                                                  VALIDATE("Entry Type","Entry Type"::"Negative Adjmt.");
                                                                  VALIDATE(Quantity,"Qty. (Calculated)" - "Qty. (Phys. Inventory)");
                                                                END;
                                                                PhysInvtEntered := FALSE;
                                                              END;

                                                   CaptionML=[ENU=Qty. (Phys. Inventory);
                                                              NOR=Antall (opptalt)];
                                                   DecimalPlaces=0:5 }
    { 55  ;   ;Last Item Ledger Entry No.;Integer ;TableRelation="Item Ledger Entry";
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Last Item Ledger Entry No.;
                                                              NOR=Siste varepostnr.];
                                                   Editable=No }
    { 56  ;   ;Phys. Inventory     ;Boolean       ;CaptionML=[ENU=Phys. Inventory;
                                                              NOR=Vareopptelling];
                                                   Editable=No }
    { 57  ;   ;Gen. Bus. Posting Group;Code10     ;TableRelation="Gen. Business Posting Group";
                                                   CaptionML=[ENU=Gen. Bus. Posting Group;
                                                              NOR=Bokf›ringsgruppe - firma] }
    { 58  ;   ;Gen. Prod. Posting Group;Code10    ;TableRelation="Gen. Product Posting Group";
                                                   CaptionML=[ENU=Gen. Prod. Posting Group;
                                                              NOR=Bokf›ringsgruppe - vare] }
    { 59  ;   ;Entry/Exit Point    ;Code10        ;TableRelation="Entry/Exit Point";
                                                   CaptionML=[ENU=Entry/Exit Point;
                                                              NOR=Inn/Utpunkt] }
    { 60  ;   ;Document Date       ;Date          ;CaptionML=[ENU=Document Date;
                                                              NOR=Bilagsdato] }
    { 62  ;   ;External Document No.;Code35       ;CaptionML=[ENU=External Document No.;
                                                              NOR=Eksterndokumentnr.] }
    { 63  ;   ;Area                ;Code10        ;TableRelation=Area;
                                                   CaptionML=[ENU=Area;
                                                              NOR=Omr†de] }
    { 64  ;   ;Transaction Specification;Code10   ;TableRelation="Transaction Specification";
                                                   CaptionML=[ENU=Transaction Specification;
                                                              NOR=Transaksjonsspesifikasjon] }
    { 65  ;   ;Posting No. Series  ;Code10        ;TableRelation="No. Series";
                                                   CaptionML=[ENU=Posting No. Series;
                                                              NOR=Bokf›ringsnr.serie] }
    { 68  ;   ;Reserved Quantity   ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Reservation Entry".Quantity WHERE (Source ID=FIELD(Journal Template Name),
                                                                                                       Source Ref. No.=FIELD(Line No.),
                                                                                                       Source Type=CONST(83),
                                                                                                       Source Subtype=FIELD(Entry Type),
                                                                                                       Source Batch Name=FIELD(Journal Batch Name),
                                                                                                       Source Prod. Order Line=CONST(0),
                                                                                                       Reservation Status=CONST(Reservation)));
                                                   AccessByPermission=TableData 120=R;
                                                   CaptionML=[ENU=Reserved Quantity;
                                                              NOR=Reservert antall];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 72  ;   ;Unit Cost (ACY)     ;Decimal       ;CaptionML=[ENU=Unit Cost (ACY);
                                                              NOR=Enhetskost (t.val)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 73  ;   ;Source Currency Code;Code10        ;TableRelation=Currency;
                                                   AccessByPermission=TableData 223=R;
                                                   CaptionML=[ENU=Source Currency Code;
                                                              NOR=Kildevalutakode];
                                                   Editable=No }
    { 79  ;   ;Document Type       ;Option        ;CaptionML=[ENU=Document Type;
                                                              NOR=Bilagstype];
                                                   OptionCaptionML=[ENU=" ,Sales Shipment,Sales Invoice,Sales Return Receipt,Sales Credit Memo,Purchase Receipt,Purchase Invoice,Purchase Return Shipment,Purchase Credit Memo,Transfer Shipment,Transfer Receipt,Service Shipment,Service Invoice,Service Credit Memo,Posted Assembly";
                                                                    NOR=" ,F›lgeseddel,Salgsfaktura,Salgsreturseddel,Salgskreditnota,Kj›psmottak,Kj›psfaktura,Bestillingsreturforsendelse,Kj›pskreditnota,Overf›ringsseddel,Overf›ringsmottak,Servicef›lgeseddel,Servicefaktura,Salgskreditnota (service),Bokf›rt montering"];
                                                   OptionString=[ ,Sales Shipment,Sales Invoice,Sales Return Receipt,Sales Credit Memo,Purchase Receipt,Purchase Invoice,Purchase Return Shipment,Purchase Credit Memo,Transfer Shipment,Transfer Receipt,Service Shipment,Service Invoice,Service Credit Memo,Posted Assembly] }
    { 80  ;   ;Document Line No.   ;Integer       ;CaptionML=[ENU=Document Line No.;
                                                              NOR=Dokumentlinjenr.] }
    { 90  ;   ;Order Type          ;Option        ;OnValidate=BEGIN
                                                                IF "Order Type" = xRec."Order Type" THEN
                                                                  EXIT;
                                                                VALIDATE("Order No.",'');
                                                                "Order Line No." := 0;
                                                              END;

                                                   CaptionML=[ENU=Order Type;
                                                              NOR=Ordretype];
                                                   OptionCaptionML=[ENU=" ,Production,Transfer,Service,Assembly";
                                                                    NOR=" ,Produksjon,Overf›ring,Service,Montering"];
                                                   OptionString=[ ,Production,Transfer,Service,Assembly];
                                                   Editable=No }
    { 91  ;   ;Order No.           ;Code20        ;TableRelation=IF (Order Type=CONST(Production)) "Production Order".No. WHERE (Status=CONST(Released));
                                                   OnValidate=VAR
                                                                AssemblyHeader@1000 : Record 900;
                                                                ProdOrder@1001 : Record 5405;
                                                                ProdOrderLine@1002 : Record 5406;
                                                              BEGIN
                                                                CASE "Order Type" OF
                                                                  "Order Type"::Production,"Order Type"::Assembly:
                                                                    BEGIN
                                                                      IF "Order No." = '' THEN BEGIN
                                                                        CASE "Order Type" OF
                                                                          "Order Type"::Production:
                                                                            CreateProdDim;
                                                                          "Order Type"::Assembly:
                                                                            CreateAssemblyDim;
                                                                        END;
                                                                        EXIT;
                                                                      END;

                                                                      CASE "Order Type" OF
                                                                        "Order Type"::Production:
                                                                          BEGIN
                                                                            GetMfgSetup;
                                                                            IF MfgSetup."Doc. No. Is Prod. Order No." THEN
                                                                              "Document No." := "Order No.";
                                                                            ProdOrder.GET(ProdOrder.Status::Released,"Order No.");
                                                                            ProdOrder.TESTFIELD(Blocked,FALSE);
                                                                            Description := ProdOrder.Description;
                                                                          END;
                                                                        "Order Type"::Assembly:
                                                                          BEGIN
                                                                            AssemblyHeader.GET(AssemblyHeader."Document Type"::Order,"Order No.");
                                                                            Description := AssemblyHeader.Description;
                                                                          END;
                                                                      END;

                                                                      "Gen. Bus. Posting Group" := '';
                                                                      CASE TRUE OF
                                                                        "Entry Type" = "Entry Type"::Output:
                                                                          BEGIN
                                                                            "Inventory Posting Group" := ProdOrder."Inventory Posting Group";
                                                                            "Gen. Prod. Posting Group" := ProdOrder."Gen. Prod. Posting Group";
                                                                          END;
                                                                        "Entry Type" = "Entry Type"::"Assembly Output":
                                                                          BEGIN
                                                                            "Inventory Posting Group" := AssemblyHeader."Inventory Posting Group";
                                                                            "Gen. Prod. Posting Group" := AssemblyHeader."Gen. Prod. Posting Group";
                                                                          END;
                                                                        "Entry Type" = "Entry Type"::Consumption:
                                                                          BEGIN
                                                                            ProdOrderLine.SetFilterByReleasedOrderNo("Order No.");
                                                                            IF ProdOrderLine.COUNT = 1 THEN BEGIN
                                                                              ProdOrderLine.FINDFIRST;
                                                                              VALIDATE("Order Line No.",ProdOrderLine."Line No.");
                                                                            END;
                                                                          END;
                                                                      END;

                                                                      IF ("Order No." <> xRec."Order No.") OR ("Order Type" <> xRec."Order Type") THEN
                                                                        CASE "Order Type" OF
                                                                          "Order Type"::Production:
                                                                            CreateProdDim;
                                                                          "Order Type"::Assembly:
                                                                            CreateAssemblyDim;
                                                                        END;
                                                                    END;
                                                                  "Order Type"::Transfer,"Order Type"::Service,"Order Type"::" ":
                                                                    ERROR(Text002,FIELDCAPTION("Order No."),FIELDCAPTION("Order Type"),"Order Type");
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Order No.;
                                                              NOR=Ordrenr.] }
    { 92  ;   ;Order Line No.      ;Integer       ;TableRelation=IF (Order Type=CONST(Production)) "Prod. Order Line"."Line No." WHERE (Status=CONST(Released),
                                                                                                                                        Prod. Order No.=FIELD(Order No.));
                                                   OnValidate=VAR
                                                                ProdOrderLine@1000 : Record 5406;
                                                              BEGIN
                                                                TESTFIELD("Order No.");
                                                                CASE "Order Type" OF
                                                                  "Order Type"::Production,"Order Type"::Assembly:
                                                                    BEGIN
                                                                      IF "Order Type" = "Order Type"::Production THEN BEGIN
                                                                        ProdOrderLine.SetFilterByReleasedOrderNo("Order No.");
                                                                        ProdOrderLine.SETRANGE("Line No.","Order Line No.");
                                                                        IF ProdOrderLine.FINDFIRST THEN BEGIN
                                                                          "Source Type" := "Source Type"::Item;
                                                                          "Source No." := ProdOrderLine."Item No.";
                                                                          "Order Line No." := ProdOrderLine."Line No.";
                                                                          "Routing No." := ProdOrderLine."Routing No.";
                                                                          "Routing Reference No." := ProdOrderLine."Routing Reference No.";
                                                                          IF "Entry Type" = "Entry Type"::Output THEN BEGIN
                                                                            "Location Code" := ProdOrderLine."Location Code";
                                                                            "Bin Code" := ProdOrderLine."Bin Code";
                                                                          END;
                                                                        END;
                                                                      END;

                                                                      IF "Order Line No." <> xRec."Order Line No." THEN
                                                                        CASE "Order Type" OF
                                                                          "Order Type"::Production:
                                                                            CreateProdDim;
                                                                          "Order Type"::Assembly:
                                                                            CreateAssemblyDim;
                                                                        END;
                                                                    END;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Order Line No.;
                                                              NOR=Ordrelinjenr.] }
    { 480 ;   ;Dimension Set ID    ;Integer       ;TableRelation="Dimension Set Entry";
                                                   OnLookup=BEGIN
                                                              ShowDimensions;
                                                            END;

                                                   CaptionML=[ENU=Dimension Set ID;
                                                              NOR=Dimensjonssett-ID];
                                                   Editable=No }
    { 481 ;   ;New Dimension Set ID;Integer       ;TableRelation="Dimension Set Entry";
                                                   OnLookup=BEGIN
                                                              ShowDimensions;
                                                            END;

                                                   CaptionML=[ENU=New Dimension Set ID;
                                                              NOR=Ny dimensjonssett-ID];
                                                   Editable=No }
    { 904 ;   ;Assemble to Order   ;Boolean       ;CaptionML=[ENU=Assemble to Order;
                                                              NOR=Monter til ordre];
                                                   Editable=No }
    { 1000;   ;Job No.             ;Code20        ;CaptionML=[ENU=Job No.;
                                                              NOR=Prosjektnr.] }
    { 1001;   ;Job Task No.        ;Code20        ;CaptionML=[ENU=Job Task No.;
                                                              NOR=Prosjektoppgavenr.] }
    { 1002;   ;Job Purchase        ;Boolean       ;CaptionML=[ENU=Job Purchase;
                                                              NOR=Prosjektkj›p] }
    { 1030;   ;Job Contract Entry No.;Integer     ;CaptionML=[ENU=Job Contract Entry No.;
                                                              NOR=L›penr. for prosjektkontrakt];
                                                   Editable=No }
    { 5402;   ;Variant Code        ;Code10        ;TableRelation="Item Variant".Code WHERE (Item No.=FIELD(Item No.));
                                                   OnValidate=BEGIN
                                                                IF "Entry Type" IN ["Entry Type"::Consumption,"Entry Type"::Output] THEN
                                                                  WhseValidateSourceLine.ItemLineVerifyChange(Rec,xRec);

                                                                IF "Variant Code" <> xRec."Variant Code" THEN BEGIN
                                                                  "Bin Code" := '';
                                                                  IF CurrFieldNo <> 0 THEN
                                                                    WMSManagement.CheckItemJnlLineFieldChange(Rec,xRec,FIELDCAPTION("Variant Code"));
                                                                  IF ("Location Code" <> '') AND ("Item No." <> '') THEN BEGIN
                                                                    GetLocation("Location Code");
                                                                    IF Location."Bin Mandatory" AND NOT Location."Directed Put-away and Pick" THEN
                                                                      WMSManagement.GetDefaultBin("Item No.","Variant Code","Location Code","Bin Code")
                                                                  END;
                                                                  IF ("Entry Type" = "Entry Type"::Transfer) AND ("Location Code" = "New Location Code") THEN
                                                                    "New Bin Code" := "Bin Code";
                                                                END;
                                                                IF ("Value Entry Type" = "Value Entry Type"::"Direct Cost") AND
                                                                   ("Item Charge No." = '')
                                                                THEN BEGIN
                                                                  GetUnitAmount(FIELDNO("Variant Code"));
                                                                  "Unit Cost" := UnitCost;
                                                                  VALIDATE("Unit Amount");
                                                                  VALIDATE("Unit of Measure Code");
                                                                  ReserveItemJnlLine.VerifyChange(Rec,xRec);
                                                                END;

                                                                IF "Variant Code" <> '' THEN BEGIN
                                                                  ItemVariant.GET("Item No.","Variant Code");
                                                                  Description := ItemVariant.Description;
                                                                END ELSE BEGIN
                                                                  GetItem;
                                                                  Description := Item.Description;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Variant Code;
                                                              NOR=Variantkode] }
    { 5403;   ;Bin Code            ;Code20        ;TableRelation=IF (Entry Type=FILTER(Purchase|Positive Adjmt.|Output),
                                                                     Quantity=FILTER(>=0)) Bin.Code WHERE (Location Code=FIELD(Location Code),
                                                                                                           Item Filter=FIELD(Item No.),
                                                                                                           Variant Filter=FIELD(Variant Code))
                                                                                                           ELSE IF (Entry Type=FILTER(Purchase|Positive Adjmt.|Output),
                                                                                                                    Quantity=FILTER(<0)) "Bin Content"."Bin Code" WHERE (Location Code=FIELD(Location Code),
                                                                                                                                                                         Item No.=FIELD(Item No.),
                                                                                                                                                                         Variant Code=FIELD(Variant Code))
                                                                                                                                                                         ELSE IF (Entry Type=FILTER(Sale|Negative Adjmt.|Transfer|Consumption),
                                                                                                                                                                                  Quantity=FILTER(>0)) "Bin Content"."Bin Code" WHERE (Location Code=FIELD(Location Code),
                                                                                                                                                                                                                                       Item No.=FIELD(Item No.),
                                                                                                                                                                                                                                       Variant Code=FIELD(Variant Code))
                                                                                                                                                                                                                                       ELSE IF (Entry Type=FILTER(Sale|Negative Adjmt.|Transfer|Consumption),
                                                                                                                                                                                                                                                Quantity=FILTER(<=0)) Bin.Code WHERE (Location Code=FIELD(Location Code),
                                                                                                                                                                                                                                                                                      Item Filter=FIELD(Item No.),
                                                                                                                                                                                                                                                                                      Variant Filter=FIELD(Variant Code));
                                                   OnValidate=VAR
                                                                ProdOrderComp@1001 : Record 5407;
                                                                WhseIntegrationMgt@1000 : Codeunit 7317;
                                                              BEGIN
                                                                IF "Bin Code" <> xRec."Bin Code" THEN BEGIN
                                                                  TESTFIELD("Location Code");
                                                                  IF "Bin Code" <> '' THEN BEGIN
                                                                    GetBin("Location Code","Bin Code");
                                                                    GetLocation("Location Code");
                                                                    Location.TESTFIELD("Bin Mandatory");
                                                                    IF CurrFieldNo <> 0 THEN
                                                                      WMSManagement.CheckItemJnlLineFieldChange(Rec,xRec,FIELDCAPTION("Bin Code"));
                                                                    TESTFIELD("Location Code",Bin."Location Code");
                                                                    WhseIntegrationMgt.CheckBinTypeCode(DATABASE::"Item Journal Line",
                                                                      FIELDCAPTION("Bin Code"),
                                                                      "Location Code",
                                                                      "Bin Code",
                                                                      "Entry Type");
                                                                  END;
                                                                  IF ("Entry Type" = "Entry Type"::Transfer) AND ("Location Code" = "New Location Code") THEN
                                                                    "New Bin Code" := "Bin Code";

                                                                  IF ("Entry Type" = "Entry Type"::Consumption) AND
                                                                     ("Bin Code" <> '') AND ("Prod. Order Comp. Line No." <> 0)
                                                                  THEN BEGIN
                                                                    TESTFIELD("Order Type","Order Type"::Production);
                                                                    TESTFIELD("Order No.");
                                                                    ProdOrderComp.GET(ProdOrderComp.Status::Released,"Order No.","Order Line No.","Prod. Order Comp. Line No.");
                                                                    IF (ProdOrderComp."Bin Code" <> '') AND (ProdOrderComp."Bin Code" <> "Bin Code") THEN
                                                                      IF NOT CONFIRM(
                                                                           Text021,
                                                                           FALSE,
                                                                           "Bin Code",
                                                                           ProdOrderComp."Bin Code",
                                                                           "Order No.")
                                                                      THEN
                                                                        ERROR(Text012);
                                                                  END;
                                                                END;

                                                                ReserveItemJnlLine.VerifyChange(Rec,xRec);
                                                              END;

                                                   CaptionML=[ENU=Bin Code;
                                                              NOR=Hyllekode] }
    { 5404;   ;Qty. per Unit of Measure;Decimal   ;InitValue=1;
                                                   CaptionML=[ENU=Qty. per Unit of Measure;
                                                              NOR=Antall per enhet];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 5406;   ;New Bin Code        ;Code20        ;TableRelation=Bin.Code WHERE (Location Code=FIELD(New Location Code),
                                                                                 Item Filter=FIELD(Item No.),
                                                                                 Variant Filter=FIELD(Variant Code));
                                                   OnValidate=VAR
                                                                WhseIntegrationMgt@1000 : Codeunit 7317;
                                                              BEGIN
                                                                TESTFIELD("Entry Type","Entry Type"::Transfer);
                                                                IF "New Bin Code" <> xRec."New Bin Code" THEN BEGIN
                                                                  TESTFIELD("New Location Code");
                                                                  IF "New Bin Code" <> '' THEN BEGIN
                                                                    GetBin("New Location Code","New Bin Code");
                                                                    GetLocation("New Location Code");
                                                                    Location.TESTFIELD("Bin Mandatory");
                                                                    IF CurrFieldNo <> 0 THEN
                                                                      WMSManagement.CheckItemJnlLineFieldChange(Rec,xRec,FIELDCAPTION("New Bin Code"));
                                                                    TESTFIELD("New Location Code",Bin."Location Code");
                                                                    WhseIntegrationMgt.CheckBinTypeCode(DATABASE::"Item Journal Line",
                                                                      FIELDCAPTION("New Bin Code"),
                                                                      "New Location Code",
                                                                      "New Bin Code",
                                                                      "Entry Type");
                                                                  END;
                                                                END;

                                                                ReserveItemJnlLine.VerifyChange(Rec,xRec);
                                                              END;

                                                   CaptionML=[ENU=New Bin Code;
                                                              NOR=Ny hyllekode] }
    { 5407;   ;Unit of Measure Code;Code10        ;TableRelation="Item Unit of Measure".Code WHERE (Item No.=FIELD(Item No.));
                                                   OnValidate=BEGIN
                                                                GetItem;
                                                                "Qty. per Unit of Measure" := UOMMgt.GetQtyPerUnitOfMeasure(Item,"Unit of Measure Code");

                                                                IF "Entry Type" IN ["Entry Type"::Consumption,"Entry Type"::Output] THEN
                                                                  WhseValidateSourceLine.ItemLineVerifyChange(Rec,xRec);

                                                                IF CurrFieldNo <> 0 THEN
                                                                  WMSManagement.CheckItemJnlLineFieldChange(Rec,xRec,FIELDCAPTION("Unit of Measure Code"));

                                                                GetUnitAmount(FIELDNO("Unit of Measure Code"));
                                                                IF "Value Entry Type" = "Value Entry Type"::Revaluation THEN
                                                                  TESTFIELD("Qty. per Unit of Measure",1);

                                                                ReadGLSetup;
                                                                "Unit Cost" := ROUND(UnitCost * "Qty. per Unit of Measure",GLSetup."Unit-Amount Rounding Precision");

                                                                IF "Entry Type" = "Entry Type"::Consumption THEN BEGIN
                                                                  "Indirect Cost %" := ROUND(Item."Indirect Cost %" * "Qty. per Unit of Measure",1);
                                                                  "Overhead Rate" :=
                                                                    ROUND(Item."Overhead Rate" * "Qty. per Unit of Measure",GLSetup."Unit-Amount Rounding Precision");
                                                                  "Unit Amount" := ROUND(UnitCost * "Qty. per Unit of Measure",GLSetup."Unit-Amount Rounding Precision");
                                                                END;

                                                                IF "No." <> '' THEN
                                                                  VALIDATE("Cap. Unit of Measure Code");

                                                                VALIDATE("Unit Amount");

                                                                IF "Entry Type" = "Entry Type"::Output THEN BEGIN
                                                                  VALIDATE("Output Quantity");
                                                                  VALIDATE("Scrap Quantity");
                                                                END ELSE
                                                                  VALIDATE(Quantity);
                                                              END;

                                                   CaptionML=[ENU=Unit of Measure Code;
                                                              NOR=Enhetskode] }
    { 5408;   ;Derived from Blanket Order;Boolean ;CaptionML=[ENU=Derived from Blanket Order;
                                                              NOR=Stammer fra rammeordre];
                                                   Editable=No }
    { 5413;   ;Quantity (Base)     ;Decimal       ;OnValidate=BEGIN
                                                                TESTFIELD("Qty. per Unit of Measure",1);
                                                                VALIDATE(Quantity,"Quantity (Base)");
                                                              END;

                                                   CaptionML=[ENU=Quantity (Base);
                                                              NOR=Antall (lagerenhet)];
                                                   DecimalPlaces=0:5 }
    { 5415;   ;Invoiced Qty. (Base);Decimal       ;CaptionML=[ENU=Invoiced Qty. (Base);
                                                              NOR=Fakturert antall (lagerenhet)];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 5468;   ;Reserved Qty. (Base);Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Reservation Entry"."Quantity (Base)" WHERE (Source ID=FIELD(Journal Template Name),
                                                                                                                Source Ref. No.=FIELD(Line No.),
                                                                                                                Source Type=CONST(83),
                                                                                                                Source Subtype=FIELD(Entry Type),
                                                                                                                Source Batch Name=FIELD(Journal Batch Name),
                                                                                                                Source Prod. Order Line=CONST(0),
                                                                                                                Reservation Status=CONST(Reservation)));
                                                   AccessByPermission=TableData 120=R;
                                                   CaptionML=[ENU=Reserved Qty. (Base);
                                                              NOR=Reservert antall (lagerenhet)];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 5560;   ;Level               ;Integer       ;CaptionML=[ENU=Level;
                                                              NOR=Niv†];
                                                   Editable=No }
    { 5561;   ;Flushing Method     ;Option        ;CaptionML=[ENU=Flushing Method;
                                                              NOR=Trekkmetode];
                                                   OptionCaptionML=[ENU=Manual,Forward,Backward,Pick + Forward,Pick + Backward;
                                                                    NOR=Manuell,Fremover,Bakover,Plukk + Fremover,Plukk + Bakover];
                                                   OptionString=Manual,Forward,Backward,Pick + Forward,Pick + Backward;
                                                   Editable=No }
    { 5562;   ;Changed by User     ;Boolean       ;CaptionML=[ENU=Changed by User;
                                                              NOR=Endret av bruker];
                                                   Editable=No }
    { 5700;   ;Cross-Reference No. ;Code20        ;CaptionML=[ENU=Cross-Reference No.;
                                                              NOR=Kryssreferansenr.] }
    { 5701;   ;Originally Ordered No.;Code20      ;TableRelation=Item;
                                                   AccessByPermission=TableData 5715=R;
                                                   CaptionML=[ENU=Originally Ordered No.;
                                                              NOR=Opprinnelig ordreant.] }
    { 5702;   ;Originally Ordered Var. Code;Code10;TableRelation="Item Variant".Code WHERE (Item No.=FIELD(Originally Ordered No.));
                                                   AccessByPermission=TableData 5715=R;
                                                   CaptionML=[ENU=Originally Ordered Var. Code;
                                                              NOR=Opprin. best. variant - kode] }
    { 5703;   ;Out-of-Stock Substitution;Boolean  ;CaptionML=[ENU=Out-of-Stock Substitution;
                                                              NOR=Tomt p† lager-erstatning] }
    { 5704;   ;Item Category Code  ;Code20        ;TableRelation="Item Category";
                                                   CaptionML=[ENU=Item Category Code;
                                                              NOR=Varekategorikode] }
    { 5705;   ;Nonstock            ;Boolean       ;CaptionML=[ENU=Nonstock;
                                                              NOR=Katalogvare] }
    { 5706;   ;Purchasing Code     ;Code10        ;TableRelation=Purchasing;
                                                   AccessByPermission=TableData 223=R;
                                                   CaptionML=[ENU=Purchasing Code;
                                                              NOR=Kj›pskode] }
    { 5707;   ;Product Group Code  ;Code10        ;TableRelation="Product Group".Code WHERE (Item Category Code=FIELD(Item Category Code));
                                                   CaptionML=[ENU=Product Group Code;
                                                              NOR=Produktgruppekode] }
    { 5791;   ;Planned Delivery Date;Date         ;CaptionML=[ENU=Planned Delivery Date;
                                                              NOR=Planlagt lev.dato] }
    { 5793;   ;Order Date          ;Date          ;CaptionML=[ENU=Order Date;
                                                              NOR=Bestillingsdato] }
    { 5800;   ;Value Entry Type    ;Option        ;CaptionML=[ENU=Value Entry Type;
                                                              NOR=Verdiposttype];
                                                   OptionCaptionML=[ENU=Direct Cost,Revaluation,Rounding,Indirect Cost,Variance;
                                                                    NOR=Direktekostn.,Revaluering,Avrunding,Indirekte kost,Avvik];
                                                   OptionString=Direct Cost,Revaluation,Rounding,Indirect Cost,Variance }
    { 5801;   ;Item Charge No.     ;Code20        ;TableRelation="Item Charge";
                                                   CaptionML=[ENU=Item Charge No.;
                                                              NOR=Varegebyrnr.] }
    { 5802;   ;Inventory Value (Calculated);Decimal;
                                                   OnValidate=BEGIN
                                                                ReadGLSetup;
                                                                "Unit Cost (Calculated)" :=
                                                                  ROUND("Inventory Value (Calculated)" / Quantity,GLSetup."Unit-Amount Rounding Precision");
                                                              END;

                                                   CaptionML=[ENU=Inventory Value (Calculated);
                                                              NOR=Lagerverdi (beregnet)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 5803;   ;Inventory Value (Revalued);Decimal ;OnValidate=BEGIN
                                                                TESTFIELD("Value Entry Type","Value Entry Type"::Revaluation);
                                                                VALIDATE(Amount,"Inventory Value (Revalued)" - "Inventory Value (Calculated)");
                                                                ReadGLSetup;
                                                                IF ("Unit Cost (Revalued)" <> xRec."Unit Cost (Revalued)") OR
                                                                   ("Inventory Value (Revalued)" <> xRec."Inventory Value (Revalued)")
                                                                THEN BEGIN
                                                                  IF CurrFieldNo <> FIELDNO("Unit Cost (Revalued)") THEN
                                                                    "Unit Cost (Revalued)" :=
                                                                      ROUND("Inventory Value (Revalued)" / Quantity,GLSetup."Unit-Amount Rounding Precision");

                                                                  IF CurrFieldNo <> 0 THEN
                                                                    ClearSingleAndRolledUpCosts;
                                                                END
                                                              END;

                                                   CaptionML=[ENU=Inventory Value (Revalued);
                                                              NOR=Lagerverdi (revaluert)];
                                                   MinValue=0;
                                                   AutoFormatType=1 }
    { 5804;   ;Variance Type       ;Option        ;CaptionML=[ENU=Variance Type;
                                                              NOR=Avvikstype];
                                                   OptionCaptionML=[ENU=" ,Purchase,Material,Capacity,Capacity Overhead,Manufacturing Overhead";
                                                                    NOR=" ,Kj›p,Material,Kapasitet,Indirekte kap.kostn,Indirekte prod.kostn."];
                                                   OptionString=[ ,Purchase,Material,Capacity,Capacity Overhead,Manufacturing Overhead] }
    { 5805;   ;Inventory Value Per ;Option        ;CaptionML=[ENU=Inventory Value Per;
                                                              NOR=Lagerverdi per];
                                                   OptionCaptionML=[ENU=" ,Item,Location,Variant,Location and Variant";
                                                                    NOR=" ,Vare,Lokasjon,Variant,Lokasjon og variant"];
                                                   OptionString=[ ,Item,Location,Variant,Location and Variant];
                                                   Editable=No }
    { 5806;   ;Partial Revaluation ;Boolean       ;CaptionML=[ENU=Partial Revaluation;
                                                              NOR=Delvis revaluering];
                                                   Editable=No }
    { 5807;   ;Applies-from Entry  ;Integer       ;OnValidate=VAR
                                                                ItemLedgEntry@1000 : Record 32;
                                                                ItemTrackingLines@1001 : Page 6510;
                                                              BEGIN
                                                                IF "Applies-from Entry" <> 0 THEN BEGIN
                                                                  TESTFIELD(Quantity);
                                                                  IF Signed(Quantity) < 0 THEN BEGIN
                                                                    IF Quantity > 0 THEN
                                                                      FIELDERROR(Quantity,Text030);
                                                                    IF Quantity < 0 THEN
                                                                      FIELDERROR(Quantity,Text029);
                                                                  END;
                                                                  ItemLedgEntry.GET("Applies-from Entry");
                                                                  ItemLedgEntry.TESTFIELD(Positive,FALSE);
                                                                  IF ItemLedgEntry.TrackingExists THEN
                                                                    ERROR(Text033,FIELDCAPTION("Applies-from Entry"),ItemTrackingLines.CAPTION);
                                                                  "Unit Cost" := CalcUnitCost(ItemLedgEntry);
                                                                END;
                                                              END;

                                                   OnLookup=BEGIN
                                                              SelectItemEntry(FIELDNO("Applies-from Entry"));
                                                            END;

                                                   CaptionML=[ENU=Applies-from Entry;
                                                              NOR=Utlignet fra-post];
                                                   MinValue=0 }
    { 5808;   ;Invoice No.         ;Code20        ;CaptionML=[ENU=Invoice No.;
                                                              NOR=Fakturanr.] }
    { 5809;   ;Unit Cost (Calculated);Decimal     ;OnValidate=BEGIN
                                                                TESTFIELD("Value Entry Type","Value Entry Type"::Revaluation);
                                                              END;

                                                   CaptionML=[ENU=Unit Cost (Calculated);
                                                              NOR=Enhetskost (beregnet)];
                                                   Editable=No;
                                                   AutoFormatType=2 }
    { 5810;   ;Unit Cost (Revalued);Decimal       ;OnValidate=BEGIN
                                                                ReadGLSetup;
                                                                TESTFIELD("Value Entry Type","Value Entry Type"::Revaluation);
                                                                IF "Unit Cost (Revalued)" <> xRec."Unit Cost (Revalued)" THEN
                                                                  VALIDATE(
                                                                    "Inventory Value (Revalued)",
                                                                    ROUND(
                                                                      "Unit Cost (Revalued)" * Quantity,GLSetup."Amount Rounding Precision"));
                                                              END;

                                                   CaptionML=[ENU=Unit Cost (Revalued);
                                                              NOR=Enhetskost (revaluert)];
                                                   MinValue=0;
                                                   AutoFormatType=2 }
    { 5811;   ;Applied Amount      ;Decimal       ;CaptionML=[ENU=Applied Amount;
                                                              NOR=Utlignet bel›p];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 5812;   ;Update Standard Cost;Boolean       ;OnValidate=BEGIN
                                                                TESTFIELD("Inventory Value Per");
                                                                GetItem;
                                                                Item.TESTFIELD("Costing Method",Item."Costing Method"::Standard);
                                                              END;

                                                   CaptionML=[ENU=Update Standard Cost;
                                                              NOR=Oppdater standardkost] }
    { 5813;   ;Amount (ACY)        ;Decimal       ;CaptionML=[ENU=Amount (ACY);
                                                              NOR=Bel›p (till.val)];
                                                   AutoFormatType=1 }
    { 5817;   ;Correction          ;Boolean       ;CaptionML=[ENU=Correction;
                                                              NOR=Korreksjon] }
    { 5818;   ;Adjustment          ;Boolean       ;CaptionML=[ENU=Adjustment;
                                                              NOR=Justering] }
    { 5819;   ;Applies-to Value Entry;Integer     ;CaptionML=[ENU=Applies-to Value Entry;
                                                              NOR=Utligningsverdipost] }
    { 5820;   ;Invoice-to Source No.;Code20       ;TableRelation=IF (Source Type=CONST(Customer)) Customer
                                                                 ELSE IF (Source Type=CONST(Vendor)) Vendor;
                                                   CaptionML=[ENU=Invoice-to Source No.;
                                                              NOR=Faktura til-kildenr.] }
    { 5830;   ;Type                ;Option        ;OnValidate=BEGIN
                                                                IF Type = Type::Resource THEN
                                                                  TESTFIELD("Entry Type","Entry Type"::"Assembly Output")
                                                                ELSE
                                                                  TESTFIELD("Entry Type","Entry Type"::Output);
                                                                VALIDATE("No.",'');
                                                              END;

                                                   AccessByPermission=TableData 99000758=R;
                                                   CaptionML=[ENU=Type;
                                                              NOR=Type];
                                                   OptionCaptionML=[ENU=Work Center,Machine Center, ,Resource;
                                                                    NOR=Arbeidssenter,Maskinsenter, ,Ressurs];
                                                   OptionString=Work Center,Machine Center, ,Resource }
    { 5831;   ;No.                 ;Code20        ;TableRelation=IF (Type=CONST(Machine Center)) "Machine Center"
                                                                 ELSE IF (Type=CONST(Work Center)) "Work Center"
                                                                 ELSE IF (Type=CONST(Resource)) Resource;
                                                   OnValidate=VAR
                                                                Resource@1000 : Record 156;
                                                              BEGIN
                                                                IF Type = Type::Resource THEN
                                                                  TESTFIELD("Entry Type","Entry Type"::"Assembly Output")
                                                                ELSE
                                                                  TESTFIELD("Entry Type","Entry Type"::Output);
                                                                IF "No." = '' THEN BEGIN
                                                                  "Work Center No." := '';
                                                                  VALIDATE("Item No.");
                                                                  IF Type IN [Type::"Work Center",Type::"Machine Center"] THEN
                                                                    CreateDimWithProdOrderLine
                                                                  ELSE
                                                                    CreateDim(
                                                                      DATABASE::"Work Center","Work Center No.",
                                                                      DATABASE::Item,"Item No.",
                                                                      DATABASE::"Salesperson/Purchaser","Salespers./Purch. Code");
                                                                  EXIT;
                                                                END;

                                                                CASE Type OF
                                                                  Type::"Work Center":
                                                                    BEGIN
                                                                      WorkCenter.GET("No.");
                                                                      WorkCenter.TESTFIELD(Blocked,FALSE);
                                                                      "Work Center No." := WorkCenter."No.";
                                                                      Description := WorkCenter.Name;
                                                                      "Gen. Prod. Posting Group" := WorkCenter."Gen. Prod. Posting Group";
                                                                      "Unit Cost Calculation" := WorkCenter."Unit Cost Calculation";
                                                                    END;
                                                                  Type::"Machine Center":
                                                                    BEGIN
                                                                      MachineCenter.GET("No.");
                                                                      MachineCenter.TESTFIELD(Blocked,FALSE);
                                                                      "Work Center No." := MachineCenter."Work Center No.";
                                                                      Description := MachineCenter.Name;
                                                                      WorkCenter.GET("Work Center No.");
                                                                      WorkCenter.TESTFIELD(Blocked,FALSE);
                                                                      "Gen. Prod. Posting Group" := MachineCenter."Gen. Prod. Posting Group";
                                                                      "Unit Cost Calculation" := "Unit Cost Calculation"::Time;
                                                                    END;
                                                                  Type::Resource:
                                                                    BEGIN
                                                                      Resource.GET("No.");
                                                                      Resource.TESTFIELD(Blocked,FALSE);
                                                                    END;
                                                                END;

                                                                IF Type IN [Type::"Work Center",Type::"Machine Center"] THEN BEGIN
                                                                  "Work Center No." := WorkCenter."No.";
                                                                  VALIDATE("Cap. Unit of Measure Code",WorkCenter."Unit of Measure Code");
                                                                END;

                                                                IF "Work Center No." <> '' THEN
                                                                  CreateDimWithProdOrderLine;
                                                              END;

                                                   CaptionML=[ENU=No.;
                                                              NOR=Nr.] }
    { 5838;   ;Operation No.       ;Code10        ;TableRelation=IF (Order Type=CONST(Production)) "Prod. Order Routing Line"."Operation No." WHERE (Status=CONST(Released),
                                                                                                                                                     Prod. Order No.=FIELD(Order No.),
                                                                                                                                                     Routing No.=FIELD(Routing No.),
                                                                                                                                                     Routing Reference No.=FIELD(Routing Reference No.));
                                                   OnValidate=VAR
                                                                ProdOrderRtngLine@1000 : Record 5409;
                                                              BEGIN
                                                                TESTFIELD("Entry Type","Entry Type"::Output);
                                                                IF "Operation No." = '' THEN
                                                                  EXIT;

                                                                TESTFIELD("Order Type","Order Type"::Production);
                                                                TESTFIELD("Order No.");
                                                                TESTFIELD("Item No.");

                                                                GetProdOrderRtngLine(ProdOrderRtngLine);

                                                                CASE ProdOrderRtngLine.Type OF
                                                                  ProdOrderRtngLine.Type::"Work Center":
                                                                    Type := Type::"Work Center";
                                                                  ProdOrderRtngLine.Type::"Machine Center":
                                                                    Type := Type::"Machine Center";
                                                                END;
                                                                VALIDATE("No.",ProdOrderRtngLine."No.");
                                                                Description := ProdOrderRtngLine.Description;
                                                              END;

                                                   CaptionML=[ENU=Operation No.;
                                                              NOR=Operasjonsnr.] }
    { 5839;   ;Work Center No.     ;Code20        ;TableRelation="Work Center";
                                                   CaptionML=[ENU=Work Center No.;
                                                              NOR=Arbeidssenternr.];
                                                   Editable=No }
    { 5841;   ;Setup Time          ;Decimal       ;OnValidate=BEGIN
                                                                IF SubcontractingWorkCenterUsed AND ("Setup Time" <> 0) THEN
                                                                  ERROR(STRSUBSTNO(SubcontractedErr,FIELDCAPTION("Setup Time"),"Line No."));
                                                                "Setup Time (Base)" := CalcBaseTime("Setup Time");
                                                              END;

                                                   AccessByPermission=TableData 99000758=R;
                                                   CaptionML=[ENU=Setup Time;
                                                              NOR=Oppstillingstid];
                                                   DecimalPlaces=0:5 }
    { 5842;   ;Run Time            ;Decimal       ;OnValidate=BEGIN
                                                                IF SubcontractingWorkCenterUsed AND ("Run Time" <> 0) THEN
                                                                  ERROR(STRSUBSTNO(SubcontractedErr,FIELDCAPTION("Run Time"),"Line No."));

                                                                "Run Time (Base)" := CalcBaseTime("Run Time");
                                                              END;

                                                   AccessByPermission=TableData 99000758=R;
                                                   CaptionML=[ENU=Run Time;
                                                              NOR=Operasjonstid];
                                                   DecimalPlaces=0:5 }
    { 5843;   ;Stop Time           ;Decimal       ;OnValidate=BEGIN
                                                                "Stop Time (Base)" := CalcBaseTime("Stop Time");
                                                              END;

                                                   AccessByPermission=TableData 99000758=R;
                                                   CaptionML=[ENU=Stop Time;
                                                              NOR=Stopptid];
                                                   DecimalPlaces=0:5 }
    { 5846;   ;Output Quantity     ;Decimal       ;OnValidate=BEGIN
                                                                TESTFIELD("Entry Type","Entry Type"::Output);
                                                                IF SubcontractingWorkCenterUsed AND ("Output Quantity" <> 0) THEN
                                                                  ERROR(STRSUBSTNO(SubcontractedErr,FIELDCAPTION("Output Quantity"),"Line No."));

                                                                IF LastOutputOperation(Rec) THEN
                                                                  WhseValidateSourceLine.ItemLineVerifyChange(Rec,xRec);

                                                                "Output Quantity (Base)" := CalcBaseQty("Output Quantity");

                                                                VALIDATE(Quantity,"Output Quantity");
                                                              END;

                                                   AccessByPermission=TableData 99000758=R;
                                                   CaptionML=[ENU=Output Quantity;
                                                              NOR=Avgangsantall];
                                                   DecimalPlaces=0:5 }
    { 5847;   ;Scrap Quantity      ;Decimal       ;OnValidate=BEGIN
                                                                TESTFIELD("Entry Type","Entry Type"::Output);
                                                                "Scrap Quantity (Base)" := CalcBaseQty("Scrap Quantity");
                                                              END;

                                                   AccessByPermission=TableData 99000758=R;
                                                   CaptionML=[ENU=Scrap Quantity;
                                                              NOR=Vrakantall];
                                                   DecimalPlaces=0:5 }
    { 5849;   ;Concurrent Capacity ;Decimal       ;OnValidate=VAR
                                                                TotalTime@1000 : Integer;
                                                              BEGIN
                                                                TESTFIELD("Entry Type","Entry Type"::Output);
                                                                IF "Concurrent Capacity" = 0 THEN
                                                                  EXIT;

                                                                TESTFIELD("Starting Time");
                                                                TESTFIELD("Ending Time");
                                                                TotalTime := CalendarMgt.CalcTimeDelta("Ending Time","Starting Time");
                                                                IF "Ending Time" < "Starting Time" THEN
                                                                  TotalTime := TotalTime + 86400000;
                                                                TESTFIELD("Work Center No.");
                                                                WorkCenter.GET("Work Center No.");
                                                                VALIDATE("Setup Time",0);
                                                                VALIDATE(
                                                                  "Run Time",
                                                                  ROUND(
                                                                    TotalTime / CalendarMgt.TimeFactor("Cap. Unit of Measure Code") *
                                                                    "Concurrent Capacity",WorkCenter."Calendar Rounding Precision"));
                                                              END;

                                                   AccessByPermission=TableData 99000758=R;
                                                   CaptionML=[ENU=Concurrent Capacity;
                                                              NOR=Samtidig kapasitet];
                                                   DecimalPlaces=0:5 }
    { 5851;   ;Setup Time (Base)   ;Decimal       ;OnValidate=BEGIN
                                                                TESTFIELD("Qty. per Cap. Unit of Measure",1);
                                                                VALIDATE("Setup Time","Setup Time (Base)");
                                                              END;

                                                   CaptionML=[ENU=Setup Time (Base);
                                                              NOR=Oppstillingstid (l.enh)];
                                                   DecimalPlaces=0:5 }
    { 5852;   ;Run Time (Base)     ;Decimal       ;OnValidate=BEGIN
                                                                TESTFIELD("Qty. per Cap. Unit of Measure",1);
                                                                VALIDATE("Run Time","Run Time (Base)");
                                                              END;

                                                   CaptionML=[ENU=Run Time (Base);
                                                              NOR=Operasjonstid (l.enh)];
                                                   DecimalPlaces=0:5 }
    { 5853;   ;Stop Time (Base)    ;Decimal       ;OnValidate=BEGIN
                                                                TESTFIELD("Qty. per Cap. Unit of Measure",1);
                                                                VALIDATE("Stop Time","Stop Time (Base)");
                                                              END;

                                                   CaptionML=[ENU=Stop Time (Base);
                                                              NOR=Stopptid (l.enh)];
                                                   DecimalPlaces=0:5 }
    { 5856;   ;Output Quantity (Base);Decimal     ;OnValidate=BEGIN
                                                                TESTFIELD("Qty. per Unit of Measure",1);
                                                                VALIDATE("Output Quantity","Output Quantity (Base)");
                                                              END;

                                                   CaptionML=[ENU=Output Quantity (Base);
                                                              NOR=Avgangsantall (l.enh)];
                                                   DecimalPlaces=0:5 }
    { 5857;   ;Scrap Quantity (Base);Decimal      ;OnValidate=BEGIN
                                                                TESTFIELD("Qty. per Unit of Measure",1);
                                                                VALIDATE("Scrap Quantity","Scrap Quantity (Base)");
                                                              END;

                                                   CaptionML=[ENU=Scrap Quantity (Base);
                                                              NOR=Vrakantall (l.enh)];
                                                   DecimalPlaces=0:5 }
    { 5858;   ;Cap. Unit of Measure Code;Code10   ;TableRelation=IF (Type=CONST(Resource)) "Resource Unit of Measure".Code WHERE (Resource No.=FIELD(No.))
                                                                 ELSE "Capacity Unit of Measure";
                                                   OnValidate=VAR
                                                                ProdOrderRtngLine@1000 : Record 5409;
                                                              BEGIN
                                                                IF Type <> Type::Resource THEN BEGIN
                                                                  "Qty. per Cap. Unit of Measure" :=
                                                                    ROUND(
                                                                      CalendarMgt.QtyperTimeUnitofMeasure(
                                                                        "Work Center No.","Cap. Unit of Measure Code"),
                                                                      0.00001);

                                                                  VALIDATE("Setup Time");
                                                                  VALIDATE("Run Time");
                                                                  VALIDATE("Stop Time");
                                                                END;

                                                                IF "Order No." <> '' THEN
                                                                  CASE "Order Type" OF
                                                                    "Order Type"::Production:
                                                                      BEGIN
                                                                        GetProdOrderRtngLine(ProdOrderRtngLine);
                                                                        "Unit Cost" := ProdOrderRtngLine."Unit Cost per";

                                                                        CostCalcMgt.RoutingCostPerUnit(
                                                                          Type,"No.","Unit Amount","Indirect Cost %","Overhead Rate","Unit Cost","Unit Cost Calculation");
                                                                      END;
                                                                    "Order Type"::Assembly:
                                                                      CostCalcMgt.ResourceCostPerUnit("No.","Unit Amount","Indirect Cost %","Overhead Rate","Unit Cost");
                                                                  END;

                                                                ReadGLSetup;
                                                                "Unit Cost" :=
                                                                  ROUND("Unit Cost" * "Qty. per Cap. Unit of Measure",GLSetup."Unit-Amount Rounding Precision");
                                                                "Unit Amount" :=
                                                                  ROUND("Unit Amount" * "Qty. per Cap. Unit of Measure",GLSetup."Unit-Amount Rounding Precision");
                                                                VALIDATE("Unit Amount");
                                                              END;

                                                   CaptionML=[ENU=Cap. Unit of Measure Code;
                                                              NOR=Kapasitetsenhetskode] }
    { 5859;   ;Qty. per Cap. Unit of Measure;Decimal;
                                                   CaptionML=[ENU=Qty. per Cap. Unit of Measure;
                                                              NOR=Ant. per kapasitetsenhet];
                                                   DecimalPlaces=0:5 }
    { 5873;   ;Starting Time       ;Time          ;OnValidate=BEGIN
                                                                IF "Ending Time" < "Starting Time" THEN
                                                                  "Ending Time" := "Starting Time";

                                                                VALIDATE("Concurrent Capacity");
                                                              END;

                                                   AccessByPermission=TableData 99000758=R;
                                                   CaptionML=[ENU=Starting Time;
                                                              NOR=Starttidspunkt] }
    { 5874;   ;Ending Time         ;Time          ;OnValidate=BEGIN
                                                                VALIDATE("Concurrent Capacity");
                                                              END;

                                                   AccessByPermission=TableData 99000758=R;
                                                   CaptionML=[ENU=Ending Time;
                                                              NOR=Sluttidspunkt] }
    { 5882;   ;Routing No.         ;Code20        ;TableRelation="Routing Header";
                                                   CaptionML=[ENU=Routing No.;
                                                              NOR=Rutenr.];
                                                   Editable=No }
    { 5883;   ;Routing Reference No.;Integer      ;CaptionML=[ENU=Routing Reference No.;
                                                              NOR=Rutereferansenr.] }
    { 5884;   ;Prod. Order Comp. Line No.;Integer ;TableRelation=IF (Order Type=CONST(Production)) "Prod. Order Component"."Line No." WHERE (Status=CONST(Released),
                                                                                                                                             Prod. Order No.=FIELD(Order No.),
                                                                                                                                             Prod. Order Line No.=FIELD(Order Line No.));
                                                   OnValidate=BEGIN
                                                                IF "Prod. Order Comp. Line No." <> xRec."Prod. Order Comp. Line No." THEN
                                                                  CreateProdDim;
                                                              END;

                                                   CaptionML=[ENU=Prod. Order Comp. Line No.;
                                                              NOR=Prod.ordrekomp.linjenr.] }
    { 5885;   ;Finished            ;Boolean       ;AccessByPermission=TableData 99000758=R;
                                                   CaptionML=[ENU=Finished;
                                                              NOR=Ferdig] }
    { 5887;   ;Unit Cost Calculation;Option       ;CaptionML=[ENU=Unit Cost Calculation;
                                                              NOR=Beregning av enhetskost];
                                                   OptionCaptionML=[ENU=Time,Units;
                                                                    NOR=Tid,Enheter];
                                                   OptionString=Time,Units }
    { 5888;   ;Subcontracting      ;Boolean       ;CaptionML=[ENU=Subcontracting;
                                                              NOR=Underleveranse] }
    { 5895;   ;Stop Code           ;Code20        ;TableRelation=Stop;
                                                   CaptionML=[ENU=Stop Code;
                                                              NOR=Stoppkode];
                                                   Description=OPC: fra 10 }
    { 5896;   ;Scrap Code          ;Code20        ;TableRelation=Scrap;
                                                   OnValidate=BEGIN
                                                                TESTFIELD(Type,Type::"Machine Center");
                                                              END;

                                                   CaptionML=[ENU=Scrap Code;
                                                              NOR=Vrakkode];
                                                   Description=OPC: fra 10 }
    { 5898;   ;Work Center Group Code;Code10      ;TableRelation="Work Center Group";
                                                   CaptionML=[ENU=Work Center Group Code;
                                                              NOR=Arbeidssentergruppekode];
                                                   Editable=No }
    { 5899;   ;Work Shift Code     ;Code10        ;TableRelation="Work Shift";
                                                   CaptionML=[ENU=Work Shift Code;
                                                              NOR=Arbeidsskiftkode] }
    { 6500;   ;Serial No.          ;Code20        ;CaptionML=[ENU=Serial No.;
                                                              NOR=Serienr.];
                                                   Editable=No }
    { 6501;   ;Lot No.             ;Code20        ;CaptionML=[ENU=Lot No.;
                                                              NOR=Partinr.];
                                                   Editable=No }
    { 6502;   ;Warranty Date       ;Date          ;CaptionML=[ENU=Warranty Date;
                                                              NOR=Garantidato];
                                                   Editable=No }
    { 6503;   ;New Serial No.      ;Code20        ;CaptionML=[ENU=New Serial No.;
                                                              NOR=Nytt serienr.];
                                                   Editable=No }
    { 6504;   ;New Lot No.         ;Code20        ;CaptionML=[ENU=New Lot No.;
                                                              NOR=Nytt partinr.];
                                                   Editable=No }
    { 6505;   ;New Item Expiration Date;Date      ;CaptionML=[ENU=New Item Expiration Date;
                                                              NOR=Ny vareholdbarhetsdato] }
    { 6506;   ;Item Expiration Date;Date          ;CaptionML=[ENU=Item Expiration Date;
                                                              NOR=Vareholdbarhetsdato];
                                                   Editable=No }
    { 6600;   ;Return Reason Code  ;Code10        ;TableRelation="Return Reason";
                                                   CaptionML=[ENU=Return Reason Code;
                                                              NOR=Retur†rsakskode] }
    { 7315;   ;Warehouse Adjustment;Boolean       ;CaptionML=[ENU=Warehouse Adjustment;
                                                              NOR=Lagerjustering] }
    { 7380;   ;Phys Invt Counting Period Code;Code10;
                                                   TableRelation="Phys. Invt. Counting Period";
                                                   CaptionML=[ENU=Phys Invt Counting Period Code;
                                                              NOR=Vareopptell.periode - kode];
                                                   Editable=No }
    { 7381;   ;Phys Invt Counting Period Type;Option;
                                                   CaptionML=[ENU=Phys Invt Counting Period Type;
                                                              NOR=Type vareopptellingsperiode];
                                                   OptionCaptionML=[ENU=" ,Item,SKU";
                                                                    NOR=" ,Vare,LFE"];
                                                   OptionString=[ ,Item,SKU];
                                                   Editable=No }
    { 83001;  ;Comment at p.o.route line;Boolean  ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Prod. Order Rtng Comment Line" WHERE (Status=CONST(Released),
                                                                                                            Prod. Order No.=FIELD(Order No.),
                                                                                                            Routing No.=FIELD(Routing No.),
                                                                                                            Operation No.=FIELD(Operation No.)));
                                                   Description=opc }
    { 83002;  ;Scrap Comment       ;Text50        ;Description=opc }
    { 99000755;;Overhead Rate      ;Decimal       ;OnValidate=BEGIN
                                                                IF ("Value Entry Type" <> "Value Entry Type"::"Direct Cost") OR
                                                                   ("Item Charge No." <> '')
                                                                THEN BEGIN
                                                                  "Overhead Rate" := 0;
                                                                  VALIDATE("Indirect Cost %",0);
                                                                END ELSE
                                                                  VALIDATE("Indirect Cost %");
                                                              END;

                                                   CaptionML=[ENU=Overhead Rate;
                                                              NOR=Sats for indirekte kostnader];
                                                   DecimalPlaces=0:5 }
    { 99000756;;Single-Level Material Cost;Decimal;CaptionML=[ENU=Single-Level Material Cost;
                                                              NOR=Materialkostn. - enkeltniv†];
                                                   AutoFormatType=1 }
    { 99000757;;Single-Level Capacity Cost;Decimal;CaptionML=[ENU=Single-Level Capacity Cost;
                                                              NOR=Kapasitetskostn. - enkeltniv†];
                                                   AutoFormatType=1 }
    { 99000758;;Single-Level Subcontrd. Cost;Decimal;
                                                   CaptionML=[ENU=Single-Level Subcontrd. Cost;
                                                              NOR=Underlevrd.kostn - enkeltniv†];
                                                   AutoFormatType=1 }
    { 99000759;;Single-Level Cap. Ovhd Cost;Decimal;
                                                   CaptionML=[ENU=Single-Level Cap. Ovhd Cost;
                                                              NOR=Indir. kap.kostn - enkeltniv†];
                                                   AutoFormatType=1 }
    { 99000760;;Single-Level Mfg. Ovhd Cost;Decimal;
                                                   CaptionML=[ENU=Single-Level Mfg. Ovhd Cost;
                                                              NOR=Indir. prod.kostn - enkeltniv†];
                                                   AutoFormatType=1 }
    { 99000761;;Rolled-up Material Cost;Decimal   ;CaptionML=[ENU=Rolled-up Material Cost;
                                                              NOR=Opprullert materialkost];
                                                   AutoFormatType=1 }
    { 99000762;;Rolled-up Capacity Cost;Decimal   ;CaptionML=[ENU=Rolled-up Capacity Cost;
                                                              NOR=Opprullert kapasitetskost];
                                                   AutoFormatType=1 }
    { 99000763;;Rolled-up Subcontracted Cost;Decimal;
                                                   CaptionML=[ENU=Rolled-up Subcontracted Cost;
                                                              NOR=Underlever.kostn. - opprullert];
                                                   AutoFormatType=1 }
    { 99000764;;Rolled-up Mfg. Ovhd Cost;Decimal  ;CaptionML=[ENU=Rolled-up Mfg. Ovhd Cost;
                                                              NOR=Opprullert indir. prod.kostn.];
                                                   AutoFormatType=1 }
    { 99000765;;Rolled-up Cap. Overhead Cost;Decimal;
                                                   CaptionML=[ENU=Rolled-up Cap. Overhead Cost;
                                                              NOR=Opprullert indir. kap.kostn.];
                                                   AutoFormatType=1 }
  }
  KEYS
  {
    {    ;Journal Template Name,Journal Batch Name,Line No.;
                                                   MaintainSIFTIndex=No;
                                                   Clustered=Yes }
    {    ;Entry Type,Item No.,Variant Code,Location Code,Bin Code,Posting Date;
                                                   SumIndexFields=Quantity (Base);
                                                   MaintainSIFTIndex=No }
    {    ;Entry Type,Item No.,Variant Code,New Location Code,New Bin Code,Posting Date;
                                                   SumIndexFields=Quantity (Base);
                                                   MaintainSIFTIndex=No }
    {    ;Item No.,Posting Date                    }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      Text001@1001 : TextConst 'ENU=%1 must be reduced.;NOR=%1 m† reduseres.';
      Text002@1002 : TextConst 'ENU=You cannot change %1 when %2 is %3.;NOR=Du kan ikke endre %1 n†r %2 er %3.';
      Text006@1005 : TextConst 'ENU=You must not enter %1 in a revaluation sum line.;NOR=Du skal ikke angi %1 i en revalueringsumline.';
      ItemJnlTemplate@1007 : Record 82;
      ItemJnlBatch@1008 : Record 233;
      ItemJnlLine@1009 : Record 83;
      Item@1010 : Record 27;
      ItemVariant@1012 : Record 5401;
      GLSetup@1014 : Record 98;
      MfgSetup@1034 : Record 99000765;
      WorkCenter@1040 : Record 99000754;
      MachineCenter@1039 : Record 99000758;
      Location@1048 : Record 14;
      Bin@1030 : Record 7354;
      ItemCheckAvail@1021 : Codeunit 311;
      ReserveItemJnlLine@1022 : Codeunit 99000835;
      NoSeriesMgt@1023 : Codeunit 396;
      UOMMgt@1024 : Codeunit 5402;
      DimMgt@1027 : Codeunit 408;
      UserMgt@1033 : Codeunit 5700;
      CalendarMgt@1041 : Codeunit 99000755;
      CostCalcMgt@1042 : Codeunit 5836;
      PurchPriceCalcMgt@1020 : Codeunit 7010;
      SalesPriceCalcMgt@1025 : Codeunit 7000;
      WMSManagement@1026 : Codeunit 7302;
      WhseValidateSourceLine@1032 : Codeunit 5777;
      PhysInvtEntered@1028 : Boolean;
      GLSetupRead@1029 : Boolean;
      MfgSetupRead@1035 : Boolean;
      UnitCost@1031 : Decimal;
      Text007@1006 : TextConst 'ENU="New ";NOR="Ny "';
      Text012@1045 : TextConst 'ENU=The update has been interrupted to respect the warning.;NOR=Oppdateringen er avbrutt som en reaksjon p† advarselen.';
      Text021@1051 : TextConst 'ENU=The entered bin code %1 is different from the bin code %2 in production order component %3.\\Are you sure that you want to post the consumption from bin code %1?;NOR=Den angitte hyllekoden %1 er ulik hyllekoden %2 i produksjonsordrekomponenten %3.\\Er du sikker p† at du vil bokf›re forbruket fra hyllekode %1?';
      Text029@1047 : TextConst 'ENU=must be positive;NOR=m† v‘re positiv';
      Text030@1046 : TextConst 'ENU=must be negative;NOR=m† v‘re negativ';
      Text031@1043 : TextConst 'ENU=You can not insert item number %1 because it is not produced on released production order %2.;NOR=Du kan ikke sette inn varenummer %1 fordi det ikke er produsert i den frigitte produksjonsordren %2.';
      Text032@1000 : TextConst 'ENU=When posting, the entry %1 will be opened first.;NOR=Ved bokf›ring †pnes posten %1 f›rst.';
      Text033@1049 : TextConst 'ENU=If the item carries serial or lot numbers, then you must use the %1 field in the %2 window.;NOR=Hvis varen har serie- eller partinummer, m† du bruke %1-feltet i %2-vinduet.';
      Text034@1050 : TextConst 'ENU=You cannot revalue individual item ledger entries for items that use the average costing method.;NOR=Du kan ikke revaluere enkeltst†ende vareposter for varer som bruker lagermetoden Gjennomsnitt.';
      SubcontractedErr@1003 : TextConst '@@@=%1 - Field Caption, %2 - Line No.;ENU=%1 must be zero in line number %2 because it is linked to the subcontracted work center.;NOR=%1 m† v‘re null p† linjenummeret %2 fordi det er koblet til arbeidssentret som er underleverand›r.';

    PROCEDURE EmptyLine@5() : Boolean;
    BEGIN
      EXIT(
        (Quantity = 0) AND
        ((TimeIsEmpty AND ("Item No." = '')) OR
         ("Value Entry Type" = "Value Entry Type"::Revaluation)));
    END;

    PROCEDURE IsValueEntryForDeletedItem@22() : Boolean;
    BEGIN
      EXIT(
        (("Entry Type" = "Entry Type"::Output) OR ("Value Entry Type" = "Value Entry Type"::Rounding)) AND
        ("Item No." = '') AND ("Item Charge No." = '') AND ("Invoiced Qty. (Base)" <> 0));
    END;

    LOCAL PROCEDURE CalcBaseQty@14(Qty@1000 : Decimal) : Decimal;
    BEGIN
      TESTFIELD("Qty. per Unit of Measure");
      EXIT(ROUND(Qty * "Qty. per Unit of Measure",0.00001));
    END;

    LOCAL PROCEDURE CalcBaseTime@28(Qty@1000 : Decimal) : Decimal;
    BEGIN
      IF "Run Time" <> 0 THEN
        TESTFIELD("Qty. per Cap. Unit of Measure");
      EXIT(ROUND(Qty * "Qty. per Cap. Unit of Measure",0.00001));
    END;

    LOCAL PROCEDURE UpdateAmount@23();
    BEGIN
      Amount := ROUND(Quantity * "Unit Amount");
    END;

    LOCAL PROCEDURE SelectItemEntry@3(CurrentFieldNo@1000 : Integer);
    VAR
      ItemLedgEntry@1001 : Record 32;
      ItemJnlLine2@1002 : Record 83;
    BEGIN
      IF ("Entry Type" = "Entry Type"::Output) AND
         ("Value Entry Type" <> "Value Entry Type"::Revaluation) AND
         (CurrentFieldNo = FIELDNO("Applies-to Entry"))
      THEN BEGIN
        ItemLedgEntry.SETCURRENTKEY(
          "Order Type","Order No.","Order Line No.","Entry Type","Prod. Order Comp. Line No.");
        ItemLedgEntry.SETRANGE("Order Type","Order Type"::Production);
        ItemLedgEntry.SETRANGE("Order No.","Order No.");
        ItemLedgEntry.SETRANGE("Order Line No.","Order Line No.");
        ItemLedgEntry.SETRANGE("Entry Type","Entry Type");
        ItemLedgEntry.SETRANGE("Prod. Order Comp. Line No.",0);
      END ELSE BEGIN
        ItemLedgEntry.SETCURRENTKEY("Item No.",Positive);
        ItemLedgEntry.SETRANGE("Item No.","Item No.");
      END;

      IF "Location Code" <> '' THEN
        ItemLedgEntry.SETRANGE("Location Code","Location Code");

      IF CurrentFieldNo = FIELDNO("Applies-to Entry") THEN BEGIN
        ItemLedgEntry.SETRANGE(Positive,(Signed(Quantity) < 0) OR ("Value Entry Type" = "Value Entry Type"::Revaluation));
        IF "Value Entry Type" <> "Value Entry Type"::Revaluation THEN BEGIN
          ItemLedgEntry.SETCURRENTKEY("Item No.",Open);
          ItemLedgEntry.SETRANGE(Open,TRUE);
        END;
      END ELSE
        ItemLedgEntry.SETRANGE(Positive,FALSE);

      IF PAGE.RUNMODAL(PAGE::"Item Ledger Entries",ItemLedgEntry) = ACTION::LookupOK THEN BEGIN
        ItemJnlLine2 := Rec;
        IF CurrentFieldNo = FIELDNO("Applies-to Entry") THEN
          ItemJnlLine2.VALIDATE("Applies-to Entry",ItemLedgEntry."Entry No.")
        ELSE
          ItemJnlLine2.VALIDATE("Applies-from Entry",ItemLedgEntry."Entry No.");
        CheckItemAvailable(CurrentFieldNo);
        Rec := ItemJnlLine2;
      END;
    END;

    LOCAL PROCEDURE CheckItemAvailable@1(CalledByFieldNo@1000 : Integer);
    BEGIN
      IF (CurrFieldNo = 0) OR (CurrFieldNo <> CalledByFieldNo) THEN // Prevent two checks on quantity
        EXIT;

      IF (CurrFieldNo <> 0) AND ("Item No." <> '') AND (Quantity <> 0) AND
         ("Value Entry Type" = "Value Entry Type"::"Direct Cost") AND ("Item Charge No." = '')
      THEN
        IF ItemCheckAvail.ItemJnlCheckLine(Rec) THEN
          ItemCheckAvail.RaiseUpdateInterruptedError;
    END;

    LOCAL PROCEDURE GetItem@2();
    BEGIN
      IF Item."No." <> "Item No." THEN
        Item.GET("Item No.");
    END;

    PROCEDURE SetUpNewLine@8(LastItemJnlLine@1000 : Record 83);
    BEGIN
      MfgSetup.GET;
      ItemJnlTemplate.GET("Journal Template Name");
      ItemJnlBatch.GET("Journal Template Name","Journal Batch Name");
      ItemJnlLine.SETRANGE("Journal Template Name","Journal Template Name");
      ItemJnlLine.SETRANGE("Journal Batch Name","Journal Batch Name");
      IF ItemJnlLine.FINDFIRST THEN BEGIN
        "Posting Date" := LastItemJnlLine."Posting Date";
        "Document Date" := LastItemJnlLine."Posting Date";
        IF (ItemJnlTemplate.Type IN
            [ItemJnlTemplate.Type::Consumption,ItemJnlTemplate.Type::Output])
        THEN BEGIN
          IF NOT MfgSetup."Doc. No. Is Prod. Order No." THEN
            "Document No." := LastItemJnlLine."Document No."
        END ELSE
          "Document No." := LastItemJnlLine."Document No.";
      END ELSE BEGIN
        "Posting Date" := WORKDATE;
        "Document Date" := WORKDATE;
        IF ItemJnlBatch."No. Series" <> '' THEN BEGIN
          CLEAR(NoSeriesMgt);
          "Document No." := NoSeriesMgt.TryGetNextNo(ItemJnlBatch."No. Series","Posting Date");
        END;
        IF (ItemJnlTemplate.Type IN
            [ItemJnlTemplate.Type::Consumption,ItemJnlTemplate.Type::Output]) AND
           NOT MfgSetup."Doc. No. Is Prod. Order No."
        THEN
          IF ItemJnlBatch."No. Series" <> '' THEN BEGIN
            CLEAR(NoSeriesMgt);
            "Document No." := NoSeriesMgt.GetNextNo(ItemJnlBatch."No. Series","Posting Date",FALSE);
          END;
      END;
      "Recurring Method" := LastItemJnlLine."Recurring Method";
      "Entry Type" := LastItemJnlLine."Entry Type";
      "Source Code" := ItemJnlTemplate."Source Code";
      "Reason Code" := ItemJnlBatch."Reason Code";
      "Posting No. Series" := ItemJnlBatch."Posting No. Series";
      IF ItemJnlTemplate.Type = ItemJnlTemplate.Type::Revaluation THEN BEGIN
        "Value Entry Type" := "Value Entry Type"::Revaluation;
        "Entry Type" := "Entry Type"::"Positive Adjmt.";
      END;

      CASE "Entry Type" OF
        "Entry Type"::Purchase:
          "Location Code" := UserMgt.GetLocation(1,'',UserMgt.GetPurchasesFilter);
        "Entry Type"::Sale:
          "Location Code" := UserMgt.GetLocation(0,'',UserMgt.GetSalesFilter);
        "Entry Type"::Output:
          CLEAR(DimMgt);
      END;

      IF Location.GET("Location Code") THEN
        IF  Location."Directed Put-away and Pick" THEN
          "Location Code" := '';
    END;

    PROCEDURE SetDocNos@165(DocType@1000 : Option;DocNo@1001 : Code[20];ExtDocNo@1002 : Text[35];PostingNos@1003 : Code[10]);
    BEGIN
      "Document Type" := DocType;
      "Document No." := DocNo;
      "External Document No." := ExtDocNo;
      "Posting No. Series" := PostingNos;
    END;

    LOCAL PROCEDURE GetUnitAmount@6(CalledByFieldNo@1000 : Integer);
    BEGIN
      RetrieveCosts;
      IF ("Value Entry Type" <> "Value Entry Type"::"Direct Cost") OR
         ("Item Charge No." <> '')
      THEN
        EXIT;

      CASE "Entry Type" OF
        "Entry Type"::Purchase:
          PurchPriceCalcMgt.FindItemJnlLinePrice(Rec,CalledByFieldNo);
        "Entry Type"::Sale:
          SalesPriceCalcMgt.FindItemJnlLinePrice(Rec,CalledByFieldNo);
        "Entry Type"::"Positive Adjmt.":
          "Unit Amount" :=
            ROUND(
              ((UnitCost - "Overhead Rate") * "Qty. per Unit of Measure") / (1 + "Indirect Cost %" / 100),
              GLSetup."Unit-Amount Rounding Precision");
        "Entry Type"::"Negative Adjmt.":
          "Unit Amount" := UnitCost * "Qty. per Unit of Measure";
        "Entry Type"::Transfer:
          "Unit Amount" := 0;
      END;
    END;

    PROCEDURE Signed@20(Value@1000 : Decimal) : Decimal;
    BEGIN
      CASE "Entry Type" OF
        "Entry Type"::Purchase,
        "Entry Type"::"Positive Adjmt.",
        "Entry Type"::Output,
        "Entry Type"::"Assembly Output":
          EXIT(Value);
        "Entry Type"::Sale,
        "Entry Type"::"Negative Adjmt.",
        "Entry Type"::Consumption,
        "Entry Type"::Transfer,
        "Entry Type"::"Assembly Consumption":
          EXIT(-Value);
      END;
    END;

    PROCEDURE IsInbound@31() : Boolean;
    BEGIN
      EXIT((Signed(Quantity) > 0) OR (Signed("Invoiced Quantity") > 0));
    END;

    PROCEDURE OpenItemTrackingLines@6500(IsReclass@1000 : Boolean);
    BEGIN
      ReserveItemJnlLine.CallItemTracking(Rec,IsReclass);
    END;

    LOCAL PROCEDURE PickDimension@48(TableList@1005 : ARRAY [10] OF Integer;CodeList@1004 : ARRAY [10] OF Code[20];InheritFromDimSetID@1003 : Integer;InheritFromTableNo@1002 : Integer);
    VAR
      ItemJournalTemplate@1001 : Record 82;
      SourceCode@1000 : Code[10];
    BEGIN
      SourceCode := "Source Code";
      IF SourceCode = '' THEN
        IF ItemJournalTemplate.GET("Journal Template Name") THEN
          SourceCode := ItemJournalTemplate."Source Code";

      "Shortcut Dimension 1 Code" := '';
      "Shortcut Dimension 2 Code" := '';
      "Dimension Set ID" :=
        DimMgt.GetDefaultDimID(
          TableList,CodeList,SourceCode,
          "Shortcut Dimension 1 Code","Shortcut Dimension 2 Code",InheritFromDimSetID,InheritFromTableNo);
      DimMgt.UpdateGlobalDimFromDimSetID("Dimension Set ID","Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");

      IF "Entry Type" = "Entry Type"::Transfer THEN BEGIN
        "New Dimension Set ID" := "Dimension Set ID";
        "New Shortcut Dimension 1 Code" := "Shortcut Dimension 1 Code";
        "New Shortcut Dimension 2 Code" := "Shortcut Dimension 2 Code";
      END;
    END;

    LOCAL PROCEDURE CreateCodeList@55(VAR CodeList@1003 : ARRAY [10] OF Code[20];No1@1002 : Code[20];No2@1001 : Code[20];No3@1000 : Code[20]);
    BEGIN
      CLEAR(CodeList);
      CodeList[1] := No1;
      CodeList[2] := No2;
      CodeList[3] := No3;
    END;

    LOCAL PROCEDURE CreateTableList@56(VAR TableID@1001 : ARRAY [10] OF Integer;Type1@1000 : Integer;Type2@1002 : Integer;Type3@1007 : Integer);
    BEGIN
      CLEAR(TableID);
      TableID[1] := Type1;
      TableID[2] := Type2;
      TableID[3] := Type3;
    END;

    LOCAL PROCEDURE CreateDim@13(Type1@1000 : Integer;No1@1001 : Code[20];Type2@1002 : Integer;No2@1003 : Code[20];Type3@1007 : Integer;No3@1006 : Code[20]);
    VAR
      TableID@1004 : ARRAY [10] OF Integer;
      No@1005 : ARRAY [10] OF Code[20];
    BEGIN
      CreateTableList(TableID,Type1,Type2,Type3);
      CreateCodeList(No,No1,No2,No3);
      PickDimension(TableID,No,0,0);
    END;

    PROCEDURE CopyDim@46(DimesionSetID@1000 : Integer);
    VAR
      DimSetEntry@1002 : Record 480;
    BEGIN
      ReadGLSetup;
      "Dimension Set ID" := DimesionSetID;
      DimSetEntry.SETRANGE("Dimension Set ID",DimesionSetID);
      DimSetEntry.SETRANGE("Dimension Code",GLSetup."Global Dimension 1 Code");
      IF DimSetEntry.FINDFIRST THEN
        "Shortcut Dimension 1 Code" := DimSetEntry."Dimension Value Code"
      ELSE
        "Shortcut Dimension 1 Code" := '';
      DimSetEntry.SETRANGE("Dimension Code",GLSetup."Global Dimension 2 Code");
      IF DimSetEntry.FINDFIRST THEN
        "Shortcut Dimension 2 Code" := DimSetEntry."Dimension Value Code"
      ELSE
        "Shortcut Dimension 2 Code" := '';
    END;

    LOCAL PROCEDURE CreateProdDim@25();
    VAR
      ProdOrder@1008 : Record 5405;
      ProdOrderLine@1009 : Record 5406;
      ProdOrderComp@1010 : Record 5407;
      DimSetIDArr@1001 : ARRAY [10] OF Integer;
      i@1000 : Integer;
    BEGIN
      "Shortcut Dimension 1 Code" := '';
      "Shortcut Dimension 2 Code" := '';
      "Dimension Set ID" := 0;
      IF ("Order Type" <> "Order Type"::Production) OR ("Order No." = '') THEN
        EXIT;
      ProdOrder.GET(ProdOrder.Status::Released,"Order No.");
      i := 1;
      DimSetIDArr[i] := ProdOrder."Dimension Set ID";
      IF "Order Line No." <> 0 THEN BEGIN
        i := i + 1;
        ProdOrderLine.GET(ProdOrderLine.Status::Released,"Order No.","Order Line No.");
        DimSetIDArr[i] := ProdOrderLine."Dimension Set ID";
      END;
      IF "Prod. Order Comp. Line No." <> 0 THEN BEGIN
        i := i + 1;
        ProdOrderComp.GET(ProdOrderLine.Status::Released,"Order No.","Order Line No.","Prod. Order Comp. Line No.");
        DimSetIDArr[i] := ProdOrderComp."Dimension Set ID";
      END;
      "Dimension Set ID" := DimMgt.GetCombinedDimensionSetID(DimSetIDArr,"Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
    END;

    LOCAL PROCEDURE CreateAssemblyDim@42();
    VAR
      AssemblyHeader@1008 : Record 900;
      AssemblyLine@1009 : Record 901;
      DimSetIDArr@1001 : ARRAY [10] OF Integer;
      i@1000 : Integer;
    BEGIN
      "Shortcut Dimension 1 Code" := '';
      "Shortcut Dimension 2 Code" := '';
      "Dimension Set ID" := 0;
      IF ("Order Type" <> "Order Type"::Assembly) OR ("Order No." = '') THEN
        EXIT;
      AssemblyHeader.GET(AssemblyHeader."Document Type"::Order,"Order No.");
      i := 1;
      DimSetIDArr[i] := AssemblyHeader."Dimension Set ID";
      IF "Order Line No." <> 0 THEN BEGIN
        i := i + 1;
        AssemblyLine.GET(AssemblyLine."Document Type"::Order,"Order No.","Order Line No.");
        DimSetIDArr[i] := AssemblyLine."Dimension Set ID";
      END;
      "Dimension Set ID" := DimMgt.GetCombinedDimensionSetID(DimSetIDArr,"Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
    END;

    LOCAL PROCEDURE CreateDimWithProdOrderLine@54();
    VAR
      ProdOrderLine@1005 : Record 5406;
      InheritFromDimSetID@1004 : Integer;
      TableID@1001 : ARRAY [10] OF Integer;
      No@1000 : ARRAY [10] OF Code[20];
    BEGIN
      IF "Order Type" = "Order Type"::Production THEN
        IF ProdOrderLine.GET(ProdOrderLine.Status::Released,"Order No.","Order Line No.") THEN
          InheritFromDimSetID := ProdOrderLine."Dimension Set ID";

      CreateTableList(TableID,DATABASE::"Work Center",DATABASE::"Salesperson/Purchaser",0);
      CreateCodeList(No,"Work Center No.","Salespers./Purch. Code",'');
      PickDimension(TableID,No,InheritFromDimSetID,DATABASE::Item);
    END;

    PROCEDURE ValidateShortcutDimCode@9(FieldNumber@1000 : Integer;VAR ShortcutDimCode@1001 : Code[20]);
    BEGIN
      DimMgt.ValidateShortcutDimValues(FieldNumber,ShortcutDimCode,"Dimension Set ID");
    END;

    PROCEDURE LookupShortcutDimCode@18(FieldNumber@1000 : Integer;VAR ShortcutDimCode@1001 : Code[20]);
    BEGIN
      DimMgt.LookupDimValueCode(FieldNumber,ShortcutDimCode);
      DimMgt.ValidateShortcutDimValues(FieldNumber,ShortcutDimCode,"Dimension Set ID");
    END;

    PROCEDURE ShowShortcutDimCode@15(VAR ShortcutDimCode@1000 : ARRAY [8] OF Code[20]);
    BEGIN
      DimMgt.GetShortcutDimensions("Dimension Set ID",ShortcutDimCode);
    END;

    PROCEDURE ValidateNewShortcutDimCode@19(FieldNumber@1000 : Integer;VAR NewShortcutDimCode@1001 : Code[20]);
    BEGIN
      DimMgt.ValidateShortcutDimValues(FieldNumber,NewShortcutDimCode,"New Dimension Set ID");
    END;

    PROCEDURE LookupNewShortcutDimCode@21(FieldNumber@1000 : Integer;VAR NewShortcutDimCode@1001 : Code[20]);
    BEGIN
      DimMgt.LookupDimValueCode(FieldNumber,NewShortcutDimCode);
      DimMgt.ValidateShortcutDimValues(FieldNumber,NewShortcutDimCode,"New Dimension Set ID");
    END;

    PROCEDURE ShowNewShortcutDimCode@16(VAR NewShortcutDimCode@1000 : ARRAY [8] OF Code[20]);
    BEGIN
      DimMgt.GetShortcutDimensions("New Dimension Set ID",NewShortcutDimCode);
    END;

    LOCAL PROCEDURE InitRevalJnlLine@5800(ItemLedgEntry2@1000 : Record 32);
    VAR
      ItemApplnEntry@1002 : Record 339;
      ValueEntry@1001 : Record 5802;
      CostAmtActual@1003 : Decimal;
    BEGIN
      IF "Value Entry Type" <> "Value Entry Type"::Revaluation THEN
        EXIT;

      ItemLedgEntry2.TESTFIELD("Item No.","Item No.");
      ItemLedgEntry2.TESTFIELD("Completely Invoiced",TRUE);
      ItemLedgEntry2.TESTFIELD(Positive,TRUE);
      ItemApplnEntry.CheckAppliedFromEntryToAdjust(ItemLedgEntry2."Entry No.");

      VALIDATE("Entry Type",ItemLedgEntry2."Entry Type");
      "Posting Date" := ItemLedgEntry2."Posting Date";
      VALIDATE("Unit Amount",0);
      VALIDATE(Quantity,ItemLedgEntry2."Invoiced Quantity");

      ValueEntry.RESET;
      ValueEntry.SETCURRENTKEY("Item Ledger Entry No.","Entry Type");
      ValueEntry.SETRANGE("Item Ledger Entry No.",ItemLedgEntry2."Entry No.");
      ValueEntry.SETFILTER("Entry Type",'<>%1',ValueEntry."Entry Type"::Rounding);
      ValueEntry.FIND('-');
      REPEAT
        IF NOT (ValueEntry."Expected Cost" OR ValueEntry."Partial Revaluation") THEN
          CostAmtActual := CostAmtActual + ValueEntry."Cost Amount (Actual)";
      UNTIL ValueEntry.NEXT = 0;

      VALIDATE("Inventory Value (Calculated)",CostAmtActual);
      VALIDATE("Inventory Value (Revalued)",CostAmtActual);

      "Location Code" := ItemLedgEntry2."Location Code";
      "Variant Code" := ItemLedgEntry2."Variant Code";
      "Applies-to Entry" := ItemLedgEntry2."Entry No.";
      CopyDim(ItemLedgEntry2."Dimension Set ID");
    END;

    PROCEDURE CopyDocumentFields@129(DocType@1004 : Option;DocNo@1003 : Code[20];ExtDocNo@1002 : Text[35];SourceCode@1001 : Code[10];NoSeriesCode@1000 : Code[10]);
    BEGIN
      "Document Type" := DocType;
      "Document No." := DocNo;
      "External Document No." := ExtDocNo;
      "Source Code" := SourceCode;
      IF NoSeriesCode <> '' THEN
        "Posting No. Series" := NoSeriesCode;
    END;

    PROCEDURE CopyFromSalesHeader@58(SalesHeader@1000 : Record 36);
    BEGIN
      "Posting Date" := SalesHeader."Posting Date";
      "Document Date" := SalesHeader."Document Date";
      "Order Date" := SalesHeader."Order Date";
      "Source Posting Group" := SalesHeader."Customer Posting Group";
      "Salespers./Purch. Code" := SalesHeader."Salesperson Code";
      "Reason Code" := SalesHeader."Reason Code";
      "Source Currency Code" := SalesHeader."Currency Code";
    END;

    PROCEDURE CopyFromSalesLine@12(SalesLine@1000 : Record 37);
    BEGIN
      "Item No." := SalesLine."No.";
      Description := SalesLine.Description;
      "Shortcut Dimension 1 Code" := SalesLine."Shortcut Dimension 1 Code";
      "Shortcut Dimension 2 Code" := SalesLine."Shortcut Dimension 2 Code";
      "Dimension Set ID" := SalesLine."Dimension Set ID";
      "Location Code" := SalesLine."Location Code";
      "Bin Code" := SalesLine."Bin Code";
      "Variant Code" := SalesLine."Variant Code";
      "Inventory Posting Group" := SalesLine."Posting Group";
      "Gen. Bus. Posting Group" := SalesLine."Gen. Bus. Posting Group";
      "Gen. Prod. Posting Group" := SalesLine."Gen. Prod. Posting Group";
      "Transaction Type" := SalesLine."Transaction Type";
      "Transport Method" := SalesLine."Transport Method";
      "Entry/Exit Point" := SalesLine."Exit Point";
      Area := SalesLine.Area;
      "Transaction Specification" := SalesLine."Transaction Specification";
      "Drop Shipment" := SalesLine."Drop Shipment";
      "Entry Type" := "Entry Type"::Sale;
      "Unit of Measure Code" := SalesLine."Unit of Measure Code";
      "Qty. per Unit of Measure" := SalesLine."Qty. per Unit of Measure";
      "Derived from Blanket Order" := SalesLine."Blanket Order No." <> '';
      "Cross-Reference No." := SalesLine."Cross-Reference No.";
      "Originally Ordered No." := SalesLine."Originally Ordered No.";
      "Originally Ordered Var. Code" := SalesLine."Originally Ordered Var. Code";
      "Out-of-Stock Substitution" := SalesLine."Out-of-Stock Substitution";
      "Item Category Code" := SalesLine."Item Category Code";
      Nonstock := SalesLine.Nonstock;
      "Purchasing Code" := SalesLine."Purchasing Code";
      "Product Group Code" := SalesLine."Product Group Code";
      "Return Reason Code" := SalesLine."Return Reason Code";
      "Planned Delivery Date" := SalesLine."Planned Delivery Date";
      "Document Line No." := SalesLine."Line No.";
      "Unit Cost" := SalesLine."Unit Cost (LCY)";
      "Unit Cost (ACY)" := SalesLine."Unit Cost";
      "Value Entry Type" := "Value Entry Type"::"Direct Cost";
      "Source Type" := "Source Type"::Customer;
      "Source No." := SalesLine."Sell-to Customer No.";
      "Invoice-to Source No." := SalesLine."Bill-to Customer No.";
      OnAfterCopyFromSalesLine(Rec, SalesLine); //07 29.03.17 JAL
    END;

    PROCEDURE CopyFromPurchHeader@57(PurchHeader@1000 : Record 38);
    BEGIN
      "Posting Date" := PurchHeader."Posting Date";
      "Document Date" := PurchHeader."Document Date";
      "Source Posting Group" := PurchHeader."Vendor Posting Group";
      "Salespers./Purch. Code" := PurchHeader."Purchaser Code";
      "Country/Region Code" := PurchHeader."Buy-from Country/Region Code";
      "Reason Code" := PurchHeader."Reason Code";
      "Source Currency Code" := PurchHeader."Currency Code";
    END;

    PROCEDURE CopyFromPurchLine@160(PurchLine@1000 : Record 39);
    BEGIN
      "Item No." := PurchLine."No.";
      Description := PurchLine.Description;
      "Shortcut Dimension 1 Code" := PurchLine."Shortcut Dimension 1 Code";
      "Shortcut Dimension 2 Code" := PurchLine."Shortcut Dimension 2 Code";
      "Dimension Set ID" := PurchLine."Dimension Set ID";
      "Location Code" := PurchLine."Location Code";
      "Bin Code" := PurchLine."Bin Code";
      "Variant Code" := PurchLine."Variant Code";
      "Item Category Code" := PurchLine."Item Category Code";
      "Product Group Code" := PurchLine."Product Group Code";
      "Inventory Posting Group" := PurchLine."Posting Group";
      "Gen. Bus. Posting Group" := PurchLine."Gen. Bus. Posting Group";
      "Gen. Prod. Posting Group" := PurchLine."Gen. Prod. Posting Group";
      "Job No." := PurchLine."Job No.";
      "Job Task No." := PurchLine."Job Task No.";
      IF "Job No." <> '' THEN
        "Job Purchase" := TRUE;
      "Applies-to Entry" := PurchLine."Appl.-to Item Entry";
      "Transaction Type" := PurchLine."Transaction Type";
      "Transport Method" := PurchLine."Transport Method";
      "Entry/Exit Point" := PurchLine."Entry Point";
      Area := PurchLine.Area;
      "Transaction Specification" := PurchLine."Transaction Specification";
      "Drop Shipment" := PurchLine."Drop Shipment";
      "Entry Type" := "Entry Type"::Purchase;
      IF PurchLine."Prod. Order No." <> '' THEN BEGIN
        "Order Type" := "Order Type"::Production;
        "Order No." := PurchLine."Prod. Order No.";
        "Order Line No." := PurchLine."Prod. Order Line No.";
      END;
      "Unit of Measure Code" := PurchLine."Unit of Measure Code";
      "Qty. per Unit of Measure" := PurchLine."Qty. per Unit of Measure";
      "Cross-Reference No." := PurchLine."Cross-Reference No.";
      "Document Line No." := PurchLine."Line No.";
      "Unit Cost" := PurchLine."Unit Cost (LCY)";
      "Unit Cost (ACY)" := PurchLine."Unit Cost";
      "Value Entry Type" := "Value Entry Type"::"Direct Cost";
      "Source Type" := "Source Type"::Vendor;
      "Source No." := PurchLine."Buy-from Vendor No.";
      "Invoice-to Source No." := PurchLine."Pay-to Vendor No.";
      "Purchasing Code" := PurchLine."Purchasing Code";
      "Indirect Cost %" := PurchLine."Indirect Cost %";
      "Overhead Rate" := PurchLine."Overhead Rate";
      "Return Reason Code" := PurchLine."Return Reason Code";
    END;

    PROCEDURE CopyFromServHeader@59(ServiceHeader@1000 : Record 5900);
    BEGIN
      "Posting Date" := ServiceHeader."Posting Date";
      "Document Date" := ServiceHeader."Document Date";
      "Order Date" := ServiceHeader."Order Date";
      "Source Posting Group" := ServiceHeader."Customer Posting Group";
      "Salespers./Purch. Code" := ServiceHeader."Salesperson Code";
      "Country/Region Code" := ServiceHeader."VAT Country/Region Code";
      "Reason Code" := ServiceHeader."Reason Code";
      "Source Type" := "Source Type"::Customer;
      "Source No." := ServiceHeader."Customer No.";
    END;

    PROCEDURE CopyFromServLine@17(ServiceLine@1000 : Record 5902);
    BEGIN
      "Item No." := ServiceLine."No.";
      Description := ServiceLine.Description;
      "Shortcut Dimension 1 Code" := ServiceLine."Shortcut Dimension 1 Code";
      "Shortcut Dimension 2 Code" := ServiceLine."Shortcut Dimension 2 Code";
      "Dimension Set ID" := ServiceLine."Dimension Set ID";
      "Location Code" := ServiceLine."Location Code";
      "Bin Code" := ServiceLine."Bin Code";
      "Variant Code" := ServiceLine."Variant Code";
      "Inventory Posting Group" := ServiceLine."Posting Group";
      "Gen. Bus. Posting Group" := ServiceLine."Gen. Bus. Posting Group";
      "Gen. Prod. Posting Group" := ServiceLine."Gen. Prod. Posting Group";
      "Applies-to Entry" := ServiceLine."Appl.-to Item Entry";
      "Transaction Type" := ServiceLine."Transaction Type";
      "Transport Method" := ServiceLine."Transport Method";
      "Entry/Exit Point" := ServiceLine."Exit Point";
      Area := ServiceLine.Area;
      "Transaction Specification" := ServiceLine."Transaction Specification";
      "Entry Type" := "Entry Type"::Sale;
      "Unit of Measure Code" := ServiceLine."Unit of Measure Code";
      "Qty. per Unit of Measure" := ServiceLine."Qty. per Unit of Measure";
      "Derived from Blanket Order" := FALSE;
      "Item Category Code" := ServiceLine."Item Category Code";
      Nonstock := ServiceLine.Nonstock;
      "Product Group Code" := ServiceLine."Product Group Code";
      "Return Reason Code" := ServiceLine."Return Reason Code";
      "Order Type" := "Order Type"::Service;
      "Order No." := ServiceLine."Document No.";
      "Order Line No." := ServiceLine."Line No.";
      "Job No." := ServiceLine."Job No.";
      "Job Task No." := ServiceLine."Job Task No.";
    END;

    PROCEDURE CopyFromServShptHeader@53(ServShptHeader@1000 : Record 5990);
    BEGIN
      "Posting Date" := ServShptHeader."Posting Date";
      "Document Date" := ServShptHeader."Document Date";
      "Order Date" := ServShptHeader."Order Date";
      "Country/Region Code" := ServShptHeader."VAT Country/Region Code";
      "Source Posting Group" := ServShptHeader."Customer Posting Group";
      "Salespers./Purch. Code" := ServShptHeader."Salesperson Code";
      "Reason Code" := ServShptHeader."Reason Code";
    END;

    PROCEDURE CopyFromServShptLine@51(ServShptLine@1000 : Record 5991);
    BEGIN
      "Item No." := ServShptLine."No.";
      Description := ServShptLine.Description;
      "Gen. Bus. Posting Group" := ServShptLine."Gen. Bus. Posting Group";
      "Gen. Prod. Posting Group" := ServShptLine."Gen. Prod. Posting Group";
      "Inventory Posting Group" := ServShptLine."Posting Group";
      "Location Code" := ServShptLine."Location Code";
      "Unit of Measure Code" := ServShptLine."Unit of Measure Code";
      "Qty. per Unit of Measure" := ServShptLine."Qty. per Unit of Measure";
      "Variant Code" := ServShptLine."Variant Code";
      "Bin Code" := ServShptLine."Bin Code";
      "Shortcut Dimension 1 Code" := ServShptLine."Shortcut Dimension 1 Code";
      "Shortcut Dimension 2 Code" := ServShptLine."Shortcut Dimension 2 Code";
      "Dimension Set ID" := ServShptLine."Dimension Set ID";
      "Entry/Exit Point" := ServShptLine."Exit Point";
      "Value Entry Type" := ItemJnlLine."Value Entry Type"::"Direct Cost";
      "Transaction Type" := ServShptLine."Transaction Type";
      "Transport Method" := ServShptLine."Transport Method";
      Area := ServShptLine.Area;
      "Transaction Specification" := ServShptLine."Transaction Specification";
      "Qty. per Unit of Measure" := ServShptLine."Qty. per Unit of Measure";
      "Item Category Code" := ServShptLine."Item Category Code";
      Nonstock := ServShptLine.Nonstock;
      "Product Group Code" := ServShptLine."Product Group Code";
      "Return Reason Code" := ServShptLine."Return Reason Code";
    END;

    PROCEDURE CopyFromServShptLineUndo@60(ServShptLine@1000 : Record 5991);
    BEGIN
      "Item No." := ServShptLine."No.";
      "Order Date" := ServShptLine."Order Date";
      "Inventory Posting Group" := ServShptLine."Posting Group";
      "Gen. Bus. Posting Group" := ServShptLine."Gen. Bus. Posting Group";
      "Gen. Prod. Posting Group" := ServShptLine."Gen. Prod. Posting Group";
      "Location Code" := ServShptLine."Location Code";
      "Variant Code" := ServShptLine."Variant Code";
      "Bin Code" := ServShptLine."Bin Code";
      "Entry/Exit Point" := ServShptLine."Exit Point";
      "Shortcut Dimension 1 Code" := ServShptLine."Shortcut Dimension 1 Code";
      "Shortcut Dimension 2 Code" := ServShptLine."Shortcut Dimension 2 Code";
      "Dimension Set ID" := ServShptLine."Dimension Set ID";
      "Value Entry Type" := "Value Entry Type"::"Direct Cost";
      "Item No." := ServShptLine."No.";
      Description := ServShptLine.Description;
      "Location Code" := ServShptLine."Location Code";
      "Variant Code" := ServShptLine."Variant Code";
      "Transaction Type" := ServShptLine."Transaction Type";
      "Transport Method" := ServShptLine."Transport Method";
      Area := ServShptLine.Area;
      "Transaction Specification" := ServShptLine."Transaction Specification";
      "Unit of Measure Code" := ServShptLine."Unit of Measure Code";
      "Qty. per Unit of Measure" := ServShptLine."Qty. per Unit of Measure";
      "Derived from Blanket Order" := FALSE;
      "Item Category Code" := ServShptLine."Item Category Code";
      Nonstock := ServShptLine.Nonstock;
      "Product Group Code" := ServShptLine."Product Group Code";
      "Return Reason Code" := ServShptLine."Return Reason Code";
    END;

    LOCAL PROCEDURE ReadGLSetup@5801();
    BEGIN
      IF NOT GLSetupRead THEN BEGIN
        GLSetup.GET;
        GLSetupRead := TRUE;
      END;
    END;

    LOCAL PROCEDURE RetrieveCosts@5803();
    VAR
      StockkeepingUnit@1000 : Record 5700;
    BEGIN
      IF ("Value Entry Type" <> "Value Entry Type"::"Direct Cost") OR
         ("Item Charge No." <> '')
      THEN
        EXIT;

      ReadGLSetup;
      GetItem;
      IF StockkeepingUnit.GET("Location Code","Item No.","Variant Code") THEN
        UnitCost := StockkeepingUnit."Unit Cost"
      ELSE
        UnitCost := Item."Unit Cost";

      IF "Entry Type" = "Entry Type"::Transfer THEN
        UnitCost := 0
      ELSE
        IF Item."Costing Method" <> Item."Costing Method"::Standard THEN
          UnitCost := ROUND(UnitCost,GLSetup."Unit-Amount Rounding Precision");
    END;

    LOCAL PROCEDURE CalcUnitCost@5804(ItemLedgEntry@1000 : Record 32) : Decimal;
    VAR
      ValueEntry@1001 : Record 5802;
      UnitCost@1002 : Decimal;
    BEGIN
      WITH ValueEntry DO BEGIN
        RESET;
        SETCURRENTKEY("Item Ledger Entry No.");
        SETRANGE("Item Ledger Entry No.",ItemLedgEntry."Entry No.");
        CALCSUMS("Cost Amount (Expected)","Cost Amount (Actual)");
        UnitCost :=
          ("Cost Amount (Expected)" + "Cost Amount (Actual)") / ItemLedgEntry.Quantity;
      END;
      EXIT(ABS(UnitCost * "Qty. per Unit of Measure"));
    END;

    LOCAL PROCEDURE ClearSingleAndRolledUpCosts@4();
    BEGIN
      "Single-Level Material Cost" := "Unit Cost (Revalued)";
      "Single-Level Capacity Cost" := 0;
      "Single-Level Subcontrd. Cost" := 0;
      "Single-Level Cap. Ovhd Cost" := 0;
      "Single-Level Mfg. Ovhd Cost" := 0;
      "Rolled-up Material Cost" := "Unit Cost (Revalued)";
      "Rolled-up Capacity Cost" := 0;
      "Rolled-up Subcontracted Cost" := 0;
      "Rolled-up Mfg. Ovhd Cost" := 0;
      "Rolled-up Cap. Overhead Cost" := 0;
    END;

    LOCAL PROCEDURE GetMfgSetup@7();
    BEGIN
      IF NOT MfgSetupRead THEN
        MfgSetup.GET;
      MfgSetupRead := TRUE;
    END;

    LOCAL PROCEDURE GetProdOrderRtngLine@27(VAR ProdOrderRtngLine@1000 : Record 5409);
    BEGIN
      TESTFIELD("Order Type","Order Type"::Production);
      TESTFIELD("Order No.");
      TESTFIELD("Operation No.");

      ProdOrderRtngLine.GET(
        ProdOrderRtngLine.Status::Released,
        "Order No.","Routing Reference No.","Routing No.","Operation No.");
    END;

    PROCEDURE OnlyStopTime@24() : Boolean;
    BEGIN
      EXIT(("Setup Time" = 0) AND ("Run Time" = 0) AND ("Stop Time" <> 0));
    END;

    PROCEDURE OutputValuePosting@29() : Boolean;
    BEGIN
      EXIT(TimeIsEmpty AND ("Invoiced Quantity" <> 0) AND NOT Subcontracting);
    END;

    PROCEDURE TimeIsEmpty@26() : Boolean;
    BEGIN
      EXIT(("Setup Time" = 0) AND ("Run Time" = 0) AND ("Stop Time" = 0));
    END;

    PROCEDURE RowID1@44() : Text[250];
    VAR
      ItemTrackingMgt@1000 : Codeunit 6500;
    BEGIN
      EXIT(
        ItemTrackingMgt.ComposeRowID(DATABASE::"Item Journal Line","Entry Type",
          "Journal Template Name","Journal Batch Name",0,"Line No."));
    END;

    LOCAL PROCEDURE GetLocation@7300(LocationCode@1000 : Code[10]);
    BEGIN
      IF LocationCode = '' THEN
        CLEAR(Location)
      ELSE
        IF Location.Code <> LocationCode THEN
          Location.GET(LocationCode);
    END;

    LOCAL PROCEDURE GetBin@36(LocationCode@1000 : Code[10];BinCode@1001 : Code[20]);
    BEGIN
      IF BinCode = '' THEN
        CLEAR(Bin)
      ELSE
        IF (Bin.Code <> BinCode) OR (Bin."Location Code" <> LocationCode) THEN
          Bin.GET(LocationCode,BinCode);
    END;

    PROCEDURE ItemPosting@33() : Boolean;
    VAR
      ProdOrderRtngLine@1000 : Record 5409;
    BEGIN
      IF ("Entry Type" = "Entry Type"::Output) AND
         ("Output Quantity" <> 0) AND
         ("Operation No." <> '')
      THEN BEGIN
        ProdOrderRtngLine.GET(
          ProdOrderRtngLine.Status::Released,
          "Order No.",
          "Routing Reference No.",
          "Routing No.",
          "Operation No.");
        EXIT(ProdOrderRtngLine."Next Operation No." = '');
      END;
      EXIT(TRUE);
    END;

    LOCAL PROCEDURE CheckPlanningAssignment@34();
    BEGIN
      IF ("Quantity (Base)" <> 0) AND ("Item No." <> '') AND ("Posting Date" <> 0D) AND
         ("Entry Type" IN ["Entry Type"::"Negative Adjmt.","Entry Type"::"Positive Adjmt.","Entry Type"::Transfer])
      THEN BEGIN
        IF ("Entry Type" = "Entry Type"::Transfer) AND ("Location Code" = "New Location Code") THEN
          EXIT;

        ReserveItemJnlLine.AssignForPlanning(Rec);
      END;
    END;

    PROCEDURE LastOutputOperation@35(ItemJnlLine@1000 : Record 83) : Boolean;
    VAR
      ProdOrderRtngLine@1002 : Record 5409;
      ItemJnlPostLine@1001 : Codeunit 22;
      Operation@1003 : Boolean;
    BEGIN
      WITH ItemJnlLine DO BEGIN
        IF "Operation No." <> '' THEN BEGIN
          TESTFIELD("Routing No.");
          IF NOT ProdOrderRtngLine.GET(
               ProdOrderRtngLine.Status::Released,"Order No.",
               "Routing Reference No.","Routing No.","Operation No.")
          THEN
            ProdOrderRtngLine.GET(
              ProdOrderRtngLine.Status::Finished,"Order No.",
              "Routing Reference No.","Routing No.","Operation No.");
          IF Finished THEN
            ProdOrderRtngLine."Routing Status" := ProdOrderRtngLine."Routing Status"::Finished
          ELSE
            ProdOrderRtngLine."Routing Status" := ProdOrderRtngLine."Routing Status"::"In Progress";
          Operation := NOT ItemJnlPostLine.NextOperationExist(ProdOrderRtngLine);
        END ELSE
          Operation := TRUE;
      END;
      EXIT(Operation);
    END;

    PROCEDURE LookupItemNo@37();
    VAR
      ItemList@1000 : Page 31;
    BEGIN
      CASE "Entry Type" OF
        "Entry Type"::Consumption:
          LookupProdOrderComp;
        "Entry Type"::Output:
          LookupProdOrderLine;
        ELSE BEGIN
          ItemList.LOOKUPMODE := TRUE;
          IF ItemList.RUNMODAL = ACTION::LookupOK THEN BEGIN
            ItemList.GETRECORD(Item);
            VALIDATE("Item No.",Item."No.");
          END;
        END;
      END;
    END;

    LOCAL PROCEDURE LookupProdOrderLine@32();
    VAR
      ProdOrderLine@1004 : Record 5406;
      ProdOrderLineList@1001 : Page 5406;
    BEGIN
      ProdOrderLine.SetFilterByReleasedOrderNo("Order No.");
      ProdOrderLine.Status := ProdOrderLine.Status::Released;
      ProdOrderLine."Prod. Order No." := "Order No.";
      ProdOrderLine."Line No." := "Order Line No.";
      ProdOrderLine."Item No." := "Item No.";

      ProdOrderLineList.LOOKUPMODE(TRUE);
      ProdOrderLineList.SETTABLEVIEW(ProdOrderLine);
      ProdOrderLineList.SETRECORD(ProdOrderLine);

      IF ProdOrderLineList.RUNMODAL = ACTION::LookupOK THEN BEGIN
        ProdOrderLineList.GETRECORD(ProdOrderLine);
        VALIDATE("Item No.",ProdOrderLine."Item No.");
        IF "Order Line No." <> ProdOrderLine."Line No." THEN
          VALIDATE("Order Line No.",ProdOrderLine."Line No.");
      END;
    END;

    LOCAL PROCEDURE LookupProdOrderComp@11();
    VAR
      ProdOrderComp@1004 : Record 5407;
      ProdOrderCompLineList@1001 : Page 5407;
    BEGIN
      ProdOrderComp.SetFilterByReleasedOrderNo("Order No.");
      ProdOrderComp.Status := ProdOrderComp.Status::Released;
      ProdOrderComp."Prod. Order No." := "Order No.";
      ProdOrderComp."Prod. Order Line No." := "Order Line No.";
      ProdOrderComp."Line No." := "Prod. Order Comp. Line No.";
      ProdOrderComp."Item No." := "Item No.";

      ProdOrderCompLineList.LOOKUPMODE(TRUE);
      ProdOrderCompLineList.SETTABLEVIEW(ProdOrderComp);
      ProdOrderCompLineList.SETRECORD(ProdOrderComp);

      IF ProdOrderCompLineList.RUNMODAL = ACTION::LookupOK THEN BEGIN
        ProdOrderCompLineList.GETRECORD(ProdOrderComp);
        IF "Prod. Order Comp. Line No." <> ProdOrderComp."Line No." THEN BEGIN
          VALIDATE("Item No.",ProdOrderComp."Item No.");
          VALIDATE("Prod. Order Comp. Line No.",ProdOrderComp."Line No.");
        END;
      END;
    END;

    PROCEDURE RecalculateUnitAmount@38();
    VAR
      ItemJnlLine1@1000 : Record 83;
    BEGIN
      GetItem;

      IF ("Value Entry Type" <> "Value Entry Type"::"Direct Cost") OR
         ("Item Charge No." <> '')
      THEN BEGIN
        "Indirect Cost %" := 0;
        "Overhead Rate" := 0;
      END ELSE BEGIN
        "Indirect Cost %" := Item."Indirect Cost %";
        "Overhead Rate" := Item."Overhead Rate";
      END;

      "Qty. per Unit of Measure" := UOMMgt.GetQtyPerUnitOfMeasure(Item,"Unit of Measure Code");
      GetUnitAmount(FIELDNO("Unit of Measure Code"));

      ReadGLSetup;

      UpdateAmount;

      CASE "Entry Type" OF
        "Entry Type"::Purchase:
          BEGIN
            ItemJnlLine1.COPY(Rec);
            PurchPriceCalcMgt.FindItemJnlLinePrice(ItemJnlLine1,FIELDNO("Unit of Measure Code"));
            "Unit Cost" := ROUND(ItemJnlLine1."Unit Amount" * "Qty. per Unit of Measure",GLSetup."Unit-Amount Rounding Precision");
          END;
        "Entry Type"::Sale:
          "Unit Cost" := ROUND(UnitCost * "Qty. per Unit of Measure",GLSetup."Unit-Amount Rounding Precision");
        "Entry Type"::"Positive Adjmt.":
          "Unit Cost" :=
            ROUND(
              "Unit Amount" * (1 + "Indirect Cost %" / 100),GLSetup."Unit-Amount Rounding Precision") +
            "Overhead Rate" * "Qty. per Unit of Measure";
        "Entry Type"::"Negative Adjmt.":
          IF NOT "Phys. Inventory" THEN
            "Unit Cost" := UnitCost * "Qty. per Unit of Measure";
      END;

      IF "Entry Type" IN ["Entry Type"::Purchase,"Entry Type"::"Positive Adjmt."] THEN BEGIN
        IF Item."Costing Method" = Item."Costing Method"::Standard THEN
          "Unit Cost" := ROUND(UnitCost * "Qty. per Unit of Measure",GLSetup."Unit-Amount Rounding Precision");
      END;
    END;

    PROCEDURE IsReclass@40(ItemJnlLine@1000 : Record 83) : Boolean;
    BEGIN
      IF (ItemJnlLine."Entry Type" = ItemJnlLine."Entry Type"::Transfer) AND
         ((ItemJnlLine."Order Type" <> ItemJnlLine."Order Type"::Transfer) OR (ItemJnlLine."Order No." = ''))
      THEN
        EXIT(TRUE);
      EXIT(FALSE);
    END;

    PROCEDURE CheckWhse@39(LocationCode@1000 : Code[20];VAR QtyToPost@1002 : Decimal);
    VAR
      Location@1001 : Record 14;
    BEGIN
      Location.GET(LocationCode);
      IF Location."Require Put-away" AND
         (NOT Location."Directed Put-away and Pick") AND
         (NOT Location."Require Receive")
      THEN
        QtyToPost := 0;
    END;

    PROCEDURE ShowDimensions@41();
    BEGIN
      "Dimension Set ID" :=
        DimMgt.EditDimensionSet2(
          "Dimension Set ID",STRSUBSTNO('%1 %2 %3',"Journal Template Name","Journal Batch Name","Line No."),
          "Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
    END;

    PROCEDURE ShowReclasDimensions@30();
    BEGIN
      DimMgt.EditReclasDimensionSet2(
        "Dimension Set ID","New Dimension Set ID",STRSUBSTNO('%1 %2 %3',"Journal Template Name","Journal Batch Name","Line No."),
        "Shortcut Dimension 1 Code","Shortcut Dimension 2 Code","New Shortcut Dimension 1 Code","New Shortcut Dimension 2 Code");
    END;

    PROCEDURE PostingItemJnlFromProduction@43(Print@1000 : Boolean);
    VAR
      ProductionOrder@1001 : Record 5405;
    BEGIN
      IF ("Order Type" = "Order Type"::Production) AND ("Order No." <> '') THEN
        ProductionOrder.GET(ProductionOrder.Status::Released,"Order No.");
      IF Print THEN
        CODEUNIT.RUN(CODEUNIT::"Item Jnl.-Post+Print",Rec)
      ELSE
        CODEUNIT.RUN(CODEUNIT::"Item Jnl.-Post",Rec);
    END;

    PROCEDURE IsAssemblyResourceConsumpLine@87() : Boolean;
    BEGIN
      EXIT(("Entry Type" = "Entry Type"::"Assembly Output") AND (Type = Type::Resource));
    END;

    PROCEDURE IsAssemblyOutputLine@89() : Boolean;
    BEGIN
      EXIT(("Entry Type" = "Entry Type"::"Assembly Output") AND (Type = Type::" "));
    END;

    PROCEDURE IsATOCorrection@10() : Boolean;
    VAR
      ItemLedgEntry@1000 : Record 32;
      PostedATOLink@1001 : Record 914;
    BEGIN
      IF NOT Correction THEN
        EXIT(FALSE);
      IF "Entry Type" <> "Entry Type"::Sale THEN
        EXIT(FALSE);
      IF NOT ItemLedgEntry.GET("Applies-to Entry") THEN
        EXIT(FALSE);
      IF ItemLedgEntry."Entry Type" <> ItemLedgEntry."Entry Type"::Sale THEN
        EXIT(FALSE);
      PostedATOLink.SETCURRENTKEY("Document Type","Document No.","Document Line No.");
      PostedATOLink.SETRANGE("Document Type",PostedATOLink."Document Type"::"Sales Shipment");
      PostedATOLink.SETRANGE("Document No.",ItemLedgEntry."Document No.");
      PostedATOLink.SETRANGE("Document Line No.",ItemLedgEntry."Document Line No.");
      EXIT(NOT PostedATOLink.ISEMPTY);
    END;

    LOCAL PROCEDURE RevaluationPerEntryAllowed@45(ItemNo@1000 : Code[20]) : Boolean;
    VAR
      ValueEntry@1001 : Record 5802;
    BEGIN
      GetItem;
      IF Item."Costing Method" <> Item."Costing Method"::Average THEN
        EXIT(TRUE);

      ValueEntry.SETRANGE("Item No.",ItemNo);
      ValueEntry.SETRANGE("Entry Type",ValueEntry."Entry Type"::Revaluation);
      ValueEntry.SETRANGE("Partial Revaluation",TRUE);
      EXIT(ValueEntry.ISEMPTY);
    END;

    PROCEDURE TrackingExists@47() : Boolean;
    BEGIN
      EXIT(("Serial No." <> '') OR ("Lot No." <> ''));
    END;

    PROCEDURE IsPurchaseReturn@49() : Boolean;
    BEGIN
      EXIT(
        ("Document Type" IN ["Document Type"::"Purchase Credit Memo",
                             "Document Type"::"Purchase Return Shipment",
                             "Document Type"::"Purchase Invoice",
                             "Document Type"::"Purchase Receipt"]) AND
        (Quantity < 0));
    END;

    PROCEDURE IsOpenedFromBatch@50() : Boolean;
    VAR
      ItemJournalBatch@1002 : Record 233;
      TemplateFilter@1001 : Text;
      BatchFilter@1000 : Text;
    BEGIN
      BatchFilter := GETFILTER("Journal Batch Name");
      IF BatchFilter <> '' THEN BEGIN
        TemplateFilter := GETFILTER("Journal Template Name");
        IF TemplateFilter <> '' THEN
          ItemJournalBatch.SETFILTER("Journal Template Name",TemplateFilter);
        ItemJournalBatch.SETFILTER(Name,BatchFilter);
        ItemJournalBatch.FINDFIRST;
      END;

      EXIT((("Journal Batch Name" <> '') AND ("Journal Template Name" = '')) OR (BatchFilter <> ''));
    END;

    PROCEDURE SubcontractingWorkCenterUsed@52() : Boolean;
    VAR
      WorkCenter@1000 : Record 99000754;
    BEGIN
      IF Type = Type::"Work Center" THEN
        IF WorkCenter.GET("Work Center No.") THEN
          EXIT(WorkCenter."Subcontractor No." <> '');

      EXIT(FALSE);
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterCopyFromSalesLine@1101103000(VAR ItemJournalLineP@1101103000 : Record 83;VAR SalesLineP@1101103001 : Record 37);
    BEGIN
    END;

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 13.11.03 HHE Sjekker om varen er en Simuleringsvare
      02. 16.11.03 HHE Lagt til feltet "shelf no." (brukes i varetelling-sortering)
                              Opprettet feltet "Beskr. 2"
                              Ved validering av "Item No." settes "BEskr. 2" og "Shelf No." inn.
                              Ny Key:Journal Template Name,Journal Batch Name,Shelf No.
      03. 07.12.05 ASL Nytt felt "Print Cap.Ledger Entry" brukes til utskrift av kvitteringsliste p† kapasitetsposter
      04. 04.04.06 ASL Nytt felt "Routing Link Code". Brukes til † sortere varer p† forbrukskladd p† monteringsstasjoner.
      05. 10.03.08 HHe/MBS Kode som gir riktig oppslag p† varenr. fra varekladd.
                                                          Removed when upgraded to NAV 2017 CU3
      06. 12.01.09 BVM   Utvidet felt Shelf nr. fra 10 til 15 tegn
      07 29.03.17 JAL Moved Code to Events


      +-------------------------------------------------+
      | OPC                                             |
      +-------------------------------------------------+
      OPC1.0     16.11.09 HHE "Stop Code" and "Scrap Code": 10 -> 20 digits
                              New field: "Comment at p.o.route line" and "Scrap Comment"
    }
    END.
  }
}

OBJECT Table 5407 Prod. Order Component
{
  OBJECT-PROPERTIES
  {
    Date=20.04.17;
    Time=15.59.59;
    Modified=Yes;
    Version List=NAVW110.00.00.14199,OPC1.0;
  }
  PROPERTIES
  {
    DataCaptionFields=Status,Prod. Order No.;
    OnInsert=BEGIN
               IF Status = Status::Finished THEN
                 ERROR(Text000);

               ReserveProdOrderComp.VerifyQuantity(Rec,xRec);

               IF Status = Status::Released THEN
                 WhseProdRelease.ReleaseLine(Rec,xRec);
             END;

    OnModify=BEGIN
               IF Status = Status::Finished THEN
                 ERROR(Text000);

               WhseValidateSourceLine.ProdComponentVerifyChange(Rec,xRec);
               ReserveProdOrderComp.VerifyChange(Rec,xRec);
               IF Status = Status::Released THEN
                 WhseProdRelease.ReleaseLine(Rec,xRec);
             END;

    OnDelete=VAR
               ProdOrderLine@1000 : Record 5406;
               ProdOrderBOMComment@1001 : Record 5416;
               ItemLedgEntry@1004 : Record 32;
               ItemTrackingMgt@1002 : Codeunit 6500;
               NewQuantity@1003 : Decimal;
             BEGIN
               IF Status = Status::Finished THEN
                 ERROR(Text000);
               IF Status = Status::Released THEN BEGIN
                 ItemLedgEntry.SETCURRENTKEY("Order Type","Order No.","Order Line No.","Entry Type","Prod. Order Comp. Line No.");
                 ItemLedgEntry.SETRANGE("Order Type",ItemLedgEntry."Order Type"::Production);
                 ItemLedgEntry.SETRANGE("Order No.","Prod. Order No.");
                 ItemLedgEntry.SETRANGE("Order Line No.","Prod. Order Line No.");
                 ItemLedgEntry.SETRANGE("Entry Type",ItemLedgEntry."Entry Type"::Consumption);
                 ItemLedgEntry.SETRANGE("Prod. Order Comp. Line No.","Line No.");
                 IF ItemLedgEntry.FINDFIRST THEN
                   ERROR(Text99000000,ItemLedgEntry."Item No.","Line No.");
               END;

               WhseValidateSourceLine.ProdComponentDelete(Rec);
               ReserveProdOrderComp.DeleteLine(Rec);

               CALCFIELDS("Reserved Qty. (Base)");
               TESTFIELD("Reserved Qty. (Base)",0);

               IF "Supplied-by Line No." > 0 THEN
                 IF ProdOrderLine.GET(Status,"Prod. Order No.","Supplied-by Line No.") THEN BEGIN
                   NewQuantity := ProdOrderLine.Quantity - "Expected Quantity";
                   IF NewQuantity = 0 THEN BEGIN
                     ProdOrderLine.SetCalledFromComponent(TRUE);
                     ProdOrderLine.DELETE(TRUE);
                   END ELSE BEGIN
                     ProdOrderLine.VALIDATE(Quantity,NewQuantity);
                     ProdOrderLine.MODIFY;
                     ProdOrderLine.UpdateProdOrderComp(ProdOrderLine."Qty. per Unit of Measure");
                   END;
                 END;

               ProdOrderBOMComment.SETRANGE(Status,Status);
               ProdOrderBOMComment.SETRANGE("Prod. Order No.","Prod. Order No.");
               ProdOrderBOMComment.SETRANGE("Prod. Order Line No.","Prod. Order Line No.");
               ProdOrderBOMComment.SETRANGE("Prod. Order BOM Line No.","Line No.");
               ProdOrderBOMComment.DELETEALL;

               WhseProdRelease.DeleteLine(Rec);

               ItemTrackingMgt.DeleteWhseItemTrkgLines(
                 DATABASE::"Prod. Order Component",Status,"Prod. Order No.",'',
                 "Prod. Order Line No.","Line No.","Location Code",TRUE);
             END;

    OnRename=BEGIN
               ERROR(Text99000001,TABLECAPTION);
             END;

    CaptionML=[ENU=Prod. Order Component;
               NOR=Prod.ordrekomponent];
    LookupPageID=Page5407;
    DrillDownPageID=Page5407;
  }
  FIELDS
  {
    { 1   ;   ;Status              ;Option        ;CaptionML=[ENU=Status;
                                                              NOR=Status];
                                                   OptionCaptionML=[ENU=Simulated,Planned,Firm Planned,Released,Finished;
                                                                    NOR=Simulert,Planlagt,Fast planlagt,Frigitt,Ferdig];
                                                   OptionString=Simulated,Planned,Firm Planned,Released,Finished }
    { 2   ;   ;Prod. Order No.     ;Code20        ;TableRelation="Production Order".No. WHERE (Status=FIELD(Status));
                                                   CaptionML=[ENU=Prod. Order No.;
                                                              NOR=Prod.ordrenr.] }
    { 3   ;   ;Prod. Order Line No.;Integer       ;TableRelation="Prod. Order Line"."Line No." WHERE (Status=FIELD(Status),
                                                                                                      Prod. Order No.=FIELD(Prod. Order No.));
                                                   CaptionML=[ENU=Prod. Order Line No.;
                                                              NOR=Prod.ordrelinjenr.] }
    { 4   ;   ;Line No.            ;Integer       ;CaptionML=[ENU=Line No.;
                                                              NOR=Linjenr.] }
    { 11  ;   ;Item No.            ;Code20        ;TableRelation=Item WHERE (Type=CONST(Inventory));
                                                   OnValidate=BEGIN
                                                                WhseValidateSourceLine.ProdComponentVerifyChange(Rec,xRec);
                                                                ReserveProdOrderComp.VerifyChange(Rec,xRec);
                                                                CALCFIELDS("Reserved Qty. (Base)");
                                                                TESTFIELD("Reserved Qty. (Base)",0);
                                                                TESTFIELD("Remaining Qty. (Base)","Expected Qty. (Base)");
                                                                IF "Item No." = '' THEN BEGIN
                                                                  CreateDim(DATABASE::Item,"Item No.");
                                                                  EXIT;
                                                                END;

                                                                Item.GET("Item No.");
                                                                IF "Item No." <> xRec."Item No." THEN BEGIN
                                                                  "Variant Code" := '';
                                                                  GetDefaultBin;
                                                                  ClearCalcFormula;
                                                                  IF "Quantity per" <> 0 THEN
                                                                    VALIDATE("Quantity per");
                                                                END;
                                                                Description := Item.Description;
                                                                Item.TESTFIELD("Base Unit of Measure");
                                                                VALIDATE("Unit of Measure Code",Item."Base Unit of Measure");
                                                                GetUpdateFromSKU;
                                                                CreateDim(DATABASE::Item,"Item No.");
                                                                DimMgt.UpdateGlobalDimFromDimSetID("Dimension Set ID","Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
                                                              END;

                                                   CaptionML=[ENU=Item No.;
                                                              NOR=Varenr.] }
    { 12  ;   ;Description         ;Text50        ;CaptionML=[ENU=Description;
                                                              NOR=Beskrivelse] }
    { 13  ;   ;Unit of Measure Code;Code10        ;TableRelation="Item Unit of Measure".Code WHERE (Item No.=FIELD(Item No.));
                                                   OnValidate=BEGIN
                                                                WhseValidateSourceLine.ProdComponentVerifyChange(Rec,xRec);

                                                                Item.GET("Item No.");
                                                                GetGLSetup;

                                                                "Qty. per Unit of Measure" := UOMMgt.GetQtyPerUnitOfMeasure(Item,"Unit of Measure Code");
                                                                "Quantity (Base)" := CalcBaseQty(Quantity);

                                                                UpdateUnitCost;

                                                                VALIDATE("Expected Quantity",Quantity * ProdOrderNeeds);
                                                              END;

                                                   CaptionML=[ENU=Unit of Measure Code;
                                                              NOR=Enhetskode] }
    { 14  ;   ;Quantity            ;Decimal       ;CaptionML=[ENU=Quantity;
                                                              NOR=Antall];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 15  ;   ;Position            ;Code10        ;CaptionML=[ENU=Position;
                                                              NOR=Posisjon] }
    { 16  ;   ;Position 2          ;Code10        ;CaptionML=[ENU=Position 2;
                                                              NOR=Posisjon 2] }
    { 17  ;   ;Position 3          ;Code10        ;CaptionML=[ENU=Position 3;
                                                              NOR=Posisjon 3] }
    { 18  ;   ;Lead-Time Offset    ;DateFormula   ;CaptionML=[ENU=Lead-Time Offset;
                                                              NOR=Forskyvning av leveringstid] }
    { 19  ;   ;Routing Link Code   ;Code10        ;TableRelation="Routing Link";
                                                   OnValidate=VAR
                                                                ProdOrderLine@1000 : Record 5406;
                                                                ProdOrderRtngLine@1001 : Record 5409;
                                                              BEGIN
                                                                VALIDATE("Expected Quantity",Quantity * ProdOrderNeeds);

                                                                ProdOrderLine.GET(Status,"Prod. Order No.","Prod. Order Line No.");

                                                                "Due Date" := ProdOrderLine."Starting Date";
                                                                "Due Time" := ProdOrderLine."Starting Time";
                                                                IF "Routing Link Code" <> '' THEN BEGIN
                                                                  ProdOrderRtngLine.SETRANGE(Status,Status);
                                                                  ProdOrderRtngLine.SETRANGE("Prod. Order No.","Prod. Order No.");
                                                                  ProdOrderRtngLine.SETRANGE("Routing No.",ProdOrderLine."Routing No.");
                                                                  ProdOrderRtngLine.SETRANGE("Routing Reference No.",ProdOrderLine."Routing Reference No.");
                                                                  ProdOrderRtngLine.SETRANGE("Routing Link Code","Routing Link Code");
                                                                  IF ProdOrderRtngLine.FINDFIRST THEN BEGIN
                                                                    "Due Date" := ProdOrderRtngLine."Starting Date";
                                                                    "Due Time" := ProdOrderRtngLine."Starting Time";
                                                                  END;
                                                                END;
                                                                IF FORMAT("Lead-Time Offset") <> '' THEN BEGIN
                                                                  "Due Date" :=
                                                                    "Due Date" -
                                                                    (CALCDATE("Lead-Time Offset",WORKDATE) - WORKDATE);
                                                                  "Due Time" := 0T;
                                                                END;
                                                                VALIDATE("Due Date");

                                                                IF "Routing Link Code" <> xRec."Routing Link Code" THEN
                                                                  UpdateBin(Rec,FIELDNO("Routing Link Code"),FIELDCAPTION("Routing Link Code"));
                                                              END;

                                                   CaptionML=[ENU=Routing Link Code;
                                                              NOR=Rutekoblingskode] }
    { 20  ;   ;Scrap %             ;Decimal       ;OnValidate=BEGIN
                                                                VALIDATE("Calculation Formula");
                                                              END;

                                                   CaptionML=[ENU=Scrap %;
                                                              NOR=Vrak-%];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0;
                                                   MaxValue=100 }
    { 21  ;   ;Variant Code        ;Code10        ;TableRelation="Item Variant".Code WHERE (Item No.=FIELD(Item No.));
                                                   OnValidate=VAR
                                                                ItemVariant@1000 : Record 5401;
                                                              BEGIN
                                                                IF Item."No." <> "Item No." THEN
                                                                  Item.GET("Item No.");
                                                                IF "Variant Code" = '' THEN
                                                                  Description := Item.Description
                                                                ELSE BEGIN
                                                                  ItemVariant.GET("Item No.","Variant Code");
                                                                  Description := ItemVariant.Description;
                                                                END;
                                                                GetDefaultBin;
                                                                WhseValidateSourceLine.ProdComponentVerifyChange(Rec,xRec);
                                                                ReserveProdOrderComp.VerifyChange(Rec,xRec);
                                                                CALCFIELDS("Reserved Qty. (Base)");
                                                                TESTFIELD("Reserved Qty. (Base)",0);
                                                                TESTFIELD("Remaining Qty. (Base)","Expected Qty. (Base)");
                                                                UpdateUnitCost;
                                                                VALIDATE("Expected Quantity");
                                                                GetUpdateFromSKU;
                                                              END;

                                                   CaptionML=[ENU=Variant Code;
                                                              NOR=Variantkode] }
    { 25  ;   ;Expected Quantity   ;Decimal       ;OnValidate=BEGIN
                                                                IF Item.GET("Item No.") THEN
                                                                  IF Item."Rounding Precision" > 0 THEN
                                                                    "Expected Quantity" := ROUND("Expected Quantity",Item."Rounding Precision",'>');
                                                                "Expected Qty. (Base)" := ROUND("Expected Quantity" * "Qty. per Unit of Measure",0.00001);
                                                                IF (Status IN [Status::Released,Status::Finished]) AND
                                                                   (xRec."Item No." <> '') AND
                                                                   ("Line No." <> 0)
                                                                THEN
                                                                  CALCFIELDS("Act. Consumption (Qty)");
                                                                "Remaining Quantity" := "Expected Quantity" - "Act. Consumption (Qty)" / "Qty. per Unit of Measure";
                                                                IF ("Remaining Quantity" * "Expected Quantity") <= 0 THEN
                                                                  "Remaining Quantity" := 0;
                                                                "Remaining Qty. (Base)" := ROUND("Remaining Quantity" * "Qty. per Unit of Measure",0.00001);
                                                                "Completely Picked" := "Qty. Picked" >= "Expected Quantity";

                                                                ReserveProdOrderComp.VerifyQuantity(Rec,xRec);

                                                                "Cost Amount" := ROUND("Expected Quantity" * "Unit Cost");
                                                                "Overhead Amount" :=
                                                                  ROUND(
                                                                    "Expected Quantity" *
                                                                    (("Direct Unit Cost" * "Indirect Cost %" / 100) + "Overhead Rate"));
                                                                "Direct Cost Amount" := ROUND("Expected Quantity" * "Direct Unit Cost");
                                                              END;

                                                   CaptionML=[ENU=Expected Quantity;
                                                              NOR=Forventet antall];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 26  ;   ;Remaining Quantity  ;Decimal       ;CaptionML=[ENU=Remaining Quantity;
                                                              NOR=Restantall];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 27  ;   ;Act. Consumption (Qty);Decimal     ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Item Ledger Entry".Quantity WHERE (Entry Type=CONST(Consumption),
                                                                                                        Order Type=CONST(Production),
                                                                                                        Order No.=FIELD(Prod. Order No.),
                                                                                                        Order Line No.=FIELD(Prod. Order Line No.),
                                                                                                        Prod. Order Comp. Line No.=FIELD(Line No.)));
                                                   AccessByPermission=TableData 5405=R;
                                                   CaptionML=[ENU=Act. Consumption (Qty);
                                                              NOR=Fakt. forbruk (ant.)];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 28  ;   ;Flushing Method     ;Option        ;OnValidate=VAR
                                                                ItemLedgEntry@1000 : Record 32;
                                                                PickWhseWorksheetLine@1001 : Record 7326;
                                                              BEGIN
                                                                IF ("Flushing Method" = "Flushing Method"::Backward) AND (Status = Status::Released) THEN BEGIN
                                                                  ItemLedgEntry.SETRANGE("Order Type",ItemLedgEntry."Order Type"::Production);
                                                                  ItemLedgEntry.SETRANGE("Order No.","Prod. Order No.");
                                                                  ItemLedgEntry.SETRANGE("Order Line No.","Prod. Order Line No.");
                                                                  ItemLedgEntry.SETRANGE("Entry Type",ItemLedgEntry."Entry Type"::Consumption);
                                                                  ItemLedgEntry.SETRANGE("Prod. Order Comp. Line No.","Line No.");
                                                                  IF "Line No." = 0 THEN
                                                                    ItemLedgEntry.SETRANGE("Item No.","Item No.");
                                                                  IF NOT ItemLedgEntry.ISEMPTY THEN
                                                                    ERROR(Text99000002,"Flushing Method",ItemLedgEntry.TABLECAPTION);
                                                                END;

                                                                IF ("Flushing Method" <> xRec."Flushing Method") AND
                                                                   (xRec."Flushing Method" IN
                                                                    [xRec."Flushing Method"::Manual,
                                                                     xRec."Flushing Method"::"Pick + Forward",
                                                                     xRec."Flushing Method"::"Pick + Backward"])
                                                                THEN BEGIN
                                                                  CALCFIELDS("Pick Qty.");
                                                                  IF "Pick Qty." <> 0 THEN
                                                                    ERROR(Text99000007,"Flushing Method","Item No.");

                                                                  IF "Qty. Picked" <> 0 THEN
                                                                    ERROR(Text99000008,"Flushing Method","Item No.");

                                                                  IF (xRec."Flushing Method" IN
                                                                      [xRec."Flushing Method"::Manual,
                                                                       xRec."Flushing Method"::"Pick + Forward",
                                                                       xRec."Flushing Method"::"Pick + Backward"]) AND
                                                                     ("Flushing Method" IN ["Flushing Method"::Forward,"Flushing Method"::Backward])
                                                                  THEN BEGIN
                                                                    PickWhseWorksheetLine.SETRANGE("Source Type",DATABASE::"Prod. Order Component");
                                                                    PickWhseWorksheetLine.SETRANGE("Source No.","Prod. Order No.");
                                                                    PickWhseWorksheetLine.SETRANGE("Source Line No.","Prod. Order Line No.");
                                                                    PickWhseWorksheetLine.SETRANGE("Source Subline No.","Line No.");
                                                                    IF NOT PickWhseWorksheetLine.ISEMPTY THEN
                                                                      ERROR(Text99000002,"Flushing Method",PickWhseWorksheetLine.TABLECAPTION);
                                                                  END;
                                                                END;

                                                                IF "Flushing Method" <> xRec."Flushing Method" THEN
                                                                  UpdateBin(Rec,FIELDNO("Flushing Method"),FIELDCAPTION("Flushing Method"));
                                                              END;

                                                   CaptionML=[ENU=Flushing Method;
                                                              NOR=Trekkmetode];
                                                   OptionCaptionML=[ENU=Manual,Forward,Backward,Pick + Forward,Pick + Backward;
                                                                    NOR=Manuell,Fremover,Bakover,Plukk + Fremover,Plukk + Bakover];
                                                   OptionString=Manual,Forward,Backward,Pick + Forward,Pick + Backward }
    { 30  ;   ;Location Code       ;Code10        ;TableRelation=Location WHERE (Use As In-Transit=CONST(No));
                                                   OnValidate=BEGIN
                                                                IF Item."No." <> "Item No." THEN
                                                                  Item.GET("Item No.");
                                                                UpdateUnitCost;
                                                                VALIDATE("Expected Quantity");

                                                                GetDefaultBin;
                                                                WhseValidateSourceLine.ProdComponentVerifyChange(Rec,xRec);
                                                                ReserveProdOrderComp.VerifyChange(Rec,xRec);
                                                                GetUpdateFromSKU;
                                                              END;

                                                   CaptionML=[ENU=Location Code;
                                                              NOR=Lokasjonskode] }
    { 31  ;   ;Shortcut Dimension 1 Code;Code20   ;TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(1));
                                                   OnValidate=BEGIN
                                                                ValidateShortcutDimCode(1,"Shortcut Dimension 1 Code");
                                                              END;

                                                   CaptionML=[ENU=Shortcut Dimension 1 Code;
                                                              NOR=Snarveisdimensjon 1 - kode];
                                                   CaptionClass='1,2,1' }
    { 32  ;   ;Shortcut Dimension 2 Code;Code20   ;TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(2));
                                                   OnValidate=BEGIN
                                                                ValidateShortcutDimCode(2,"Shortcut Dimension 2 Code");
                                                              END;

                                                   CaptionML=[ENU=Shortcut Dimension 2 Code;
                                                              NOR=Snarveisdimensjon 2 - kode];
                                                   CaptionClass='1,2,2' }
    { 33  ;   ;Bin Code            ;Code20        ;TableRelation=Bin.Code WHERE (Location Code=FIELD(Location Code));
                                                   OnValidate=VAR
                                                                WMSManagement@1000 : Codeunit 7302;
                                                                WhseIntegrationMgt@1001 : Codeunit 7317;
                                                              BEGIN
                                                                IF "Bin Code" <> '' THEN BEGIN
                                                                  TESTFIELD("Location Code");
                                                                  WMSManagement.FindBin("Location Code","Bin Code",'');
                                                                  WhseIntegrationMgt.CheckBinTypeCode(DATABASE::"Prod. Order Component",
                                                                    FIELDCAPTION("Bin Code"),
                                                                    "Location Code",
                                                                    "Bin Code",0);
                                                                  CheckBin;
                                                                END;
                                                              END;

                                                   OnLookup=VAR
                                                              WMSManagement@1000 : Codeunit 7302;
                                                              BinCode@1001 : Code[20];
                                                            BEGIN
                                                              IF Quantity > 0 THEN
                                                                BinCode := WMSManagement.BinContentLookUp("Location Code","Item No.","Variant Code",'',"Bin Code")
                                                              ELSE
                                                                BinCode := WMSManagement.BinLookUp("Location Code","Item No.","Variant Code",'');

                                                              IF BinCode <> '' THEN
                                                                VALIDATE("Bin Code",BinCode);
                                                            END;

                                                   CaptionML=[ENU=Bin Code;
                                                              NOR=Hyllekode] }
    { 35  ;   ;Supplied-by Line No.;Integer       ;TableRelation="Prod. Order Line"."Line No." WHERE (Status=FIELD(Status),
                                                                                                      Prod. Order No.=FIELD(Prod. Order No.),
                                                                                                      Line No.=FIELD(Supplied-by Line No.));
                                                   CaptionML=[ENU=Supplied-by Line No.;
                                                              NOR=Forsynt av-linjenr.] }
    { 36  ;   ;Planning Level Code ;Integer       ;CaptionML=[ENU=Planning Level Code;
                                                              NOR=Planl.niv† - kode];
                                                   Editable=No }
    { 37  ;   ;Item Low-Level Code ;Integer       ;CaptionML=[ENU=Item Low-Level Code;
                                                              NOR=Varens lavniv†kode] }
    { 40  ;   ;Length              ;Decimal       ;OnValidate=BEGIN
                                                                VALIDATE("Calculation Formula");
                                                              END;

                                                   CaptionML=[ENU=Length;
                                                              NOR=Lengde];
                                                   DecimalPlaces=0:5 }
    { 41  ;   ;Width               ;Decimal       ;OnValidate=BEGIN
                                                                VALIDATE("Calculation Formula");
                                                              END;

                                                   CaptionML=[ENU=Width;
                                                              NOR=Bredde];
                                                   DecimalPlaces=0:5 }
    { 42  ;   ;Weight              ;Decimal       ;OnValidate=BEGIN
                                                                VALIDATE("Calculation Formula");
                                                              END;

                                                   CaptionML=[ENU=Weight;
                                                              NOR=Vekt];
                                                   DecimalPlaces=0:5 }
    { 43  ;   ;Depth               ;Decimal       ;OnValidate=BEGIN
                                                                VALIDATE("Calculation Formula");
                                                              END;

                                                   CaptionML=[ENU=Depth;
                                                              NOR=Dybde];
                                                   DecimalPlaces=0:5 }
    { 44  ;   ;Calculation Formula ;Option        ;OnValidate=BEGIN
                                                                CASE "Calculation Formula" OF
                                                                  "Calculation Formula"::" ":
                                                                    Quantity := "Quantity per";
                                                                  "Calculation Formula"::Length:
                                                                    Quantity := ROUND(Length * "Quantity per",0.00001);
                                                                  "Calculation Formula"::"Length * Width":
                                                                    Quantity := ROUND(Length * Width * "Quantity per",0.00001);
                                                                  "Calculation Formula"::"Length * Width * Depth":
                                                                    Quantity := ROUND(Length * Width * Depth * "Quantity per",0.00001);
                                                                  "Calculation Formula"::Weight:
                                                                    Quantity := ROUND(Weight * "Quantity per",0.00001);
                                                                END;
                                                                "Quantity (Base)" := Quantity * "Qty. per Unit of Measure";
                                                                VALIDATE("Expected Quantity",Quantity * ProdOrderNeeds);
                                                              END;

                                                   CaptionML=[ENU=Calculation Formula;
                                                              NOR=Beregningsformel];
                                                   OptionCaptionML=[ENU=" ,Length,Length * Width,Length * Width * Depth,Weight";
                                                                    NOR=" ,Lengde,Lengde * Bredde,Lengde * bredde * Dybde,Vekt"];
                                                   OptionString=[ ,Length,Length * Width,Length * Width * Depth,Weight] }
    { 45  ;   ;Quantity per        ;Decimal       ;OnValidate=BEGIN
                                                                WhseValidateSourceLine.ProdComponentVerifyChange(Rec,xRec);
                                                                TESTFIELD("Item No.");
                                                                VALIDATE("Calculation Formula");
                                                              END;

                                                   CaptionML=[ENU=Quantity per;
                                                              NOR=Antall per];
                                                   DecimalPlaces=0:5 }
    { 50  ;   ;Unit Cost           ;Decimal       ;OnValidate=BEGIN
                                                                TESTFIELD("Item No.");

                                                                Item.GET("Item No.");
                                                                GetGLSetup;
                                                                IF Item."Costing Method" = Item."Costing Method"::Standard THEN BEGIN
                                                                  IF CurrFieldNo = FIELDNO("Unit Cost") THEN
                                                                    ERROR(
                                                                      Text99000003,
                                                                      FIELDCAPTION("Unit Cost"),Item.FIELDCAPTION("Costing Method"),Item."Costing Method");
                                                                  UpdateUnitCost;
                                                                END;
                                                                VALIDATE("Calculation Formula");
                                                              END;

                                                   CaptionML=[ENU=Unit Cost;
                                                              NOR=Enhetskost];
                                                   DecimalPlaces=2:5 }
    { 51  ;   ;Cost Amount         ;Decimal       ;CaptionML=[ENU=Cost Amount;
                                                              NOR=Kostbel›p];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 52  ;   ;Due Date            ;Date          ;OnValidate=VAR
                                                                CheckDateConflict@1000 : Codeunit 99000815;
                                                              BEGIN
                                                                WhseValidateSourceLine.ProdComponentVerifyChange(Rec,xRec);
                                                                IF NOT Blocked THEN BEGIN
                                                                  IF CurrFieldNo <> 0 THEN
                                                                    CheckDateConflict.ProdOrderComponentCheck(Rec,TRUE,TRUE)
                                                                  ELSE
                                                                    IF CheckDateConflict.ProdOrderComponentCheck(Rec,NOT WarningRaised,FALSE) THEN
                                                                      WarningRaised := TRUE;
                                                                END;
                                                                UpdateDatetime;
                                                              END;

                                                   CaptionML=[ENU=Due Date;
                                                              NOR=Forfallsdato] }
    { 53  ;   ;Due Time            ;Time          ;OnValidate=BEGIN
                                                                UpdateDatetime;
                                                              END;

                                                   CaptionML=[ENU=Due Time;
                                                              NOR=Forfallstidsp.] }
    { 60  ;   ;Qty. per Unit of Measure;Decimal   ;CaptionML=[ENU=Qty. per Unit of Measure;
                                                              NOR=Antall per enhet];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 61  ;   ;Remaining Qty. (Base);Decimal      ;CaptionML=[ENU=Remaining Qty. (Base);
                                                              NOR=Restlager (ant.)];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 62  ;   ;Quantity (Base)     ;Decimal       ;CaptionML=[ENU=Quantity (Base);
                                                              NOR=Antall (lagerenhet)];
                                                   DecimalPlaces=0:5 }
    { 63  ;   ;Reserved Qty. (Base);Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Reservation Entry"."Quantity (Base)" WHERE (Source ID=FIELD(Prod. Order No.),
                                                                                                                 Source Ref. No.=FIELD(Line No.),
                                                                                                                 Source Type=CONST(5407),
                                                                                                                 Source Subtype=FIELD(Status),
                                                                                                                 Source Batch Name=CONST(),
                                                                                                                 Source Prod. Order Line=FIELD(Prod. Order Line No.),
                                                                                                                 Reservation Status=CONST(Reservation)));
                                                   CaptionML=[ENU=Reserved Qty. (Base);
                                                              NOR=Reservert antall (lagerenhet)];
                                                   DecimalPlaces=0:5;
                                                   Editable=Yes }
    { 71  ;   ;Reserved Quantity   ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Reservation Entry".Quantity WHERE (Source ID=FIELD(Prod. Order No.),
                                                                                                        Source Ref. No.=FIELD(Line No.),
                                                                                                        Source Type=CONST(5407),
                                                                                                        Source Subtype=FIELD(Status),
                                                                                                        Source Batch Name=CONST(),
                                                                                                        Source Prod. Order Line=FIELD(Prod. Order Line No.),
                                                                                                        Reservation Status=CONST(Reservation)));
                                                   CaptionML=[ENU=Reserved Quantity;
                                                              NOR=Reservert antall];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 73  ;   ;Expected Qty. (Base);Decimal       ;OnValidate=BEGIN
                                                                IF Status <> Status::Simulated THEN BEGIN
                                                                  IF Status IN [Status::Released,Status::Finished] THEN
                                                                    CALCFIELDS("Act. Consumption (Qty)");
                                                                  "Remaining Quantity" := "Expected Quantity" - "Act. Consumption (Qty)";
                                                                  "Remaining Qty. (Base)" := ROUND("Remaining Quantity" * "Qty. per Unit of Measure",0.00001);
                                                                END;
                                                                "Cost Amount" := ROUND("Expected Quantity" * "Unit Cost");
                                                                "Overhead Amount" :=
                                                                  ROUND(
                                                                    "Expected Quantity" *
                                                                    (("Direct Unit Cost" * "Indirect Cost %" / 100) + "Overhead Rate"));
                                                                "Direct Cost Amount" := ROUND("Expected Quantity" * "Direct Unit Cost");
                                                              END;

                                                   CaptionML=[ENU=Expected Qty. (Base);
                                                              NOR=Forventet antall (lagerenhet)];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 76  ;   ;Due Date-Time       ;DateTime      ;OnValidate=BEGIN
                                                                "Due Date" := DT2DATE("Due Date-Time");
                                                                "Due Time" := DT2TIME("Due Date-Time");
                                                                VALIDATE("Due Date");
                                                              END;

                                                   CaptionML=[ENU=Due Date-Time;
                                                              NOR=Forfallsdato-tidsp.] }
    { 480 ;   ;Dimension Set ID    ;Integer       ;TableRelation="Dimension Set Entry";
                                                   OnLookup=BEGIN
                                                              ShowDimensions;
                                                            END;

                                                   CaptionML=[ENU=Dimension Set ID;
                                                              NOR=Dimensjonssett-ID];
                                                   Editable=No }
    { 5702;   ;Substitution Available;Boolean     ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Item Substitution" WHERE (Type=CONST(Item),
                                                                                                Substitute Type=CONST(Item),
                                                                                                No.=FIELD(Item No.),
                                                                                                Variant Code=FIELD(Variant Code)));
                                                   CaptionML=[ENU=Substitution Available;
                                                              NOR=Erstatning mulig];
                                                   Editable=No }
    { 5703;   ;Original Item No.   ;Code20        ;TableRelation=Item;
                                                   CaptionML=[ENU=Original Item No.;
                                                              NOR=Opprinnelig varenr.];
                                                   Editable=No }
    { 5704;   ;Original Variant Code;Code10       ;TableRelation="Item Variant".Code WHERE (Item No.=FIELD(Original Item No.));
                                                   CaptionML=[ENU=Original Variant Code;
                                                              NOR=Opprinnelig variantkode];
                                                   Editable=No }
    { 5750;   ;Pick Qty.           ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Warehouse Activity Line"."Qty. Outstanding" WHERE (Activity Type=FILTER(<>Put-away),
                                                                                                                       Source Type=CONST(5407),
                                                                                                                       Source Subtype=FIELD(Status),
                                                                                                                       Source No.=FIELD(Prod. Order No.),
                                                                                                                       Source Line No.=FIELD(Prod. Order Line No.),
                                                                                                                       Source Subline No.=FIELD(Line No.),
                                                                                                                       Unit of Measure Code=FIELD(Unit of Measure Code),
                                                                                                                       Action Type=FILTER(' '|Place),
                                                                                                                       Original Breakbulk=CONST(No),
                                                                                                                       Breakbulk No.=CONST(0)));
                                                   CaptionML=[ENU=Pick Qty.;
                                                              NOR=Plukkant.];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 7300;   ;Qty. Picked         ;Decimal       ;OnValidate=BEGIN
                                                                "Qty. Picked (Base)" := CalcBaseQty("Qty. Picked");
                                                                "Completely Picked" := "Qty. Picked" >= "Expected Quantity";
                                                              END;

                                                   CaptionML=[ENU=Qty. Picked;
                                                              NOR=Plukket ant.];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 7301;   ;Qty. Picked (Base)  ;Decimal       ;CaptionML=[ENU=Qty. Picked (Base);
                                                              NOR=Plukket ant. (l.enh.)];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 7302;   ;Completely Picked   ;Boolean       ;CaptionML=[ENU=Completely Picked;
                                                              NOR=Ferdig plukket];
                                                   Editable=No }
    { 7303;   ;Pick Qty. (Base)    ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Warehouse Activity Line"."Qty. Outstanding (Base)" WHERE (Activity Type=FILTER(<>Put-away),
                                                                                                                              Source Type=CONST(5407),
                                                                                                                              Source Subtype=FIELD(Status),
                                                                                                                              Source No.=FIELD(Prod. Order No.),
                                                                                                                              Source Line No.=FIELD(Prod. Order Line No.),
                                                                                                                              Source Subline No.=FIELD(Line No.),
                                                                                                                              Action Type=FILTER(' '|Place),
                                                                                                                              Original Breakbulk=CONST(No),
                                                                                                                              Breakbulk No.=CONST(0)));
                                                   CaptionML=[ENU=Pick Qty. (Base);
                                                              NOR=Plukkant. (l.enh.)];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 83001;  ;Ship now            ;Decimal       ;CaptionML=NOR=Flytt n† (antall);
                                                   Description=OPC }
    { 83002;  ;Shipped             ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Item Ledger Entry".Quantity WHERE (Entry Type=CONST(Transfer),
                                                                                                        Order Type=CONST(Production),
                                                                                                        Order No.=FIELD(Prod. Order No.),
                                                                                                        Item No.=FIELD(Item No.),
                                                                                                        Location Code=CONST(HOVED)));
                                                   CaptionML=NOR=Ant. flyttet;
                                                   Description=OPC;
                                                   Editable=No }
    { 83003;  ;Shipped qty - remaining;Decimal    ;CaptionML=NOR=Gjenst†r † flytte;
                                                   Description=OPC;
                                                   Editable=No }
    { 99000754;;Direct Unit Cost   ;Decimal       ;CaptionML=[ENU=Direct Unit Cost;
                                                              NOR=Direkte enhetskost];
                                                   DecimalPlaces=2:5 }
    { 99000755;;Indirect Cost %    ;Decimal       ;OnValidate=BEGIN
                                                                "Direct Unit Cost" :=
                                                                  ROUND(("Unit Cost" - "Overhead Rate") / (1 + "Indirect Cost %" / 100));

                                                                VALIDATE("Unit Cost");
                                                              END;

                                                   CaptionML=[ENU=Indirect Cost %;
                                                              NOR=Indirekte kost-%];
                                                   DecimalPlaces=0:5 }
    { 99000756;;Overhead Rate      ;Decimal       ;OnValidate=BEGIN
                                                                VALIDATE("Indirect Cost %");
                                                              END;

                                                   CaptionML=[ENU=Overhead Rate;
                                                              NOR=Sats for indirekte kostnader];
                                                   DecimalPlaces=0:5 }
    { 99000757;;Direct Cost Amount ;Decimal       ;CaptionML=[ENU=Direct Cost Amount;
                                                              NOR=Kj›pspris/prod.kost - bel›p];
                                                   DecimalPlaces=2:2 }
    { 99000758;;Overhead Amount    ;Decimal       ;CaptionML=[ENU=Overhead Amount;
                                                              NOR=Bel›p for indirekte kostnader];
                                                   DecimalPlaces=2:2 }
  }
  KEYS
  {
    {    ;Status,Prod. Order No.,Prod. Order Line No.,Line No.;
                                                   Clustered=Yes }
    {    ;Prod. Order No.,Prod. Order Line No.,Line No.,Status }
    {    ;Status,Prod. Order No.,Prod. Order Line No.,Due Date;
                                                   SumIndexFields=Expected Quantity,Cost Amount }
    {    ;Status,Prod. Order No.,Prod. Order Line No.,Item No.,Line No.;
                                                   MaintainSQLIndex=No }
    {    ;Status,Item No.,Variant Code,Location Code,Due Date;
                                                   SumIndexFields=Expected Quantity,Remaining Qty. (Base),Cost Amount,Overhead Amount;
                                                   MaintainSIFTIndex=No }
    { No ;Item No.,Variant Code,Location Code,Shortcut Dimension 1 Code,Shortcut Dimension 2 Code,Due Date;
                                                   SumIndexFields=Expected Quantity,Remaining Qty. (Base),Cost Amount,Overhead Amount }
    {    ;Status,Prod. Order No.,Routing Link Code,Flushing Method }
    {    ;Status,Prod. Order No.,Location Code     }
    {    ;Item No.,Variant Code,Location Code,Status,Due Date;
                                                   SumIndexFields=Expected Qty. (Base),Remaining Qty. (Base),Cost Amount,Overhead Amount,Qty. Picked (Base);
                                                   MaintainSIFTIndex=No }
    {    ;Status,Prod. Order No.,Prod. Order Line No.,Item Low-Level Code;
                                                   MaintainSQLIndex=No }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      Text000@1028 : TextConst 'ENU=A finished production order component cannot be inserted, modified, or deleted.;NOR=Kan ikke sette inn, endre eller slette en ferdig produksjonsordrekomponent.';
      Text001@1015 : TextConst 'ENU=The changed %1 now points to bin %2. Do you want to update the bin on this line?;NOR=%1 som er endret, viser n† til hylle %2. Vil du oppdatere hyllen p† denne linjen?';
      Text99000000@1000 : TextConst 'ENU=You cannot delete item %1 in line %2 because at least one item ledger entry is associated with it.;NOR=Du kan ikke slette varen %1 i linje %2 fordi den har minst ‚n varepost tilknyttet.';
      Text99000001@1001 : TextConst 'ENU=You cannot rename a %1.;NOR=Du kan ikke gi nytt navn til en %1.';
      Text99000002@1002 : TextConst 'ENU=You cannot change flushing method to %1 when there is at least one record in table %2 associated with it.;NOR=Du kan ikke endre trekkmetode til %1 n†r den har minst ‚n post i tabell %2 tilknyttet.';
      Text99000003@1003 : TextConst 'ENU=You cannot change %1 when %2 is %3.;NOR=Du kan ikke endre %1 n†r %2 er %3.';
      Item@1005 : Record 27;
      ReservEntry@1007 : Record 337;
      GLSetup@1024 : Record 98;
      Location@1012 : Record 14;
      SKU@1025 : Record 5700;
      ReservMgt@1008 : Codeunit 99000845;
      ReservEngineMgt@1009 : Codeunit 99000831;
      ReserveProdOrderComp@1010 : Codeunit 99000838;
      UOMMgt@1011 : Codeunit 5402;
      DimMgt@1014 : Codeunit 408;
      WhseProdRelease@1016 : Codeunit 5774;
      WhseValidateSourceLine@1027 : Codeunit 5777;
      ItemSubstitutionMgt@1031 : Codeunit 5701;
      Reservation@1017 : Page 498;
      Blocked@1023 : Boolean;
      GLSetupRead@1022 : Boolean;
      Text99000007@1029 : TextConst 'ENU=You cannot change flushing method to %1 because a pick has already been created for production order component %2.;NOR=Du kan ikke endre trekkmetode til %1 fordi det allerede er opprettet et plukk for produksjonsordrekomponenten %2.';
      Text99000008@1030 : TextConst 'ENU=You cannot change flushing method to %1 because production order component %2 has already been picked.;NOR=Du kan ikke endre trekkmetode til %1 fordi produksjonsordrekomponenten %2 allerede er plukket.';
      Text99000009@1013 : TextConst 'ENU=Automatic reservation is not possible.\Do you want to reserve items manually?;NOR=Det er ikke mulig † reservere automatisk.\Vil du reservere varene manuelt?';
      IgnoreErrors@1026 : Boolean;
      ErrorOccured@1032 : Boolean;
      WarningRaised@1004 : Boolean;

    PROCEDURE Caption@4() : Text[100];
    VAR
      ProdOrder@1000 : Record 5405;
      ProdOrderLine@1001 : Record 5406;
    BEGIN
      IF NOT ProdOrder.GET(Status,"Prod. Order No.") THEN
        EXIT('');

      IF NOT ProdOrderLine.GET(Status,"Prod. Order No.","Prod. Order Line No.") THEN
        CLEAR(ProdOrderLine);

      EXIT(
        STRSUBSTNO('%1 %2 %3',
          "Prod. Order No.",ProdOrder.Description,ProdOrderLine."Item No."));
    END;

    LOCAL PROCEDURE ProdOrderNeeds@1() : Decimal;
    VAR
      ProdOrderLine@1000 : Record 5406;
      ProdOrderRtngLine@1001 : Record 5409;
    BEGIN
      ProdOrderLine.GET(Status,"Prod. Order No.","Prod. Order Line No.");

      "Due Date" := ProdOrderLine."Starting Date";

      ProdOrderRtngLine.RESET;
      ProdOrderRtngLine.SETRANGE(Status,Status);
      ProdOrderRtngLine.SETRANGE("Prod. Order No.","Prod. Order No.");
      ProdOrderRtngLine.SETRANGE("Routing Reference No.",ProdOrderLine."Routing Reference No.");
      IF "Routing Link Code" <> '' THEN
        ProdOrderRtngLine.SETRANGE("Routing Link Code","Routing Link Code");
      IF ProdOrderRtngLine.FINDFIRST THEN
        EXIT(
          ProdOrderLine.Quantity *
          (1 + ProdOrderLine."Scrap %" / 100) *
          (1 + ProdOrderRtngLine."Scrap Factor % (Accumulated)") *
          (1 + "Scrap %" / 100) +
          ProdOrderRtngLine."Fixed Scrap Qty. (Accum.)");

      EXIT(
        ProdOrderLine.Quantity *
        (1 + ProdOrderLine."Scrap %" / 100) * (1 + "Scrap %" / 100));
    END;

    PROCEDURE GetNeededQty@3(CalcBasedOn@1000 : 'Actual Output,Expected Output';IncludePreviousPosting@1001 : Boolean) : Decimal;
    VAR
      ProdOrderLine@1002 : Record 5406;
      ProdOrderRtngLine@1003 : Record 5409;
      CapLedgEntry@1004 : Record 5832;
      CostCalcMgt@1006 : Codeunit 5836;
      OutputQtyBase@1005 : Decimal;
      CompQtyBase@1008 : Decimal;
    BEGIN
      Item.GET("Item No.");
      IF Item."Rounding Precision" = 0 THEN
        Item."Rounding Precision" := 0.00001;

      IF CalcBasedOn = CalcBasedOn::"Actual Output" THEN BEGIN
        ProdOrderLine.GET(Status,"Prod. Order No.","Prod. Order Line No.");

        ProdOrderRtngLine.SETRANGE(Status,Status);
        ProdOrderRtngLine.SETRANGE("Prod. Order No.","Prod. Order No.");
        ProdOrderRtngLine.SETRANGE("Routing No.",ProdOrderLine."Routing No.");
        ProdOrderRtngLine.SETRANGE("Routing Reference No.",ProdOrderLine."Routing Reference No.");
        ProdOrderRtngLine.SETRANGE("Routing Link Code","Routing Link Code");
        IF NOT ProdOrderRtngLine.FINDFIRST OR ("Routing Link Code" = '') THEN BEGIN
          ProdOrderRtngLine.SETRANGE("Routing Link Code");
          ProdOrderRtngLine.SETFILTER("Next Operation No.",'%1','');
          IF NOT ProdOrderRtngLine.FINDFIRST THEN
            ProdOrderRtngLine."Operation No." := '';
        END;
        IF Status IN [Status::Released,Status::Finished] THEN BEGIN
          CapLedgEntry.SETCURRENTKEY("Order Type","Order No.","Order Line No.");
          CapLedgEntry.SETRANGE("Order Type",CapLedgEntry."Order Type"::Production);
          CapLedgEntry.SETRANGE("Order No.","Prod. Order No.");
          CapLedgEntry.SETRANGE("Order Line No.","Prod. Order Line No.");
          CapLedgEntry.SETRANGE("Operation No.",ProdOrderRtngLine."Operation No.");
          IF CapLedgEntry.FIND('-') THEN
            REPEAT
              OutputQtyBase := OutputQtyBase + CapLedgEntry."Output Quantity" + CapLedgEntry."Scrap Quantity";
            UNTIL CapLedgEntry.NEXT = 0;
        END;

        CompQtyBase := CostCalcMgt.CalcActNeededQtyBase(ProdOrderLine,Rec,OutputQtyBase);

        IF IncludePreviousPosting THEN BEGIN
          IF Status IN [Status::Released,Status::Finished] THEN
            CALCFIELDS("Act. Consumption (Qty)");
          EXIT(
            ROUND(
              (CompQtyBase - "Act. Consumption (Qty)") / "Qty. per Unit of Measure",
              Item."Rounding Precision",'>'));
        END;
        EXIT(ROUND(CompQtyBase / "Qty. per Unit of Measure",Item."Rounding Precision",'>'));
      END;
      EXIT(ROUND("Remaining Quantity",Item."Rounding Precision"));
    END;

    PROCEDURE ShowReservation@8();
    BEGIN
      TESTFIELD("Item No.");
      CLEAR(Reservation);
      Reservation.SetProdOrderComponent(Rec);
      Reservation.RUNMODAL;
    END;

    PROCEDURE ShowReservationEntries@21(Modal@1000 : Boolean);
    BEGIN
      TESTFIELD("Item No.");
      ReservEngineMgt.InitFilterAndSortingLookupFor(ReservEntry,TRUE);
      ReserveProdOrderComp.FilterReservFor(ReservEntry,Rec);
      IF Modal THEN
        PAGE.RUNMODAL(PAGE::"Reservation Entries",ReservEntry)
      ELSE
        PAGE.RUN(PAGE::"Reservation Entries",ReservEntry);
    END;

    LOCAL PROCEDURE CalcBaseQty@14(Qty@1000 : Decimal) : Decimal;
    BEGIN
      TESTFIELD("Qty. per Unit of Measure");
      EXIT(ROUND(Qty * "Qty. per Unit of Measure",0.00001));
    END;

    PROCEDURE AdjustQtyToQtyPicked@25(VAR QtyToPost@1000 : Decimal);
    VAR
      AdjustedQty@1001 : Decimal;
    BEGIN
      AdjustedQty :=
        "Qty. Picked" + WhseValidateSourceLine.CalcNextLevelProdOutput(Rec) -
        ("Expected Quantity" - "Remaining Quantity");

      IF QtyToPost > AdjustedQty THEN
        QtyToPost := AdjustedQty;
    END;

    PROCEDURE BlockDynamicTracking@17(SetBlock@1000 : Boolean);
    BEGIN
      Blocked := SetBlock;
      ReserveProdOrderComp.Block(Blocked);
    END;

    LOCAL PROCEDURE CreateDim@5(Type1@1000 : Integer;No1@1001 : Code[20]);
    VAR
      ProdOrderLine@1004 : Record 5406;
      TableID@1002 : ARRAY [10] OF Integer;
      No@1003 : ARRAY [10] OF Code[20];
    BEGIN
      TableID[1] := Type1;
      No[1] := No1;
      "Shortcut Dimension 1 Code" := '';
      "Shortcut Dimension 2 Code" := '';

      ProdOrderLine.GET(Status,"Prod. Order No.","Prod. Order Line No.");

      "Dimension Set ID" :=
        DimMgt.GetDefaultDimID(
          TableID,No,'',"Shortcut Dimension 1 Code","Shortcut Dimension 2 Code",
          ProdOrderLine."Dimension Set ID",DATABASE::Item);
    END;

    PROCEDURE IsInbound@22() : Boolean;
    BEGIN
      EXIT("Quantity (Base)" < 0);
    END;

    PROCEDURE OpenItemTrackingLines@6500();
    BEGIN
      ReserveProdOrderComp.CallItemTracking(Rec);
    END;

    PROCEDURE ValidateShortcutDimCode@6(FieldNumber@1000 : Integer;VAR ShortcutDimCode@1001 : Code[20]);
    BEGIN
      DimMgt.ValidateShortcutDimValues(FieldNumber,ShortcutDimCode,"Dimension Set ID");
    END;

    PROCEDURE LookupShortcutDimCode@7(FieldNumber@1000 : Integer;VAR ShortcutDimCode@1001 : Code[20]);
    BEGIN
      DimMgt.LookupDimValueCode(FieldNumber,ShortcutDimCode);
      DimMgt.ValidateShortcutDimValues(FieldNumber,ShortcutDimCode,"Dimension Set ID");
    END;

    PROCEDURE ShowShortcutDimCode@9(VAR ShortcutDimCode@1000 : ARRAY [8] OF Code[20]);
    BEGIN
      DimMgt.GetShortcutDimensions("Dimension Set ID",ShortcutDimCode);
    END;

    LOCAL PROCEDURE GetUpdateFromSKU@10();
    VAR
      SKU@1000 : Record 5700;
      GetPlanningParameters@1001 : Codeunit 99000855;
    BEGIN
      GetPlanningParameters.AtSKU(SKU,"Item No.","Variant Code","Location Code");
      VALIDATE("Flushing Method",SKU."Flushing Method");
    END;

    PROCEDURE UpdateDatetime@20();
    BEGIN
      IF ("Due Date" <> 0D) AND ("Due Time" <> 0T) THEN
        "Due Date-Time" := CREATEDATETIME("Due Date","Due Time")
      ELSE
        "Due Date-Time" := 0DT;
    END;

    LOCAL PROCEDURE GetGLSetup@11();
    BEGIN
      IF NOT GLSetupRead THEN
        GLSetup.GET;
      GLSetupRead := TRUE;
    END;

    PROCEDURE RowID1@44() : Text[250];
    VAR
      ItemTrackingMgt@1000 : Codeunit 6500;
    BEGIN
      EXIT(
        ItemTrackingMgt.ComposeRowID(DATABASE::"Prod. Order Component",Status,
          "Prod. Order No.",'',"Prod. Order Line No.","Line No."));
    END;

    LOCAL PROCEDURE GetLocation@7300(LocationCode@1000 : Code[10]);
    BEGIN
      IF LocationCode = '' THEN
        CLEAR(Location)
      ELSE
        IF Location.Code <> LocationCode THEN
          Location.GET(LocationCode);
    END;

    PROCEDURE GetDefaultBin@50();
    VAR
      ProdOrderRtngLine@1000 : Record 5409;
    BEGIN
      IF (Quantity * xRec.Quantity > 0) AND
         ("Item No." = xRec."Item No.") AND
         ("Location Code" = xRec."Location Code") AND
         ("Variant Code" = xRec."Variant Code") AND
         ("Routing Link Code" = xRec."Routing Link Code")
      THEN
        EXIT;

      "Bin Code" := '';
      IF ("Location Code" <> '') AND ("Item No." <> '') THEN
        VALIDATE("Bin Code",GetDefaultConsumptionBin(ProdOrderRtngLine));
    END;

    PROCEDURE GetDefaultConsumptionBin@15(VAR ProdOrderRtngLine@1000 : Record 5409) BinCode : Code[20];
    VAR
      ProdOrderLine@1001 : Record 5406;
      WMSManagement@1002 : Codeunit 7302;
    BEGIN
      ProdOrderLine.GET(Status,"Prod. Order No.","Prod. Order Line No.");
      IF "Location Code" = ProdOrderLine."Location Code" THEN
        IF FindFirstRtngLine(ProdOrderRtngLine,ProdOrderLine) THEN
          BinCode := GetBinCodeFromRtngLine(ProdOrderRtngLine);

      IF BinCode <> '' THEN
        EXIT;

      BinCode := GetBinCodeFromLocation("Location Code");

      IF BinCode <> '' THEN
        EXIT;

      GetLocation("Location Code");
      IF Location."Bin Mandatory" AND NOT Location."Directed Put-away and Pick" THEN
        WMSManagement.GetDefaultBin("Item No.","Variant Code","Location Code",BinCode);
    END;

    LOCAL PROCEDURE FindFirstRtngLine@16(VAR ProdOrderRtngLine@1000 : Record 5409;ProdOrderLine@1001 : Record 5406) : Boolean;
    BEGIN
      ProdOrderRtngLine.RESET;
      ProdOrderRtngLine.SETCURRENTKEY(Status,"Prod. Order No.","Routing Reference No.","Routing No.","Operation No.");
      ProdOrderRtngLine.SETRANGE(Status,ProdOrderLine.Status);
      ProdOrderRtngLine.SETRANGE("Prod. Order No.",ProdOrderLine."Prod. Order No.");
      ProdOrderRtngLine.SETRANGE("Routing Reference No.",ProdOrderLine."Routing Reference No.");
      ProdOrderRtngLine.SETRANGE("Routing No.",ProdOrderLine."Routing No.");
      ProdOrderRtngLine.SETFILTER("No.",'<>%1',''); // empty No. implies blank bin codes - ignore these
      ProdOrderRtngLine.SETRANGE("Previous Operation No.",''); // first operation
      IF "Routing Link Code" <> '' THEN BEGIN
        ProdOrderRtngLine.SETRANGE("Routing Link Code","Routing Link Code");
        ProdOrderRtngLine.SETRANGE("Previous Operation No.");
        IF ProdOrderRtngLine.COUNT = 0 THEN BEGIN // no routing line with Routing Link Code found- use 1st op
          ProdOrderRtngLine.SETRANGE("Routing Link Code");
          ProdOrderRtngLine.SETRANGE("Previous Operation No.",'');
        END;
      END;

      EXIT(ProdOrderRtngLine.FINDFIRST);
    END;

    LOCAL PROCEDURE GetBinCodeFromRtngLine@18(ProdOrderRtngLine@1000 : Record 5409) BinCode : Code[20];
    BEGIN
      CASE "Flushing Method" OF
        "Flushing Method"::Manual,
        "Flushing Method"::"Pick + Forward",
        "Flushing Method"::"Pick + Backward":
          BinCode := ProdOrderRtngLine."To-Production Bin Code";
        "Flushing Method"::Forward,
        "Flushing Method"::Backward:
          BinCode := ProdOrderRtngLine."Open Shop Floor Bin Code";
      END;
    END;

    LOCAL PROCEDURE GetBinCodeFromLocation@19(LocationCode@1000 : Code[10]) BinCode : Code[20];
    BEGIN
      GetLocation(LocationCode);
      CASE "Flushing Method" OF
        "Flushing Method"::Manual,
        "Flushing Method"::"Pick + Forward",
        "Flushing Method"::"Pick + Backward":
          BinCode := Location."To-Production Bin Code";
        "Flushing Method"::Forward,
        "Flushing Method"::Backward:
          BinCode := Location."Open Shop Floor Bin Code";
      END;
    END;

    LOCAL PROCEDURE UpdateBin@23(VAR ProdOrderComp@1000 : Record 5407;FieldNo@1001 : Integer;FieldCaption@1002 : Text[30]);
    VAR
      ProdOrderComp2@1003 : Record 5407;
      OverwriteBinCode@1004 : Boolean;
    BEGIN
      ProdOrderComp2 := ProdOrderComp;
      ProdOrderComp2.GetDefaultBin;
      IF ProdOrderComp."Bin Code" <> ProdOrderComp2."Bin Code" THEN
        IF CurrFieldNo = FieldNo THEN BEGIN
          IF CONFIRM(Text001,FALSE,FieldCaption,ProdOrderComp2."Bin Code") THEN
            OverwriteBinCode := TRUE;
        END ELSE
          OverwriteBinCode := TRUE;
      IF OverwriteBinCode THEN
        ProdOrderComp."Bin Code" := ProdOrderComp2."Bin Code";
    END;

    LOCAL PROCEDURE CheckBin@24();
    VAR
      BinContent@1000 : Record 7302;
      Bin@1001 : Record 7354;
    BEGIN
      IF "Bin Code" <> '' THEN BEGIN
        GetLocation("Location Code");
        IF NOT Location."Directed Put-away and Pick" THEN
          EXIT;

        IF BinContent.GET(
             "Location Code","Bin Code",
             "Item No.","Variant Code","Unit of Measure Code")
        THEN BEGIN
          IF NOT BinContent.CheckWhseClass(IgnoreErrors) THEN
            ErrorOccured := TRUE;
        END ELSE BEGIN
          Bin.GET("Location Code","Bin Code");
          IF NOT Bin.CheckWhseClass("Item No.",IgnoreErrors) THEN
            ErrorOccured := TRUE;
        END;
      END;
      IF ErrorOccured THEN
        "Bin Code" := '';
    END;

    PROCEDURE AutoReserve@2();
    VAR
      Item@1001 : Record 27;
      FullAutoReservation@1000 : Boolean;
    BEGIN
      IF Status IN [Status::Simulated,Status::Finished] THEN
        EXIT;

      TESTFIELD("Item No.");
      Item.GET("Item No.");
      IF Item.Reserve <> Item.Reserve::Always THEN
        EXIT;

      IF "Remaining Qty. (Base)" <> 0 THEN BEGIN
        TESTFIELD("Due Date");
        ReservMgt.SetProdOrderComponent(Rec);
        ReservMgt.AutoReserve(FullAutoReservation,'',"Due Date","Remaining Quantity","Remaining Qty. (Base)");
        CALCFIELDS("Reserved Quantity","Reserved Qty. (Base)");
        FIND;
        IF NOT FullAutoReservation AND
           (CurrFieldNo <> 0)
        THEN
          IF CONFIRM(Text99000009,TRUE) THEN BEGIN
            COMMIT;
            ShowReservation;
            FIND;
          END;
      END;
    END;

    PROCEDURE ShowItemSub@30();
    BEGIN
      ItemSubstitutionMgt.GetCompSubst(Rec);
    END;

    LOCAL PROCEDURE GetSKU@5802() : Boolean;
    BEGIN
      IF (SKU."Location Code" = "Location Code") AND
         (SKU."Item No." = "Item No.") AND
         (SKU."Variant Code" = "Variant Code")
      THEN
        EXIT(TRUE);
      IF SKU.GET("Location Code","Item No.","Variant Code") THEN
        EXIT(TRUE);

      EXIT(FALSE);
    END;

    LOCAL PROCEDURE ClearCalcFormula@13();
    BEGIN
      "Calculation Formula" := "Calculation Formula"::" ";
      Length := 0;
      Width := 0;
      Weight := 0;
      Depth := 0;
    END;

    LOCAL PROCEDURE UpdateUnitCost@12();
    BEGIN
      IF GetSKU THEN
        "Unit Cost" := SKU."Unit Cost"
      ELSE
        "Unit Cost" := Item."Unit Cost";

      "Unit Cost" :=
        ROUND("Unit Cost" * "Qty. per Unit of Measure",
          GLSetup."Unit-Amount Rounding Precision");

      "Indirect Cost %" := ROUND(Item."Indirect Cost %",0.00001);

      "Overhead Rate" :=
        ROUND(Item."Overhead Rate" * "Qty. per Unit of Measure",
          GLSetup."Unit-Amount Rounding Precision");

      "Direct Unit Cost" :=
        ROUND(
          ("Unit Cost" - "Overhead Rate") / (1 + "Indirect Cost %" / 100),
          GLSetup."Unit-Amount Rounding Precision");
    END;

    PROCEDURE FilterLinesWithItemToPlan@70(VAR Item@1000 : Record 27;IncludeFirmPlanned@1001 : Boolean);
    BEGIN
      RESET;
      SETCURRENTKEY("Item No.","Variant Code","Location Code",Status,"Due Date");
      IF IncludeFirmPlanned THEN
        SETRANGE(Status,Status::Planned,Status::Released)
      ELSE
        SETFILTER(Status,'%1|%2',Status::Planned,Status::Released);
      SETRANGE("Item No.",Item."No.");
      SETFILTER("Variant Code",Item.GETFILTER("Variant Filter"));
      SETFILTER("Location Code",Item.GETFILTER("Location Filter"));
      SETFILTER("Due Date",Item.GETFILTER("Date Filter"));
      SETFILTER("Shortcut Dimension 1 Code",Item.GETFILTER("Global Dimension 1 Filter"));
      SETFILTER("Shortcut Dimension 2 Code",Item.GETFILTER("Global Dimension 2 Filter"));
      SETFILTER("Remaining Qty. (Base)",'<>0');
    END;

    PROCEDURE FindLinesWithItemToPlan@68(VAR Item@1000 : Record 27;IncludeFirmPlanned@1001 : Boolean) : Boolean;
    BEGIN
      FilterLinesWithItemToPlan(Item,IncludeFirmPlanned);
      EXIT(FIND('-'));
    END;

    PROCEDURE LinesWithItemToPlanExist@67(VAR Item@1000 : Record 27;IncludeFirmPlanned@1001 : Boolean) : Boolean;
    BEGIN
      FilterLinesWithItemToPlan(Item,IncludeFirmPlanned);
      EXIT(NOT ISEMPTY);
    END;

    PROCEDURE ShowDimensions@69();
    BEGIN
      "Dimension Set ID" :=
        DimMgt.EditDimensionSet2(
          "Dimension Set ID",STRSUBSTNO('%1 %2 %3',Status,"Prod. Order No.","Prod. Order Line No."),
          "Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
    END;

    PROCEDURE SetIgnoreErrors@31();
    BEGIN
      IgnoreErrors := TRUE;
    END;

    PROCEDURE HasErrorOccured@32() : Boolean;
    BEGIN
      EXIT(ErrorOccured);
    END;

    PROCEDURE SetFilterByReleasedOrderNo@26(OrderNo@1000 : Code[20]);
    BEGIN
      RESET;
      SETCURRENTKEY(Status,"Prod. Order No.","Prod. Order Line No.","Item No.","Line No.");
      SETRANGE(Status,Status::Released);
      SETRANGE("Prod. Order No.",OrderNo);
    END;

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 20.04.17 JAL Added fields for OPC.
    }
    END.
  }
}

OBJECT Table 5409 Prod. Order Routing Line
{
  OBJECT-PROPERTIES
  {
    Date=20.04.17;
    Time=15.54.52;
    Modified=Yes;
    Version List=NAVW110.00,OPC1.0;
  }
  PROPERTIES
  {
    Permissions=TableData 5410=rimd;
    OnInsert=BEGIN
               TESTFIELD("Routing No.");
               IF Status = Status::Finished THEN
                 ERROR(Text006,Status,TABLECAPTION);

               IF "Next Operation No." = '' THEN
                 SetNextOperations(Rec);

               UpdateComponentsBin(0); // from trigger = insert
             END;

    OnModify=BEGIN
               IF Status = Status::Finished THEN
                 ERROR(Text006,Status,TABLECAPTION);

               UpdateComponentsBin(1); // from trigger = modify
             END;

    OnDelete=VAR
               CapLedgEntry@1000 : Record 5832;
             BEGIN
               IF Status = Status::Finished THEN
                 ERROR(Text006,Status,TABLECAPTION);

               IF Status = Status::Released THEN BEGIN
                 CapLedgEntry.SETRANGE("Order Type",CapLedgEntry."Order Type"::Production);
                 CapLedgEntry.SETRANGE("Order No.","Prod. Order No.");
                 CapLedgEntry.SETRANGE("Routing Reference No.","Routing Reference No.");
                 CapLedgEntry.SETRANGE("Routing No.","Routing No.");
                 CapLedgEntry.SETRANGE("Operation No.","Operation No.");
                 IF NOT CapLedgEntry.ISEMPTY THEN
                   ERROR(
                     Text000,
                     Status,TABLECAPTION,"Operation No.",CapLedgEntry.TABLECAPTION);
               END;

               IF SubcontractPurchOrderExist THEN
                 ERROR(
                   Text000,
                   Status,TABLECAPTION,"Operation No.",PurchLine.TABLECAPTION);

               DeleteRelations;

               UpdateComponentsBin(2); // from trigger = delete
             END;

    OnRename=BEGIN
               ERROR(Text001,TABLECAPTION);
             END;

    CaptionML=[ENU=Prod. Order Routing Line;
               NOR=Prod.ordrerutelinje];
    LookupPageID=Page99000817;
    DrillDownPageID=Page99000817;
  }
  FIELDS
  {
    { 1   ;   ;Routing No.         ;Code20        ;TableRelation="Routing Header";
                                                   CaptionML=[ENU=Routing No.;
                                                              NOR=Rutenr.] }
    { 3   ;   ;Routing Reference No.;Integer      ;CaptionML=[ENU=Routing Reference No.;
                                                              NOR=Rutereferansenr.];
                                                   Editable=No }
    { 4   ;   ;Operation No.       ;Code10        ;OnValidate=BEGIN
                                                                SetRecalcStatus;

                                                                GetLine;
                                                                "Starting Time" := ProdOrderLine."Starting Time";
                                                                "Ending Time" := ProdOrderLine."Ending Time";
                                                                "Starting Date" := ProdOrderLine."Starting Date";
                                                                "Ending Date" := ProdOrderLine."Ending Date";
                                                              END;

                                                   CaptionML=[ENU=Operation No.;
                                                              NOR=Operasjonsnr.];
                                                   NotBlank=Yes }
    { 5   ;   ;Next Operation No.  ;Code30        ;OnValidate=BEGIN
                                                                SetRecalcStatus;
                                                                GetLine;
                                                              END;

                                                   CaptionML=[ENU=Next Operation No.;
                                                              NOR=Neste operasjonsnr.] }
    { 6   ;   ;Previous Operation No.;Code30      ;OnValidate=BEGIN
                                                                SetRecalcStatus;
                                                              END;

                                                   CaptionML=[ENU=Previous Operation No.;
                                                              NOR=Forrige operasjonsnr.] }
    { 7   ;   ;Type                ;Option        ;OnValidate=BEGIN
                                                                SetRecalcStatus;

                                                                "No." := '';
                                                                "Work Center No." := '';
                                                                "Work Center Group Code" := '';

                                                                ModifyCapNeedEntries;
                                                              END;

                                                   CaptionML=[ENU=Type;
                                                              NOR=Type];
                                                   OptionCaptionML=[ENU=Work Center,Machine Center;
                                                                    NOR=Arbeidssenter,Maskinsenter];
                                                   OptionString=Work Center,Machine Center }
    { 8   ;   ;No.                 ;Code20        ;TableRelation=IF (Type=CONST(Work Center)) "Work Center"
                                                                 ELSE IF (Type=CONST(Machine Center)) "Machine Center";
                                                   OnValidate=BEGIN
                                                                IF ("No." <> xRec."No.") AND (xRec."No." <> '') THEN
                                                                  IF SubcontractPurchOrderExist THEN
                                                                    ERROR(
                                                                      Text007,
                                                                      FIELDCAPTION("No."),PurchLine.TABLECAPTION,Status,TABLECAPTION,"Operation No.");

                                                                SetRecalcStatus;

                                                                IF "No." = '' THEN
                                                                  EXIT;

                                                                CASE Type OF
                                                                  Type::"Work Center":
                                                                    BEGIN
                                                                      WorkCenter.GET("No.");
                                                                      WorkCenter.TESTFIELD(Blocked,FALSE);
                                                                      WorkCenterTransferfields;
                                                                    END;
                                                                  Type::"Machine Center":
                                                                    BEGIN
                                                                      MachineCenter.GET("No.");
                                                                      MachineCenter.TESTFIELD(Blocked,FALSE);
                                                                      MachineCtrTransferfields;
                                                                    END;
                                                                END;
                                                                ModifyCapNeedEntries;

                                                                GetLine;
                                                                IF ProdOrderLine."Routing Type" = ProdOrderLine."Routing Type"::Serial THEN
                                                                  CalcStartingEndingDates(Direction::Forward);
                                                              END;

                                                   CaptionML=[ENU=No.;
                                                              NOR=Nr.] }
    { 9   ;   ;Work Center No.     ;Code20        ;TableRelation="Work Center";
                                                   CaptionML=[ENU=Work Center No.;
                                                              NOR=Arbeidssenternr.];
                                                   Editable=No }
    { 10  ;   ;Work Center Group Code;Code10      ;TableRelation="Work Center Group";
                                                   CaptionML=[ENU=Work Center Group Code;
                                                              NOR=Arbeidssentergruppekode];
                                                   Editable=No }
    { 11  ;   ;Description         ;Text50        ;CaptionML=[ENU=Description;
                                                              NOR=Beskrivelse] }
    { 12  ;   ;Setup Time          ;Decimal       ;OnValidate=BEGIN
                                                                CalcStartingEndingDates(Direction::Forward);
                                                              END;

                                                   CaptionML=[ENU=Setup Time;
                                                              NOR=Oppstillingstid];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
    { 13  ;   ;Run Time            ;Decimal       ;OnValidate=BEGIN
                                                                CalcStartingEndingDates(Direction::Forward);
                                                              END;

                                                   CaptionML=[ENU=Run Time;
                                                              NOR=Operasjonstid];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
    { 14  ;   ;Wait Time           ;Decimal       ;OnValidate=BEGIN
                                                                CalcStartingEndingDates(Direction::Forward);
                                                              END;

                                                   CaptionML=[ENU=Wait Time;
                                                              NOR=Ventetid];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
    { 15  ;   ;Move Time           ;Decimal       ;OnValidate=BEGIN
                                                                CalcStartingEndingDates(Direction::Forward);
                                                              END;

                                                   CaptionML=[ENU=Move Time;
                                                              NOR=Transporttid];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
    { 16  ;   ;Fixed Scrap Quantity;Decimal       ;OnValidate=BEGIN
                                                                SetRecalcStatus;
                                                              END;

                                                   CaptionML=[ENU=Fixed Scrap Quantity;
                                                              NOR=Fast vrakantall];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
    { 17  ;   ;Lot Size            ;Decimal       ;CaptionML=[ENU=Lot Size;
                                                              NOR=Partist›rrelse];
                                                   DecimalPlaces=0:5 }
    { 18  ;   ;Scrap Factor %      ;Decimal       ;OnValidate=BEGIN
                                                                SetRecalcStatus;
                                                              END;

                                                   CaptionML=[ENU=Scrap Factor %;
                                                              NOR=Vrakfaktor-%];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
    { 19  ;   ;Setup Time Unit of Meas. Code;Code10;
                                                   TableRelation="Capacity Unit of Measure";
                                                   OnValidate=BEGIN
                                                                CalcStartingEndingDates(Direction::Forward);
                                                              END;

                                                   CaptionML=[ENU=Setup Time Unit of Meas. Code;
                                                              NOR=Oppstillingstid - enhetskode] }
    { 20  ;   ;Run Time Unit of Meas. Code;Code10 ;TableRelation="Capacity Unit of Measure";
                                                   OnValidate=BEGIN
                                                                CalcStartingEndingDates(Direction::Forward);
                                                              END;

                                                   CaptionML=[ENU=Run Time Unit of Meas. Code;
                                                              NOR=Operasjonstid - enhetskode] }
    { 21  ;   ;Wait Time Unit of Meas. Code;Code10;TableRelation="Capacity Unit of Measure";
                                                   OnValidate=BEGIN
                                                                CalcStartingEndingDates(Direction::Forward);
                                                              END;

                                                   CaptionML=[ENU=Wait Time Unit of Meas. Code;
                                                              NOR=Ventetid - enhetskode] }
    { 22  ;   ;Move Time Unit of Meas. Code;Code10;TableRelation="Capacity Unit of Measure";
                                                   OnValidate=BEGIN
                                                                CalcStartingEndingDates(Direction::Forward);
                                                              END;

                                                   CaptionML=[ENU=Move Time Unit of Meas. Code;
                                                              NOR=Transporttid - enhetskode] }
    { 27  ;   ;Minimum Process Time;Decimal       ;CaptionML=[ENU=Minimum Process Time;
                                                              NOR=Minimum behandlingstid];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
    { 28  ;   ;Maximum Process Time;Decimal       ;CaptionML=[ENU=Maximum Process Time;
                                                              NOR=Maksimal behandlingstid];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
    { 30  ;   ;Concurrent Capacities;Decimal      ;InitValue=1;
                                                   OnValidate=BEGIN
                                                                CalcStartingEndingDates(Direction::Forward);
                                                              END;

                                                   CaptionML=[ENU=Concurrent Capacities;
                                                              NOR=Samtidige kapasiteter];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
    { 31  ;   ;Send-Ahead Quantity ;Decimal       ;OnValidate=BEGIN
                                                                CalcStartingEndingDates(Direction::Forward);
                                                              END;

                                                   CaptionML=[ENU=Send-Ahead Quantity;
                                                              NOR=Overlappantall];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
    { 34  ;   ;Routing Link Code   ;Code10        ;TableRelation="Routing Link";
                                                   CaptionML=[ENU=Routing Link Code;
                                                              NOR=Rutekoblingskode];
                                                   Editable=No }
    { 35  ;   ;Standard Task Code  ;Code10        ;TableRelation="Standard Task";
                                                   OnValidate=VAR
                                                                StandardTask@1000 : Record 99000778;
                                                                StdTaskTool@1001 : Record 99000781;
                                                                StdTaskPersonnel@1002 : Record 99000782;
                                                                StdTaskQltyMeasure@1003 : Record 99000784;
                                                                StdTaskComment@1004 : Record 99000783;
                                                              BEGIN
                                                                IF "Standard Task Code" = '' THEN
                                                                  EXIT;

                                                                StandardTask.GET("Standard Task Code");
                                                                Description := StandardTask.Description;

                                                                DeleteRelations;

                                                                StdTaskTool.SETRANGE("Standard Task Code","Standard Task Code");
                                                                IF StdTaskTool.FIND('-') THEN
                                                                  REPEAT
                                                                    ProdOrderRoutTool.Status := Status;
                                                                    ProdOrderRoutTool."Prod. Order No." := "Prod. Order No.";
                                                                    ProdOrderRoutTool."Routing Reference No." := "Routing Reference No.";
                                                                    ProdOrderRoutTool."Routing No." := "Routing No.";
                                                                    ProdOrderRoutTool."Operation No." := "Operation No.";
                                                                    ProdOrderRoutTool."Line No." := StdTaskTool."Line No.";
                                                                    ProdOrderRoutTool."No." := StdTaskTool."No.";
                                                                    ProdOrderRoutTool.Description := StdTaskTool.Description;
                                                                    ProdOrderRoutTool.INSERT;
                                                                  UNTIL StdTaskTool.NEXT = 0;

                                                                StdTaskPersonnel.SETRANGE("Standard Task Code","Standard Task Code");
                                                                IF StdTaskPersonnel.FIND('-') THEN
                                                                  REPEAT
                                                                    ProdOrderRtngPersonnel.Status := Status;
                                                                    ProdOrderRtngPersonnel."Prod. Order No." := "Prod. Order No.";
                                                                    ProdOrderRtngPersonnel."Routing Reference No." := "Routing Reference No.";
                                                                    ProdOrderRtngPersonnel."Routing No." := "Routing No.";
                                                                    ProdOrderRtngPersonnel."Operation No." := "Operation No.";
                                                                    ProdOrderRtngPersonnel."Line No." := StdTaskPersonnel."Line No.";
                                                                    ProdOrderRtngPersonnel."No." := StdTaskPersonnel."No.";
                                                                    ProdOrderRtngPersonnel.Description := StdTaskPersonnel.Description;
                                                                    ProdOrderRtngPersonnel.INSERT;
                                                                  UNTIL StdTaskPersonnel.NEXT = 0;

                                                                StdTaskQltyMeasure.SETRANGE("Standard Task Code","Standard Task Code");
                                                                IF StdTaskQltyMeasure.FIND('-') THEN
                                                                  REPEAT
                                                                    ProdOrderRtngQltyMeas.Status := Status;
                                                                    ProdOrderRtngQltyMeas."Prod. Order No." := "Prod. Order No.";
                                                                    ProdOrderRtngQltyMeas."Routing Reference No." := "Routing Reference No.";
                                                                    ProdOrderRtngQltyMeas."Routing No." := "Routing No.";
                                                                    ProdOrderRtngQltyMeas."Operation No." := "Operation No.";
                                                                    ProdOrderRtngQltyMeas."Line No." := StdTaskQltyMeasure."Line No.";
                                                                    ProdOrderRtngQltyMeas."Qlty Measure Code" := StdTaskQltyMeasure."Qlty Measure Code";
                                                                    ProdOrderRtngQltyMeas.Description := StdTaskQltyMeasure.Description;
                                                                    ProdOrderRtngQltyMeas."Min. Value" := StdTaskQltyMeasure."Min. Value";
                                                                    ProdOrderRtngQltyMeas."Max. Value" := StdTaskQltyMeasure."Max. Value";
                                                                    ProdOrderRtngQltyMeas."Mean Tolerance" := StdTaskQltyMeasure."Mean Tolerance";
                                                                    ProdOrderRtngQltyMeas.INSERT;
                                                                  UNTIL StdTaskQltyMeasure.NEXT = 0;

                                                                StdTaskComment.SETRANGE("Standard Task Code","Standard Task Code");
                                                                IF StdTaskComment.FIND('-') THEN
                                                                  REPEAT
                                                                    ProdOrderRtngComment.Status := Status;
                                                                    ProdOrderRtngComment."Prod. Order No." := "Prod. Order No.";
                                                                    ProdOrderRtngComment."Routing Reference No." := "Routing Reference No.";
                                                                    ProdOrderRtngComment."Routing No." := "Routing No.";
                                                                    ProdOrderRtngComment."Operation No." := "Operation No.";
                                                                    ProdOrderRtngComment."Line No." := StdTaskComment."Line No.";
                                                                    ProdOrderRtngComment.Comment := StdTaskComment.Text;
                                                                    ProdOrderRtngComment.INSERT;
                                                                  UNTIL StdTaskComment.NEXT = 0;
                                                              END;

                                                   CaptionML=[ENU=Standard Task Code;
                                                              NOR=Standardoppgavekode] }
    { 40  ;   ;Unit Cost per       ;Decimal       ;OnValidate=BEGIN
                                                                GLSetup.GET;
                                                                "Direct Unit Cost" :=
                                                                  ROUND(
                                                                    ("Unit Cost per" - "Overhead Rate") /
                                                                    (1 + "Indirect Cost %" / 100),
                                                                    GLSetup."Unit-Amount Rounding Precision");

                                                                CalcStartingEndingDates(Direction::Forward);
                                                              END;

                                                   CaptionML=[ENU=Unit Cost per;
                                                              NOR=Enhetskost per];
                                                   MinValue=0;
                                                   AutoFormatType=2 }
    { 41  ;   ;Recalculate         ;Boolean       ;CaptionML=[ENU=Recalculate;
                                                              NOR=Beregn p† nytt] }
    { 50  ;   ;Sequence No. (Forward);Integer     ;CaptionML=[ENU=Sequence No. (Forward);
                                                              NOR=Rekkef›lgenr. (fremover)];
                                                   Editable=No }
    { 51  ;   ;Sequence No. (Backward);Integer    ;CaptionML=[ENU=Sequence No. (Backward);
                                                              NOR=Rekkef›lgenr. (bakover)];
                                                   Editable=No }
    { 52  ;   ;Fixed Scrap Qty. (Accum.);Decimal  ;CaptionML=[ENU=Fixed Scrap Qty. (Accum.);
                                                              NOR=Fast vrakantall (akkum.)];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 53  ;   ;Scrap Factor % (Accumulated);Decimal;
                                                   CaptionML=[ENU=Scrap Factor % (Accumulated);
                                                              NOR=Vrakfaktor-% (akkumulert)];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 55  ;   ;Sequence No. (Actual);Integer      ;CaptionML=[ENU=Sequence No. (Actual);
                                                              NOR=Rekkef›lgenr. (faktisk)];
                                                   Editable=No }
    { 56  ;   ;Direct Unit Cost    ;Decimal       ;OnValidate=BEGIN
                                                                VALIDATE("Indirect Cost %");
                                                              END;

                                                   CaptionML=[ENU=Direct Unit Cost;
                                                              NOR=Direkte enhetskost];
                                                   DecimalPlaces=2:5 }
    { 57  ;   ;Indirect Cost %     ;Decimal       ;OnValidate=BEGIN
                                                                GLSetup.GET;
                                                                "Unit Cost per" :=
                                                                  ROUND(
                                                                    "Direct Unit Cost" * (1 + "Indirect Cost %" / 100) + "Overhead Rate",
                                                                    GLSetup."Unit-Amount Rounding Precision");
                                                              END;

                                                   CaptionML=[ENU=Indirect Cost %;
                                                              NOR=Indirekte kost-%];
                                                   DecimalPlaces=0:5 }
    { 58  ;   ;Overhead Rate       ;Decimal       ;OnValidate=BEGIN
                                                                VALIDATE("Indirect Cost %");
                                                              END;

                                                   CaptionML=[ENU=Overhead Rate;
                                                              NOR=Sats for indirekte kostnader];
                                                   DecimalPlaces=0:5 }
    { 70  ;   ;Starting Time       ;Time          ;OnValidate=BEGIN
                                                                CalcStartingEndingDates(Direction::Forward);
                                                              END;

                                                   CaptionML=[ENU=Starting Time;
                                                              NOR=Starttidspunkt] }
    { 71  ;   ;Starting Date       ;Date          ;OnValidate=BEGIN
                                                                VALIDATE("Starting Time");
                                                              END;

                                                   CaptionML=[ENU=Starting Date;
                                                              NOR=Startdato] }
    { 72  ;   ;Ending Time         ;Time          ;OnValidate=BEGIN
                                                                CalcStartingEndingDates(Direction::Backward);
                                                              END;

                                                   CaptionML=[ENU=Ending Time;
                                                              NOR=Sluttidspunkt] }
    { 73  ;   ;Ending Date         ;Date          ;OnValidate=BEGIN
                                                                VALIDATE("Ending Time");
                                                              END;

                                                   CaptionML=[ENU=Ending Date;
                                                              NOR=Sluttdato] }
    { 74  ;   ;Status              ;Option        ;CaptionML=[ENU=Status;
                                                              NOR=Status];
                                                   OptionCaptionML=[ENU=Simulated,Planned,Firm Planned,Released,Finished;
                                                                    NOR=Simulert,Planlagt,Fast planlagt,Frigitt,Ferdig];
                                                   OptionString=Simulated,Planned,Firm Planned,Released,Finished }
    { 75  ;   ;Prod. Order No.     ;Code20        ;TableRelation="Production Order".No. WHERE (Status=FIELD(Status));
                                                   CaptionML=[ENU=Prod. Order No.;
                                                              NOR=Prod.ordrenr.];
                                                   NotBlank=Yes;
                                                   Editable=No }
    { 76  ;   ;Unit Cost Calculation;Option       ;CaptionML=[ENU=Unit Cost Calculation;
                                                              NOR=Beregning av enhetskost];
                                                   OptionCaptionML=[ENU=Time,Units;
                                                                    NOR=Tid,Enheter];
                                                   OptionString=Time,Units }
    { 77  ;   ;Input Quantity      ;Decimal       ;CaptionML=[ENU=Input Quantity;
                                                              NOR=Tilgangsantall];
                                                   DecimalPlaces=0:5 }
    { 78  ;   ;Critical Path       ;Boolean       ;CaptionML=[ENU=Critical Path;
                                                              NOR=Kritisk bane];
                                                   Editable=No }
    { 79  ;   ;Routing Status      ;Option        ;OnValidate=VAR
                                                                ProdOrderCapacityNeed@1000 : Record 5410;
                                                              BEGIN
                                                                IF (xRec."Routing Status" = xRec."Routing Status"::Finished) AND (xRec."Routing Status" <> "Routing Status") THEN
                                                                  ERROR(Text008,FIELDCAPTION("Routing Status"),xRec."Routing Status","Routing Status");

                                                                IF ("Routing Status" = "Routing Status"::Finished) AND (xRec."Routing Status" <> "Routing Status") THEN BEGIN
                                                                  IF NOT CONFIRM(Text009,FALSE,FIELDCAPTION("Routing Status"),"Routing Status") THEN
                                                                    ERROR('');

                                                                  ProdOrderCapacityNeed.SETCURRENTKEY(
                                                                    Status,"Prod. Order No.","Requested Only","Routing No.","Routing Reference No.","Operation No.","Line No.");
                                                                  ProdOrderCapacityNeed.SETRANGE(Status,Status);
                                                                  ProdOrderCapacityNeed.SETRANGE("Prod. Order No.","Prod. Order No.");
                                                                  ProdOrderCapacityNeed.SETRANGE("Requested Only",FALSE);
                                                                  ProdOrderCapacityNeed.SETRANGE("Routing No.","Routing No.");
                                                                  ProdOrderCapacityNeed.SETRANGE("Routing Reference No.","Routing Reference No.");
                                                                  ProdOrderCapacityNeed.SETRANGE("Operation No.","Operation No.");
                                                                  ProdOrderCapacityNeed.MODIFYALL("Allocated Time",0);
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Routing Status;
                                                              NOR=Rutestatus];
                                                   OptionCaptionML=[ENU=" ,Planned,In Progress,Finished";
                                                                    NOR=" ,Planlagt,I arbeid,Ferdig"];
                                                   OptionString=[ ,Planned,In Progress,Finished] }
    { 81  ;   ;Flushing Method     ;Option        ;InitValue=Manual;
                                                   CaptionML=[ENU=Flushing Method;
                                                              NOR=Trekkmetode];
                                                   OptionCaptionML=[ENU=Manual,Forward,Backward;
                                                                    NOR=Manuell,Forlengs,Baklengs];
                                                   OptionString=Manual,Forward,Backward }
    { 90  ;   ;Expected Operation Cost Amt.;Decimal;
                                                   CaptionML=[ENU=Expected Operation Cost Amt.;
                                                              NOR=Forventet operasjonskostbel›p];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 91  ;   ;Expected Capacity Need;Decimal     ;FieldClass=Normal;
                                                   CaptionML=[ENU=Expected Capacity Need;
                                                              NOR=Forventet kapasitetsbehov];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 96  ;   ;Expected Capacity Ovhd. Cost;Decimal;
                                                   CaptionML=[ENU=Expected Capacity Ovhd. Cost;
                                                              NOR=Forventet indir. kap.kostn.];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 98  ;   ;Starting Date-Time  ;DateTime      ;OnValidate=BEGIN
                                                                "Starting Date" := DT2DATE("Starting Date-Time");
                                                                "Starting Time" := DT2TIME("Starting Date-Time");
                                                                VALIDATE("Starting Time");
                                                              END;

                                                   CaptionML=[ENU=Starting Date-Time;
                                                              NOR=Startdato-tidsp.] }
    { 99  ;   ;Ending Date-Time    ;DateTime      ;OnValidate=BEGIN
                                                                "Ending Date" := DT2DATE("Ending Date-Time");
                                                                "Ending Time" := DT2TIME("Ending Date-Time");
                                                                VALIDATE("Ending Time");
                                                              END;

                                                   CaptionML=[ENU=Ending Date-Time;
                                                              NOR=Sluttdato-tidsp.] }
    { 100 ;   ;Schedule Manually   ;Boolean       ;CaptionML=[ENU=Schedule Manually;
                                                              NOR=Tidsplanlegg manuelt] }
    { 101 ;   ;Location Code       ;Code10        ;AccessByPermission=TableData 14=R;
                                                   CaptionML=[ENU=Location Code;
                                                              NOR=Lokasjonskode];
                                                   Editable=No }
    { 7301;   ;Open Shop Floor Bin Code;Code20    ;AccessByPermission=TableData 5771=R;
                                                   CaptionML=[ENU=Open Shop Floor Bin Code;
                                                              NOR=pen prod.hyllekode];
                                                   Editable=No }
    { 7302;   ;To-Production Bin Code;Code20      ;AccessByPermission=TableData 5771=R;
                                                   CaptionML=[ENU=To-Production Bin Code;
                                                              NOR=Til-Hyllekode for produksjon];
                                                   Editable=No }
    { 7303;   ;From-Production Bin Code;Code20    ;AccessByPermission=TableData 5771=R;
                                                   CaptionML=[ENU=From-Production Bin Code;
                                                              NOR=Fra-Hyllekode for produksjon];
                                                   Editable=No }
    { 83300;  ;Finished Qty        ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Capacity Ledger Entry"."Output Quantity" WHERE (Order Type=CONST(Production),
                                                                                                                    Order No.=FIELD(Prod. Order No.),
                                                                                                                    Operation No.=FIELD(Operation No.)));
                                                   CaptionML=NOR=Ferdig Antall;
                                                   Description=OPC }
    { 83301;  ;Dokument Link       ;Text80        ;CaptionML=NOR=Tilknyttet dokument;
                                                   Description=OPC }
    { 83302;  ;Actual Run Time     ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Capacity Ledger Entry"."Run Time" WHERE (Order Type=CONST(Production),
                                                                                                             Order No.=FIELD(Prod. Order No.),
                                                                                                             Operation No.=FIELD(Operation No.)));
                                                   CaptionML=NOR=Forbrukt tid;
                                                   Description=OPC }
    { 83303;  ;Actual Direct Cost  ;Decimal       ;CaptionML=[ENU=Actual Direct Cost;
                                                              NOR=Faktisk Direkte Kost];
                                                   Description=OPC }
    { 83304;  ;Actual Indirect Cost;Decimal       ;CaptionML=[ENU=Actual Indirect Cost;
                                                              NOR=Faktisk Indirekte Kost];
                                                   Description=OPC }
  }
  KEYS
  {
    {    ;Status,Prod. Order No.,Routing Reference No.,Routing No.,Operation No.;
                                                   SumIndexFields=Expected Operation Cost Amt.,Expected Capacity Need,Expected Capacity Ovhd. Cost;
                                                   Clustered=Yes }
    {    ;Prod. Order No.,Routing Reference No.,Status,Routing No.,Operation No.;
                                                   MaintainSIFTIndex=No }
    {    ;Status,Prod. Order No.,Routing Reference No.,Routing No.,Sequence No. (Forward) }
    {    ;Status,Prod. Order No.,Routing Reference No.,Routing No.,Sequence No. (Backward) }
    {    ;Status,Prod. Order No.,Routing Reference No.,Routing No.,Sequence No. (Actual) }
    {    ;Work Center No.                         ;SumIndexFields=Expected Operation Cost Amt.;
                                                   MaintainSIFTIndex=No }
    {    ;Type,No.,Starting Date                  ;SumIndexFields=Expected Operation Cost Amt.;
                                                   MaintainSIFTIndex=No }
    {    ;Status,Work Center No.                   }
    {    ;Prod. Order No.,Status,Flushing Method   }
    {    ;Starting Date,Starting Time             ;MaintainSQLIndex=No;
                                                   MaintainSIFTIndex=No }
    {    ;Ending Date,Ending Time                 ;MaintainSQLIndex=No;
                                                   MaintainSIFTIndex=No }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      Text000@1000 : TextConst '@@@="%1 = Document status; %2 = Table Caption; %3 = Field Value; %4 = Table Caption";ENU=You cannot delete %1 %2 %3 because there is at least one %4 associated with it.;NOR=Du kan ikke slette %1 %2 %3 fordi det finnes minst ‚n %4 tilknyttet.';
      Text001@1001 : TextConst 'ENU=You cannot rename a %1.;NOR=Du kan ikke gi nytt navn til en %1.';
      Text002@1002 : TextConst 'ENU=This routing line cannot be moved because of critical work centers in previous operations;NOR=Denne rutelinjen kan ikke flyttes p† grunn av kritiske arbeidssentre i tidligere operasjoner';
      Text003@1003 : TextConst 'ENU=This routing line cannot be moved because of critical work centers in next operations;NOR=Denne rutelinjen kan ikke flyttes p† grunn av kritiske arbeidssentre i kommende operasjoner';
      WorkCenter@1006 : Record 99000754;
      MachineCenter@1007 : Record 99000758;
      ProdOrderLine@1008 : Record 5406;
      ProdOrderRtngLine@1009 : Record 5409;
      ProdOrderRoutTool@1010 : Record 5411;
      ProdOrderRtngPersonnel@1011 : Record 5412;
      ProdOrderRtngQltyMeas@1012 : Record 5413;
      ProdOrderRtngComment@1013 : Record 5415;
      GLSetup@1005 : Record 98;
      ProdOrderCapNeed@1014 : Record 5410;
      PurchLine@1021 : Record 39;
      CalcProdOrder@1015 : Codeunit 99000773;
      ProdOrderRouteMgt@1016 : Codeunit 99000772;
      Text004@1019 : TextConst 'ENU=Some routing lines are referring to the operation just deleted. The references are\in the fields %1 and %2.\\This may have to be corrected as a routing line referring to a non-existent\operation will lead to serious errors in capacity planning.\\Do you want to see a list of the lines in question?\(Access the columns Next Operation No. and Previous Operation No.);NOR=Noen av rutelinjene viser til operasjonen som nettopp ble slettet. Henvisningene finnes\i feltene %1 og %2.\\Det kan v‘re at dette m† korrigeres fordi en rutelinje som viser til en ikke-eksisterende\operasjon kan medf›re alvorlige feil i kapasitetsplanleggingen.\\Vil du se en oversikt over de aktuelle linjene?\(Se i kolonnene Neste operasjonsnr. og Forrige operasjonsnr.)';
      Text005@1004 : TextConst 'ENU=Routing Lines referring to deleted Operation No. %1;NOR=Rutelinjene viser til slettet operasjonsnr. %1';
      Text006@1020 : TextConst 'ENU=A %1 %2 can not be inserted, modified, or deleted.;NOR=Det kan ikke settes inn, endres eller slettes noen %1 %2.';
      Direction@1018 : 'Forward,Backward';
      Text007@1022 : TextConst 'ENU=You cannot change %1, because there is at least one %2 associated with %3 %4 %5.;NOR=Du kan ikke endre %1 fordi det er minst ‚n %2 tilknyttet %3 %4 %5.';
      Text008@1023 : TextConst 'ENU=You cannot change the %1 from %2 to %3.;NOR=Du kan ikke endre %1 fra %2 til %3.';
      Text009@1024 : TextConst 'ENU=If you change the %1 to %2, then all related allocated capacity will be deleted, and you will not be able to change the %1 of the operation again.\\Are you sure that you want to continue?;NOR=Hvis du endrer %1 til %2, slettes all relatert tildelt kapasitet, og du kan ikke endre %1 for operasjonen p† nytt.\\Er du sikker p† at du vil fortsette?';
      SkipUpdateOfCompBinCodes@1017 : Boolean;

    PROCEDURE Caption@12() : Text[100];
    VAR
      ProdOrder@1000 : Record 5405;
    BEGIN
      IF GETFILTERS = '' THEN
        EXIT('');

      IF NOT ProdOrder.GET(Status,"Prod. Order No.") THEN
        EXIT('');

      EXIT(
        STRSUBSTNO('%1 %2 %3',
          "Prod. Order No.",ProdOrder.Description,"Routing No."));
    END;

    LOCAL PROCEDURE GetLine@15();
    BEGIN
      ProdOrderLine.SETRANGE(Status,Status);
      ProdOrderLine.SETRANGE("Prod. Order No.","Prod. Order No.");
      ProdOrderLine.SETRANGE("Routing No.","Routing No.");
      ProdOrderLine.SETRANGE("Routing Reference No.","Routing Reference No.");
      ProdOrderLine.FIND('-');
    END;

    LOCAL PROCEDURE DeleteRelations@3();
    BEGIN
      ProdOrderRoutTool.SETRANGE(Status,Status);
      ProdOrderRoutTool.SETRANGE("Prod. Order No.","Prod. Order No.");
      ProdOrderRoutTool.SETRANGE("Routing Reference No.","Routing Reference No.");
      ProdOrderRoutTool.SETRANGE("Routing No.","Routing No.");
      ProdOrderRoutTool.SETRANGE("Operation No.","Operation No.");
      ProdOrderRoutTool.DELETEALL;

      ProdOrderRtngPersonnel.SETRANGE(Status,Status);
      ProdOrderRtngPersonnel.SETRANGE("Prod. Order No.","Prod. Order No.");
      ProdOrderRtngPersonnel.SETRANGE("Routing Reference No.","Routing Reference No.");
      ProdOrderRtngPersonnel.SETRANGE("Routing No.","Routing No.");
      ProdOrderRtngPersonnel.SETRANGE("Operation No.","Operation No.");
      ProdOrderRtngPersonnel.DELETEALL;

      ProdOrderRtngQltyMeas.SETRANGE(Status,Status);
      ProdOrderRtngQltyMeas.SETRANGE("Prod. Order No.","Prod. Order No.");
      ProdOrderRtngQltyMeas.SETRANGE("Routing Reference No.","Routing Reference No.");
      ProdOrderRtngQltyMeas.SETRANGE("Routing No.","Routing No.");
      ProdOrderRtngQltyMeas.SETRANGE("Operation No.","Operation No.");
      ProdOrderRtngQltyMeas.DELETEALL;

      ProdOrderRtngComment.SETRANGE(Status,Status);
      ProdOrderRtngComment.SETRANGE("Prod. Order No.","Prod. Order No.");
      ProdOrderRtngComment.SETRANGE("Routing Reference No.","Routing Reference No.");
      ProdOrderRtngComment.SETRANGE("Routing No.","Routing No.");
      ProdOrderRtngComment.SETRANGE("Operation No.","Operation No.");
      ProdOrderRtngComment.DELETEALL;

      ProdOrderCapNeed.SETRANGE(Status,Status);
      ProdOrderCapNeed.SETRANGE("Prod. Order No.","Prod. Order No.");
      ProdOrderCapNeed.SETRANGE("Routing No.","Routing No.");
      ProdOrderCapNeed.SETRANGE("Routing Reference No.","Routing Reference No.");
      ProdOrderCapNeed.SETRANGE("Operation No.","Operation No.");
      ProdOrderCapNeed.DELETEALL;
    END;

    LOCAL PROCEDURE WorkCenterTransferfields@2();
    BEGIN
      "Work Center No." := WorkCenter."No.";
      "Work Center Group Code" := WorkCenter."Work Center Group Code";
      "Setup Time Unit of Meas. Code" := WorkCenter."Unit of Measure Code";
      "Run Time Unit of Meas. Code" := WorkCenter."Unit of Measure Code";
      "Wait Time Unit of Meas. Code" := WorkCenter."Unit of Measure Code";
      "Move Time Unit of Meas. Code" := WorkCenter."Unit of Measure Code";
      Description := WorkCenter.Name;
      "Flushing Method" := WorkCenter."Flushing Method";
      "Unit Cost per" := WorkCenter."Unit Cost";
      "Direct Unit Cost" := WorkCenter."Direct Unit Cost";
      "Indirect Cost %" := WorkCenter."Indirect Cost %";
      "Overhead Rate" := WorkCenter."Overhead Rate";
      "Unit Cost Calculation" := WorkCenter."Unit Cost Calculation";
      FillDefaultLocationAndBins;
    END;

    LOCAL PROCEDURE MachineCtrTransferfields@1();
    BEGIN
      WorkCenter.GET(MachineCenter."Work Center No.");
      WorkCenterTransferfields;

      Description := MachineCenter.Name;
      "Setup Time" := MachineCenter."Setup Time";
      "Wait Time" := MachineCenter."Wait Time";
      "Move Time" := MachineCenter."Move Time";
      "Fixed Scrap Quantity" := MachineCenter."Fixed Scrap Quantity";
      "Scrap Factor %" := MachineCenter."Scrap %";
      "Minimum Process Time" := MachineCenter."Minimum Process Time";
      "Maximum Process Time" := MachineCenter."Maximum Process Time";
      "Concurrent Capacities" := MachineCenter."Concurrent Capacities";
      IF "Concurrent Capacities" = 0 THEN
        "Concurrent Capacities" := 1;
      "Send-Ahead Quantity" := MachineCenter."Send-Ahead Quantity";
      "Setup Time Unit of Meas. Code" := MachineCenter."Setup Time Unit of Meas. Code";
      "Wait Time Unit of Meas. Code" := MachineCenter."Wait Time Unit of Meas. Code";
      "Move Time Unit of Meas. Code" := MachineCenter."Move Time Unit of Meas. Code";
      "Flushing Method" := MachineCenter."Flushing Method";
      "Unit Cost per" := MachineCenter."Unit Cost";
      "Direct Unit Cost" := MachineCenter."Direct Unit Cost";
      "Indirect Cost %" := MachineCenter."Indirect Cost %";
      "Overhead Rate" := MachineCenter."Overhead Rate";
      FillDefaultLocationAndBins;
    END;

    PROCEDURE FillDefaultLocationAndBins@8();
    BEGIN
      GetLine;
      "Location Code" := ProdOrderLine."Location Code";
      CASE Type OF
        Type::"Work Center":
          BEGIN
            IF WorkCenter."No." <> "No." THEN
              WorkCenter.GET("No.");
            IF WorkCenter."Location Code" = "Location Code" THEN BEGIN
              "Open Shop Floor Bin Code" := WorkCenter."Open Shop Floor Bin Code";
              "To-Production Bin Code" := WorkCenter."To-Production Bin Code";
              "From-Production Bin Code" := WorkCenter."From-Production Bin Code";
            END;
          END;
        Type::"Machine Center":
          BEGIN
            IF MachineCenter."No." <> "No." THEN
              MachineCenter.GET("No.");
            IF MachineCenter."Location Code" = "Location Code" THEN BEGIN
              "Open Shop Floor Bin Code" := MachineCenter."Open Shop Floor Bin Code";
              "To-Production Bin Code" := MachineCenter."To-Production Bin Code";
              "From-Production Bin Code" := MachineCenter."From-Production Bin Code";
            END;
            IF WorkCenter."No." <> MachineCenter."Work Center No." THEN
              WorkCenter.GET(MachineCenter."Work Center No.");
            IF WorkCenter."Location Code" = "Location Code" THEN BEGIN
              IF "Open Shop Floor Bin Code" = '' THEN
                "Open Shop Floor Bin Code" := WorkCenter."Open Shop Floor Bin Code";
              IF "To-Production Bin Code" = '' THEN
                "To-Production Bin Code" := WorkCenter."To-Production Bin Code";
              IF "From-Production Bin Code" = '' THEN
                "From-Production Bin Code" := WorkCenter."From-Production Bin Code";
            END;
          END;
      END;
    END;

    LOCAL PROCEDURE CalcStartingEndingDates@17(Direction1@1000 : 'Forward,Backward');
    VAR
      ReservationCheckDateConfl@1001 : Codeunit 99000815;
    BEGIN
      IF "Routing Status" = "Routing Status"::Finished THEN
        FIELDERROR("Routing Status");

      MODIFY(TRUE);

      ProdOrderRtngLine.GET(Status,"Prod. Order No.","Routing Reference No.","Routing No.","Operation No.");

      ProdOrderRouteMgt.CalcSequenceFromActual(ProdOrderRtngLine,Direction1);
      ProdOrderRtngLine.GET(Status,"Prod. Order No.","Routing Reference No.","Routing No.","Operation No.");
      ProdOrderRtngLine.SETCURRENTKEY(
        Status,"Prod. Order No.","Routing Reference No.","Routing No.","Sequence No. (Actual)");
      CalcProdOrder.CalculateRoutingFromActual(ProdOrderRtngLine,Direction1,FALSE);

      CalculateRoutingBack;
      CalculateRoutingForward;

      GET(Status,"Prod. Order No.","Routing Reference No.","Routing No.","Operation No.");
      GetLine;
      ReservationCheckDateConfl.ProdOrderLineCheck(ProdOrderLine,TRUE);
    END;

    PROCEDURE SetRecalcStatus@5();
    BEGIN
      Recalculate := TRUE;
    END;

    PROCEDURE RunTimePer@7() : Decimal;
    BEGIN
      IF "Lot Size" = 0 THEN
        "Lot Size" := 1;

      EXIT("Run Time" / "Lot Size");
    END;

    LOCAL PROCEDURE CalculateRoutingBack@10();
    VAR
      ProdOrderLine@1000 : Record 5406;
      ProdOrderRtngLine@1001 : Record 5409;
    BEGIN
      IF "Previous Operation No." <> '' THEN BEGIN
        ProdOrderRtngLine.SETRANGE(Status,Status);
        ProdOrderRtngLine.SETRANGE("Prod. Order No.","Prod. Order No.");
        ProdOrderRtngLine.SETRANGE("Routing Reference No.","Routing Reference No.");
        ProdOrderRtngLine.SETRANGE("Routing No.","Routing No.");
        ProdOrderRtngLine.SETFILTER("Operation No.","Previous Operation No.");
        ProdOrderRtngLine.SETFILTER("Routing Status",'<>%1',ProdOrderRtngLine."Routing Status"::Finished);

        IF ProdOrderRtngLine.FIND('-') THEN
          REPEAT
            ProdOrderRtngLine.SETCURRENTKEY(Status,"Prod. Order No.","Routing Reference No.",
              "Routing No.","Sequence No. (Actual)");
            WorkCenter.GET(ProdOrderRtngLine."Work Center No.");
            CASE WorkCenter."Simulation Type" OF
              WorkCenter."Simulation Type"::Moves:
                BEGIN
                  ProdOrderRouteMgt.CalcSequenceFromActual(ProdOrderRtngLine,Direction::Backward);
                  CalcProdOrder.CalculateRoutingFromActual(ProdOrderRtngLine,Direction::Backward,TRUE);
                END;
              WorkCenter."Simulation Type"::"Moves When Necessary":
                IF (ProdOrderRtngLine."Ending Date" > "Starting Date") OR
                   ((ProdOrderRtngLine."Ending Date" = "Starting Date") AND
                    (ProdOrderRtngLine."Ending Time" > "Starting Time"))
                THEN BEGIN
                  ProdOrderRouteMgt.CalcSequenceFromActual(ProdOrderRtngLine,Direction::Backward);
                  CalcProdOrder.CalculateRoutingFromActual(ProdOrderRtngLine,Direction::Backward,TRUE);
                END;
              WorkCenter."Simulation Type"::Critical:
                BEGIN
                  IF (ProdOrderRtngLine."Ending Date" > "Starting Date") OR
                     ((ProdOrderRtngLine."Ending Date" = "Starting Date") AND
                      (ProdOrderRtngLine."Ending Time" > "Starting Time"))
                  THEN
                    ERROR(Text002);
                END;
            END;
            ProdOrderRtngLine.SETCURRENTKEY(Status,"Prod. Order No.","Routing Reference No.",
              "Routing No.","Operation No.");
          UNTIL ProdOrderRtngLine.NEXT = 0;
      END;

      ProdOrderLine.SETRANGE(Status,Status);
      ProdOrderLine.SETRANGE("Prod. Order No.","Prod. Order No.");
      ProdOrderLine.SETRANGE("Routing Reference No.","Routing Reference No.");
      ProdOrderLine.SETRANGE("Routing No.","Routing No.");
      IF ProdOrderLine.FIND('-') THEN
        REPEAT
          CalcProdOrder.CalculateProdOrderDates(ProdOrderLine,TRUE);
          AdjustComponents(ProdOrderLine);
        UNTIL ProdOrderLine.NEXT = 0;
    END;

    LOCAL PROCEDURE CalculateRoutingForward@9();
    VAR
      ProdOrderLine@1000 : Record 5406;
      ProdOrderRtngLine@1001 : Record 5409;
    BEGIN
      IF "Next Operation No." <> '' THEN BEGIN
        ProdOrderRtngLine.SETRANGE(Status,Status);
        ProdOrderRtngLine.SETRANGE("Prod. Order No.","Prod. Order No.");
        ProdOrderRtngLine.SETRANGE("Routing Reference No.","Routing Reference No.");
        ProdOrderRtngLine.SETRANGE("Routing No.","Routing No.");
        ProdOrderRtngLine.SETFILTER("Operation No.","Next Operation No.");
        ProdOrderRtngLine.SETFILTER("Routing Status",'<>%1',ProdOrderRtngLine."Routing Status"::Finished);

        IF ProdOrderRtngLine.FIND('-') THEN
          REPEAT
            ProdOrderRtngLine.SETCURRENTKEY(Status,"Prod. Order No.","Routing Reference No.",
              "Routing No.","Sequence No. (Actual)");
            WorkCenter.GET(ProdOrderRtngLine."Work Center No.");
            CASE WorkCenter."Simulation Type" OF
              WorkCenter."Simulation Type"::Moves:
                BEGIN
                  ProdOrderRouteMgt.CalcSequenceFromActual(ProdOrderRtngLine,Direction::Forward);
                  CalcProdOrder.CalculateRoutingFromActual(ProdOrderRtngLine,Direction::Forward,TRUE);
                END;
              WorkCenter."Simulation Type"::"Moves When Necessary":
                IF (ProdOrderRtngLine."Starting Date" < "Ending Date") OR
                   ((ProdOrderRtngLine."Starting Date" = "Ending Date") AND
                    (ProdOrderRtngLine."Starting Time" < "Ending Time"))
                THEN BEGIN
                  ProdOrderRouteMgt.CalcSequenceFromActual(ProdOrderRtngLine,Direction::Forward);
                  CalcProdOrder.CalculateRoutingFromActual(ProdOrderRtngLine,Direction::Forward,TRUE);
                END;
              WorkCenter."Simulation Type"::Critical:
                BEGIN
                  IF (ProdOrderRtngLine."Starting Date" < "Ending Date") OR
                     ((ProdOrderRtngLine."Starting Date" = "Ending Date") AND
                      (ProdOrderRtngLine."Starting Time" < "Ending Time"))
                  THEN
                    ERROR(Text003);
                END;
            END;
            ProdOrderRtngLine.SETCURRENTKEY(Status,"Prod. Order No.","Routing Reference No.",
              "Routing No.","Operation No.");
          UNTIL ProdOrderRtngLine.NEXT = 0;
      END;

      ProdOrderLine.SETRANGE(Status,Status);
      ProdOrderLine.SETRANGE("Prod. Order No.","Prod. Order No.");
      ProdOrderLine.SETRANGE("Routing Reference No.","Routing Reference No.");
      ProdOrderLine.SETRANGE("Routing No.","Routing No.");
      IF ProdOrderLine.FIND('-') THEN
        REPEAT
          CalcProdOrder.CalculateProdOrderDates(ProdOrderLine,TRUE);
          AdjustComponents(ProdOrderLine);
        UNTIL ProdOrderLine.NEXT = 0;
      CalcProdOrder.CalculateComponents;
    END;

    LOCAL PROCEDURE ModifyCapNeedEntries@13();
    BEGIN
      ProdOrderCapNeed.SETRANGE(Status,Status);
      ProdOrderCapNeed.SETRANGE("Prod. Order No.","Prod. Order No.");
      ProdOrderCapNeed.SETRANGE("Routing Reference No.","Routing Reference No.");
      ProdOrderCapNeed.SETRANGE("Routing No.","Routing No.");
      ProdOrderCapNeed.SETRANGE("Operation No.","Operation No.");
      ProdOrderCapNeed.SETRANGE("Requested Only",FALSE);
      IF ProdOrderCapNeed.FIND('-') THEN
        REPEAT
          ProdOrderCapNeed."No." := "No.";
          ProdOrderCapNeed."Work Center No." := "Work Center No.";
          ProdOrderCapNeed."Work Center Group Code" := "Work Center Group Code";
          ProdOrderCapNeed.MODIFY;
        UNTIL ProdOrderCapNeed.NEXT = 0;
    END;

    LOCAL PROCEDURE AdjustComponents@14(VAR ProdOrderLine@1000 : Record 5406);
    VAR
      ProdOrderComp@1001 : Record 5407;
    BEGIN
      ProdOrderComp.SETRANGE(Status,Status);
      ProdOrderComp.SETRANGE("Prod. Order No.","Prod. Order No.");
      ProdOrderComp.SETRANGE("Prod. Order Line No.",ProdOrderLine."Line No.");

      IF ProdOrderComp.FIND('-') THEN
        REPEAT
          ProdOrderComp.VALIDATE("Routing Link Code");
          ProdOrderComp.MODIFY;
        UNTIL ProdOrderComp.NEXT = 0;
    END;

    PROCEDURE UpdateDatetime@11();
    BEGIN
      IF ("Starting Date" <> 0D) AND ("Starting Time" <> 0T) THEN
        "Starting Date-Time" := CREATEDATETIME("Starting Date","Starting Time")
      ELSE
        "Starting Date-Time" := 0DT;

      IF ("Ending Date" <> 0D) AND ("Ending Time" <> 0T) THEN
        "Ending Date-Time" := CREATEDATETIME("Ending Date","Ending Time")
      ELSE
        "Ending Date-Time" := 0DT;
    END;

    PROCEDURE CheckPreviousAndNext@18();
    VAR
      ProdOrderRtngLine@1001 : Record 5409;
      TempDeletedProdOrderRtngLine@1002 : TEMPORARY Record 5409;
      TempRemainingProdOrderRtngLine@1003 : TEMPORARY Record 5409;
      ProdOrderRoutingForm@1006 : Page 99000817;
      ErrorOnNext@1004 : Boolean;
      ErrorOnPrevious@1005 : Boolean;
    BEGIN
      TempDeletedProdOrderRtngLine := Rec;
      TempDeletedProdOrderRtngLine.INSERT;

      ProdOrderRtngLine.SETRANGE(Status,Status);
      ProdOrderRtngLine.SETRANGE("Prod. Order No.","Prod. Order No.");
      ProdOrderRtngLine.SETRANGE("Routing Reference No.","Routing Reference No.");
      ProdOrderRtngLine.SETRANGE("Routing No.","Routing No.");
      ProdOrderRtngLine.SETFILTER("Operation No.",'<>%1',"Operation No.");
      ProdOrderRtngLine.SETFILTER("Routing Status",'<>%1',ProdOrderRtngLine."Routing Status"::Finished);

      IF ProdOrderRtngLine.FIND('-') THEN
        REPEAT
          IF ProdOrderRtngLine."Next Operation No." <> '' THEN BEGIN
            TempDeletedProdOrderRtngLine.SETFILTER("Operation No.",ProdOrderRtngLine."Next Operation No.");
            ErrorOnNext := TempDeletedProdOrderRtngLine.FINDFIRST;
          END ELSE
            ErrorOnNext := FALSE;

          IF ProdOrderRtngLine."Previous Operation No." <> '' THEN BEGIN
            TempDeletedProdOrderRtngLine.SETFILTER("Operation No.",ProdOrderRtngLine."Previous Operation No.");
            ErrorOnPrevious := TempDeletedProdOrderRtngLine.FINDFIRST;
          END ELSE
            ErrorOnPrevious := FALSE;

          IF ErrorOnNext OR ErrorOnPrevious THEN BEGIN
            TempRemainingProdOrderRtngLine := ProdOrderRtngLine;
            TempRemainingProdOrderRtngLine.INSERT;
          END
        UNTIL ProdOrderRtngLine.NEXT = 0;

      IF TempRemainingProdOrderRtngLine.FIND('-') THEN BEGIN
        COMMIT;
        IF NOT CONFIRM(
             STRSUBSTNO(Text004,FIELDCAPTION("Next Operation No."),FIELDCAPTION("Previous Operation No.")),
             TRUE)
        THEN
          EXIT;
        ProdOrderRoutingForm.Initialize(STRSUBSTNO(Text005,"Operation No."));
        REPEAT
          TempRemainingProdOrderRtngLine.MARK(TRUE);
        UNTIL TempRemainingProdOrderRtngLine.NEXT = 0;
        TempRemainingProdOrderRtngLine.MARKEDONLY(TRUE);
        ProdOrderRoutingForm.SETTABLEVIEW(TempRemainingProdOrderRtngLine);
        ProdOrderRoutingForm.RUNMODAL;
      END;
    END;

    PROCEDURE SetNextOperations@4(VAR RtngLine@1001 : Record 5409);
    VAR
      RtngLine2@1003 : Record 5409;
    BEGIN
      RtngLine2.SETRANGE(Status,RtngLine.Status);
      RtngLine2.SETRANGE("Prod. Order No.",RtngLine."Prod. Order No.");
      RtngLine2.SETRANGE("Routing Reference No.",RtngLine."Routing Reference No.");
      RtngLine2.SETRANGE("Routing No.",RtngLine."Routing No.");
      RtngLine2.SETFILTER("Operation No.",'>%1',RtngLine."Operation No.");

      IF RtngLine2.FINDFIRST THEN
        RtngLine."Next Operation No." := RtngLine2."Operation No."
      ELSE BEGIN
        RtngLine2.SETFILTER("Operation No.",'');
        RtngLine2.SETRANGE("Next Operation No.",'');
        IF RtngLine2.FINDFIRST THEN BEGIN
          RtngLine2."Next Operation No." := RtngLine."Operation No.";
          RtngLine2.MODIFY;
        END;
      END;
    END;

    LOCAL PROCEDURE SubcontractPurchOrderExist@6() : Boolean;
    BEGIN
      IF Status <> Status::Released THEN
        EXIT(FALSE);

      ProdOrderLine.RESET;
      ProdOrderLine.SETRANGE(Status,Status);
      ProdOrderLine.SETRANGE("Prod. Order No.","Prod. Order No.");
      ProdOrderLine.SETRANGE("Routing Reference No.","Routing Reference No.");
      ProdOrderLine.SETRANGE("Routing No.","Routing No.");
      IF ProdOrderLine.FIND('-') THEN
        REPEAT
          PurchLine.SETCURRENTKEY(
            "Document Type",Type,"Prod. Order No.","Prod. Order Line No.","Routing No.","Operation No.");
          PurchLine.SETRANGE("Document Type",PurchLine."Document Type"::Order);
          PurchLine.SETRANGE(Type,PurchLine.Type::Item);
          PurchLine.SETRANGE("Prod. Order No.","Prod. Order No.");
          PurchLine.SETRANGE("Prod. Order Line No.",ProdOrderLine."Line No.");
          PurchLine.SETRANGE("Operation No.","Operation No.");
          IF NOT PurchLine.ISEMPTY THEN
            EXIT(TRUE);
        UNTIL ProdOrderLine.NEXT = 0;

      EXIT(FALSE);
    END;

    PROCEDURE UpdateComponentsBin@16(FromTrigger@1000 : 'Insert,Modify,Delete');
    VAR
      TempProdOrderRtngLine@1001 : TEMPORARY Record 5409;
    BEGIN
      IF SkipUpdateOfCompBinCodes THEN
        EXIT;

      IF NOT UpdateOfComponentsBinRequired(FromTrigger) THEN
        EXIT;

      PopulateNewRoutingLineSet(TempProdOrderRtngLine,FromTrigger);
      ProdOrderRouteMgt.UpdateComponentsBin(TempProdOrderRtngLine,FALSE);
    END;

    LOCAL PROCEDURE UpdateOfComponentsBinRequired@19(FromTrigger@1000 : 'Insert,Modify,Delete') : Boolean;
    BEGIN
      IF ("No." = '') AND (xRec."No." = "No.") THEN // bin codes are and were empty
        EXIT(FALSE);

      CASE FromTrigger OF
        FromTrigger::Insert,FromTrigger::Delete:
          EXIT(("Previous Operation No." = '') OR ("Routing Link Code" <> ''));
        FromTrigger::Modify:
          EXIT(
            ((xRec."Previous Operation No." = '') AND ("Previous Operation No." <> '')) OR
            ((xRec."Previous Operation No." <> '') AND ("Previous Operation No." = '')) OR
            (xRec."Routing Link Code" <> "Routing Link Code") OR
            ((("Previous Operation No." = '') OR ("Routing Link Code" <> '')) AND
             ((xRec."To-Production Bin Code" <> "To-Production Bin Code") OR
              (xRec."Open Shop Floor Bin Code" <> "Open Shop Floor Bin Code"))));
      END;
    END;

    LOCAL PROCEDURE PopulateNewRoutingLineSet@20(VAR ProdOrderRtngLineTmp@1000 : Record 5409;FromTrigger@1001 : 'Insert,Modify,Delete');
    VAR
      ProdOrderRtngLine2@1002 : Record 5409;
    BEGIN
      // copy existing routings for this prod. order to temporary table
      ProdOrderRtngLineTmp.DELETEALL;
      ProdOrderRtngLine2.SETCURRENTKEY(Status,"Prod. Order No.","Routing Reference No.","Routing No.","Operation No.");
      ProdOrderRtngLine2.SETRANGE(Status,Status);
      ProdOrderRtngLine2.SETRANGE("Prod. Order No.","Prod. Order No.");
      ProdOrderRtngLine2.SETRANGE("Routing Reference No.","Routing Reference No.");
      ProdOrderRtngLine2.SETRANGE("Routing No.","Routing No.");
      IF ProdOrderRtngLine2.FINDSET(FALSE) THEN
        REPEAT
          ProdOrderRtngLineTmp := ProdOrderRtngLine2;
          ProdOrderRtngLineTmp.INSERT;
        UNTIL ProdOrderRtngLine2.NEXT = 0;

      // update the recordset with the current change
      ProdOrderRtngLineTmp := Rec;
      CASE FromTrigger OF
        FromTrigger::Insert:
          ProdOrderRtngLineTmp.INSERT;
        FromTrigger::Modify:
          ProdOrderRtngLineTmp.MODIFY;
        FromTrigger::Delete:
          ProdOrderRtngLineTmp.DELETE;
      END;
    END;

    PROCEDURE SetSkipUpdateOfCompBinCodes@21(Setting@1000 : Boolean);
    BEGIN
      SkipUpdateOfCompBinCodes := Setting;
    END;

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 20.04.17 JAL Added fields for OPC.
    }
    END.
  }
}

OBJECT Table 99000758 Machine Center
{
  OBJECT-PROPERTIES
  {
    Date=20.04.17;
    Time=16.20.12;
    Modified=Yes;
    Version List=NAVW110.00,OPC1.0;
  }
  PROPERTIES
  {
    DataCaptionFields=No.,Name;
    OnInsert=BEGIN
               MfgSetup.GET;
               IF "No." = '' THEN BEGIN
                 MfgSetup.TESTFIELD("Machine Center Nos.");
                 NoSeriesMgt.InitSeries(MfgSetup."Machine Center Nos.",xRec."No. Series",0D,"No.","No. Series");
               END;
             END;

    OnModify=BEGIN
               "Last Date Modified" := TODAY;
             END;

    OnDelete=VAR
               ProdOrderRtngLine@1000 : Record 5409;
               StdCostWksh@1001 : Record 5841;
               CapLedgEntry@1002 : Record 5832;
             BEGIN
               CapLedgEntry.SETRANGE(Type,CapLedgEntry.Type::"Machine Center");
               CapLedgEntry.SETRANGE("No.","No.");
               IF NOT CapLedgEntry.ISEMPTY THEN
                 ERROR(Text007,TABLECAPTION,"No.",CapLedgEntry.TABLECAPTION);

               StdCostWksh.RESET;
               StdCostWksh.SETRANGE(Type,StdCostWksh.Type::"Machine Center");
               StdCostWksh.SETRANGE("No.","No.");
               IF NOT StdCostWksh.ISEMPTY THEN
                 ERROR(Text007,TABLECAPTION,"No.",StdCostWksh.TABLECAPTION);

               CalendarEntry.SETRANGE("Capacity Type",CalendarEntry."Capacity Type"::"Machine Center");
               CalendarEntry.SETRANGE("No.","No.");
               CalendarEntry.DELETEALL;

               CalAbsentEntry.SETRANGE("Capacity Type",CalendarEntry."Capacity Type"::"Machine Center");
               CalAbsentEntry.SETRANGE("No.","No.");
               CalAbsentEntry.DELETEALL;

               MfgCommentLine.SETRANGE("Table Name",MfgCommentLine."Table Name"::"Machine Center");
               MfgCommentLine.SETRANGE("No.","No.");
               MfgCommentLine.DELETEALL;

               ProdOrderRtngLine.SETRANGE(Type,ProdOrderRtngLine.Type::"Machine Center");
               ProdOrderRtngLine.SETRANGE("No.","No.");
               IF NOT ProdOrderRtngLine.ISEMPTY THEN
                 ERROR(Text000);
             END;

    OnRename=BEGIN
               "Last Date Modified" := TODAY;
             END;

    CaptionML=[ENU=Machine Center;
               NOR=Maskinsenter];
    LookupPageID=Page99000761;
    DrillDownPageID=Page99000761;
  }
  FIELDS
  {
    { 1   ;   ;No.                 ;Code20        ;AltSearchField=Search Name;
                                                   CaptionML=[ENU=No.;
                                                              NOR=Nr.] }
    { 3   ;   ;Name                ;Text50        ;OnValidate=BEGIN
                                                                "Search Name" := Name;
                                                              END;

                                                   CaptionML=[ENU=Name;
                                                              NOR=Navn] }
    { 4   ;   ;Search Name         ;Code50        ;CaptionML=[ENU=Search Name;
                                                              NOR=S›kenavn] }
    { 5   ;   ;Name 2              ;Text50        ;CaptionML=[ENU=Name 2;
                                                              NOR=Navn 2] }
    { 6   ;   ;Address             ;Text50        ;CaptionML=[ENU=Address;
                                                              NOR=Adresse] }
    { 7   ;   ;Address 2           ;Text50        ;CaptionML=[ENU=Address 2;
                                                              NOR=Adresse 2] }
    { 8   ;   ;City                ;Text30        ;TableRelation=IF (Country/Region Code=CONST()) "Post Code".City
                                                                 ELSE IF (Country/Region Code=FILTER(<>'')) "Post Code".City WHERE (Country/Region Code=FIELD(Country/Region Code));
                                                   OnValidate=BEGIN
                                                                PostCode.ValidateCity(City,"Post Code",County,"Country/Region Code",(CurrFieldNo <> 0) AND GUIALLOWED);
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=City;
                                                              NOR=Sted] }
    { 9   ;   ;Post Code           ;Code20        ;TableRelation=IF (Country/Region Code=CONST()) "Post Code"
                                                                 ELSE IF (Country/Region Code=FILTER(<>'')) "Post Code" WHERE (Country/Region Code=FIELD(Country/Region Code));
                                                   OnValidate=BEGIN
                                                                PostCode.ValidatePostCode(City,"Post Code",County,"Country/Region Code",(CurrFieldNo <> 0) AND GUIALLOWED);
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Post Code;
                                                              NOR=Postnr.] }
    { 14  ;   ;Work Center No.     ;Code20        ;TableRelation="Work Center";
                                                   OnValidate=VAR
                                                                WorkCenter@1000 : Record 99000754;
                                                                ProdOrderRtngLine@1001 : Record 5409;
                                                                ProdOrderCapNeed@1002 : Record 5410;
                                                                PlanningRtngLine@1003 : Record 99000830;
                                                              BEGIN
                                                                IF "Work Center No." = xRec."Work Center No." THEN
                                                                  EXIT;

                                                                IF "Work Center No." <> '' THEN BEGIN
                                                                  WorkCenter.GET("Work Center No.");
                                                                  WorkCenter.TESTFIELD("Unit of Measure Code");
                                                                  "Queue Time Unit of Meas. Code" := WorkCenter."Queue Time Unit of Meas. Code";
                                                                  "Setup Time Unit of Meas. Code" := WorkCenter."Unit of Measure Code";
                                                                  "Wait Time Unit of Meas. Code" := WorkCenter."Unit of Measure Code";
                                                                  "Move Time Unit of Meas. Code" := WorkCenter."Unit of Measure Code";
                                                                END;
                                                                VALIDATE("Location Code",WorkCenter."Location Code");

                                                                CalendarEntry.SETCURRENTKEY("Capacity Type","No.");
                                                                CalendarEntry.SETRANGE("Capacity Type",CalendarEntry."Capacity Type"::"Machine Center");
                                                                CalendarEntry.SETRANGE("No.","No.");
                                                                IF NOT CalendarEntry.FIND('-') THEN
                                                                  EXIT;

                                                                IF CurrFieldNo <> 0 THEN
                                                                  IF NOT CONFIRM(Text001,FALSE,FIELDCAPTION("Work Center No."))
                                                                  THEN BEGIN
                                                                    "Work Center No." := xRec."Work Center No.";
                                                                    EXIT;
                                                                  END;

                                                                Window.OPEN(
                                                                  Text002 +
                                                                  Text003 +
                                                                  Text004 +
                                                                  Text006);

                                                                i := 0;
                                                                NoOfRecords := CalendarEntry.COUNT;
                                                                IF CalendarEntry.FIND('-') THEN
                                                                  REPEAT
                                                                    i := i + 1;
                                                                    Window.UPDATE(1,i);
                                                                    Window.UPDATE(2,ROUND(i / NoOfRecords * 10000,1));
                                                                    CalendarEntry.VALIDATE("Work Center No.","Work Center No.");
                                                                    CalendarEntry.MODIFY;
                                                                  UNTIL CalendarEntry.NEXT = 0;

                                                                i := 0;
                                                                CalAbsentEntry.SETCURRENTKEY("Capacity Type","No.");
                                                                CalAbsentEntry.SETRANGE("Capacity Type",CalendarEntry."Capacity Type"::"Machine Center");
                                                                CalAbsentEntry.SETRANGE("No.","No.");
                                                                NoOfRecords := CalAbsentEntry.COUNT;
                                                                IF CalAbsentEntry.FIND('-') THEN
                                                                  REPEAT
                                                                    i := i + 1;
                                                                    Window.UPDATE(3,i);
                                                                    Window.UPDATE(4,ROUND(i / NoOfRecords * 10000,1));
                                                                    CalAbsentEntry.VALIDATE("Work Center No.","Work Center No.");
                                                                    CalAbsentEntry.MODIFY;
                                                                  UNTIL CalAbsentEntry.NEXT = 0;

                                                                i := 0;
                                                                ProdOrderCapNeed.SETCURRENTKEY(Type,"No.");
                                                                ProdOrderCapNeed.SETRANGE(Type,ProdOrderCapNeed.Type::"Machine Center");
                                                                ProdOrderCapNeed.SETRANGE("No.","No.");
                                                                NoOfRecords := ProdOrderCapNeed.COUNT;
                                                                IF ProdOrderCapNeed.FIND('-') THEN
                                                                  REPEAT
                                                                    i := i + 1;
                                                                    Window.UPDATE(7,i);
                                                                    Window.UPDATE(8,ROUND(i / NoOfRecords * 10000,1));
                                                                    ProdOrderCapNeed.VALIDATE("Work Center No.","Work Center No.");
                                                                    ProdOrderCapNeed.MODIFY;
                                                                  UNTIL ProdOrderCapNeed.NEXT = 0;

                                                                MODIFY;

                                                                RtngLine.SETCURRENTKEY(Type,"No.");
                                                                RtngLine.SETRANGE(Type,RtngLine.Type::"Machine Center");
                                                                RtngLine.SETRANGE("No.","No.");
                                                                IF RtngLine.FIND('-') THEN
                                                                  REPEAT
                                                                    RtngLine.VALIDATE("Work Center No.","Work Center No.");
                                                                    RtngLine.MODIFY;
                                                                  UNTIL RtngLine.NEXT = 0;

                                                                PlanningRtngLine.SETCURRENTKEY(Type,"No.");
                                                                PlanningRtngLine.SETRANGE(Type,PlanningRtngLine.Type::"Machine Center");
                                                                PlanningRtngLine.SETRANGE("No.","No.");
                                                                IF PlanningRtngLine.FIND('-') THEN
                                                                  REPEAT
                                                                    PlanningRtngLine.VALIDATE("Work Center No.","Work Center No.");
                                                                    PlanningRtngLine.MODIFY;
                                                                  UNTIL PlanningRtngLine.NEXT = 0;

                                                                ProdOrderRtngLine.SETCURRENTKEY(Type,"No.");
                                                                ProdOrderRtngLine.SETRANGE(Type,PlanningRtngLine.Type::"Machine Center");
                                                                ProdOrderRtngLine.SETRANGE("No.","No.");
                                                                IF ProdOrderRtngLine.FIND('-') THEN
                                                                  REPEAT
                                                                    ProdOrderRtngLine.VALIDATE("Work Center No.","Work Center No.");
                                                                    ProdOrderRtngLine.MODIFY;
                                                                  UNTIL ProdOrderRtngLine.NEXT = 0;

                                                                Window.CLOSE;
                                                              END;

                                                   CaptionML=[ENU=Work Center No.;
                                                              NOR=Arbeidssenternr.] }
    { 19  ;   ;Direct Unit Cost    ;Decimal       ;OnValidate=BEGIN
                                                                VALIDATE("Indirect Cost %");
                                                              END;

                                                   CaptionML=[ENU=Direct Unit Cost;
                                                              NOR=Direkte enhetskost];
                                                   MinValue=0;
                                                   AutoFormatType=2 }
    { 20  ;   ;Indirect Cost %     ;Decimal       ;OnValidate=BEGIN
                                                                GetGLSetup;
                                                                "Unit Cost" :=
                                                                  ROUND(
                                                                    "Direct Unit Cost" * (1 + "Indirect Cost %" / 100) + "Overhead Rate",
                                                                    GLSetup."Unit-Amount Rounding Precision");
                                                              END;

                                                   CaptionML=[ENU=Indirect Cost %;
                                                              NOR=Indirekte kost-%];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
    { 21  ;   ;Unit Cost           ;Decimal       ;OnValidate=BEGIN
                                                                GetGLSetup;
                                                                "Direct Unit Cost" :=
                                                                  ROUND(("Unit Cost" - "Overhead Rate") / (1 + "Indirect Cost %" / 100),
                                                                    GLSetup."Unit-Amount Rounding Precision");
                                                              END;

                                                   CaptionML=[ENU=Unit Cost;
                                                              NOR=Enhetskost];
                                                   DecimalPlaces=2:5;
                                                   MinValue=0;
                                                   AutoFormatType=2 }
    { 22  ;   ;Queue Time          ;Decimal       ;CaptionML=[ENU=Queue Time;
                                                              NOR=K›tid];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
    { 23  ;   ;Queue Time Unit of Meas. Code;Code10;
                                                   TableRelation="Capacity Unit of Measure";
                                                   CaptionML=[ENU=Queue Time Unit of Meas. Code;
                                                              NOR=K›tidsenhetskode] }
    { 26  ;   ;Last Date Modified  ;Date          ;CaptionML=[ENU=Last Date Modified;
                                                              NOR=Endret den];
                                                   Editable=No }
    { 27  ;   ;Comment             ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Manufacturing Comment Line" WHERE (Table Name=CONST(Machine Center),
                                                                                                         No.=FIELD(No.)));
                                                   CaptionML=[ENU=Comment;
                                                              NOR=Merknad];
                                                   Editable=No }
    { 31  ;   ;Capacity            ;Decimal       ;CaptionML=[ENU=Capacity;
                                                              NOR=Kapasitet];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
    { 32  ;   ;Efficiency          ;Decimal       ;InitValue=100;
                                                   CaptionML=[ENU=Efficiency;
                                                              NOR=Effektivitet];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
    { 33  ;   ;Maximum Efficiency  ;Decimal       ;CaptionML=[ENU=Maximum Efficiency;
                                                              NOR=Maks. effektivitet];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
    { 34  ;   ;Minimum Efficiency  ;Decimal       ;CaptionML=[ENU=Minimum Efficiency;
                                                              NOR=Min. effektivitet];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
    { 38  ;   ;Blocked             ;Boolean       ;CaptionML=[ENU=Blocked;
                                                              NOR=Sperret] }
    { 39  ;   ;Date Filter         ;Date          ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Date Filter;
                                                              NOR=Datofilter] }
    { 40  ;   ;Work Shift Filter   ;Code10        ;FieldClass=FlowFilter;
                                                   TableRelation="Work Shift";
                                                   CaptionML=[ENU=Work Shift Filter;
                                                              NOR=Arbeidsskiftfilter] }
    { 41  ;   ;Capacity (Total)    ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Calendar Entry"."Capacity (Total)" WHERE (Capacity Type=CONST(Machine Center),
                                                                                                              No.=FIELD(No.),
                                                                                                              Work Shift Code=FIELD(Work Shift Filter),
                                                                                                              Date=FIELD(Date Filter)));
                                                   CaptionML=[ENU=Capacity (Total);
                                                              NOR=Kapasitet (total)];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 42  ;   ;Capacity (Effective);Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Calendar Entry"."Capacity (Effective)" WHERE (Capacity Type=CONST(Machine Center),
                                                                                                                  No.=FIELD(No.),
                                                                                                                  Work Shift Code=FIELD(Work Shift Filter),
                                                                                                                  Date=FIELD(Date Filter)));
                                                   CaptionML=[ENU=Capacity (Effective);
                                                              NOR=Kapasitet (effektiv)];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 44  ;   ;Prod. Order Need (Qty.);Decimal    ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Prod. Order Capacity Need"."Allocated Time" WHERE (Type=CONST(Machine Center),
                                                                                                                       No.=FIELD(No.),
                                                                                                                       Status=FIELD(Prod. Order Status Filter),
                                                                                                                       Date=FIELD(Date Filter),
                                                                                                                       Requested Only=CONST(No)));
                                                   CaptionML=[ENU=Prod. Order Need (Qty.);
                                                              NOR=Prod.ordrebehov (ant.)];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 45  ;   ;Prod. Order Need Amount;Decimal    ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Prod. Order Routing Line"."Expected Operation Cost Amt." WHERE (Type=CONST(Machine Center),
                                                                                                                                    No.=FIELD(No.),
                                                                                                                                    Status=FIELD(Prod. Order Status Filter)));
                                                   CaptionML=[ENU=Prod. Order Need Amount;
                                                              NOR=Prod.ordrebehov - bel›p];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 47  ;   ;Prod. Order Status Filter;Option   ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Prod. Order Status Filter;
                                                              NOR=Prod.ordrestatusfilter];
                                                   OptionCaptionML=[ENU=Simulated,Planned,Firm Planned,Released,Finished;
                                                                    NOR=Simulert,Planlagt,Fast planlagt,Frigitt,Ferdig];
                                                   OptionString=Simulated,Planned,Firm Planned,Released,Finished }
    { 50  ;   ;Setup Time          ;Decimal       ;CaptionML=[ENU=Setup Time;
                                                              NOR=Oppstillingstid];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
    { 52  ;   ;Wait Time           ;Decimal       ;CaptionML=[ENU=Wait Time;
                                                              NOR=Ventetid];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
    { 53  ;   ;Move Time           ;Decimal       ;CaptionML=[ENU=Move Time;
                                                              NOR=Transporttid];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
    { 54  ;   ;Fixed Scrap Quantity;Decimal       ;CaptionML=[ENU=Fixed Scrap Quantity;
                                                              NOR=Fast vrakantall];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
    { 55  ;   ;Scrap %             ;Decimal       ;CaptionML=[ENU=Scrap %;
                                                              NOR=Vrak-%];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
    { 56  ;   ;Setup Time Unit of Meas. Code;Code10;
                                                   TableRelation="Capacity Unit of Measure";
                                                   CaptionML=[ENU=Setup Time Unit of Meas. Code;
                                                              NOR=Oppstillingstid - enhetskode] }
    { 57  ;   ;Wait Time Unit of Meas. Code;Code10;TableRelation="Capacity Unit of Measure";
                                                   CaptionML=[ENU=Wait Time Unit of Meas. Code;
                                                              NOR=Ventetid - enhetskode] }
    { 58  ;   ;Send-Ahead Quantity ;Decimal       ;CaptionML=[ENU=Send-Ahead Quantity;
                                                              NOR=Overlappantall];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
    { 59  ;   ;Move Time Unit of Meas. Code;Code10;TableRelation="Capacity Unit of Measure";
                                                   CaptionML=[ENU=Move Time Unit of Meas. Code;
                                                              NOR=Transporttid - enhetskode] }
    { 60  ;   ;Flushing Method     ;Option        ;InitValue=Manual;
                                                   CaptionML=[ENU=Flushing Method;
                                                              NOR=Trekkmetode];
                                                   OptionCaptionML=[ENU=Manual,Forward,Backward;
                                                                    NOR=Manuell,Forlengs,Baklengs];
                                                   OptionString=Manual,Forward,Backward }
    { 62  ;   ;Minimum Process Time;Decimal       ;CaptionML=[ENU=Minimum Process Time;
                                                              NOR=Minimum behandlingstid];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
    { 63  ;   ;Maximum Process Time;Decimal       ;CaptionML=[ENU=Maximum Process Time;
                                                              NOR=Maksimal behandlingstid];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
    { 64  ;   ;Concurrent Capacities;Decimal      ;CaptionML=[ENU=Concurrent Capacities;
                                                              NOR=Samtidige kapasiteter];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
    { 65  ;   ;Item Filter         ;Code20        ;FieldClass=FlowFilter;
                                                   TableRelation=Item;
                                                   CaptionML=[ENU=Item Filter;
                                                              NOR=Varefilter] }
    { 66  ;   ;Stop Code Filter    ;Code10        ;FieldClass=FlowFilter;
                                                   TableRelation=Stop;
                                                   CaptionML=[ENU=Stop Code Filter;
                                                              NOR=Stoppkodefilter] }
    { 67  ;   ;Scrap Code Filter   ;Code10        ;FieldClass=FlowFilter;
                                                   TableRelation=Scrap;
                                                   CaptionML=[ENU=Scrap Code Filter;
                                                              NOR=Vrakkodefilter] }
    { 80  ;   ;No. Series          ;Code10        ;TableRelation="No. Series";
                                                   CaptionML=[ENU=No. Series;
                                                              NOR=Nr.serie];
                                                   Editable=No }
    { 81  ;   ;Overhead Rate       ;Decimal       ;OnValidate=BEGIN
                                                                VALIDATE("Indirect Cost %");
                                                              END;

                                                   CaptionML=[ENU=Overhead Rate;
                                                              NOR=Sats for indirekte kostnader];
                                                   AutoFormatType=2 }
    { 82  ;   ;Gen. Prod. Posting Group;Code10    ;TableRelation="Gen. Product Posting Group";
                                                   CaptionML=[ENU=Gen. Prod. Posting Group;
                                                              NOR=Bokf›ringsgruppe - vare] }
    { 83  ;   ;County              ;Text30        ;CaptionML=[ENU=County;
                                                              NOR=Fylke/delstat] }
    { 84  ;   ;Country/Region Code ;Code10        ;TableRelation=Country/Region;
                                                   CaptionML=[ENU=Country/Region Code;
                                                              NOR=Lands-/regionkode] }
    { 7300;   ;Location Code       ;Code10        ;TableRelation=Location.Code WHERE (Use As In-Transit=CONST(No),
                                                                                      Bin Mandatory=CONST(Yes));
                                                   OnValidate=VAR
                                                                WorkCenter@1000 : Record 99000754;
                                                                AutoUpdate@1001 : Boolean;
                                                              BEGIN
                                                                IF "Location Code" <> xRec."Location Code" THEN BEGIN
                                                                  IF ("Work Center No." = '') AND ("Location Code" <> '') THEN
                                                                    ERROR(Text008,FIELDCAPTION("Location Code"),TABLECAPTION,WorkCenter.TABLECAPTION);

                                                                  IF "Open Shop Floor Bin Code" <> '' THEN BEGIN
                                                                    IF ConfirmAutoRemovalOfBinCode(AutoUpdate) THEN
                                                                      VALIDATE("Open Shop Floor Bin Code",'')
                                                                    ELSE
                                                                      TESTFIELD("Open Shop Floor Bin Code",'');
                                                                  END;
                                                                  IF "To-Production Bin Code" <> '' THEN BEGIN
                                                                    IF ConfirmAutoRemovalOfBinCode(AutoUpdate) THEN
                                                                      VALIDATE("To-Production Bin Code",'')
                                                                    ELSE
                                                                      TESTFIELD("To-Production Bin Code",'');
                                                                  END;
                                                                  IF "From-Production Bin Code" <> '' THEN BEGIN
                                                                    IF ConfirmAutoRemovalOfBinCode(AutoUpdate) THEN
                                                                      VALIDATE("From-Production Bin Code",'')
                                                                    ELSE
                                                                      TESTFIELD("From-Production Bin Code",'');
                                                                  END;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Location Code;
                                                              NOR=Lokasjonskode];
                                                   Editable=No }
    { 7301;   ;Open Shop Floor Bin Code;Code20    ;TableRelation=Bin.Code WHERE (Location Code=FIELD(Location Code));
                                                   OnValidate=VAR
                                                                WhseIntegrationMgt@1000 : Codeunit 7317;
                                                              BEGIN
                                                                WhseIntegrationMgt.CheckBinCode("Location Code",
                                                                  "Open Shop Floor Bin Code",
                                                                  FIELDCAPTION("Open Shop Floor Bin Code"),
                                                                  DATABASE::"Machine Center","No.");
                                                              END;

                                                   CaptionML=[ENU=Open Shop Floor Bin Code;
                                                              NOR=pen prod.hyllekode] }
    { 7302;   ;To-Production Bin Code;Code20      ;TableRelation=Bin.Code WHERE (Location Code=FIELD(Location Code));
                                                   OnValidate=VAR
                                                                WhseIntegrationMgt@1000 : Codeunit 7317;
                                                              BEGIN
                                                                WhseIntegrationMgt.CheckBinCode("Location Code",
                                                                  "To-Production Bin Code",
                                                                  FIELDCAPTION("To-Production Bin Code"),
                                                                  DATABASE::"Machine Center","No.");
                                                              END;

                                                   CaptionML=[ENU=To-Production Bin Code;
                                                              NOR=Til-Hyllekode for produksjon] }
    { 7303;   ;From-Production Bin Code;Code20    ;TableRelation=Bin.Code WHERE (Location Code=FIELD(Location Code));
                                                   OnValidate=VAR
                                                                WhseIntegrationMgt@1000 : Codeunit 7317;
                                                              BEGIN
                                                                WhseIntegrationMgt.CheckBinCode("Location Code",
                                                                  "From-Production Bin Code",
                                                                  FIELDCAPTION("From-Production Bin Code"),
                                                                  DATABASE::"Machine Center","No.");
                                                              END;

                                                   CaptionML=[ENU=From-Production Bin Code;
                                                              NOR=Fra-Hyllekode for produksjon] }
    { 83001;  ;Show in OPC         ;Boolean       ;CaptionML=[ENU=Show in OPC;
                                                              NOR=Vises i OPC];
                                                   Description=OPC }
    { 83002;  ;Clocking            ;Boolean       ;CaptionML=[ENU=Clocking;
                                                              NOR=M›nstring];
                                                   Description=OPC }
    { 83003;  ;Employee No.        ;Code20        ;CaptionML=[ENU=Employee No. (H and L);
                                                              NOR=Ansattnr. (H og L)];
                                                   Description=OPC }
    { 83004;  ;Time registrations  ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Time Register".Quantity WHERE (Machine Center=FIELD(No.),
                                                                                                   Start Date=FIELD(Date Filter)));
                                                   Description=OPC }
    { 83005;  ;Earliest Time Reg.  ;Time          ;FieldClass=FlowField;
                                                   CalcFormula=Min("Time Register"."Start Time" WHERE (Machine Center=FIELD(No.),
                                                                                                       Start Date=FIELD(Date Filter)));
                                                   Description=OPC }
    { 83006;  ;Latest Time Reg.    ;Time          ;FieldClass=FlowField;
                                                   CalcFormula=Max("Time Register"."End Time" WHERE (Machine Center=FIELD(No.),
                                                                                                     Start Date=FIELD(Date Filter)));
                                                   Description=OPC }
    { 83007;  ;Deduct - Lunch      ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Time Register" WHERE (Deduction Type=CONST(Lunch),
                                                                                            Start Date=FIELD(Date Filter),
                                                                                            Machine Center=FIELD(No.)));
                                                   Description=OPC }
    { 83008;  ;Invoiced Qty.       ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Capacity Ledger Entry"."Invoiced Quantity" WHERE (No.=FIELD(No.),
                                                                                                                      Type=FILTER(Machine Center),
                                                                                                                      Posting Date=FIELD(Date Filter)));
                                                   Description=OPC }
    { 83009;  ;Birth Date          ;Date          ;CaptionML=[ENU=Birth Date;
                                                              NOR=F›dselsdato];
                                                   Description=OPC }
    { 83010;  ;Allow OPC Move      ;Boolean       ;CaptionML=NOR=Tillat flytting av komponenter via OPC;
                                                   Description=OPC }
  }
  KEYS
  {
    {    ;No.                                     ;Clustered=Yes }
    {    ;Search Name                              }
    {    ;Work Center No.                          }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      Text000@1000 : TextConst 'ENU=The Machine Center is being used on production orders.;NOR=Maskinsenteret brukes i forbindelse med produksjonsordrer.';
      Text001@1001 : TextConst 'ENU=Do you want to change %1?;NOR=Vil du endre %1?';
      Text002@1002 : TextConst 'ENU=Work Center No. is corrected on\\;NOR=Arbeidssenternr. er korrigert\\';
      Text003@1003 : TextConst 'ENU=Calendar Entry    #1###### @2@@@@@@@@@@@@@\;NOR=Kalenderpost      #1###### @2@@@@@@@@@@@@@\';
      Text004@1004 : TextConst 'ENU=Calendar Absent.  #3###### @4@@@@@@@@@@@@@\;NOR=Kalenderfrav‘r    #3###### @4@@@@@@@@@@@@@\';
      Text006@1005 : TextConst 'ENU=Prod. Order Need  #7###### @8@@@@@@@@@@@@@;NOR=Prod.ordrebehov   #7###### @8@@@@@@@@@@@@@';
      PostCode@1020 : Record 225;
      MfgSetup@1006 : Record 99000765;
      MachineCenter@1007 : Record 99000758;
      CalendarEntry@1008 : Record 99000757;
      CalAbsentEntry@1009 : Record 99000760;
      MfgCommentLine@1010 : Record 99000770;
      RtngLine@1011 : Record 99000764;
      GLSetup@1017 : Record 98;
      NoSeriesMgt@1013 : Codeunit 396;
      Window@1014 : Dialog;
      i@1015 : Integer;
      NoOfRecords@1016 : Integer;
      GLSetupRead@1018 : Boolean;
      Text007@1019 : TextConst '@@@="%1 = Table caption; %2 = Field Value; %3 = Table Caption";ENU=You cannot delete %1 %2 because there is at least one %3 associated with it.;NOR=Du kan ikke slette %1 %2 fordi det finnes minst ‚n %3 tilknyttet.';
      Text008@1021 : TextConst 'ENU=You cannot change the %1 on %2 unless it is linked to a %3.;NOR=Du kan ikke endre %1 p† %2 med mindre koblet til %3.';
      Text009@1022 : TextConst 'ENU=If you change the %1, then all bin codes on the %2 will be removed. Are you sure that you want to continue?;NOR=Hvis du endrer %1, vil alle hyllekoder p† %2 bli fjernet. Er du sikker p† at du vil fortsette ?';

    PROCEDURE AssistEdit@2(OldMachineCenter@1000 : Record 99000758) : Boolean;
    BEGIN
      WITH MachineCenter DO BEGIN
        MachineCenter := Rec;
        MfgSetup.GET;
        MfgSetup.TESTFIELD("Machine Center Nos.");
        IF NoSeriesMgt.SelectSeries(MfgSetup."Machine Center Nos.",OldMachineCenter."No. Series","No. Series") THEN BEGIN
          NoSeriesMgt.SetSeries("No.");
          Rec := MachineCenter;
          EXIT(TRUE);
        END;
      END;
    END;

    LOCAL PROCEDURE GetGLSetup@14();
    BEGIN
      IF NOT GLSetupRead THEN
        GLSetup.GET;
      GLSetupRead := TRUE;
    END;

    LOCAL PROCEDURE ConfirmAutoRemovalOfBinCode@1(VAR AutoUpdate@1000 : Boolean) : Boolean;
    BEGIN
      IF AutoUpdate THEN
        EXIT(TRUE);

      IF CONFIRM(Text009,FALSE,FIELDCAPTION("Location Code"),TABLECAPTION) THEN
        AutoUpdate := TRUE;

      EXIT(AutoUpdate);
    END;

    PROCEDURE GetBinCode@9(UseFlushingMethod@1000 : Boolean;FlushingMethod@1001 : 'Manual,Forward,Backward,Pick + Forward,Pick + Backward') : Code[20];
    BEGIN
      IF NOT UseFlushingMethod THEN
        EXIT("From-Production Bin Code");

      CASE FlushingMethod OF
        FlushingMethod::Manual,
        FlushingMethod::"Pick + Forward",
        FlushingMethod::"Pick + Backward":
          EXIT("To-Production Bin Code");
        FlushingMethod::Forward,
        FlushingMethod::Backward:
          EXIT("Open Shop Floor Bin Code");
      END;
    END;

    BEGIN
    {
      +----------------------------------------------+
      OPC 5.01 (=5.0 SP1)
      ------------------------------------------------
      No  Date     ID  Description
      01. 04.11.09 HHE Opprettet feltene: 83001 "Show in OPC", 83470 Clocking, 83471 "Employee No."
      02. 21.01.10 BVM Nytt felt: Flowfelt Invoiced Qty, .
      03. 17.12.10 HHE Nytt felt: Birth date (›nsket av FRSK. Brukes i m›nstringstider->l›nnsgrunnlag)
      04. 04.03.10 HHE Nye  felt: Timeregistrations (brukes for summering av faktisk m›nstringstid)
                                  "Earilest start time" (tidspkt. for innstempling)
                                  "Latest end time" (tidspkt. for utstempling)
      05. 19.03.10 HHE Nytt felt "Deduct - Lunch" (for † se om det finnes fradrag-lunch for dagen)
    }
    END.
  }
}

OBJECT Table 99000760 Calendar Absence Entry
{
  OBJECT-PROPERTIES
  {
    Date=20.04.17;
    Time=16.20.12;
    Modified=Yes;
    Version List=NAVW110.00,OPC1.0;
  }
  PROPERTIES
  {
    OnDelete=BEGIN
               CalAbsenceMgt.RemoveAbsence(Rec);
             END;

    OnRename=BEGIN
               CalAbsenceMgt.RemoveAbsence(xRec);
               Updated := FALSE;
             END;

    CaptionML=[ENU=Calendar Absence Entry;
               NOR=Kalenderfrav‘rspost];
    LookupPageID=Page99000772;
    DrillDownPageID=Page99000772;
  }
  FIELDS
  {
    { 1   ;   ;Capacity Type       ;Option        ;CaptionML=[ENU=Capacity Type;
                                                              NOR=Kapasitetstype];
                                                   OptionCaptionML=[ENU=Work Center,Machine Center;
                                                                    NOR=Arbeidssenter,Maskinsenter];
                                                   OptionString=Work Center,Machine Center;
                                                   Editable=No }
    { 2   ;   ;No.                 ;Code20        ;TableRelation=IF (Capacity Type=CONST(Work Center)) "Work Center"
                                                                 ELSE IF (Capacity Type=CONST(Machine Center)) "Machine Center";
                                                   OnValidate=BEGIN
                                                                IF "No." = '' THEN
                                                                  EXIT;

                                                                CASE "Capacity Type" OF
                                                                  "Capacity Type"::"Work Center":
                                                                    BEGIN
                                                                      Workcenter.GET("No.");
                                                                      Workcenter.TESTFIELD("Work Center Group Code");
                                                                      "Work Center No." := Workcenter."No.";
                                                                      "Work Center Group Code" := Workcenter."Work Center Group Code";
                                                                      Capacity := Workcenter.Capacity;
                                                                    END;
                                                                  "Capacity Type"::"Machine Center":
                                                                    BEGIN
                                                                      Machinecenter.GET("No.");
                                                                      Machinecenter.TESTFIELD("Work Center No.");
                                                                      Workcenter.GET(Machinecenter."Work Center No.");
                                                                      Workcenter.TESTFIELD("Work Center Group Code");
                                                                      "Work Center No." := Workcenter."No.";
                                                                      "Work Center Group Code" := Workcenter."Work Center Group Code";
                                                                      Capacity := Machinecenter.Capacity;
                                                                    END;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=No.;
                                                              NOR=Nr.];
                                                   NotBlank=Yes }
    { 4   ;   ;Date                ;Date          ;OnValidate=BEGIN
                                                                UpdateDatetime;
                                                              END;

                                                   CaptionML=[ENU=Date;
                                                              NOR=Dato];
                                                   NotBlank=Yes }
    { 6   ;   ;Starting Time       ;Time          ;OnValidate=BEGIN
                                                                IF ("Ending Time" = 0T) OR
                                                                   ("Ending Time" < "Starting Time" )
                                                                THEN
                                                                  VALIDATE("Ending Time","Starting Time")
                                                              END;

                                                   CaptionML=[ENU=Starting Time;
                                                              NOR=Starttidspunkt] }
    { 7   ;   ;Ending Time         ;Time          ;OnValidate=BEGIN
                                                                IF "Ending Time" < "Starting Time" THEN
                                                                  ERROR(Text000,FIELDCAPTION("Ending Time"),FIELDCAPTION("Starting Time"));

                                                                UpdateDatetime;
                                                              END;

                                                   CaptionML=[ENU=Ending Time;
                                                              NOR=Sluttidspunkt] }
    { 8   ;   ;Work Center No.     ;Code20        ;TableRelation="Work Center";
                                                   CaptionML=[ENU=Work Center No.;
                                                              NOR=Arbeidssenternr.];
                                                   Editable=No }
    { 9   ;   ;Work Center Group Code;Code10      ;TableRelation="Work Center Group";
                                                   CaptionML=[ENU=Work Center Group Code;
                                                              NOR=Arbeidssentergruppekode];
                                                   Editable=No }
    { 21  ;   ;Capacity            ;Decimal       ;OnValidate=BEGIN
                                                                IF Capacity <> xRec.Capacity THEN BEGIN
                                                                  CalAbsenceMgt.RemoveAbsence(xRec);
                                                                  Updated := FALSE;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Capacity;
                                                              NOR=Kapasitet];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
    { 24  ;   ;Starting Date-Time  ;DateTime      ;OnValidate=BEGIN
                                                                "Starting Time" := DT2TIME("Starting Date-Time");
                                                                Date := DT2DATE("Starting Date-Time");
                                                                VALIDATE("Starting Time");
                                                              END;

                                                   CaptionML=[ENU=Starting Date-Time;
                                                              NOR=Startdato-tidsp.] }
    { 25  ;   ;Ending Date-Time    ;DateTime      ;OnValidate=BEGIN
                                                                "Ending Time" := DT2TIME("Ending Date-Time");
                                                                Date := DT2DATE("Ending Date-Time");
                                                                VALIDATE("Ending Time");
                                                              END;

                                                   CaptionML=[ENU=Ending Date-Time;
                                                              NOR=Sluttdato-tidsp.] }
    { 31  ;   ;Description         ;Text50        ;CaptionML=[ENU=Description;
                                                              NOR=Beskrivelse] }
    { 32  ;   ;Updated             ;Boolean       ;CaptionML=[ENU=Updated;
                                                              NOR=Oppdatert];
                                                   Editable=No }
    { 50000;  ;Work Type Code      ;Code10        ;TableRelation="Work Type Code" WHERE (Absence=CONST(Yes));
                                                   CaptionML=[ENU=Work Type Code;
                                                              NOR=Arbeidstypekode] }
  }
  KEYS
  {
    {    ;Capacity Type,No.,Date,Starting Time,Ending Time;
                                                   Clustered=Yes }
    {    ;Work Center No.                          }
    {    ;Capacity Type,No.,Date,Starting Date-Time,Ending Date-Time }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      Text000@1000 : TextConst 'ENU=%1 must be higher than %2.;NOR=%1 m† v‘re st›rre enn %2.';
      Workcenter@1001 : Record 99000754;
      Machinecenter@1002 : Record 99000758;
      CalAbsenceMgt@1003 : Codeunit 99000759;

    PROCEDURE Caption@3() : Text[100];
    BEGIN
      IF "Capacity Type" = "Capacity Type"::"Machine Center" THEN BEGIN
        IF NOT Machinecenter.GET(GETFILTER("No.")) THEN
          EXIT('');
        EXIT(
          STRSUBSTNO('%1 %2',
            Machinecenter."No.",Machinecenter.Name));
      END;
      IF NOT Workcenter.GET(GETFILTER("No.")) THEN
        EXIT('');
      EXIT(
        STRSUBSTNO('%1 %2',
          Workcenter."No.",Workcenter.Name));
    END;

    LOCAL PROCEDURE UpdateDatetime@11();
    BEGIN
      "Starting Date-Time" := CREATEDATETIME(Date,"Starting Time");
      "Ending Date-Time" := CREATEDATETIME(Date,"Ending Time");
    END;

    BEGIN
    {
      +-------------------------------------------------+
      | OPC                                             |
      +-------------------------------------------------+
      Dato     ID  Beskrivelse
      16.11.09 HHE Nytt felt "Work Type Code"
    }
    END.
  }
}

OBJECT Table 99000761 Stop
{
  OBJECT-PROPERTIES
  {
    Date=20.04.17;
    Time=11.32.33;
    Modified=Yes;
    Version List=NAVW17.00,OPC1.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Stop;
               NOR=Stopp];
    LookupPageID=Page99000779;
    DrillDownPageID=Page99000779;
  }
  FIELDS
  {
    { 1   ;   ;Code                ;Code10        ;CaptionML=[ENU=Code;
                                                              NOR=Kode];
                                                   NotBlank=Yes }
    { 2   ;   ;Description         ;Text50        ;CaptionML=[ENU=Description;
                                                              NOR=Beskrivelse] }
    { 50000;  ;OPC-Non producing time;Boolean     ;CaptionML=[ENU=OPC-Non producing time;
                                                              NOR=OPC- Ikke produktiv tid] }
  }
  KEYS
  {
    {    ;Code                                    ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 19.10.09 HHE Nytt felt = 50000 "OPC-Non producing time"
    }
    END.
  }
}

