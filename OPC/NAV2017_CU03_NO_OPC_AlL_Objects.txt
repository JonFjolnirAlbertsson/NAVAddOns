OBJECT Table 83 Item Journal Line
{
  OBJECT-PROPERTIES
  {
    Date=22.09.17;
    Time=22:33:34;
    Modified=Yes;
    Version List=NAVW110.00,INC1.08,OPC6.01;
  }
  PROPERTIES
  {
    OnInsert=BEGIN
               LOCKTABLE;
               ItemJnlTemplate.GET("Journal Template Name");
               ItemJnlBatch.GET("Journal Template Name","Journal Batch Name");

               ValidateShortcutDimCode(1,"Shortcut Dimension 1 Code");
               ValidateShortcutDimCode(2,"Shortcut Dimension 2 Code");
               ValidateNewShortcutDimCode(1,"New Shortcut Dimension 1 Code");
               ValidateNewShortcutDimCode(2,"New Shortcut Dimension 2 Code");

               CheckPlanningAssignment;
             END;

    OnModify=BEGIN
               ReserveItemJnlLine.VerifyChange(Rec,xRec);
               CheckPlanningAssignment;
             END;

    OnDelete=BEGIN
               ReserveItemJnlLine.DeleteLine(Rec);

               CALCFIELDS("Reserved Qty. (Base)");
               TESTFIELD("Reserved Qty. (Base)",0);
             END;

    OnRename=BEGIN
               ReserveItemJnlLine.RenameLine(Rec,xRec);
             END;

    CaptionML=[ENU=Item Journal Line;
               NOR=Varekladdelinje];
    LookupPageID=Page519;
    DrillDownPageID=Page519;
  }
  FIELDS
  {
    { 1   ;   ;Journal Template Name;Code10       ;TableRelation="Item Journal Template";
                                                   CaptionML=[ENU=Journal Template Name;
                                                              NOR=Kladdemalnavn] }
    { 2   ;   ;Line No.            ;Integer       ;CaptionML=[ENU=Line No.;
                                                              NOR=Linjenr.] }
    { 3   ;   ;Item No.            ;Code20        ;TableRelation=Item;
                                                   OnValidate=VAR
                                                                ProdOrderLine@1001 : Record 5406;
                                                                ProdOrderComp@1000 : Record 5407;
                                                              BEGIN
                                                                IF "Item No." <> xRec."Item No." THEN BEGIN
                                                                  "Variant Code" := '';
                                                                  "Bin Code" := '';
                                                                  IF CurrFieldNo <> 0 THEN
                                                                    WMSManagement.CheckItemJnlLineFieldChange(Rec,xRec,FIELDCAPTION("Item No."));
                                                                  IF ("Location Code" <> '') AND ("Item No." <> '') THEN BEGIN
                                                                    GetLocation("Location Code");
                                                                    IF Location."Bin Mandatory" AND NOT Location."Directed Put-away and Pick" THEN
                                                                      WMSManagement.GetDefaultBin("Item No.","Variant Code","Location Code","Bin Code")
                                                                  END;
                                                                  IF ("Entry Type" = "Entry Type"::Transfer) AND ("Location Code" = "New Location Code") THEN
                                                                    "New Bin Code" := "Bin Code";
                                                                END;

                                                                IF "Entry Type" IN ["Entry Type"::Consumption,"Entry Type"::Output] THEN
                                                                  WhseValidateSourceLine.ItemLineVerifyChange(Rec,xRec);

                                                                IF "Item No." = '' THEN BEGIN
                                                                  CreateDim(
                                                                    DATABASE::Item,"Item No.",
                                                                    DATABASE::"Salesperson/Purchaser","Salespers./Purch. Code",
                                                                    DATABASE::"Work Center","Work Center No.");
                                                                  EXIT;
                                                                END;

                                                                GetItem;
                                                                Item.TESTFIELD(Blocked,FALSE);
                                                                Item.TESTFIELD(Type,Item.Type::Inventory);
                                                                IF "Value Entry Type" = "Value Entry Type"::Revaluation THEN
                                                                  Item.TESTFIELD("Inventory Value Zero",FALSE);
                                                                Description := Item.Description;
                                                                "Inventory Posting Group" := Item."Inventory Posting Group";
                                                                "Item Category Code" := Item."Item Category Code";
                                                                "Product Group Code" := Item."Product Group Code";

                                                                IF ("Value Entry Type" <> "Value Entry Type"::"Direct Cost") OR
                                                                   ("Item Charge No." <> '')
                                                                THEN BEGIN
                                                                  IF "Item No." <> xRec."Item No." THEN BEGIN
                                                                    TESTFIELD("Partial Revaluation",FALSE);
                                                                    RetrieveCosts;
                                                                    "Indirect Cost %" := 0;
                                                                    "Overhead Rate" := 0;
                                                                    "Inventory Value Per" := "Inventory Value Per"::" ";
                                                                    VALIDATE("Applies-to Entry",0);
                                                                    "Partial Revaluation" := FALSE;
                                                                  END;
                                                                END ELSE BEGIN
                                                                  "Indirect Cost %" := Item."Indirect Cost %";
                                                                  "Overhead Rate" := Item."Overhead Rate";
                                                                  IF NOT "Phys. Inventory" OR (Item."Costing Method" = Item."Costing Method"::Standard) THEN BEGIN
                                                                    RetrieveCosts;
                                                                    "Unit Cost" := UnitCost;
                                                                  END ELSE
                                                                    UnitCost := "Unit Cost";
                                                                END;

                                                                IF (("Entry Type" = "Entry Type"::Output) AND (WorkCenter."No." = '') AND (MachineCenter."No." = '')) OR
                                                                   ("Entry Type" <> "Entry Type"::Output) OR
                                                                   ("Value Entry Type" = "Value Entry Type"::Revaluation)
                                                                THEN
                                                                  "Gen. Prod. Posting Group" := Item."Gen. Prod. Posting Group";

                                                                CASE "Entry Type" OF
                                                                  "Entry Type"::Purchase,
                                                                  "Entry Type"::Output,
                                                                  "Entry Type"::"Assembly Output":
                                                                    PurchPriceCalcMgt.FindItemJnlLinePrice(Rec,FIELDNO("Item No."));
                                                                  "Entry Type"::"Positive Adjmt.",
                                                                  "Entry Type"::"Negative Adjmt.",
                                                                  "Entry Type"::Consumption,
                                                                  "Entry Type"::"Assembly Consumption":
                                                                    "Unit Amount" := UnitCost;
                                                                  "Entry Type"::Sale:
                                                                    SalesPriceCalcMgt.FindItemJnlLinePrice(Rec,FIELDNO("Item No."));
                                                                  "Entry Type"::Transfer:
                                                                    BEGIN
                                                                      "Unit Amount" := 0;
                                                                      "Unit Cost" := 0;
                                                                      Amount := 0;
                                                                    END;
                                                                END;

                                                                CASE "Entry Type" OF
                                                                  "Entry Type"::Purchase:
                                                                    "Unit of Measure Code" := Item."Purch. Unit of Measure";
                                                                  "Entry Type"::Sale:
                                                                    "Unit of Measure Code" := Item."Sales Unit of Measure";
                                                                  "Entry Type"::Output:
                                                                    BEGIN
                                                                      Item.TESTFIELD("Inventory Value Zero",FALSE);
                                                                      ProdOrderLine.SetFilterByReleasedOrderNo("Order No.");
                                                                      ProdOrderLine.SETRANGE("Item No.","Item No.");
                                                                      IF ProdOrderLine.FINDFIRST THEN BEGIN
                                                                        "Routing No." := ProdOrderLine."Routing No.";
                                                                        "Source Type" := "Source Type"::Item;
                                                                        "Source No." := ProdOrderLine."Item No.";
                                                                      END ELSE
                                                                        IF ("Value Entry Type" <> "Value Entry Type"::Revaluation) AND
                                                                           (CurrFieldNo <> 0)
                                                                        THEN
                                                                          ERROR(Text031,"Item No.","Order No.");
                                                                      IF ProdOrderLine.COUNT = 1 THEN BEGIN
                                                                        VALIDATE("Order Line No.",ProdOrderLine."Line No.");
                                                                        "Unit of Measure Code" := ProdOrderLine."Unit of Measure Code";
                                                                        "Location Code" := ProdOrderLine."Location Code";
                                                                        VALIDATE("Variant Code",ProdOrderLine."Variant Code");
                                                                        VALIDATE("Bin Code",ProdOrderLine."Bin Code");
                                                                      END ELSE
                                                                        "Unit of Measure Code" := Item."Base Unit of Measure";
                                                                    END;
                                                                  "Entry Type"::Consumption:
                                                                    BEGIN
                                                                      ProdOrderComp.SetFilterByReleasedOrderNo("Order No.");
                                                                      ProdOrderComp.SETRANGE("Item No.","Item No.");
                                                                      IF ProdOrderComp.COUNT = 1 THEN BEGIN
                                                                        ProdOrderComp.FINDFIRST;
                                                                        VALIDATE("Order Line No.",ProdOrderComp."Prod. Order Line No.");
                                                                        VALIDATE("Prod. Order Comp. Line No.",ProdOrderComp."Line No.");
                                                                        "Unit of Measure Code" := ProdOrderComp."Unit of Measure Code";
                                                                        "Location Code" := ProdOrderComp."Location Code";
                                                                        VALIDATE("Variant Code",ProdOrderComp."Variant Code");
                                                                        VALIDATE("Bin Code",ProdOrderComp."Bin Code");
                                                                      END ELSE BEGIN
                                                                        "Unit of Measure Code" := Item."Base Unit of Measure";
                                                                        VALIDATE("Prod. Order Comp. Line No.",0);
                                                                      END;
                                                                    END;
                                                                  ELSE
                                                                    "Unit of Measure Code" := Item."Base Unit of Measure";
                                                                END;

                                                                IF "Value Entry Type" = "Value Entry Type"::Revaluation THEN
                                                                  "Unit of Measure Code" := Item."Base Unit of Measure";
                                                                VALIDATE("Unit of Measure Code");
                                                                IF "Variant Code" <> '' THEN
                                                                  VALIDATE("Variant Code");

                                                                CheckItemAvailable(FIELDNO("Item No."));

                                                                IF ((NOT ("Order Type" IN ["Order Type"::Production,"Order Type"::Assembly])) OR ("Order No." = '')) AND NOT "Phys. Inventory"
                                                                THEN
                                                                  CreateDim(
                                                                    DATABASE::Item,"Item No.",
                                                                    DATABASE::"Salesperson/Purchaser","Salespers./Purch. Code",
                                                                    DATABASE::"Work Center","Work Center No.");

                                                                ReserveItemJnlLine.VerifyChange(Rec,xRec);
                                                              END;

                                                   CaptionML=[ENU=Item No.;
                                                              NOR=Varenr.] }
    { 4   ;   ;Posting Date        ;Date          ;OnValidate=VAR
                                                                CheckDateConflict@1000 : Codeunit 99000815;
                                                              BEGIN
                                                                VALIDATE("Document Date","Posting Date");
                                                                CheckDateConflict.ItemJnlLineCheck(Rec,CurrFieldNo <> 0);
                                                              END;

                                                   CaptionML=[ENU=Posting Date;
                                                              NOR=Bokf›ringsdato] }
    { 5   ;   ;Entry Type          ;Option        ;OnValidate=BEGIN
                                                                IF NOT ("Entry Type" IN ["Entry Type"::"Positive Adjmt.","Entry Type"::"Negative Adjmt."]) THEN
                                                                  TESTFIELD("Phys. Inventory",FALSE);

                                                                IF CurrFieldNo <> 0 THEN
                                                                  WMSManagement.CheckItemJnlLineFieldChange(Rec,xRec,FIELDCAPTION("Entry Type"));

                                                                CASE "Entry Type" OF
                                                                  "Entry Type"::Purchase:
                                                                    IF UserMgt.GetRespCenter(1,'') <> '' THEN
                                                                      "Location Code" := UserMgt.GetLocation(1,'',UserMgt.GetPurchasesFilter);
                                                                  "Entry Type"::Sale:
                                                                    IF UserMgt.GetRespCenter(0,'') <> '' THEN
                                                                      "Location Code" := UserMgt.GetLocation(0,'',UserMgt.GetSalesFilter);
                                                                  "Entry Type"::Consumption,"Entry Type"::Output:
                                                                    VALIDATE("Order Type","Order Type"::Production);
                                                                  "Entry Type"::"Assembly Consumption","Entry Type"::"Assembly Output":
                                                                    VALIDATE("Order Type","Order Type"::Assembly);
                                                                END;

                                                                IF xRec."Location Code" = '' THEN
                                                                  IF Location.GET("Location Code") THEN
                                                                    IF  Location."Directed Put-away and Pick" THEN
                                                                      "Location Code" := '';

                                                                IF "Item No." <> '' THEN
                                                                  VALIDATE("Location Code");

                                                                VALIDATE("Item No.");
                                                                IF "Entry Type" <> "Entry Type"::Transfer THEN BEGIN
                                                                  "New Location Code" := '';
                                                                  "New Bin Code" := '';
                                                                END;

                                                                IF "Entry Type" <> "Entry Type"::Output THEN
                                                                  Type := Type::" ";

                                                                ReserveItemJnlLine.VerifyChange(Rec,xRec);
                                                              END;

                                                   CaptionML=[ENU=Entry Type;
                                                              NOR=Posttype];
                                                   OptionCaptionML=[ENU=Purchase,Sale,Positive Adjmt.,Negative Adjmt.,Transfer,Consumption,Output, ,Assembly Consumption,Assembly Output;
                                                                    NOR=Kj›p,Salg,Oppjust.,Nedjust.,Overf›ring,Forbruk,Avgang, ,Monteringsforbruk,Monteringsavgang];
                                                   OptionString=Purchase,Sale,Positive Adjmt.,Negative Adjmt.,Transfer,Consumption,Output, ,Assembly Consumption,Assembly Output }
    { 6   ;   ;Source No.          ;Code20        ;TableRelation=IF (Source Type=CONST(Customer)) Customer
                                                                 ELSE IF (Source Type=CONST(Vendor)) Vendor
                                                                 ELSE IF (Source Type=CONST(Item)) Item;
                                                   CaptionML=[ENU=Source No.;
                                                              NOR=Kildenr.];
                                                   Editable=No }
    { 7   ;   ;Document No.        ;Code20        ;CaptionML=[ENU=Document No.;
                                                              NOR=Bilagsnr.] }
    { 8   ;   ;Description         ;Text50        ;CaptionML=[ENU=Description;
                                                              NOR=Beskrivelse] }
    { 9   ;   ;Location Code       ;Code10        ;TableRelation=Location;
                                                   OnValidate=BEGIN
                                                                IF "Entry Type" <= "Entry Type"::Transfer THEN
                                                                  TESTFIELD("Item No.");

                                                                IF ("Value Entry Type" = "Value Entry Type"::"Direct Cost") AND
                                                                   ("Item Charge No." = '') AND
                                                                   ("No." = '')
                                                                THEN BEGIN
                                                                  GetUnitAmount(FIELDNO("Location Code"));
                                                                  "Unit Cost" := UnitCost;
                                                                  VALIDATE("Unit Amount");
                                                                  CheckItemAvailable(FIELDNO("Location Code"));
                                                                END;

                                                                IF "Entry Type" IN ["Entry Type"::Consumption,"Entry Type"::Output] THEN
                                                                  WhseValidateSourceLine.ItemLineVerifyChange(Rec,xRec);

                                                                IF "Location Code" <> xRec."Location Code" THEN BEGIN
                                                                  "Bin Code" := '';
                                                                  IF CurrFieldNo <> 0 THEN
                                                                    WMSManagement.CheckItemJnlLineFieldChange(Rec,xRec,FIELDCAPTION("Location Code"));
                                                                  IF ("Location Code" <> '') AND ("Item No." <> '') THEN BEGIN
                                                                    GetLocation("Location Code");
                                                                    IF Location."Bin Mandatory" AND NOT Location."Directed Put-away and Pick" THEN
                                                                      WMSManagement.GetDefaultBin("Item No.","Variant Code","Location Code","Bin Code");
                                                                  END;
                                                                  IF "Entry Type" = "Entry Type"::Transfer THEN BEGIN
                                                                    "New Location Code" := "Location Code";
                                                                    "New Bin Code" := "Bin Code";
                                                                  END;
                                                                END;

                                                                VALIDATE("Unit of Measure Code");

                                                                ReserveItemJnlLine.VerifyChange(Rec,xRec);
                                                              END;

                                                   CaptionML=[ENU=Location Code;
                                                              NOR=Lokasjonskode] }
    { 10  ;   ;Inventory Posting Group;Code10     ;TableRelation="Inventory Posting Group";
                                                   CaptionML=[ENU=Inventory Posting Group;
                                                              NOR=Bokf›ringsgruppe - lager];
                                                   Editable=No }
    { 11  ;   ;Source Posting Group;Code10        ;TableRelation=IF (Source Type=CONST(Customer)) "Customer Posting Group"
                                                                 ELSE IF (Source Type=CONST(Vendor)) "Vendor Posting Group"
                                                                 ELSE IF (Source Type=CONST(Item)) "Inventory Posting Group";
                                                   CaptionML=[ENU=Source Posting Group;
                                                              NOR=Kildebokf›ringsgruppe];
                                                   Editable=No }
    { 13  ;   ;Quantity            ;Decimal       ;OnValidate=VAR
                                                                CallWhseCheck@1000 : Boolean;
                                                              BEGIN
                                                                IF ("Entry Type" <= "Entry Type"::Transfer) AND (Quantity <> 0) THEN
                                                                  TESTFIELD("Item No.");

                                                                IF NOT PhysInvtEntered THEN
                                                                  TESTFIELD("Phys. Inventory",FALSE);

                                                                CallWhseCheck :=
                                                                  ("Entry Type" = "Entry Type"::"Assembly Consumption") OR
                                                                  ("Entry Type" = "Entry Type"::Consumption) OR
                                                                  ("Entry Type" = "Entry Type"::Output) AND
                                                                  LastOutputOperation(Rec);
                                                                IF CallWhseCheck THEN
                                                                  WhseValidateSourceLine.ItemLineVerifyChange(Rec,xRec);

                                                                IF CurrFieldNo <> 0 THEN
                                                                  WMSManagement.CheckItemJnlLineFieldChange(Rec,xRec,FIELDCAPTION(Quantity));

                                                                "Quantity (Base)" := CalcBaseQty(Quantity);
                                                                IF ("Entry Type" = "Entry Type"::Output) AND
                                                                   ("Value Entry Type" <> "Value Entry Type"::Revaluation)
                                                                THEN
                                                                  "Invoiced Quantity" := 0
                                                                ELSE
                                                                  "Invoiced Quantity" := Quantity;
                                                                "Invoiced Qty. (Base)" := CalcBaseQty("Invoiced Quantity");

                                                                GetUnitAmount(FIELDNO(Quantity));
                                                                UpdateAmount;

                                                                CheckItemAvailable(FIELDNO(Quantity));

                                                                IF "Entry Type" = "Entry Type"::Transfer THEN BEGIN
                                                                  "Qty. (Calculated)" := 0;
                                                                  "Qty. (Phys. Inventory)" := 0;
                                                                  "Last Item Ledger Entry No." := 0;
                                                                END;

                                                                CALCFIELDS("Reserved Qty. (Base)");
                                                                IF ABS("Quantity (Base)") < ABS("Reserved Qty. (Base)") THEN
                                                                  ERROR(Text001,FIELDCAPTION("Reserved Qty. (Base)"));

                                                                IF Item."Item Tracking Code" <> '' THEN
                                                                  ReserveItemJnlLine.VerifyQuantity(Rec,xRec);
                                                              END;

                                                   CaptionML=[ENU=Quantity;
                                                              NOR=Antall];
                                                   DecimalPlaces=0:5 }
    { 15  ;   ;Invoiced Quantity   ;Decimal       ;CaptionML=[ENU=Invoiced Quantity;
                                                              NOR=Fakturert antall];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 16  ;   ;Unit Amount         ;Decimal       ;OnValidate=BEGIN
                                                                UpdateAmount;
                                                                IF "Item No." <> '' THEN BEGIN
                                                                  IF "Value Entry Type" = "Value Entry Type"::Revaluation THEN
                                                                    "Unit Cost" := "Unit Amount"
                                                                  ELSE
                                                                    CASE "Entry Type" OF
                                                                      "Entry Type"::Purchase,
                                                                      "Entry Type"::"Positive Adjmt.",
                                                                      "Entry Type"::"Assembly Output":
                                                                        BEGIN
                                                                          IF "Entry Type" = "Entry Type"::"Positive Adjmt." THEN BEGIN
                                                                            GetItem;
                                                                            IF (CurrFieldNo = FIELDNO("Unit Amount")) AND
                                                                               (Item."Costing Method" = Item."Costing Method"::Standard)
                                                                            THEN
                                                                              ERROR(
                                                                                Text002,
                                                                                FIELDCAPTION("Unit Amount"),Item.FIELDCAPTION("Costing Method"),Item."Costing Method");
                                                                          END;

                                                                          ReadGLSetup;
                                                                          IF "Entry Type" = "Entry Type"::Purchase THEN
                                                                            "Unit Cost" := "Unit Amount";
                                                                          IF "Entry Type" = "Entry Type"::"Positive Adjmt." THEN
                                                                            "Unit Cost" :=
                                                                              ROUND(
                                                                                "Unit Amount" * (1 + "Indirect Cost %" / 100),GLSetup."Unit-Amount Rounding Precision") +
                                                                              "Overhead Rate" * "Qty. per Unit of Measure";
                                                                          IF ("Value Entry Type" = "Value Entry Type"::"Direct Cost") AND
                                                                             ("Item Charge No." = '')
                                                                          THEN
                                                                            VALIDATE("Unit Cost");
                                                                        END;
                                                                      "Entry Type"::"Negative Adjmt.",
                                                                      "Entry Type"::Consumption,
                                                                      "Entry Type"::"Assembly Consumption":
                                                                        BEGIN
                                                                          GetItem;
                                                                          IF (CurrFieldNo = FIELDNO("Unit Amount")) AND
                                                                             (Item."Costing Method" = Item."Costing Method"::Standard)
                                                                          THEN
                                                                            ERROR(
                                                                              Text002,
                                                                              FIELDCAPTION("Unit Amount"),Item.FIELDCAPTION("Costing Method"),Item."Costing Method");
                                                                          "Unit Cost" := "Unit Amount";
                                                                          IF ("Value Entry Type" = "Value Entry Type"::"Direct Cost") AND
                                                                             ("Item Charge No." = '')
                                                                          THEN
                                                                            VALIDATE("Unit Cost");
                                                                        END;
                                                                    END;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Unit Amount;
                                                              NOR=Enhetsbel›p];
                                                   AutoFormatType=2 }
    { 17  ;   ;Unit Cost           ;Decimal       ;OnValidate=BEGIN
                                                                TESTFIELD("Item No.");
                                                                RetrieveCosts;
                                                                IF "Entry Type" IN ["Entry Type"::Purchase,"Entry Type"::"Positive Adjmt.","Entry Type"::Consumption] THEN BEGIN
                                                                  IF Item."Costing Method" = Item."Costing Method"::Standard THEN BEGIN
                                                                    IF CurrFieldNo = FIELDNO("Unit Cost") THEN
                                                                      ERROR(
                                                                        Text002,
                                                                        FIELDCAPTION("Unit Cost"),Item.FIELDCAPTION("Costing Method"),Item."Costing Method");
                                                                    "Unit Cost" := ROUND(UnitCost * "Qty. per Unit of Measure",GLSetup."Unit-Amount Rounding Precision");
                                                                  END;
                                                                END;

                                                                IF ("Item Charge No." = '') AND
                                                                   ("Value Entry Type" = "Value Entry Type"::"Direct Cost") AND
                                                                   (CurrFieldNo = FIELDNO("Unit Cost"))
                                                                THEN BEGIN
                                                                  CASE "Entry Type" OF
                                                                    "Entry Type"::Purchase:
                                                                      "Unit Amount" := "Unit Cost";
                                                                    "Entry Type"::"Positive Adjmt.",
                                                                    "Entry Type"::"Assembly Output":
                                                                      BEGIN
                                                                        ReadGLSetup;
                                                                        "Unit Amount" :=
                                                                          ROUND(
                                                                            ("Unit Cost" - "Overhead Rate" * "Qty. per Unit of Measure") / (1 + "Indirect Cost %" / 100),
                                                                            GLSetup."Unit-Amount Rounding Precision")
                                                                      END;
                                                                    "Entry Type"::"Negative Adjmt.",
                                                                    "Entry Type"::Consumption,
                                                                    "Entry Type"::"Assembly Consumption":
                                                                      BEGIN
                                                                        IF Item."Costing Method" = Item."Costing Method"::Standard THEN
                                                                          ERROR(
                                                                            Text002,
                                                                            FIELDCAPTION("Unit Cost"),Item.FIELDCAPTION("Costing Method"),Item."Costing Method");
                                                                        "Unit Amount" := "Unit Cost";
                                                                      END;
                                                                  END;
                                                                  UpdateAmount;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Unit Cost;
                                                              NOR=Enhetskost];
                                                   AutoFormatType=2 }
    { 18  ;   ;Amount              ;Decimal       ;OnValidate=BEGIN
                                                                TESTFIELD(Quantity);
                                                                "Unit Amount" := Amount / Quantity;
                                                                VALIDATE("Unit Amount");
                                                                ReadGLSetup;
                                                                "Unit Amount" := ROUND("Unit Amount",GLSetup."Unit-Amount Rounding Precision");
                                                              END;

                                                   CaptionML=[ENU=Amount;
                                                              NOR=Bel›p];
                                                   AutoFormatType=1 }
    { 22  ;   ;Discount Amount     ;Decimal       ;CaptionML=[ENU=Discount Amount;
                                                              NOR=Rabattbel›p];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 23  ;   ;Salespers./Purch. Code;Code10      ;TableRelation=Salesperson/Purchaser;
                                                   OnValidate=BEGIN
                                                                IF ("Order Type" <> "Order Type"::Production) OR ("Order No." = '') THEN
                                                                  CreateDim(
                                                                    DATABASE::"Salesperson/Purchaser","Salespers./Purch. Code",
                                                                    DATABASE::Item,"Item No.",
                                                                    DATABASE::"Work Center","Work Center No.");
                                                              END;

                                                   CaptionML=[ENU=Salespers./Purch. Code;
                                                              NOR=Selger/innkj›per - kode] }
    { 26  ;   ;Source Code         ;Code10        ;TableRelation="Source Code";
                                                   CaptionML=[ENU=Source Code;
                                                              NOR=Kildespor];
                                                   Editable=No }
    { 29  ;   ;Applies-to Entry    ;Integer       ;OnValidate=VAR
                                                                ItemLedgEntry@1000 : Record 32;
                                                                ItemTrackingLines@1001 : Page 6510;
                                                              BEGIN
                                                                IF "Applies-to Entry" <> 0 THEN BEGIN
                                                                  ItemLedgEntry.GET("Applies-to Entry");

                                                                  IF "Value Entry Type" = "Value Entry Type"::Revaluation THEN BEGIN
                                                                    IF "Inventory Value Per" <> "Inventory Value Per"::" " THEN
                                                                      ERROR(Text006,FIELDCAPTION("Applies-to Entry"));

                                                                    IF "Inventory Value Per" = "Inventory Value Per"::" " THEN
                                                                      IF NOT RevaluationPerEntryAllowed(Item."No.") THEN
                                                                        ERROR(Text034);

                                                                    InitRevalJnlLine(ItemLedgEntry);
                                                                    ItemLedgEntry.TESTFIELD(Positive,TRUE);
                                                                  END ELSE BEGIN
                                                                    TESTFIELD(Quantity);
                                                                    IF Signed(Quantity) * ItemLedgEntry.Quantity > 0 THEN BEGIN
                                                                      IF Quantity > 0 THEN
                                                                        FIELDERROR(Quantity,Text030);
                                                                      IF Quantity < 0 THEN
                                                                        FIELDERROR(Quantity,Text029);
                                                                    END;
                                                                    IF ItemLedgEntry.TrackingExists THEN
                                                                      ERROR(Text033,FIELDCAPTION("Applies-to Entry"),ItemTrackingLines.CAPTION);

                                                                    IF NOT ItemLedgEntry.Open THEN
                                                                      MESSAGE(Text032,"Applies-to Entry");

                                                                    IF "Entry Type" = "Entry Type"::Output THEN BEGIN
                                                                      ItemLedgEntry.TESTFIELD("Order Type","Order Type"::Production);
                                                                      ItemLedgEntry.TESTFIELD("Order No.","Order No.");
                                                                      ItemLedgEntry.TESTFIELD("Order Line No.","Order Line No.");
                                                                      ItemLedgEntry.TESTFIELD("Entry Type","Entry Type");
                                                                    END;
                                                                  END;

                                                                  "Location Code" := ItemLedgEntry."Location Code";
                                                                  "Variant Code" := ItemLedgEntry."Variant Code";
                                                                END ELSE BEGIN
                                                                  IF "Value Entry Type" = "Value Entry Type"::Revaluation THEN BEGIN
                                                                    VALIDATE("Unit Amount",0);
                                                                    VALIDATE(Quantity,0);
                                                                    "Inventory Value (Calculated)" := 0;
                                                                    "Inventory Value (Revalued)" := 0;
                                                                    "Location Code" := '';
                                                                    "Variant Code" := '';
                                                                    "Bin Code" := '';
                                                                  END;
                                                                END;
                                                              END;

                                                   OnLookup=BEGIN
                                                              SelectItemEntry(FIELDNO("Applies-to Entry"));
                                                            END;

                                                   CaptionML=[ENU=Applies-to Entry;
                                                              NOR=Utligningspost] }
    { 32  ;   ;Item Shpt. Entry No.;Integer       ;CaptionML=[ENU=Item Shpt. Entry No.;
                                                              NOR=Varelev.l›penr.];
                                                   Editable=No }
    { 34  ;   ;Shortcut Dimension 1 Code;Code20   ;TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(1));
                                                   OnValidate=BEGIN
                                                                ValidateShortcutDimCode(1,"Shortcut Dimension 1 Code");
                                                              END;

                                                   CaptionML=[ENU=Shortcut Dimension 1 Code;
                                                              NOR=Snarveisdimensjon 1 - kode];
                                                   CaptionClass='1,2,1' }
    { 35  ;   ;Shortcut Dimension 2 Code;Code20   ;TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(2));
                                                   OnValidate=BEGIN
                                                                ValidateShortcutDimCode(2,"Shortcut Dimension 2 Code");
                                                              END;

                                                   CaptionML=[ENU=Shortcut Dimension 2 Code;
                                                              NOR=Snarveisdimensjon 2 - kode];
                                                   CaptionClass='1,2,2' }
    { 37  ;   ;Indirect Cost %     ;Decimal       ;OnValidate=BEGIN
                                                                TESTFIELD("Item No.");
                                                                TESTFIELD("Value Entry Type","Value Entry Type"::"Direct Cost");
                                                                TESTFIELD("Item Charge No.",'');
                                                                IF "Entry Type" IN ["Entry Type"::Sale,"Entry Type"::"Negative Adjmt."] THEN
                                                                  ERROR(
                                                                    Text002,
                                                                    FIELDCAPTION("Indirect Cost %"),FIELDCAPTION("Entry Type"),"Entry Type");

                                                                GetItem;
                                                                IF Item."Costing Method" = Item."Costing Method"::Standard THEN
                                                                  ERROR(
                                                                    Text002,
                                                                    FIELDCAPTION("Indirect Cost %"),Item.FIELDCAPTION("Costing Method"),Item."Costing Method");

                                                                IF "Entry Type" <> "Entry Type"::Purchase THEN
                                                                  "Unit Cost" :=
                                                                    ROUND(
                                                                      "Unit Amount" * (1 + "Indirect Cost %" / 100) +
                                                                      "Overhead Rate" * "Qty. per Unit of Measure",GLSetup."Unit-Amount Rounding Precision");
                                                              END;

                                                   CaptionML=[ENU=Indirect Cost %;
                                                              NOR=Indirekte kost-%];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
    { 39  ;   ;Source Type         ;Option        ;CaptionML=[ENU=Source Type;
                                                              NOR=Kildetype];
                                                   OptionCaptionML=[ENU=" ,Customer,Vendor,Item";
                                                                    NOR=" ,Kunde,Leverand›r,Vare"];
                                                   OptionString=[ ,Customer,Vendor,Item];
                                                   Editable=No }
    { 41  ;   ;Journal Batch Name  ;Code10        ;TableRelation="Item Journal Batch".Name WHERE (Journal Template Name=FIELD(Journal Template Name));
                                                   CaptionML=[ENU=Journal Batch Name;
                                                              NOR=Kladdenavn] }
    { 42  ;   ;Reason Code         ;Code10        ;TableRelation="Reason Code";
                                                   CaptionML=[ENU=Reason Code;
                                                              NOR=rsaksspor] }
    { 43  ;   ;Recurring Method    ;Option        ;CaptionML=[ENU=Recurring Method;
                                                              NOR=Gjentakelsesprinsipp];
                                                   OptionCaptionML=[ENU=,Fixed,Variable;
                                                                    NOR=,Fast,Variabel];
                                                   OptionString=,Fixed,Variable;
                                                   BlankZero=Yes }
    { 44  ;   ;Expiration Date     ;Date          ;CaptionML=[ENU=Expiration Date;
                                                              NOR=Utg†r den] }
    { 45  ;   ;Recurring Frequency ;DateFormula   ;CaptionML=[ENU=Recurring Frequency;
                                                              NOR=Gjentakelsesintervall] }
    { 46  ;   ;Drop Shipment       ;Boolean       ;AccessByPermission=TableData 223=R;
                                                   CaptionML=[ENU=Drop Shipment;
                                                              NOR=Direkte levering];
                                                   Editable=No }
    { 47  ;   ;Transaction Type    ;Code10        ;TableRelation="Transaction Type";
                                                   CaptionML=[ENU=Transaction Type;
                                                              NOR=Transaksjonsart] }
    { 48  ;   ;Transport Method    ;Code10        ;TableRelation="Transport Method";
                                                   CaptionML=[ENU=Transport Method;
                                                              NOR=Transportm†te] }
    { 49  ;   ;Country/Region Code ;Code10        ;TableRelation=Country/Region;
                                                   CaptionML=[ENU=Country/Region Code;
                                                              NOR=Lands-/regionkode] }
    { 50  ;   ;New Location Code   ;Code10        ;TableRelation=Location;
                                                   OnValidate=BEGIN
                                                                TESTFIELD("Entry Type","Entry Type"::Transfer);
                                                                IF "New Location Code" <> xRec."New Location Code" THEN BEGIN
                                                                  "New Bin Code" := '';
                                                                  IF ("New Location Code" <> '') AND ("Item No." <> '') THEN BEGIN
                                                                    GetLocation("New Location Code");
                                                                    IF Location."Bin Mandatory" AND NOT Location."Directed Put-away and Pick" THEN
                                                                      WMSManagement.GetDefaultBin("Item No.","Variant Code","New Location Code","New Bin Code")
                                                                  END;
                                                                END;

                                                                ReserveItemJnlLine.VerifyChange(Rec,xRec);
                                                              END;

                                                   CaptionML=[ENU=New Location Code;
                                                              NOR=Ny lokasjonskode] }
    { 51  ;   ;New Shortcut Dimension 1 Code;Code20;
                                                   TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(1));
                                                   OnValidate=BEGIN
                                                                TESTFIELD("Entry Type","Entry Type"::Transfer);
                                                                ValidateNewShortcutDimCode(1,"New Shortcut Dimension 1 Code");
                                                              END;

                                                   CaptionML=[ENU=New Shortcut Dimension 1 Code;
                                                              NOR=Ny snarveisdimensj. 1 - kode];
                                                   CaptionClass='1,2,1,' + Text007 }
    { 52  ;   ;New Shortcut Dimension 2 Code;Code20;
                                                   TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(2));
                                                   OnValidate=BEGIN
                                                                TESTFIELD("Entry Type","Entry Type"::Transfer);
                                                                ValidateNewShortcutDimCode(2,"New Shortcut Dimension 2 Code");
                                                              END;

                                                   CaptionML=[ENU=New Shortcut Dimension 2 Code;
                                                              NOR=Ny snarveisdimensj. 2 - kode];
                                                   CaptionClass='1,2,2,' + Text007 }
    { 53  ;   ;Qty. (Calculated)   ;Decimal       ;OnValidate=BEGIN
                                                                VALIDATE("Qty. (Phys. Inventory)");
                                                              END;

                                                   CaptionML=[ENU=Qty. (Calculated);
                                                              NOR=Antall (beregnet)];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 54  ;   ;Qty. (Phys. Inventory);Decimal     ;OnValidate=BEGIN
                                                                TESTFIELD("Phys. Inventory",TRUE);

                                                                IF CurrFieldNo <> 0 THEN
                                                                  WMSManagement.CheckItemJnlLineFieldChange(Rec,xRec,FIELDCAPTION("Qty. (Phys. Inventory)"));

                                                                PhysInvtEntered := TRUE;
                                                                Quantity := 0;
                                                                IF "Qty. (Phys. Inventory)" >= "Qty. (Calculated)" THEN BEGIN
                                                                  VALIDATE("Entry Type","Entry Type"::"Positive Adjmt.");
                                                                  VALIDATE(Quantity,"Qty. (Phys. Inventory)" - "Qty. (Calculated)");
                                                                END ELSE BEGIN
                                                                  VALIDATE("Entry Type","Entry Type"::"Negative Adjmt.");
                                                                  VALIDATE(Quantity,"Qty. (Calculated)" - "Qty. (Phys. Inventory)");
                                                                END;
                                                                PhysInvtEntered := FALSE;
                                                              END;

                                                   CaptionML=[ENU=Qty. (Phys. Inventory);
                                                              NOR=Antall (opptalt)];
                                                   DecimalPlaces=0:5 }
    { 55  ;   ;Last Item Ledger Entry No.;Integer ;TableRelation="Item Ledger Entry";
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Last Item Ledger Entry No.;
                                                              NOR=Siste varepostnr.];
                                                   Editable=No }
    { 56  ;   ;Phys. Inventory     ;Boolean       ;CaptionML=[ENU=Phys. Inventory;
                                                              NOR=Vareopptelling];
                                                   Editable=No }
    { 57  ;   ;Gen. Bus. Posting Group;Code10     ;TableRelation="Gen. Business Posting Group";
                                                   CaptionML=[ENU=Gen. Bus. Posting Group;
                                                              NOR=Bokf›ringsgruppe - firma] }
    { 58  ;   ;Gen. Prod. Posting Group;Code10    ;TableRelation="Gen. Product Posting Group";
                                                   CaptionML=[ENU=Gen. Prod. Posting Group;
                                                              NOR=Bokf›ringsgruppe - vare] }
    { 59  ;   ;Entry/Exit Point    ;Code10        ;TableRelation="Entry/Exit Point";
                                                   CaptionML=[ENU=Entry/Exit Point;
                                                              NOR=Inn/Utpunkt] }
    { 60  ;   ;Document Date       ;Date          ;CaptionML=[ENU=Document Date;
                                                              NOR=Bilagsdato] }
    { 62  ;   ;External Document No.;Code35       ;CaptionML=[ENU=External Document No.;
                                                              NOR=Eksterndokumentnr.] }
    { 63  ;   ;Area                ;Code10        ;TableRelation=Area;
                                                   CaptionML=[ENU=Area;
                                                              NOR=Omr†de] }
    { 64  ;   ;Transaction Specification;Code10   ;TableRelation="Transaction Specification";
                                                   CaptionML=[ENU=Transaction Specification;
                                                              NOR=Transaksjonsspesifikasjon] }
    { 65  ;   ;Posting No. Series  ;Code10        ;TableRelation="No. Series";
                                                   CaptionML=[ENU=Posting No. Series;
                                                              NOR=Bokf›ringsnr.serie] }
    { 68  ;   ;Reserved Quantity   ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Reservation Entry".Quantity WHERE (Source ID=FIELD(Journal Template Name),
                                                                                                       Source Ref. No.=FIELD(Line No.),
                                                                                                       Source Type=CONST(83),
                                                                                                       Source Subtype=FIELD(Entry Type),
                                                                                                       Source Batch Name=FIELD(Journal Batch Name),
                                                                                                       Source Prod. Order Line=CONST(0),
                                                                                                       Reservation Status=CONST(Reservation)));
                                                   AccessByPermission=TableData 120=R;
                                                   CaptionML=[ENU=Reserved Quantity;
                                                              NOR=Reservert antall];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 72  ;   ;Unit Cost (ACY)     ;Decimal       ;CaptionML=[ENU=Unit Cost (ACY);
                                                              NOR=Enhetskost (t.val)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 73  ;   ;Source Currency Code;Code10        ;TableRelation=Currency;
                                                   AccessByPermission=TableData 223=R;
                                                   CaptionML=[ENU=Source Currency Code;
                                                              NOR=Kildevalutakode];
                                                   Editable=No }
    { 79  ;   ;Document Type       ;Option        ;CaptionML=[ENU=Document Type;
                                                              NOR=Bilagstype];
                                                   OptionCaptionML=[ENU=" ,Sales Shipment,Sales Invoice,Sales Return Receipt,Sales Credit Memo,Purchase Receipt,Purchase Invoice,Purchase Return Shipment,Purchase Credit Memo,Transfer Shipment,Transfer Receipt,Service Shipment,Service Invoice,Service Credit Memo,Posted Assembly";
                                                                    NOR=" ,F›lgeseddel,Salgsfaktura,Salgsreturseddel,Salgskreditnota,Kj›psmottak,Kj›psfaktura,Bestillingsreturforsendelse,Kj›pskreditnota,Overf›ringsseddel,Overf›ringsmottak,Servicef›lgeseddel,Servicefaktura,Salgskreditnota (service),Bokf›rt montering"];
                                                   OptionString=[ ,Sales Shipment,Sales Invoice,Sales Return Receipt,Sales Credit Memo,Purchase Receipt,Purchase Invoice,Purchase Return Shipment,Purchase Credit Memo,Transfer Shipment,Transfer Receipt,Service Shipment,Service Invoice,Service Credit Memo,Posted Assembly] }
    { 80  ;   ;Document Line No.   ;Integer       ;CaptionML=[ENU=Document Line No.;
                                                              NOR=Dokumentlinjenr.] }
    { 90  ;   ;Order Type          ;Option        ;OnValidate=BEGIN
                                                                IF "Order Type" = xRec."Order Type" THEN
                                                                  EXIT;
                                                                VALIDATE("Order No.",'');
                                                                "Order Line No." := 0;
                                                              END;

                                                   CaptionML=[ENU=Order Type;
                                                              NOR=Ordretype];
                                                   OptionCaptionML=[ENU=" ,Production,Transfer,Service,Assembly";
                                                                    NOR=" ,Produksjon,Overf›ring,Service,Montering"];
                                                   OptionString=[ ,Production,Transfer,Service,Assembly];
                                                   Editable=No }
    { 91  ;   ;Order No.           ;Code20        ;TableRelation=IF (Order Type=CONST(Production)) "Production Order".No. WHERE (Status=CONST(Released));
                                                   OnValidate=VAR
                                                                AssemblyHeader@1000 : Record 900;
                                                                ProdOrder@1001 : Record 5405;
                                                                ProdOrderLine@1002 : Record 5406;
                                                              BEGIN
                                                                CASE "Order Type" OF
                                                                  "Order Type"::Production,"Order Type"::Assembly:
                                                                    BEGIN
                                                                      IF "Order No." = '' THEN BEGIN
                                                                        CASE "Order Type" OF
                                                                          "Order Type"::Production:
                                                                            CreateProdDim;
                                                                          "Order Type"::Assembly:
                                                                            CreateAssemblyDim;
                                                                        END;
                                                                        EXIT;
                                                                      END;

                                                                      CASE "Order Type" OF
                                                                        "Order Type"::Production:
                                                                          BEGIN
                                                                            GetMfgSetup;
                                                                            IF MfgSetup."Doc. No. Is Prod. Order No." THEN
                                                                              "Document No." := "Order No.";
                                                                            ProdOrder.GET(ProdOrder.Status::Released,"Order No.");
                                                                            ProdOrder.TESTFIELD(Blocked,FALSE);
                                                                            Description := ProdOrder.Description;
                                                                          END;
                                                                        "Order Type"::Assembly:
                                                                          BEGIN
                                                                            AssemblyHeader.GET(AssemblyHeader."Document Type"::Order,"Order No.");
                                                                            Description := AssemblyHeader.Description;
                                                                          END;
                                                                      END;

                                                                      "Gen. Bus. Posting Group" := '';
                                                                      CASE TRUE OF
                                                                        "Entry Type" = "Entry Type"::Output:
                                                                          BEGIN
                                                                            "Inventory Posting Group" := ProdOrder."Inventory Posting Group";
                                                                            "Gen. Prod. Posting Group" := ProdOrder."Gen. Prod. Posting Group";
                                                                          END;
                                                                        "Entry Type" = "Entry Type"::"Assembly Output":
                                                                          BEGIN
                                                                            "Inventory Posting Group" := AssemblyHeader."Inventory Posting Group";
                                                                            "Gen. Prod. Posting Group" := AssemblyHeader."Gen. Prod. Posting Group";
                                                                          END;
                                                                        "Entry Type" = "Entry Type"::Consumption:
                                                                          BEGIN
                                                                            ProdOrderLine.SetFilterByReleasedOrderNo("Order No.");
                                                                            IF ProdOrderLine.COUNT = 1 THEN BEGIN
                                                                              ProdOrderLine.FINDFIRST;
                                                                              VALIDATE("Order Line No.",ProdOrderLine."Line No.");
                                                                            END;
                                                                          END;
                                                                      END;

                                                                      IF ("Order No." <> xRec."Order No.") OR ("Order Type" <> xRec."Order Type") THEN
                                                                        CASE "Order Type" OF
                                                                          "Order Type"::Production:
                                                                            CreateProdDim;
                                                                          "Order Type"::Assembly:
                                                                            CreateAssemblyDim;
                                                                        END;
                                                                    END;
                                                                  "Order Type"::Transfer,"Order Type"::Service,"Order Type"::" ":
                                                                    ERROR(Text002,FIELDCAPTION("Order No."),FIELDCAPTION("Order Type"),"Order Type");
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Order No.;
                                                              NOR=Ordrenr.] }
    { 92  ;   ;Order Line No.      ;Integer       ;TableRelation=IF (Order Type=CONST(Production)) "Prod. Order Line"."Line No." WHERE (Status=CONST(Released),
                                                                                                                                        Prod. Order No.=FIELD(Order No.));
                                                   OnValidate=VAR
                                                                ProdOrderLine@1000 : Record 5406;
                                                              BEGIN
                                                                TESTFIELD("Order No.");
                                                                CASE "Order Type" OF
                                                                  "Order Type"::Production,"Order Type"::Assembly:
                                                                    BEGIN
                                                                      IF "Order Type" = "Order Type"::Production THEN BEGIN
                                                                        ProdOrderLine.SetFilterByReleasedOrderNo("Order No.");
                                                                        ProdOrderLine.SETRANGE("Line No.","Order Line No.");
                                                                        IF ProdOrderLine.FINDFIRST THEN BEGIN
                                                                          "Source Type" := "Source Type"::Item;
                                                                          "Source No." := ProdOrderLine."Item No.";
                                                                          "Order Line No." := ProdOrderLine."Line No.";
                                                                          "Routing No." := ProdOrderLine."Routing No.";
                                                                          "Routing Reference No." := ProdOrderLine."Routing Reference No.";
                                                                          IF "Entry Type" = "Entry Type"::Output THEN BEGIN
                                                                            "Location Code" := ProdOrderLine."Location Code";
                                                                            "Bin Code" := ProdOrderLine."Bin Code";
                                                                          END;
                                                                        END;
                                                                      END;

                                                                      IF "Order Line No." <> xRec."Order Line No." THEN
                                                                        CASE "Order Type" OF
                                                                          "Order Type"::Production:
                                                                            CreateProdDim;
                                                                          "Order Type"::Assembly:
                                                                            CreateAssemblyDim;
                                                                        END;
                                                                    END;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Order Line No.;
                                                              NOR=Ordrelinjenr.] }
    { 480 ;   ;Dimension Set ID    ;Integer       ;TableRelation="Dimension Set Entry";
                                                   OnLookup=BEGIN
                                                              ShowDimensions;
                                                            END;

                                                   CaptionML=[ENU=Dimension Set ID;
                                                              NOR=Dimensjonssett-ID];
                                                   Editable=No }
    { 481 ;   ;New Dimension Set ID;Integer       ;TableRelation="Dimension Set Entry";
                                                   OnLookup=BEGIN
                                                              ShowDimensions;
                                                            END;

                                                   CaptionML=[ENU=New Dimension Set ID;
                                                              NOR=Ny dimensjonssett-ID];
                                                   Editable=No }
    { 904 ;   ;Assemble to Order   ;Boolean       ;CaptionML=[ENU=Assemble to Order;
                                                              NOR=Monter til ordre];
                                                   Editable=No }
    { 1000;   ;Job No.             ;Code20        ;CaptionML=[ENU=Job No.;
                                                              NOR=Prosjektnr.] }
    { 1001;   ;Job Task No.        ;Code20        ;CaptionML=[ENU=Job Task No.;
                                                              NOR=Prosjektoppgavenr.] }
    { 1002;   ;Job Purchase        ;Boolean       ;CaptionML=[ENU=Job Purchase;
                                                              NOR=Prosjektkj›p] }
    { 1030;   ;Job Contract Entry No.;Integer     ;CaptionML=[ENU=Job Contract Entry No.;
                                                              NOR=L›penr. for prosjektkontrakt];
                                                   Editable=No }
    { 5402;   ;Variant Code        ;Code10        ;TableRelation="Item Variant".Code WHERE (Item No.=FIELD(Item No.));
                                                   OnValidate=BEGIN
                                                                IF "Entry Type" IN ["Entry Type"::Consumption,"Entry Type"::Output] THEN
                                                                  WhseValidateSourceLine.ItemLineVerifyChange(Rec,xRec);

                                                                IF "Variant Code" <> xRec."Variant Code" THEN BEGIN
                                                                  "Bin Code" := '';
                                                                  IF CurrFieldNo <> 0 THEN
                                                                    WMSManagement.CheckItemJnlLineFieldChange(Rec,xRec,FIELDCAPTION("Variant Code"));
                                                                  IF ("Location Code" <> '') AND ("Item No." <> '') THEN BEGIN
                                                                    GetLocation("Location Code");
                                                                    IF Location."Bin Mandatory" AND NOT Location."Directed Put-away and Pick" THEN
                                                                      WMSManagement.GetDefaultBin("Item No.","Variant Code","Location Code","Bin Code")
                                                                  END;
                                                                  IF ("Entry Type" = "Entry Type"::Transfer) AND ("Location Code" = "New Location Code") THEN
                                                                    "New Bin Code" := "Bin Code";
                                                                END;
                                                                IF ("Value Entry Type" = "Value Entry Type"::"Direct Cost") AND
                                                                   ("Item Charge No." = '')
                                                                THEN BEGIN
                                                                  GetUnitAmount(FIELDNO("Variant Code"));
                                                                  "Unit Cost" := UnitCost;
                                                                  VALIDATE("Unit Amount");
                                                                  VALIDATE("Unit of Measure Code");
                                                                  ReserveItemJnlLine.VerifyChange(Rec,xRec);
                                                                END;

                                                                IF "Variant Code" <> '' THEN BEGIN
                                                                  ItemVariant.GET("Item No.","Variant Code");
                                                                  Description := ItemVariant.Description;
                                                                END ELSE BEGIN
                                                                  GetItem;
                                                                  Description := Item.Description;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Variant Code;
                                                              NOR=Variantkode] }
    { 5403;   ;Bin Code            ;Code20        ;TableRelation=IF (Entry Type=FILTER(Purchase|Positive Adjmt.|Output),
                                                                     Quantity=FILTER(>=0)) Bin.Code WHERE (Location Code=FIELD(Location Code),
                                                                                                           Item Filter=FIELD(Item No.),
                                                                                                           Variant Filter=FIELD(Variant Code))
                                                                                                           ELSE IF (Entry Type=FILTER(Purchase|Positive Adjmt.|Output),
                                                                                                                    Quantity=FILTER(<0)) "Bin Content"."Bin Code" WHERE (Location Code=FIELD(Location Code),
                                                                                                                                                                         Item No.=FIELD(Item No.),
                                                                                                                                                                         Variant Code=FIELD(Variant Code))
                                                                                                                                                                         ELSE IF (Entry Type=FILTER(Sale|Negative Adjmt.|Transfer|Consumption),
                                                                                                                                                                                  Quantity=FILTER(>0)) "Bin Content"."Bin Code" WHERE (Location Code=FIELD(Location Code),
                                                                                                                                                                                                                                       Item No.=FIELD(Item No.),
                                                                                                                                                                                                                                       Variant Code=FIELD(Variant Code))
                                                                                                                                                                                                                                       ELSE IF (Entry Type=FILTER(Sale|Negative Adjmt.|Transfer|Consumption),
                                                                                                                                                                                                                                                Quantity=FILTER(<=0)) Bin.Code WHERE (Location Code=FIELD(Location Code),
                                                                                                                                                                                                                                                                                      Item Filter=FIELD(Item No.),
                                                                                                                                                                                                                                                                                      Variant Filter=FIELD(Variant Code));
                                                   OnValidate=VAR
                                                                ProdOrderComp@1001 : Record 5407;
                                                                WhseIntegrationMgt@1000 : Codeunit 7317;
                                                              BEGIN
                                                                IF "Bin Code" <> xRec."Bin Code" THEN BEGIN
                                                                  TESTFIELD("Location Code");
                                                                  IF "Bin Code" <> '' THEN BEGIN
                                                                    GetBin("Location Code","Bin Code");
                                                                    GetLocation("Location Code");
                                                                    Location.TESTFIELD("Bin Mandatory");
                                                                    IF CurrFieldNo <> 0 THEN
                                                                      WMSManagement.CheckItemJnlLineFieldChange(Rec,xRec,FIELDCAPTION("Bin Code"));
                                                                    TESTFIELD("Location Code",Bin."Location Code");
                                                                    WhseIntegrationMgt.CheckBinTypeCode(DATABASE::"Item Journal Line",
                                                                      FIELDCAPTION("Bin Code"),
                                                                      "Location Code",
                                                                      "Bin Code",
                                                                      "Entry Type");
                                                                  END;
                                                                  IF ("Entry Type" = "Entry Type"::Transfer) AND ("Location Code" = "New Location Code") THEN
                                                                    "New Bin Code" := "Bin Code";

                                                                  IF ("Entry Type" = "Entry Type"::Consumption) AND
                                                                     ("Bin Code" <> '') AND ("Prod. Order Comp. Line No." <> 0)
                                                                  THEN BEGIN
                                                                    TESTFIELD("Order Type","Order Type"::Production);
                                                                    TESTFIELD("Order No.");
                                                                    ProdOrderComp.GET(ProdOrderComp.Status::Released,"Order No.","Order Line No.","Prod. Order Comp. Line No.");
                                                                    IF (ProdOrderComp."Bin Code" <> '') AND (ProdOrderComp."Bin Code" <> "Bin Code") THEN
                                                                      IF NOT CONFIRM(
                                                                           Text021,
                                                                           FALSE,
                                                                           "Bin Code",
                                                                           ProdOrderComp."Bin Code",
                                                                           "Order No.")
                                                                      THEN
                                                                        ERROR(Text012);
                                                                  END;
                                                                END;

                                                                ReserveItemJnlLine.VerifyChange(Rec,xRec);
                                                              END;

                                                   CaptionML=[ENU=Bin Code;
                                                              NOR=Hyllekode] }
    { 5404;   ;Qty. per Unit of Measure;Decimal   ;InitValue=1;
                                                   CaptionML=[ENU=Qty. per Unit of Measure;
                                                              NOR=Antall per enhet];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 5406;   ;New Bin Code        ;Code20        ;TableRelation=Bin.Code WHERE (Location Code=FIELD(New Location Code),
                                                                                 Item Filter=FIELD(Item No.),
                                                                                 Variant Filter=FIELD(Variant Code));
                                                   OnValidate=VAR
                                                                WhseIntegrationMgt@1000 : Codeunit 7317;
                                                              BEGIN
                                                                TESTFIELD("Entry Type","Entry Type"::Transfer);
                                                                IF "New Bin Code" <> xRec."New Bin Code" THEN BEGIN
                                                                  TESTFIELD("New Location Code");
                                                                  IF "New Bin Code" <> '' THEN BEGIN
                                                                    GetBin("New Location Code","New Bin Code");
                                                                    GetLocation("New Location Code");
                                                                    Location.TESTFIELD("Bin Mandatory");
                                                                    IF CurrFieldNo <> 0 THEN
                                                                      WMSManagement.CheckItemJnlLineFieldChange(Rec,xRec,FIELDCAPTION("New Bin Code"));
                                                                    TESTFIELD("New Location Code",Bin."Location Code");
                                                                    WhseIntegrationMgt.CheckBinTypeCode(DATABASE::"Item Journal Line",
                                                                      FIELDCAPTION("New Bin Code"),
                                                                      "New Location Code",
                                                                      "New Bin Code",
                                                                      "Entry Type");
                                                                  END;
                                                                END;

                                                                ReserveItemJnlLine.VerifyChange(Rec,xRec);
                                                              END;

                                                   CaptionML=[ENU=New Bin Code;
                                                              NOR=Ny hyllekode] }
    { 5407;   ;Unit of Measure Code;Code10        ;TableRelation="Item Unit of Measure".Code WHERE (Item No.=FIELD(Item No.));
                                                   OnValidate=BEGIN
                                                                GetItem;
                                                                "Qty. per Unit of Measure" := UOMMgt.GetQtyPerUnitOfMeasure(Item,"Unit of Measure Code");

                                                                IF "Entry Type" IN ["Entry Type"::Consumption,"Entry Type"::Output] THEN
                                                                  WhseValidateSourceLine.ItemLineVerifyChange(Rec,xRec);

                                                                IF CurrFieldNo <> 0 THEN
                                                                  WMSManagement.CheckItemJnlLineFieldChange(Rec,xRec,FIELDCAPTION("Unit of Measure Code"));

                                                                GetUnitAmount(FIELDNO("Unit of Measure Code"));
                                                                IF "Value Entry Type" = "Value Entry Type"::Revaluation THEN
                                                                  TESTFIELD("Qty. per Unit of Measure",1);

                                                                ReadGLSetup;
                                                                "Unit Cost" := ROUND(UnitCost * "Qty. per Unit of Measure",GLSetup."Unit-Amount Rounding Precision");

                                                                IF "Entry Type" = "Entry Type"::Consumption THEN BEGIN
                                                                  "Indirect Cost %" := ROUND(Item."Indirect Cost %" * "Qty. per Unit of Measure",1);
                                                                  "Overhead Rate" :=
                                                                    ROUND(Item."Overhead Rate" * "Qty. per Unit of Measure",GLSetup."Unit-Amount Rounding Precision");
                                                                  "Unit Amount" := ROUND(UnitCost * "Qty. per Unit of Measure",GLSetup."Unit-Amount Rounding Precision");
                                                                END;

                                                                IF "No." <> '' THEN
                                                                  VALIDATE("Cap. Unit of Measure Code");

                                                                VALIDATE("Unit Amount");

                                                                IF "Entry Type" = "Entry Type"::Output THEN BEGIN
                                                                  VALIDATE("Output Quantity");
                                                                  VALIDATE("Scrap Quantity");
                                                                END ELSE
                                                                  VALIDATE(Quantity);
                                                              END;

                                                   CaptionML=[ENU=Unit of Measure Code;
                                                              NOR=Enhetskode] }
    { 5408;   ;Derived from Blanket Order;Boolean ;CaptionML=[ENU=Derived from Blanket Order;
                                                              NOR=Stammer fra rammeordre];
                                                   Editable=No }
    { 5413;   ;Quantity (Base)     ;Decimal       ;OnValidate=BEGIN
                                                                TESTFIELD("Qty. per Unit of Measure",1);
                                                                VALIDATE(Quantity,"Quantity (Base)");
                                                              END;

                                                   CaptionML=[ENU=Quantity (Base);
                                                              NOR=Antall (lagerenhet)];
                                                   DecimalPlaces=0:5 }
    { 5415;   ;Invoiced Qty. (Base);Decimal       ;CaptionML=[ENU=Invoiced Qty. (Base);
                                                              NOR=Fakturert antall (lagerenhet)];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 5468;   ;Reserved Qty. (Base);Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Reservation Entry"."Quantity (Base)" WHERE (Source ID=FIELD(Journal Template Name),
                                                                                                                Source Ref. No.=FIELD(Line No.),
                                                                                                                Source Type=CONST(83),
                                                                                                                Source Subtype=FIELD(Entry Type),
                                                                                                                Source Batch Name=FIELD(Journal Batch Name),
                                                                                                                Source Prod. Order Line=CONST(0),
                                                                                                                Reservation Status=CONST(Reservation)));
                                                   AccessByPermission=TableData 120=R;
                                                   CaptionML=[ENU=Reserved Qty. (Base);
                                                              NOR=Reservert antall (lagerenhet)];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 5560;   ;Level               ;Integer       ;CaptionML=[ENU=Level;
                                                              NOR=Niv†];
                                                   Editable=No }
    { 5561;   ;Flushing Method     ;Option        ;CaptionML=[ENU=Flushing Method;
                                                              NOR=Trekkmetode];
                                                   OptionCaptionML=[ENU=Manual,Forward,Backward,Pick + Forward,Pick + Backward;
                                                                    NOR=Manuell,Fremover,Bakover,Plukk + Fremover,Plukk + Bakover];
                                                   OptionString=Manual,Forward,Backward,Pick + Forward,Pick + Backward;
                                                   Editable=No }
    { 5562;   ;Changed by User     ;Boolean       ;CaptionML=[ENU=Changed by User;
                                                              NOR=Endret av bruker];
                                                   Editable=No }
    { 5700;   ;Cross-Reference No. ;Code20        ;CaptionML=[ENU=Cross-Reference No.;
                                                              NOR=Kryssreferansenr.] }
    { 5701;   ;Originally Ordered No.;Code20      ;TableRelation=Item;
                                                   AccessByPermission=TableData 5715=R;
                                                   CaptionML=[ENU=Originally Ordered No.;
                                                              NOR=Opprinnelig ordreant.] }
    { 5702;   ;Originally Ordered Var. Code;Code10;TableRelation="Item Variant".Code WHERE (Item No.=FIELD(Originally Ordered No.));
                                                   AccessByPermission=TableData 5715=R;
                                                   CaptionML=[ENU=Originally Ordered Var. Code;
                                                              NOR=Opprin. best. variant - kode] }
    { 5703;   ;Out-of-Stock Substitution;Boolean  ;CaptionML=[ENU=Out-of-Stock Substitution;
                                                              NOR=Tomt p† lager-erstatning] }
    { 5704;   ;Item Category Code  ;Code20        ;TableRelation="Item Category";
                                                   CaptionML=[ENU=Item Category Code;
                                                              NOR=Varekategorikode] }
    { 5705;   ;Nonstock            ;Boolean       ;CaptionML=[ENU=Nonstock;
                                                              NOR=Katalogvare] }
    { 5706;   ;Purchasing Code     ;Code10        ;TableRelation=Purchasing;
                                                   AccessByPermission=TableData 223=R;
                                                   CaptionML=[ENU=Purchasing Code;
                                                              NOR=Kj›pskode] }
    { 5707;   ;Product Group Code  ;Code10        ;TableRelation="Product Group".Code WHERE (Item Category Code=FIELD(Item Category Code));
                                                   CaptionML=[ENU=Product Group Code;
                                                              NOR=Produktgruppekode] }
    { 5791;   ;Planned Delivery Date;Date         ;CaptionML=[ENU=Planned Delivery Date;
                                                              NOR=Planlagt lev.dato] }
    { 5793;   ;Order Date          ;Date          ;CaptionML=[ENU=Order Date;
                                                              NOR=Bestillingsdato] }
    { 5800;   ;Value Entry Type    ;Option        ;CaptionML=[ENU=Value Entry Type;
                                                              NOR=Verdiposttype];
                                                   OptionCaptionML=[ENU=Direct Cost,Revaluation,Rounding,Indirect Cost,Variance;
                                                                    NOR=Direktekostn.,Revaluering,Avrunding,Indirekte kost,Avvik];
                                                   OptionString=Direct Cost,Revaluation,Rounding,Indirect Cost,Variance }
    { 5801;   ;Item Charge No.     ;Code20        ;TableRelation="Item Charge";
                                                   CaptionML=[ENU=Item Charge No.;
                                                              NOR=Varegebyrnr.] }
    { 5802;   ;Inventory Value (Calculated);Decimal;
                                                   OnValidate=BEGIN
                                                                ReadGLSetup;
                                                                "Unit Cost (Calculated)" :=
                                                                  ROUND("Inventory Value (Calculated)" / Quantity,GLSetup."Unit-Amount Rounding Precision");
                                                              END;

                                                   CaptionML=[ENU=Inventory Value (Calculated);
                                                              NOR=Lagerverdi (beregnet)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 5803;   ;Inventory Value (Revalued);Decimal ;OnValidate=BEGIN
                                                                TESTFIELD("Value Entry Type","Value Entry Type"::Revaluation);
                                                                VALIDATE(Amount,"Inventory Value (Revalued)" - "Inventory Value (Calculated)");
                                                                ReadGLSetup;
                                                                IF ("Unit Cost (Revalued)" <> xRec."Unit Cost (Revalued)") OR
                                                                   ("Inventory Value (Revalued)" <> xRec."Inventory Value (Revalued)")
                                                                THEN BEGIN
                                                                  IF CurrFieldNo <> FIELDNO("Unit Cost (Revalued)") THEN
                                                                    "Unit Cost (Revalued)" :=
                                                                      ROUND("Inventory Value (Revalued)" / Quantity,GLSetup."Unit-Amount Rounding Precision");

                                                                  IF CurrFieldNo <> 0 THEN
                                                                    ClearSingleAndRolledUpCosts;
                                                                END
                                                              END;

                                                   CaptionML=[ENU=Inventory Value (Revalued);
                                                              NOR=Lagerverdi (revaluert)];
                                                   MinValue=0;
                                                   AutoFormatType=1 }
    { 5804;   ;Variance Type       ;Option        ;CaptionML=[ENU=Variance Type;
                                                              NOR=Avvikstype];
                                                   OptionCaptionML=[ENU=" ,Purchase,Material,Capacity,Capacity Overhead,Manufacturing Overhead";
                                                                    NOR=" ,Kj›p,Material,Kapasitet,Indirekte kap.kostn,Indirekte prod.kostn."];
                                                   OptionString=[ ,Purchase,Material,Capacity,Capacity Overhead,Manufacturing Overhead] }
    { 5805;   ;Inventory Value Per ;Option        ;CaptionML=[ENU=Inventory Value Per;
                                                              NOR=Lagerverdi per];
                                                   OptionCaptionML=[ENU=" ,Item,Location,Variant,Location and Variant";
                                                                    NOR=" ,Vare,Lokasjon,Variant,Lokasjon og variant"];
                                                   OptionString=[ ,Item,Location,Variant,Location and Variant];
                                                   Editable=No }
    { 5806;   ;Partial Revaluation ;Boolean       ;CaptionML=[ENU=Partial Revaluation;
                                                              NOR=Delvis revaluering];
                                                   Editable=No }
    { 5807;   ;Applies-from Entry  ;Integer       ;OnValidate=VAR
                                                                ItemLedgEntry@1000 : Record 32;
                                                                ItemTrackingLines@1001 : Page 6510;
                                                              BEGIN
                                                                IF "Applies-from Entry" <> 0 THEN BEGIN
                                                                  TESTFIELD(Quantity);
                                                                  IF Signed(Quantity) < 0 THEN BEGIN
                                                                    IF Quantity > 0 THEN
                                                                      FIELDERROR(Quantity,Text030);
                                                                    IF Quantity < 0 THEN
                                                                      FIELDERROR(Quantity,Text029);
                                                                  END;
                                                                  ItemLedgEntry.GET("Applies-from Entry");
                                                                  ItemLedgEntry.TESTFIELD(Positive,FALSE);
                                                                  IF ItemLedgEntry.TrackingExists THEN
                                                                    ERROR(Text033,FIELDCAPTION("Applies-from Entry"),ItemTrackingLines.CAPTION);
                                                                  "Unit Cost" := CalcUnitCost(ItemLedgEntry);
                                                                END;
                                                              END;

                                                   OnLookup=BEGIN
                                                              SelectItemEntry(FIELDNO("Applies-from Entry"));
                                                            END;

                                                   CaptionML=[ENU=Applies-from Entry;
                                                              NOR=Utlignet fra-post];
                                                   MinValue=0 }
    { 5808;   ;Invoice No.         ;Code20        ;CaptionML=[ENU=Invoice No.;
                                                              NOR=Fakturanr.] }
    { 5809;   ;Unit Cost (Calculated);Decimal     ;OnValidate=BEGIN
                                                                TESTFIELD("Value Entry Type","Value Entry Type"::Revaluation);
                                                              END;

                                                   CaptionML=[ENU=Unit Cost (Calculated);
                                                              NOR=Enhetskost (beregnet)];
                                                   Editable=No;
                                                   AutoFormatType=2 }
    { 5810;   ;Unit Cost (Revalued);Decimal       ;OnValidate=BEGIN
                                                                ReadGLSetup;
                                                                TESTFIELD("Value Entry Type","Value Entry Type"::Revaluation);
                                                                IF "Unit Cost (Revalued)" <> xRec."Unit Cost (Revalued)" THEN
                                                                  VALIDATE(
                                                                    "Inventory Value (Revalued)",
                                                                    ROUND(
                                                                      "Unit Cost (Revalued)" * Quantity,GLSetup."Amount Rounding Precision"));
                                                              END;

                                                   CaptionML=[ENU=Unit Cost (Revalued);
                                                              NOR=Enhetskost (revaluert)];
                                                   MinValue=0;
                                                   AutoFormatType=2 }
    { 5811;   ;Applied Amount      ;Decimal       ;CaptionML=[ENU=Applied Amount;
                                                              NOR=Utlignet bel›p];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 5812;   ;Update Standard Cost;Boolean       ;OnValidate=BEGIN
                                                                TESTFIELD("Inventory Value Per");
                                                                GetItem;
                                                                Item.TESTFIELD("Costing Method",Item."Costing Method"::Standard);
                                                              END;

                                                   CaptionML=[ENU=Update Standard Cost;
                                                              NOR=Oppdater standardkost] }
    { 5813;   ;Amount (ACY)        ;Decimal       ;CaptionML=[ENU=Amount (ACY);
                                                              NOR=Bel›p (till.val)];
                                                   AutoFormatType=1 }
    { 5817;   ;Correction          ;Boolean       ;CaptionML=[ENU=Correction;
                                                              NOR=Korreksjon] }
    { 5818;   ;Adjustment          ;Boolean       ;CaptionML=[ENU=Adjustment;
                                                              NOR=Justering] }
    { 5819;   ;Applies-to Value Entry;Integer     ;CaptionML=[ENU=Applies-to Value Entry;
                                                              NOR=Utligningsverdipost] }
    { 5820;   ;Invoice-to Source No.;Code20       ;TableRelation=IF (Source Type=CONST(Customer)) Customer
                                                                 ELSE IF (Source Type=CONST(Vendor)) Vendor;
                                                   CaptionML=[ENU=Invoice-to Source No.;
                                                              NOR=Faktura til-kildenr.] }
    { 5830;   ;Type                ;Option        ;OnValidate=BEGIN
                                                                IF Type = Type::Resource THEN
                                                                  TESTFIELD("Entry Type","Entry Type"::"Assembly Output")
                                                                ELSE
                                                                  TESTFIELD("Entry Type","Entry Type"::Output);
                                                                VALIDATE("No.",'');
                                                              END;

                                                   AccessByPermission=TableData 99000758=R;
                                                   CaptionML=[ENU=Type;
                                                              NOR=Type];
                                                   OptionCaptionML=[ENU=Work Center,Machine Center, ,Resource;
                                                                    NOR=Arbeidssenter,Maskinsenter, ,Ressurs];
                                                   OptionString=Work Center,Machine Center, ,Resource }
    { 5831;   ;No.                 ;Code20        ;TableRelation=IF (Type=CONST(Machine Center)) "Machine Center"
                                                                 ELSE IF (Type=CONST(Work Center)) "Work Center"
                                                                 ELSE IF (Type=CONST(Resource)) Resource;
                                                   OnValidate=VAR
                                                                Resource@1000 : Record 156;
                                                              BEGIN
                                                                IF Type = Type::Resource THEN
                                                                  TESTFIELD("Entry Type","Entry Type"::"Assembly Output")
                                                                ELSE
                                                                  TESTFIELD("Entry Type","Entry Type"::Output);
                                                                IF "No." = '' THEN BEGIN
                                                                  "Work Center No." := '';
                                                                  VALIDATE("Item No.");
                                                                  IF Type IN [Type::"Work Center",Type::"Machine Center"] THEN
                                                                    CreateDimWithProdOrderLine
                                                                  ELSE
                                                                    CreateDim(
                                                                      DATABASE::"Work Center","Work Center No.",
                                                                      DATABASE::Item,"Item No.",
                                                                      DATABASE::"Salesperson/Purchaser","Salespers./Purch. Code");
                                                                  EXIT;
                                                                END;

                                                                CASE Type OF
                                                                  Type::"Work Center":
                                                                    BEGIN
                                                                      WorkCenter.GET("No.");
                                                                      WorkCenter.TESTFIELD(Blocked,FALSE);
                                                                      "Work Center No." := WorkCenter."No.";
                                                                      Description := WorkCenter.Name;
                                                                      "Gen. Prod. Posting Group" := WorkCenter."Gen. Prod. Posting Group";
                                                                      "Unit Cost Calculation" := WorkCenter."Unit Cost Calculation";
                                                                    END;
                                                                  Type::"Machine Center":
                                                                    BEGIN
                                                                      MachineCenter.GET("No.");
                                                                      MachineCenter.TESTFIELD(Blocked,FALSE);
                                                                      "Work Center No." := MachineCenter."Work Center No.";
                                                                      Description := MachineCenter.Name;
                                                                      WorkCenter.GET("Work Center No.");
                                                                      WorkCenter.TESTFIELD(Blocked,FALSE);
                                                                      "Gen. Prod. Posting Group" := MachineCenter."Gen. Prod. Posting Group";
                                                                      "Unit Cost Calculation" := "Unit Cost Calculation"::Time;
                                                                    END;
                                                                  Type::Resource:
                                                                    BEGIN
                                                                      Resource.GET("No.");
                                                                      Resource.TESTFIELD(Blocked,FALSE);
                                                                    END;
                                                                END;

                                                                IF Type IN [Type::"Work Center",Type::"Machine Center"] THEN BEGIN
                                                                  "Work Center No." := WorkCenter."No.";
                                                                  VALIDATE("Cap. Unit of Measure Code",WorkCenter."Unit of Measure Code");
                                                                END;

                                                                IF "Work Center No." <> '' THEN
                                                                  CreateDimWithProdOrderLine;
                                                              END;

                                                   CaptionML=[ENU=No.;
                                                              NOR=Nr.] }
    { 5838;   ;Operation No.       ;Code10        ;TableRelation=IF (Order Type=CONST(Production)) "Prod. Order Routing Line"."Operation No." WHERE (Status=CONST(Released),
                                                                                                                                                     Prod. Order No.=FIELD(Order No.),
                                                                                                                                                     Routing No.=FIELD(Routing No.),
                                                                                                                                                     Routing Reference No.=FIELD(Routing Reference No.));
                                                   OnValidate=VAR
                                                                ProdOrderRtngLine@1000 : Record 5409;
                                                              BEGIN
                                                                TESTFIELD("Entry Type","Entry Type"::Output);
                                                                IF "Operation No." = '' THEN
                                                                  EXIT;

                                                                TESTFIELD("Order Type","Order Type"::Production);
                                                                TESTFIELD("Order No.");
                                                                TESTFIELD("Item No.");

                                                                GetProdOrderRtngLine(ProdOrderRtngLine);

                                                                CASE ProdOrderRtngLine.Type OF
                                                                  ProdOrderRtngLine.Type::"Work Center":
                                                                    Type := Type::"Work Center";
                                                                  ProdOrderRtngLine.Type::"Machine Center":
                                                                    Type := Type::"Machine Center";
                                                                END;
                                                                VALIDATE("No.",ProdOrderRtngLine."No.");
                                                                Description := ProdOrderRtngLine.Description;
                                                              END;

                                                   CaptionML=[ENU=Operation No.;
                                                              NOR=Operasjonsnr.] }
    { 5839;   ;Work Center No.     ;Code20        ;TableRelation="Work Center";
                                                   CaptionML=[ENU=Work Center No.;
                                                              NOR=Arbeidssenternr.];
                                                   Editable=No }
    { 5841;   ;Setup Time          ;Decimal       ;OnValidate=BEGIN
                                                                IF SubcontractingWorkCenterUsed AND ("Setup Time" <> 0) THEN
                                                                  ERROR(STRSUBSTNO(SubcontractedErr,FIELDCAPTION("Setup Time"),"Line No."));
                                                                "Setup Time (Base)" := CalcBaseTime("Setup Time");
                                                              END;

                                                   AccessByPermission=TableData 99000758=R;
                                                   CaptionML=[ENU=Setup Time;
                                                              NOR=Oppstillingstid];
                                                   DecimalPlaces=0:5 }
    { 5842;   ;Run Time            ;Decimal       ;OnValidate=BEGIN
                                                                IF SubcontractingWorkCenterUsed AND ("Run Time" <> 0) THEN
                                                                  ERROR(STRSUBSTNO(SubcontractedErr,FIELDCAPTION("Run Time"),"Line No."));

                                                                "Run Time (Base)" := CalcBaseTime("Run Time");
                                                              END;

                                                   AccessByPermission=TableData 99000758=R;
                                                   CaptionML=[ENU=Run Time;
                                                              NOR=Operasjonstid];
                                                   DecimalPlaces=0:5 }
    { 5843;   ;Stop Time           ;Decimal       ;OnValidate=BEGIN
                                                                "Stop Time (Base)" := CalcBaseTime("Stop Time");
                                                              END;

                                                   AccessByPermission=TableData 99000758=R;
                                                   CaptionML=[ENU=Stop Time;
                                                              NOR=Stopptid];
                                                   DecimalPlaces=0:5 }
    { 5846;   ;Output Quantity     ;Decimal       ;OnValidate=BEGIN
                                                                TESTFIELD("Entry Type","Entry Type"::Output);
                                                                IF SubcontractingWorkCenterUsed AND ("Output Quantity" <> 0) THEN
                                                                  ERROR(STRSUBSTNO(SubcontractedErr,FIELDCAPTION("Output Quantity"),"Line No."));

                                                                IF LastOutputOperation(Rec) THEN
                                                                  WhseValidateSourceLine.ItemLineVerifyChange(Rec,xRec);

                                                                "Output Quantity (Base)" := CalcBaseQty("Output Quantity");

                                                                VALIDATE(Quantity,"Output Quantity");
                                                              END;

                                                   AccessByPermission=TableData 99000758=R;
                                                   CaptionML=[ENU=Output Quantity;
                                                              NOR=Avgangsantall];
                                                   DecimalPlaces=0:5 }
    { 5847;   ;Scrap Quantity      ;Decimal       ;OnValidate=BEGIN
                                                                TESTFIELD("Entry Type","Entry Type"::Output);
                                                                "Scrap Quantity (Base)" := CalcBaseQty("Scrap Quantity");
                                                              END;

                                                   AccessByPermission=TableData 99000758=R;
                                                   CaptionML=[ENU=Scrap Quantity;
                                                              NOR=Vrakantall];
                                                   DecimalPlaces=0:5 }
    { 5849;   ;Concurrent Capacity ;Decimal       ;OnValidate=VAR
                                                                TotalTime@1000 : Integer;
                                                              BEGIN
                                                                TESTFIELD("Entry Type","Entry Type"::Output);
                                                                IF "Concurrent Capacity" = 0 THEN
                                                                  EXIT;

                                                                TESTFIELD("Starting Time");
                                                                TESTFIELD("Ending Time");
                                                                TotalTime := CalendarMgt.CalcTimeDelta("Ending Time","Starting Time");
                                                                IF "Ending Time" < "Starting Time" THEN
                                                                  TotalTime := TotalTime + 86400000;
                                                                TESTFIELD("Work Center No.");
                                                                WorkCenter.GET("Work Center No.");
                                                                VALIDATE("Setup Time",0);
                                                                VALIDATE(
                                                                  "Run Time",
                                                                  ROUND(
                                                                    TotalTime / CalendarMgt.TimeFactor("Cap. Unit of Measure Code") *
                                                                    "Concurrent Capacity",WorkCenter."Calendar Rounding Precision"));
                                                              END;

                                                   AccessByPermission=TableData 99000758=R;
                                                   CaptionML=[ENU=Concurrent Capacity;
                                                              NOR=Samtidig kapasitet];
                                                   DecimalPlaces=0:5 }
    { 5851;   ;Setup Time (Base)   ;Decimal       ;OnValidate=BEGIN
                                                                TESTFIELD("Qty. per Cap. Unit of Measure",1);
                                                                VALIDATE("Setup Time","Setup Time (Base)");
                                                              END;

                                                   CaptionML=[ENU=Setup Time (Base);
                                                              NOR=Oppstillingstid (l.enh)];
                                                   DecimalPlaces=0:5 }
    { 5852;   ;Run Time (Base)     ;Decimal       ;OnValidate=BEGIN
                                                                TESTFIELD("Qty. per Cap. Unit of Measure",1);
                                                                VALIDATE("Run Time","Run Time (Base)");
                                                              END;

                                                   CaptionML=[ENU=Run Time (Base);
                                                              NOR=Operasjonstid (l.enh)];
                                                   DecimalPlaces=0:5 }
    { 5853;   ;Stop Time (Base)    ;Decimal       ;OnValidate=BEGIN
                                                                TESTFIELD("Qty. per Cap. Unit of Measure",1);
                                                                VALIDATE("Stop Time","Stop Time (Base)");
                                                              END;

                                                   CaptionML=[ENU=Stop Time (Base);
                                                              NOR=Stopptid (l.enh)];
                                                   DecimalPlaces=0:5 }
    { 5856;   ;Output Quantity (Base);Decimal     ;OnValidate=BEGIN
                                                                TESTFIELD("Qty. per Unit of Measure",1);
                                                                VALIDATE("Output Quantity","Output Quantity (Base)");
                                                              END;

                                                   CaptionML=[ENU=Output Quantity (Base);
                                                              NOR=Avgangsantall (l.enh)];
                                                   DecimalPlaces=0:5 }
    { 5857;   ;Scrap Quantity (Base);Decimal      ;OnValidate=BEGIN
                                                                TESTFIELD("Qty. per Unit of Measure",1);
                                                                VALIDATE("Scrap Quantity","Scrap Quantity (Base)");
                                                              END;

                                                   CaptionML=[ENU=Scrap Quantity (Base);
                                                              NOR=Vrakantall (l.enh)];
                                                   DecimalPlaces=0:5 }
    { 5858;   ;Cap. Unit of Measure Code;Code10   ;TableRelation=IF (Type=CONST(Resource)) "Resource Unit of Measure".Code WHERE (Resource No.=FIELD(No.))
                                                                 ELSE "Capacity Unit of Measure";
                                                   OnValidate=VAR
                                                                ProdOrderRtngLine@1000 : Record 5409;
                                                              BEGIN
                                                                IF Type <> Type::Resource THEN BEGIN
                                                                  "Qty. per Cap. Unit of Measure" :=
                                                                    ROUND(
                                                                      CalendarMgt.QtyperTimeUnitofMeasure(
                                                                        "Work Center No.","Cap. Unit of Measure Code"),
                                                                      0.00001);

                                                                  VALIDATE("Setup Time");
                                                                  VALIDATE("Run Time");
                                                                  VALIDATE("Stop Time");
                                                                END;

                                                                IF "Order No." <> '' THEN
                                                                  CASE "Order Type" OF
                                                                    "Order Type"::Production:
                                                                      BEGIN
                                                                        GetProdOrderRtngLine(ProdOrderRtngLine);
                                                                        "Unit Cost" := ProdOrderRtngLine."Unit Cost per";

                                                                        CostCalcMgt.RoutingCostPerUnit(
                                                                          Type,"No.","Unit Amount","Indirect Cost %","Overhead Rate","Unit Cost","Unit Cost Calculation");
                                                                      END;
                                                                    "Order Type"::Assembly:
                                                                      CostCalcMgt.ResourceCostPerUnit("No.","Unit Amount","Indirect Cost %","Overhead Rate","Unit Cost");
                                                                  END;

                                                                ReadGLSetup;
                                                                "Unit Cost" :=
                                                                  ROUND("Unit Cost" * "Qty. per Cap. Unit of Measure",GLSetup."Unit-Amount Rounding Precision");
                                                                "Unit Amount" :=
                                                                  ROUND("Unit Amount" * "Qty. per Cap. Unit of Measure",GLSetup."Unit-Amount Rounding Precision");
                                                                VALIDATE("Unit Amount");
                                                              END;

                                                   CaptionML=[ENU=Cap. Unit of Measure Code;
                                                              NOR=Kapasitetsenhetskode] }
    { 5859;   ;Qty. per Cap. Unit of Measure;Decimal;
                                                   CaptionML=[ENU=Qty. per Cap. Unit of Measure;
                                                              NOR=Ant. per kapasitetsenhet];
                                                   DecimalPlaces=0:5 }
    { 5873;   ;Starting Time       ;Time          ;OnValidate=BEGIN
                                                                IF "Ending Time" < "Starting Time" THEN
                                                                  "Ending Time" := "Starting Time";

                                                                VALIDATE("Concurrent Capacity");
                                                              END;

                                                   AccessByPermission=TableData 99000758=R;
                                                   CaptionML=[ENU=Starting Time;
                                                              NOR=Starttidspunkt] }
    { 5874;   ;Ending Time         ;Time          ;OnValidate=BEGIN
                                                                VALIDATE("Concurrent Capacity");
                                                              END;

                                                   AccessByPermission=TableData 99000758=R;
                                                   CaptionML=[ENU=Ending Time;
                                                              NOR=Sluttidspunkt] }
    { 5882;   ;Routing No.         ;Code20        ;TableRelation="Routing Header";
                                                   CaptionML=[ENU=Routing No.;
                                                              NOR=Rutenr.];
                                                   Editable=No }
    { 5883;   ;Routing Reference No.;Integer      ;CaptionML=[ENU=Routing Reference No.;
                                                              NOR=Rutereferansenr.] }
    { 5884;   ;Prod. Order Comp. Line No.;Integer ;TableRelation=IF (Order Type=CONST(Production)) "Prod. Order Component"."Line No." WHERE (Status=CONST(Released),
                                                                                                                                             Prod. Order No.=FIELD(Order No.),
                                                                                                                                             Prod. Order Line No.=FIELD(Order Line No.));
                                                   OnValidate=BEGIN
                                                                IF "Prod. Order Comp. Line No." <> xRec."Prod. Order Comp. Line No." THEN
                                                                  CreateProdDim;
                                                              END;

                                                   CaptionML=[ENU=Prod. Order Comp. Line No.;
                                                              NOR=Prod.ordrekomp.linjenr.] }
    { 5885;   ;Finished            ;Boolean       ;AccessByPermission=TableData 99000758=R;
                                                   CaptionML=[ENU=Finished;
                                                              NOR=Ferdig] }
    { 5887;   ;Unit Cost Calculation;Option       ;CaptionML=[ENU=Unit Cost Calculation;
                                                              NOR=Beregning av enhetskost];
                                                   OptionCaptionML=[ENU=Time,Units;
                                                                    NOR=Tid,Enheter];
                                                   OptionString=Time,Units }
    { 5888;   ;Subcontracting      ;Boolean       ;CaptionML=[ENU=Subcontracting;
                                                              NOR=Underleveranse] }
    { 5895;   ;Stop Code           ;Code20        ;TableRelation=Stop;
                                                   CaptionML=[ENU=Stop Code;
                                                              NOR=Stoppkode];
                                                   Description=OPC: fra 10 }
    { 5896;   ;Scrap Code          ;Code20        ;TableRelation=Scrap;
                                                   OnValidate=BEGIN
                                                                TESTFIELD(Type,Type::"Machine Center");
                                                              END;

                                                   CaptionML=[ENU=Scrap Code;
                                                              NOR=Vrakkode];
                                                   Description=OPC: fra 10 }
    { 5898;   ;Work Center Group Code;Code10      ;TableRelation="Work Center Group";
                                                   CaptionML=[ENU=Work Center Group Code;
                                                              NOR=Arbeidssentergruppekode];
                                                   Editable=No }
    { 5899;   ;Work Shift Code     ;Code10        ;TableRelation="Work Shift";
                                                   CaptionML=[ENU=Work Shift Code;
                                                              NOR=Arbeidsskiftkode] }
    { 6500;   ;Serial No.          ;Code20        ;CaptionML=[ENU=Serial No.;
                                                              NOR=Serienr.];
                                                   Editable=No }
    { 6501;   ;Lot No.             ;Code20        ;CaptionML=[ENU=Lot No.;
                                                              NOR=Partinr.];
                                                   Editable=No }
    { 6502;   ;Warranty Date       ;Date          ;CaptionML=[ENU=Warranty Date;
                                                              NOR=Garantidato];
                                                   Editable=No }
    { 6503;   ;New Serial No.      ;Code20        ;CaptionML=[ENU=New Serial No.;
                                                              NOR=Nytt serienr.];
                                                   Editable=No }
    { 6504;   ;New Lot No.         ;Code20        ;CaptionML=[ENU=New Lot No.;
                                                              NOR=Nytt partinr.];
                                                   Editable=No }
    { 6505;   ;New Item Expiration Date;Date      ;CaptionML=[ENU=New Item Expiration Date;
                                                              NOR=Ny vareholdbarhetsdato] }
    { 6506;   ;Item Expiration Date;Date          ;CaptionML=[ENU=Item Expiration Date;
                                                              NOR=Vareholdbarhetsdato];
                                                   Editable=No }
    { 6600;   ;Return Reason Code  ;Code10        ;TableRelation="Return Reason";
                                                   CaptionML=[ENU=Return Reason Code;
                                                              NOR=Retur†rsakskode] }
    { 7315;   ;Warehouse Adjustment;Boolean       ;CaptionML=[ENU=Warehouse Adjustment;
                                                              NOR=Lagerjustering] }
    { 7380;   ;Phys Invt Counting Period Code;Code10;
                                                   TableRelation="Phys. Invt. Counting Period";
                                                   CaptionML=[ENU=Phys Invt Counting Period Code;
                                                              NOR=Vareopptell.periode - kode];
                                                   Editable=No }
    { 7381;   ;Phys Invt Counting Period Type;Option;
                                                   CaptionML=[ENU=Phys Invt Counting Period Type;
                                                              NOR=Type vareopptellingsperiode];
                                                   OptionCaptionML=[ENU=" ,Item,SKU";
                                                                    NOR=" ,Vare,LFE"];
                                                   OptionString=[ ,Item,SKU];
                                                   Editable=No }
    { 50000;  ;Shelf No.           ;Code15        ;CaptionML=NOR=Hyllenr. }
    { 50001;  ;Description 2       ;Text30        ;CaptionML=NOR=Beskrivelse 2 }
    { 50050;  ;Employee no.        ;Code10        ;CaptionML=[ENU=Employee no.;
                                                              NOR=Ansatt nr.];
                                                   Description=SID ASL 17.11.03 }
    { 50051;  ;Innlesnings status  ;Option        ;OptionCaptionML=[ENU=" ,Check Date";
                                                                    NOR=" ,Sjekk dato"];
                                                   OptionString=[ ,Check Date];
                                                   Description=SID ASL 18.11.03 }
    { 50052;  ;Print Cap.Ledger Entry;Boolean      }
    { 83001;  ;Scrap Comment       ;Text50        ;Description=opc }
    { 83002;  ;Routing Link Code   ;Code20        ;CaptionML=[ENU=Routing Link Code;
                                                              NOR=Rutekoblingskode] }
    { 83003;  ;Comment at p.o.route line;Boolean  ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Prod. Order Rtng Comment Line" WHERE (Status=CONST(Released),
                                                                                                            Prod. Order No.=FIELD(Order No.),
                                                                                                            Routing No.=FIELD(Routing No.),
                                                                                                            Operation No.=FIELD(Operation No.)));
                                                   Description=opc }
    { 99000755;;Overhead Rate      ;Decimal       ;OnValidate=BEGIN
                                                                IF ("Value Entry Type" <> "Value Entry Type"::"Direct Cost") OR
                                                                   ("Item Charge No." <> '')
                                                                THEN BEGIN
                                                                  "Overhead Rate" := 0;
                                                                  VALIDATE("Indirect Cost %",0);
                                                                END ELSE
                                                                  VALIDATE("Indirect Cost %");
                                                              END;

                                                   CaptionML=[ENU=Overhead Rate;
                                                              NOR=Sats for indirekte kostnader];
                                                   DecimalPlaces=0:5 }
    { 99000756;;Single-Level Material Cost;Decimal;CaptionML=[ENU=Single-Level Material Cost;
                                                              NOR=Materialkostn. - enkeltniv†];
                                                   AutoFormatType=1 }
    { 99000757;;Single-Level Capacity Cost;Decimal;CaptionML=[ENU=Single-Level Capacity Cost;
                                                              NOR=Kapasitetskostn. - enkeltniv†];
                                                   AutoFormatType=1 }
    { 99000758;;Single-Level Subcontrd. Cost;Decimal;
                                                   CaptionML=[ENU=Single-Level Subcontrd. Cost;
                                                              NOR=Underlevrd.kostn - enkeltniv†];
                                                   AutoFormatType=1 }
    { 99000759;;Single-Level Cap. Ovhd Cost;Decimal;
                                                   CaptionML=[ENU=Single-Level Cap. Ovhd Cost;
                                                              NOR=Indir. kap.kostn - enkeltniv†];
                                                   AutoFormatType=1 }
    { 99000760;;Single-Level Mfg. Ovhd Cost;Decimal;
                                                   CaptionML=[ENU=Single-Level Mfg. Ovhd Cost;
                                                              NOR=Indir. prod.kostn - enkeltniv†];
                                                   AutoFormatType=1 }
    { 99000761;;Rolled-up Material Cost;Decimal   ;CaptionML=[ENU=Rolled-up Material Cost;
                                                              NOR=Opprullert materialkost];
                                                   AutoFormatType=1 }
    { 99000762;;Rolled-up Capacity Cost;Decimal   ;CaptionML=[ENU=Rolled-up Capacity Cost;
                                                              NOR=Opprullert kapasitetskost];
                                                   AutoFormatType=1 }
    { 99000763;;Rolled-up Subcontracted Cost;Decimal;
                                                   CaptionML=[ENU=Rolled-up Subcontracted Cost;
                                                              NOR=Underlever.kostn. - opprullert];
                                                   AutoFormatType=1 }
    { 99000764;;Rolled-up Mfg. Ovhd Cost;Decimal  ;CaptionML=[ENU=Rolled-up Mfg. Ovhd Cost;
                                                              NOR=Opprullert indir. prod.kostn.];
                                                   AutoFormatType=1 }
    { 99000765;;Rolled-up Cap. Overhead Cost;Decimal;
                                                   CaptionML=[ENU=Rolled-up Cap. Overhead Cost;
                                                              NOR=Opprullert indir. kap.kostn.];
                                                   AutoFormatType=1 }
  }
  KEYS
  {
    {    ;Journal Template Name,Journal Batch Name,Line No.;
                                                   MaintainSIFTIndex=No;
                                                   Clustered=Yes }
    {    ;Entry Type,Item No.,Variant Code,Location Code,Bin Code,Posting Date;
                                                   SumIndexFields=Quantity (Base);
                                                   MaintainSIFTIndex=No }
    {    ;Entry Type,Item No.,Variant Code,New Location Code,New Bin Code,Posting Date;
                                                   SumIndexFields=Quantity (Base);
                                                   MaintainSIFTIndex=No }
    {    ;Item No.,Posting Date                    }
    {    ;Journal Template Name,Journal Batch Name,Shelf No. }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      Text001@1001 : TextConst 'ENU=%1 must be reduced.;NOR=%1 m† reduseres.';
      Text002@1002 : TextConst 'ENU=You cannot change %1 when %2 is %3.;NOR=Du kan ikke endre %1 n†r %2 er %3.';
      Text006@1005 : TextConst 'ENU=You must not enter %1 in a revaluation sum line.;NOR=Du skal ikke angi %1 i en revalueringsumline.';
      ItemJnlTemplate@1007 : Record 82;
      ItemJnlBatch@1008 : Record 233;
      ItemJnlLine@1009 : Record 83;
      Item@1010 : Record 27;
      ItemVariant@1012 : Record 5401;
      GLSetup@1014 : Record 98;
      MfgSetup@1034 : Record 99000765;
      WorkCenter@1040 : Record 99000754;
      MachineCenter@1039 : Record 99000758;
      Location@1048 : Record 14;
      Bin@1030 : Record 7354;
      ItemCheckAvail@1021 : Codeunit 311;
      ReserveItemJnlLine@1022 : Codeunit 99000835;
      NoSeriesMgt@1023 : Codeunit 396;
      UOMMgt@1024 : Codeunit 5402;
      DimMgt@1027 : Codeunit 408;
      UserMgt@1033 : Codeunit 5700;
      CalendarMgt@1041 : Codeunit 99000755;
      CostCalcMgt@1042 : Codeunit 5836;
      PurchPriceCalcMgt@1020 : Codeunit 7010;
      SalesPriceCalcMgt@1025 : Codeunit 7000;
      WMSManagement@1026 : Codeunit 7302;
      WhseValidateSourceLine@1032 : Codeunit 5777;
      PhysInvtEntered@1028 : Boolean;
      GLSetupRead@1029 : Boolean;
      MfgSetupRead@1035 : Boolean;
      UnitCost@1031 : Decimal;
      Text007@1006 : TextConst 'ENU="New ";NOR="Ny "';
      Text012@1045 : TextConst 'ENU=The update has been interrupted to respect the warning.;NOR=Oppdateringen er avbrutt som en reaksjon p† advarselen.';
      Text021@1051 : TextConst 'ENU=The entered bin code %1 is different from the bin code %2 in production order component %3.\\Are you sure that you want to post the consumption from bin code %1?;NOR=Den angitte hyllekoden %1 er ulik hyllekoden %2 i produksjonsordrekomponenten %3.\\Er du sikker p† at du vil bokf›re forbruket fra hyllekode %1?';
      Text029@1047 : TextConst 'ENU=must be positive;NOR=m† v‘re positiv';
      Text030@1046 : TextConst 'ENU=must be negative;NOR=m† v‘re negativ';
      Text031@1043 : TextConst 'ENU=You can not insert item number %1 because it is not produced on released production order %2.;NOR=Du kan ikke sette inn varenummer %1 fordi det ikke er produsert i den frigitte produksjonsordren %2.';
      Text032@1000 : TextConst 'ENU=When posting, the entry %1 will be opened first.;NOR=Ved bokf›ring †pnes posten %1 f›rst.';
      Text033@1049 : TextConst 'ENU=If the item carries serial or lot numbers, then you must use the %1 field in the %2 window.;NOR=Hvis varen har serie- eller partinummer, m† du bruke %1-feltet i %2-vinduet.';
      Text034@1050 : TextConst 'ENU=You cannot revalue individual item ledger entries for items that use the average costing method.;NOR=Du kan ikke revaluere enkeltst†ende vareposter for varer som bruker lagermetoden Gjennomsnitt.';
      SubcontractedErr@1003 : TextConst '@@@=%1 - Field Caption, %2 - Line No.;ENU=%1 must be zero in line number %2 because it is linked to the subcontracted work center.;NOR=%1 m† v‘re null p† linjenummeret %2 fordi det er koblet til arbeidssentret som er underleverand›r.';

    PROCEDURE EmptyLine@5() : Boolean;
    BEGIN
      EXIT(
        (Quantity = 0) AND
        ((TimeIsEmpty AND ("Item No." = '')) OR
         ("Value Entry Type" = "Value Entry Type"::Revaluation)));
    END;

    PROCEDURE IsValueEntryForDeletedItem@22() : Boolean;
    BEGIN
      EXIT(
        (("Entry Type" = "Entry Type"::Output) OR ("Value Entry Type" = "Value Entry Type"::Rounding)) AND
        ("Item No." = '') AND ("Item Charge No." = '') AND ("Invoiced Qty. (Base)" <> 0));
    END;

    LOCAL PROCEDURE CalcBaseQty@14(Qty@1000 : Decimal) : Decimal;
    BEGIN
      TESTFIELD("Qty. per Unit of Measure");
      EXIT(ROUND(Qty * "Qty. per Unit of Measure",0.00001));
    END;

    LOCAL PROCEDURE CalcBaseTime@28(Qty@1000 : Decimal) : Decimal;
    BEGIN
      IF "Run Time" <> 0 THEN
        TESTFIELD("Qty. per Cap. Unit of Measure");
      EXIT(ROUND(Qty * "Qty. per Cap. Unit of Measure",0.00001));
    END;

    LOCAL PROCEDURE UpdateAmount@23();
    BEGIN
      Amount := ROUND(Quantity * "Unit Amount");
    END;

    LOCAL PROCEDURE SelectItemEntry@3(CurrentFieldNo@1000 : Integer);
    VAR
      ItemLedgEntry@1001 : Record 32;
      ItemJnlLine2@1002 : Record 83;
    BEGIN
      IF ("Entry Type" = "Entry Type"::Output) AND
         ("Value Entry Type" <> "Value Entry Type"::Revaluation) AND
         (CurrentFieldNo = FIELDNO("Applies-to Entry"))
      THEN BEGIN
        ItemLedgEntry.SETCURRENTKEY(
          "Order Type","Order No.","Order Line No.","Entry Type","Prod. Order Comp. Line No.");
        ItemLedgEntry.SETRANGE("Order Type","Order Type"::Production);
        ItemLedgEntry.SETRANGE("Order No.","Order No.");
        ItemLedgEntry.SETRANGE("Order Line No.","Order Line No.");
        ItemLedgEntry.SETRANGE("Entry Type","Entry Type");
        ItemLedgEntry.SETRANGE("Prod. Order Comp. Line No.",0);
      END ELSE BEGIN
        ItemLedgEntry.SETCURRENTKEY("Item No.",Positive);
        ItemLedgEntry.SETRANGE("Item No.","Item No.");
      END;

      IF "Location Code" <> '' THEN
        ItemLedgEntry.SETRANGE("Location Code","Location Code");

      IF CurrentFieldNo = FIELDNO("Applies-to Entry") THEN BEGIN
        ItemLedgEntry.SETRANGE(Positive,(Signed(Quantity) < 0) OR ("Value Entry Type" = "Value Entry Type"::Revaluation));
        IF "Value Entry Type" <> "Value Entry Type"::Revaluation THEN BEGIN
          ItemLedgEntry.SETCURRENTKEY("Item No.",Open);
          ItemLedgEntry.SETRANGE(Open,TRUE);
        END;
      END ELSE
        ItemLedgEntry.SETRANGE(Positive,FALSE);

      IF PAGE.RUNMODAL(PAGE::"Item Ledger Entries",ItemLedgEntry) = ACTION::LookupOK THEN BEGIN
        ItemJnlLine2 := Rec;
        IF CurrentFieldNo = FIELDNO("Applies-to Entry") THEN
          ItemJnlLine2.VALIDATE("Applies-to Entry",ItemLedgEntry."Entry No.")
        ELSE
          ItemJnlLine2.VALIDATE("Applies-from Entry",ItemLedgEntry."Entry No.");
        CheckItemAvailable(CurrentFieldNo);
        Rec := ItemJnlLine2;
      END;
    END;

    LOCAL PROCEDURE CheckItemAvailable@1(CalledByFieldNo@1000 : Integer);
    BEGIN
      IF (CurrFieldNo = 0) OR (CurrFieldNo <> CalledByFieldNo) THEN // Prevent two checks on quantity
        EXIT;

      IF (CurrFieldNo <> 0) AND ("Item No." <> '') AND (Quantity <> 0) AND
         ("Value Entry Type" = "Value Entry Type"::"Direct Cost") AND ("Item Charge No." = '')
      THEN
        IF ItemCheckAvail.ItemJnlCheckLine(Rec) THEN
          ItemCheckAvail.RaiseUpdateInterruptedError;
    END;

    LOCAL PROCEDURE GetItem@2();
    BEGIN
      IF Item."No." <> "Item No." THEN
        Item.GET("Item No.");
    END;

    PROCEDURE SetUpNewLine@8(LastItemJnlLine@1000 : Record 83);
    BEGIN
      MfgSetup.GET;
      ItemJnlTemplate.GET("Journal Template Name");
      ItemJnlBatch.GET("Journal Template Name","Journal Batch Name");
      ItemJnlLine.SETRANGE("Journal Template Name","Journal Template Name");
      ItemJnlLine.SETRANGE("Journal Batch Name","Journal Batch Name");
      IF ItemJnlLine.FINDFIRST THEN BEGIN
        "Posting Date" := LastItemJnlLine."Posting Date";
        "Document Date" := LastItemJnlLine."Posting Date";
        IF (ItemJnlTemplate.Type IN
            [ItemJnlTemplate.Type::Consumption,ItemJnlTemplate.Type::Output])
        THEN BEGIN
          IF NOT MfgSetup."Doc. No. Is Prod. Order No." THEN
            "Document No." := LastItemJnlLine."Document No."
        END ELSE
          "Document No." := LastItemJnlLine."Document No.";
      END ELSE BEGIN
        "Posting Date" := WORKDATE;
        "Document Date" := WORKDATE;
        IF ItemJnlBatch."No. Series" <> '' THEN BEGIN
          CLEAR(NoSeriesMgt);
          "Document No." := NoSeriesMgt.TryGetNextNo(ItemJnlBatch."No. Series","Posting Date");
        END;
        IF (ItemJnlTemplate.Type IN
            [ItemJnlTemplate.Type::Consumption,ItemJnlTemplate.Type::Output]) AND
           NOT MfgSetup."Doc. No. Is Prod. Order No."
        THEN
          IF ItemJnlBatch."No. Series" <> '' THEN BEGIN
            CLEAR(NoSeriesMgt);
            "Document No." := NoSeriesMgt.GetNextNo(ItemJnlBatch."No. Series","Posting Date",FALSE);
          END;
      END;
      "Recurring Method" := LastItemJnlLine."Recurring Method";
      "Entry Type" := LastItemJnlLine."Entry Type";
      "Source Code" := ItemJnlTemplate."Source Code";
      "Reason Code" := ItemJnlBatch."Reason Code";
      "Posting No. Series" := ItemJnlBatch."Posting No. Series";
      IF ItemJnlTemplate.Type = ItemJnlTemplate.Type::Revaluation THEN BEGIN
        "Value Entry Type" := "Value Entry Type"::Revaluation;
        "Entry Type" := "Entry Type"::"Positive Adjmt.";
      END;

      CASE "Entry Type" OF
        "Entry Type"::Purchase:
          "Location Code" := UserMgt.GetLocation(1,'',UserMgt.GetPurchasesFilter);
        "Entry Type"::Sale:
          "Location Code" := UserMgt.GetLocation(0,'',UserMgt.GetSalesFilter);
        "Entry Type"::Output:
          CLEAR(DimMgt);
      END;

      IF Location.GET("Location Code") THEN
        IF  Location."Directed Put-away and Pick" THEN
          "Location Code" := '';
    END;

    PROCEDURE SetDocNos@165(DocType@1000 : Option;DocNo@1001 : Code[20];ExtDocNo@1002 : Text[35];PostingNos@1003 : Code[10]);
    BEGIN
      "Document Type" := DocType;
      "Document No." := DocNo;
      "External Document No." := ExtDocNo;
      "Posting No. Series" := PostingNos;
    END;

    LOCAL PROCEDURE GetUnitAmount@6(CalledByFieldNo@1000 : Integer);
    BEGIN
      RetrieveCosts;
      IF ("Value Entry Type" <> "Value Entry Type"::"Direct Cost") OR
         ("Item Charge No." <> '')
      THEN
        EXIT;

      CASE "Entry Type" OF
        "Entry Type"::Purchase:
          PurchPriceCalcMgt.FindItemJnlLinePrice(Rec,CalledByFieldNo);
        "Entry Type"::Sale:
          SalesPriceCalcMgt.FindItemJnlLinePrice(Rec,CalledByFieldNo);
        "Entry Type"::"Positive Adjmt.":
          "Unit Amount" :=
            ROUND(
              ((UnitCost - "Overhead Rate") * "Qty. per Unit of Measure") / (1 + "Indirect Cost %" / 100),
              GLSetup."Unit-Amount Rounding Precision");
        "Entry Type"::"Negative Adjmt.":
          "Unit Amount" := UnitCost * "Qty. per Unit of Measure";
        "Entry Type"::Transfer:
          "Unit Amount" := 0;
      END;
    END;

    PROCEDURE Signed@20(Value@1000 : Decimal) : Decimal;
    BEGIN
      CASE "Entry Type" OF
        "Entry Type"::Purchase,
        "Entry Type"::"Positive Adjmt.",
        "Entry Type"::Output,
        "Entry Type"::"Assembly Output":
          EXIT(Value);
        "Entry Type"::Sale,
        "Entry Type"::"Negative Adjmt.",
        "Entry Type"::Consumption,
        "Entry Type"::Transfer,
        "Entry Type"::"Assembly Consumption":
          EXIT(-Value);
      END;
    END;

    PROCEDURE IsInbound@31() : Boolean;
    BEGIN
      EXIT((Signed(Quantity) > 0) OR (Signed("Invoiced Quantity") > 0));
    END;

    PROCEDURE OpenItemTrackingLines@6500(IsReclass@1000 : Boolean);
    BEGIN
      ReserveItemJnlLine.CallItemTracking(Rec,IsReclass);
    END;

    LOCAL PROCEDURE PickDimension@48(TableList@1005 : ARRAY [10] OF Integer;CodeList@1004 : ARRAY [10] OF Code[20];InheritFromDimSetID@1003 : Integer;InheritFromTableNo@1002 : Integer);
    VAR
      ItemJournalTemplate@1001 : Record 82;
      SourceCode@1000 : Code[10];
    BEGIN
      SourceCode := "Source Code";
      IF SourceCode = '' THEN
        IF ItemJournalTemplate.GET("Journal Template Name") THEN
          SourceCode := ItemJournalTemplate."Source Code";

      "Shortcut Dimension 1 Code" := '';
      "Shortcut Dimension 2 Code" := '';
      "Dimension Set ID" :=
        DimMgt.GetDefaultDimID(
          TableList,CodeList,SourceCode,
          "Shortcut Dimension 1 Code","Shortcut Dimension 2 Code",InheritFromDimSetID,InheritFromTableNo);
      DimMgt.UpdateGlobalDimFromDimSetID("Dimension Set ID","Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");

      IF "Entry Type" = "Entry Type"::Transfer THEN BEGIN
        "New Dimension Set ID" := "Dimension Set ID";
        "New Shortcut Dimension 1 Code" := "Shortcut Dimension 1 Code";
        "New Shortcut Dimension 2 Code" := "Shortcut Dimension 2 Code";
      END;
    END;

    LOCAL PROCEDURE CreateCodeList@55(VAR CodeList@1003 : ARRAY [10] OF Code[20];No1@1002 : Code[20];No2@1001 : Code[20];No3@1000 : Code[20]);
    BEGIN
      CLEAR(CodeList);
      CodeList[1] := No1;
      CodeList[2] := No2;
      CodeList[3] := No3;
    END;

    LOCAL PROCEDURE CreateTableList@56(VAR TableID@1001 : ARRAY [10] OF Integer;Type1@1000 : Integer;Type2@1002 : Integer;Type3@1007 : Integer);
    BEGIN
      CLEAR(TableID);
      TableID[1] := Type1;
      TableID[2] := Type2;
      TableID[3] := Type3;
    END;

    LOCAL PROCEDURE CreateDim@13(Type1@1000 : Integer;No1@1001 : Code[20];Type2@1002 : Integer;No2@1003 : Code[20];Type3@1007 : Integer;No3@1006 : Code[20]);
    VAR
      TableID@1004 : ARRAY [10] OF Integer;
      No@1005 : ARRAY [10] OF Code[20];
    BEGIN
      CreateTableList(TableID,Type1,Type2,Type3);
      CreateCodeList(No,No1,No2,No3);
      PickDimension(TableID,No,0,0);
    END;

    PROCEDURE CopyDim@46(DimesionSetID@1000 : Integer);
    VAR
      DimSetEntry@1002 : Record 480;
    BEGIN
      ReadGLSetup;
      "Dimension Set ID" := DimesionSetID;
      DimSetEntry.SETRANGE("Dimension Set ID",DimesionSetID);
      DimSetEntry.SETRANGE("Dimension Code",GLSetup."Global Dimension 1 Code");
      IF DimSetEntry.FINDFIRST THEN
        "Shortcut Dimension 1 Code" := DimSetEntry."Dimension Value Code"
      ELSE
        "Shortcut Dimension 1 Code" := '';
      DimSetEntry.SETRANGE("Dimension Code",GLSetup."Global Dimension 2 Code");
      IF DimSetEntry.FINDFIRST THEN
        "Shortcut Dimension 2 Code" := DimSetEntry."Dimension Value Code"
      ELSE
        "Shortcut Dimension 2 Code" := '';
    END;

    LOCAL PROCEDURE CreateProdDim@25();
    VAR
      ProdOrder@1008 : Record 5405;
      ProdOrderLine@1009 : Record 5406;
      ProdOrderComp@1010 : Record 5407;
      DimSetIDArr@1001 : ARRAY [10] OF Integer;
      i@1000 : Integer;
    BEGIN
      "Shortcut Dimension 1 Code" := '';
      "Shortcut Dimension 2 Code" := '';
      "Dimension Set ID" := 0;
      IF ("Order Type" <> "Order Type"::Production) OR ("Order No." = '') THEN
        EXIT;
      ProdOrder.GET(ProdOrder.Status::Released,"Order No.");
      i := 1;
      DimSetIDArr[i] := ProdOrder."Dimension Set ID";
      IF "Order Line No." <> 0 THEN BEGIN
        i := i + 1;
        ProdOrderLine.GET(ProdOrderLine.Status::Released,"Order No.","Order Line No.");
        DimSetIDArr[i] := ProdOrderLine."Dimension Set ID";
      END;
      IF "Prod. Order Comp. Line No." <> 0 THEN BEGIN
        i := i + 1;
        ProdOrderComp.GET(ProdOrderLine.Status::Released,"Order No.","Order Line No.","Prod. Order Comp. Line No.");
        DimSetIDArr[i] := ProdOrderComp."Dimension Set ID";
      END;
      "Dimension Set ID" := DimMgt.GetCombinedDimensionSetID(DimSetIDArr,"Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
    END;

    LOCAL PROCEDURE CreateAssemblyDim@42();
    VAR
      AssemblyHeader@1008 : Record 900;
      AssemblyLine@1009 : Record 901;
      DimSetIDArr@1001 : ARRAY [10] OF Integer;
      i@1000 : Integer;
    BEGIN
      "Shortcut Dimension 1 Code" := '';
      "Shortcut Dimension 2 Code" := '';
      "Dimension Set ID" := 0;
      IF ("Order Type" <> "Order Type"::Assembly) OR ("Order No." = '') THEN
        EXIT;
      AssemblyHeader.GET(AssemblyHeader."Document Type"::Order,"Order No.");
      i := 1;
      DimSetIDArr[i] := AssemblyHeader."Dimension Set ID";
      IF "Order Line No." <> 0 THEN BEGIN
        i := i + 1;
        AssemblyLine.GET(AssemblyLine."Document Type"::Order,"Order No.","Order Line No.");
        DimSetIDArr[i] := AssemblyLine."Dimension Set ID";
      END;
      "Dimension Set ID" := DimMgt.GetCombinedDimensionSetID(DimSetIDArr,"Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
    END;

    LOCAL PROCEDURE CreateDimWithProdOrderLine@54();
    VAR
      ProdOrderLine@1005 : Record 5406;
      InheritFromDimSetID@1004 : Integer;
      TableID@1001 : ARRAY [10] OF Integer;
      No@1000 : ARRAY [10] OF Code[20];
    BEGIN
      IF "Order Type" = "Order Type"::Production THEN
        IF ProdOrderLine.GET(ProdOrderLine.Status::Released,"Order No.","Order Line No.") THEN
          InheritFromDimSetID := ProdOrderLine."Dimension Set ID";

      CreateTableList(TableID,DATABASE::"Work Center",DATABASE::"Salesperson/Purchaser",0);
      CreateCodeList(No,"Work Center No.","Salespers./Purch. Code",'');
      PickDimension(TableID,No,InheritFromDimSetID,DATABASE::Item);
    END;

    PROCEDURE ValidateShortcutDimCode@9(FieldNumber@1000 : Integer;VAR ShortcutDimCode@1001 : Code[20]);
    BEGIN
      DimMgt.ValidateShortcutDimValues(FieldNumber,ShortcutDimCode,"Dimension Set ID");
    END;

    PROCEDURE LookupShortcutDimCode@18(FieldNumber@1000 : Integer;VAR ShortcutDimCode@1001 : Code[20]);
    BEGIN
      DimMgt.LookupDimValueCode(FieldNumber,ShortcutDimCode);
      DimMgt.ValidateShortcutDimValues(FieldNumber,ShortcutDimCode,"Dimension Set ID");
    END;

    PROCEDURE ShowShortcutDimCode@15(VAR ShortcutDimCode@1000 : ARRAY [8] OF Code[20]);
    BEGIN
      DimMgt.GetShortcutDimensions("Dimension Set ID",ShortcutDimCode);
    END;

    PROCEDURE ValidateNewShortcutDimCode@19(FieldNumber@1000 : Integer;VAR NewShortcutDimCode@1001 : Code[20]);
    BEGIN
      DimMgt.ValidateShortcutDimValues(FieldNumber,NewShortcutDimCode,"New Dimension Set ID");
    END;

    PROCEDURE LookupNewShortcutDimCode@21(FieldNumber@1000 : Integer;VAR NewShortcutDimCode@1001 : Code[20]);
    BEGIN
      DimMgt.LookupDimValueCode(FieldNumber,NewShortcutDimCode);
      DimMgt.ValidateShortcutDimValues(FieldNumber,NewShortcutDimCode,"New Dimension Set ID");
    END;

    PROCEDURE ShowNewShortcutDimCode@16(VAR NewShortcutDimCode@1000 : ARRAY [8] OF Code[20]);
    BEGIN
      DimMgt.GetShortcutDimensions("New Dimension Set ID",NewShortcutDimCode);
    END;

    LOCAL PROCEDURE InitRevalJnlLine@5800(ItemLedgEntry2@1000 : Record 32);
    VAR
      ItemApplnEntry@1002 : Record 339;
      ValueEntry@1001 : Record 5802;
      CostAmtActual@1003 : Decimal;
    BEGIN
      IF "Value Entry Type" <> "Value Entry Type"::Revaluation THEN
        EXIT;

      ItemLedgEntry2.TESTFIELD("Item No.","Item No.");
      ItemLedgEntry2.TESTFIELD("Completely Invoiced",TRUE);
      ItemLedgEntry2.TESTFIELD(Positive,TRUE);
      ItemApplnEntry.CheckAppliedFromEntryToAdjust(ItemLedgEntry2."Entry No.");

      VALIDATE("Entry Type",ItemLedgEntry2."Entry Type");
      "Posting Date" := ItemLedgEntry2."Posting Date";
      VALIDATE("Unit Amount",0);
      VALIDATE(Quantity,ItemLedgEntry2."Invoiced Quantity");

      ValueEntry.RESET;
      ValueEntry.SETCURRENTKEY("Item Ledger Entry No.","Entry Type");
      ValueEntry.SETRANGE("Item Ledger Entry No.",ItemLedgEntry2."Entry No.");
      ValueEntry.SETFILTER("Entry Type",'<>%1',ValueEntry."Entry Type"::Rounding);
      ValueEntry.FIND('-');
      REPEAT
        IF NOT (ValueEntry."Expected Cost" OR ValueEntry."Partial Revaluation") THEN
          CostAmtActual := CostAmtActual + ValueEntry."Cost Amount (Actual)";
      UNTIL ValueEntry.NEXT = 0;

      VALIDATE("Inventory Value (Calculated)",CostAmtActual);
      VALIDATE("Inventory Value (Revalued)",CostAmtActual);

      "Location Code" := ItemLedgEntry2."Location Code";
      "Variant Code" := ItemLedgEntry2."Variant Code";
      "Applies-to Entry" := ItemLedgEntry2."Entry No.";
      CopyDim(ItemLedgEntry2."Dimension Set ID");
    END;

    PROCEDURE CopyDocumentFields@129(DocType@1004 : Option;DocNo@1003 : Code[20];ExtDocNo@1002 : Text[35];SourceCode@1001 : Code[10];NoSeriesCode@1000 : Code[10]);
    BEGIN
      "Document Type" := DocType;
      "Document No." := DocNo;
      "External Document No." := ExtDocNo;
      "Source Code" := SourceCode;
      IF NoSeriesCode <> '' THEN
        "Posting No. Series" := NoSeriesCode;
    END;

    PROCEDURE CopyFromSalesHeader@58(SalesHeader@1000 : Record 36);
    BEGIN
      "Posting Date" := SalesHeader."Posting Date";
      "Document Date" := SalesHeader."Document Date";
      "Order Date" := SalesHeader."Order Date";
      "Source Posting Group" := SalesHeader."Customer Posting Group";
      "Salespers./Purch. Code" := SalesHeader."Salesperson Code";
      "Reason Code" := SalesHeader."Reason Code";
      "Source Currency Code" := SalesHeader."Currency Code";
    END;

    PROCEDURE CopyFromSalesLine@12(SalesLine@1000 : Record 37);
    BEGIN
      "Item No." := SalesLine."No.";
      Description := SalesLine.Description;
      "Shortcut Dimension 1 Code" := SalesLine."Shortcut Dimension 1 Code";
      "Shortcut Dimension 2 Code" := SalesLine."Shortcut Dimension 2 Code";
      "Dimension Set ID" := SalesLine."Dimension Set ID";
      "Location Code" := SalesLine."Location Code";
      "Bin Code" := SalesLine."Bin Code";
      "Variant Code" := SalesLine."Variant Code";
      "Inventory Posting Group" := SalesLine."Posting Group";
      "Gen. Bus. Posting Group" := SalesLine."Gen. Bus. Posting Group";
      "Gen. Prod. Posting Group" := SalesLine."Gen. Prod. Posting Group";
      "Transaction Type" := SalesLine."Transaction Type";
      "Transport Method" := SalesLine."Transport Method";
      "Entry/Exit Point" := SalesLine."Exit Point";
      Area := SalesLine.Area;
      "Transaction Specification" := SalesLine."Transaction Specification";
      "Drop Shipment" := SalesLine."Drop Shipment";
      "Entry Type" := "Entry Type"::Sale;
      "Unit of Measure Code" := SalesLine."Unit of Measure Code";
      "Qty. per Unit of Measure" := SalesLine."Qty. per Unit of Measure";
      "Derived from Blanket Order" := SalesLine."Blanket Order No." <> '';
      "Cross-Reference No." := SalesLine."Cross-Reference No.";
      "Originally Ordered No." := SalesLine."Originally Ordered No.";
      "Originally Ordered Var. Code" := SalesLine."Originally Ordered Var. Code";
      "Out-of-Stock Substitution" := SalesLine."Out-of-Stock Substitution";
      "Item Category Code" := SalesLine."Item Category Code";
      Nonstock := SalesLine.Nonstock;
      "Purchasing Code" := SalesLine."Purchasing Code";
      "Product Group Code" := SalesLine."Product Group Code";
      "Return Reason Code" := SalesLine."Return Reason Code";
      "Planned Delivery Date" := SalesLine."Planned Delivery Date";
      "Document Line No." := SalesLine."Line No.";
      "Unit Cost" := SalesLine."Unit Cost (LCY)";
      "Unit Cost (ACY)" := SalesLine."Unit Cost";
      "Value Entry Type" := "Value Entry Type"::"Direct Cost";
      "Source Type" := "Source Type"::Customer;
      "Source No." := SalesLine."Sell-to Customer No.";
      "Invoice-to Source No." := SalesLine."Bill-to Customer No.";
      OnAfterCopyFromSalesLine(Rec, SalesLine); //07 29.03.17 JAL
    END;

    PROCEDURE CopyFromPurchHeader@57(PurchHeader@1000 : Record 38);
    BEGIN
      "Posting Date" := PurchHeader."Posting Date";
      "Document Date" := PurchHeader."Document Date";
      "Source Posting Group" := PurchHeader."Vendor Posting Group";
      "Salespers./Purch. Code" := PurchHeader."Purchaser Code";
      "Country/Region Code" := PurchHeader."Buy-from Country/Region Code";
      "Reason Code" := PurchHeader."Reason Code";
      "Source Currency Code" := PurchHeader."Currency Code";
    END;

    PROCEDURE CopyFromPurchLine@160(PurchLine@1000 : Record 39);
    BEGIN
      "Item No." := PurchLine."No.";
      Description := PurchLine.Description;
      "Shortcut Dimension 1 Code" := PurchLine."Shortcut Dimension 1 Code";
      "Shortcut Dimension 2 Code" := PurchLine."Shortcut Dimension 2 Code";
      "Dimension Set ID" := PurchLine."Dimension Set ID";
      "Location Code" := PurchLine."Location Code";
      "Bin Code" := PurchLine."Bin Code";
      "Variant Code" := PurchLine."Variant Code";
      "Item Category Code" := PurchLine."Item Category Code";
      "Product Group Code" := PurchLine."Product Group Code";
      "Inventory Posting Group" := PurchLine."Posting Group";
      "Gen. Bus. Posting Group" := PurchLine."Gen. Bus. Posting Group";
      "Gen. Prod. Posting Group" := PurchLine."Gen. Prod. Posting Group";
      "Job No." := PurchLine."Job No.";
      "Job Task No." := PurchLine."Job Task No.";
      IF "Job No." <> '' THEN
        "Job Purchase" := TRUE;
      "Applies-to Entry" := PurchLine."Appl.-to Item Entry";
      "Transaction Type" := PurchLine."Transaction Type";
      "Transport Method" := PurchLine."Transport Method";
      "Entry/Exit Point" := PurchLine."Entry Point";
      Area := PurchLine.Area;
      "Transaction Specification" := PurchLine."Transaction Specification";
      "Drop Shipment" := PurchLine."Drop Shipment";
      "Entry Type" := "Entry Type"::Purchase;
      IF PurchLine."Prod. Order No." <> '' THEN BEGIN
        "Order Type" := "Order Type"::Production;
        "Order No." := PurchLine."Prod. Order No.";
        "Order Line No." := PurchLine."Prod. Order Line No.";
      END;
      "Unit of Measure Code" := PurchLine."Unit of Measure Code";
      "Qty. per Unit of Measure" := PurchLine."Qty. per Unit of Measure";
      "Cross-Reference No." := PurchLine."Cross-Reference No.";
      "Document Line No." := PurchLine."Line No.";
      "Unit Cost" := PurchLine."Unit Cost (LCY)";
      "Unit Cost (ACY)" := PurchLine."Unit Cost";
      "Value Entry Type" := "Value Entry Type"::"Direct Cost";
      "Source Type" := "Source Type"::Vendor;
      "Source No." := PurchLine."Buy-from Vendor No.";
      "Invoice-to Source No." := PurchLine."Pay-to Vendor No.";
      "Purchasing Code" := PurchLine."Purchasing Code";
      "Indirect Cost %" := PurchLine."Indirect Cost %";
      "Overhead Rate" := PurchLine."Overhead Rate";
      "Return Reason Code" := PurchLine."Return Reason Code";
    END;

    PROCEDURE CopyFromServHeader@59(ServiceHeader@1000 : Record 5900);
    BEGIN
      "Posting Date" := ServiceHeader."Posting Date";
      "Document Date" := ServiceHeader."Document Date";
      "Order Date" := ServiceHeader."Order Date";
      "Source Posting Group" := ServiceHeader."Customer Posting Group";
      "Salespers./Purch. Code" := ServiceHeader."Salesperson Code";
      "Country/Region Code" := ServiceHeader."VAT Country/Region Code";
      "Reason Code" := ServiceHeader."Reason Code";
      "Source Type" := "Source Type"::Customer;
      "Source No." := ServiceHeader."Customer No.";
    END;

    PROCEDURE CopyFromServLine@17(ServiceLine@1000 : Record 5902);
    BEGIN
      "Item No." := ServiceLine."No.";
      Description := ServiceLine.Description;
      "Shortcut Dimension 1 Code" := ServiceLine."Shortcut Dimension 1 Code";
      "Shortcut Dimension 2 Code" := ServiceLine."Shortcut Dimension 2 Code";
      "Dimension Set ID" := ServiceLine."Dimension Set ID";
      "Location Code" := ServiceLine."Location Code";
      "Bin Code" := ServiceLine."Bin Code";
      "Variant Code" := ServiceLine."Variant Code";
      "Inventory Posting Group" := ServiceLine."Posting Group";
      "Gen. Bus. Posting Group" := ServiceLine."Gen. Bus. Posting Group";
      "Gen. Prod. Posting Group" := ServiceLine."Gen. Prod. Posting Group";
      "Applies-to Entry" := ServiceLine."Appl.-to Item Entry";
      "Transaction Type" := ServiceLine."Transaction Type";
      "Transport Method" := ServiceLine."Transport Method";
      "Entry/Exit Point" := ServiceLine."Exit Point";
      Area := ServiceLine.Area;
      "Transaction Specification" := ServiceLine."Transaction Specification";
      "Entry Type" := "Entry Type"::Sale;
      "Unit of Measure Code" := ServiceLine."Unit of Measure Code";
      "Qty. per Unit of Measure" := ServiceLine."Qty. per Unit of Measure";
      "Derived from Blanket Order" := FALSE;
      "Item Category Code" := ServiceLine."Item Category Code";
      Nonstock := ServiceLine.Nonstock;
      "Product Group Code" := ServiceLine."Product Group Code";
      "Return Reason Code" := ServiceLine."Return Reason Code";
      "Order Type" := "Order Type"::Service;
      "Order No." := ServiceLine."Document No.";
      "Order Line No." := ServiceLine."Line No.";
      "Job No." := ServiceLine."Job No.";
      "Job Task No." := ServiceLine."Job Task No.";
    END;

    PROCEDURE CopyFromServShptHeader@53(ServShptHeader@1000 : Record 5990);
    BEGIN
      "Posting Date" := ServShptHeader."Posting Date";
      "Document Date" := ServShptHeader."Document Date";
      "Order Date" := ServShptHeader."Order Date";
      "Country/Region Code" := ServShptHeader."VAT Country/Region Code";
      "Source Posting Group" := ServShptHeader."Customer Posting Group";
      "Salespers./Purch. Code" := ServShptHeader."Salesperson Code";
      "Reason Code" := ServShptHeader."Reason Code";
    END;

    PROCEDURE CopyFromServShptLine@51(ServShptLine@1000 : Record 5991);
    BEGIN
      "Item No." := ServShptLine."No.";
      Description := ServShptLine.Description;
      "Gen. Bus. Posting Group" := ServShptLine."Gen. Bus. Posting Group";
      "Gen. Prod. Posting Group" := ServShptLine."Gen. Prod. Posting Group";
      "Inventory Posting Group" := ServShptLine."Posting Group";
      "Location Code" := ServShptLine."Location Code";
      "Unit of Measure Code" := ServShptLine."Unit of Measure Code";
      "Qty. per Unit of Measure" := ServShptLine."Qty. per Unit of Measure";
      "Variant Code" := ServShptLine."Variant Code";
      "Bin Code" := ServShptLine."Bin Code";
      "Shortcut Dimension 1 Code" := ServShptLine."Shortcut Dimension 1 Code";
      "Shortcut Dimension 2 Code" := ServShptLine."Shortcut Dimension 2 Code";
      "Dimension Set ID" := ServShptLine."Dimension Set ID";
      "Entry/Exit Point" := ServShptLine."Exit Point";
      "Value Entry Type" := ItemJnlLine."Value Entry Type"::"Direct Cost";
      "Transaction Type" := ServShptLine."Transaction Type";
      "Transport Method" := ServShptLine."Transport Method";
      Area := ServShptLine.Area;
      "Transaction Specification" := ServShptLine."Transaction Specification";
      "Qty. per Unit of Measure" := ServShptLine."Qty. per Unit of Measure";
      "Item Category Code" := ServShptLine."Item Category Code";
      Nonstock := ServShptLine.Nonstock;
      "Product Group Code" := ServShptLine."Product Group Code";
      "Return Reason Code" := ServShptLine."Return Reason Code";
    END;

    PROCEDURE CopyFromServShptLineUndo@60(ServShptLine@1000 : Record 5991);
    BEGIN
      "Item No." := ServShptLine."No.";
      "Order Date" := ServShptLine."Order Date";
      "Inventory Posting Group" := ServShptLine."Posting Group";
      "Gen. Bus. Posting Group" := ServShptLine."Gen. Bus. Posting Group";
      "Gen. Prod. Posting Group" := ServShptLine."Gen. Prod. Posting Group";
      "Location Code" := ServShptLine."Location Code";
      "Variant Code" := ServShptLine."Variant Code";
      "Bin Code" := ServShptLine."Bin Code";
      "Entry/Exit Point" := ServShptLine."Exit Point";
      "Shortcut Dimension 1 Code" := ServShptLine."Shortcut Dimension 1 Code";
      "Shortcut Dimension 2 Code" := ServShptLine."Shortcut Dimension 2 Code";
      "Dimension Set ID" := ServShptLine."Dimension Set ID";
      "Value Entry Type" := "Value Entry Type"::"Direct Cost";
      "Item No." := ServShptLine."No.";
      Description := ServShptLine.Description;
      "Location Code" := ServShptLine."Location Code";
      "Variant Code" := ServShptLine."Variant Code";
      "Transaction Type" := ServShptLine."Transaction Type";
      "Transport Method" := ServShptLine."Transport Method";
      Area := ServShptLine.Area;
      "Transaction Specification" := ServShptLine."Transaction Specification";
      "Unit of Measure Code" := ServShptLine."Unit of Measure Code";
      "Qty. per Unit of Measure" := ServShptLine."Qty. per Unit of Measure";
      "Derived from Blanket Order" := FALSE;
      "Item Category Code" := ServShptLine."Item Category Code";
      Nonstock := ServShptLine.Nonstock;
      "Product Group Code" := ServShptLine."Product Group Code";
      "Return Reason Code" := ServShptLine."Return Reason Code";
    END;

    LOCAL PROCEDURE ReadGLSetup@5801();
    BEGIN
      IF NOT GLSetupRead THEN BEGIN
        GLSetup.GET;
        GLSetupRead := TRUE;
      END;
    END;

    LOCAL PROCEDURE RetrieveCosts@5803();
    VAR
      StockkeepingUnit@1000 : Record 5700;
    BEGIN
      IF ("Value Entry Type" <> "Value Entry Type"::"Direct Cost") OR
         ("Item Charge No." <> '')
      THEN
        EXIT;

      ReadGLSetup;
      GetItem;
      IF StockkeepingUnit.GET("Location Code","Item No.","Variant Code") THEN
        UnitCost := StockkeepingUnit."Unit Cost"
      ELSE
        UnitCost := Item."Unit Cost";

      IF "Entry Type" = "Entry Type"::Transfer THEN
        UnitCost := 0
      ELSE
        IF Item."Costing Method" <> Item."Costing Method"::Standard THEN
          UnitCost := ROUND(UnitCost,GLSetup."Unit-Amount Rounding Precision");
    END;

    LOCAL PROCEDURE CalcUnitCost@5804(ItemLedgEntry@1000 : Record 32) : Decimal;
    VAR
      ValueEntry@1001 : Record 5802;
      UnitCost@1002 : Decimal;
    BEGIN
      WITH ValueEntry DO BEGIN
        RESET;
        SETCURRENTKEY("Item Ledger Entry No.");
        SETRANGE("Item Ledger Entry No.",ItemLedgEntry."Entry No.");
        CALCSUMS("Cost Amount (Expected)","Cost Amount (Actual)");
        UnitCost :=
          ("Cost Amount (Expected)" + "Cost Amount (Actual)") / ItemLedgEntry.Quantity;
      END;
      EXIT(ABS(UnitCost * "Qty. per Unit of Measure"));
    END;

    LOCAL PROCEDURE ClearSingleAndRolledUpCosts@4();
    BEGIN
      "Single-Level Material Cost" := "Unit Cost (Revalued)";
      "Single-Level Capacity Cost" := 0;
      "Single-Level Subcontrd. Cost" := 0;
      "Single-Level Cap. Ovhd Cost" := 0;
      "Single-Level Mfg. Ovhd Cost" := 0;
      "Rolled-up Material Cost" := "Unit Cost (Revalued)";
      "Rolled-up Capacity Cost" := 0;
      "Rolled-up Subcontracted Cost" := 0;
      "Rolled-up Mfg. Ovhd Cost" := 0;
      "Rolled-up Cap. Overhead Cost" := 0;
    END;

    LOCAL PROCEDURE GetMfgSetup@7();
    BEGIN
      IF NOT MfgSetupRead THEN
        MfgSetup.GET;
      MfgSetupRead := TRUE;
    END;

    LOCAL PROCEDURE GetProdOrderRtngLine@27(VAR ProdOrderRtngLine@1000 : Record 5409);
    BEGIN
      TESTFIELD("Order Type","Order Type"::Production);
      TESTFIELD("Order No.");
      TESTFIELD("Operation No.");

      ProdOrderRtngLine.GET(
        ProdOrderRtngLine.Status::Released,
        "Order No.","Routing Reference No.","Routing No.","Operation No.");
    END;

    PROCEDURE OnlyStopTime@24() : Boolean;
    BEGIN
      EXIT(("Setup Time" = 0) AND ("Run Time" = 0) AND ("Stop Time" <> 0));
    END;

    PROCEDURE OutputValuePosting@29() : Boolean;
    BEGIN
      EXIT(TimeIsEmpty AND ("Invoiced Quantity" <> 0) AND NOT Subcontracting);
    END;

    PROCEDURE TimeIsEmpty@26() : Boolean;
    BEGIN
      EXIT(("Setup Time" = 0) AND ("Run Time" = 0) AND ("Stop Time" = 0));
    END;

    PROCEDURE RowID1@44() : Text[250];
    VAR
      ItemTrackingMgt@1000 : Codeunit 6500;
    BEGIN
      EXIT(
        ItemTrackingMgt.ComposeRowID(DATABASE::"Item Journal Line","Entry Type",
          "Journal Template Name","Journal Batch Name",0,"Line No."));
    END;

    LOCAL PROCEDURE GetLocation@7300(LocationCode@1000 : Code[10]);
    BEGIN
      IF LocationCode = '' THEN
        CLEAR(Location)
      ELSE
        IF Location.Code <> LocationCode THEN
          Location.GET(LocationCode);
    END;

    LOCAL PROCEDURE GetBin@36(LocationCode@1000 : Code[10];BinCode@1001 : Code[20]);
    BEGIN
      IF BinCode = '' THEN
        CLEAR(Bin)
      ELSE
        IF (Bin.Code <> BinCode) OR (Bin."Location Code" <> LocationCode) THEN
          Bin.GET(LocationCode,BinCode);
    END;

    PROCEDURE ItemPosting@33() : Boolean;
    VAR
      ProdOrderRtngLine@1000 : Record 5409;
    BEGIN
      IF ("Entry Type" = "Entry Type"::Output) AND
         ("Output Quantity" <> 0) AND
         ("Operation No." <> '')
      THEN BEGIN
        ProdOrderRtngLine.GET(
          ProdOrderRtngLine.Status::Released,
          "Order No.",
          "Routing Reference No.",
          "Routing No.",
          "Operation No.");
        EXIT(ProdOrderRtngLine."Next Operation No." = '');
      END;
      EXIT(TRUE);
    END;

    LOCAL PROCEDURE CheckPlanningAssignment@34();
    BEGIN
      IF ("Quantity (Base)" <> 0) AND ("Item No." <> '') AND ("Posting Date" <> 0D) AND
         ("Entry Type" IN ["Entry Type"::"Negative Adjmt.","Entry Type"::"Positive Adjmt.","Entry Type"::Transfer])
      THEN BEGIN
        IF ("Entry Type" = "Entry Type"::Transfer) AND ("Location Code" = "New Location Code") THEN
          EXIT;

        ReserveItemJnlLine.AssignForPlanning(Rec);
      END;
    END;

    PROCEDURE LastOutputOperation@35(ItemJnlLine@1000 : Record 83) : Boolean;
    VAR
      ProdOrderRtngLine@1002 : Record 5409;
      ItemJnlPostLine@1001 : Codeunit 22;
      Operation@1003 : Boolean;
    BEGIN
      WITH ItemJnlLine DO BEGIN
        IF "Operation No." <> '' THEN BEGIN
          TESTFIELD("Routing No.");
          IF NOT ProdOrderRtngLine.GET(
               ProdOrderRtngLine.Status::Released,"Order No.",
               "Routing Reference No.","Routing No.","Operation No.")
          THEN
            ProdOrderRtngLine.GET(
              ProdOrderRtngLine.Status::Finished,"Order No.",
              "Routing Reference No.","Routing No.","Operation No.");
          IF Finished THEN
            ProdOrderRtngLine."Routing Status" := ProdOrderRtngLine."Routing Status"::Finished
          ELSE
            ProdOrderRtngLine."Routing Status" := ProdOrderRtngLine."Routing Status"::"In Progress";
          Operation := NOT ItemJnlPostLine.NextOperationExist(ProdOrderRtngLine);
        END ELSE
          Operation := TRUE;
      END;
      EXIT(Operation);
    END;

    PROCEDURE LookupItemNo@37();
    VAR
      ItemList@1000 : Page 31;
    BEGIN
      CASE "Entry Type" OF
        "Entry Type"::Consumption:
          LookupProdOrderComp;
        "Entry Type"::Output:
          LookupProdOrderLine;
        ELSE BEGIN
          ItemList.LOOKUPMODE := TRUE;
          IF ItemList.RUNMODAL = ACTION::LookupOK THEN BEGIN
            ItemList.GETRECORD(Item);
            VALIDATE("Item No.",Item."No.");
          END;
        END;
      END;
    END;

    LOCAL PROCEDURE LookupProdOrderLine@32();
    VAR
      ProdOrderLine@1004 : Record 5406;
      ProdOrderLineList@1001 : Page 5406;
    BEGIN
      ProdOrderLine.SetFilterByReleasedOrderNo("Order No.");
      ProdOrderLine.Status := ProdOrderLine.Status::Released;
      ProdOrderLine."Prod. Order No." := "Order No.";
      ProdOrderLine."Line No." := "Order Line No.";
      ProdOrderLine."Item No." := "Item No.";

      ProdOrderLineList.LOOKUPMODE(TRUE);
      ProdOrderLineList.SETTABLEVIEW(ProdOrderLine);
      ProdOrderLineList.SETRECORD(ProdOrderLine);

      IF ProdOrderLineList.RUNMODAL = ACTION::LookupOK THEN BEGIN
        ProdOrderLineList.GETRECORD(ProdOrderLine);
        VALIDATE("Item No.",ProdOrderLine."Item No.");
        IF "Order Line No." <> ProdOrderLine."Line No." THEN
          VALIDATE("Order Line No.",ProdOrderLine."Line No.");
      END;
    END;

    LOCAL PROCEDURE LookupProdOrderComp@11();
    VAR
      ProdOrderComp@1004 : Record 5407;
      ProdOrderCompLineList@1001 : Page 5407;
    BEGIN
      ProdOrderComp.SetFilterByReleasedOrderNo("Order No.");
      ProdOrderComp.Status := ProdOrderComp.Status::Released;
      ProdOrderComp."Prod. Order No." := "Order No.";
      ProdOrderComp."Prod. Order Line No." := "Order Line No.";
      ProdOrderComp."Line No." := "Prod. Order Comp. Line No.";
      ProdOrderComp."Item No." := "Item No.";

      ProdOrderCompLineList.LOOKUPMODE(TRUE);
      ProdOrderCompLineList.SETTABLEVIEW(ProdOrderComp);
      ProdOrderCompLineList.SETRECORD(ProdOrderComp);

      IF ProdOrderCompLineList.RUNMODAL = ACTION::LookupOK THEN BEGIN
        ProdOrderCompLineList.GETRECORD(ProdOrderComp);
        IF "Prod. Order Comp. Line No." <> ProdOrderComp."Line No." THEN BEGIN
          VALIDATE("Item No.",ProdOrderComp."Item No.");
          VALIDATE("Prod. Order Comp. Line No.",ProdOrderComp."Line No.");
        END;
      END;
    END;

    PROCEDURE RecalculateUnitAmount@38();
    VAR
      ItemJnlLine1@1000 : Record 83;
    BEGIN
      GetItem;

      IF ("Value Entry Type" <> "Value Entry Type"::"Direct Cost") OR
         ("Item Charge No." <> '')
      THEN BEGIN
        "Indirect Cost %" := 0;
        "Overhead Rate" := 0;
      END ELSE BEGIN
        "Indirect Cost %" := Item."Indirect Cost %";
        "Overhead Rate" := Item."Overhead Rate";
      END;

      "Qty. per Unit of Measure" := UOMMgt.GetQtyPerUnitOfMeasure(Item,"Unit of Measure Code");
      GetUnitAmount(FIELDNO("Unit of Measure Code"));

      ReadGLSetup;

      UpdateAmount;

      CASE "Entry Type" OF
        "Entry Type"::Purchase:
          BEGIN
            ItemJnlLine1.COPY(Rec);
            PurchPriceCalcMgt.FindItemJnlLinePrice(ItemJnlLine1,FIELDNO("Unit of Measure Code"));
            "Unit Cost" := ROUND(ItemJnlLine1."Unit Amount" * "Qty. per Unit of Measure",GLSetup."Unit-Amount Rounding Precision");
          END;
        "Entry Type"::Sale:
          "Unit Cost" := ROUND(UnitCost * "Qty. per Unit of Measure",GLSetup."Unit-Amount Rounding Precision");
        "Entry Type"::"Positive Adjmt.":
          "Unit Cost" :=
            ROUND(
              "Unit Amount" * (1 + "Indirect Cost %" / 100),GLSetup."Unit-Amount Rounding Precision") +
            "Overhead Rate" * "Qty. per Unit of Measure";
        "Entry Type"::"Negative Adjmt.":
          IF NOT "Phys. Inventory" THEN
            "Unit Cost" := UnitCost * "Qty. per Unit of Measure";
      END;

      IF "Entry Type" IN ["Entry Type"::Purchase,"Entry Type"::"Positive Adjmt."] THEN BEGIN
        IF Item."Costing Method" = Item."Costing Method"::Standard THEN
          "Unit Cost" := ROUND(UnitCost * "Qty. per Unit of Measure",GLSetup."Unit-Amount Rounding Precision");
      END;
    END;

    PROCEDURE IsReclass@40(ItemJnlLine@1000 : Record 83) : Boolean;
    BEGIN
      IF (ItemJnlLine."Entry Type" = ItemJnlLine."Entry Type"::Transfer) AND
         ((ItemJnlLine."Order Type" <> ItemJnlLine."Order Type"::Transfer) OR (ItemJnlLine."Order No." = ''))
      THEN
        EXIT(TRUE);
      EXIT(FALSE);
    END;

    PROCEDURE CheckWhse@39(LocationCode@1000 : Code[20];VAR QtyToPost@1002 : Decimal);
    VAR
      Location@1001 : Record 14;
    BEGIN
      Location.GET(LocationCode);
      IF Location."Require Put-away" AND
         (NOT Location."Directed Put-away and Pick") AND
         (NOT Location."Require Receive")
      THEN
        QtyToPost := 0;
    END;

    PROCEDURE ShowDimensions@41();
    BEGIN
      "Dimension Set ID" :=
        DimMgt.EditDimensionSet2(
          "Dimension Set ID",STRSUBSTNO('%1 %2 %3',"Journal Template Name","Journal Batch Name","Line No."),
          "Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
    END;

    PROCEDURE ShowReclasDimensions@30();
    BEGIN
      DimMgt.EditReclasDimensionSet2(
        "Dimension Set ID","New Dimension Set ID",STRSUBSTNO('%1 %2 %3',"Journal Template Name","Journal Batch Name","Line No."),
        "Shortcut Dimension 1 Code","Shortcut Dimension 2 Code","New Shortcut Dimension 1 Code","New Shortcut Dimension 2 Code");
    END;

    PROCEDURE PostingItemJnlFromProduction@43(Print@1000 : Boolean);
    VAR
      ProductionOrder@1001 : Record 5405;
    BEGIN
      IF ("Order Type" = "Order Type"::Production) AND ("Order No." <> '') THEN
        ProductionOrder.GET(ProductionOrder.Status::Released,"Order No.");
      IF Print THEN
        CODEUNIT.RUN(CODEUNIT::"Item Jnl.-Post+Print",Rec)
      ELSE
        CODEUNIT.RUN(CODEUNIT::"Item Jnl.-Post",Rec);
    END;

    PROCEDURE IsAssemblyResourceConsumpLine@87() : Boolean;
    BEGIN
      EXIT(("Entry Type" = "Entry Type"::"Assembly Output") AND (Type = Type::Resource));
    END;

    PROCEDURE IsAssemblyOutputLine@89() : Boolean;
    BEGIN
      EXIT(("Entry Type" = "Entry Type"::"Assembly Output") AND (Type = Type::" "));
    END;

    PROCEDURE IsATOCorrection@10() : Boolean;
    VAR
      ItemLedgEntry@1000 : Record 32;
      PostedATOLink@1001 : Record 914;
    BEGIN
      IF NOT Correction THEN
        EXIT(FALSE);
      IF "Entry Type" <> "Entry Type"::Sale THEN
        EXIT(FALSE);
      IF NOT ItemLedgEntry.GET("Applies-to Entry") THEN
        EXIT(FALSE);
      IF ItemLedgEntry."Entry Type" <> ItemLedgEntry."Entry Type"::Sale THEN
        EXIT(FALSE);
      PostedATOLink.SETCURRENTKEY("Document Type","Document No.","Document Line No.");
      PostedATOLink.SETRANGE("Document Type",PostedATOLink."Document Type"::"Sales Shipment");
      PostedATOLink.SETRANGE("Document No.",ItemLedgEntry."Document No.");
      PostedATOLink.SETRANGE("Document Line No.",ItemLedgEntry."Document Line No.");
      EXIT(NOT PostedATOLink.ISEMPTY);
    END;

    LOCAL PROCEDURE RevaluationPerEntryAllowed@45(ItemNo@1000 : Code[20]) : Boolean;
    VAR
      ValueEntry@1001 : Record 5802;
    BEGIN
      GetItem;
      IF Item."Costing Method" <> Item."Costing Method"::Average THEN
        EXIT(TRUE);

      ValueEntry.SETRANGE("Item No.",ItemNo);
      ValueEntry.SETRANGE("Entry Type",ValueEntry."Entry Type"::Revaluation);
      ValueEntry.SETRANGE("Partial Revaluation",TRUE);
      EXIT(ValueEntry.ISEMPTY);
    END;

    PROCEDURE TrackingExists@47() : Boolean;
    BEGIN
      EXIT(("Serial No." <> '') OR ("Lot No." <> ''));
    END;

    PROCEDURE IsPurchaseReturn@49() : Boolean;
    BEGIN
      EXIT(
        ("Document Type" IN ["Document Type"::"Purchase Credit Memo",
                             "Document Type"::"Purchase Return Shipment",
                             "Document Type"::"Purchase Invoice",
                             "Document Type"::"Purchase Receipt"]) AND
        (Quantity < 0));
    END;

    PROCEDURE IsOpenedFromBatch@50() : Boolean;
    VAR
      ItemJournalBatch@1002 : Record 233;
      TemplateFilter@1001 : Text;
      BatchFilter@1000 : Text;
    BEGIN
      BatchFilter := GETFILTER("Journal Batch Name");
      IF BatchFilter <> '' THEN BEGIN
        TemplateFilter := GETFILTER("Journal Template Name");
        IF TemplateFilter <> '' THEN
          ItemJournalBatch.SETFILTER("Journal Template Name",TemplateFilter);
        ItemJournalBatch.SETFILTER(Name,BatchFilter);
        ItemJournalBatch.FINDFIRST;
      END;

      EXIT((("Journal Batch Name" <> '') AND ("Journal Template Name" = '')) OR (BatchFilter <> ''));
    END;

    PROCEDURE SubcontractingWorkCenterUsed@52() : Boolean;
    VAR
      WorkCenter@1000 : Record 99000754;
    BEGIN
      IF Type = Type::"Work Center" THEN
        IF WorkCenter.GET("Work Center No.") THEN
          EXIT(WorkCenter."Subcontractor No." <> '');

      EXIT(FALSE);
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterCopyFromSalesLine@1101103000(VAR ItemJournalLineP@1101103000 : Record 83;VAR SalesLineP@1101103001 : Record 37);
    BEGIN
    END;

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 13.11.03 HHE Sjekker om varen er en Simuleringsvare
      02. 16.11.03 HHE Lagt til feltet "shelf no." (brukes i varetelling-sortering)
                       Opprettet feltet "Beskr. 2"
                       Ved validering av "Item No." settes "BEskr. 2" og "Shelf No." inn.
                       Ny Key:Journal Template Name,Journal Batch Name,Shelf No.
      03. 07.12.05 ASL Nytt felt "Print Cap.Ledger Entry" brukes til utskrift av kvitteringsliste p† kapasitetsposter
      04. 04.04.06 ASL Nytt felt "Routing Link Code". Brukes til † sortere varer p† forbrukskladd p† monteringsstasjoner.
      05. 10.03.08 HHe/MBS Kode som gir riktig oppslag p† varenr. fra varekladd.
                       Removed when upgraded to NAV 2017 CU3
      06. 12.01.09 BVM Utvidet felt Shelf nr. fra 10 til 15 tegn
      07. 29.03.17 JAL Moved Code to Events
      08. 16.11.09 HHE "Stop Code" and "Scrap Code": 10 -> 20 digits
                              New field: "Comment at p.o.route line" and "Scrap Comment"
    }
    END.
  }
}

OBJECT Table 5407 Prod. Order Component
{
  OBJECT-PROPERTIES
  {
    Date=28.09.17;
    Time=14:45:11;
    Modified=Yes;
    Version List=NAVW110.00.00.14199,INC1.08,OPC6.08;
  }
  PROPERTIES
  {
    DataCaptionFields=Status,Prod. Order No.;
    OnInsert=BEGIN
               IF Status = Status::Finished THEN
                 ERROR(Text000);

               ReserveProdOrderComp.VerifyQuantity(Rec,xRec);

               IF Status = Status::Released THEN
                 WhseProdRelease.ReleaseLine(Rec,xRec);
             END;

    OnModify=BEGIN
               IF Status = Status::Finished THEN
                 ERROR(Text000);

               WhseValidateSourceLine.ProdComponentVerifyChange(Rec,xRec);
               ReserveProdOrderComp.VerifyChange(Rec,xRec);
               IF Status = Status::Released THEN
                 WhseProdRelease.ReleaseLine(Rec,xRec);
             END;

    OnDelete=VAR
               ProdOrderLine@1000 : Record 5406;
               ProdOrderBOMComment@1001 : Record 5416;
               ItemLedgEntry@1004 : Record 32;
               ItemTrackingMgt@1002 : Codeunit 6500;
               NewQuantity@1003 : Decimal;
             BEGIN
               IF Status = Status::Finished THEN
                 ERROR(Text000);
               IF Status = Status::Released THEN BEGIN
                 ItemLedgEntry.SETCURRENTKEY("Order Type","Order No.","Order Line No.","Entry Type","Prod. Order Comp. Line No.");
                 ItemLedgEntry.SETRANGE("Order Type",ItemLedgEntry."Order Type"::Production);
                 ItemLedgEntry.SETRANGE("Order No.","Prod. Order No.");
                 ItemLedgEntry.SETRANGE("Order Line No.","Prod. Order Line No.");
                 ItemLedgEntry.SETRANGE("Entry Type",ItemLedgEntry."Entry Type"::Consumption);
                 ItemLedgEntry.SETRANGE("Prod. Order Comp. Line No.","Line No.");
                 IF ItemLedgEntry.FINDFIRST THEN
                   ERROR(Text99000000,ItemLedgEntry."Item No.","Line No.");
               END;

               WhseValidateSourceLine.ProdComponentDelete(Rec);
               ReserveProdOrderComp.DeleteLine(Rec);

               CALCFIELDS("Reserved Qty. (Base)");
               TESTFIELD("Reserved Qty. (Base)",0);

               IF "Supplied-by Line No." > 0 THEN
                 IF ProdOrderLine.GET(Status,"Prod. Order No.","Supplied-by Line No.") THEN BEGIN
                   NewQuantity := ProdOrderLine.Quantity - "Expected Quantity";
                   IF NewQuantity = 0 THEN BEGIN
                     ProdOrderLine.SetCalledFromComponent(TRUE);
                     ProdOrderLine.DELETE(TRUE);
                   END ELSE BEGIN
                     ProdOrderLine.VALIDATE(Quantity,NewQuantity);
                     ProdOrderLine.MODIFY;
                     ProdOrderLine.UpdateProdOrderComp(ProdOrderLine."Qty. per Unit of Measure");
                   END;
                 END;

               ProdOrderBOMComment.SETRANGE(Status,Status);
               ProdOrderBOMComment.SETRANGE("Prod. Order No.","Prod. Order No.");
               ProdOrderBOMComment.SETRANGE("Prod. Order Line No.","Prod. Order Line No.");
               ProdOrderBOMComment.SETRANGE("Prod. Order BOM Line No.","Line No.");
               ProdOrderBOMComment.DELETEALL;

               WhseProdRelease.DeleteLine(Rec);

               ItemTrackingMgt.DeleteWhseItemTrkgLines(
                 DATABASE::"Prod. Order Component",Status,"Prod. Order No.",'',
                 "Prod. Order Line No.","Line No.","Location Code",TRUE);
             END;

    OnRename=BEGIN
               ERROR(Text99000001,TABLECAPTION);
             END;

    CaptionML=[ENU=Prod. Order Component;
               NOR=Prod.ordrekomponent];
    LookupPageID=Page5407;
    DrillDownPageID=Page5407;
  }
  FIELDS
  {
    { 1   ;   ;Status              ;Option        ;CaptionML=[ENU=Status;
                                                              NOR=Status];
                                                   OptionCaptionML=[ENU=Simulated,Planned,Firm Planned,Released,Finished;
                                                                    NOR=Simulert,Planlagt,Fast planlagt,Frigitt,Ferdig];
                                                   OptionString=Simulated,Planned,Firm Planned,Released,Finished }
    { 2   ;   ;Prod. Order No.     ;Code20        ;TableRelation="Production Order".No. WHERE (Status=FIELD(Status));
                                                   CaptionML=[ENU=Prod. Order No.;
                                                              NOR=Prod.ordrenr.] }
    { 3   ;   ;Prod. Order Line No.;Integer       ;TableRelation="Prod. Order Line"."Line No." WHERE (Status=FIELD(Status),
                                                                                                      Prod. Order No.=FIELD(Prod. Order No.));
                                                   CaptionML=[ENU=Prod. Order Line No.;
                                                              NOR=Prod.ordrelinjenr.] }
    { 4   ;   ;Line No.            ;Integer       ;CaptionML=[ENU=Line No.;
                                                              NOR=Linjenr.] }
    { 11  ;   ;Item No.            ;Code20        ;TableRelation=Item WHERE (Type=CONST(Inventory));
                                                   OnValidate=BEGIN
                                                                WhseValidateSourceLine.ProdComponentVerifyChange(Rec,xRec);
                                                                ReserveProdOrderComp.VerifyChange(Rec,xRec);
                                                                CALCFIELDS("Reserved Qty. (Base)");
                                                                TESTFIELD("Reserved Qty. (Base)",0);
                                                                TESTFIELD("Remaining Qty. (Base)","Expected Qty. (Base)");
                                                                IF "Item No." = '' THEN BEGIN
                                                                  CreateDim(DATABASE::Item,"Item No.");
                                                                  EXIT;
                                                                END;

                                                                Item.GET("Item No.");
                                                                IF "Item No." <> xRec."Item No." THEN BEGIN
                                                                  "Variant Code" := '';
                                                                  GetDefaultBin;
                                                                  ClearCalcFormula;
                                                                  IF "Quantity per" <> 0 THEN
                                                                    VALIDATE("Quantity per");
                                                                END;
                                                                Description := Item.Description;
                                                                Item.TESTFIELD("Base Unit of Measure");
                                                                VALIDATE("Unit of Measure Code",Item."Base Unit of Measure");
                                                                GetUpdateFromSKU;
                                                                CreateDim(DATABASE::Item,"Item No.");
                                                                DimMgt.UpdateGlobalDimFromDimSetID("Dimension Set ID","Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
                                                              END;

                                                   CaptionML=[ENU=Item No.;
                                                              NOR=Varenr.] }
    { 12  ;   ;Description         ;Text50        ;CaptionML=[ENU=Description;
                                                              NOR=Beskrivelse] }
    { 13  ;   ;Unit of Measure Code;Code10        ;TableRelation="Item Unit of Measure".Code WHERE (Item No.=FIELD(Item No.));
                                                   OnValidate=BEGIN
                                                                WhseValidateSourceLine.ProdComponentVerifyChange(Rec,xRec);

                                                                Item.GET("Item No.");
                                                                GetGLSetup;

                                                                "Qty. per Unit of Measure" := UOMMgt.GetQtyPerUnitOfMeasure(Item,"Unit of Measure Code");
                                                                "Quantity (Base)" := CalcBaseQty(Quantity);

                                                                UpdateUnitCost;

                                                                VALIDATE("Expected Quantity",Quantity * ProdOrderNeeds);
                                                              END;

                                                   CaptionML=[ENU=Unit of Measure Code;
                                                              NOR=Enhetskode] }
    { 14  ;   ;Quantity            ;Decimal       ;CaptionML=[ENU=Quantity;
                                                              NOR=Antall];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 15  ;   ;Position            ;Code10        ;CaptionML=[ENU=Position;
                                                              NOR=Posisjon] }
    { 16  ;   ;Position 2          ;Code10        ;CaptionML=[ENU=Position 2;
                                                              NOR=Posisjon 2] }
    { 17  ;   ;Position 3          ;Code10        ;CaptionML=[ENU=Position 3;
                                                              NOR=Posisjon 3] }
    { 18  ;   ;Lead-Time Offset    ;DateFormula   ;CaptionML=[ENU=Lead-Time Offset;
                                                              NOR=Forskyvning av leveringstid] }
    { 19  ;   ;Routing Link Code   ;Code10        ;TableRelation="Routing Link";
                                                   OnValidate=VAR
                                                                ProdOrderLine@1000 : Record 5406;
                                                                ProdOrderRtngLine@1001 : Record 5409;
                                                              BEGIN
                                                                VALIDATE("Expected Quantity",Quantity * ProdOrderNeeds);

                                                                ProdOrderLine.GET(Status,"Prod. Order No.","Prod. Order Line No.");

                                                                "Due Date" := ProdOrderLine."Starting Date";
                                                                "Due Time" := ProdOrderLine."Starting Time";
                                                                IF "Routing Link Code" <> '' THEN BEGIN
                                                                  ProdOrderRtngLine.SETRANGE(Status,Status);
                                                                  ProdOrderRtngLine.SETRANGE("Prod. Order No.","Prod. Order No.");
                                                                  ProdOrderRtngLine.SETRANGE("Routing No.",ProdOrderLine."Routing No.");
                                                                  ProdOrderRtngLine.SETRANGE("Routing Reference No.",ProdOrderLine."Routing Reference No.");
                                                                  ProdOrderRtngLine.SETRANGE("Routing Link Code","Routing Link Code");
                                                                  IF ProdOrderRtngLine.FINDFIRST THEN BEGIN
                                                                    "Due Date" := ProdOrderRtngLine."Starting Date";
                                                                    "Due Time" := ProdOrderRtngLine."Starting Time";
                                                                  END;
                                                                END;
                                                                IF FORMAT("Lead-Time Offset") <> '' THEN BEGIN
                                                                  "Due Date" :=
                                                                    "Due Date" -
                                                                    (CALCDATE("Lead-Time Offset",WORKDATE) - WORKDATE);
                                                                  "Due Time" := 0T;
                                                                END;
                                                                VALIDATE("Due Date");

                                                                IF "Routing Link Code" <> xRec."Routing Link Code" THEN
                                                                  UpdateBin(Rec,FIELDNO("Routing Link Code"),FIELDCAPTION("Routing Link Code"));
                                                              END;

                                                   CaptionML=[ENU=Routing Link Code;
                                                              NOR=Rutekoblingskode] }
    { 20  ;   ;Scrap %             ;Decimal       ;OnValidate=BEGIN
                                                                VALIDATE("Calculation Formula");
                                                              END;

                                                   CaptionML=[ENU=Scrap %;
                                                              NOR=Vrak-%];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0;
                                                   MaxValue=100 }
    { 21  ;   ;Variant Code        ;Code10        ;TableRelation="Item Variant".Code WHERE (Item No.=FIELD(Item No.));
                                                   OnValidate=VAR
                                                                ItemVariant@1000 : Record 5401;
                                                              BEGIN
                                                                IF Item."No." <> "Item No." THEN
                                                                  Item.GET("Item No.");
                                                                IF "Variant Code" = '' THEN
                                                                  Description := Item.Description
                                                                ELSE BEGIN
                                                                  ItemVariant.GET("Item No.","Variant Code");
                                                                  Description := ItemVariant.Description;
                                                                END;
                                                                GetDefaultBin;
                                                                WhseValidateSourceLine.ProdComponentVerifyChange(Rec,xRec);
                                                                ReserveProdOrderComp.VerifyChange(Rec,xRec);
                                                                CALCFIELDS("Reserved Qty. (Base)");
                                                                TESTFIELD("Reserved Qty. (Base)",0);
                                                                TESTFIELD("Remaining Qty. (Base)","Expected Qty. (Base)");
                                                                UpdateUnitCost;
                                                                VALIDATE("Expected Quantity");
                                                                GetUpdateFromSKU;
                                                              END;

                                                   CaptionML=[ENU=Variant Code;
                                                              NOR=Variantkode] }
    { 25  ;   ;Expected Quantity   ;Decimal       ;OnValidate=BEGIN
                                                                IF Item.GET("Item No.") THEN
                                                                  IF Item."Rounding Precision" > 0 THEN
                                                                    "Expected Quantity" := ROUND("Expected Quantity",Item."Rounding Precision",'>');
                                                                "Expected Qty. (Base)" := ROUND("Expected Quantity" * "Qty. per Unit of Measure",0.00001);
                                                                IF (Status IN [Status::Released,Status::Finished]) AND
                                                                   (xRec."Item No." <> '') AND
                                                                   ("Line No." <> 0)
                                                                THEN
                                                                  CALCFIELDS("Act. Consumption (Qty)");
                                                                "Remaining Quantity" := "Expected Quantity" - "Act. Consumption (Qty)" / "Qty. per Unit of Measure";
                                                                IF ("Remaining Quantity" * "Expected Quantity") <= 0 THEN
                                                                  "Remaining Quantity" := 0;
                                                                "Remaining Qty. (Base)" := ROUND("Remaining Quantity" * "Qty. per Unit of Measure",0.00001);
                                                                "Completely Picked" := "Qty. Picked" >= "Expected Quantity";

                                                                ReserveProdOrderComp.VerifyQuantity(Rec,xRec);

                                                                "Cost Amount" := ROUND("Expected Quantity" * "Unit Cost");
                                                                "Overhead Amount" :=
                                                                  ROUND(
                                                                    "Expected Quantity" *
                                                                    (("Direct Unit Cost" * "Indirect Cost %" / 100) + "Overhead Rate"));
                                                                "Direct Cost Amount" := ROUND("Expected Quantity" * "Direct Unit Cost");
                                                              END;

                                                   CaptionML=[ENU=Expected Quantity;
                                                              NOR=Forventet antall];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 26  ;   ;Remaining Quantity  ;Decimal       ;CaptionML=[ENU=Remaining Quantity;
                                                              NOR=Restantall];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 27  ;   ;Act. Consumption (Qty);Decimal     ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Item Ledger Entry".Quantity WHERE (Entry Type=CONST(Consumption),
                                                                                                        Order Type=CONST(Production),
                                                                                                        Order No.=FIELD(Prod. Order No.),
                                                                                                        Order Line No.=FIELD(Prod. Order Line No.),
                                                                                                        Prod. Order Comp. Line No.=FIELD(Line No.)));
                                                   AccessByPermission=TableData 5405=R;
                                                   CaptionML=[ENU=Act. Consumption (Qty);
                                                              NOR=Fakt. forbruk (ant.)];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 28  ;   ;Flushing Method     ;Option        ;OnValidate=VAR
                                                                ItemLedgEntry@1000 : Record 32;
                                                                PickWhseWorksheetLine@1001 : Record 7326;
                                                              BEGIN
                                                                IF ("Flushing Method" = "Flushing Method"::Backward) AND (Status = Status::Released) THEN BEGIN
                                                                  ItemLedgEntry.SETRANGE("Order Type",ItemLedgEntry."Order Type"::Production);
                                                                  ItemLedgEntry.SETRANGE("Order No.","Prod. Order No.");
                                                                  ItemLedgEntry.SETRANGE("Order Line No.","Prod. Order Line No.");
                                                                  ItemLedgEntry.SETRANGE("Entry Type",ItemLedgEntry."Entry Type"::Consumption);
                                                                  ItemLedgEntry.SETRANGE("Prod. Order Comp. Line No.","Line No.");
                                                                  IF "Line No." = 0 THEN
                                                                    ItemLedgEntry.SETRANGE("Item No.","Item No.");
                                                                  IF NOT ItemLedgEntry.ISEMPTY THEN
                                                                    ERROR(Text99000002,"Flushing Method",ItemLedgEntry.TABLECAPTION);
                                                                END;

                                                                IF ("Flushing Method" <> xRec."Flushing Method") AND
                                                                   (xRec."Flushing Method" IN
                                                                    [xRec."Flushing Method"::Manual,
                                                                     xRec."Flushing Method"::"Pick + Forward",
                                                                     xRec."Flushing Method"::"Pick + Backward"])
                                                                THEN BEGIN
                                                                  CALCFIELDS("Pick Qty.");
                                                                  IF "Pick Qty." <> 0 THEN
                                                                    ERROR(Text99000007,"Flushing Method","Item No.");

                                                                  IF "Qty. Picked" <> 0 THEN
                                                                    ERROR(Text99000008,"Flushing Method","Item No.");

                                                                  IF (xRec."Flushing Method" IN
                                                                      [xRec."Flushing Method"::Manual,
                                                                       xRec."Flushing Method"::"Pick + Forward",
                                                                       xRec."Flushing Method"::"Pick + Backward"]) AND
                                                                     ("Flushing Method" IN ["Flushing Method"::Forward,"Flushing Method"::Backward])
                                                                  THEN BEGIN
                                                                    PickWhseWorksheetLine.SETRANGE("Source Type",DATABASE::"Prod. Order Component");
                                                                    PickWhseWorksheetLine.SETRANGE("Source No.","Prod. Order No.");
                                                                    PickWhseWorksheetLine.SETRANGE("Source Line No.","Prod. Order Line No.");
                                                                    PickWhseWorksheetLine.SETRANGE("Source Subline No.","Line No.");
                                                                    IF NOT PickWhseWorksheetLine.ISEMPTY THEN
                                                                      ERROR(Text99000002,"Flushing Method",PickWhseWorksheetLine.TABLECAPTION);
                                                                  END;
                                                                END;

                                                                IF "Flushing Method" <> xRec."Flushing Method" THEN
                                                                  UpdateBin(Rec,FIELDNO("Flushing Method"),FIELDCAPTION("Flushing Method"));
                                                              END;

                                                   CaptionML=[ENU=Flushing Method;
                                                              NOR=Trekkmetode];
                                                   OptionCaptionML=[ENU=Manual,Forward,Backward,Pick + Forward,Pick + Backward;
                                                                    NOR=Manuell,Fremover,Bakover,Plukk + Fremover,Plukk + Bakover];
                                                   OptionString=Manual,Forward,Backward,Pick + Forward,Pick + Backward }
    { 30  ;   ;Location Code       ;Code10        ;TableRelation=Location WHERE (Use As In-Transit=CONST(No));
                                                   OnValidate=BEGIN
                                                                IF Item."No." <> "Item No." THEN
                                                                  Item.GET("Item No.");
                                                                UpdateUnitCost;
                                                                VALIDATE("Expected Quantity");

                                                                GetDefaultBin;
                                                                WhseValidateSourceLine.ProdComponentVerifyChange(Rec,xRec);
                                                                ReserveProdOrderComp.VerifyChange(Rec,xRec);
                                                                GetUpdateFromSKU;
                                                              END;

                                                   CaptionML=[ENU=Location Code;
                                                              NOR=Lokasjonskode] }
    { 31  ;   ;Shortcut Dimension 1 Code;Code20   ;TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(1));
                                                   OnValidate=BEGIN
                                                                ValidateShortcutDimCode(1,"Shortcut Dimension 1 Code");
                                                              END;

                                                   CaptionML=[ENU=Shortcut Dimension 1 Code;
                                                              NOR=Snarveisdimensjon 1 - kode];
                                                   CaptionClass='1,2,1' }
    { 32  ;   ;Shortcut Dimension 2 Code;Code20   ;TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(2));
                                                   OnValidate=BEGIN
                                                                ValidateShortcutDimCode(2,"Shortcut Dimension 2 Code");
                                                              END;

                                                   CaptionML=[ENU=Shortcut Dimension 2 Code;
                                                              NOR=Snarveisdimensjon 2 - kode];
                                                   CaptionClass='1,2,2' }
    { 33  ;   ;Bin Code            ;Code20        ;TableRelation=Bin.Code WHERE (Location Code=FIELD(Location Code));
                                                   OnValidate=VAR
                                                                WMSManagement@1000 : Codeunit 7302;
                                                                WhseIntegrationMgt@1001 : Codeunit 7317;
                                                              BEGIN
                                                                IF "Bin Code" <> '' THEN BEGIN
                                                                  TESTFIELD("Location Code");
                                                                  WMSManagement.FindBin("Location Code","Bin Code",'');
                                                                  WhseIntegrationMgt.CheckBinTypeCode(DATABASE::"Prod. Order Component",
                                                                    FIELDCAPTION("Bin Code"),
                                                                    "Location Code",
                                                                    "Bin Code",0);
                                                                  CheckBin;
                                                                END;
                                                              END;

                                                   OnLookup=VAR
                                                              WMSManagement@1000 : Codeunit 7302;
                                                              BinCode@1001 : Code[20];
                                                            BEGIN
                                                              IF Quantity > 0 THEN
                                                                BinCode := WMSManagement.BinContentLookUp("Location Code","Item No.","Variant Code",'',"Bin Code")
                                                              ELSE
                                                                BinCode := WMSManagement.BinLookUp("Location Code","Item No.","Variant Code",'');

                                                              IF BinCode <> '' THEN
                                                                VALIDATE("Bin Code",BinCode);
                                                            END;

                                                   CaptionML=[ENU=Bin Code;
                                                              NOR=Hyllekode] }
    { 35  ;   ;Supplied-by Line No.;Integer       ;TableRelation="Prod. Order Line"."Line No." WHERE (Status=FIELD(Status),
                                                                                                      Prod. Order No.=FIELD(Prod. Order No.),
                                                                                                      Line No.=FIELD(Supplied-by Line No.));
                                                   CaptionML=[ENU=Supplied-by Line No.;
                                                              NOR=Forsynt av-linjenr.] }
    { 36  ;   ;Planning Level Code ;Integer       ;CaptionML=[ENU=Planning Level Code;
                                                              NOR=Planl.niv† - kode];
                                                   Editable=No }
    { 37  ;   ;Item Low-Level Code ;Integer       ;CaptionML=[ENU=Item Low-Level Code;
                                                              NOR=Varens lavniv†kode] }
    { 40  ;   ;Length              ;Decimal       ;OnValidate=BEGIN
                                                                VALIDATE("Calculation Formula");
                                                              END;

                                                   CaptionML=[ENU=Length;
                                                              NOR=Lengde];
                                                   DecimalPlaces=0:5 }
    { 41  ;   ;Width               ;Decimal       ;OnValidate=BEGIN
                                                                VALIDATE("Calculation Formula");
                                                              END;

                                                   CaptionML=[ENU=Width;
                                                              NOR=Bredde];
                                                   DecimalPlaces=0:5 }
    { 42  ;   ;Weight              ;Decimal       ;OnValidate=BEGIN
                                                                VALIDATE("Calculation Formula");
                                                              END;

                                                   CaptionML=[ENU=Weight;
                                                              NOR=Vekt];
                                                   DecimalPlaces=0:5 }
    { 43  ;   ;Depth               ;Decimal       ;OnValidate=BEGIN
                                                                VALIDATE("Calculation Formula");
                                                              END;

                                                   CaptionML=[ENU=Depth;
                                                              NOR=Dybde];
                                                   DecimalPlaces=0:5 }
    { 44  ;   ;Calculation Formula ;Option        ;OnValidate=BEGIN
                                                                CASE "Calculation Formula" OF
                                                                  "Calculation Formula"::" ":
                                                                    Quantity := "Quantity per";
                                                                  "Calculation Formula"::Length:
                                                                    Quantity := ROUND(Length * "Quantity per",0.00001);
                                                                  "Calculation Formula"::"Length * Width":
                                                                    Quantity := ROUND(Length * Width * "Quantity per",0.00001);
                                                                  "Calculation Formula"::"Length * Width * Depth":
                                                                    Quantity := ROUND(Length * Width * Depth * "Quantity per",0.00001);
                                                                  "Calculation Formula"::Weight:
                                                                    Quantity := ROUND(Weight * "Quantity per",0.00001);
                                                                END;
                                                                "Quantity (Base)" := Quantity * "Qty. per Unit of Measure";
                                                                VALIDATE("Expected Quantity",Quantity * ProdOrderNeeds);
                                                              END;

                                                   CaptionML=[ENU=Calculation Formula;
                                                              NOR=Beregningsformel];
                                                   OptionCaptionML=[ENU=" ,Length,Length * Width,Length * Width * Depth,Weight";
                                                                    NOR=" ,Lengde,Lengde * Bredde,Lengde * bredde * Dybde,Vekt"];
                                                   OptionString=[ ,Length,Length * Width,Length * Width * Depth,Weight] }
    { 45  ;   ;Quantity per        ;Decimal       ;OnValidate=BEGIN
                                                                WhseValidateSourceLine.ProdComponentVerifyChange(Rec,xRec);
                                                                TESTFIELD("Item No.");
                                                                VALIDATE("Calculation Formula");
                                                              END;

                                                   CaptionML=[ENU=Quantity per;
                                                              NOR=Antall per];
                                                   DecimalPlaces=0:5 }
    { 50  ;   ;Unit Cost           ;Decimal       ;OnValidate=BEGIN
                                                                TESTFIELD("Item No.");

                                                                Item.GET("Item No.");
                                                                GetGLSetup;
                                                                IF Item."Costing Method" = Item."Costing Method"::Standard THEN BEGIN
                                                                  IF CurrFieldNo = FIELDNO("Unit Cost") THEN
                                                                    ERROR(
                                                                      Text99000003,
                                                                      FIELDCAPTION("Unit Cost"),Item.FIELDCAPTION("Costing Method"),Item."Costing Method");
                                                                  UpdateUnitCost;
                                                                END;
                                                                VALIDATE("Calculation Formula");
                                                              END;

                                                   CaptionML=[ENU=Unit Cost;
                                                              NOR=Enhetskost];
                                                   DecimalPlaces=2:5 }
    { 51  ;   ;Cost Amount         ;Decimal       ;CaptionML=[ENU=Cost Amount;
                                                              NOR=Kostbel›p];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 52  ;   ;Due Date            ;Date          ;OnValidate=VAR
                                                                CheckDateConflict@1000 : Codeunit 99000815;
                                                              BEGIN
                                                                WhseValidateSourceLine.ProdComponentVerifyChange(Rec,xRec);
                                                                IF NOT Blocked THEN BEGIN
                                                                  IF CurrFieldNo <> 0 THEN
                                                                    CheckDateConflict.ProdOrderComponentCheck(Rec,TRUE,TRUE)
                                                                  ELSE
                                                                    IF CheckDateConflict.ProdOrderComponentCheck(Rec,NOT WarningRaised,FALSE) THEN
                                                                      WarningRaised := TRUE;
                                                                END;
                                                                UpdateDatetime;
                                                              END;

                                                   CaptionML=[ENU=Due Date;
                                                              NOR=Forfallsdato] }
    { 53  ;   ;Due Time            ;Time          ;OnValidate=BEGIN
                                                                UpdateDatetime;
                                                              END;

                                                   CaptionML=[ENU=Due Time;
                                                              NOR=Forfallstidsp.] }
    { 60  ;   ;Qty. per Unit of Measure;Decimal   ;CaptionML=[ENU=Qty. per Unit of Measure;
                                                              NOR=Antall per enhet];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 61  ;   ;Remaining Qty. (Base);Decimal      ;CaptionML=[ENU=Remaining Qty. (Base);
                                                              NOR=Restlager (ant.)];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 62  ;   ;Quantity (Base)     ;Decimal       ;CaptionML=[ENU=Quantity (Base);
                                                              NOR=Antall (lagerenhet)];
                                                   DecimalPlaces=0:5 }
    { 63  ;   ;Reserved Qty. (Base);Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Reservation Entry"."Quantity (Base)" WHERE (Source ID=FIELD(Prod. Order No.),
                                                                                                                 Source Ref. No.=FIELD(Line No.),
                                                                                                                 Source Type=CONST(5407),
                                                                                                                 Source Subtype=FIELD(Status),
                                                                                                                 Source Batch Name=CONST(),
                                                                                                                 Source Prod. Order Line=FIELD(Prod. Order Line No.),
                                                                                                                 Reservation Status=CONST(Reservation)));
                                                   CaptionML=[ENU=Reserved Qty. (Base);
                                                              NOR=Reservert antall (lagerenhet)];
                                                   DecimalPlaces=0:5;
                                                   Editable=Yes }
    { 71  ;   ;Reserved Quantity   ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Reservation Entry".Quantity WHERE (Source ID=FIELD(Prod. Order No.),
                                                                                                        Source Ref. No.=FIELD(Line No.),
                                                                                                        Source Type=CONST(5407),
                                                                                                        Source Subtype=FIELD(Status),
                                                                                                        Source Batch Name=CONST(),
                                                                                                        Source Prod. Order Line=FIELD(Prod. Order Line No.),
                                                                                                        Reservation Status=CONST(Reservation)));
                                                   CaptionML=[ENU=Reserved Quantity;
                                                              NOR=Reservert antall];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 73  ;   ;Expected Qty. (Base);Decimal       ;OnValidate=BEGIN
                                                                IF Status <> Status::Simulated THEN BEGIN
                                                                  IF Status IN [Status::Released,Status::Finished] THEN
                                                                    CALCFIELDS("Act. Consumption (Qty)");
                                                                  "Remaining Quantity" := "Expected Quantity" - "Act. Consumption (Qty)";
                                                                  "Remaining Qty. (Base)" := ROUND("Remaining Quantity" * "Qty. per Unit of Measure",0.00001);
                                                                END;
                                                                "Cost Amount" := ROUND("Expected Quantity" * "Unit Cost");
                                                                "Overhead Amount" :=
                                                                  ROUND(
                                                                    "Expected Quantity" *
                                                                    (("Direct Unit Cost" * "Indirect Cost %" / 100) + "Overhead Rate"));
                                                                "Direct Cost Amount" := ROUND("Expected Quantity" * "Direct Unit Cost");
                                                              END;

                                                   CaptionML=[ENU=Expected Qty. (Base);
                                                              NOR=Forventet antall (lagerenhet)];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 76  ;   ;Due Date-Time       ;DateTime      ;OnValidate=BEGIN
                                                                "Due Date" := DT2DATE("Due Date-Time");
                                                                "Due Time" := DT2TIME("Due Date-Time");
                                                                VALIDATE("Due Date");
                                                              END;

                                                   CaptionML=[ENU=Due Date-Time;
                                                              NOR=Forfallsdato-tidsp.] }
    { 480 ;   ;Dimension Set ID    ;Integer       ;TableRelation="Dimension Set Entry";
                                                   OnLookup=BEGIN
                                                              ShowDimensions;
                                                            END;

                                                   CaptionML=[ENU=Dimension Set ID;
                                                              NOR=Dimensjonssett-ID];
                                                   Editable=No }
    { 5702;   ;Substitution Available;Boolean     ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Item Substitution" WHERE (Type=CONST(Item),
                                                                                                Substitute Type=CONST(Item),
                                                                                                No.=FIELD(Item No.),
                                                                                                Variant Code=FIELD(Variant Code)));
                                                   CaptionML=[ENU=Substitution Available;
                                                              NOR=Erstatning mulig];
                                                   Editable=No }
    { 5703;   ;Original Item No.   ;Code20        ;TableRelation=Item;
                                                   CaptionML=[ENU=Original Item No.;
                                                              NOR=Opprinnelig varenr.];
                                                   Editable=No }
    { 5704;   ;Original Variant Code;Code10       ;TableRelation="Item Variant".Code WHERE (Item No.=FIELD(Original Item No.));
                                                   CaptionML=[ENU=Original Variant Code;
                                                              NOR=Opprinnelig variantkode];
                                                   Editable=No }
    { 5750;   ;Pick Qty.           ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Warehouse Activity Line"."Qty. Outstanding" WHERE (Activity Type=FILTER(<>Put-away),
                                                                                                                       Source Type=CONST(5407),
                                                                                                                       Source Subtype=FIELD(Status),
                                                                                                                       Source No.=FIELD(Prod. Order No.),
                                                                                                                       Source Line No.=FIELD(Prod. Order Line No.),
                                                                                                                       Source Subline No.=FIELD(Line No.),
                                                                                                                       Unit of Measure Code=FIELD(Unit of Measure Code),
                                                                                                                       Action Type=FILTER(' '|Place),
                                                                                                                       Original Breakbulk=CONST(No),
                                                                                                                       Breakbulk No.=CONST(0)));
                                                   CaptionML=[ENU=Pick Qty.;
                                                              NOR=Plukkant.];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 7300;   ;Qty. Picked         ;Decimal       ;OnValidate=BEGIN
                                                                "Qty. Picked (Base)" := CalcBaseQty("Qty. Picked");
                                                                "Completely Picked" := "Qty. Picked" >= "Expected Quantity";
                                                              END;

                                                   CaptionML=[ENU=Qty. Picked;
                                                              NOR=Plukket ant.];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 7301;   ;Qty. Picked (Base)  ;Decimal       ;CaptionML=[ENU=Qty. Picked (Base);
                                                              NOR=Plukket ant. (l.enh.)];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 7302;   ;Completely Picked   ;Boolean       ;CaptionML=[ENU=Completely Picked;
                                                              NOR=Ferdig plukket];
                                                   Editable=No }
    { 7303;   ;Pick Qty. (Base)    ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Warehouse Activity Line"."Qty. Outstanding (Base)" WHERE (Activity Type=FILTER(<>Put-away),
                                                                                                                              Source Type=CONST(5407),
                                                                                                                              Source Subtype=FIELD(Status),
                                                                                                                              Source No.=FIELD(Prod. Order No.),
                                                                                                                              Source Line No.=FIELD(Prod. Order Line No.),
                                                                                                                              Source Subline No.=FIELD(Line No.),
                                                                                                                              Action Type=FILTER(' '|Place),
                                                                                                                              Original Breakbulk=CONST(No),
                                                                                                                              Breakbulk No.=CONST(0)));
                                                   CaptionML=[ENU=Pick Qty. (Base);
                                                              NOR=Plukkant. (l.enh.)];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 50000;  ;Hyllenr.            ;Text30         }
    { 50001;  ;Beskrivelse 2       ;Text30        ;CaptionML=[ENU=Description 2;
                                                              NOR=Beskrivelse 2] }
    { 50010;  ;Vendor No.          ;Code10        ;TableRelation=Vendor;
                                                   CaptionML=NOR=Leverand›rnr. }
    { 50011;  ;Item Ledger Enty Exist;Boolean      }
    { 50200;  ;Kopieres til serv.komponent;Boolean }
    { 50300;  ;Qty. on Prod. Order ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Prod. Order Line"."Remaining Qty. (Base)" WHERE (Status=FILTER(Planned..Released),
                                                                                                                     Item No.=FIELD(Item No.)));
                                                   CaptionML=[ENU=Qty. on Prod. Order;
                                                              NOR=Antall i prod.ordre];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 50301;  ;Qty. on Purch. Order;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Purchase Line"."Outstanding Qty. (Base)" WHERE (Document Type=CONST(Order),
                                                                                                                    Type=CONST(Item),
                                                                                                                    No.=FIELD(Item No.)));
                                                   CaptionML=[ENU=Qty. on Purch. Order;
                                                              NOR=Antall i bestilling];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 83001;  ;Ship now            ;Decimal       ;CaptionML=NOR=Flytt n† (antall);
                                                   Description=OPC }
    { 83002;  ;Shipped             ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Item Ledger Entry".Quantity WHERE (Entry Type=CONST(Transfer),
                                                                                                        Order Type=CONST(Production),
                                                                                                        Order No.=FIELD(Prod. Order No.),
                                                                                                        Item No.=FIELD(Item No.),
                                                                                                        Location Code=CONST(HOVED)));
                                                   CaptionML=NOR=Ant. flyttet;
                                                   Description=OPC;
                                                   Editable=No }
    { 83003;  ;Shipped qty - remaining;Decimal    ;CaptionML=NOR=Gjenst†r † flytte;
                                                   Description=OPC;
                                                   Editable=No }
    { 99000754;;Direct Unit Cost   ;Decimal       ;CaptionML=[ENU=Direct Unit Cost;
                                                              NOR=Direkte enhetskost];
                                                   DecimalPlaces=2:5 }
    { 99000755;;Indirect Cost %    ;Decimal       ;OnValidate=BEGIN
                                                                "Direct Unit Cost" :=
                                                                  ROUND(("Unit Cost" - "Overhead Rate") / (1 + "Indirect Cost %" / 100));

                                                                VALIDATE("Unit Cost");
                                                              END;

                                                   CaptionML=[ENU=Indirect Cost %;
                                                              NOR=Indirekte kost-%];
                                                   DecimalPlaces=0:5 }
    { 99000756;;Overhead Rate      ;Decimal       ;OnValidate=BEGIN
                                                                VALIDATE("Indirect Cost %");
                                                              END;

                                                   CaptionML=[ENU=Overhead Rate;
                                                              NOR=Sats for indirekte kostnader];
                                                   DecimalPlaces=0:5 }
    { 99000757;;Direct Cost Amount ;Decimal       ;CaptionML=[ENU=Direct Cost Amount;
                                                              NOR=Kj›pspris/prod.kost - bel›p];
                                                   DecimalPlaces=2:2 }
    { 99000758;;Overhead Amount    ;Decimal       ;CaptionML=[ENU=Overhead Amount;
                                                              NOR=Bel›p for indirekte kostnader];
                                                   DecimalPlaces=2:2 }
  }
  KEYS
  {
    {    ;Status,Prod. Order No.,Prod. Order Line No.,Line No.;
                                                   Clustered=Yes }
    {    ;Prod. Order No.,Prod. Order Line No.,Line No.,Status }
    {    ;Status,Prod. Order No.,Prod. Order Line No.,Due Date;
                                                   SumIndexFields=Expected Quantity,Cost Amount }
    {    ;Status,Prod. Order No.,Prod. Order Line No.,Item No.,Line No.;
                                                   MaintainSQLIndex=No }
    {    ;Status,Item No.,Variant Code,Location Code,Due Date;
                                                   SumIndexFields=Expected Quantity,Remaining Qty. (Base),Cost Amount,Overhead Amount;
                                                   MaintainSIFTIndex=No }
    { No ;Item No.,Variant Code,Location Code,Shortcut Dimension 1 Code,Shortcut Dimension 2 Code,Due Date;
                                                   SumIndexFields=Expected Quantity,Remaining Qty. (Base),Cost Amount,Overhead Amount }
    {    ;Status,Prod. Order No.,Routing Link Code,Flushing Method }
    {    ;Status,Prod. Order No.,Location Code     }
    {    ;Item No.,Variant Code,Location Code,Status,Due Date;
                                                   SumIndexFields=Expected Qty. (Base),Remaining Qty. (Base),Cost Amount,Overhead Amount,Qty. Picked (Base);
                                                   MaintainSIFTIndex=No }
    {    ;Status,Prod. Order No.,Prod. Order Line No.,Item Low-Level Code;
                                                   MaintainSQLIndex=No }
    {    ;Vendor No.,Hyllenr.                      }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      Text000@1028 : TextConst 'ENU=A finished production order component cannot be inserted, modified, or deleted.;NOR=Kan ikke sette inn, endre eller slette en ferdig produksjonsordrekomponent.';
      Text001@1015 : TextConst 'ENU=The changed %1 now points to bin %2. Do you want to update the bin on this line?;NOR=%1 som er endret, viser n† til hylle %2. Vil du oppdatere hyllen p† denne linjen?';
      Text99000000@1000 : TextConst 'ENU=You cannot delete item %1 in line %2 because at least one item ledger entry is associated with it.;NOR=Du kan ikke slette varen %1 i linje %2 fordi den har minst ‚n varepost tilknyttet.';
      Text99000001@1001 : TextConst 'ENU=You cannot rename a %1.;NOR=Du kan ikke gi nytt navn til en %1.';
      Text99000002@1002 : TextConst 'ENU=You cannot change flushing method to %1 when there is at least one record in table %2 associated with it.;NOR=Du kan ikke endre trekkmetode til %1 n†r den har minst ‚n post i tabell %2 tilknyttet.';
      Text99000003@1003 : TextConst 'ENU=You cannot change %1 when %2 is %3.;NOR=Du kan ikke endre %1 n†r %2 er %3.';
      Item@1005 : Record 27;
      ReservEntry@1007 : Record 337;
      GLSetup@1024 : Record 98;
      Location@1012 : Record 14;
      SKU@1025 : Record 5700;
      ReservMgt@1008 : Codeunit 99000845;
      ReservEngineMgt@1009 : Codeunit 99000831;
      ReserveProdOrderComp@1010 : Codeunit 99000838;
      UOMMgt@1011 : Codeunit 5402;
      DimMgt@1014 : Codeunit 408;
      WhseProdRelease@1016 : Codeunit 5774;
      WhseValidateSourceLine@1027 : Codeunit 5777;
      ItemSubstitutionMgt@1031 : Codeunit 5701;
      Reservation@1017 : Page 498;
      Blocked@1023 : Boolean;
      GLSetupRead@1022 : Boolean;
      Text99000007@1029 : TextConst 'ENU=You cannot change flushing method to %1 because a pick has already been created for production order component %2.;NOR=Du kan ikke endre trekkmetode til %1 fordi det allerede er opprettet et plukk for produksjonsordrekomponenten %2.';
      Text99000008@1030 : TextConst 'ENU=You cannot change flushing method to %1 because production order component %2 has already been picked.;NOR=Du kan ikke endre trekkmetode til %1 fordi produksjonsordrekomponenten %2 allerede er plukket.';
      Text99000009@1013 : TextConst 'ENU=Automatic reservation is not possible.\Do you want to reserve items manually?;NOR=Det er ikke mulig † reservere automatisk.\Vil du reservere varene manuelt?';
      IgnoreErrors@1026 : Boolean;
      ErrorOccured@1032 : Boolean;
      WarningRaised@1004 : Boolean;

    PROCEDURE Caption@4() : Text[100];
    VAR
      ProdOrder@1000 : Record 5405;
      ProdOrderLine@1001 : Record 5406;
    BEGIN
      IF NOT ProdOrder.GET(Status,"Prod. Order No.") THEN
        EXIT('');

      IF NOT ProdOrderLine.GET(Status,"Prod. Order No.","Prod. Order Line No.") THEN
        CLEAR(ProdOrderLine);

      EXIT(
        STRSUBSTNO('%1 %2 %3',
          "Prod. Order No.",ProdOrder.Description,ProdOrderLine."Item No."));
    END;

    LOCAL PROCEDURE ProdOrderNeeds@1() : Decimal;
    VAR
      ProdOrderLine@1000 : Record 5406;
      ProdOrderRtngLine@1001 : Record 5409;
    BEGIN
      ProdOrderLine.GET(Status,"Prod. Order No.","Prod. Order Line No.");

      "Due Date" := ProdOrderLine."Starting Date";

      ProdOrderRtngLine.RESET;
      ProdOrderRtngLine.SETRANGE(Status,Status);
      ProdOrderRtngLine.SETRANGE("Prod. Order No.","Prod. Order No.");
      ProdOrderRtngLine.SETRANGE("Routing Reference No.",ProdOrderLine."Routing Reference No.");
      IF "Routing Link Code" <> '' THEN
        ProdOrderRtngLine.SETRANGE("Routing Link Code","Routing Link Code");
      IF ProdOrderRtngLine.FINDFIRST THEN
        EXIT(
          ProdOrderLine.Quantity *
          (1 + ProdOrderLine."Scrap %" / 100) *
          (1 + ProdOrderRtngLine."Scrap Factor % (Accumulated)") *
          (1 + "Scrap %" / 100) +
          ProdOrderRtngLine."Fixed Scrap Qty. (Accum.)");

      EXIT(
        ProdOrderLine.Quantity *
        (1 + ProdOrderLine."Scrap %" / 100) * (1 + "Scrap %" / 100));
    END;

    PROCEDURE GetNeededQty@3(CalcBasedOn@1000 : 'Actual Output,Expected Output';IncludePreviousPosting@1001 : Boolean) : Decimal;
    VAR
      ProdOrderLine@1002 : Record 5406;
      ProdOrderRtngLine@1003 : Record 5409;
      CapLedgEntry@1004 : Record 5832;
      CostCalcMgt@1006 : Codeunit 5836;
      OutputQtyBase@1005 : Decimal;
      CompQtyBase@1008 : Decimal;
    BEGIN
      Item.GET("Item No.");
      IF Item."Rounding Precision" = 0 THEN
        Item."Rounding Precision" := 0.00001;

      IF CalcBasedOn = CalcBasedOn::"Actual Output" THEN BEGIN
        ProdOrderLine.GET(Status,"Prod. Order No.","Prod. Order Line No.");

        ProdOrderRtngLine.SETRANGE(Status,Status);
        ProdOrderRtngLine.SETRANGE("Prod. Order No.","Prod. Order No.");
        ProdOrderRtngLine.SETRANGE("Routing No.",ProdOrderLine."Routing No.");
        ProdOrderRtngLine.SETRANGE("Routing Reference No.",ProdOrderLine."Routing Reference No.");
        ProdOrderRtngLine.SETRANGE("Routing Link Code","Routing Link Code");
        IF NOT ProdOrderRtngLine.FINDFIRST OR ("Routing Link Code" = '') THEN BEGIN
          ProdOrderRtngLine.SETRANGE("Routing Link Code");
          ProdOrderRtngLine.SETFILTER("Next Operation No.",'%1','');
          IF NOT ProdOrderRtngLine.FINDFIRST THEN
            ProdOrderRtngLine."Operation No." := '';
        END;
        IF Status IN [Status::Released,Status::Finished] THEN BEGIN
          CapLedgEntry.SETCURRENTKEY("Order Type","Order No.","Order Line No.");
          CapLedgEntry.SETRANGE("Order Type",CapLedgEntry."Order Type"::Production);
          CapLedgEntry.SETRANGE("Order No.","Prod. Order No.");
          CapLedgEntry.SETRANGE("Order Line No.","Prod. Order Line No.");
          CapLedgEntry.SETRANGE("Operation No.",ProdOrderRtngLine."Operation No.");
          IF CapLedgEntry.FIND('-') THEN
            REPEAT
              OutputQtyBase := OutputQtyBase + CapLedgEntry."Output Quantity" + CapLedgEntry."Scrap Quantity";
            UNTIL CapLedgEntry.NEXT = 0;
        END;

        CompQtyBase := CostCalcMgt.CalcActNeededQtyBase(ProdOrderLine,Rec,OutputQtyBase);

        IF IncludePreviousPosting THEN BEGIN
          IF Status IN [Status::Released,Status::Finished] THEN
            CALCFIELDS("Act. Consumption (Qty)");
          EXIT(
            ROUND(
              (CompQtyBase - "Act. Consumption (Qty)") / "Qty. per Unit of Measure",
              Item."Rounding Precision",'>'));
        END;
        EXIT(ROUND(CompQtyBase / "Qty. per Unit of Measure",Item."Rounding Precision",'>'));
      END;
      EXIT(ROUND("Remaining Quantity",Item."Rounding Precision"));
    END;

    PROCEDURE ShowReservation@8();
    BEGIN
      TESTFIELD("Item No.");
      CLEAR(Reservation);
      Reservation.SetProdOrderComponent(Rec);
      Reservation.RUNMODAL;
    END;

    PROCEDURE ShowReservationEntries@21(Modal@1000 : Boolean);
    BEGIN
      TESTFIELD("Item No.");
      ReservEngineMgt.InitFilterAndSortingLookupFor(ReservEntry,TRUE);
      ReserveProdOrderComp.FilterReservFor(ReservEntry,Rec);
      IF Modal THEN
        PAGE.RUNMODAL(PAGE::"Reservation Entries",ReservEntry)
      ELSE
        PAGE.RUN(PAGE::"Reservation Entries",ReservEntry);
    END;

    LOCAL PROCEDURE CalcBaseQty@14(Qty@1000 : Decimal) : Decimal;
    BEGIN
      TESTFIELD("Qty. per Unit of Measure");
      EXIT(ROUND(Qty * "Qty. per Unit of Measure",0.00001));
    END;

    PROCEDURE AdjustQtyToQtyPicked@25(VAR QtyToPost@1000 : Decimal);
    VAR
      AdjustedQty@1001 : Decimal;
    BEGIN
      AdjustedQty :=
        "Qty. Picked" + WhseValidateSourceLine.CalcNextLevelProdOutput(Rec) -
        ("Expected Quantity" - "Remaining Quantity");

      IF QtyToPost > AdjustedQty THEN
        QtyToPost := AdjustedQty;
    END;

    PROCEDURE BlockDynamicTracking@17(SetBlock@1000 : Boolean);
    BEGIN
      Blocked := SetBlock;
      ReserveProdOrderComp.Block(Blocked);
    END;

    LOCAL PROCEDURE CreateDim@5(Type1@1000 : Integer;No1@1001 : Code[20]);
    VAR
      ProdOrderLine@1004 : Record 5406;
      TableID@1002 : ARRAY [10] OF Integer;
      No@1003 : ARRAY [10] OF Code[20];
    BEGIN
      TableID[1] := Type1;
      No[1] := No1;
      "Shortcut Dimension 1 Code" := '';
      "Shortcut Dimension 2 Code" := '';

      ProdOrderLine.GET(Status,"Prod. Order No.","Prod. Order Line No.");

      "Dimension Set ID" :=
        DimMgt.GetDefaultDimID(
          TableID,No,'',"Shortcut Dimension 1 Code","Shortcut Dimension 2 Code",
          ProdOrderLine."Dimension Set ID",DATABASE::Item);
    END;

    PROCEDURE IsInbound@22() : Boolean;
    BEGIN
      EXIT("Quantity (Base)" < 0);
    END;

    PROCEDURE OpenItemTrackingLines@6500();
    BEGIN
      ReserveProdOrderComp.CallItemTracking(Rec);
    END;

    PROCEDURE ValidateShortcutDimCode@6(FieldNumber@1000 : Integer;VAR ShortcutDimCode@1001 : Code[20]);
    BEGIN
      DimMgt.ValidateShortcutDimValues(FieldNumber,ShortcutDimCode,"Dimension Set ID");
    END;

    PROCEDURE LookupShortcutDimCode@7(FieldNumber@1000 : Integer;VAR ShortcutDimCode@1001 : Code[20]);
    BEGIN
      DimMgt.LookupDimValueCode(FieldNumber,ShortcutDimCode);
      DimMgt.ValidateShortcutDimValues(FieldNumber,ShortcutDimCode,"Dimension Set ID");
    END;

    PROCEDURE ShowShortcutDimCode@9(VAR ShortcutDimCode@1000 : ARRAY [8] OF Code[20]);
    BEGIN
      DimMgt.GetShortcutDimensions("Dimension Set ID",ShortcutDimCode);
    END;

    LOCAL PROCEDURE GetUpdateFromSKU@10();
    VAR
      SKU@1000 : Record 5700;
      GetPlanningParameters@1001 : Codeunit 99000855;
    BEGIN
      GetPlanningParameters.AtSKU(SKU,"Item No.","Variant Code","Location Code");
      VALIDATE("Flushing Method",SKU."Flushing Method");
    END;

    PROCEDURE UpdateDatetime@20();
    BEGIN
      IF ("Due Date" <> 0D) AND ("Due Time" <> 0T) THEN
        "Due Date-Time" := CREATEDATETIME("Due Date","Due Time")
      ELSE
        "Due Date-Time" := 0DT;
    END;

    LOCAL PROCEDURE GetGLSetup@11();
    BEGIN
      IF NOT GLSetupRead THEN
        GLSetup.GET;
      GLSetupRead := TRUE;
    END;

    PROCEDURE RowID1@44() : Text[250];
    VAR
      ItemTrackingMgt@1000 : Codeunit 6500;
    BEGIN
      EXIT(
        ItemTrackingMgt.ComposeRowID(DATABASE::"Prod. Order Component",Status,
          "Prod. Order No.",'',"Prod. Order Line No.","Line No."));
    END;

    LOCAL PROCEDURE GetLocation@7300(LocationCode@1000 : Code[10]);
    BEGIN
      IF LocationCode = '' THEN
        CLEAR(Location)
      ELSE
        IF Location.Code <> LocationCode THEN
          Location.GET(LocationCode);
    END;

    PROCEDURE GetDefaultBin@50();
    VAR
      ProdOrderRtngLine@1000 : Record 5409;
    BEGIN
      IF (Quantity * xRec.Quantity > 0) AND
         ("Item No." = xRec."Item No.") AND
         ("Location Code" = xRec."Location Code") AND
         ("Variant Code" = xRec."Variant Code") AND
         ("Routing Link Code" = xRec."Routing Link Code")
      THEN
        EXIT;

      "Bin Code" := '';
      IF ("Location Code" <> '') AND ("Item No." <> '') THEN
        VALIDATE("Bin Code",GetDefaultConsumptionBin(ProdOrderRtngLine));
    END;

    PROCEDURE GetDefaultConsumptionBin@15(VAR ProdOrderRtngLine@1000 : Record 5409) BinCode : Code[20];
    VAR
      ProdOrderLine@1001 : Record 5406;
      WMSManagement@1002 : Codeunit 7302;
    BEGIN
      ProdOrderLine.GET(Status,"Prod. Order No.","Prod. Order Line No.");
      IF "Location Code" = ProdOrderLine."Location Code" THEN
        IF FindFirstRtngLine(ProdOrderRtngLine,ProdOrderLine) THEN
          BinCode := GetBinCodeFromRtngLine(ProdOrderRtngLine);

      IF BinCode <> '' THEN
        EXIT;

      BinCode := GetBinCodeFromLocation("Location Code");

      IF BinCode <> '' THEN
        EXIT;

      GetLocation("Location Code");
      IF Location."Bin Mandatory" AND NOT Location."Directed Put-away and Pick" THEN
        WMSManagement.GetDefaultBin("Item No.","Variant Code","Location Code",BinCode);
    END;

    LOCAL PROCEDURE FindFirstRtngLine@16(VAR ProdOrderRtngLine@1000 : Record 5409;ProdOrderLine@1001 : Record 5406) : Boolean;
    BEGIN
      ProdOrderRtngLine.RESET;
      ProdOrderRtngLine.SETCURRENTKEY(Status,"Prod. Order No.","Routing Reference No.","Routing No.","Operation No.");
      ProdOrderRtngLine.SETRANGE(Status,ProdOrderLine.Status);
      ProdOrderRtngLine.SETRANGE("Prod. Order No.",ProdOrderLine."Prod. Order No.");
      ProdOrderRtngLine.SETRANGE("Routing Reference No.",ProdOrderLine."Routing Reference No.");
      ProdOrderRtngLine.SETRANGE("Routing No.",ProdOrderLine."Routing No.");
      ProdOrderRtngLine.SETFILTER("No.",'<>%1',''); // empty No. implies blank bin codes - ignore these
      ProdOrderRtngLine.SETRANGE("Previous Operation No.",''); // first operation
      IF "Routing Link Code" <> '' THEN BEGIN
        ProdOrderRtngLine.SETRANGE("Routing Link Code","Routing Link Code");
        ProdOrderRtngLine.SETRANGE("Previous Operation No.");
        IF ProdOrderRtngLine.COUNT = 0 THEN BEGIN // no routing line with Routing Link Code found- use 1st op
          ProdOrderRtngLine.SETRANGE("Routing Link Code");
          ProdOrderRtngLine.SETRANGE("Previous Operation No.",'');
        END;
      END;

      EXIT(ProdOrderRtngLine.FINDFIRST);
    END;

    LOCAL PROCEDURE GetBinCodeFromRtngLine@18(ProdOrderRtngLine@1000 : Record 5409) BinCode : Code[20];
    BEGIN
      CASE "Flushing Method" OF
        "Flushing Method"::Manual,
        "Flushing Method"::"Pick + Forward",
        "Flushing Method"::"Pick + Backward":
          BinCode := ProdOrderRtngLine."To-Production Bin Code";
        "Flushing Method"::Forward,
        "Flushing Method"::Backward:
          BinCode := ProdOrderRtngLine."Open Shop Floor Bin Code";
      END;
    END;

    LOCAL PROCEDURE GetBinCodeFromLocation@19(LocationCode@1000 : Code[10]) BinCode : Code[20];
    BEGIN
      GetLocation(LocationCode);
      CASE "Flushing Method" OF
        "Flushing Method"::Manual,
        "Flushing Method"::"Pick + Forward",
        "Flushing Method"::"Pick + Backward":
          BinCode := Location."To-Production Bin Code";
        "Flushing Method"::Forward,
        "Flushing Method"::Backward:
          BinCode := Location."Open Shop Floor Bin Code";
      END;
    END;

    LOCAL PROCEDURE UpdateBin@23(VAR ProdOrderComp@1000 : Record 5407;FieldNo@1001 : Integer;FieldCaption@1002 : Text[30]);
    VAR
      ProdOrderComp2@1003 : Record 5407;
      OverwriteBinCode@1004 : Boolean;
    BEGIN
      ProdOrderComp2 := ProdOrderComp;
      ProdOrderComp2.GetDefaultBin;
      IF ProdOrderComp."Bin Code" <> ProdOrderComp2."Bin Code" THEN
        IF CurrFieldNo = FieldNo THEN BEGIN
          IF CONFIRM(Text001,FALSE,FieldCaption,ProdOrderComp2."Bin Code") THEN
            OverwriteBinCode := TRUE;
        END ELSE
          OverwriteBinCode := TRUE;
      IF OverwriteBinCode THEN
        ProdOrderComp."Bin Code" := ProdOrderComp2."Bin Code";
    END;

    LOCAL PROCEDURE CheckBin@24();
    VAR
      BinContent@1000 : Record 7302;
      Bin@1001 : Record 7354;
    BEGIN
      IF "Bin Code" <> '' THEN BEGIN
        GetLocation("Location Code");
        IF NOT Location."Directed Put-away and Pick" THEN
          EXIT;

        IF BinContent.GET(
             "Location Code","Bin Code",
             "Item No.","Variant Code","Unit of Measure Code")
        THEN BEGIN
          IF NOT BinContent.CheckWhseClass(IgnoreErrors) THEN
            ErrorOccured := TRUE;
        END ELSE BEGIN
          Bin.GET("Location Code","Bin Code");
          IF NOT Bin.CheckWhseClass("Item No.",IgnoreErrors) THEN
            ErrorOccured := TRUE;
        END;
      END;
      IF ErrorOccured THEN
        "Bin Code" := '';
    END;

    PROCEDURE AutoReserve@2();
    VAR
      Item@1001 : Record 27;
      FullAutoReservation@1000 : Boolean;
    BEGIN
      IF Status IN [Status::Simulated,Status::Finished] THEN
        EXIT;

      TESTFIELD("Item No.");
      Item.GET("Item No.");
      IF Item.Reserve <> Item.Reserve::Always THEN
        EXIT;

      IF "Remaining Qty. (Base)" <> 0 THEN BEGIN
        TESTFIELD("Due Date");
        ReservMgt.SetProdOrderComponent(Rec);
        ReservMgt.AutoReserve(FullAutoReservation,'',"Due Date","Remaining Quantity","Remaining Qty. (Base)");
        CALCFIELDS("Reserved Quantity","Reserved Qty. (Base)");
        FIND;
        IF NOT FullAutoReservation AND
           (CurrFieldNo <> 0)
        THEN
          IF CONFIRM(Text99000009,TRUE) THEN BEGIN
            COMMIT;
            ShowReservation;
            FIND;
          END;
      END;
    END;

    PROCEDURE ShowItemSub@30();
    BEGIN
      ItemSubstitutionMgt.GetCompSubst(Rec);
    END;

    LOCAL PROCEDURE GetSKU@5802() : Boolean;
    BEGIN
      IF (SKU."Location Code" = "Location Code") AND
         (SKU."Item No." = "Item No.") AND
         (SKU."Variant Code" = "Variant Code")
      THEN
        EXIT(TRUE);
      IF SKU.GET("Location Code","Item No.","Variant Code") THEN
        EXIT(TRUE);

      EXIT(FALSE);
    END;

    LOCAL PROCEDURE ClearCalcFormula@13();
    BEGIN
      "Calculation Formula" := "Calculation Formula"::" ";
      Length := 0;
      Width := 0;
      Weight := 0;
      Depth := 0;
    END;

    LOCAL PROCEDURE UpdateUnitCost@12();
    BEGIN
      IF GetSKU THEN
        "Unit Cost" := SKU."Unit Cost"
      ELSE
        "Unit Cost" := Item."Unit Cost";

      "Unit Cost" :=
        ROUND("Unit Cost" * "Qty. per Unit of Measure",
          GLSetup."Unit-Amount Rounding Precision");

      "Indirect Cost %" := ROUND(Item."Indirect Cost %",0.00001);

      "Overhead Rate" :=
        ROUND(Item."Overhead Rate" * "Qty. per Unit of Measure",
          GLSetup."Unit-Amount Rounding Precision");

      "Direct Unit Cost" :=
        ROUND(
          ("Unit Cost" - "Overhead Rate") / (1 + "Indirect Cost %" / 100),
          GLSetup."Unit-Amount Rounding Precision");
    END;

    PROCEDURE FilterLinesWithItemToPlan@70(VAR Item@1000 : Record 27;IncludeFirmPlanned@1001 : Boolean);
    BEGIN
      RESET;
      SETCURRENTKEY("Item No.","Variant Code","Location Code",Status,"Due Date");
      IF IncludeFirmPlanned THEN
        SETRANGE(Status,Status::Planned,Status::Released)
      ELSE
        SETFILTER(Status,'%1|%2',Status::Planned,Status::Released);
      SETRANGE("Item No.",Item."No.");
      SETFILTER("Variant Code",Item.GETFILTER("Variant Filter"));
      SETFILTER("Location Code",Item.GETFILTER("Location Filter"));
      SETFILTER("Due Date",Item.GETFILTER("Date Filter"));
      SETFILTER("Shortcut Dimension 1 Code",Item.GETFILTER("Global Dimension 1 Filter"));
      SETFILTER("Shortcut Dimension 2 Code",Item.GETFILTER("Global Dimension 2 Filter"));
      SETFILTER("Remaining Qty. (Base)",'<>0');
    END;

    PROCEDURE FindLinesWithItemToPlan@68(VAR Item@1000 : Record 27;IncludeFirmPlanned@1001 : Boolean) : Boolean;
    BEGIN
      FilterLinesWithItemToPlan(Item,IncludeFirmPlanned);
      EXIT(FIND('-'));
    END;

    PROCEDURE LinesWithItemToPlanExist@67(VAR Item@1000 : Record 27;IncludeFirmPlanned@1001 : Boolean) : Boolean;
    BEGIN
      FilterLinesWithItemToPlan(Item,IncludeFirmPlanned);
      EXIT(NOT ISEMPTY);
    END;

    PROCEDURE ShowDimensions@69();
    BEGIN
      "Dimension Set ID" :=
        DimMgt.EditDimensionSet2(
          "Dimension Set ID",STRSUBSTNO('%1 %2 %3',Status,"Prod. Order No.","Prod. Order Line No."),
          "Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
    END;

    PROCEDURE SetIgnoreErrors@31();
    BEGIN
      IgnoreErrors := TRUE;
    END;

    PROCEDURE HasErrorOccured@32() : Boolean;
    BEGIN
      EXIT(ErrorOccured);
    END;

    PROCEDURE SetFilterByReleasedOrderNo@26(OrderNo@1000 : Code[20]);
    BEGIN
      RESET;
      SETCURRENTKEY(Status,"Prod. Order No.","Prod. Order Line No.","Item No.","Line No.");
      SETRANGE(Status,Status::Released);
      SETRANGE("Prod. Order No.",OrderNo);
    END;

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 27.11.03 HHE Opprettet feltet "Hyllenr.", Vendor
                       Opprettet 2 nye indekser: Status,Prod. Order No.,Prod. Order Line No.,Vendor No.
                                                 Status,Prod. Order No.,Prod. Order Line No.,Hyllenr.
      02. 09.01.04 ASL Opprettet nytt felt for beskrivelse 2, verdi hentes fra onvalidate p† komponentnummer.
      03. 26.10.04 HHE Nytt felt:"Kopieres til serv.komponent" (henter da kun disse inn p† serv.varens komp.liste)
      04. 03.11.04 HHE Overf›rer verdien i feltet "Kopieres til serv.komponent" fra varekort
      05. 12.11.07 HHE Nytt felt "Item Ledger Enty Exist". Brukes til kontroll n†r man velger "Forny"
                       Endret kode p† OnDelete: Kan kun slette vareposter "Item Ledg. Entry exist"=Nei
                       (koden ser lik ut, men det var lettere † bruke denne feltverdien n†r man skal kj›re Forny p† p.o.)
      06. 11.11.08 HHE Kode som setter inn lokasjonskode p† komponenten
      07. 30.12.09 HHE Opprettet felt for "Qty on Prod. order" og "Qty on Purch Order"
      08. 27.04.17 JAL Added fields for OPC.
    }
    END.
  }
}

OBJECT Table 5409 Prod. Order Routing Line
{
  OBJECT-PROPERTIES
  {
    Date=28.09.17;
    Time=14:46:57;
    Modified=Yes;
    Version List=NAVW110.00,INC1.04,OPC6.02;
  }
  PROPERTIES
  {
    Permissions=TableData 5410=rimd;
    OnInsert=BEGIN
               TESTFIELD("Routing No.");
               IF Status = Status::Finished THEN
                 ERROR(Text006,Status,TABLECAPTION);

               IF "Next Operation No." = '' THEN
                 SetNextOperations(Rec);

               UpdateComponentsBin(0); // from trigger = insert
             END;

    OnModify=BEGIN
               IF Status = Status::Finished THEN
                 ERROR(Text006,Status,TABLECAPTION);

               UpdateComponentsBin(1); // from trigger = modify
             END;

    OnDelete=VAR
               CapLedgEntry@1000 : Record 5832;
             BEGIN
               IF Status = Status::Finished THEN
                 ERROR(Text006,Status,TABLECAPTION);

               IF Status = Status::Released THEN BEGIN
                 CapLedgEntry.SETRANGE("Order Type",CapLedgEntry."Order Type"::Production);
                 CapLedgEntry.SETRANGE("Order No.","Prod. Order No.");
                 CapLedgEntry.SETRANGE("Routing Reference No.","Routing Reference No.");
                 CapLedgEntry.SETRANGE("Routing No.","Routing No.");
                 CapLedgEntry.SETRANGE("Operation No.","Operation No.");
                 IF NOT CapLedgEntry.ISEMPTY THEN
                   ERROR(
                     Text000,
                     Status,TABLECAPTION,"Operation No.",CapLedgEntry.TABLECAPTION);
               END;

               IF SubcontractPurchOrderExist THEN
                 ERROR(
                   Text000,
                   Status,TABLECAPTION,"Operation No.",PurchLine.TABLECAPTION);

               DeleteRelations;

               UpdateComponentsBin(2); // from trigger = delete
             END;

    OnRename=BEGIN
               ERROR(Text001,TABLECAPTION);
             END;

    CaptionML=[ENU=Prod. Order Routing Line;
               NOR=Prod.ordrerutelinje];
    LookupPageID=Page99000817;
    DrillDownPageID=Page99000817;
  }
  FIELDS
  {
    { 1   ;   ;Routing No.         ;Code20        ;TableRelation="Routing Header";
                                                   CaptionML=[ENU=Routing No.;
                                                              NOR=Rutenr.] }
    { 3   ;   ;Routing Reference No.;Integer      ;CaptionML=[ENU=Routing Reference No.;
                                                              NOR=Rutereferansenr.];
                                                   Editable=No }
    { 4   ;   ;Operation No.       ;Code10        ;OnValidate=BEGIN
                                                                SetRecalcStatus;

                                                                GetLine;
                                                                "Starting Time" := ProdOrderLine."Starting Time";
                                                                "Ending Time" := ProdOrderLine."Ending Time";
                                                                "Starting Date" := ProdOrderLine."Starting Date";
                                                                "Ending Date" := ProdOrderLine."Ending Date";
                                                              END;

                                                   CaptionML=[ENU=Operation No.;
                                                              NOR=Operasjonsnr.];
                                                   NotBlank=Yes }
    { 5   ;   ;Next Operation No.  ;Code30        ;OnValidate=BEGIN
                                                                SetRecalcStatus;
                                                                GetLine;
                                                              END;

                                                   CaptionML=[ENU=Next Operation No.;
                                                              NOR=Neste operasjonsnr.] }
    { 6   ;   ;Previous Operation No.;Code30      ;OnValidate=BEGIN
                                                                SetRecalcStatus;
                                                              END;

                                                   CaptionML=[ENU=Previous Operation No.;
                                                              NOR=Forrige operasjonsnr.] }
    { 7   ;   ;Type                ;Option        ;OnValidate=BEGIN
                                                                SetRecalcStatus;

                                                                "No." := '';
                                                                "Work Center No." := '';
                                                                "Work Center Group Code" := '';

                                                                ModifyCapNeedEntries;
                                                              END;

                                                   CaptionML=[ENU=Type;
                                                              NOR=Type];
                                                   OptionCaptionML=[ENU=Work Center,Machine Center;
                                                                    NOR=Arbeidssenter,Maskinsenter];
                                                   OptionString=Work Center,Machine Center }
    { 8   ;   ;No.                 ;Code20        ;TableRelation=IF (Type=CONST(Work Center)) "Work Center"
                                                                 ELSE IF (Type=CONST(Machine Center)) "Machine Center";
                                                   OnValidate=BEGIN
                                                                IF ("No." <> xRec."No.") AND (xRec."No." <> '') THEN
                                                                  IF SubcontractPurchOrderExist THEN
                                                                    ERROR(
                                                                      Text007,
                                                                      FIELDCAPTION("No."),PurchLine.TABLECAPTION,Status,TABLECAPTION,"Operation No.");

                                                                SetRecalcStatus;

                                                                IF "No." = '' THEN
                                                                  EXIT;

                                                                CASE Type OF
                                                                  Type::"Work Center":
                                                                    BEGIN
                                                                      WorkCenter.GET("No.");
                                                                      WorkCenter.TESTFIELD(Blocked,FALSE);
                                                                      WorkCenterTransferfields;
                                                                    END;
                                                                  Type::"Machine Center":
                                                                    BEGIN
                                                                      MachineCenter.GET("No.");
                                                                      MachineCenter.TESTFIELD(Blocked,FALSE);
                                                                      MachineCtrTransferfields;
                                                                    END;
                                                                END;
                                                                ModifyCapNeedEntries;

                                                                GetLine;
                                                                IF ProdOrderLine."Routing Type" = ProdOrderLine."Routing Type"::Serial THEN
                                                                  CalcStartingEndingDates(Direction::Forward);
                                                              END;

                                                   CaptionML=[ENU=No.;
                                                              NOR=Nr.] }
    { 9   ;   ;Work Center No.     ;Code20        ;TableRelation="Work Center";
                                                   CaptionML=[ENU=Work Center No.;
                                                              NOR=Arbeidssenternr.];
                                                   Editable=No }
    { 10  ;   ;Work Center Group Code;Code10      ;TableRelation="Work Center Group";
                                                   CaptionML=[ENU=Work Center Group Code;
                                                              NOR=Arbeidssentergruppekode];
                                                   Editable=No }
    { 11  ;   ;Description         ;Text50        ;CaptionML=[ENU=Description;
                                                              NOR=Beskrivelse] }
    { 12  ;   ;Setup Time          ;Decimal       ;OnValidate=BEGIN
                                                                CalcStartingEndingDates(Direction::Forward);
                                                              END;

                                                   CaptionML=[ENU=Setup Time;
                                                              NOR=Oppstillingstid];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
    { 13  ;   ;Run Time            ;Decimal       ;OnValidate=BEGIN
                                                                CalcStartingEndingDates(Direction::Forward);
                                                              END;

                                                   CaptionML=[ENU=Run Time;
                                                              NOR=Operasjonstid];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
    { 14  ;   ;Wait Time           ;Decimal       ;OnValidate=BEGIN
                                                                CalcStartingEndingDates(Direction::Forward);
                                                              END;

                                                   CaptionML=[ENU=Wait Time;
                                                              NOR=Ventetid];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
    { 15  ;   ;Move Time           ;Decimal       ;OnValidate=BEGIN
                                                                CalcStartingEndingDates(Direction::Forward);
                                                              END;

                                                   CaptionML=[ENU=Move Time;
                                                              NOR=Transporttid];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
    { 16  ;   ;Fixed Scrap Quantity;Decimal       ;OnValidate=BEGIN
                                                                SetRecalcStatus;
                                                              END;

                                                   CaptionML=[ENU=Fixed Scrap Quantity;
                                                              NOR=Fast vrakantall];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
    { 17  ;   ;Lot Size            ;Decimal       ;CaptionML=[ENU=Lot Size;
                                                              NOR=Partist›rrelse];
                                                   DecimalPlaces=0:5 }
    { 18  ;   ;Scrap Factor %      ;Decimal       ;OnValidate=BEGIN
                                                                SetRecalcStatus;
                                                              END;

                                                   CaptionML=[ENU=Scrap Factor %;
                                                              NOR=Vrakfaktor-%];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
    { 19  ;   ;Setup Time Unit of Meas. Code;Code10;
                                                   TableRelation="Capacity Unit of Measure";
                                                   OnValidate=BEGIN
                                                                CalcStartingEndingDates(Direction::Forward);
                                                              END;

                                                   CaptionML=[ENU=Setup Time Unit of Meas. Code;
                                                              NOR=Oppstillingstid - enhetskode] }
    { 20  ;   ;Run Time Unit of Meas. Code;Code10 ;TableRelation="Capacity Unit of Measure";
                                                   OnValidate=BEGIN
                                                                CalcStartingEndingDates(Direction::Forward);
                                                              END;

                                                   CaptionML=[ENU=Run Time Unit of Meas. Code;
                                                              NOR=Operasjonstid - enhetskode] }
    { 21  ;   ;Wait Time Unit of Meas. Code;Code10;TableRelation="Capacity Unit of Measure";
                                                   OnValidate=BEGIN
                                                                CalcStartingEndingDates(Direction::Forward);
                                                              END;

                                                   CaptionML=[ENU=Wait Time Unit of Meas. Code;
                                                              NOR=Ventetid - enhetskode] }
    { 22  ;   ;Move Time Unit of Meas. Code;Code10;TableRelation="Capacity Unit of Measure";
                                                   OnValidate=BEGIN
                                                                CalcStartingEndingDates(Direction::Forward);
                                                              END;

                                                   CaptionML=[ENU=Move Time Unit of Meas. Code;
                                                              NOR=Transporttid - enhetskode] }
    { 27  ;   ;Minimum Process Time;Decimal       ;CaptionML=[ENU=Minimum Process Time;
                                                              NOR=Minimum behandlingstid];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
    { 28  ;   ;Maximum Process Time;Decimal       ;CaptionML=[ENU=Maximum Process Time;
                                                              NOR=Maksimal behandlingstid];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
    { 30  ;   ;Concurrent Capacities;Decimal      ;InitValue=1;
                                                   OnValidate=BEGIN
                                                                CalcStartingEndingDates(Direction::Forward);
                                                              END;

                                                   CaptionML=[ENU=Concurrent Capacities;
                                                              NOR=Samtidige kapasiteter];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
    { 31  ;   ;Send-Ahead Quantity ;Decimal       ;OnValidate=BEGIN
                                                                CalcStartingEndingDates(Direction::Forward);
                                                              END;

                                                   CaptionML=[ENU=Send-Ahead Quantity;
                                                              NOR=Overlappantall];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
    { 34  ;   ;Routing Link Code   ;Code10        ;TableRelation="Routing Link";
                                                   CaptionML=[ENU=Routing Link Code;
                                                              NOR=Rutekoblingskode];
                                                   Editable=No }
    { 35  ;   ;Standard Task Code  ;Code10        ;TableRelation="Standard Task";
                                                   OnValidate=VAR
                                                                StandardTask@1000 : Record 99000778;
                                                                StdTaskTool@1001 : Record 99000781;
                                                                StdTaskPersonnel@1002 : Record 99000782;
                                                                StdTaskQltyMeasure@1003 : Record 99000784;
                                                                StdTaskComment@1004 : Record 99000783;
                                                              BEGIN
                                                                IF "Standard Task Code" = '' THEN
                                                                  EXIT;

                                                                StandardTask.GET("Standard Task Code");
                                                                Description := StandardTask.Description;

                                                                DeleteRelations;

                                                                StdTaskTool.SETRANGE("Standard Task Code","Standard Task Code");
                                                                IF StdTaskTool.FIND('-') THEN
                                                                  REPEAT
                                                                    ProdOrderRoutTool.Status := Status;
                                                                    ProdOrderRoutTool."Prod. Order No." := "Prod. Order No.";
                                                                    ProdOrderRoutTool."Routing Reference No." := "Routing Reference No.";
                                                                    ProdOrderRoutTool."Routing No." := "Routing No.";
                                                                    ProdOrderRoutTool."Operation No." := "Operation No.";
                                                                    ProdOrderRoutTool."Line No." := StdTaskTool."Line No.";
                                                                    ProdOrderRoutTool."No." := StdTaskTool."No.";
                                                                    ProdOrderRoutTool.Description := StdTaskTool.Description;
                                                                    ProdOrderRoutTool.INSERT;
                                                                  UNTIL StdTaskTool.NEXT = 0;

                                                                StdTaskPersonnel.SETRANGE("Standard Task Code","Standard Task Code");
                                                                IF StdTaskPersonnel.FIND('-') THEN
                                                                  REPEAT
                                                                    ProdOrderRtngPersonnel.Status := Status;
                                                                    ProdOrderRtngPersonnel."Prod. Order No." := "Prod. Order No.";
                                                                    ProdOrderRtngPersonnel."Routing Reference No." := "Routing Reference No.";
                                                                    ProdOrderRtngPersonnel."Routing No." := "Routing No.";
                                                                    ProdOrderRtngPersonnel."Operation No." := "Operation No.";
                                                                    ProdOrderRtngPersonnel."Line No." := StdTaskPersonnel."Line No.";
                                                                    ProdOrderRtngPersonnel."No." := StdTaskPersonnel."No.";
                                                                    ProdOrderRtngPersonnel.Description := StdTaskPersonnel.Description;
                                                                    ProdOrderRtngPersonnel.INSERT;
                                                                  UNTIL StdTaskPersonnel.NEXT = 0;

                                                                StdTaskQltyMeasure.SETRANGE("Standard Task Code","Standard Task Code");
                                                                IF StdTaskQltyMeasure.FIND('-') THEN
                                                                  REPEAT
                                                                    ProdOrderRtngQltyMeas.Status := Status;
                                                                    ProdOrderRtngQltyMeas."Prod. Order No." := "Prod. Order No.";
                                                                    ProdOrderRtngQltyMeas."Routing Reference No." := "Routing Reference No.";
                                                                    ProdOrderRtngQltyMeas."Routing No." := "Routing No.";
                                                                    ProdOrderRtngQltyMeas."Operation No." := "Operation No.";
                                                                    ProdOrderRtngQltyMeas."Line No." := StdTaskQltyMeasure."Line No.";
                                                                    ProdOrderRtngQltyMeas."Qlty Measure Code" := StdTaskQltyMeasure."Qlty Measure Code";
                                                                    ProdOrderRtngQltyMeas.Description := StdTaskQltyMeasure.Description;
                                                                    ProdOrderRtngQltyMeas."Min. Value" := StdTaskQltyMeasure."Min. Value";
                                                                    ProdOrderRtngQltyMeas."Max. Value" := StdTaskQltyMeasure."Max. Value";
                                                                    ProdOrderRtngQltyMeas."Mean Tolerance" := StdTaskQltyMeasure."Mean Tolerance";
                                                                    ProdOrderRtngQltyMeas.INSERT;
                                                                  UNTIL StdTaskQltyMeasure.NEXT = 0;

                                                                StdTaskComment.SETRANGE("Standard Task Code","Standard Task Code");
                                                                IF StdTaskComment.FIND('-') THEN
                                                                  REPEAT
                                                                    ProdOrderRtngComment.Status := Status;
                                                                    ProdOrderRtngComment."Prod. Order No." := "Prod. Order No.";
                                                                    ProdOrderRtngComment."Routing Reference No." := "Routing Reference No.";
                                                                    ProdOrderRtngComment."Routing No." := "Routing No.";
                                                                    ProdOrderRtngComment."Operation No." := "Operation No.";
                                                                    ProdOrderRtngComment."Line No." := StdTaskComment."Line No.";
                                                                    ProdOrderRtngComment.Comment := StdTaskComment.Text;
                                                                    ProdOrderRtngComment.INSERT;
                                                                  UNTIL StdTaskComment.NEXT = 0;
                                                              END;

                                                   CaptionML=[ENU=Standard Task Code;
                                                              NOR=Standardoppgavekode] }
    { 40  ;   ;Unit Cost per       ;Decimal       ;OnValidate=BEGIN
                                                                GLSetup.GET;
                                                                "Direct Unit Cost" :=
                                                                  ROUND(
                                                                    ("Unit Cost per" - "Overhead Rate") /
                                                                    (1 + "Indirect Cost %" / 100),
                                                                    GLSetup."Unit-Amount Rounding Precision");

                                                                CalcStartingEndingDates(Direction::Forward);
                                                              END;

                                                   CaptionML=[ENU=Unit Cost per;
                                                              NOR=Enhetskost per];
                                                   MinValue=0;
                                                   AutoFormatType=2 }
    { 41  ;   ;Recalculate         ;Boolean       ;CaptionML=[ENU=Recalculate;
                                                              NOR=Beregn p† nytt] }
    { 50  ;   ;Sequence No. (Forward);Integer     ;CaptionML=[ENU=Sequence No. (Forward);
                                                              NOR=Rekkef›lgenr. (fremover)];
                                                   Editable=No }
    { 51  ;   ;Sequence No. (Backward);Integer    ;CaptionML=[ENU=Sequence No. (Backward);
                                                              NOR=Rekkef›lgenr. (bakover)];
                                                   Editable=No }
    { 52  ;   ;Fixed Scrap Qty. (Accum.);Decimal  ;CaptionML=[ENU=Fixed Scrap Qty. (Accum.);
                                                              NOR=Fast vrakantall (akkum.)];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 53  ;   ;Scrap Factor % (Accumulated);Decimal;
                                                   CaptionML=[ENU=Scrap Factor % (Accumulated);
                                                              NOR=Vrakfaktor-% (akkumulert)];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 55  ;   ;Sequence No. (Actual);Integer      ;CaptionML=[ENU=Sequence No. (Actual);
                                                              NOR=Rekkef›lgenr. (faktisk)];
                                                   Editable=No }
    { 56  ;   ;Direct Unit Cost    ;Decimal       ;OnValidate=BEGIN
                                                                VALIDATE("Indirect Cost %");
                                                              END;

                                                   CaptionML=[ENU=Direct Unit Cost;
                                                              NOR=Direkte enhetskost];
                                                   DecimalPlaces=2:5 }
    { 57  ;   ;Indirect Cost %     ;Decimal       ;OnValidate=BEGIN
                                                                GLSetup.GET;
                                                                "Unit Cost per" :=
                                                                  ROUND(
                                                                    "Direct Unit Cost" * (1 + "Indirect Cost %" / 100) + "Overhead Rate",
                                                                    GLSetup."Unit-Amount Rounding Precision");
                                                              END;

                                                   CaptionML=[ENU=Indirect Cost %;
                                                              NOR=Indirekte kost-%];
                                                   DecimalPlaces=0:5 }
    { 58  ;   ;Overhead Rate       ;Decimal       ;OnValidate=BEGIN
                                                                VALIDATE("Indirect Cost %");
                                                              END;

                                                   CaptionML=[ENU=Overhead Rate;
                                                              NOR=Sats for indirekte kostnader];
                                                   DecimalPlaces=0:5 }
    { 70  ;   ;Starting Time       ;Time          ;OnValidate=BEGIN
                                                                CalcStartingEndingDates(Direction::Forward);
                                                              END;

                                                   CaptionML=[ENU=Starting Time;
                                                              NOR=Starttidspunkt] }
    { 71  ;   ;Starting Date       ;Date          ;OnValidate=BEGIN
                                                                VALIDATE("Starting Time");
                                                              END;

                                                   CaptionML=[ENU=Starting Date;
                                                              NOR=Startdato] }
    { 72  ;   ;Ending Time         ;Time          ;OnValidate=BEGIN
                                                                CalcStartingEndingDates(Direction::Backward);
                                                              END;

                                                   CaptionML=[ENU=Ending Time;
                                                              NOR=Sluttidspunkt] }
    { 73  ;   ;Ending Date         ;Date          ;OnValidate=BEGIN
                                                                VALIDATE("Ending Time");
                                                              END;

                                                   CaptionML=[ENU=Ending Date;
                                                              NOR=Sluttdato] }
    { 74  ;   ;Status              ;Option        ;CaptionML=[ENU=Status;
                                                              NOR=Status];
                                                   OptionCaptionML=[ENU=Simulated,Planned,Firm Planned,Released,Finished;
                                                                    NOR=Simulert,Planlagt,Fast planlagt,Frigitt,Ferdig];
                                                   OptionString=Simulated,Planned,Firm Planned,Released,Finished }
    { 75  ;   ;Prod. Order No.     ;Code20        ;TableRelation="Production Order".No. WHERE (Status=FIELD(Status));
                                                   CaptionML=[ENU=Prod. Order No.;
                                                              NOR=Prod.ordrenr.];
                                                   NotBlank=Yes;
                                                   Editable=No }
    { 76  ;   ;Unit Cost Calculation;Option       ;CaptionML=[ENU=Unit Cost Calculation;
                                                              NOR=Beregning av enhetskost];
                                                   OptionCaptionML=[ENU=Time,Units;
                                                                    NOR=Tid,Enheter];
                                                   OptionString=Time,Units }
    { 77  ;   ;Input Quantity      ;Decimal       ;CaptionML=[ENU=Input Quantity;
                                                              NOR=Tilgangsantall];
                                                   DecimalPlaces=0:5 }
    { 78  ;   ;Critical Path       ;Boolean       ;CaptionML=[ENU=Critical Path;
                                                              NOR=Kritisk bane];
                                                   Editable=No }
    { 79  ;   ;Routing Status      ;Option        ;OnValidate=VAR
                                                                ProdOrderCapacityNeed@1000 : Record 5410;
                                                              BEGIN
                                                                IF (xRec."Routing Status" = xRec."Routing Status"::Finished) AND (xRec."Routing Status" <> "Routing Status") THEN
                                                                  ERROR(Text008,FIELDCAPTION("Routing Status"),xRec."Routing Status","Routing Status");

                                                                IF ("Routing Status" = "Routing Status"::Finished) AND (xRec."Routing Status" <> "Routing Status") THEN BEGIN
                                                                  IF NOT CONFIRM(Text009,FALSE,FIELDCAPTION("Routing Status"),"Routing Status") THEN
                                                                    ERROR('');

                                                                  ProdOrderCapacityNeed.SETCURRENTKEY(
                                                                    Status,"Prod. Order No.","Requested Only","Routing No.","Routing Reference No.","Operation No.","Line No.");
                                                                  ProdOrderCapacityNeed.SETRANGE(Status,Status);
                                                                  ProdOrderCapacityNeed.SETRANGE("Prod. Order No.","Prod. Order No.");
                                                                  ProdOrderCapacityNeed.SETRANGE("Requested Only",FALSE);
                                                                  ProdOrderCapacityNeed.SETRANGE("Routing No.","Routing No.");
                                                                  ProdOrderCapacityNeed.SETRANGE("Routing Reference No.","Routing Reference No.");
                                                                  ProdOrderCapacityNeed.SETRANGE("Operation No.","Operation No.");
                                                                  ProdOrderCapacityNeed.MODIFYALL("Allocated Time",0);
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Routing Status;
                                                              NOR=Rutestatus];
                                                   OptionCaptionML=[ENU=" ,Planned,In Progress,Finished";
                                                                    NOR=" ,Planlagt,I arbeid,Ferdig"];
                                                   OptionString=[ ,Planned,In Progress,Finished] }
    { 81  ;   ;Flushing Method     ;Option        ;InitValue=Manual;
                                                   CaptionML=[ENU=Flushing Method;
                                                              NOR=Trekkmetode];
                                                   OptionCaptionML=[ENU=Manual,Forward,Backward;
                                                                    NOR=Manuell,Forlengs,Baklengs];
                                                   OptionString=Manual,Forward,Backward }
    { 90  ;   ;Expected Operation Cost Amt.;Decimal;
                                                   CaptionML=[ENU=Expected Operation Cost Amt.;
                                                              NOR=Forventet operasjonskostbel›p];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 91  ;   ;Expected Capacity Need;Decimal     ;FieldClass=Normal;
                                                   CaptionML=[ENU=Expected Capacity Need;
                                                              NOR=Forventet kapasitetsbehov];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 96  ;   ;Expected Capacity Ovhd. Cost;Decimal;
                                                   CaptionML=[ENU=Expected Capacity Ovhd. Cost;
                                                              NOR=Forventet indir. kap.kostn.];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 98  ;   ;Starting Date-Time  ;DateTime      ;OnValidate=BEGIN
                                                                "Starting Date" := DT2DATE("Starting Date-Time");
                                                                "Starting Time" := DT2TIME("Starting Date-Time");
                                                                VALIDATE("Starting Time");
                                                              END;

                                                   CaptionML=[ENU=Starting Date-Time;
                                                              NOR=Startdato-tidsp.] }
    { 99  ;   ;Ending Date-Time    ;DateTime      ;OnValidate=BEGIN
                                                                "Ending Date" := DT2DATE("Ending Date-Time");
                                                                "Ending Time" := DT2TIME("Ending Date-Time");
                                                                VALIDATE("Ending Time");
                                                              END;

                                                   CaptionML=[ENU=Ending Date-Time;
                                                              NOR=Sluttdato-tidsp.] }
    { 100 ;   ;Schedule Manually   ;Boolean       ;CaptionML=[ENU=Schedule Manually;
                                                              NOR=Tidsplanlegg manuelt] }
    { 101 ;   ;Location Code       ;Code10        ;AccessByPermission=TableData 14=R;
                                                   CaptionML=[ENU=Location Code;
                                                              NOR=Lokasjonskode];
                                                   Editable=No }
    { 7301;   ;Open Shop Floor Bin Code;Code20    ;AccessByPermission=TableData 5771=R;
                                                   CaptionML=[ENU=Open Shop Floor Bin Code;
                                                              NOR=pen prod.hyllekode];
                                                   Editable=No }
    { 7302;   ;To-Production Bin Code;Code20      ;AccessByPermission=TableData 5771=R;
                                                   CaptionML=[ENU=To-Production Bin Code;
                                                              NOR=Til-Hyllekode for produksjon];
                                                   Editable=No }
    { 7303;   ;From-Production Bin Code;Code20    ;AccessByPermission=TableData 5771=R;
                                                   CaptionML=[ENU=From-Production Bin Code;
                                                              NOR=Fra-Hyllekode for produksjon];
                                                   Editable=No }
    { 70150;  ;Orden FCS           ;BigInteger    ;Editable=No }
    { 70151;  ;Stable              ;Boolean        }
    { 70155;  ;Starting Real Date  ;Date          ;FieldClass=FlowField;
                                                   CalcFormula=Min("Capacity Ledger Entry"."Posting Date" WHERE (Order Type=CONST(Production),
                                                                                                                 Order No.=FIELD(Prod. Order No.),
                                                                                                                 Routing Reference No.=FIELD(Routing Reference No.),
                                                                                                                 Routing No.=FIELD(Routing No.),
                                                                                                                 Operation No.=FIELD(Operation No.)));
                                                   CaptionML=[ENU=Starting Real Date;
                                                              NOR=Virkelig startdato];
                                                   Editable=No }
    { 70156;  ;Starting Real Time  ;Time          ;FieldClass=FlowField;
                                                   CalcFormula=Min("Capacity Ledger Entry"."Starting Time" WHERE (Order Type=CONST(Production),
                                                                                                                  Order No.=FIELD(Prod. Order No.),
                                                                                                                  Routing Reference No.=FIELD(Routing Reference No.),
                                                                                                                  Routing No.=FIELD(Routing No.),
                                                                                                                  Operation No.=FIELD(Operation No.),
                                                                                                                  Posting Date=FIELD(Starting Real Date),
                                                                                                                  Starting Time=FILTER(<>'')));
                                                   CaptionML=[ENU=Starting Real Time;
                                                              NOR=Virkelig starttid];
                                                   Editable=No }
    { 70157;  ;Ending Real Date    ;Date          ;FieldClass=FlowField;
                                                   CalcFormula=Max("Capacity Ledger Entry"."Posting Date" WHERE (Order Type=CONST(Production),
                                                                                                                 Order No.=FIELD(Prod. Order No.),
                                                                                                                 Routing Reference No.=FIELD(Routing Reference No.),
                                                                                                                 Routing No.=FIELD(Routing No.),
                                                                                                                 Operation No.=FIELD(Operation No.)));
                                                   CaptionML=[ENU=Ending Real Date;
                                                              NOR=Virkelig sluttdato];
                                                   Editable=No }
    { 70158;  ;Ending Real Time    ;Time          ;FieldClass=FlowField;
                                                   CalcFormula=Max("Capacity Ledger Entry"."Ending Time" WHERE (Order Type=CONST(Production),
                                                                                                                Order No.=FIELD(Prod. Order No.),
                                                                                                                Routing Reference No.=FIELD(Routing Reference No.),
                                                                                                                Routing No.=FIELD(Routing No.),
                                                                                                                Operation No.=FIELD(Operation No.),
                                                                                                                Posting Date=FIELD(Ending Real Date)));
                                                   CaptionML=[ENU=Ending Real Time;
                                                              NOR=Virkelig slutttid];
                                                   Editable=No }
    { 70159;  ;Setup Real Time     ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Capacity Ledger Entry"."Setup Time" WHERE (Order Type=CONST(Production),
                                                                                                               Order No.=FIELD(Prod. Order No.),
                                                                                                               Routing Reference No.=FIELD(Routing Reference No.),
                                                                                                               Routing No.=FIELD(Routing No.),
                                                                                                               Operation No.=FIELD(Operation No.)));
                                                   CaptionML=[ENU=Setup Real Time;
                                                              NOR=Virkelig Oppstillingstid];
                                                   Editable=No }
    { 70160;  ;Run Real Time       ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Capacity Ledger Entry"."Run Time" WHERE (Order Type=CONST(Production),
                                                                                                             Order No.=FIELD(Prod. Order No.),
                                                                                                             Routing Reference No.=FIELD(Routing Reference No.),
                                                                                                             Routing No.=FIELD(Routing No.),
                                                                                                             Operation No.=FIELD(Operation No.)));
                                                   CaptionML=[ENU=Run Real Time;
                                                              NOR=Virkelig Operasjonstid];
                                                   Editable=No }
    { 70161;  ;Last Planned Starting Date;Date    ;CaptionML=[ENU=Last Planned Starting Date;
                                                              NOR=Sist planlagte startdato] }
    { 70162;  ;Last Planned Starting Time;Time    ;CaptionML=[ENU=Last Planned Starting Time;
                                                              NOR=Sist planlagte starttid] }
    { 70163;  ;Last Planned Ending Date;Date      ;CaptionML=[ENU=Last Planned Ending Date;
                                                              NOR=Sist planlagte sluttdato] }
    { 70164;  ;Last Planned Ending Time;Time      ;CaptionML=[ENU=Last Planned Ending Time;
                                                              NOR=Sist planlagte sluttid] }
    { 70165;  ;Due date            ;Date          ;CaptionML=[ENU=Due date;
                                                              NOR=Forfallsdato] }
    { 70166;  ;Run Time Temp       ;Decimal       ;CaptionML=[ENU=Run Time Temp;
                                                              NOR=Overlappsantall temp] }
    { 70167;  ;Blocked             ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Production Order".Blocked WHERE (Status=FIELD(Status),
                                                                                                        No.=FIELD(Prod. Order No.)));
                                                   CaptionML=[ENU=Blocked;
                                                              NOR=Sperret];
                                                   Editable=No }
    { 70168;  ;Scrap Quantity      ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Capacity Ledger Entry"."Scrap Quantity" WHERE (Order Type=CONST(Production),
                                                                                                                   Order No.=FIELD(Prod. Order No.),
                                                                                                                   Routing Reference No.=FIELD(Routing Reference No.),
                                                                                                                   Routing No.=FIELD(Routing No.),
                                                                                                                   Operation No.=FIELD(Operation No.)));
                                                   CaptionML=[ENU=Scrap Quantity;
                                                              NOR=vrakantall];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 70169;  ;Minimum Starting Date;Date         ;CaptionML=[ENU=Minimum Starting Date;
                                                              NOR=Tidligste startdato] }
    { 70170;  ;Minimum Starting Time;Time         ;CaptionML=[ENU=Minimum Starting Time;
                                                              NOR=Tidligste starttid] }
    { 70171;  ;Output Quantity     ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Capacity Ledger Entry"."Output Quantity" WHERE (Order Type=CONST(Production),
                                                                                                                    Order No.=FIELD(Prod. Order No.),
                                                                                                                    Routing Reference No.=FIELD(Routing Reference No.),
                                                                                                                    Routing No.=FIELD(Routing No.),
                                                                                                                    Operation No.=FIELD(Operation No.)));
                                                   CaptionML=[ENU=Output Quantity;
                                                              NOR=Avgangsantall];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 70172;  ;Low-Level Code      ;Integer       ;CaptionML=[ENU=Low-Level Code;
                                                              NOR=Lavniv†kode];
                                                   Editable=No }
    { 70173;  ;Queue time (minutes);Decimal       ;CaptionML=[ENU=Queue time (minutes);
                                                              NOR=K›-tid (minutter)] }
    { 70174;  ;Fixed               ;Boolean        }
    { 70175;  ;Granule No.         ;Integer       ;CaptionML=[ENU=Granule No.;
                                                              NOR=Granul nr.] }
    { 70176;  ;FCS Status          ;Integer       ;CaptionML=[ENU=FCS Status;
                                                              NOR=FCS status] }
    { 70177;  ;Granule Field       ;Code50        ;CaptionML=[ENU=Granule Field;
                                                              NOR=Granul felt] }
    { 83300;  ;Finished Qty        ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Capacity Ledger Entry"."Output Quantity" WHERE (Order Type=CONST(Production),
                                                                                                                    Order No.=FIELD(Prod. Order No.),
                                                                                                                    Operation No.=FIELD(Operation No.)));
                                                   CaptionML=NOR=Ferdig Antall;
                                                   Description=OPC }
    { 83301;  ;Dokument Link       ;Text80        ;CaptionML=NOR=Tilknyttet dokument;
                                                   Description=OPC }
    { 83302;  ;Actual Run Time     ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Capacity Ledger Entry"."Run Time" WHERE (Order Type=CONST(Production),
                                                                                                             Order No.=FIELD(Prod. Order No.),
                                                                                                             Operation No.=FIELD(Operation No.)));
                                                   CaptionML=NOR=Forbrukt tid;
                                                   Description=OPC }
    { 83303;  ;Actual Direct Cost  ;Decimal       ;CaptionML=[ENU=Actual Direct Cost;
                                                              NOR=Faktisk Direkte Kost];
                                                   Description=OPC }
    { 83304;  ;Actual Indirect Cost;Decimal       ;CaptionML=[ENU=Actual Indirect Cost;
                                                              NOR=Faktisk Indirekte Kost];
                                                   Description=OPC }
  }
  KEYS
  {
    {    ;Status,Prod. Order No.,Routing Reference No.,Routing No.,Operation No.;
                                                   SumIndexFields=Expected Operation Cost Amt.,Expected Capacity Need,Expected Capacity Ovhd. Cost;
                                                   Clustered=Yes }
    {    ;Prod. Order No.,Routing Reference No.,Status,Routing No.,Operation No.;
                                                   MaintainSIFTIndex=No }
    {    ;Status,Prod. Order No.,Routing Reference No.,Routing No.,Sequence No. (Forward) }
    {    ;Status,Prod. Order No.,Routing Reference No.,Routing No.,Sequence No. (Backward) }
    {    ;Status,Prod. Order No.,Routing Reference No.,Routing No.,Sequence No. (Actual) }
    {    ;Work Center No.                         ;SumIndexFields=Expected Operation Cost Amt.;
                                                   MaintainSIFTIndex=No }
    {    ;Type,No.,Starting Date                  ;SumIndexFields=Expected Operation Cost Amt.;
                                                   MaintainSIFTIndex=No }
    {    ;Status,Work Center No.                   }
    {    ;Prod. Order No.,Status,Flushing Method   }
    {    ;Starting Date,Starting Time             ;MaintainSQLIndex=No;
                                                   MaintainSIFTIndex=No }
    {    ;Ending Date,Ending Time                 ;MaintainSQLIndex=No;
                                                   MaintainSIFTIndex=No }
    {    ;Work Center Group Code,Routing Status,Status,Setup Time Unit of Meas. Code,Run Time Unit of Meas. Code,Move Time Unit of Meas. Code }
    {    ;Operation No.                            }
    {    ;Work Center Group Code,Status,No.        }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      Text000@1000 : TextConst '@@@="%1 = Document status; %2 = Table Caption; %3 = Field Value; %4 = Table Caption";ENU=You cannot delete %1 %2 %3 because there is at least one %4 associated with it.;NOR=Du kan ikke slette %1 %2 %3 fordi det finnes minst ‚n %4 tilknyttet.';
      Text001@1001 : TextConst 'ENU=You cannot rename a %1.;NOR=Du kan ikke gi nytt navn til en %1.';
      Text002@1002 : TextConst 'ENU=This routing line cannot be moved because of critical work centers in previous operations;NOR=Denne rutelinjen kan ikke flyttes p† grunn av kritiske arbeidssentre i tidligere operasjoner';
      Text003@1003 : TextConst 'ENU=This routing line cannot be moved because of critical work centers in next operations;NOR=Denne rutelinjen kan ikke flyttes p† grunn av kritiske arbeidssentre i kommende operasjoner';
      WorkCenter@1006 : Record 99000754;
      MachineCenter@1007 : Record 99000758;
      ProdOrderLine@1008 : Record 5406;
      ProdOrderRtngLine@1009 : Record 5409;
      ProdOrderRoutTool@1010 : Record 5411;
      ProdOrderRtngPersonnel@1011 : Record 5412;
      ProdOrderRtngQltyMeas@1012 : Record 5413;
      ProdOrderRtngComment@1013 : Record 5415;
      GLSetup@1005 : Record 98;
      ProdOrderCapNeed@1014 : Record 5410;
      PurchLine@1021 : Record 39;
      CalcProdOrder@1015 : Codeunit 99000773;
      ProdOrderRouteMgt@1016 : Codeunit 99000772;
      Text004@1019 : TextConst 'ENU=Some routing lines are referring to the operation just deleted. The references are\in the fields %1 and %2.\\This may have to be corrected as a routing line referring to a non-existent\operation will lead to serious errors in capacity planning.\\Do you want to see a list of the lines in question?\(Access the columns Next Operation No. and Previous Operation No.);NOR=Noen av rutelinjene viser til operasjonen som nettopp ble slettet. Henvisningene finnes\i feltene %1 og %2.\\Det kan v‘re at dette m† korrigeres fordi en rutelinje som viser til en ikke-eksisterende\operasjon kan medf›re alvorlige feil i kapasitetsplanleggingen.\\Vil du se en oversikt over de aktuelle linjene?\(Se i kolonnene Neste operasjonsnr. og Forrige operasjonsnr.)';
      Text005@1004 : TextConst 'ENU=Routing Lines referring to deleted Operation No. %1;NOR=Rutelinjene viser til slettet operasjonsnr. %1';
      Text006@1020 : TextConst 'ENU=A %1 %2 can not be inserted, modified, or deleted.;NOR=Det kan ikke settes inn, endres eller slettes noen %1 %2.';
      Direction@1018 : 'Forward,Backward';
      Text007@1022 : TextConst 'ENU=You cannot change %1, because there is at least one %2 associated with %3 %4 %5.;NOR=Du kan ikke endre %1 fordi det er minst ‚n %2 tilknyttet %3 %4 %5.';
      Text008@1023 : TextConst 'ENU=You cannot change the %1 from %2 to %3.;NOR=Du kan ikke endre %1 fra %2 til %3.';
      Text009@1024 : TextConst 'ENU=If you change the %1 to %2, then all related allocated capacity will be deleted, and you will not be able to change the %1 of the operation again.\\Are you sure that you want to continue?;NOR=Hvis du endrer %1 til %2, slettes all relatert tildelt kapasitet, og du kan ikke endre %1 for operasjonen p† nytt.\\Er du sikker p† at du vil fortsette?';
      SkipUpdateOfCompBinCodes@1017 : Boolean;

    PROCEDURE Caption@12() : Text[100];
    VAR
      ProdOrder@1000 : Record 5405;
    BEGIN
      IF GETFILTERS = '' THEN
        EXIT('');

      IF NOT ProdOrder.GET(Status,"Prod. Order No.") THEN
        EXIT('');

      EXIT(
        STRSUBSTNO('%1 %2 %3',
          "Prod. Order No.",ProdOrder.Description,"Routing No."));
    END;

    LOCAL PROCEDURE GetLine@15();
    BEGIN
      ProdOrderLine.SETRANGE(Status,Status);
      ProdOrderLine.SETRANGE("Prod. Order No.","Prod. Order No.");
      ProdOrderLine.SETRANGE("Routing No.","Routing No.");
      ProdOrderLine.SETRANGE("Routing Reference No.","Routing Reference No.");
      ProdOrderLine.FIND('-');
    END;

    LOCAL PROCEDURE DeleteRelations@3();
    BEGIN
      ProdOrderRoutTool.SETRANGE(Status,Status);
      ProdOrderRoutTool.SETRANGE("Prod. Order No.","Prod. Order No.");
      ProdOrderRoutTool.SETRANGE("Routing Reference No.","Routing Reference No.");
      ProdOrderRoutTool.SETRANGE("Routing No.","Routing No.");
      ProdOrderRoutTool.SETRANGE("Operation No.","Operation No.");
      ProdOrderRoutTool.DELETEALL;

      ProdOrderRtngPersonnel.SETRANGE(Status,Status);
      ProdOrderRtngPersonnel.SETRANGE("Prod. Order No.","Prod. Order No.");
      ProdOrderRtngPersonnel.SETRANGE("Routing Reference No.","Routing Reference No.");
      ProdOrderRtngPersonnel.SETRANGE("Routing No.","Routing No.");
      ProdOrderRtngPersonnel.SETRANGE("Operation No.","Operation No.");
      ProdOrderRtngPersonnel.DELETEALL;

      ProdOrderRtngQltyMeas.SETRANGE(Status,Status);
      ProdOrderRtngQltyMeas.SETRANGE("Prod. Order No.","Prod. Order No.");
      ProdOrderRtngQltyMeas.SETRANGE("Routing Reference No.","Routing Reference No.");
      ProdOrderRtngQltyMeas.SETRANGE("Routing No.","Routing No.");
      ProdOrderRtngQltyMeas.SETRANGE("Operation No.","Operation No.");
      ProdOrderRtngQltyMeas.DELETEALL;

      ProdOrderRtngComment.SETRANGE(Status,Status);
      ProdOrderRtngComment.SETRANGE("Prod. Order No.","Prod. Order No.");
      ProdOrderRtngComment.SETRANGE("Routing Reference No.","Routing Reference No.");
      ProdOrderRtngComment.SETRANGE("Routing No.","Routing No.");
      ProdOrderRtngComment.SETRANGE("Operation No.","Operation No.");
      ProdOrderRtngComment.DELETEALL;

      ProdOrderCapNeed.SETRANGE(Status,Status);
      ProdOrderCapNeed.SETRANGE("Prod. Order No.","Prod. Order No.");
      ProdOrderCapNeed.SETRANGE("Routing No.","Routing No.");
      ProdOrderCapNeed.SETRANGE("Routing Reference No.","Routing Reference No.");
      ProdOrderCapNeed.SETRANGE("Operation No.","Operation No.");
      ProdOrderCapNeed.DELETEALL;
    END;

    LOCAL PROCEDURE WorkCenterTransferfields@2();
    BEGIN
      "Work Center No." := WorkCenter."No.";
      "Work Center Group Code" := WorkCenter."Work Center Group Code";
      "Setup Time Unit of Meas. Code" := WorkCenter."Unit of Measure Code";
      "Run Time Unit of Meas. Code" := WorkCenter."Unit of Measure Code";
      "Wait Time Unit of Meas. Code" := WorkCenter."Unit of Measure Code";
      "Move Time Unit of Meas. Code" := WorkCenter."Unit of Measure Code";
      Description := WorkCenter.Name;
      "Flushing Method" := WorkCenter."Flushing Method";
      "Unit Cost per" := WorkCenter."Unit Cost";
      "Direct Unit Cost" := WorkCenter."Direct Unit Cost";
      "Indirect Cost %" := WorkCenter."Indirect Cost %";
      "Overhead Rate" := WorkCenter."Overhead Rate";
      "Unit Cost Calculation" := WorkCenter."Unit Cost Calculation";
      FillDefaultLocationAndBins;
    END;

    LOCAL PROCEDURE MachineCtrTransferfields@1();
    BEGIN
      WorkCenter.GET(MachineCenter."Work Center No.");
      WorkCenterTransferfields;

      Description := MachineCenter.Name;
      "Setup Time" := MachineCenter."Setup Time";
      "Wait Time" := MachineCenter."Wait Time";
      "Move Time" := MachineCenter."Move Time";
      "Fixed Scrap Quantity" := MachineCenter."Fixed Scrap Quantity";
      "Scrap Factor %" := MachineCenter."Scrap %";
      "Minimum Process Time" := MachineCenter."Minimum Process Time";
      "Maximum Process Time" := MachineCenter."Maximum Process Time";
      "Concurrent Capacities" := MachineCenter."Concurrent Capacities";
      IF "Concurrent Capacities" = 0 THEN
        "Concurrent Capacities" := 1;
      "Send-Ahead Quantity" := MachineCenter."Send-Ahead Quantity";
      "Setup Time Unit of Meas. Code" := MachineCenter."Setup Time Unit of Meas. Code";
      "Wait Time Unit of Meas. Code" := MachineCenter."Wait Time Unit of Meas. Code";
      "Move Time Unit of Meas. Code" := MachineCenter."Move Time Unit of Meas. Code";
      "Flushing Method" := MachineCenter."Flushing Method";
      "Unit Cost per" := MachineCenter."Unit Cost";
      "Direct Unit Cost" := MachineCenter."Direct Unit Cost";
      "Indirect Cost %" := MachineCenter."Indirect Cost %";
      "Overhead Rate" := MachineCenter."Overhead Rate";
      FillDefaultLocationAndBins;
    END;

    PROCEDURE FillDefaultLocationAndBins@8();
    BEGIN
      GetLine;
      "Location Code" := ProdOrderLine."Location Code";
      CASE Type OF
        Type::"Work Center":
          BEGIN
            IF WorkCenter."No." <> "No." THEN
              WorkCenter.GET("No.");
            IF WorkCenter."Location Code" = "Location Code" THEN BEGIN
              "Open Shop Floor Bin Code" := WorkCenter."Open Shop Floor Bin Code";
              "To-Production Bin Code" := WorkCenter."To-Production Bin Code";
              "From-Production Bin Code" := WorkCenter."From-Production Bin Code";
            END;
          END;
        Type::"Machine Center":
          BEGIN
            IF MachineCenter."No." <> "No." THEN
              MachineCenter.GET("No.");
            IF MachineCenter."Location Code" = "Location Code" THEN BEGIN
              "Open Shop Floor Bin Code" := MachineCenter."Open Shop Floor Bin Code";
              "To-Production Bin Code" := MachineCenter."To-Production Bin Code";
              "From-Production Bin Code" := MachineCenter."From-Production Bin Code";
            END;
            IF WorkCenter."No." <> MachineCenter."Work Center No." THEN
              WorkCenter.GET(MachineCenter."Work Center No.");
            IF WorkCenter."Location Code" = "Location Code" THEN BEGIN
              IF "Open Shop Floor Bin Code" = '' THEN
                "Open Shop Floor Bin Code" := WorkCenter."Open Shop Floor Bin Code";
              IF "To-Production Bin Code" = '' THEN
                "To-Production Bin Code" := WorkCenter."To-Production Bin Code";
              IF "From-Production Bin Code" = '' THEN
                "From-Production Bin Code" := WorkCenter."From-Production Bin Code";
            END;
          END;
      END;
    END;

    LOCAL PROCEDURE CalcStartingEndingDates@17(Direction1@1000 : 'Forward,Backward');
    VAR
      ReservationCheckDateConfl@1001 : Codeunit 99000815;
    BEGIN
      IF "Routing Status" = "Routing Status"::Finished THEN
        FIELDERROR("Routing Status");

      MODIFY(TRUE);

      ProdOrderRtngLine.GET(Status,"Prod. Order No.","Routing Reference No.","Routing No.","Operation No.");

      ProdOrderRouteMgt.CalcSequenceFromActual(ProdOrderRtngLine,Direction1);
      ProdOrderRtngLine.GET(Status,"Prod. Order No.","Routing Reference No.","Routing No.","Operation No.");
      ProdOrderRtngLine.SETCURRENTKEY(
        Status,"Prod. Order No.","Routing Reference No.","Routing No.","Sequence No. (Actual)");
      CalcProdOrder.CalculateRoutingFromActual(ProdOrderRtngLine,Direction1,FALSE);

      CalculateRoutingBack;
      CalculateRoutingForward;

      GET(Status,"Prod. Order No.","Routing Reference No.","Routing No.","Operation No.");
      GetLine;
      ReservationCheckDateConfl.ProdOrderLineCheck(ProdOrderLine,TRUE);
    END;

    PROCEDURE SetRecalcStatus@5();
    BEGIN
      Recalculate := TRUE;
    END;

    PROCEDURE RunTimePer@7() : Decimal;
    BEGIN
      IF "Lot Size" = 0 THEN
        "Lot Size" := 1;

      EXIT("Run Time" / "Lot Size");
    END;

    LOCAL PROCEDURE CalculateRoutingBack@10();
    VAR
      ProdOrderLine@1000 : Record 5406;
      ProdOrderRtngLine@1001 : Record 5409;
    BEGIN
      IF "Previous Operation No." <> '' THEN BEGIN
        ProdOrderRtngLine.SETRANGE(Status,Status);
        ProdOrderRtngLine.SETRANGE("Prod. Order No.","Prod. Order No.");
        ProdOrderRtngLine.SETRANGE("Routing Reference No.","Routing Reference No.");
        ProdOrderRtngLine.SETRANGE("Routing No.","Routing No.");
        ProdOrderRtngLine.SETFILTER("Operation No.","Previous Operation No.");
        ProdOrderRtngLine.SETFILTER("Routing Status",'<>%1',ProdOrderRtngLine."Routing Status"::Finished);

        IF ProdOrderRtngLine.FIND('-') THEN
          REPEAT
            ProdOrderRtngLine.SETCURRENTKEY(Status,"Prod. Order No.","Routing Reference No.",
              "Routing No.","Sequence No. (Actual)");
            WorkCenter.GET(ProdOrderRtngLine."Work Center No.");
            CASE WorkCenter."Simulation Type" OF
              WorkCenter."Simulation Type"::Moves:
                BEGIN
                  ProdOrderRouteMgt.CalcSequenceFromActual(ProdOrderRtngLine,Direction::Backward);
                  CalcProdOrder.CalculateRoutingFromActual(ProdOrderRtngLine,Direction::Backward,TRUE);
                END;
              WorkCenter."Simulation Type"::"Moves When Necessary":
                IF (ProdOrderRtngLine."Ending Date" > "Starting Date") OR
                   ((ProdOrderRtngLine."Ending Date" = "Starting Date") AND
                    (ProdOrderRtngLine."Ending Time" > "Starting Time"))
                THEN BEGIN
                  ProdOrderRouteMgt.CalcSequenceFromActual(ProdOrderRtngLine,Direction::Backward);
                  CalcProdOrder.CalculateRoutingFromActual(ProdOrderRtngLine,Direction::Backward,TRUE);
                END;
              WorkCenter."Simulation Type"::Critical:
                BEGIN
                  IF (ProdOrderRtngLine."Ending Date" > "Starting Date") OR
                     ((ProdOrderRtngLine."Ending Date" = "Starting Date") AND
                      (ProdOrderRtngLine."Ending Time" > "Starting Time"))
                  THEN
                    ERROR(Text002);
                END;
            END;
            ProdOrderRtngLine.SETCURRENTKEY(Status,"Prod. Order No.","Routing Reference No.",
              "Routing No.","Operation No.");
          UNTIL ProdOrderRtngLine.NEXT = 0;
      END;

      ProdOrderLine.SETRANGE(Status,Status);
      ProdOrderLine.SETRANGE("Prod. Order No.","Prod. Order No.");
      ProdOrderLine.SETRANGE("Routing Reference No.","Routing Reference No.");
      ProdOrderLine.SETRANGE("Routing No.","Routing No.");
      IF ProdOrderLine.FIND('-') THEN
        REPEAT
          CalcProdOrder.CalculateProdOrderDates(ProdOrderLine,TRUE);
          AdjustComponents(ProdOrderLine);
        UNTIL ProdOrderLine.NEXT = 0;
    END;

    LOCAL PROCEDURE CalculateRoutingForward@9();
    VAR
      ProdOrderLine@1000 : Record 5406;
      ProdOrderRtngLine@1001 : Record 5409;
    BEGIN
      IF "Next Operation No." <> '' THEN BEGIN
        ProdOrderRtngLine.SETRANGE(Status,Status);
        ProdOrderRtngLine.SETRANGE("Prod. Order No.","Prod. Order No.");
        ProdOrderRtngLine.SETRANGE("Routing Reference No.","Routing Reference No.");
        ProdOrderRtngLine.SETRANGE("Routing No.","Routing No.");
        ProdOrderRtngLine.SETFILTER("Operation No.","Next Operation No.");
        ProdOrderRtngLine.SETFILTER("Routing Status",'<>%1',ProdOrderRtngLine."Routing Status"::Finished);

        IF ProdOrderRtngLine.FIND('-') THEN
          REPEAT
            ProdOrderRtngLine.SETCURRENTKEY(Status,"Prod. Order No.","Routing Reference No.",
              "Routing No.","Sequence No. (Actual)");
            WorkCenter.GET(ProdOrderRtngLine."Work Center No.");
            CASE WorkCenter."Simulation Type" OF
              WorkCenter."Simulation Type"::Moves:
                BEGIN
                  ProdOrderRouteMgt.CalcSequenceFromActual(ProdOrderRtngLine,Direction::Forward);
                  CalcProdOrder.CalculateRoutingFromActual(ProdOrderRtngLine,Direction::Forward,TRUE);
                END;
              WorkCenter."Simulation Type"::"Moves When Necessary":
                IF (ProdOrderRtngLine."Starting Date" < "Ending Date") OR
                   ((ProdOrderRtngLine."Starting Date" = "Ending Date") AND
                    (ProdOrderRtngLine."Starting Time" < "Ending Time"))
                THEN BEGIN
                  ProdOrderRouteMgt.CalcSequenceFromActual(ProdOrderRtngLine,Direction::Forward);
                  CalcProdOrder.CalculateRoutingFromActual(ProdOrderRtngLine,Direction::Forward,TRUE);
                END;
              WorkCenter."Simulation Type"::Critical:
                BEGIN
                  IF (ProdOrderRtngLine."Starting Date" < "Ending Date") OR
                     ((ProdOrderRtngLine."Starting Date" = "Ending Date") AND
                      (ProdOrderRtngLine."Starting Time" < "Ending Time"))
                  THEN
                    ERROR(Text003);
                END;
            END;
            ProdOrderRtngLine.SETCURRENTKEY(Status,"Prod. Order No.","Routing Reference No.",
              "Routing No.","Operation No.");
          UNTIL ProdOrderRtngLine.NEXT = 0;
      END;

      ProdOrderLine.SETRANGE(Status,Status);
      ProdOrderLine.SETRANGE("Prod. Order No.","Prod. Order No.");
      ProdOrderLine.SETRANGE("Routing Reference No.","Routing Reference No.");
      ProdOrderLine.SETRANGE("Routing No.","Routing No.");
      IF ProdOrderLine.FIND('-') THEN
        REPEAT
          CalcProdOrder.CalculateProdOrderDates(ProdOrderLine,TRUE);
          AdjustComponents(ProdOrderLine);
        UNTIL ProdOrderLine.NEXT = 0;
      CalcProdOrder.CalculateComponents;
    END;

    LOCAL PROCEDURE ModifyCapNeedEntries@13();
    BEGIN
      ProdOrderCapNeed.SETRANGE(Status,Status);
      ProdOrderCapNeed.SETRANGE("Prod. Order No.","Prod. Order No.");
      ProdOrderCapNeed.SETRANGE("Routing Reference No.","Routing Reference No.");
      ProdOrderCapNeed.SETRANGE("Routing No.","Routing No.");
      ProdOrderCapNeed.SETRANGE("Operation No.","Operation No.");
      ProdOrderCapNeed.SETRANGE("Requested Only",FALSE);
      IF ProdOrderCapNeed.FIND('-') THEN
        REPEAT
          ProdOrderCapNeed."No." := "No.";
          ProdOrderCapNeed."Work Center No." := "Work Center No.";
          ProdOrderCapNeed."Work Center Group Code" := "Work Center Group Code";
          ProdOrderCapNeed.MODIFY;
        UNTIL ProdOrderCapNeed.NEXT = 0;
    END;

    LOCAL PROCEDURE AdjustComponents@14(VAR ProdOrderLine@1000 : Record 5406);
    VAR
      ProdOrderComp@1001 : Record 5407;
    BEGIN
      ProdOrderComp.SETRANGE(Status,Status);
      ProdOrderComp.SETRANGE("Prod. Order No.","Prod. Order No.");
      ProdOrderComp.SETRANGE("Prod. Order Line No.",ProdOrderLine."Line No.");

      IF ProdOrderComp.FIND('-') THEN
        REPEAT
          ProdOrderComp.VALIDATE("Routing Link Code");
          ProdOrderComp.MODIFY;
        UNTIL ProdOrderComp.NEXT = 0;
    END;

    PROCEDURE UpdateDatetime@11();
    BEGIN
      IF ("Starting Date" <> 0D) AND ("Starting Time" <> 0T) THEN
        "Starting Date-Time" := CREATEDATETIME("Starting Date","Starting Time")
      ELSE
        "Starting Date-Time" := 0DT;

      IF ("Ending Date" <> 0D) AND ("Ending Time" <> 0T) THEN
        "Ending Date-Time" := CREATEDATETIME("Ending Date","Ending Time")
      ELSE
        "Ending Date-Time" := 0DT;
    END;

    PROCEDURE CheckPreviousAndNext@18();
    VAR
      ProdOrderRtngLine@1001 : Record 5409;
      TempDeletedProdOrderRtngLine@1002 : TEMPORARY Record 5409;
      TempRemainingProdOrderRtngLine@1003 : TEMPORARY Record 5409;
      ProdOrderRoutingForm@1006 : Page 99000817;
      ErrorOnNext@1004 : Boolean;
      ErrorOnPrevious@1005 : Boolean;
    BEGIN
      TempDeletedProdOrderRtngLine := Rec;
      TempDeletedProdOrderRtngLine.INSERT;

      ProdOrderRtngLine.SETRANGE(Status,Status);
      ProdOrderRtngLine.SETRANGE("Prod. Order No.","Prod. Order No.");
      ProdOrderRtngLine.SETRANGE("Routing Reference No.","Routing Reference No.");
      ProdOrderRtngLine.SETRANGE("Routing No.","Routing No.");
      ProdOrderRtngLine.SETFILTER("Operation No.",'<>%1',"Operation No.");
      ProdOrderRtngLine.SETFILTER("Routing Status",'<>%1',ProdOrderRtngLine."Routing Status"::Finished);

      IF ProdOrderRtngLine.FIND('-') THEN
        REPEAT
          IF ProdOrderRtngLine."Next Operation No." <> '' THEN BEGIN
            TempDeletedProdOrderRtngLine.SETFILTER("Operation No.",ProdOrderRtngLine."Next Operation No.");
            ErrorOnNext := TempDeletedProdOrderRtngLine.FINDFIRST;
          END ELSE
            ErrorOnNext := FALSE;

          IF ProdOrderRtngLine."Previous Operation No." <> '' THEN BEGIN
            TempDeletedProdOrderRtngLine.SETFILTER("Operation No.",ProdOrderRtngLine."Previous Operation No.");
            ErrorOnPrevious := TempDeletedProdOrderRtngLine.FINDFIRST;
          END ELSE
            ErrorOnPrevious := FALSE;

          IF ErrorOnNext OR ErrorOnPrevious THEN BEGIN
            TempRemainingProdOrderRtngLine := ProdOrderRtngLine;
            TempRemainingProdOrderRtngLine.INSERT;
          END
        UNTIL ProdOrderRtngLine.NEXT = 0;

      IF TempRemainingProdOrderRtngLine.FIND('-') THEN BEGIN
        COMMIT;
        IF NOT CONFIRM(
             STRSUBSTNO(Text004,FIELDCAPTION("Next Operation No."),FIELDCAPTION("Previous Operation No.")),
             TRUE)
        THEN
          EXIT;
        ProdOrderRoutingForm.Initialize(STRSUBSTNO(Text005,"Operation No."));
        REPEAT
          TempRemainingProdOrderRtngLine.MARK(TRUE);
        UNTIL TempRemainingProdOrderRtngLine.NEXT = 0;
        TempRemainingProdOrderRtngLine.MARKEDONLY(TRUE);
        ProdOrderRoutingForm.SETTABLEVIEW(TempRemainingProdOrderRtngLine);
        ProdOrderRoutingForm.RUNMODAL;
      END;
    END;

    PROCEDURE SetNextOperations@4(VAR RtngLine@1001 : Record 5409);
    VAR
      RtngLine2@1003 : Record 5409;
    BEGIN
      RtngLine2.SETRANGE(Status,RtngLine.Status);
      RtngLine2.SETRANGE("Prod. Order No.",RtngLine."Prod. Order No.");
      RtngLine2.SETRANGE("Routing Reference No.",RtngLine."Routing Reference No.");
      RtngLine2.SETRANGE("Routing No.",RtngLine."Routing No.");
      RtngLine2.SETFILTER("Operation No.",'>%1',RtngLine."Operation No.");

      IF RtngLine2.FINDFIRST THEN
        RtngLine."Next Operation No." := RtngLine2."Operation No."
      ELSE BEGIN
        RtngLine2.SETFILTER("Operation No.",'');
        RtngLine2.SETRANGE("Next Operation No.",'');
        IF RtngLine2.FINDFIRST THEN BEGIN
          RtngLine2."Next Operation No." := RtngLine."Operation No.";
          RtngLine2.MODIFY;
        END;
      END;
    END;

    LOCAL PROCEDURE SubcontractPurchOrderExist@6() : Boolean;
    BEGIN
      IF Status <> Status::Released THEN
        EXIT(FALSE);

      ProdOrderLine.RESET;
      ProdOrderLine.SETRANGE(Status,Status);
      ProdOrderLine.SETRANGE("Prod. Order No.","Prod. Order No.");
      ProdOrderLine.SETRANGE("Routing Reference No.","Routing Reference No.");
      ProdOrderLine.SETRANGE("Routing No.","Routing No.");
      IF ProdOrderLine.FIND('-') THEN
        REPEAT
          PurchLine.SETCURRENTKEY(
            "Document Type",Type,"Prod. Order No.","Prod. Order Line No.","Routing No.","Operation No.");
          PurchLine.SETRANGE("Document Type",PurchLine."Document Type"::Order);
          PurchLine.SETRANGE(Type,PurchLine.Type::Item);
          PurchLine.SETRANGE("Prod. Order No.","Prod. Order No.");
          PurchLine.SETRANGE("Prod. Order Line No.",ProdOrderLine."Line No.");
          PurchLine.SETRANGE("Operation No.","Operation No.");
          IF NOT PurchLine.ISEMPTY THEN
            EXIT(TRUE);
        UNTIL ProdOrderLine.NEXT = 0;

      EXIT(FALSE);
    END;

    PROCEDURE FindFCSOrder@1080001() FCSOrder : BigInteger;
    VAR
      ProdOrderRtngLineNext@1080000 : Record 5409;
      ProdOrderRtngLinePrevious@1080001 : Record 5409;
      OrdenFCSNext@1080002 : BigInteger;
      OrdenFCSPrevious@1080003 : BigInteger;
      Fin@1080004 : Boolean;
    BEGIN

      OrdenFCSNext:=0;
      OrdenFCSPrevious:=0;
      ProdOrderRtngLineNext.COPY(Rec);
      ProdOrderRtngLineNext.SETRANGE(Status,Status);
      ProdOrderRtngLineNext.SETRANGE("Prod. Order No.","Prod. Order No.");
      ProdOrderRtngLineNext.SETRANGE("Routing Reference No.","Routing Reference No.");
      ProdOrderRtngLineNext.SETRANGE("Routing No.","Routing No.");
      ProdOrderRtngLinePrevious.COPY(ProdOrderRtngLineNext);
      IF ProdOrderRtngLineNext.NEXT<>0 THEN BEGIN
        OrdenFCSNext:=ProdOrderRtngLineNext."Orden FCS";
        IF OrdenFCSNext=0 THEN BEGIN
          Fin:=FALSE;
          REPEAT
            IF ProdOrderRtngLineNext."Orden FCS"<>0 THEN BEGIN
              OrdenFCSNext:=ProdOrderRtngLineNext."Orden FCS";
              Fin:=TRUE
            END;
          UNTIL (ProdOrderRtngLineNext.NEXT=0) OR Fin
        END
      END;
      IF ProdOrderRtngLinePrevious.NEXT(-1)<>0 THEN OrdenFCSPrevious:=ProdOrderRtngLinePrevious."Orden FCS";
      IF (OrdenFCSPrevious<>0) AND (OrdenFCSNext<>0) THEN
        FCSOrder:=ROUND((OrdenFCSPrevious+OrdenFCSNext)/2,1)
      ELSE
        IF (OrdenFCSPrevious=0) AND (OrdenFCSNext=0) THEN FCSOrder:=0
        ELSE
          IF OrdenFCSPrevious<>0 THEN FCSOrder:=OrdenFCSPrevious+10
          ELSE FCSOrder:=OrdenFCSNext-10
    END;

    PROCEDURE UpdateComponentsBin@16(FromTrigger@1000 : 'Insert,Modify,Delete');
    VAR
      TempProdOrderRtngLine@1001 : TEMPORARY Record 5409;
    BEGIN
      IF SkipUpdateOfCompBinCodes THEN
        EXIT;

      IF NOT UpdateOfComponentsBinRequired(FromTrigger) THEN
        EXIT;

      PopulateNewRoutingLineSet(TempProdOrderRtngLine,FromTrigger);
      ProdOrderRouteMgt.UpdateComponentsBin(TempProdOrderRtngLine,FALSE);
    END;

    LOCAL PROCEDURE UpdateOfComponentsBinRequired@19(FromTrigger@1000 : 'Insert,Modify,Delete') : Boolean;
    BEGIN
      IF ("No." = '') AND (xRec."No." = "No.") THEN // bin codes are and were empty
        EXIT(FALSE);

      CASE FromTrigger OF
        FromTrigger::Insert,FromTrigger::Delete:
          EXIT(("Previous Operation No." = '') OR ("Routing Link Code" <> ''));
        FromTrigger::Modify:
          EXIT(
            ((xRec."Previous Operation No." = '') AND ("Previous Operation No." <> '')) OR
            ((xRec."Previous Operation No." <> '') AND ("Previous Operation No." = '')) OR
            (xRec."Routing Link Code" <> "Routing Link Code") OR
            ((("Previous Operation No." = '') OR ("Routing Link Code" <> '')) AND
             ((xRec."To-Production Bin Code" <> "To-Production Bin Code") OR
              (xRec."Open Shop Floor Bin Code" <> "Open Shop Floor Bin Code"))));
      END;
    END;

    LOCAL PROCEDURE PopulateNewRoutingLineSet@20(VAR ProdOrderRtngLineTmp@1000 : Record 5409;FromTrigger@1001 : 'Insert,Modify,Delete');
    VAR
      ProdOrderRtngLine2@1002 : Record 5409;
    BEGIN
      // copy existing routings for this prod. order to temporary table
      ProdOrderRtngLineTmp.DELETEALL;
      ProdOrderRtngLine2.SETCURRENTKEY(Status,"Prod. Order No.","Routing Reference No.","Routing No.","Operation No.");
      ProdOrderRtngLine2.SETRANGE(Status,Status);
      ProdOrderRtngLine2.SETRANGE("Prod. Order No.","Prod. Order No.");
      ProdOrderRtngLine2.SETRANGE("Routing Reference No.","Routing Reference No.");
      ProdOrderRtngLine2.SETRANGE("Routing No.","Routing No.");
      IF ProdOrderRtngLine2.FINDSET(FALSE) THEN
        REPEAT
          ProdOrderRtngLineTmp := ProdOrderRtngLine2;
          ProdOrderRtngLineTmp.INSERT;
        UNTIL ProdOrderRtngLine2.NEXT = 0;

      // update the recordset with the current change
      ProdOrderRtngLineTmp := Rec;
      CASE FromTrigger OF
        FromTrigger::Insert:
          ProdOrderRtngLineTmp.INSERT;
        FromTrigger::Modify:
          ProdOrderRtngLineTmp.MODIFY;
        FromTrigger::Delete:
          ProdOrderRtngLineTmp.DELETE;
      END;
    END;

    PROCEDURE SetSkipUpdateOfCompBinCodes@21(Setting@1000 : Boolean);
    BEGIN
      SkipUpdateOfCompBinCodes := Setting;
    END;

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 12.11.07 HHE Fjernet sjekk p† OnDelete. Sjekker kun p† om det er bokf›rt Avgangsantall
      02. 16.09.09 HHE FCS Ny key:Work Center Group Code,Routing Status,Status,Setup Time Unit of Meas. Code,
                       Run Time Unit of Meas. Code,Move Time Unit of Meas. Code
                       Ny funksjon: FindFCSOrder (med tilh›rende variabler og kode)
      03. 16.09.09 HHE Ny n›kkel for † kunne analysere bruk av ikke-numeriske operasjonsnr. (FCS t†ler ikke dette)
      04. 22.09.09 HHE Ny n›kkel: Work Center Group Code,Status,No.  (til FCS)


      +-------------------------------------------------+
      | OPC                                             |
      +-------------------------------------------------+
      OPC1.0     16.11.09 HHE Opprettet felt "83300, 83301, 83302".
    }
    END.
  }
}

OBJECT Table 5832 Capacity Ledger Entry
{
  OBJECT-PROPERTIES
  {
    Date=28.09.17;
    Time=11:36:31;
    Modified=Yes;
    Version List=NAVW110.00,INC1.10,OPC6.01;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Capacity Ledger Entry;
               NOR=Kapasitetspost];
    LookupPageID=Page5832;
    DrillDownPageID=Page5832;
  }
  FIELDS
  {
    { 1   ;   ;Entry No.           ;Integer       ;CaptionML=[ENU=Entry No.;
                                                              NOR=L›penr.] }
    { 2   ;   ;No.                 ;Code20        ;TableRelation=IF (Type=CONST(Machine Center)) "Machine Center"
                                                                 ELSE IF (Type=CONST(Work Center)) "Work Center"
                                                                 ELSE IF (Type=CONST(Resource)) Resource;
                                                   CaptionML=[ENU=No.;
                                                              NOR=Nr.] }
    { 3   ;   ;Posting Date        ;Date          ;CaptionML=[ENU=Posting Date;
                                                              NOR=Bokf›ringsdato] }
    { 4   ;   ;Type                ;Option        ;CaptionML=[ENU=Type;
                                                              NOR=Type];
                                                   OptionCaptionML=[ENU=Work Center,Machine Center, ,Resource;
                                                                    NOR=Arbeidssenter,Maskinsenter, ,Ressurs];
                                                   OptionString=Work Center,Machine Center, ,Resource }
    { 6   ;   ;Document No.        ;Code20        ;CaptionML=[ENU=Document No.;
                                                              NOR=Bilagsnr.] }
    { 7   ;   ;Description         ;Text50        ;CaptionML=[ENU=Description;
                                                              NOR=Beskrivelse] }
    { 8   ;   ;Operation No.       ;Code10        ;CaptionML=[ENU=Operation No.;
                                                              NOR=Operasjonsnr.] }
    { 9   ;   ;Work Center No.     ;Code20        ;TableRelation="Work Center";
                                                   CaptionML=[ENU=Work Center No.;
                                                              NOR=Arbeidssenternr.] }
    { 10  ;   ;Quantity            ;Decimal       ;CaptionML=[ENU=Quantity;
                                                              NOR=Antall];
                                                   DecimalPlaces=0:5 }
    { 11  ;   ;Setup Time          ;Decimal       ;CaptionML=[ENU=Setup Time;
                                                              NOR=Oppstillingstid];
                                                   DecimalPlaces=0:5 }
    { 12  ;   ;Run Time            ;Decimal       ;CaptionML=[ENU=Run Time;
                                                              NOR=Operasjonstid];
                                                   DecimalPlaces=0:5 }
    { 13  ;   ;Stop Time           ;Decimal       ;CaptionML=[ENU=Stop Time;
                                                              NOR=Stopptid];
                                                   DecimalPlaces=0:5 }
    { 15  ;   ;Invoiced Quantity   ;Decimal       ;CaptionML=[ENU=Invoiced Quantity;
                                                              NOR=Fakturert antall];
                                                   DecimalPlaces=0:5 }
    { 16  ;   ;Output Quantity     ;Decimal       ;CaptionML=[ENU=Output Quantity;
                                                              NOR=Avgangsantall];
                                                   DecimalPlaces=0:5 }
    { 17  ;   ;Scrap Quantity      ;Decimal       ;CaptionML=[ENU=Scrap Quantity;
                                                              NOR=Vrakantall];
                                                   DecimalPlaces=0:5 }
    { 19  ;   ;Concurrent Capacity ;Decimal       ;CaptionML=[ENU=Concurrent Capacity;
                                                              NOR=Samtidig kapasitet] }
    { 28  ;   ;Cap. Unit of Measure Code;Code10   ;TableRelation="Capacity Unit of Measure";
                                                   CaptionML=[ENU=Cap. Unit of Measure Code;
                                                              NOR=Kapasitetsenhetskode] }
    { 29  ;   ;Qty. per Cap. Unit of Measure;Decimal;
                                                   CaptionML=[ENU=Qty. per Cap. Unit of Measure;
                                                              NOR=Ant. per kapasitetsenhet];
                                                   DecimalPlaces=0:5 }
    { 33  ;   ;Global Dimension 1 Code;Code20     ;TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(1));
                                                   CaptionML=[ENU=Global Dimension 1 Code;
                                                              NOR=Global dimensjon 1 - kode];
                                                   CaptionClass='1,1,1' }
    { 34  ;   ;Global Dimension 2 Code;Code20     ;TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(2));
                                                   CaptionML=[ENU=Global Dimension 2 Code;
                                                              NOR=Global dimensjon 2 - kode];
                                                   CaptionClass='1,1,2' }
    { 39  ;   ;Last Output Line    ;Boolean       ;CaptionML=[ENU=Last Output Line;
                                                              NOR=Siste avganglinje] }
    { 42  ;   ;Completely Invoiced ;Boolean       ;CaptionML=[ENU=Completely Invoiced;
                                                              NOR=Fullstendig fakturert] }
    { 43  ;   ;Starting Time       ;Time          ;CaptionML=[ENU=Starting Time;
                                                              NOR=Starttidspunkt] }
    { 44  ;   ;Ending Time         ;Time          ;CaptionML=[ENU=Ending Time;
                                                              NOR=Sluttidspunkt] }
    { 52  ;   ;Routing No.         ;Code20        ;TableRelation="Routing Header";
                                                   CaptionML=[ENU=Routing No.;
                                                              NOR=Rutenr.] }
    { 53  ;   ;Routing Reference No.;Integer      ;CaptionML=[ENU=Routing Reference No.;
                                                              NOR=Rutereferansenr.] }
    { 56  ;   ;Item No.            ;Code20        ;TableRelation=Item;
                                                   CaptionML=[ENU=Item No.;
                                                              NOR=Varenr.] }
    { 57  ;   ;Variant Code        ;Code10        ;TableRelation="Item Variant".Code WHERE (Item No.=FIELD(Item No.));
                                                   CaptionML=[ENU=Variant Code;
                                                              NOR=Variantkode] }
    { 58  ;   ;Unit of Measure Code;Code10        ;TableRelation="Item Unit of Measure".Code WHERE (Item No.=FIELD(Item No.));
                                                   CaptionML=[ENU=Unit of Measure Code;
                                                              NOR=Enhetskode] }
    { 59  ;   ;Qty. per Unit of Measure;Decimal   ;CaptionML=[ENU=Qty. per Unit of Measure;
                                                              NOR=Antall per enhet];
                                                   DecimalPlaces=0:5 }
    { 60  ;   ;Document Date       ;Date          ;CaptionML=[ENU=Document Date;
                                                              NOR=Bilagsdato] }
    { 61  ;   ;External Document No.;Code35       ;CaptionML=[ENU=External Document No.;
                                                              NOR=Eksterndokumentnr.] }
    { 65  ;   ;Stop Code           ;Code20        ;TableRelation=Stop;
                                                   CaptionML=[ENU=Stop Code;
                                                              NOR=Stoppkode];
                                                   Description=opc: fra 10 tegn }
    { 66  ;   ;Scrap Code          ;Code20        ;TableRelation=Scrap;
                                                   CaptionML=[ENU=Scrap Code;
                                                              NOR=Vrakkode];
                                                   Description=opc: fra 10 tegn }
    { 68  ;   ;Work Center Group Code;Code10      ;TableRelation="Work Center Group";
                                                   CaptionML=[ENU=Work Center Group Code;
                                                              NOR=Arbeidssentergruppekode] }
    { 69  ;   ;Work Shift Code     ;Code10        ;TableRelation="Work Shift";
                                                   CaptionML=[ENU=Work Shift Code;
                                                              NOR=Arbeidsskiftkode] }
    { 71  ;   ;Direct Cost         ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Value Entry"."Cost Amount (Actual)" WHERE (Capacity Ledger Entry No.=FIELD(Entry No.),
                                                                                                               Entry Type=CONST(Direct Cost)));
                                                   CaptionML=[ENU=Direct Cost;
                                                              NOR=Kj›pspris/prod.kost];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 72  ;   ;Overhead Cost       ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Value Entry"."Cost Amount (Actual)" WHERE (Capacity Ledger Entry No.=FIELD(Entry No.),
                                                                                                               Entry Type=CONST(Indirect Cost)));
                                                   CaptionML=[ENU=Overhead Cost;
                                                              NOR=Sats for indirekte kostnad];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 76  ;   ;Direct Cost (ACY)   ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Value Entry"."Cost Amount (Actual) (ACY)" WHERE (Capacity Ledger Entry No.=FIELD(Entry No.),
                                                                                                                     Entry Type=CONST(Direct Cost)));
                                                   CaptionML=[ENU=Direct Cost (ACY);
                                                              NOR=Kj›pspris/prod.kost (t.val)];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr=GetCurrencyCode }
    { 77  ;   ;Overhead Cost (ACY) ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Value Entry"."Cost Amount (Actual) (ACY)" WHERE (Capacity Ledger Entry No.=FIELD(Entry No.),
                                                                                                                     Entry Type=CONST(Indirect Cost)));
                                                   CaptionML=[ENU=Overhead Cost (ACY);
                                                              NOR=Sats for indir. kostn. (t.val)];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr=GetCurrencyCode }
    { 78  ;   ;Subcontracting      ;Boolean       ;CaptionML=[ENU=Subcontracting;
                                                              NOR=Underleveranse] }
    { 90  ;   ;Order Type          ;Option        ;CaptionML=[ENU=Order Type;
                                                              NOR=Ordretype];
                                                   OptionCaptionML=[ENU=" ,Production,Transfer,Service,Assembly";
                                                                    NOR=" ,Produksjon,Overf›ring,Service,Montering"];
                                                   OptionString=[ ,Production,Transfer,Service,Assembly];
                                                   Editable=No }
    { 91  ;   ;Order No.           ;Code20        ;TableRelation=IF (Order Type=CONST(Production)) "Production Order".No. WHERE (Status=FILTER(Released..));
                                                   CaptionML=[ENU=Order No.;
                                                              NOR=Ordrenr.];
                                                   Editable=No }
    { 92  ;   ;Order Line No.      ;Integer       ;TableRelation=IF (Order Type=CONST(Production)) "Prod. Order Line"."Line No." WHERE (Status=FILTER(Released..),
                                                                                                                                        Prod. Order No.=FIELD(Order No.));
                                                   CaptionML=[ENU=Order Line No.;
                                                              NOR=Ordrelinjenr.];
                                                   Editable=No }
    { 480 ;   ;Dimension Set ID    ;Integer       ;TableRelation="Dimension Set Entry";
                                                   OnLookup=BEGIN
                                                              ShowDimensions;
                                                            END;

                                                   CaptionML=[ENU=Dimension Set ID;
                                                              NOR=Dimensjonssett-ID];
                                                   Editable=No }
    { 50050;  ;Employee no.        ;Code10        ;CaptionML=[ENU=Employee no.;
                                                              NOR=Ansatt nr] }
    { 50051;  ;Print               ;Boolean        }
    { 83001;  ;Scrap Comment       ;Text50         }
  }
  KEYS
  {
    {    ;Entry No.                               ;Clustered=Yes }
    {    ;Document No.,Posting Date                }
    {    ;Order Type,Order No.,Order Line No.,Routing No.,Routing Reference No.,Operation No.,Last Output Line;
                                                   SumIndexFields=Quantity,Output Quantity;
                                                   MaintainSIFTIndex=No }
    {    ;Work Center No.,Work Shift Code,Posting Date }
    {    ;Type,No.,Work Shift Code,Item No.,Posting Date }
    {    ;Document No.,Stop Code,No.,Posting Date  }
  }
  FIELDGROUPS
  {
    { 1   ;DropDown            ;Entry No.,Description,Type,No.,Posting Date,Document No. }
  }
  CODE
  {
    VAR
      GLSetup@1000 : Record 98;
      GLSetupRead@1001 : Boolean;

    LOCAL PROCEDURE GetCurrencyCode@4() : Code[10];
    BEGIN
      IF GLSetupRead THEN BEGIN
        GLSetup.GET;
        GLSetupRead := TRUE;
      END;
      EXIT(GLSetup."Additional Reporting Currency");
    END;

    PROCEDURE ShowDimensions@1();
    VAR
      DimMgt@1000 : Codeunit 408;
    BEGIN
      DimMgt.ShowDimensionSet("Dimension Set ID",STRSUBSTNO('%1 %2',TABLECAPTION,"Entry No."));
    END;

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 17.11.03 ASL Lagt til felt Ansatt nr kommer fra Kronos integrasjon.
      02. 30.06.05 HHE Ny key: Ansattnr.
      03. 08.08.05 ASL Ny Key: "Prod. Order No.","Posting Date" Summering p† Quantity og "Output Quantity"
      04. 07.12.05 ASL Nytt felt Print, brukes til † skrive ut kvitteringsliste over bokf›rt forbruk.
      05. 08.12.05 HHE Ny key:Prod. Order No.,Posting Date,Subcontracting
      06. 16.09.09 HHE FCS Ny key: Operation No.,Routing No.,Routing Reference No.,Prod. Order No.  SumIndex:Setup time,Run time

      +--------------------------------------------+
      | OPC                                        |
      +--------------------------------------------+

      07. 16.11.09  HHE Utvidet feltet "Scrap Code" og "Stop Code" 10->20 tegn
                        Nye felt 50000Posting timeTime,50001CommentBoolean,50005Scrap CommentText
                        Nye keys: Prod. Order No.,Operation No.,No.  med SumIndexFields:  Output Quantity
                                      No.,Operation No.,Prod. Order No.                    :  Run Time
                                      Scrap Code,Item No.                                  :  (ingen)
                                      Prod. Order No.,Prod. Order Line No.,Work Center No. : Quantity
      08. 17.12.09 HHE       Ny n›kkel: ""Bilagsnr.", Stoppkode, "bokf›ringsdato",
      09. 21.01.10 BVM       Invoiced Quantity inn som sumIndexfield
      10. 24.03.10 HHE       Ny N›kkel: "Document No.,Stop Code,No.,Posting Date" (brukes i Mette sin rapport)
                            Sum av tid pr. Ind.tid.kode, sum pr. ansatt
    }
    END.
  }
}

OBJECT Table 83001 OPC Setup
{
  OBJECT-PROPERTIES
  {
    Date=27.09.17;
    Time=16:17:00;
    Modified=Yes;
    Version List=OPC6.07;
  }
  PROPERTIES
  {
    CaptionML=[ENU=OPC Setup;
               NOR=OPC Oppsett];
  }
  FIELDS
  {
    { 1   ;   ;Primary Key         ;Code10        ;CaptionML=[ENU=Primary Key;
                                                              NOR=Prim‘r n›kkel] }
    { 10  ;   ;Output Jnl. Templ. Name Qty;Code10 ;TableRelation="Item Journal Template".Name WHERE (Type=CONST(Output));
                                                   CaptionML=[ENU=Output Jnl. Template Name Qty;
                                                              NOR=Ferdigmeld.kladd mal - antall] }
    { 20  ;   ;Output Jnl. Batch Name Qty;Code10  ;TableRelation="Item Journal Batch".Name WHERE (Journal Template Name=FIELD(Output Jnl. Templ. Name Qty),
                                                                                                  Template Type=CONST(Output));
                                                   CaptionML=[ENU=Output Jrn Batch Name Qty;
                                                              NOR=Ferdigmeld.kladdnavn - antall] }
    { 30  ;   ;Output Jnl. Templ. Name Time;Code10;TableRelation="Item Journal Template".Name WHERE (Type=CONST(Output));
                                                   CaptionML=[ENU=Output Jnl. Templ. Name Time;
                                                              NOR=Ferdigmeld.kladd mal - tid] }
    { 40  ;   ;Output Jnl. Batch Name Time;Code10 ;TableRelation="Item Journal Batch".Name WHERE (Journal Template Name=FIELD(Output Jnl. Templ. Name Time),
                                                                                                  Template Type=CONST(Output));
                                                   CaptionML=[ENU=Output Jnl. Batch Name Time;
                                                              NOR=Ferdigmeld.kladdnavn - tid] }
    { 50  ;   ;Output Jnl. Templ. Name Corr;Code10;TableRelation="Item Journal Template".Name WHERE (Type=CONST(Output));
                                                   CaptionML=[ENU=Output Jnl. Templ. Name Correction;
                                                              NOR=Ferdigmeld.kladd mal korreksjon] }
    { 60  ;   ;Output Jnl. Batch Name Corr;Code10 ;TableRelation="Item Journal Batch".Name WHERE (Journal Template Name=FIELD(Output Jnl. Templ. Name Corr),
                                                                                                  Template Type=CONST(Output));
                                                   CaptionML=[ENU=Output Jnl. Batch Name Correction;
                                                              NOR=Ferdigmeld.kladdnavn korreksjon] }
    { 100 ;   ;Document No. Ind.Time;Code10       ;CaptionML=[ENU=Document No. Ind.Time;
                                                              NOR=Bilagsnr. Ind.Tid] }
    { 200 ;   ;Item Reclass. Jnl Templ. Name;Code10;
                                                   TableRelation="Item Journal Template".Name WHERE (Type=CONST(Revaluation));
                                                   CaptionML=[ENU=Item Reclass. Jnl. Name;
                                                              NOR=Vareoverf›ringskladd mal (flytting)] }
    { 201 ;   ;Item Reclass. Jnl.Batch  Name;Code10;
                                                   TableRelation="Item Journal Batch".Name WHERE (Journal Template Name=FIELD(Item Reclass. Jnl Templ. Name),
                                                                                                  Template Type=CONST(Revaluation));
                                                   CaptionML=NOR=Vareoverf›ringskladdnavn }
    { 202 ;   ;OPC-Move Location Code;Code10      ;TableRelation=Location.Code;
                                                   CaptionML=NOR="OPC Flytt fra Lokasjonskode " }
    { 300 ;   ;Warning Picture     ;BLOB          ;CaptionML=[ENU=Warning Picture;
                                                              NOR=Advarsler bilde];
                                                   SubType=Bitmap }
    { 400 ;   ;Item Journal Template Name;Code10  ;TableRelation="Item Journal Template".Name WHERE (Type=CONST(Item));
                                                   CaptionML=[ENU=Item Journal Template Name;
                                                              NOR=Varekladdemalnavn] }
    { 410 ;   ;Item Journal Batch Name;Code10     ;TableRelation="Item Journal Batch".Name WHERE (Journal Template Name=FIELD(Item Journal Template Name),
                                                                                                  Template Type=CONST(Item));
                                                   CaptionML=[ENU=Item Journal Batch Name;
                                                              NOR=Varekladdenavn] }
    { 420 ;   ;Cap. Jnl. Templ. Name Corr;Code10  ;TableRelation="Item Journal Template".Name WHERE (Type=CONST(Capacity));
                                                   CaptionML=[ENU=Cap. Jnl. Templ. Name Corr;
                                                              NOR=Kapasitetskladd korreksjon] }
    { 430 ;   ;Cap. Jnl. Batch Name Corr;Code10   ;TableRelation="Item Journal Batch".Name WHERE (Journal Template Name=FIELD(Cap. Jnl. Templ. Name Corr),
                                                                                                  Template Type=CONST(Capacity));
                                                   CaptionML=[ENU=Cap. Jnl. Batch Name Corr;
                                                              NOR=Kapasitetskladd mal korreksjon] }
    { 440 ;   ;Cap. Jnl. Templ. Name Indirect;Code10;
                                                   TableRelation="Item Journal Template".Name WHERE (Type=CONST(Capacity));
                                                   CaptionML=[ENU=Cap. Jnl. Templ. Name Indirect Time;
                                                              NOR=Kapasitetskladd  - Indirekte tid] }
    { 450 ;   ;Cap. Jnl. Batch Name Indirect;Code10;
                                                   TableRelation="Item Journal Batch".Name WHERE (Journal Template Name=FIELD(Cap. Jnl. Templ. Name Indirect),
                                                                                                  Template Type=CONST(Capacity));
                                                   CaptionML=[ENU=Cap. Jnl. Batch Name Indirect Time;
                                                              NOR=Kapasitetskladd mal - Indirekte tid] }
    { 600 ;   ;Work Center Prod time;Code10       ;TableRelation="Work Center".No.;
                                                   CaptionML=[ENU=Macine. cent. Production;
                                                              NOR=Arb. senter. Prod] }
    { 610 ;   ;Work Center Adm. time;Code10       ;TableRelation="Work Center".No.;
                                                   CaptionML=[ENU=Macine. cent. Administration;
                                                              NOR=Arb. senter. Adm.] }
    { 800 ;   ;Auto Insert Machine Center;Boolean ;InitValue=Yes;
                                                   CaptionML=[ENU=Auto Insert Machine Center Line;
                                                              NOR=Insert maskinensenterlinje automatisk] }
  }
  KEYS
  {
    {    ;Primary Key                             ;Clustered=Yes }
  }
  FIELDGROUPS
  {
    { 1   ;Brick               ;Primary Key,Field301                     }
  }
  CODE
  {

    PROCEDURE CheckOutputJnlTimeSetup@1101103000();
    BEGIN
      Rec.TESTFIELD("Output Jnl. Templ. Name Time");
      Rec.TESTFIELD("Output Jnl. Batch Name Time");
    END;

    PROCEDURE CheckOutputJnlQtySetup@1101103001();
    BEGIN
      Rec.TESTFIELD("Output Jnl. Templ. Name Qty");
      Rec.TESTFIELD("Output Jnl. Batch Name Qty");
    END;

    PROCEDURE CheckCapacityJnlSetup@1101103002();
    BEGIN
      Rec.TESTFIELD("Cap. Jnl. Templ. Name Indirect");
      Rec.TESTFIELD("Cap. Jnl. Batch Name Indirect");
    END;

    PROCEDURE CheckCapacityCorrectionJnlSetup@1101103003();
    BEGIN
      Rec.TESTFIELD("Cap. Jnl. Templ. Name Corr");
      Rec.TESTFIELD("Cap. Jnl. Batch Name Corr");
    END;

    PROCEDURE CheckOutputCorrectionJnlSetup@1101103004();
    BEGIN
      Rec.TESTFIELD("Output Jnl. Templ. Name Corr");
      Rec.TESTFIELD("Output Jnl. Batch Name Corr");
    END;

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 06.12.05 ASL Tabell oppgrader 4.0SP1
      02. 29.03.06 ASL Lagt til felt Document No. Ind.Time, brukes til tidsbokf›ring
                       uten tilknyttning til Prod.Ordre.
      03. 22.01.10 BVM Nye (1000 og 1001) felt for kladdenavn ved korreksjon fra OPC kapasitetepost korreksjon
      04. 22.03.10 HHE Nye felt: "Cap. Journal Batch Name OPC" og "Cap. Journal Name OPC"
                       Disse feltene brukes n†r man m›nstrer-ut og skal bokf›re Indirekte tid.
      05. 17.08.10 HHE Nytt felt:"Item Reclass. Journal (templ.)" (brukes i OPC - flytt komponent)
                       Nytt felt:"Item Reclass. Journal (Name)"   (brukes i OPC - flytt komponent)
      06. 19.08.10 HHE Nytt felt "OPC-Move Location Code". Brukes i OPC-flytt som "Fra lokasjon"
      07. 15.08.17 JAL New field for Warning icon
    }
    END.
  }
}

OBJECT Table 83002 OPC Information Message
{
  OBJECT-PROPERTIES
  {
    Date=20.09.17;
    Time=15:17:18;
    Modified=Yes;
    Version List=OPC6.03;
  }
  PROPERTIES
  {
    CaptionML=[ENU=OPC Information Message;
               NOR=OPC Oppslagstavle];
  }
  FIELDS
  {
    { 1   ;   ;Entry No.           ;Integer       ;CaptionML=[ENU=Entry No.;
                                                              NOR=L›penr.] }
    { 10  ;   ;Description         ;Text250       ;Width=250;
                                                   CaptionML=[ENU=Description;
                                                              NOR=Beskrivelse] }
    { 20  ;   ;Last Modified       ;DateTime      ;CaptionML=[ENU=Last Modified;
                                                              NOR=Sist oppdatert] }
  }
  KEYS
  {
    {    ;Entry No.                               ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    PROCEDURE GetNextEntryNo@1101103001() : Integer;
    VAR
      OPCInformationMessageL@1101103000 : Record 83002;
    BEGIN
      IF OPCInformationMessageL.FINDLAST THEN BEGIN
        IF OPCInformationMessageL."Entry No." = 0 THEN
          EXIT(1);
        EXIT((OPCInformationMessageL."Entry No." + 1));
      END
      ELSE
        EXIT(1);
    END;

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. mar06    HHE   Opprettet tabell (tekstlinjer 1-10)
      02. 15.12.06 HHE   Opprettet Tekstlinje 11-15 (›nske fra Odd)
      03. 15.08.17 JAL Merged to NAV 2017
    }
    END.
  }
}

OBJECT Table 83007 OPC Time Register
{
  OBJECT-PROPERTIES
  {
    Date=03.10.17;
    Time=12:29:41;
    Modified=Yes;
    Version List=OPC6.02;
  }
  PROPERTIES
  {
    OnInsert=BEGIN
               CheckTimeRegister();
             END;

    OnModify=BEGIN
               CheckStatus()
             END;

    OnDelete=BEGIN
               CheckStatus()
             END;

    OnRename=BEGIN
               CheckStatus()
             END;

    CaptionML=[ENU=OPC Time Register;
               NOR=OPC M›nstringstider];
    LookupPageID=Page83017;
    DrillDownPageID=Page83017;
  }
  FIELDS
  {
    { 1   ;   ;Machine Center      ;Code20        ;TableRelation="Machine Center";
                                                   CaptionML=[ENU=Machine Center;
                                                              NOR=Produksjonsressurs];
                                                   NotBlank=Yes }
    { 2   ;   ;Start Date          ;Date          ;OnValidate=BEGIN
                                                                CalcQty;
                                                              END;

                                                   CaptionML=[ENU=Start Date;
                                                              NOR=Startdato] }
    { 3   ;   ;Start Time          ;Time          ;OnValidate=BEGIN
                                                                CalcQty;
                                                              END;

                                                   CaptionML=[ENU=Start Time;
                                                              NOR=Starttid] }
    { 5   ;   ;End Date            ;Date          ;OnValidate=BEGIN
                                                                CalcQty;
                                                              END;

                                                   CaptionML=[ENU=End Date;
                                                              NOR=Sluttdato] }
    { 6   ;   ;End Time            ;Time          ;OnValidate=BEGIN
                                                                CalcQty;
                                                              END;

                                                   CaptionML=[ENU=End Time;
                                                              NOR=Sluttid] }
    { 7   ;   ;Quantity            ;Decimal       ;CaptionML=[ENU=Quantity;
                                                              NOR=Antall];
                                                   BlankZero=Yes;
                                                   Editable=No }
    { 11  ;   ;Time Type           ;Option        ;CaptionML=NOR=Tidstype;
                                                   OptionCaptionML=NOR=Dagtid,Overtid 50%,Overtid 100%;
                                                   OptionString=Daytime,Overtime 50%,Overtime 100%;
                                                   Editable=No }
    { 12  ;   ;Machine Center Name ;Text30        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Machine Center".Name WHERE (No.=FIELD(Machine Center)));
                                                   CaptionML=[ENU=Machine Center Name;
                                                              NOR=Produksjonsressursnavn];
                                                   Editable=No }
    { 13  ;   ;Absence             ;Boolean       ;CaptionML=[ENU=Absence;
                                                              NOR=Frav‘r] }
    { 14  ;   ;Date exported to Tempus;Date        }
    { 15  ;   ;Actual Start Time   ;Time          ;CaptionML=NOR=Faktisk starttid }
    { 20  ;   ;Starting day        ;Text10        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Date."Period Name" WHERE (Period Type=CONST(Date),
                                                                                                Period Start=FIELD(Start Date)));
                                                   CaptionML=NOR=Ukedag (start);
                                                   Editable=No }
    { 30  ;   ;Description         ;Text50        ;CaptionML=NOR=Beskrivelse }
    { 31  ;   ;Deduction Type      ;Option        ;CaptionML=[ENU=Deduction Type;
                                                              NOR=Type fratrekk];
                                                   OptionCaptionML=[ENU=,Lunch,Dinner,Other;
                                                                    NOR=" ,Lunch,Middag,Annet"];
                                                   OptionString=[ ,Lunch,Dinner,Other];
                                                   Description=03. BVM }
  }
  KEYS
  {
    {    ;Machine Center,Start Date,Start Time    ;Clustered=Yes }
    {    ;End Date,End Time                       ;SumIndexFields=Quantity }
    {    ;Deduction Type                           }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      C_INC_ERR_EXPORTED@1101103000 : TextConst 'ENU=This post is already exported to Tempus. It can not be corrected in NAV. Correct it in Tempus.;NOR=Denne posten er allerede eksportert til Tempus, og kan ikke lenger rettes her. Rett i Tempus';
      C_INC_REC_EXISTS@1101103001 : TextConst 'ENU=Machine Center No. %1 os registered in.;NOR=Maskinsenter nr. %1 er m›nstret inn.';

    PROCEDURE CalcQty@1101104000();
    BEGIN
      IF (("Start Date" <> 0D) AND ("Start Time" <> 0T)
        AND ("End Date" <> 0D) AND ("End Time" <> 0T)) THEN BEGIN

        Quantity := ( (("End Date" - "Start Date") * 24) +
          (("End Time" - "Start Time") / 3600000))
      END ELSE
        Quantity := 0;
    END;

    LOCAL PROCEDURE CheckStatus@1101103001();
    BEGIN
      //02. ->
      IF "Date exported to Tempus" <> 0D THEN
        ERROR(C_INC_ERR_EXPORTED);
      //02.<-
    END;

    LOCAL PROCEDURE CheckTimeRegister@1101103000() : Boolean;
    VAR
      OPCTimeRegisterL@1101103000 : Record 83007;
    BEGIN
      OPCTimeRegisterL.SETRANGE("Machine Center", Rec."Machine Center");
      OPCTimeRegisterL.SETRANGE("End Date", 0D);
      IF OPCTimeRegisterL.FINDSET THEN
        ERROR(C_INC_REC_EXISTS);
    END;

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 28.09.17 JAL Upgraded to NAV 2017
      02. 02.10.17 JAL Added CheckTimeRegister() when inserting record. To prevent double registering on the same second.
    }
    END.
  }
}

OBJECT Table 83010 OPC Run Times
{
  OBJECT-PROPERTIES
  {
    Date=28.09.17;
    Time=19:39:03;
    Modified=Yes;
    Version List=OPC6.05;
  }
  PROPERTIES
  {
    DataCaptionFields=Machine Center,Description;
    CaptionML=[ENU=OPC Run Times;
               NOR=OPC Operasjonstider];
  }
  FIELDS
  {
    { 1   ;   ;Entry No.           ;Integer       ;CaptionML=[ENU=Entry No.;
                                                              NOR=L›penummer] }
    { 10  ;   ;Prod. Order No.     ;Code20        ;TableRelation="Production Order".No.;
                                                   CaptionML=[ENU=Prod. Order No.;
                                                              NOR=Prod.ordrenr.];
                                                   NotBlank=No;
                                                   Editable=No }
    { 20  ;   ;Routing No.         ;Code20        ;CaptionML=[ENU=Routing No.;
                                                              NOR=Rute nr.] }
    { 30  ;   ;Operation No.       ;Code10        ;CaptionML=[ENU=Operation No.;
                                                              NOR=Operasjonsnr.];
                                                   NotBlank=No }
    { 40  ;   ;Machine Center      ;Code20        ;TableRelation="Machine Center";
                                                   OnValidate=VAR
                                                                MachineCenterL@1000000000 : Record 99000758;
                                                              BEGIN
                                                                IF MachineCenterL.GET("Machine Center") THEN
                                                                  Description := MachineCenterL.Name;
                                                              END;

                                                   CaptionML=[ENU=Machine Center;
                                                              NOR=Produksjonsressurs] }
    { 45  ;   ;Description         ;Text30        ;CaptionML=[ENU=Description;
                                                              NOR=Beskrivelse] }
    { 50  ;   ;Starting Date       ;Date          ;CaptionML=[ENU=Starting Date;
                                                              NOR=Start dato] }
    { 60  ;   ;Starting Time       ;Time          ;CaptionML=[ENU=Starting Time;
                                                              NOR=Start tidspunkt] }
    { 70  ;   ;Ending Date         ;Date          ;CaptionML=[ENU=Ending Date;
                                                              NOR=Slutt dato] }
    { 80  ;   ;Ending Time         ;Time          ;CaptionML=[ENU=Ending Time;
                                                              NOR=Slutt tidspunkt] }
    { 100 ;   ;Finish Now          ;Boolean       ;OnValidate=BEGIN
                                                                TESTFIELD("Machine Center");
                                                                TESTFIELD("Starting Date");
                                                                TESTFIELD("Starting Time");
                                                              END;

                                                   CaptionML=[ENU=Finish Now;
                                                              NOR=Avslutt n†] }
    { 110 ;   ;Posted              ;Boolean       ;CaptionML=[ENU=Posted;
                                                              NOR=Bokf›rt] }
    { 200 ;   ;Work Done at M.C.   ;Code20        ;TableRelation="Machine Center".No.;
                                                   CaptionML=[ENU=Work Done at Machine Center No.;
                                                              NOR=Arbeid utf›rt p† Maskinsenternr.] }
    { 300 ;   ;Stop Code           ;Code20        ;TableRelation=Stop.Code;
                                                   CaptionML=NOR=Indirekte tid (kode);
                                                   Description=//OPC - ny 22.jan10 }
  }
  KEYS
  {
    {    ;Entry No.                               ;Clustered=Yes }
    {    ;Machine Center                           }
    {    ;Prod. Order No.,Routing No.,Operation No. }
    {    ;Posted                                   }
    {    ;Finish Now                               }
    {    ;Starting Date,Starting Time,Ending Date,Ending Time }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    PROCEDURE GetHours@1101104001() : Decimal;
    VAR
      StartDateTimeL@1101104004 : DateTime;
      EndDateTimeL@1101104005 : DateTime;
    BEGIN
      StartDateTimeL := CREATEDATETIME(Rec."Starting Date", Rec."Starting Time");
      EndDateTimeL := CREATEDATETIME(Rec."Ending Date", Rec."Ending Time");
      EXIT( ((EndDateTimeL - StartDateTimeL) / 3600000) );
    END;

    PROCEDURE GetTime@1000000001() : Decimal;
    BEGIN
      IF (Rec."Ending Time" <> 0T) AND (Rec."Starting Time" <> 0T)
        AND (Rec."Ending Date" <> 0D) AND (Rec."Starting Date" <> 0D) THEN
          EXIT(((Rec."Ending Date" - Rec."Starting Date") * 1440) + ((Rec."Ending Time" - Rec."Starting Time") / 60000))
      ELSE
        EXIT(0);
    END;

    PROCEDURE GetNextLineNo@1101103000() : Integer;
    VAR
      OPCRunTimesL@1101103000 : Record 83010;
    BEGIN
      IF OPCRunTimesL.FINDLAST THEN
        EXIT(OPCRunTimesL."Entry No." + 1)
      ELSE
        EXIT(1);
    END;

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 06.12.05 ASL Tabell oppgrader 4.0SP1
      02. 14.12.05 HHE Legger inn "Work done at"
      03. 29.03.06 ASL Endret slik at det tillates blanke verdier for "Prod. Order No.",
                       "Routing No.","Operation No.", for bokf›ring av ikke produktiv tid
      05. 22.01.10 HHE Nytt felt = "Stop Code" (viser hvilken ind.tid.kode man er innstemplet p†)
    }
    END.
  }
}

OBJECT Table 83011 OPC Indirect Time
{
  OBJECT-PROPERTIES
  {
    Date=20.09.17;
    Time=15:27:14;
    Modified=Yes;
    Version List=OPC6.01;
  }
  PROPERTIES
  {
    OnInsert=VAR
               Stop@1000000000 : Record 99000761;
             BEGIN
               CLEAR(Stop);
               IF NOT Stop.GET(Code) THEN BEGIN
                 Stop.INIT;
                 Stop.Code := Code;
                 Stop."Indirect Time" := TRUE;
                 Stop.INSERT;
               END;
             END;

    CaptionML=[ENU=OPC Indirect Time;
               NOR=OPC Indirekte tid];
    LookupPageID=Page83027;
  }
  FIELDS
  {
    { 1   ;   ;Code                ;Code15        ;CaptionML=[ENU=Code;
                                                              NOR=Kode] }
    { 2   ;   ;Description         ;Text30        ;CaptionML=[ENU=Description;
                                                              NOR=Beskrivelse] }
  }
  KEYS
  {
    {    ;Code                                    ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 29.03.06 ASL Oppretter ogs† kodene som stopp†rsaker for †
                       bruke standard stokkkoder i tidsbokf›ring
    }
    END.
  }
}

OBJECT Table 83012 OPC Run Times Deduction
{
  OBJECT-PROPERTIES
  {
    Date=20.09.17;
    Time=16:06:35;
    Modified=Yes;
    Version List=OPC6.01;
  }
  PROPERTIES
  {
    CaptionML=[ENU=OPC Run Times Deduction;
               NOR=OPC Operasjonstider fradrag];
    LookupPageID=Page83022;
  }
  FIELDS
  {
    { 1   ;   ;Code                ;Code10        ;CaptionML=[ENU=Code;
                                                              NOR=Kode] }
    { 2   ;   ;Description         ;Text30        ;CaptionML=[ENU=Description;
                                                              NOR=Beskrivelse] }
    { 3   ;   ;From Time           ;Time          ;CaptionML=[ENU=From Time;
                                                              NOR=Fra klokken] }
    { 4   ;   ;To Time             ;Time          ;CaptionML=[ENU=To Time;
                                                              NOR=Til klokken] }
    { 9   ;   ;Deduct Prod. Order  ;Boolean       ;CaptionML=[ENU=Deduct From Production Order;
                                                              NOR=Trekk fra p† produksjonsordre] }
    { 10  ;   ;Deduct Type         ;Option        ;CaptionML=[ENU=Deduct type;
                                                              NOR=Fratrekk type];
                                                   OptionCaptionML=[ENU=,Lunch,Dinner,Other;
                                                                    NOR=" ,Lunch,Middag,Annet"];
                                                   OptionString=[ ,Lunch,Dinner,Other];
                                                   Description=01. BVM }
  }
  KEYS
  {
    {    ;Code                                    ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 02.03.10 BVM Nytt felt for fratrekstype ved bruk av m›nstring
    }
    END.
  }
}

OBJECT Table 83013 OPC Cue
{
  OBJECT-PROPERTIES
  {
    Date=20.09.17;
    Time=15:26:29;
    Modified=Yes;
    Version List=OPC6.01;
  }
  PROPERTIES
  {
    CaptionML=[ENU=OPC Cue;
               NOR=OPC bunke-ikon];
  }
  FIELDS
  {
    { 1   ;   ;Primary Key         ;Code10        ;CaptionML=[ENU=Primary Key;
                                                              NOR=Prim‘rn›kkel] }
    { 10  ;   ;Production Order- Released;Integer ;FieldClass=FlowField;
                                                   CalcFormula=Count("Production Order" WHERE (Status=CONST(Released)));
                                                   CaptionML=[ENU=Production Order - Released;
                                                              NOR=Produksjonordre - Frigitt];
                                                   Editable=No }
    { 20  ;   ;Resource Status     ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("OPC Run Times" WHERE (Ending Date=FILTER(''),
                                                                                            Starting Date=FILTER(>01.01.00),
                                                                                            Machine Center=FILTER(<>'')));
                                                   CaptionML=[ENU=Resource Status;
                                                              NOR=Ressursstatus];
                                                   Editable=No }
    { 30  ;   ;Firm planned tasks  ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Prod. Order Routing Line" WHERE (Type=CONST(Machine Center),
                                                                                                       Routing Status=FILTER(<>Finished),
                                                                                                       Status=CONST(Firm Planned)));
                                                   CaptionML=[ENU=Firm planned tasks;
                                                              NOR=Fast planlagte oppgaver];
                                                   Editable=No }
    { 220 ;   ;Date Filter         ;Date          ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Date Filter;
                                                              NOR=Datofilter];
                                                   Editable=No }
    { 240 ;   ;Responsibility Center Filter;Code10;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Responsibility Center Filter;
                                                              NOR=Filter for ansvarssenter];
                                                   Editable=No }
  }
  KEYS
  {
    {    ;Primary Key                             ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 20.09.17 JAL OPC Cue for Role Center
    }
    END.
  }
}

OBJECT Table 99000754 Work Center
{
  OBJECT-PROPERTIES
  {
    Date=28.09.17;
    Time=11:58:31;
    Modified=Yes;
    Version List=NAVW110.00,OPC6.03;
  }
  PROPERTIES
  {
    DataCaptionFields=No.,Name;
    OnInsert=BEGIN
               MfgSetup.GET;
               IF "No." = '' THEN BEGIN
                 MfgSetup.TESTFIELD("Work Center Nos.");
                 NoSeriesMgt.InitSeries(MfgSetup."Work Center Nos.",xRec."No. Series",0D,"No.","No. Series");
               END;
               DimMgt.UpdateDefaultDim(
                 DATABASE::"Work Center","No.",
                 "Global Dimension 1 Code","Global Dimension 2 Code");
             END;

    OnModify=BEGIN
               "Last Date Modified" := TODAY;
             END;

    OnDelete=VAR
               ProdOrderRtngLine@1000 : Record 5409;
               StdCostWksh@1001 : Record 5841;
               CapLedgEntry@1002 : Record 5832;
             BEGIN
               CapLedgEntry.SETRANGE("Work Center No.","No.");
               IF NOT CapLedgEntry.ISEMPTY THEN
                 ERROR(Text010,TABLECAPTION,"No.",CapLedgEntry.TABLECAPTION);

               StdCostWksh.RESET;
               StdCostWksh.SETRANGE(Type,StdCostWksh.Type::"Work Center");
               StdCostWksh.SETRANGE("No.","No.");
               IF NOT StdCostWksh.ISEMPTY THEN
                 ERROR(Text010,TABLECAPTION,"No.",StdCostWksh.TABLECAPTION);

               CalendarEntry.SETCURRENTKEY("Capacity Type","No.");
               CalendarEntry.SETRANGE("Capacity Type",CalendarEntry."Capacity Type"::"Work Center");
               CalendarEntry.SETRANGE("No.","No.");
               CalendarEntry.DELETEALL;

               CalAbsentEntry.SETCURRENTKEY("Capacity Type","No.");
               CalAbsentEntry.SETRANGE("Capacity Type",CalendarEntry."Capacity Type"::"Work Center");
               CalAbsentEntry.SETRANGE("No.","No.");
               CalAbsentEntry.DELETEALL;

               MfgCommentLine.SETRANGE("Table Name",MfgCommentLine."Table Name"::"Work Center");
               MfgCommentLine.SETRANGE("No.","No.");
               MfgCommentLine.DELETEALL;

               ProdOrderRtngLine.SETRANGE("Work Center No.","No.");
               IF NOT ProdOrderRtngLine.ISEMPTY THEN
                 ERROR(Text000);

               DimMgt.DeleteDefaultDim(DATABASE::"Work Center","No.");

               VALIDATE("Location Code",''); // to clean up the default bins
             END;

    OnRename=BEGIN
               "Last Date Modified" := TODAY;
             END;

    CaptionML=[ENU=Work Center;
               NOR=Arbeidssenter];
    LookupPageID=Page99000755;
    DrillDownPageID=Page99000755;
  }
  FIELDS
  {
    { 1   ;   ;No.                 ;Code20        ;AltSearchField=Search Name;
                                                   CaptionML=[ENU=No.;
                                                              NOR=Nr.] }
    { 3   ;   ;Name                ;Text50        ;OnValidate=BEGIN
                                                                "Search Name" := Name;
                                                              END;

                                                   CaptionML=[ENU=Name;
                                                              NOR=Navn] }
    { 4   ;   ;Search Name         ;Code50        ;CaptionML=[ENU=Search Name;
                                                              NOR=S›kenavn] }
    { 5   ;   ;Name 2              ;Text50        ;CaptionML=[ENU=Name 2;
                                                              NOR=Navn 2] }
    { 6   ;   ;Address             ;Text50        ;CaptionML=[ENU=Address;
                                                              NOR=Adresse] }
    { 7   ;   ;Address 2           ;Text50        ;CaptionML=[ENU=Address 2;
                                                              NOR=Adresse 2] }
    { 8   ;   ;City                ;Text30        ;TableRelation=IF (Country/Region Code=CONST()) "Post Code".City
                                                                 ELSE IF (Country/Region Code=FILTER(<>'')) "Post Code".City WHERE (Country/Region Code=FIELD(Country/Region Code));
                                                   OnValidate=BEGIN
                                                                PostCode.ValidateCity(City,"Post Code",County,"Country/Region Code",(CurrFieldNo <> 0) AND GUIALLOWED);
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=City;
                                                              NOR=Sted] }
    { 9   ;   ;Post Code           ;Code20        ;TableRelation=IF (Country/Region Code=CONST()) "Post Code"
                                                                 ELSE IF (Country/Region Code=FILTER(<>'')) "Post Code" WHERE (Country/Region Code=FIELD(Country/Region Code));
                                                   OnValidate=BEGIN
                                                                PostCode.ValidatePostCode(City,"Post Code",County,"Country/Region Code",(CurrFieldNo <> 0) AND GUIALLOWED);
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Post Code;
                                                              NOR=Postnr.] }
    { 12  ;   ;Alternate Work Center;Code20       ;TableRelation="Work Center";
                                                   CaptionML=[ENU=Alternate Work Center;
                                                              NOR=Alternativt arbeidssenter] }
    { 14  ;   ;Work Center Group Code;Code10      ;TableRelation="Work Center Group";
                                                   OnValidate=VAR
                                                                ProdOrderRtngLine@1000 : Record 5409;
                                                                ProdOrderCapNeedEntry@1001 : Record 5410;
                                                                PlanningRtngLine@1002 : Record 99000830;
                                                              BEGIN
                                                                IF "Work Center Group Code" = xRec."Work Center Group Code" THEN
                                                                  EXIT;

                                                                CalendarEntry.SETCURRENTKEY("Work Center No.");
                                                                CalendarEntry.SETRANGE("Work Center No.","No.");
                                                                IF NOT CalendarEntry.FIND('-') THEN
                                                                  EXIT;

                                                                IF CurrFieldNo <> 0 THEN
                                                                  IF NOT CONFIRM(Text001,FALSE,FIELDCAPTION("Work Center Group Code"))
                                                                  THEN BEGIN
                                                                    "Work Center Group Code" := xRec."Work Center Group Code";
                                                                    EXIT;
                                                                  END;

                                                                Window.OPEN(
                                                                  Text002 +
                                                                  Text003 +
                                                                  Text004 +
                                                                  Text006);

                                                                // Capacity Calendar
                                                                EntryCounter := 0;
                                                                NoOfRecords := CalendarEntry.COUNT;
                                                                IF CalendarEntry.FIND('-') THEN
                                                                  REPEAT
                                                                    EntryCounter := EntryCounter + 1;
                                                                    Window.UPDATE(1,EntryCounter);
                                                                    Window.UPDATE(2,ROUND(EntryCounter / NoOfRecords * 10000,1));
                                                                    CalendarEntry."Work Center Group Code" := "Work Center Group Code";
                                                                    CalendarEntry.MODIFY;
                                                                  UNTIL CalendarEntry.NEXT = 0;

                                                                // Capacity Absence
                                                                EntryCounter := 0;
                                                                CalAbsentEntry.SETCURRENTKEY("Work Center No.");
                                                                CalAbsentEntry.SETRANGE("Work Center No.","No.");
                                                                NoOfRecords := CalAbsentEntry.COUNT;
                                                                IF CalAbsentEntry.FIND('-') THEN
                                                                  REPEAT
                                                                    EntryCounter := EntryCounter + 1;
                                                                    Window.UPDATE(3,EntryCounter);
                                                                    Window.UPDATE(4,ROUND(EntryCounter / NoOfRecords * 10000,1));
                                                                    CalAbsentEntry."Work Center Group Code" := "Work Center Group Code";
                                                                    CalAbsentEntry.MODIFY;
                                                                  UNTIL CalAbsentEntry.NEXT = 0;

                                                                EntryCounter := 0;

                                                                ProdOrderCapNeedEntry.SETCURRENTKEY("Work Center No.");
                                                                ProdOrderCapNeedEntry.SETRANGE("Work Center No.","No.");
                                                                NoOfRecords := ProdOrderCapNeedEntry.COUNT;
                                                                IF ProdOrderCapNeedEntry.FIND('-') THEN
                                                                  REPEAT
                                                                    EntryCounter := EntryCounter + 1;
                                                                    Window.UPDATE(7,EntryCounter);
                                                                    Window.UPDATE(8,ROUND(EntryCounter / NoOfRecords * 10000,1));
                                                                    ProdOrderCapNeedEntry."Work Center Group Code" := "Work Center Group Code";
                                                                    ProdOrderCapNeedEntry.MODIFY;
                                                                  UNTIL ProdOrderCapNeedEntry.NEXT = 0;

                                                                MODIFY;

                                                                RtngLine.SETCURRENTKEY("Work Center No.");
                                                                RtngLine.SETRANGE("Work Center No.","No.");
                                                                RtngLine.MODIFYALL("Work Center Group Code","Work Center Group Code");

                                                                PlanningRtngLine.SETCURRENTKEY("Work Center No.");
                                                                PlanningRtngLine.SETRANGE("Work Center No.","No.");
                                                                PlanningRtngLine.MODIFYALL("Work Center Group Code","Work Center Group Code");

                                                                ProdOrderRtngLine.SETCURRENTKEY("Work Center No.");
                                                                ProdOrderRtngLine.SETRANGE("Work Center No.","No.");
                                                                ProdOrderRtngLine.MODIFYALL("Work Center Group Code","Work Center Group Code");

                                                                Window.CLOSE;
                                                              END;

                                                   CaptionML=[ENU=Work Center Group Code;
                                                              NOR=Arbeidssentergruppekode] }
    { 16  ;   ;Global Dimension 1 Code;Code20     ;TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(1));
                                                   OnValidate=BEGIN
                                                                ValidateShortcutDimCode(1,"Global Dimension 1 Code");
                                                              END;

                                                   CaptionML=[ENU=Global Dimension 1 Code;
                                                              NOR=Global dimensjon 1 - kode];
                                                   CaptionClass='1,1,1' }
    { 17  ;   ;Global Dimension 2 Code;Code20     ;TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(2));
                                                   OnValidate=BEGIN
                                                                ValidateShortcutDimCode(2,"Global Dimension 2 Code");
                                                              END;

                                                   CaptionML=[ENU=Global Dimension 2 Code;
                                                              NOR=Global dimensjon 2 - kode];
                                                   CaptionClass='1,1,2' }
    { 18  ;   ;Subcontractor No.   ;Code20        ;TableRelation=Vendor;
                                                   CaptionML=[ENU=Subcontractor No.;
                                                              NOR=Underleverand›rnr.] }
    { 19  ;   ;Direct Unit Cost    ;Decimal       ;OnValidate=BEGIN
                                                                VALIDATE("Indirect Cost %");
                                                              END;

                                                   CaptionML=[ENU=Direct Unit Cost;
                                                              NOR=Direkte enhetskost];
                                                   MinValue=0;
                                                   AutoFormatType=2 }
    { 20  ;   ;Indirect Cost %     ;Decimal       ;OnValidate=BEGIN
                                                                GetGLSetup;
                                                                "Unit Cost" :=
                                                                  ROUND(
                                                                    "Direct Unit Cost" * (1 + "Indirect Cost %" / 100) + "Overhead Rate",
                                                                    GLSetup."Unit-Amount Rounding Precision");
                                                              END;

                                                   CaptionML=[ENU=Indirect Cost %;
                                                              NOR=Indirekte kost-%];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
    { 21  ;   ;Unit Cost           ;Decimal       ;OnValidate=BEGIN
                                                                GetGLSetup;
                                                                "Direct Unit Cost" :=
                                                                  ROUND(("Unit Cost" - "Overhead Rate") / (1 + "Indirect Cost %" / 100),
                                                                    GLSetup."Unit-Amount Rounding Precision");
                                                              END;

                                                   CaptionML=[ENU=Unit Cost;
                                                              NOR=Enhetskost];
                                                   DecimalPlaces=2:5;
                                                   MinValue=0;
                                                   AutoFormatType=2 }
    { 22  ;   ;Queue Time          ;Decimal       ;CaptionML=[ENU=Queue Time;
                                                              NOR=K›tid];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
    { 23  ;   ;Queue Time Unit of Meas. Code;Code10;
                                                   TableRelation="Capacity Unit of Measure";
                                                   CaptionML=[ENU=Queue Time Unit of Meas. Code;
                                                              NOR=K›tidsenhetskode] }
    { 26  ;   ;Last Date Modified  ;Date          ;CaptionML=[ENU=Last Date Modified;
                                                              NOR=Endret den];
                                                   Editable=No }
    { 27  ;   ;Comment             ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Manufacturing Comment Line" WHERE (Table Name=CONST(Work Center),
                                                                                                         No.=FIELD(No.)));
                                                   CaptionML=[ENU=Comment;
                                                              NOR=Merknad];
                                                   Editable=No }
    { 30  ;   ;Unit of Measure Code;Code10        ;TableRelation="Capacity Unit of Measure";
                                                   OnValidate=BEGIN
                                                                IF "Unit of Measure Code" = xRec."Unit of Measure Code" THEN
                                                                  EXIT;

                                                                CALCFIELDS("Prod. Order Need (Qty.)");
                                                                IF "Prod. Order Need (Qty.)" <> 0 THEN
                                                                  ERROR(Text007,FIELDCAPTION("Unit of Measure Code"));

                                                                IF xRec."Unit of Measure Code" <> '' THEN
                                                                  IF CurrFieldNo <> 0 THEN
                                                                    IF NOT CONFIRM(Text001,FALSE,FIELDCAPTION("Unit of Measure Code"))
                                                                    THEN BEGIN
                                                                      "Unit of Measure Code" := xRec."Unit of Measure Code";
                                                                      EXIT;
                                                                    END;

                                                                Window.OPEN(
                                                                  Text008 +
                                                                  Text009);

                                                                MODIFY;

                                                                // Capacity Calendar
                                                                EntryCounter := 0;
                                                                CalendarEntry.SETCURRENTKEY("Work Center No.");
                                                                CalendarEntry.SETRANGE("Work Center No.","No.");
                                                                NoOfRecords := CalendarEntry.COUNT;
                                                                IF CalendarEntry.FIND('-') THEN
                                                                  REPEAT
                                                                    EntryCounter := EntryCounter + 1;
                                                                    Window.UPDATE(1,EntryCounter);
                                                                    Window.UPDATE(2,ROUND(EntryCounter / NoOfRecords * 10000,1));
                                                                    CalendarEntry.VALIDATE("Ending Time");
                                                                    CalendarEntry.MODIFY;
                                                                  UNTIL CalendarEntry.NEXT = 0;

                                                                Window.CLOSE;
                                                              END;

                                                   CaptionML=[ENU=Unit of Measure Code;
                                                              NOR=Enhetskode] }
    { 31  ;   ;Capacity            ;Decimal       ;InitValue=1;
                                                   CaptionML=[ENU=Capacity;
                                                              NOR=Kapasitet];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
    { 32  ;   ;Efficiency          ;Decimal       ;InitValue=100;
                                                   CaptionML=[ENU=Efficiency;
                                                              NOR=Effektivitet];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
    { 33  ;   ;Maximum Efficiency  ;Decimal       ;CaptionML=[ENU=Maximum Efficiency;
                                                              NOR=Maks. effektivitet];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
    { 34  ;   ;Minimum Efficiency  ;Decimal       ;CaptionML=[ENU=Minimum Efficiency;
                                                              NOR=Min. effektivitet];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
    { 35  ;   ;Calendar Rounding Precision;Decimal;InitValue=0,0001;
                                                   CaptionML=[ENU=Calendar Rounding Precision;
                                                              NOR=Kalenderavrundingspresisjon];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0,0001;
                                                   NotBlank=Yes }
    { 36  ;   ;Simulation Type     ;Option        ;CaptionML=[ENU=Simulation Type;
                                                              NOR=Simuleringstype];
                                                   OptionCaptionML=[ENU=Moves,Moves When Necessary,Critical;
                                                                    NOR=Flytter,Flytter ved behov,Kritisk];
                                                   OptionString=Moves,Moves When Necessary,Critical }
    { 37  ;   ;Shop Calendar Code  ;Code10        ;TableRelation="Shop Calendar";
                                                   CaptionML=[ENU=Shop Calendar Code;
                                                              NOR=Produksjonskalenderkode] }
    { 38  ;   ;Blocked             ;Boolean       ;CaptionML=[ENU=Blocked;
                                                              NOR=Sperret] }
    { 39  ;   ;Date Filter         ;Date          ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Date Filter;
                                                              NOR=Datofilter] }
    { 40  ;   ;Work Shift Filter   ;Code10        ;FieldClass=FlowFilter;
                                                   TableRelation="Work Shift";
                                                   CaptionML=[ENU=Work Shift Filter;
                                                              NOR=Arbeidsskiftfilter] }
    { 41  ;   ;Capacity (Total)    ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Calendar Entry"."Capacity (Total)" WHERE (Capacity Type=CONST(Work Center),
                                                                                                              No.=FIELD(No.),
                                                                                                              Work Shift Code=FIELD(Work Shift Filter),
                                                                                                              Date=FIELD(Date Filter)));
                                                   CaptionML=[ENU=Capacity (Total);
                                                              NOR=Kapasitet (total)];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 42  ;   ;Capacity (Effective);Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Calendar Entry"."Capacity (Effective)" WHERE (Capacity Type=CONST(Work Center),
                                                                                                                  No.=FIELD(No.),
                                                                                                                  Work Shift Code=FIELD(Work Shift Filter),
                                                                                                                  Date=FIELD(Date Filter)));
                                                   CaptionML=[ENU=Capacity (Effective);
                                                              NOR=Kapasitet (effektiv)];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 44  ;   ;Prod. Order Need (Qty.);Decimal    ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Prod. Order Capacity Need"."Allocated Time" WHERE (Work Center No.=FIELD(No.),
                                                                                                                       Status=FIELD(Prod. Order Status Filter),
                                                                                                                       Date=FIELD(Date Filter),
                                                                                                                       Requested Only=CONST(No)));
                                                   CaptionML=[ENU=Prod. Order Need (Qty.);
                                                              NOR=Prod.ordrebehov (ant.)];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 45  ;   ;Prod. Order Need Amount;Decimal    ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Prod. Order Routing Line"."Expected Operation Cost Amt." WHERE (Work Center No.=FIELD(No.),
                                                                                                                                    Status=FIELD(Prod. Order Status Filter)));
                                                   CaptionML=[ENU=Prod. Order Need Amount;
                                                              NOR=Prod.ordrebehov - bel›p];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 47  ;   ;Prod. Order Status Filter;Option   ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Prod. Order Status Filter;
                                                              NOR=Prod.ordrestatusfilter];
                                                   OptionCaptionML=[ENU=Simulated,Planned,Firm Planned,Released,Finished;
                                                                    NOR=Simulert,Planlagt,Fast planlagt,Frigitt,Ferdig];
                                                   OptionString=Simulated,Planned,Firm Planned,Released,Finished }
    { 50  ;   ;Unit Cost Calculation;Option       ;CaptionML=[ENU=Unit Cost Calculation;
                                                              NOR=Beregning av enhetskost];
                                                   OptionCaptionML=[ENU=Time,Units;
                                                                    NOR=Tid,Enheter];
                                                   OptionString=Time,Units }
    { 51  ;   ;Specific Unit Cost  ;Boolean       ;CaptionML=[ENU=Specific Unit Cost;
                                                              NOR=Bestemt enhetskost] }
    { 52  ;   ;Consolidated Calendar;Boolean      ;CaptionML=[ENU=Consolidated Calendar;
                                                              NOR=Konsolidert kalender] }
    { 53  ;   ;Flushing Method     ;Option        ;InitValue=Manual;
                                                   CaptionML=[ENU=Flushing Method;
                                                              NOR=Trekkmetode];
                                                   OptionCaptionML=[ENU=Manual,Forward,Backward;
                                                                    NOR=Manuell,Forlengs,Baklengs];
                                                   OptionString=Manual,Forward,Backward }
    { 80  ;   ;No. Series          ;Code10        ;TableRelation="No. Series";
                                                   CaptionML=[ENU=No. Series;
                                                              NOR=Nr.serie];
                                                   Editable=No }
    { 81  ;   ;Overhead Rate       ;Decimal       ;OnValidate=BEGIN
                                                                VALIDATE("Indirect Cost %");
                                                              END;

                                                   CaptionML=[ENU=Overhead Rate;
                                                              NOR=Sats for indirekte kostnader];
                                                   AutoFormatType=2 }
    { 82  ;   ;Gen. Prod. Posting Group;Code10    ;TableRelation="Gen. Product Posting Group";
                                                   CaptionML=[ENU=Gen. Prod. Posting Group;
                                                              NOR=Bokf›ringsgruppe - vare] }
    { 83  ;   ;County              ;Text30        ;CaptionML=[ENU=County;
                                                              NOR=Fylke/delstat] }
    { 84  ;   ;Country/Region Code ;Code10        ;TableRelation=Country/Region;
                                                   CaptionML=[ENU=Country/Region Code;
                                                              NOR=Lands-/regionkode] }
    { 7300;   ;Location Code       ;Code10        ;TableRelation=Location.Code WHERE (Use As In-Transit=CONST(No),
                                                                                      Bin Mandatory=CONST(Yes));
                                                   OnValidate=VAR
                                                                Location@1000 : Record 14;
                                                                MachineCenter@1001 : Record 99000758;
                                                                WhseIntegrationMgt@1002 : Codeunit 7317;
                                                                AutoUpdate@1003 : Boolean;
                                                              BEGIN
                                                                IF "Location Code" <> xRec."Location Code" THEN BEGIN
                                                                  IF "Location Code" <> '' THEN BEGIN
                                                                    Location.GET("Location Code");
                                                                    WhseIntegrationMgt.CheckLocationCode(Location,DATABASE::"Work Center","No.");
                                                                  END;

                                                                  IF "Open Shop Floor Bin Code" <> '' THEN BEGIN
                                                                    IF ConfirmAutoRemovalOfBinCode(AutoUpdate) THEN
                                                                      VALIDATE("Open Shop Floor Bin Code",'')
                                                                    ELSE
                                                                      TESTFIELD("Open Shop Floor Bin Code",'');
                                                                  END;
                                                                  IF "To-Production Bin Code" <> '' THEN BEGIN
                                                                    IF ConfirmAutoRemovalOfBinCode(AutoUpdate) THEN
                                                                      VALIDATE("To-Production Bin Code",'')
                                                                    ELSE
                                                                      TESTFIELD("To-Production Bin Code",'');
                                                                  END;
                                                                  IF "From-Production Bin Code" <> '' THEN BEGIN
                                                                    IF ConfirmAutoRemovalOfBinCode(AutoUpdate) THEN
                                                                      VALIDATE("From-Production Bin Code",'')
                                                                    ELSE
                                                                      TESTFIELD("From-Production Bin Code",'');
                                                                  END;
                                                                  MachineCenter.SETCURRENTKEY("Work Center No.");
                                                                  MachineCenter.SETRANGE("Work Center No.","No.");
                                                                  IF MachineCenter.FINDSET(TRUE) THEN
                                                                    REPEAT
                                                                      MachineCenter."Location Code" := "Location Code";
                                                                      IF MachineCenter."Open Shop Floor Bin Code" <> '' THEN BEGIN
                                                                        IF ConfirmAutoRemovalOfBinCode(AutoUpdate) THEN
                                                                          MachineCenter.VALIDATE("Open Shop Floor Bin Code",'')
                                                                        ELSE
                                                                          MachineCenter.TESTFIELD("Open Shop Floor Bin Code",'');
                                                                      END;
                                                                      IF MachineCenter."To-Production Bin Code" <> '' THEN BEGIN
                                                                        IF ConfirmAutoRemovalOfBinCode(AutoUpdate) THEN
                                                                          MachineCenter.VALIDATE("To-Production Bin Code",'')
                                                                        ELSE
                                                                          MachineCenter.TESTFIELD("To-Production Bin Code",'');
                                                                      END;
                                                                      IF MachineCenter."From-Production Bin Code" <> '' THEN BEGIN
                                                                        IF ConfirmAutoRemovalOfBinCode(AutoUpdate) THEN
                                                                          MachineCenter.VALIDATE("From-Production Bin Code",'')
                                                                        ELSE
                                                                          MachineCenter.TESTFIELD("From-Production Bin Code",'');
                                                                      END;
                                                                      MachineCenter.MODIFY(TRUE);
                                                                    UNTIL MachineCenter.NEXT = 0;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Location Code;
                                                              NOR=Lokasjonskode] }
    { 7301;   ;Open Shop Floor Bin Code;Code20    ;TableRelation=Bin.Code WHERE (Location Code=FIELD(Location Code));
                                                   OnValidate=VAR
                                                                WhseIntegrationMgt@1000 : Codeunit 7317;
                                                              BEGIN
                                                                WhseIntegrationMgt.CheckBinCode("Location Code",
                                                                  "Open Shop Floor Bin Code",
                                                                  FIELDCAPTION("Open Shop Floor Bin Code"),
                                                                  DATABASE::"Work Center","No.");
                                                              END;

                                                   CaptionML=[ENU=Open Shop Floor Bin Code;
                                                              NOR=pen prod.hyllekode] }
    { 7302;   ;To-Production Bin Code;Code20      ;TableRelation=Bin.Code WHERE (Location Code=FIELD(Location Code));
                                                   OnValidate=VAR
                                                                WhseIntegrationMgt@1000 : Codeunit 7317;
                                                              BEGIN
                                                                WhseIntegrationMgt.CheckBinCode("Location Code",
                                                                  "To-Production Bin Code",
                                                                  FIELDCAPTION("To-Production Bin Code"),
                                                                  DATABASE::"Work Center","No.");
                                                              END;

                                                   CaptionML=[ENU=To-Production Bin Code;
                                                              NOR=Til-Hyllekode for produksjon] }
    { 7303;   ;From-Production Bin Code;Code20    ;TableRelation=Bin.Code WHERE (Location Code=FIELD(Location Code));
                                                   OnValidate=VAR
                                                                WhseIntegrationMgt@1000 : Codeunit 7317;
                                                              BEGIN
                                                                WhseIntegrationMgt.CheckBinCode("Location Code",
                                                                  "From-Production Bin Code",
                                                                  FIELDCAPTION("From-Production Bin Code"),
                                                                  DATABASE::"Work Center","No.");
                                                              END;

                                                   CaptionML=[ENU=From-Production Bin Code;
                                                              NOR=Fra-Hyllekode for produksjon] }
    { 83001;  ;Deduct Lunch        ;Decimal       ;CaptionML=[ENU=Deduct lunch (Hours);
                                                              NOR=Fratrekk lunch (timer)];
                                                   Description=01. BVM }
    { 83002;  ;Deduct Dinner       ;Decimal       ;CaptionML=[ENU=Deduct dinner (hours);
                                                              NOR=Fratrekk middag (timer)];
                                                   Description=01. BVM }
    { 83003;  ;Earliest Time Reg. Start Time;Time ;CaptionML=[ENU=Earliest Time Reg. Start Time (In);
                                                              NOR=Tidligste m›nstringstid(inn)] }
    { 83004;  ;Time Reg. Deduct Code Lunch;Code10 ;TableRelation="OPC Run Times Deduction".Code;
                                                   CaptionML=[ENU=Time Reg. Deduct Code Lunch;
                                                              NOR=M›nstring fradragskode lunsj] }
    { 83005;  ;Time Reg. Deduct Code Dinner;Code10;TableRelation="OPC Run Times Deduction".Code;
                                                   CaptionML=[ENU=Time Reg. Deduct Code Dinner;
                                                              NOR=M›nstring fradragskode middag] }
  }
  KEYS
  {
    {    ;No.                                     ;Clustered=Yes }
    {    ;Search Name                              }
    {    ;Work Center Group Code                   }
    {    ;Subcontractor No.                        }
    {    ;Name                                     }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      Text000@1000 : TextConst 'ENU=The Work Center is being used on production orders.;NOR=Arbeidssenteret brukes for produksjonsordrer.';
      Text001@1001 : TextConst 'ENU=Do you want to change %1?;NOR=Vil du endre %1?';
      Text002@1002 : TextConst 'ENU=Work Center Group Code is changed...\\;NOR=Koden for arbeidssentergruppen er endret...\\';
      Text003@1003 : TextConst 'ENU=Calendar Entry    #1###### @2@@@@@@@@@@@@@\;NOR=Kalenderpost      #1###### @2@@@@@@@@@@@@@\';
      Text004@1004 : TextConst 'ENU=Calendar Absent.  #3###### @4@@@@@@@@@@@@@\;NOR=Kalenderfrav‘r    #3###### @4@@@@@@@@@@@@@\';
      Text006@1005 : TextConst 'ENU=Prod. Order Need  #7###### @8@@@@@@@@@@@@@;NOR=Prod.ordrebehov   #7###### @8@@@@@@@@@@@@@';
      Text007@1006 : TextConst 'ENU=%1 cannot be changed for scheduled work centers.;NOR=%1 kan ikke endres for planlagte arbeidssentre.';
      Text008@1007 : TextConst 'ENU=Capacity Unit of Time is corrected on\\;NOR=Kapasitetstid er korrigert p†\\';
      Text009@1008 : TextConst 'ENU=Calendar Entry    #1###### @2@@@@@@@@@@@@@;NOR=Kalenderpost      #1###### @2@@@@@@@@@@@@@';
      PostCode@1024 : Record 225;
      MfgSetup@1009 : Record 99000765;
      WorkCenter@1010 : Record 99000754;
      CalendarEntry@1011 : Record 99000757;
      CalAbsentEntry@1012 : Record 99000760;
      MfgCommentLine@1013 : Record 99000770;
      RtngLine@1014 : Record 99000764;
      GLSetup@1022 : Record 98;
      NoSeriesMgt@1015 : Codeunit 396;
      DimMgt@1020 : Codeunit 408;
      Window@1017 : Dialog;
      EntryCounter@1018 : Integer;
      NoOfRecords@1019 : Integer;
      GLSetupRead@1021 : Boolean;
      Text010@1023 : TextConst '@@@="%1 = Table caption; %2 = Field Value; %3 = Table Caption";ENU=You cannot delete %1 %2 because there is at least one %3 associated with it.;NOR=Du kan ikke slette %1 %2 fordi det finnes minst ‚n %3 tilknyttet.';
      Text011@1025 : TextConst 'ENU=If you change the %1, then all bin codes on the %2 and related %3 will be removed. Are you sure that you want to continue?;NOR=Hvis du endrer %1, vil alle hyllekoder p† %2 og relaterte %3 bli fjernet. Er du sikker p† at du vil fortsette ?';

    PROCEDURE AssistEdit@2(OldWorkCenter@1000 : Record 99000754) : Boolean;
    BEGIN
      WITH WorkCenter DO BEGIN
        WorkCenter := Rec;
        MfgSetup.GET;
        MfgSetup.TESTFIELD("Work Center Nos.");
        IF NoSeriesMgt.SelectSeries(MfgSetup."Work Center Nos.",OldWorkCenter."No. Series","No. Series") THEN BEGIN
          NoSeriesMgt.SetSeries("No.");
          Rec := WorkCenter;
          EXIT(TRUE);
        END;
      END;
    END;

    LOCAL PROCEDURE ValidateShortcutDimCode@29(FieldNumber@1000 : Integer;VAR ShortcutDimCode@1001 : Code[20]);
    BEGIN
      DimMgt.ValidateDimValueCode(FieldNumber,ShortcutDimCode);
      DimMgt.SaveDefaultDim(DATABASE::"Work Center","No.",FieldNumber,ShortcutDimCode);
      MODIFY;
    END;

    LOCAL PROCEDURE GetGLSetup@14();
    BEGIN
      IF NOT GLSetupRead THEN
        GLSetup.GET;
      GLSetupRead := TRUE;
    END;

    LOCAL PROCEDURE ConfirmAutoRemovalOfBinCode@1(VAR AutoUpdate@1000 : Boolean) : Boolean;
    VAR
      MachineCenter@1001 : Record 99000758;
    BEGIN
      IF AutoUpdate THEN
        EXIT(TRUE);

      IF CONFIRM(Text011,FALSE,FIELDCAPTION("Location Code"),TABLECAPTION,MachineCenter.TABLECAPTION) THEN
        AutoUpdate := TRUE;

      EXIT(AutoUpdate);
    END;

    PROCEDURE GetBinCode@9(UseFlushingMethod@1000 : Boolean;FlushingMethod@1001 : 'Manual,Forward,Backward,Pick + Forward,Pick + Backward') : Code[20];
    BEGIN
      IF NOT UseFlushingMethod THEN
        EXIT("From-Production Bin Code");

      CASE FlushingMethod OF
        FlushingMethod::Manual,
        FlushingMethod::"Pick + Forward",
        FlushingMethod::"Pick + Backward":
          EXIT("To-Production Bin Code");
        FlushingMethod::Forward,
        FlushingMethod::Backward:
          EXIT("Open Shop Floor Bin Code");
      END;
    END;

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 23.02.10 BVM Nye felt for fratrekk av tid ved m›nstring for Administrasjon
      02. 10.03.10 HHE Nytt felt "Earliest start time - time reg" (AS vil at tid innstemplet f›r kl. 7.00 i produksjon
                       skal fremvises som 7.00)
      03. 11.03.10 HHE Nye felt: "Run Times Deduction-oas".Code" -> Fradrag i m›nstringstid
    }
    END.
  }
}

OBJECT Table 99000758 Machine Center
{
  OBJECT-PROPERTIES
  {
    Date=28.09.17;
    Time=11:59:12;
    Modified=Yes;
    Version List=NAVW110.00,OPC6.05;
  }
  PROPERTIES
  {
    DataCaptionFields=No.,Name;
    OnInsert=BEGIN
               MfgSetup.GET;
               IF "No." = '' THEN BEGIN
                 MfgSetup.TESTFIELD("Machine Center Nos.");
                 NoSeriesMgt.InitSeries(MfgSetup."Machine Center Nos.",xRec."No. Series",0D,"No.","No. Series");
               END;
             END;

    OnModify=BEGIN
               "Last Date Modified" := TODAY;
             END;

    OnDelete=VAR
               ProdOrderRtngLine@1000 : Record 5409;
               StdCostWksh@1001 : Record 5841;
               CapLedgEntry@1002 : Record 5832;
             BEGIN
               CapLedgEntry.SETRANGE(Type,CapLedgEntry.Type::"Machine Center");
               CapLedgEntry.SETRANGE("No.","No.");
               IF NOT CapLedgEntry.ISEMPTY THEN
                 ERROR(Text007,TABLECAPTION,"No.",CapLedgEntry.TABLECAPTION);

               StdCostWksh.RESET;
               StdCostWksh.SETRANGE(Type,StdCostWksh.Type::"Machine Center");
               StdCostWksh.SETRANGE("No.","No.");
               IF NOT StdCostWksh.ISEMPTY THEN
                 ERROR(Text007,TABLECAPTION,"No.",StdCostWksh.TABLECAPTION);

               CalendarEntry.SETRANGE("Capacity Type",CalendarEntry."Capacity Type"::"Machine Center");
               CalendarEntry.SETRANGE("No.","No.");
               CalendarEntry.DELETEALL;

               CalAbsentEntry.SETRANGE("Capacity Type",CalendarEntry."Capacity Type"::"Machine Center");
               CalAbsentEntry.SETRANGE("No.","No.");
               CalAbsentEntry.DELETEALL;

               MfgCommentLine.SETRANGE("Table Name",MfgCommentLine."Table Name"::"Machine Center");
               MfgCommentLine.SETRANGE("No.","No.");
               MfgCommentLine.DELETEALL;

               ProdOrderRtngLine.SETRANGE(Type,ProdOrderRtngLine.Type::"Machine Center");
               ProdOrderRtngLine.SETRANGE("No.","No.");
               IF NOT ProdOrderRtngLine.ISEMPTY THEN
                 ERROR(Text000);
             END;

    OnRename=BEGIN
               "Last Date Modified" := TODAY;
             END;

    CaptionML=[ENU=Machine Center;
               NOR=Maskinsenter];
    LookupPageID=Page99000761;
    DrillDownPageID=Page99000761;
  }
  FIELDS
  {
    { 1   ;   ;No.                 ;Code20        ;AltSearchField=Search Name;
                                                   CaptionML=[ENU=No.;
                                                              NOR=Nr.] }
    { 3   ;   ;Name                ;Text50        ;OnValidate=BEGIN
                                                                "Search Name" := Name;
                                                              END;

                                                   CaptionML=[ENU=Name;
                                                              NOR=Navn] }
    { 4   ;   ;Search Name         ;Code50        ;CaptionML=[ENU=Search Name;
                                                              NOR=S›kenavn] }
    { 5   ;   ;Name 2              ;Text50        ;CaptionML=[ENU=Name 2;
                                                              NOR=Navn 2] }
    { 6   ;   ;Address             ;Text50        ;CaptionML=[ENU=Address;
                                                              NOR=Adresse] }
    { 7   ;   ;Address 2           ;Text50        ;CaptionML=[ENU=Address 2;
                                                              NOR=Adresse 2] }
    { 8   ;   ;City                ;Text30        ;TableRelation=IF (Country/Region Code=CONST()) "Post Code".City
                                                                 ELSE IF (Country/Region Code=FILTER(<>'')) "Post Code".City WHERE (Country/Region Code=FIELD(Country/Region Code));
                                                   OnValidate=BEGIN
                                                                PostCode.ValidateCity(City,"Post Code",County,"Country/Region Code",(CurrFieldNo <> 0) AND GUIALLOWED);
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=City;
                                                              NOR=Sted] }
    { 9   ;   ;Post Code           ;Code20        ;TableRelation=IF (Country/Region Code=CONST()) "Post Code"
                                                                 ELSE IF (Country/Region Code=FILTER(<>'')) "Post Code" WHERE (Country/Region Code=FIELD(Country/Region Code));
                                                   OnValidate=BEGIN
                                                                PostCode.ValidatePostCode(City,"Post Code",County,"Country/Region Code",(CurrFieldNo <> 0) AND GUIALLOWED);
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Post Code;
                                                              NOR=Postnr.] }
    { 14  ;   ;Work Center No.     ;Code20        ;TableRelation="Work Center";
                                                   OnValidate=VAR
                                                                WorkCenter@1000 : Record 99000754;
                                                                ProdOrderRtngLine@1001 : Record 5409;
                                                                ProdOrderCapNeed@1002 : Record 5410;
                                                                PlanningRtngLine@1003 : Record 99000830;
                                                              BEGIN
                                                                IF "Work Center No." = xRec."Work Center No." THEN
                                                                  EXIT;

                                                                IF "Work Center No." <> '' THEN BEGIN
                                                                  WorkCenter.GET("Work Center No.");
                                                                  WorkCenter.TESTFIELD("Unit of Measure Code");
                                                                  "Queue Time Unit of Meas. Code" := WorkCenter."Queue Time Unit of Meas. Code";
                                                                  "Setup Time Unit of Meas. Code" := WorkCenter."Unit of Measure Code";
                                                                  "Wait Time Unit of Meas. Code" := WorkCenter."Unit of Measure Code";
                                                                  "Move Time Unit of Meas. Code" := WorkCenter."Unit of Measure Code";
                                                                END;
                                                                VALIDATE("Location Code",WorkCenter."Location Code");

                                                                CalendarEntry.SETCURRENTKEY("Capacity Type","No.");
                                                                CalendarEntry.SETRANGE("Capacity Type",CalendarEntry."Capacity Type"::"Machine Center");
                                                                CalendarEntry.SETRANGE("No.","No.");
                                                                IF NOT CalendarEntry.FIND('-') THEN
                                                                  EXIT;

                                                                IF CurrFieldNo <> 0 THEN
                                                                  IF NOT CONFIRM(Text001,FALSE,FIELDCAPTION("Work Center No."))
                                                                  THEN BEGIN
                                                                    "Work Center No." := xRec."Work Center No.";
                                                                    EXIT;
                                                                  END;

                                                                Window.OPEN(
                                                                  Text002 +
                                                                  Text003 +
                                                                  Text004 +
                                                                  Text006);

                                                                i := 0;
                                                                NoOfRecords := CalendarEntry.COUNT;
                                                                IF CalendarEntry.FIND('-') THEN
                                                                  REPEAT
                                                                    i := i + 1;
                                                                    Window.UPDATE(1,i);
                                                                    Window.UPDATE(2,ROUND(i / NoOfRecords * 10000,1));
                                                                    CalendarEntry.VALIDATE("Work Center No.","Work Center No.");
                                                                    CalendarEntry.MODIFY;
                                                                  UNTIL CalendarEntry.NEXT = 0;

                                                                i := 0;
                                                                CalAbsentEntry.SETCURRENTKEY("Capacity Type","No.");
                                                                CalAbsentEntry.SETRANGE("Capacity Type",CalendarEntry."Capacity Type"::"Machine Center");
                                                                CalAbsentEntry.SETRANGE("No.","No.");
                                                                NoOfRecords := CalAbsentEntry.COUNT;
                                                                IF CalAbsentEntry.FIND('-') THEN
                                                                  REPEAT
                                                                    i := i + 1;
                                                                    Window.UPDATE(3,i);
                                                                    Window.UPDATE(4,ROUND(i / NoOfRecords * 10000,1));
                                                                    CalAbsentEntry.VALIDATE("Work Center No.","Work Center No.");
                                                                    CalAbsentEntry.MODIFY;
                                                                  UNTIL CalAbsentEntry.NEXT = 0;

                                                                i := 0;
                                                                ProdOrderCapNeed.SETCURRENTKEY(Type,"No.");
                                                                ProdOrderCapNeed.SETRANGE(Type,ProdOrderCapNeed.Type::"Machine Center");
                                                                ProdOrderCapNeed.SETRANGE("No.","No.");
                                                                NoOfRecords := ProdOrderCapNeed.COUNT;
                                                                IF ProdOrderCapNeed.FIND('-') THEN
                                                                  REPEAT
                                                                    i := i + 1;
                                                                    Window.UPDATE(7,i);
                                                                    Window.UPDATE(8,ROUND(i / NoOfRecords * 10000,1));
                                                                    ProdOrderCapNeed.VALIDATE("Work Center No.","Work Center No.");
                                                                    ProdOrderCapNeed.MODIFY;
                                                                  UNTIL ProdOrderCapNeed.NEXT = 0;

                                                                MODIFY;

                                                                RtngLine.SETCURRENTKEY(Type,"No.");
                                                                RtngLine.SETRANGE(Type,RtngLine.Type::"Machine Center");
                                                                RtngLine.SETRANGE("No.","No.");
                                                                IF RtngLine.FIND('-') THEN
                                                                  REPEAT
                                                                    RtngLine.VALIDATE("Work Center No.","Work Center No.");
                                                                    RtngLine.MODIFY;
                                                                  UNTIL RtngLine.NEXT = 0;

                                                                PlanningRtngLine.SETCURRENTKEY(Type,"No.");
                                                                PlanningRtngLine.SETRANGE(Type,PlanningRtngLine.Type::"Machine Center");
                                                                PlanningRtngLine.SETRANGE("No.","No.");
                                                                IF PlanningRtngLine.FIND('-') THEN
                                                                  REPEAT
                                                                    PlanningRtngLine.VALIDATE("Work Center No.","Work Center No.");
                                                                    PlanningRtngLine.MODIFY;
                                                                  UNTIL PlanningRtngLine.NEXT = 0;

                                                                ProdOrderRtngLine.SETCURRENTKEY(Type,"No.");
                                                                ProdOrderRtngLine.SETRANGE(Type,PlanningRtngLine.Type::"Machine Center");
                                                                ProdOrderRtngLine.SETRANGE("No.","No.");
                                                                IF ProdOrderRtngLine.FIND('-') THEN
                                                                  REPEAT
                                                                    ProdOrderRtngLine.VALIDATE("Work Center No.","Work Center No.");
                                                                    ProdOrderRtngLine.MODIFY;
                                                                  UNTIL ProdOrderRtngLine.NEXT = 0;

                                                                Window.CLOSE;
                                                              END;

                                                   CaptionML=[ENU=Work Center No.;
                                                              NOR=Arbeidssenternr.] }
    { 19  ;   ;Direct Unit Cost    ;Decimal       ;OnValidate=BEGIN
                                                                VALIDATE("Indirect Cost %");
                                                              END;

                                                   CaptionML=[ENU=Direct Unit Cost;
                                                              NOR=Direkte enhetskost];
                                                   MinValue=0;
                                                   AutoFormatType=2 }
    { 20  ;   ;Indirect Cost %     ;Decimal       ;OnValidate=BEGIN
                                                                GetGLSetup;
                                                                "Unit Cost" :=
                                                                  ROUND(
                                                                    "Direct Unit Cost" * (1 + "Indirect Cost %" / 100) + "Overhead Rate",
                                                                    GLSetup."Unit-Amount Rounding Precision");
                                                              END;

                                                   CaptionML=[ENU=Indirect Cost %;
                                                              NOR=Indirekte kost-%];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
    { 21  ;   ;Unit Cost           ;Decimal       ;OnValidate=BEGIN
                                                                GetGLSetup;
                                                                "Direct Unit Cost" :=
                                                                  ROUND(("Unit Cost" - "Overhead Rate") / (1 + "Indirect Cost %" / 100),
                                                                    GLSetup."Unit-Amount Rounding Precision");
                                                              END;

                                                   CaptionML=[ENU=Unit Cost;
                                                              NOR=Enhetskost];
                                                   DecimalPlaces=2:5;
                                                   MinValue=0;
                                                   AutoFormatType=2 }
    { 22  ;   ;Queue Time          ;Decimal       ;CaptionML=[ENU=Queue Time;
                                                              NOR=K›tid];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
    { 23  ;   ;Queue Time Unit of Meas. Code;Code10;
                                                   TableRelation="Capacity Unit of Measure";
                                                   CaptionML=[ENU=Queue Time Unit of Meas. Code;
                                                              NOR=K›tidsenhetskode] }
    { 26  ;   ;Last Date Modified  ;Date          ;CaptionML=[ENU=Last Date Modified;
                                                              NOR=Endret den];
                                                   Editable=No }
    { 27  ;   ;Comment             ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Manufacturing Comment Line" WHERE (Table Name=CONST(Machine Center),
                                                                                                         No.=FIELD(No.)));
                                                   CaptionML=[ENU=Comment;
                                                              NOR=Merknad];
                                                   Editable=No }
    { 31  ;   ;Capacity            ;Decimal       ;CaptionML=[ENU=Capacity;
                                                              NOR=Kapasitet];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
    { 32  ;   ;Efficiency          ;Decimal       ;InitValue=100;
                                                   CaptionML=[ENU=Efficiency;
                                                              NOR=Effektivitet];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
    { 33  ;   ;Maximum Efficiency  ;Decimal       ;CaptionML=[ENU=Maximum Efficiency;
                                                              NOR=Maks. effektivitet];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
    { 34  ;   ;Minimum Efficiency  ;Decimal       ;CaptionML=[ENU=Minimum Efficiency;
                                                              NOR=Min. effektivitet];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
    { 38  ;   ;Blocked             ;Boolean       ;CaptionML=[ENU=Blocked;
                                                              NOR=Sperret] }
    { 39  ;   ;Date Filter         ;Date          ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Date Filter;
                                                              NOR=Datofilter] }
    { 40  ;   ;Work Shift Filter   ;Code10        ;FieldClass=FlowFilter;
                                                   TableRelation="Work Shift";
                                                   CaptionML=[ENU=Work Shift Filter;
                                                              NOR=Arbeidsskiftfilter] }
    { 41  ;   ;Capacity (Total)    ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Calendar Entry"."Capacity (Total)" WHERE (Capacity Type=CONST(Machine Center),
                                                                                                              No.=FIELD(No.),
                                                                                                              Work Shift Code=FIELD(Work Shift Filter),
                                                                                                              Date=FIELD(Date Filter)));
                                                   CaptionML=[ENU=Capacity (Total);
                                                              NOR=Kapasitet (total)];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 42  ;   ;Capacity (Effective);Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Calendar Entry"."Capacity (Effective)" WHERE (Capacity Type=CONST(Machine Center),
                                                                                                                  No.=FIELD(No.),
                                                                                                                  Work Shift Code=FIELD(Work Shift Filter),
                                                                                                                  Date=FIELD(Date Filter)));
                                                   CaptionML=[ENU=Capacity (Effective);
                                                              NOR=Kapasitet (effektiv)];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 44  ;   ;Prod. Order Need (Qty.);Decimal    ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Prod. Order Capacity Need"."Allocated Time" WHERE (Type=CONST(Machine Center),
                                                                                                                       No.=FIELD(No.),
                                                                                                                       Status=FIELD(Prod. Order Status Filter),
                                                                                                                       Date=FIELD(Date Filter),
                                                                                                                       Requested Only=CONST(No)));
                                                   CaptionML=[ENU=Prod. Order Need (Qty.);
                                                              NOR=Prod.ordrebehov (ant.)];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 45  ;   ;Prod. Order Need Amount;Decimal    ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Prod. Order Routing Line"."Expected Operation Cost Amt." WHERE (Type=CONST(Machine Center),
                                                                                                                                    No.=FIELD(No.),
                                                                                                                                    Status=FIELD(Prod. Order Status Filter)));
                                                   CaptionML=[ENU=Prod. Order Need Amount;
                                                              NOR=Prod.ordrebehov - bel›p];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 47  ;   ;Prod. Order Status Filter;Option   ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Prod. Order Status Filter;
                                                              NOR=Prod.ordrestatusfilter];
                                                   OptionCaptionML=[ENU=Simulated,Planned,Firm Planned,Released,Finished;
                                                                    NOR=Simulert,Planlagt,Fast planlagt,Frigitt,Ferdig];
                                                   OptionString=Simulated,Planned,Firm Planned,Released,Finished }
    { 50  ;   ;Setup Time          ;Decimal       ;CaptionML=[ENU=Setup Time;
                                                              NOR=Oppstillingstid];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
    { 52  ;   ;Wait Time           ;Decimal       ;CaptionML=[ENU=Wait Time;
                                                              NOR=Ventetid];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
    { 53  ;   ;Move Time           ;Decimal       ;CaptionML=[ENU=Move Time;
                                                              NOR=Transporttid];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
    { 54  ;   ;Fixed Scrap Quantity;Decimal       ;CaptionML=[ENU=Fixed Scrap Quantity;
                                                              NOR=Fast vrakantall];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
    { 55  ;   ;Scrap %             ;Decimal       ;CaptionML=[ENU=Scrap %;
                                                              NOR=Vrak-%];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
    { 56  ;   ;Setup Time Unit of Meas. Code;Code10;
                                                   TableRelation="Capacity Unit of Measure";
                                                   CaptionML=[ENU=Setup Time Unit of Meas. Code;
                                                              NOR=Oppstillingstid - enhetskode] }
    { 57  ;   ;Wait Time Unit of Meas. Code;Code10;TableRelation="Capacity Unit of Measure";
                                                   CaptionML=[ENU=Wait Time Unit of Meas. Code;
                                                              NOR=Ventetid - enhetskode] }
    { 58  ;   ;Send-Ahead Quantity ;Decimal       ;CaptionML=[ENU=Send-Ahead Quantity;
                                                              NOR=Overlappantall];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
    { 59  ;   ;Move Time Unit of Meas. Code;Code10;TableRelation="Capacity Unit of Measure";
                                                   CaptionML=[ENU=Move Time Unit of Meas. Code;
                                                              NOR=Transporttid - enhetskode] }
    { 60  ;   ;Flushing Method     ;Option        ;InitValue=Manual;
                                                   CaptionML=[ENU=Flushing Method;
                                                              NOR=Trekkmetode];
                                                   OptionCaptionML=[ENU=Manual,Forward,Backward;
                                                                    NOR=Manuell,Forlengs,Baklengs];
                                                   OptionString=Manual,Forward,Backward }
    { 62  ;   ;Minimum Process Time;Decimal       ;CaptionML=[ENU=Minimum Process Time;
                                                              NOR=Minimum behandlingstid];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
    { 63  ;   ;Maximum Process Time;Decimal       ;CaptionML=[ENU=Maximum Process Time;
                                                              NOR=Maksimal behandlingstid];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
    { 64  ;   ;Concurrent Capacities;Decimal      ;CaptionML=[ENU=Concurrent Capacities;
                                                              NOR=Samtidige kapasiteter];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
    { 65  ;   ;Item Filter         ;Code20        ;FieldClass=FlowFilter;
                                                   TableRelation=Item;
                                                   CaptionML=[ENU=Item Filter;
                                                              NOR=Varefilter] }
    { 66  ;   ;Stop Code Filter    ;Code10        ;FieldClass=FlowFilter;
                                                   TableRelation=Stop;
                                                   CaptionML=[ENU=Stop Code Filter;
                                                              NOR=Stoppkodefilter] }
    { 67  ;   ;Scrap Code Filter   ;Code10        ;FieldClass=FlowFilter;
                                                   TableRelation=Scrap;
                                                   CaptionML=[ENU=Scrap Code Filter;
                                                              NOR=Vrakkodefilter] }
    { 80  ;   ;No. Series          ;Code10        ;TableRelation="No. Series";
                                                   CaptionML=[ENU=No. Series;
                                                              NOR=Nr.serie];
                                                   Editable=No }
    { 81  ;   ;Overhead Rate       ;Decimal       ;OnValidate=BEGIN
                                                                VALIDATE("Indirect Cost %");
                                                              END;

                                                   CaptionML=[ENU=Overhead Rate;
                                                              NOR=Sats for indirekte kostnader];
                                                   AutoFormatType=2 }
    { 82  ;   ;Gen. Prod. Posting Group;Code10    ;TableRelation="Gen. Product Posting Group";
                                                   CaptionML=[ENU=Gen. Prod. Posting Group;
                                                              NOR=Bokf›ringsgruppe - vare] }
    { 83  ;   ;County              ;Text30        ;CaptionML=[ENU=County;
                                                              NOR=Fylke/delstat] }
    { 84  ;   ;Country/Region Code ;Code10        ;TableRelation=Country/Region;
                                                   CaptionML=[ENU=Country/Region Code;
                                                              NOR=Lands-/regionkode] }
    { 7300;   ;Location Code       ;Code10        ;TableRelation=Location.Code WHERE (Use As In-Transit=CONST(No),
                                                                                      Bin Mandatory=CONST(Yes));
                                                   OnValidate=VAR
                                                                WorkCenter@1000 : Record 99000754;
                                                                AutoUpdate@1001 : Boolean;
                                                              BEGIN
                                                                IF "Location Code" <> xRec."Location Code" THEN BEGIN
                                                                  IF ("Work Center No." = '') AND ("Location Code" <> '') THEN
                                                                    ERROR(Text008,FIELDCAPTION("Location Code"),TABLECAPTION,WorkCenter.TABLECAPTION);

                                                                  IF "Open Shop Floor Bin Code" <> '' THEN BEGIN
                                                                    IF ConfirmAutoRemovalOfBinCode(AutoUpdate) THEN
                                                                      VALIDATE("Open Shop Floor Bin Code",'')
                                                                    ELSE
                                                                      TESTFIELD("Open Shop Floor Bin Code",'');
                                                                  END;
                                                                  IF "To-Production Bin Code" <> '' THEN BEGIN
                                                                    IF ConfirmAutoRemovalOfBinCode(AutoUpdate) THEN
                                                                      VALIDATE("To-Production Bin Code",'')
                                                                    ELSE
                                                                      TESTFIELD("To-Production Bin Code",'');
                                                                  END;
                                                                  IF "From-Production Bin Code" <> '' THEN BEGIN
                                                                    IF ConfirmAutoRemovalOfBinCode(AutoUpdate) THEN
                                                                      VALIDATE("From-Production Bin Code",'')
                                                                    ELSE
                                                                      TESTFIELD("From-Production Bin Code",'');
                                                                  END;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Location Code;
                                                              NOR=Lokasjonskode];
                                                   Editable=No }
    { 7301;   ;Open Shop Floor Bin Code;Code20    ;TableRelation=Bin.Code WHERE (Location Code=FIELD(Location Code));
                                                   OnValidate=VAR
                                                                WhseIntegrationMgt@1000 : Codeunit 7317;
                                                              BEGIN
                                                                WhseIntegrationMgt.CheckBinCode("Location Code",
                                                                  "Open Shop Floor Bin Code",
                                                                  FIELDCAPTION("Open Shop Floor Bin Code"),
                                                                  DATABASE::"Machine Center","No.");
                                                              END;

                                                   CaptionML=[ENU=Open Shop Floor Bin Code;
                                                              NOR=pen prod.hyllekode] }
    { 7302;   ;To-Production Bin Code;Code20      ;TableRelation=Bin.Code WHERE (Location Code=FIELD(Location Code));
                                                   OnValidate=VAR
                                                                WhseIntegrationMgt@1000 : Codeunit 7317;
                                                              BEGIN
                                                                WhseIntegrationMgt.CheckBinCode("Location Code",
                                                                  "To-Production Bin Code",
                                                                  FIELDCAPTION("To-Production Bin Code"),
                                                                  DATABASE::"Machine Center","No.");
                                                              END;

                                                   CaptionML=[ENU=To-Production Bin Code;
                                                              NOR=Til-Hyllekode for produksjon] }
    { 7303;   ;From-Production Bin Code;Code20    ;TableRelation=Bin.Code WHERE (Location Code=FIELD(Location Code));
                                                   OnValidate=VAR
                                                                WhseIntegrationMgt@1000 : Codeunit 7317;
                                                              BEGIN
                                                                WhseIntegrationMgt.CheckBinCode("Location Code",
                                                                  "From-Production Bin Code",
                                                                  FIELDCAPTION("From-Production Bin Code"),
                                                                  DATABASE::"Machine Center","No.");
                                                              END;

                                                   CaptionML=[ENU=From-Production Bin Code;
                                                              NOR=Fra-Hyllekode for produksjon] }
    { 83001;  ;Show in OPC         ;Boolean       ;CaptionML=[ENU=Show in OPC;
                                                              NOR=Vises i OPC];
                                                   Description=OPC }
    { 83002;  ;Clocking            ;Boolean       ;CaptionML=[ENU=Clocking;
                                                              NOR=M›nstring];
                                                   Description=OPC }
    { 83003;  ;Employee No.        ;Code20        ;CaptionML=[ENU=Employee No. (H and L);
                                                              NOR=Ansattnr. (H og L)];
                                                   Description=OPC }
    { 83004;  ;Time Registrations  ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("OPC Time Register".Quantity WHERE (Machine Center=FIELD(No.),
                                                                                                       Start Date=FIELD(Date Filter)));
                                                   CaptionML=[ENU=Time Registrations;
                                                              NOR=Timeregistrering];
                                                   Description=OPC }
    { 83005;  ;Earliest Time Reg.  ;Time          ;FieldClass=FlowField;
                                                   CalcFormula=Min("OPC Time Register"."Start Time" WHERE (Machine Center=FIELD(No.),
                                                                                                           Start Date=FIELD(Date Filter)));
                                                   Description=OPC }
    { 83006;  ;Latest Time Reg.    ;Time          ;FieldClass=FlowField;
                                                   CalcFormula=Max("OPC Time Register"."End Time" WHERE (Machine Center=FIELD(No.),
                                                                                                         Start Date=FIELD(Date Filter)));
                                                   Description=OPC }
    { 83007;  ;Deduct Lunch        ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("OPC Time Register" WHERE (Deduction Type=CONST(Lunch),
                                                                                                Start Date=FIELD(Date Filter),
                                                                                                Machine Center=FIELD(No.)));
                                                   CaptionML=[ENU=Deduct Lunch;
                                                              NOR=Fradrag lunsj];
                                                   Description=OPC }
    { 83008;  ;Invoiced Qty.       ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Capacity Ledger Entry"."Invoiced Quantity" WHERE (No.=FIELD(No.),
                                                                                                                      Type=FILTER(Machine Center),
                                                                                                                      Posting Date=FIELD(Date Filter)));
                                                   Description=OPC }
    { 83009;  ;Birth Date          ;Date          ;CaptionML=[ENU=Birth Date;
                                                              NOR=F›dselsdato];
                                                   Description=OPC }
    { 83010;  ;Allow OPC Move      ;Boolean       ;CaptionML=NOR=Tillat flytting av komponenter via OPC;
                                                   Description=OPC }
  }
  KEYS
  {
    {    ;No.                                     ;Clustered=Yes }
    {    ;Search Name                              }
    {    ;Work Center No.                          }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      Text000@1000 : TextConst 'ENU=The Machine Center is being used on production orders.;NOR=Maskinsenteret brukes i forbindelse med produksjonsordrer.';
      Text001@1001 : TextConst 'ENU=Do you want to change %1?;NOR=Vil du endre %1?';
      Text002@1002 : TextConst 'ENU=Work Center No. is corrected on\\;NOR=Arbeidssenternr. er korrigert\\';
      Text003@1003 : TextConst 'ENU=Calendar Entry    #1###### @2@@@@@@@@@@@@@\;NOR=Kalenderpost      #1###### @2@@@@@@@@@@@@@\';
      Text004@1004 : TextConst 'ENU=Calendar Absent.  #3###### @4@@@@@@@@@@@@@\;NOR=Kalenderfrav‘r    #3###### @4@@@@@@@@@@@@@\';
      Text006@1005 : TextConst 'ENU=Prod. Order Need  #7###### @8@@@@@@@@@@@@@;NOR=Prod.ordrebehov   #7###### @8@@@@@@@@@@@@@';
      PostCode@1020 : Record 225;
      MfgSetup@1006 : Record 99000765;
      MachineCenter@1007 : Record 99000758;
      CalendarEntry@1008 : Record 99000757;
      CalAbsentEntry@1009 : Record 99000760;
      MfgCommentLine@1010 : Record 99000770;
      RtngLine@1011 : Record 99000764;
      GLSetup@1017 : Record 98;
      NoSeriesMgt@1013 : Codeunit 396;
      Window@1014 : Dialog;
      i@1015 : Integer;
      NoOfRecords@1016 : Integer;
      GLSetupRead@1018 : Boolean;
      Text007@1019 : TextConst '@@@="%1 = Table caption; %2 = Field Value; %3 = Table Caption";ENU=You cannot delete %1 %2 because there is at least one %3 associated with it.;NOR=Du kan ikke slette %1 %2 fordi det finnes minst ‚n %3 tilknyttet.';
      Text008@1021 : TextConst 'ENU=You cannot change the %1 on %2 unless it is linked to a %3.;NOR=Du kan ikke endre %1 p† %2 med mindre koblet til %3.';
      Text009@1022 : TextConst 'ENU=If you change the %1, then all bin codes on the %2 will be removed. Are you sure that you want to continue?;NOR=Hvis du endrer %1, vil alle hyllekoder p† %2 bli fjernet. Er du sikker p† at du vil fortsette ?';

    PROCEDURE AssistEdit@2(OldMachineCenter@1000 : Record 99000758) : Boolean;
    BEGIN
      WITH MachineCenter DO BEGIN
        MachineCenter := Rec;
        MfgSetup.GET;
        MfgSetup.TESTFIELD("Machine Center Nos.");
        IF NoSeriesMgt.SelectSeries(MfgSetup."Machine Center Nos.",OldMachineCenter."No. Series","No. Series") THEN BEGIN
          NoSeriesMgt.SetSeries("No.");
          Rec := MachineCenter;
          EXIT(TRUE);
        END;
      END;
    END;

    LOCAL PROCEDURE GetGLSetup@14();
    BEGIN
      IF NOT GLSetupRead THEN
        GLSetup.GET;
      GLSetupRead := TRUE;
    END;

    LOCAL PROCEDURE ConfirmAutoRemovalOfBinCode@1(VAR AutoUpdate@1000 : Boolean) : Boolean;
    BEGIN
      IF AutoUpdate THEN
        EXIT(TRUE);

      IF CONFIRM(Text009,FALSE,FIELDCAPTION("Location Code"),TABLECAPTION) THEN
        AutoUpdate := TRUE;

      EXIT(AutoUpdate);
    END;

    PROCEDURE GetBinCode@9(UseFlushingMethod@1000 : Boolean;FlushingMethod@1001 : 'Manual,Forward,Backward,Pick + Forward,Pick + Backward') : Code[20];
    BEGIN
      IF NOT UseFlushingMethod THEN
        EXIT("From-Production Bin Code");

      CASE FlushingMethod OF
        FlushingMethod::Manual,
        FlushingMethod::"Pick + Forward",
        FlushingMethod::"Pick + Backward":
          EXIT("To-Production Bin Code");
        FlushingMethod::Forward,
        FlushingMethod::Backward:
          EXIT("Open Shop Floor Bin Code");
      END;
    END;

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 04.11.09 HHE Opprettet feltene: 83001 "Show in OPC", 83470 Clocking, 83471 "Employee No."
      02. 21.01.10 BVM Nytt felt: Flowfelt Invoiced Qty, .
      03. 17.12.10 HHE Nytt felt: Birth date (›nsket av FRSK. Brukes i m›nstringstider->l›nnsgrunnlag)
      04. 04.03.10 HHE Nye  felt: Timeregistrations (brukes for summering av faktisk m›nstringstid)
                                  "Earilest start time" (tidspkt. for innstempling)
                                  "Latest end time" (tidspkt. for utstempling)
      05. 19.03.10 HHE Nytt felt "Deduct - Lunch" (for † se om det finnes fradrag-lunch for dagen)
    }
    END.
  }
}

OBJECT Table 99000761 Stop
{
  OBJECT-PROPERTIES
  {
    Date=28.09.17;
    Time=12:01:11;
    Modified=Yes;
    Version List=NAVW17.00,OPC6.01;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Stop;
               NOR=Stopp];
    LookupPageID=Page99000779;
    DrillDownPageID=Page99000779;
  }
  FIELDS
  {
    { 1   ;   ;Code                ;Code10        ;CaptionML=[ENU=Code;
                                                              NOR=Kode];
                                                   NotBlank=Yes }
    { 2   ;   ;Description         ;Text50        ;CaptionML=[ENU=Description;
                                                              NOR=Beskrivelse] }
    { 83001;  ;Indirect Time       ;Boolean       ;CaptionML=[ENU=OPC Indirect Time;
                                                              NOR=OPC indirekte tid] }
  }
  KEYS
  {
    {    ;Code                                    ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 19.10.09 hhe Nytt felt = 83001 "OPC Indirect Time"
    }
    END.
  }
}

OBJECT Report 50021 Report50021
{
  OBJECT-PROPERTIES
  {
    Date=20.09.17;
    Time=15:17:21;
    Modified=Yes;
    Version List=OPC6.01;
  }
  PROPERTIES
  {
    CaptionML=[ENU=OPC Indirect Time;
               NOR=OPC Indirekte tid];
  }
  DATASET
  {
    { 1101103000;;DataItem;                  ;
               DataItemTable=Table5832;
               DataItemTableView=SORTING(Document No.,Stop Code,No.,Posting Date)
                                 WHERE(Document No.=CONST(IND.TID));
               OnPreDataItem=BEGIN
                               LastFieldNo := FIELDNO("Stop Code");
                             END;

               OnAfterGetRecord=BEGIN
                                  //hhe 17.21.09->
                                  IF MachCenter.GET("No.") THEN BEGIN
                                  END;
                                  //he 17.12.09 <-
                                END;

               ReqFilterFields=Stop Code,Posting Date,Type,No. }

    { 1101103001;1;Column;C_INC_ReportTitle  ;
               SourceExpr=C_INC_ReportTitle }

    { 1101103002;1;Column;COMPANYNAME        ;
               SourceExpr=COMPANYNAME }

    { 1101103003;1;Column;TODAY              ;
               SourceExpr=FORMAT(TODAY,0,4) }

    { 1101103005;1;Column;C_INC_PageCap      ;
               SourceExpr=C_INC_PageCap }

    { 1101103004;1;Column;USERID             ;
               SourceExpr=USERID }

    { 1101103006;1;Column;C_INC_Stoppkode    ;
               SourceExpr=C_INC_Stoppkode }

    { 1101103007;1;Column;C_INC_QtyHours     ;
               SourceExpr=C_INC_QtyHours }

    { 1101103008;1;Column;StopCode           ;
               SourceExpr="Stop Code" }

    { 1101103009;1;Column;DocumentNo         ;
               SourceExpr="Document No." }

    { 1101103010;1;Column;PostingDate        ;
               SourceExpr="Posting Date" }

    { 1101103011;1;Column;No                 ;
               SourceExpr="No." }

    { 1101103012;1;Column;MachCenterName     ;
               SourceExpr=MachCenter.Name }

    { 1101103013;1;Column;Quantity           ;
               SourceExpr=Quantity }

    { 1101103014;1;Column;SumString          ;
               SourceExpr='Sum for ' + "Stop Code" }

    { 1101103015;1;Column;C_INC_TotalQtyHours;
               SourceExpr=C_INC_TotalQtyHours }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      LastFieldNo@1101103002 : Integer;
      FooterPrinted@1101103001 : Boolean;
      MachCenter@1101103000 : Record 99000758;
      TotalFor@1101103003 : TextConst 'NOR="Sum for "';
      C_INC_ReportTitle@1101103004 : TextConst 'ENU=Capacity Ledger Entry;NOR=Indirekte tid';
      C_INC_PageCap@1101103005 : TextConst 'ENU=Page %1 of %2;NOR=Side %1 av %2';
      C_INC_Stoppkode@1101103006 : TextConst 'NOR=Stoppkode';
      C_INC_QtyHours@1101103007 : TextConst 'NOR=Antall timer';
      C_INC_TotalQtyHours@1101103008 : TextConst 'NOR=TOTALT ANTALL TIMER';

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. des2009  hhe Opprettet rapporten
      02. 24.03.10 hhe Ny sorteringsn›kkel " " (skaper Sub-totaler til Mette sin rapport: sum tid pr. ansatt for Ind.tid.kode)
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner" xmlns:cl="http://schemas.microsoft.com/sqlserver/reporting/2010/01/componentdefinition" xmlns="http://schemas.microsoft.com/sqlserver/reporting/2010/01/reportdefinition">
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
      <rd:DataSourceID>0993dfdc-018c-4e90-a154-8503f4cd1ed4</rd:DataSourceID>
    </DataSource>
  </DataSources>
  <DataSets>
    <DataSet Name="DataSet_Result">
      <Query>
        <DataSourceName>DataSource</DataSourceName>
        <CommandText />
      </Query>
      <Fields>
        <Field Name="C_INC_ReportTitle">
          <DataField>C_INC_ReportTitle</DataField>
        </Field>
        <Field Name="COMPANYNAME">
          <DataField>COMPANYNAME</DataField>
        </Field>
        <Field Name="TODAY">
          <DataField>TODAY</DataField>
        </Field>
        <Field Name="C_INC_PageCap">
          <DataField>C_INC_PageCap</DataField>
        </Field>
        <Field Name="USERID">
          <DataField>USERID</DataField>
        </Field>
        <Field Name="C_INC_Stoppkode">
          <DataField>C_INC_Stoppkode</DataField>
        </Field>
        <Field Name="C_INC_QtyHours">
          <DataField>C_INC_QtyHours</DataField>
        </Field>
        <Field Name="StopCode">
          <DataField>StopCode</DataField>
        </Field>
        <Field Name="DocumentNo">
          <DataField>DocumentNo</DataField>
        </Field>
        <Field Name="PostingDate">
          <DataField>PostingDate</DataField>
        </Field>
        <Field Name="No">
          <DataField>No</DataField>
        </Field>
        <Field Name="MachCenterName">
          <DataField>MachCenterName</DataField>
        </Field>
        <Field Name="Quantity">
          <DataField>Quantity</DataField>
        </Field>
        <Field Name="QuantityFormat">
          <DataField>QuantityFormat</DataField>
        </Field>
        <Field Name="SumString">
          <DataField>SumString</DataField>
        </Field>
        <Field Name="C_INC_TotalQtyHours">
          <DataField>C_INC_TotalQtyHours</DataField>
        </Field>
      </Fields>
      <rd:DataSetInfo>
        <rd:DataSetName>DataSet</rd:DataSetName>
        <rd:SchemaPath>Report.xsd</rd:SchemaPath>
        <rd:TableName>Result</rd:TableName>
      </rd:DataSetInfo>
    </DataSet>
  </DataSets>
  <ReportSections>
    <ReportSection>
      <Body>
        <ReportItems>
          <Tablix Name="Tablix1">
            <TablixBody>
              <TablixColumns>
                <TablixColumn>
                  <Width>19cm</Width>
                </TablixColumn>
              </TablixColumns>
              <TablixRows>
                <TablixRow>
                  <Height>1.74174cm</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Rectangle Name="Rectangle1">
                          <ReportItems>
                            <Tablix Name="Tablix2">
                              <TablixBody>
                                <TablixColumns>
                                  <TablixColumn>
                                    <Width>0.64792cm</Width>
                                  </TablixColumn>
                                  <TablixColumn>
                                    <Width>0.64792cm</Width>
                                  </TablixColumn>
                                </TablixColumns>
                                <TablixRows>
                                  <TablixRow>
                                    <Height>0.15021cm</Height>
                                    <TablixCells>
                                      <TablixCell>
                                        <CellContents>
                                          <Textbox Name="Textbox1">
                                            <CanGrow>true</CanGrow>
                                            <KeepTogether>true</KeepTogether>
                                            <Paragraphs>
                                              <Paragraph>
                                                <TextRuns>
                                                  <TextRun>
                                                    <Value EvaluationMode="Auto" />
                                                    <Style />
                                                  </TextRun>
                                                </TextRuns>
                                                <Style />
                                              </Paragraph>
                                            </Paragraphs>
                                            <rd:DefaultName>Textbox1</rd:DefaultName>
                                            <Visibility>
                                              <Hidden>=Code.SetData(
Cstr(Fields!C_INC_ReportTitle.Value) + Chr(177) +
Cstr(Fields!COMPANYNAME.Value) + Chr(177) +
Cstr(Fields!TODAY.Value) + Chr(177) +
Cstr(Fields!C_INC_PageCap.Value) + Chr(177) +
Cstr(Fields!USERID.Value)
,1)</Hidden>
                                            </Visibility>
                                            <Style>
                                              <Border>
                                                <Color>LightGrey</Color>
                                              </Border>
                                              <PaddingLeft>2pt</PaddingLeft>
                                              <PaddingRight>2pt</PaddingRight>
                                              <PaddingTop>2pt</PaddingTop>
                                              <PaddingBottom>2pt</PaddingBottom>
                                            </Style>
                                          </Textbox>
                                        </CellContents>
                                      </TablixCell>
                                      <TablixCell>
                                        <CellContents>
                                          <Textbox Name="Textbox5">
                                            <CanGrow>true</CanGrow>
                                            <KeepTogether>true</KeepTogether>
                                            <Paragraphs>
                                              <Paragraph>
                                                <TextRuns>
                                                  <TextRun>
                                                    <Value EvaluationMode="Auto" />
                                                    <Style />
                                                  </TextRun>
                                                </TextRuns>
                                                <Style />
                                              </Paragraph>
                                            </Paragraphs>
                                            <rd:DefaultName>Textbox5</rd:DefaultName>
                                            <Style>
                                              <Border>
                                                <Color>LightGrey</Color>
                                              </Border>
                                              <PaddingLeft>2pt</PaddingLeft>
                                              <PaddingRight>2pt</PaddingRight>
                                              <PaddingTop>2pt</PaddingTop>
                                              <PaddingBottom>2pt</PaddingBottom>
                                            </Style>
                                          </Textbox>
                                        </CellContents>
                                      </TablixCell>
                                    </TablixCells>
                                  </TablixRow>
                                </TablixRows>
                              </TablixBody>
                              <TablixColumnHierarchy>
                                <TablixMembers>
                                  <TablixMember />
                                  <TablixMember />
                                </TablixMembers>
                              </TablixColumnHierarchy>
                              <TablixRowHierarchy>
                                <TablixMembers>
                                  <TablixMember />
                                </TablixMembers>
                              </TablixRowHierarchy>
                              <Height>0.15021cm</Height>
                              <Width>1.29583cm</Width>
                              <Style>
                                <Border>
                                  <Style>None</Style>
                                </Border>
                              </Style>
                            </Tablix>
                            <Tablix Name="Tablix3">
                              <TablixBody>
                                <TablixColumns>
                                  <TablixColumn>
                                    <Width>1.91892cm</Width>
                                  </TablixColumn>
                                  <TablixColumn>
                                    <Width>1.91892cm</Width>
                                  </TablixColumn>
                                  <TablixColumn>
                                    <Width>1.91892cm</Width>
                                  </TablixColumn>
                                  <TablixColumn>
                                    <Width>2.21892cm</Width>
                                  </TablixColumn>
                                  <TablixColumn>
                                    <Width>3.71892cm</Width>
                                  </TablixColumn>
                                  <TablixColumn>
                                    <Width>2.91892cm</Width>
                                  </TablixColumn>
                                </TablixColumns>
                                <TablixRows>
                                  <TablixRow>
                                    <Height>0.423cm</Height>
                                    <TablixCells>
                                      <TablixCell>
                                        <CellContents>
                                          <Textbox Name="C_INC_Stoppkode">
                                            <CanGrow>true</CanGrow>
                                            <KeepTogether>true</KeepTogether>
                                            <Paragraphs>
                                              <Paragraph>
                                                <TextRuns>
                                                  <TextRun>
                                                    <Value EvaluationMode="Auto">=Fields!C_INC_Stoppkode.Value</Value>
                                                    <Style>
                                                      <FontSize>9pt</FontSize>
                                                      <FontWeight>Bold</FontWeight>
                                                    </Style>
                                                  </TextRun>
                                                </TextRuns>
                                                <Style />
                                              </Paragraph>
                                            </Paragraphs>
                                            <rd:DefaultName>C_INC_Stoppkode</rd:DefaultName>
                                            <Style>
                                              <Border>
                                                <Style>None</Style>
                                              </Border>
                                              <PaddingLeft>2pt</PaddingLeft>
                                              <PaddingRight>2pt</PaddingRight>
                                              <PaddingTop>2pt</PaddingTop>
                                              <PaddingBottom>2pt</PaddingBottom>
                                            </Style>
                                          </Textbox>
                                          <ColSpan>2</ColSpan>
                                        </CellContents>
                                      </TablixCell>
                                      <TablixCell />
                                      <TablixCell>
                                        <CellContents>
                                          <Textbox Name="StopCode">
                                            <CanGrow>true</CanGrow>
                                            <KeepTogether>true</KeepTogether>
                                            <Paragraphs>
                                              <Paragraph>
                                                <TextRuns>
                                                  <TextRun>
                                                    <Value EvaluationMode="Auto">=Fields!StopCode.Value</Value>
                                                    <Style>
                                                      <FontSize>9pt</FontSize>
                                                      <FontWeight>Bold</FontWeight>
                                                    </Style>
                                                  </TextRun>
                                                </TextRuns>
                                                <Style />
                                              </Paragraph>
                                            </Paragraphs>
                                            <rd:DefaultName>StopCode</rd:DefaultName>
                                            <Style>
                                              <Border>
                                                <Style>None</Style>
                                              </Border>
                                              <PaddingLeft>2pt</PaddingLeft>
                                              <PaddingRight>2pt</PaddingRight>
                                              <PaddingTop>2pt</PaddingTop>
                                              <PaddingBottom>2pt</PaddingBottom>
                                            </Style>
                                          </Textbox>
                                          <ColSpan>2</ColSpan>
                                        </CellContents>
                                      </TablixCell>
                                      <TablixCell />
                                      <TablixCell>
                                        <CellContents>
                                          <Textbox Name="Textbox32">
                                            <CanGrow>true</CanGrow>
                                            <KeepTogether>true</KeepTogether>
                                            <Paragraphs>
                                              <Paragraph>
                                                <TextRuns>
                                                  <TextRun>
                                                    <Value EvaluationMode="Auto" />
                                                    <Style>
                                                      <FontSize>9pt</FontSize>
                                                      <FontWeight>Bold</FontWeight>
                                                    </Style>
                                                  </TextRun>
                                                </TextRuns>
                                                <Style />
                                              </Paragraph>
                                            </Paragraphs>
                                            <rd:DefaultName>Textbox32</rd:DefaultName>
                                            <Style>
                                              <Border>
                                                <Style>None</Style>
                                              </Border>
                                              <PaddingLeft>2pt</PaddingLeft>
                                              <PaddingRight>2pt</PaddingRight>
                                              <PaddingTop>2pt</PaddingTop>
                                              <PaddingBottom>2pt</PaddingBottom>
                                            </Style>
                                          </Textbox>
                                        </CellContents>
                                      </TablixCell>
                                      <TablixCell>
                                        <CellContents>
                                          <Textbox Name="C_INC_QtyHours">
                                            <CanGrow>true</CanGrow>
                                            <KeepTogether>true</KeepTogether>
                                            <Paragraphs>
                                              <Paragraph>
                                                <TextRuns>
                                                  <TextRun>
                                                    <Value EvaluationMode="Auto">=Fields!C_INC_QtyHours.Value</Value>
                                                    <Style>
                                                      <FontSize>9pt</FontSize>
                                                      <FontWeight>Bold</FontWeight>
                                                    </Style>
                                                  </TextRun>
                                                </TextRuns>
                                                <Style />
                                              </Paragraph>
                                            </Paragraphs>
                                            <rd:DefaultName>C_INC_QtyHours</rd:DefaultName>
                                            <Style>
                                              <Border>
                                                <Style>None</Style>
                                              </Border>
                                              <PaddingLeft>2pt</PaddingLeft>
                                              <PaddingRight>2pt</PaddingRight>
                                              <PaddingTop>2pt</PaddingTop>
                                              <PaddingBottom>2pt</PaddingBottom>
                                            </Style>
                                          </Textbox>
                                        </CellContents>
                                      </TablixCell>
                                    </TablixCells>
                                  </TablixRow>
                                  <TablixRow>
                                    <Height>0.423cm</Height>
                                    <TablixCells>
                                      <TablixCell>
                                        <CellContents>
                                          <Textbox Name="DocumentNo">
                                            <CanGrow>true</CanGrow>
                                            <KeepTogether>true</KeepTogether>
                                            <Paragraphs>
                                              <Paragraph>
                                                <TextRuns>
                                                  <TextRun>
                                                    <Value EvaluationMode="Auto">=Fields!DocumentNo.Value</Value>
                                                    <Style>
                                                      <FontSize>9pt</FontSize>
                                                    </Style>
                                                  </TextRun>
                                                </TextRuns>
                                                <Style />
                                              </Paragraph>
                                            </Paragraphs>
                                            <rd:DefaultName>DocumentNo</rd:DefaultName>
                                            <Style>
                                              <Border>
                                                <Style>None</Style>
                                              </Border>
                                              <PaddingLeft>2pt</PaddingLeft>
                                              <PaddingRight>2pt</PaddingRight>
                                              <PaddingTop>2pt</PaddingTop>
                                              <PaddingBottom>2pt</PaddingBottom>
                                            </Style>
                                          </Textbox>
                                        </CellContents>
                                      </TablixCell>
                                      <TablixCell>
                                        <CellContents>
                                          <Textbox Name="StopCode1">
                                            <CanGrow>true</CanGrow>
                                            <KeepTogether>true</KeepTogether>
                                            <Paragraphs>
                                              <Paragraph>
                                                <TextRuns>
                                                  <TextRun>
                                                    <Value EvaluationMode="Auto">=Fields!StopCode.Value</Value>
                                                    <Style>
                                                      <FontSize>9pt</FontSize>
                                                    </Style>
                                                  </TextRun>
                                                </TextRuns>
                                                <Style />
                                              </Paragraph>
                                            </Paragraphs>
                                            <rd:DefaultName>StopCode1</rd:DefaultName>
                                            <Style>
                                              <Border>
                                                <Style>None</Style>
                                              </Border>
                                              <PaddingLeft>2pt</PaddingLeft>
                                              <PaddingRight>2pt</PaddingRight>
                                              <PaddingTop>2pt</PaddingTop>
                                              <PaddingBottom>2pt</PaddingBottom>
                                            </Style>
                                          </Textbox>
                                        </CellContents>
                                      </TablixCell>
                                      <TablixCell>
                                        <CellContents>
                                          <Textbox Name="PostingDate">
                                            <CanGrow>true</CanGrow>
                                            <KeepTogether>true</KeepTogether>
                                            <Paragraphs>
                                              <Paragraph>
                                                <TextRuns>
                                                  <TextRun>
                                                    <Value EvaluationMode="Auto">=Fields!PostingDate.Value</Value>
                                                    <Style>
                                                      <FontSize>9pt</FontSize>
                                                      <Format>dd.MM.yy</Format>
                                                    </Style>
                                                  </TextRun>
                                                </TextRuns>
                                                <Style />
                                              </Paragraph>
                                            </Paragraphs>
                                            <rd:DefaultName>PostingDate</rd:DefaultName>
                                            <Style>
                                              <Border>
                                                <Style>None</Style>
                                              </Border>
                                              <PaddingLeft>2pt</PaddingLeft>
                                              <PaddingRight>2pt</PaddingRight>
                                              <PaddingTop>2pt</PaddingTop>
                                              <PaddingBottom>2pt</PaddingBottom>
                                            </Style>
                                          </Textbox>
                                        </CellContents>
                                      </TablixCell>
                                      <TablixCell>
                                        <CellContents>
                                          <Textbox Name="No">
                                            <CanGrow>true</CanGrow>
                                            <KeepTogether>true</KeepTogether>
                                            <Paragraphs>
                                              <Paragraph>
                                                <TextRuns>
                                                  <TextRun>
                                                    <Value EvaluationMode="Auto">=Fields!No.Value</Value>
                                                    <Style>
                                                      <FontSize>9pt</FontSize>
                                                    </Style>
                                                  </TextRun>
                                                </TextRuns>
                                                <Style />
                                              </Paragraph>
                                            </Paragraphs>
                                            <rd:DefaultName>No</rd:DefaultName>
                                            <Style>
                                              <Border>
                                                <Style>None</Style>
                                              </Border>
                                              <PaddingLeft>2pt</PaddingLeft>
                                              <PaddingRight>2pt</PaddingRight>
                                              <PaddingTop>2pt</PaddingTop>
                                              <PaddingBottom>2pt</PaddingBottom>
                                            </Style>
                                          </Textbox>
                                        </CellContents>
                                      </TablixCell>
                                      <TablixCell>
                                        <CellContents>
                                          <Textbox Name="MachCenterName">
                                            <CanGrow>true</CanGrow>
                                            <KeepTogether>true</KeepTogether>
                                            <Paragraphs>
                                              <Paragraph>
                                                <TextRuns>
                                                  <TextRun>
                                                    <Value EvaluationMode="Auto">=Fields!MachCenterName.Value</Value>
                                                    <Style>
                                                      <FontSize>9pt</FontSize>
                                                    </Style>
                                                  </TextRun>
                                                </TextRuns>
                                                <Style />
                                              </Paragraph>
                                            </Paragraphs>
                                            <rd:DefaultName>MachCenterName</rd:DefaultName>
                                            <Style>
                                              <Border>
                                                <Style>None</Style>
                                              </Border>
                                              <PaddingLeft>2pt</PaddingLeft>
                                              <PaddingRight>2pt</PaddingRight>
                                              <PaddingTop>2pt</PaddingTop>
                                              <PaddingBottom>2pt</PaddingBottom>
                                            </Style>
                                          </Textbox>
                                        </CellContents>
                                      </TablixCell>
                                      <TablixCell>
                                        <CellContents>
                                          <Textbox Name="Quantity">
                                            <CanGrow>true</CanGrow>
                                            <KeepTogether>true</KeepTogether>
                                            <Paragraphs>
                                              <Paragraph>
                                                <TextRuns>
                                                  <TextRun>
                                                    <Value EvaluationMode="Auto">=Fields!Quantity.Value</Value>
                                                    <Style>
                                                      <FontSize>9pt</FontSize>
                                                      <Format>=Fields!QuantityFormat.Value</Format>
                                                    </Style>
                                                  </TextRun>
                                                </TextRuns>
                                                <Style />
                                              </Paragraph>
                                            </Paragraphs>
                                            <rd:DefaultName>Quantity</rd:DefaultName>
                                            <Style>
                                              <Border>
                                                <Style>None</Style>
                                              </Border>
                                              <PaddingLeft>2pt</PaddingLeft>
                                              <PaddingRight>2pt</PaddingRight>
                                              <PaddingTop>2pt</PaddingTop>
                                              <PaddingBottom>2pt</PaddingBottom>
                                            </Style>
                                          </Textbox>
                                        </CellContents>
                                      </TablixCell>
                                    </TablixCells>
                                  </TablixRow>
                                  <TablixRow>
                                    <Height>0.423cm</Height>
                                    <TablixCells>
                                      <TablixCell>
                                        <CellContents>
                                          <Textbox Name="SumString">
                                            <CanGrow>true</CanGrow>
                                            <KeepTogether>true</KeepTogether>
                                            <Paragraphs>
                                              <Paragraph>
                                                <TextRuns>
                                                  <TextRun>
                                                    <Value EvaluationMode="Auto">=Fields!SumString.Value</Value>
                                                    <Style>
                                                      <FontSize>9pt</FontSize>
                                                    </Style>
                                                  </TextRun>
                                                </TextRuns>
                                                <Style />
                                              </Paragraph>
                                            </Paragraphs>
                                            <rd:DefaultName>SumString</rd:DefaultName>
                                            <Style>
                                              <Border>
                                                <Style>None</Style>
                                              </Border>
                                              <TopBorder>
                                                <Style>Solid</Style>
                                              </TopBorder>
                                              <PaddingLeft>2pt</PaddingLeft>
                                              <PaddingRight>2pt</PaddingRight>
                                              <PaddingTop>2pt</PaddingTop>
                                              <PaddingBottom>2pt</PaddingBottom>
                                            </Style>
                                          </Textbox>
                                          <ColSpan>4</ColSpan>
                                        </CellContents>
                                      </TablixCell>
                                      <TablixCell />
                                      <TablixCell />
                                      <TablixCell />
                                      <TablixCell>
                                        <CellContents>
                                          <Textbox Name="Textbox34">
                                            <CanGrow>true</CanGrow>
                                            <KeepTogether>true</KeepTogether>
                                            <Paragraphs>
                                              <Paragraph>
                                                <TextRuns>
                                                  <TextRun>
                                                    <Value EvaluationMode="Auto" />
                                                    <Style>
                                                      <FontSize>9pt</FontSize>
                                                    </Style>
                                                  </TextRun>
                                                </TextRuns>
                                                <Style />
                                              </Paragraph>
                                            </Paragraphs>
                                            <rd:DefaultName>Textbox34</rd:DefaultName>
                                            <Style>
                                              <Border>
                                                <Style>None</Style>
                                              </Border>
                                              <TopBorder>
                                                <Style>Solid</Style>
                                              </TopBorder>
                                              <PaddingLeft>2pt</PaddingLeft>
                                              <PaddingRight>2pt</PaddingRight>
                                              <PaddingTop>2pt</PaddingTop>
                                              <PaddingBottom>2pt</PaddingBottom>
                                            </Style>
                                          </Textbox>
                                        </CellContents>
                                      </TablixCell>
                                      <TablixCell>
                                        <CellContents>
                                          <Textbox Name="Quantity2">
                                            <CanGrow>true</CanGrow>
                                            <KeepTogether>true</KeepTogether>
                                            <Paragraphs>
                                              <Paragraph>
                                                <TextRuns>
                                                  <TextRun>
                                                    <Value EvaluationMode="Auto">=SUM(Fields!Quantity.Value)</Value>
                                                    <Style>
                                                      <FontSize>9pt</FontSize>
                                                      <Format>=Fields!QuantityFormat.Value</Format>
                                                    </Style>
                                                  </TextRun>
                                                </TextRuns>
                                                <Style />
                                              </Paragraph>
                                            </Paragraphs>
                                            <rd:DefaultName>Quantity</rd:DefaultName>
                                            <Style>
                                              <Border>
                                                <Style>None</Style>
                                              </Border>
                                              <TopBorder>
                                                <Style>Solid</Style>
                                              </TopBorder>
                                              <PaddingLeft>2pt</PaddingLeft>
                                              <PaddingRight>2pt</PaddingRight>
                                              <PaddingTop>2pt</PaddingTop>
                                              <PaddingBottom>2pt</PaddingBottom>
                                            </Style>
                                          </Textbox>
                                        </CellContents>
                                      </TablixCell>
                                    </TablixCells>
                                  </TablixRow>
                                  <TablixRow>
                                    <Height>0.423cm</Height>
                                    <TablixCells>
                                      <TablixCell>
                                        <CellContents>
                                          <Textbox Name="C_INC_TotalQtyHours">
                                            <CanGrow>true</CanGrow>
                                            <KeepTogether>true</KeepTogether>
                                            <Paragraphs>
                                              <Paragraph>
                                                <TextRuns>
                                                  <TextRun>
                                                    <Value EvaluationMode="Auto">=Fields!C_INC_TotalQtyHours.Value</Value>
                                                    <Style>
                                                      <FontSize>9pt</FontSize>
                                                      <FontWeight>Bold</FontWeight>
                                                    </Style>
                                                  </TextRun>
                                                </TextRuns>
                                                <Style />
                                              </Paragraph>
                                            </Paragraphs>
                                            <rd:DefaultName>C_INC_TotalQtyHours</rd:DefaultName>
                                            <Style>
                                              <Border>
                                                <Style>None</Style>
                                              </Border>
                                              <PaddingLeft>2pt</PaddingLeft>
                                              <PaddingRight>2pt</PaddingRight>
                                              <PaddingTop>2pt</PaddingTop>
                                              <PaddingBottom>2pt</PaddingBottom>
                                            </Style>
                                          </Textbox>
                                          <ColSpan>4</ColSpan>
                                        </CellContents>
                                      </TablixCell>
                                      <TablixCell />
                                      <TablixCell />
                                      <TablixCell />
                                      <TablixCell>
                                        <CellContents>
                                          <Textbox Name="Textbox35">
                                            <CanGrow>true</CanGrow>
                                            <KeepTogether>true</KeepTogether>
                                            <Paragraphs>
                                              <Paragraph>
                                                <TextRuns>
                                                  <TextRun>
                                                    <Value EvaluationMode="Auto" />
                                                    <Style>
                                                      <FontSize>9pt</FontSize>
                                                      <FontWeight>Bold</FontWeight>
                                                    </Style>
                                                  </TextRun>
                                                </TextRuns>
                                                <Style />
                                              </Paragraph>
                                            </Paragraphs>
                                            <rd:DefaultName>Textbox35</rd:DefaultName>
                                            <Style>
                                              <Border>
                                                <Style>None</Style>
                                              </Border>
                                              <PaddingLeft>2pt</PaddingLeft>
                                              <PaddingRight>2pt</PaddingRight>
                                              <PaddingTop>2pt</PaddingTop>
                                              <PaddingBottom>2pt</PaddingBottom>
                                            </Style>
                                          </Textbox>
                                        </CellContents>
                                      </TablixCell>
                                      <TablixCell>
                                        <CellContents>
                                          <Textbox Name="Quantity3">
                                            <CanGrow>true</CanGrow>
                                            <KeepTogether>true</KeepTogether>
                                            <Paragraphs>
                                              <Paragraph>
                                                <TextRuns>
                                                  <TextRun>
                                                    <Value EvaluationMode="Auto">=Sum(Fields!Quantity.Value)</Value>
                                                    <Style>
                                                      <FontSize>9pt</FontSize>
                                                      <FontWeight>Bold</FontWeight>
                                                      <Format>=Fields!QuantityFormat.Value</Format>
                                                    </Style>
                                                  </TextRun>
                                                </TextRuns>
                                                <Style />
                                              </Paragraph>
                                            </Paragraphs>
                                            <rd:DefaultName>Quantity</rd:DefaultName>
                                            <Style>
                                              <Border>
                                                <Style>None</Style>
                                              </Border>
                                              <PaddingLeft>2pt</PaddingLeft>
                                              <PaddingRight>2pt</PaddingRight>
                                              <PaddingTop>2pt</PaddingTop>
                                              <PaddingBottom>2pt</PaddingBottom>
                                            </Style>
                                          </Textbox>
                                        </CellContents>
                                      </TablixCell>
                                    </TablixCells>
                                  </TablixRow>
                                </TablixRows>
                              </TablixBody>
                              <TablixColumnHierarchy>
                                <TablixMembers>
                                  <TablixMember />
                                  <TablixMember />
                                  <TablixMember />
                                  <TablixMember />
                                  <TablixMember />
                                  <TablixMember />
                                </TablixMembers>
                              </TablixColumnHierarchy>
                              <TablixRowHierarchy>
                                <TablixMembers>
                                  <TablixMember>
                                    <Group Name="No">
                                      <GroupExpressions>
                                        <GroupExpression>=Fields!StopCode.Value</GroupExpression>
                                      </GroupExpressions>
                                    </Group>
                                    <SortExpressions>
                                      <SortExpression>
                                        <Value>=Fields!No.Value</Value>
                                      </SortExpression>
                                    </SortExpressions>
                                    <TablixMembers>
                                      <TablixMember>
                                        <KeepWithGroup>After</KeepWithGroup>
                                      </TablixMember>
                                      <TablixMember>
                                        <Group Name="Details1" />
                                      </TablixMember>
                                      <TablixMember>
                                        <KeepWithGroup>Before</KeepWithGroup>
                                      </TablixMember>
                                    </TablixMembers>
                                  </TablixMember>
                                  <TablixMember>
                                    <KeepWithGroup>Before</KeepWithGroup>
                                  </TablixMember>
                                </TablixMembers>
                              </TablixRowHierarchy>
                              <DataSetName>DataSet_Result</DataSetName>
                              <Top>0.04974cm</Top>
                              <Height>1.692cm</Height>
                              <Width>14.61354cm</Width>
                              <ZIndex>1</ZIndex>
                              <Style>
                                <Border>
                                  <Style>None</Style>
                                </Border>
                              </Style>
                            </Tablix>
                          </ReportItems>
                          <KeepTogether>true</KeepTogether>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                          </Style>
                        </Rectangle>
                      </CellContents>
                    </TablixCell>
                  </TablixCells>
                </TablixRow>
              </TablixRows>
            </TablixBody>
            <TablixColumnHierarchy>
              <TablixMembers>
                <TablixMember />
              </TablixMembers>
            </TablixColumnHierarchy>
            <TablixRowHierarchy>
              <TablixMembers>
                <TablixMember>
                  <Group Name="Details">
                    <GroupExpressions>
                      <GroupExpression>=Fields!DocumentNo.Value</GroupExpression>
                    </GroupExpressions>
                    <PageBreak>
                      <BreakLocation>Between</BreakLocation>
                    </PageBreak>
                  </Group>
                </TablixMember>
              </TablixMembers>
            </TablixRowHierarchy>
            <DataSetName>DataSet_Result</DataSetName>
            <Height>1.74174cm</Height>
            <Width>19cm</Width>
            <Style>
              <Border>
                <Style>None</Style>
              </Border>
            </Style>
          </Tablix>
        </ReportItems>
        <Height>1.74174cm</Height>
        <Style />
      </Body>
      <Width>19cm</Width>
      <Page>
        <PageHeader>
          <Height>2.54cm</Height>
          <PrintOnFirstPage>true</PrintOnFirstPage>
          <PrintOnLastPage>true</PrintOnLastPage>
          <ReportItems>
            <Textbox Name="Textbox7">
              <CanGrow>true</CanGrow>
              <KeepTogether>true</KeepTogether>
              <Paragraphs>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Value EvaluationMode="Auto">=Code.GetData(1,1) ''</Value>
                      <Style>
                        <FontWeight>Bold</FontWeight>
                      </Style>
                    </TextRun>
                  </TextRuns>
                  <Style />
                </Paragraph>
              </Paragraphs>
              <rd:DefaultName>Textbox7</rd:DefaultName>
              <Height>0.423cm</Height>
              <Width>9.67021cm</Width>
              <Style>
                <Border>
                  <Style>None</Style>
                </Border>
                <PaddingTop>2pt</PaddingTop>
                <PaddingBottom>2pt</PaddingBottom>
              </Style>
            </Textbox>
            <Textbox Name="Textbox8">
              <CanGrow>true</CanGrow>
              <KeepTogether>true</KeepTogether>
              <Paragraphs>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Value EvaluationMode="Auto">=Code.GetData(2,1) ''</Value>
                      <Style>
                        <FontSize>9pt</FontSize>
                      </Style>
                    </TextRun>
                  </TextRuns>
                  <Style />
                </Paragraph>
              </Paragraphs>
              <rd:DefaultName>Textbox7</rd:DefaultName>
              <Top>0.423cm</Top>
              <Height>0.423cm</Height>
              <Width>9.67021cm</Width>
              <ZIndex>1</ZIndex>
              <Style>
                <Border>
                  <Style>None</Style>
                </Border>
                <PaddingLeft>2pt</PaddingLeft>
                <PaddingRight>2pt</PaddingRight>
                <PaddingTop>2pt</PaddingTop>
                <PaddingBottom>2pt</PaddingBottom>
              </Style>
            </Textbox>
            <Textbox Name="Textbox9">
              <CanGrow>true</CanGrow>
              <KeepTogether>true</KeepTogether>
              <Paragraphs>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Value EvaluationMode="Auto">=Code.GetData(3,1) ''</Value>
                      <Style>
                        <FontSize>9pt</FontSize>
                      </Style>
                    </TextRun>
                  </TextRuns>
                  <Style>
                    <TextAlign>Right</TextAlign>
                  </Style>
                </Paragraph>
              </Paragraphs>
              <rd:DefaultName>Textbox7</rd:DefaultName>
              <Left>10.67916cm</Left>
              <Height>0.423cm</Height>
              <Width>8.32084cm</Width>
              <ZIndex>2</ZIndex>
              <Style>
                <Border>
                  <Style>None</Style>
                </Border>
                <PaddingLeft>2pt</PaddingLeft>
                <PaddingRight>2pt</PaddingRight>
                <PaddingTop>2pt</PaddingTop>
                <PaddingBottom>2pt</PaddingBottom>
              </Style>
            </Textbox>
            <Textbox Name="Textbox10">
              <CanGrow>true</CanGrow>
              <KeepTogether>true</KeepTogether>
              <Paragraphs>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Value EvaluationMode="Auto">=Replace(Replace(Code.GetData(4,1), "%1", Globals!PageNumber), "%2", Globals!TotalPages)</Value>
                      <Style>
                        <FontSize>9pt</FontSize>
                      </Style>
                    </TextRun>
                  </TextRuns>
                  <Style>
                    <TextAlign>Right</TextAlign>
                  </Style>
                </Paragraph>
              </Paragraphs>
              <rd:DefaultName>Textbox7</rd:DefaultName>
              <Top>0.423cm</Top>
              <Left>10.67916cm</Left>
              <Height>0.423cm</Height>
              <Width>8.32084cm</Width>
              <ZIndex>3</ZIndex>
              <Style>
                <Border>
                  <Style>None</Style>
                </Border>
                <PaddingLeft>2pt</PaddingLeft>
                <PaddingRight>2pt</PaddingRight>
                <PaddingTop>2pt</PaddingTop>
                <PaddingBottom>2pt</PaddingBottom>
              </Style>
            </Textbox>
            <Textbox Name="Textbox11">
              <CanGrow>true</CanGrow>
              <KeepTogether>true</KeepTogether>
              <Paragraphs>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Value EvaluationMode="Auto">=Code.GetData(5,1) ''</Value>
                      <Style>
                        <FontSize>9pt</FontSize>
                      </Style>
                    </TextRun>
                  </TextRuns>
                  <Style>
                    <TextAlign>Right</TextAlign>
                  </Style>
                </Paragraph>
              </Paragraphs>
              <rd:DefaultName>Textbox7</rd:DefaultName>
              <Top>0.846cm</Top>
              <Left>10.67916cm</Left>
              <Height>0.423cm</Height>
              <Width>8.32084cm</Width>
              <ZIndex>4</ZIndex>
              <Style>
                <Border>
                  <Style>None</Style>
                </Border>
                <PaddingLeft>2pt</PaddingLeft>
                <PaddingRight>2pt</PaddingRight>
                <PaddingTop>2pt</PaddingTop>
                <PaddingBottom>2pt</PaddingBottom>
              </Style>
            </Textbox>
          </ReportItems>
          <Style>
            <Border>
              <Style>None</Style>
            </Border>
          </Style>
        </PageHeader>
        <PageHeight>29.7cm</PageHeight>
        <PageWidth>21cm</PageWidth>
        <LeftMargin>1cm</LeftMargin>
        <TopMargin>1cm</TopMargin>
        <BottomMargin>1cm</BottomMargin>
        <ColumnSpacing>1.27cm</ColumnSpacing>
        <Style />
      </Page>
    </ReportSection>
  </ReportSections>
  <Code>Public Function BlankZero(ByVal Value As Decimal)
    if Value = 0 then
        Return ""
    end if
    Return Value
End Function

Public Function BlankPos(ByVal Value As Decimal)
    if Value &gt; 0 then
        Return ""
    end if
    Return Value
End Function

Public Function BlankZeroAndPos(ByVal Value As Decimal)
    if Value &gt;= 0 then
        Return ""
    end if
    Return Value
End Function

Public Function BlankNeg(ByVal Value As Decimal)
    if Value &lt; 0 then
        Return ""
    end if
    Return Value
End Function

Public Function BlankNegAndZero(ByVal Value As Decimal)
    if Value &lt;= 0 then
        Return ""
    end if
    Return Value
End Function

Shared Data1 as Object
Shared Data2 as Object
Shared Data3 as Object
Shared Data4 as Object
Shared Data5 as Object
Shared Data6 as Object
Shared Data7 as Object
Shared Data10 as Object

Public Function GetData(Num as Integer, Group as integer) as Object
if Group = 1 then
   Return Cstr(Choose(Num, Split(Cstr(Data1),Chr(177))))
End If

if Group = 2 then
   Return Cstr(Choose(Num, Split(Cstr(Data2),Chr(177))))
End If

if Group = 3 then
   Return Cstr(Choose(Num, Split(Cstr(Data3),Chr(177))))
End If

if Group = 4 then
   Return Cstr(Choose(Num, Split(Cstr(Data4),Chr(177))))
End If

if Group = 5 then
   Return Cstr(Choose(Num, Split(Cstr(Data5),Chr(177))))
End If

if Group = 6 then
   Return Cstr(Choose(Num, Split(Cstr(Data6),Chr(177))))
End If

if Group = 7 then
   Return Cstr(Choose(Num, Split(Cstr(Data7),Chr(177))))
End If

if Group = 10 then
   Return Cstr(Choose(Num, Split(Cstr(Data10),Chr(177))))
End If
End Function

Public Function SetData(NewData as Object,Group as integer)
  If Group = 1 and NewData &gt; "" Then
      Data1 = NewData
  End If

  If Group = 2 and NewData &gt; "" Then
      Data2 = NewData
  End If

  If Group = 3 and NewData &gt; "" Then
      Data3 = NewData
  End If

  If Group = 4 and NewData &gt; "" Then
      Data4 = NewData
  End If

  If Group = 5 and NewData &gt; "" Then
      Data5 = NewData
  End If

  If Group = 6 and NewData &gt; "" Then
      Data6 = NewData
  End If

  If Group = 7 and NewData &gt; "" Then
      Data7 = NewData
  End If

  If Group = 10 and NewData &gt; "" Then
      Data10 = NewData
  End If
End Function</Code>
  <Language>=User!Language</Language>
  <ConsumeContainerWhitespace>true</ConsumeContainerWhitespace>
  <rd:ReportUnitType>Cm</rd:ReportUnitType>
  <rd:ReportID>0eeb6585-38ae-40f1-885b-8d50088d51b4</rd:ReportID>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 58001 OPC Time Register List
{
  OBJECT-PROPERTIES
  {
    Date=20.09.17;
    Time=15:17:23;
    Modified=Yes;
    Version List=OPC6.01;
  }
  PROPERTIES
  {
    CaptionML=[ENU=OPC Time Register List;
               NOR=OPC M›nstringsoversikt];
  }
  DATASET
  {
    { 1101103000;;DataItem;                  ;
               DataItemTable=Table83007;
               OnPreDataItem=BEGIN

                               LastFieldNo := FIELDNO("Machine Center");

                               OverUnder := 0;
                               SumDagtrekk := 0;
                               SumPrUke := 0;
                               AntallPoster := 0;
                             END;

               OnAfterGetRecord=BEGIN

                                  //hhe 03.04.06->
                                  ProdRess.GET("Machine Center");
                                  //hhe 03.04.06<-
                                  //FSK 14.02.11->

                                  ThisDay := DATE2DMY("Start Date",1);
                                  Helgedag := DATE2DWY("Start Date",1);
                                  ThisWeek := DATE2DWY("Start Date",2);
                                  ThisMonth := DATE2DMY("Start Date",2);
                                  ThisEmp := ProdRess.Name;

                                  IF ThisEmp <> PreviousEmp THEN
                                  BEGIN
                                    OverUnder := 0;
                                    SumDagtrekk := 0;
                                    SumPrUke := 0;
                                    SumPrDag := 0;
                                    AntallPoster := 0;
                                    Helgedager := 0;
                                  END;

                                  IF ThisWeek <> PreviousWeek THEN
                                    BEGIN
                                      SumPrUke := 0;
                                      Mellomrom := TRUE;
                                    END
                                  ELSE
                                    Mellomrom := FALSE;


                                  IF (ThisDay <> PreviousDay) THEN
                                  BEGIN
                                    AntallPoster := AntallPoster + 1;
                                    Trukket := FALSE;
                                  END;

                                  IF (ThisDay <> PreviousDay) THEN
                                    SumPrDag := 0
                                    ELSE
                                    IF (Quantity > 0.0999) THEN
                                    BEGIN
                                    SumPrDag := SumPrDag + Quantity;
                                    Trukket := TRUE;
                                    END
                                    ELSE
                                    SumPrDag := SumPrDag;

                                  IF (Quantity < 0.01) AND (Quantity > 0.0003)THEN
                                    Description := SlettPost;

                                  IF (Quantity < 0.05) AND (Quantity > 0.00999)THEN
                                    Description := JusterPost;

                                  IF (Quantity < 0.1) AND (Quantity > 0.04999)THEN
                                    Description := VeldigLitenPost;

                                  IF (Quantity < 0.5) AND (Quantity > 0.0999)THEN
                                    Description := LitenPost;

                                  IF (ThisDay <> PreviousDay) AND (Helgedag > 5) THEN
                                    Helgedager := Helgedager + 1;

                                  IF (Trukket = TRUE) THEN
                                    Dagtrekk := 0
                                    ELSE BEGIN

                                    IF (ThisDay <> PreviousDay) AND (Helgedag < 6) THEN
                                      BEGIN
                                      IF (ThisMonth < 10) AND (Quantity > 0.0999) THEN
                                        Dagtrekk := -7.5
                                      ELSE
                                      IF (ThisMonth > 9) AND (Quantity > 0.5) THEN
                                        Dagtrekk := -8.0
                                      ELSE IF (ThisDay <> PreviousDay) AND (Helgedag > 5) THEN
                                       Dagtrekk := 0
                                      ELSE IF (ThisDay <> PreviousDay) AND (Quantity = 0.0999) THEN
                                       Dagtrekk := 0
                                      END
                                    ELSE
                                    IF (ThisDay = PreviousDay) AND (Quantity > 0.0999) AND (SumPrDag > Quantity) AND (Helgedag < 6) THEN
                                        Dagtrekk := -7.5
                                    ELSE
                                    IF (ThisDay = PreviousDay) AND (Quantity > 0.0999) AND (SumPrDag > Quantity) AND (ThisMonth > 9) AND (Helgedag < 6) THEN
                                        Dagtrekk := -8.0
                                    ELSE
                                    IF (ThisDay = PreviousDay) THEN
                                      Dagtrekk := 0;
                                  END;

                                  OverUnder := Quantity + Dagtrekk;
                                  SumDagtrekk := SumDagtrekk + OverUnder;
                                  SumPrUke := SumPrUke + Quantity;
                                  PreviousDay := DATE2DMY("Start Date",1);
                                  PreviousWeek := DATE2DWY("Start Date",2);
                                  PreviousEmp := ProdRess.Name;

                                  //FSK 14.02.11<-
                                END;
                                 }

    { 1101103001;1;Column;ReportTitle        ;
               SourceExpr=ReportTitle }

    { 1101103002;1;Column;COMPANYNAME        ;
               SourceExpr=COMPANYNAME }

    { 1101103003;1;Column;TODAY              ;
               SourceExpr=FORMAT(TODAY,0,4) }

    { 1101103004;1;Column;PageCap            ;
               SourceExpr=PageCap }

    { 1101103005;1;Column;MachineCenter      ;
               SourceExpr="Machine Center" }

    { 1101103006;1;Column;ProdRess_Name      ;
               SourceExpr=ProdRess.Name }

    { 1101103007;1;Column;StartingDay        ;
               SourceExpr="Starting day" }

    { 1101103008;1;Column;StartDate          ;
               SourceExpr="Start Date" }

    { 1101103009;1;Column;StartTime          ;
               SourceExpr="Start Time" }

    { 1101103010;1;Column;EndDate            ;
               SourceExpr="End Date" }

    { 1101103011;1;Column;EndTime            ;
               SourceExpr="End Time" }

    { 1101103012;1;Column;Quantity           ;
               SourceExpr=Quantity }

    { 1101103013;1;Column;OverUnder          ;
               SourceExpr=OverUnder }

    { 1101103014;1;Column;SumPrUke           ;
               SourceExpr=SumPrUke }

    { 1101103015;1;Column;Absence            ;
               SourceExpr=Absence }

    { 1101103016;1;Column;Description        ;
               SourceExpr=Description }

    { 1101103028;1;Column;MachineCenterCap   ;
               SourceExpr=FIELDCAPTION("Machine Center") }

    { 1101103017;1;Column;AnsattnrCap        ;
               SourceExpr=AnsattnrCap }

    { 1101103026;1;Column;StartingDayCap     ;
               SourceExpr=WeekDayCap }

    { 1101103025;1;Column;StartDateCap       ;
               SourceExpr=FIELDCAPTION("Start Date") }

    { 1101103024;1;Column;StartTimeCap       ;
               SourceExpr=FIELDCAPTION("Start Time") }

    { 1101103023;1;Column;EndDateCap         ;
               SourceExpr=FIELDCAPTION("End Date") }

    { 1101103022;1;Column;EndTimeCap         ;
               SourceExpr=FIELDCAPTION("End Time") }

    { 1101103021;1;Column;QuantityCap        ;
               SourceExpr=QuantityCap }

    { 1101103020;1;Column;OverUnderCap       ;
               SourceExpr=UnderOverCap }

    { 1101103019;1;Column;SumPrUkeCap        ;
               SourceExpr=ThisWeekCap }

    { 1101103018;1;Column;AbsenceCap         ;
               SourceExpr=AbcenseCap }

    { 1101103027;1;Column;TotalString        ;
               SourceExpr=TotalFor + FIELDCAPTION("Machine Center") }

    { 1101103029;1;Column;RoundedQty         ;
               SourceExpr=ROUND(Quantity,0.1, '>') }

    { 1101103030;1;Column;SumDagtrekk        ;
               SourceExpr=ROUND(SumDagtrekk,0.1, '>') }

    { 1101103031;1;Column;AntallStemplinger  ;
               SourceExpr=AntallStemplinger }

    { 1101103032;1;Column;AntallPoster       ;
               SourceExpr=AntallPoster }

    { 1101103033;1;Column;Derav              ;
               SourceExpr=Derav }

    { 1101103034;1;Column;Helgedager         ;
               SourceExpr=Helgedager }

    { 1101103035;1;Column;Helg               ;
               SourceExpr=Helg }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      LastFieldNo@1101103020 : Integer;
      FooterPrinted@1101103019 : Boolean;
      "--hhe--"@1101103018 : Boolean;
      ProdRess@1101103017 : Record 99000758;
      OverUnder@1101103016 : Decimal;
      Dagtrekk@1101103015 : Decimal;
      SumDagtrekk@1101103014 : Decimal;
      PreviousDay@1101103013 : Integer;
      ThisDay@1101103012 : Integer;
      Helgedag@1101103011 : Integer;
      ThisEmp@1101103010 : Text[30];
      PreviousEmp@1101103009 : Text[30];
      ThisMonth@1101103008 : Integer;
      ThisWeek@1101103007 : Integer;
      SumPrUke@1101103006 : Decimal;
      PreviousWeek@1101103005 : Integer;
      AntallPoster@1101103004 : Integer;
      Helgedager@1101103003 : Integer;
      SumPrDag@1101103002 : Decimal;
      Trukket@1101103001 : Boolean;
      Mellomrom@1101103000 : Boolean;
      ReportTitle@1101103029 : TextConst 'ENU=Time Register;NOR=Stemplingsliste';
      PageCap@1101103030 : TextConst 'ENU=Page %1 of %2;NOR=Side %1 av %2';
      TotalFor@1101103028 : TextConst 'NOR="Sum for "';
      AntallStemplinger@1101103027 : TextConst 'NOR=Antall Dager:';
      Helg@1101103026 : TextConst 'NOR=Helgedag(er)';
      Derav@1101103025 : TextConst 'NOR=derav';
      SlettPost@1101103024 : TextConst 'NOR=For liten post - M SLETTES';
      JusterPost@1101103023 : TextConst 'NOR=SLETT/SL SAMMEN Post';
      VeldigLitenPost@1101103022 : TextConst 'NOR=Juster / Sl† sammen - Ingen trekk !';
      LitenPost@1101103021 : TextConst 'NOR=Liten post - korrekt trekk !';
      AnsattnrCap@1101103031 : TextConst 'NOR=Ansattnr.';
      WeekDayCap@1101103032 : TextConst 'NOR=Ukedag';
      QuantityCap@1101103033 : TextConst 'ENU=Quantity;NOR=Timer';
      UnderOverCap@1101103034 : TextConst 'ENU=Over/Under;NOR=Over/Under';
      ThisWeekCap@1101103035 : TextConst 'ENU=This Week;NOR=Sum/Uke';
      AbcenseCap@1101103036 : TextConst 'NOR=Frav‘r';

    BEGIN
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner" xmlns:cl="http://schemas.microsoft.com/sqlserver/reporting/2010/01/componentdefinition" xmlns="http://schemas.microsoft.com/sqlserver/reporting/2010/01/reportdefinition">
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
      <rd:DataSourceID>065a2ece-dcd2-450d-a37e-6075421925c3</rd:DataSourceID>
    </DataSource>
  </DataSources>
  <DataSets>
    <DataSet Name="DataSet_Result">
      <Query>
        <DataSourceName>DataSource</DataSourceName>
        <CommandText />
      </Query>
      <Fields>
        <Field Name="ReportTitle">
          <DataField>ReportTitle</DataField>
        </Field>
        <Field Name="COMPANYNAME">
          <DataField>COMPANYNAME</DataField>
        </Field>
        <Field Name="TODAY">
          <DataField>TODAY</DataField>
        </Field>
        <Field Name="PageCap">
          <DataField>PageCap</DataField>
        </Field>
        <Field Name="MachineCenter">
          <DataField>MachineCenter</DataField>
        </Field>
        <Field Name="ProdRess_Name">
          <DataField>ProdRess_Name</DataField>
        </Field>
        <Field Name="StartingDay">
          <DataField>StartingDay</DataField>
        </Field>
        <Field Name="StartDate">
          <DataField>StartDate</DataField>
        </Field>
        <Field Name="StartTime">
          <DataField>StartTime</DataField>
        </Field>
        <Field Name="EndDate">
          <DataField>EndDate</DataField>
        </Field>
        <Field Name="EndTime">
          <DataField>EndTime</DataField>
        </Field>
        <Field Name="Quantity">
          <DataField>Quantity</DataField>
        </Field>
        <Field Name="QuantityFormat">
          <DataField>QuantityFormat</DataField>
        </Field>
        <Field Name="OverUnder">
          <DataField>OverUnder</DataField>
        </Field>
        <Field Name="OverUnderFormat">
          <DataField>OverUnderFormat</DataField>
        </Field>
        <Field Name="SumPrUke">
          <DataField>SumPrUke</DataField>
        </Field>
        <Field Name="SumPrUkeFormat">
          <DataField>SumPrUkeFormat</DataField>
        </Field>
        <Field Name="Absence">
          <DataField>Absence</DataField>
        </Field>
        <Field Name="Description">
          <DataField>Description</DataField>
        </Field>
        <Field Name="MachineCenterCap">
          <DataField>MachineCenterCap</DataField>
        </Field>
        <Field Name="AnsattnrCap">
          <DataField>AnsattnrCap</DataField>
        </Field>
        <Field Name="StartingDayCap">
          <DataField>StartingDayCap</DataField>
        </Field>
        <Field Name="StartDateCap">
          <DataField>StartDateCap</DataField>
        </Field>
        <Field Name="StartTimeCap">
          <DataField>StartTimeCap</DataField>
        </Field>
        <Field Name="EndDateCap">
          <DataField>EndDateCap</DataField>
        </Field>
        <Field Name="EndTimeCap">
          <DataField>EndTimeCap</DataField>
        </Field>
        <Field Name="QuantityCap">
          <DataField>QuantityCap</DataField>
        </Field>
        <Field Name="OverUnderCap">
          <DataField>OverUnderCap</DataField>
        </Field>
        <Field Name="SumPrUkeCap">
          <DataField>SumPrUkeCap</DataField>
        </Field>
        <Field Name="AbsenceCap">
          <DataField>AbsenceCap</DataField>
        </Field>
        <Field Name="TotalString">
          <DataField>TotalString</DataField>
        </Field>
        <Field Name="RoundedQty">
          <DataField>RoundedQty</DataField>
        </Field>
        <Field Name="RoundedQtyFormat">
          <DataField>RoundedQtyFormat</DataField>
        </Field>
        <Field Name="SumDagtrekk">
          <DataField>SumDagtrekk</DataField>
        </Field>
        <Field Name="SumDagtrekkFormat">
          <DataField>SumDagtrekkFormat</DataField>
        </Field>
        <Field Name="AntallStemplinger">
          <DataField>AntallStemplinger</DataField>
        </Field>
        <Field Name="AntallPoster">
          <DataField>AntallPoster</DataField>
        </Field>
        <Field Name="Derav">
          <DataField>Derav</DataField>
        </Field>
        <Field Name="Helgedager">
          <DataField>Helgedager</DataField>
        </Field>
        <Field Name="Helg">
          <DataField>Helg</DataField>
        </Field>
      </Fields>
      <rd:DataSetInfo>
        <rd:DataSetName>DataSet</rd:DataSetName>
        <rd:SchemaPath>Report.xsd</rd:SchemaPath>
        <rd:TableName>Result</rd:TableName>
      </rd:DataSetInfo>
    </DataSet>
  </DataSets>
  <ReportSections>
    <ReportSection>
      <Body>
        <ReportItems>
          <Tablix Name="Tablix1">
            <TablixBody>
              <TablixColumns>
                <TablixColumn>
                  <Width>19cm</Width>
                </TablixColumn>
              </TablixColumns>
              <TablixRows>
                <TablixRow>
                  <Height>2.46324cm</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Rectangle Name="Rectangle1">
                          <ReportItems>
                            <Tablix Name="Tablix2">
                              <TablixBody>
                                <TablixColumns>
                                  <TablixColumn>
                                    <Width>0.80793cm</Width>
                                  </TablixColumn>
                                  <TablixColumn>
                                    <Width>0.80793cm</Width>
                                  </TablixColumn>
                                  <TablixColumn>
                                    <Width>0.80793cm</Width>
                                  </TablixColumn>
                                </TablixColumns>
                                <TablixRows>
                                  <TablixRow>
                                    <Height>0.20312cm</Height>
                                    <TablixCells>
                                      <TablixCell>
                                        <CellContents>
                                          <Textbox Name="Textbox2">
                                            <CanGrow>true</CanGrow>
                                            <KeepTogether>true</KeepTogether>
                                            <Paragraphs>
                                              <Paragraph>
                                                <TextRuns>
                                                  <TextRun>
                                                    <Value EvaluationMode="Auto" />
                                                    <Style />
                                                  </TextRun>
                                                </TextRuns>
                                                <Style />
                                              </Paragraph>
                                            </Paragraphs>
                                            <rd:DefaultName>Textbox2</rd:DefaultName>
                                            <Visibility>
                                              <Hidden>=Code.SetData(
Cstr(Fields!ReportTitle.Value) + Chr(177) +
Cstr(Fields!COMPANYNAME.Value) + Chr(177) +
Cstr(Fields!TODAY.Value) + Chr(177) +
Cstr(Fields!PageCap.Value)
,1)</Hidden>
                                            </Visibility>
                                            <Style>
                                              <Border>
                                                <Color>LightGrey</Color>
                                              </Border>
                                              <PaddingLeft>2pt</PaddingLeft>
                                              <PaddingRight>2pt</PaddingRight>
                                              <PaddingTop>2pt</PaddingTop>
                                              <PaddingBottom>2pt</PaddingBottom>
                                            </Style>
                                          </Textbox>
                                        </CellContents>
                                      </TablixCell>
                                      <TablixCell>
                                        <CellContents>
                                          <Textbox Name="Textbox4">
                                            <CanGrow>true</CanGrow>
                                            <KeepTogether>true</KeepTogether>
                                            <Paragraphs>
                                              <Paragraph>
                                                <TextRuns>
                                                  <TextRun>
                                                    <Value EvaluationMode="Auto" />
                                                    <Style />
                                                  </TextRun>
                                                </TextRuns>
                                                <Style />
                                              </Paragraph>
                                            </Paragraphs>
                                            <rd:DefaultName>Textbox4</rd:DefaultName>
                                            <Style>
                                              <Border>
                                                <Color>LightGrey</Color>
                                              </Border>
                                              <PaddingLeft>2pt</PaddingLeft>
                                              <PaddingRight>2pt</PaddingRight>
                                              <PaddingTop>2pt</PaddingTop>
                                              <PaddingBottom>2pt</PaddingBottom>
                                            </Style>
                                          </Textbox>
                                        </CellContents>
                                      </TablixCell>
                                      <TablixCell>
                                        <CellContents>
                                          <Textbox Name="Textbox6">
                                            <CanGrow>true</CanGrow>
                                            <KeepTogether>true</KeepTogether>
                                            <Paragraphs>
                                              <Paragraph>
                                                <TextRuns>
                                                  <TextRun>
                                                    <Value EvaluationMode="Auto" />
                                                    <Style />
                                                  </TextRun>
                                                </TextRuns>
                                                <Style />
                                              </Paragraph>
                                            </Paragraphs>
                                            <rd:DefaultName>Textbox6</rd:DefaultName>
                                            <Style>
                                              <Border>
                                                <Color>LightGrey</Color>
                                              </Border>
                                              <PaddingLeft>2pt</PaddingLeft>
                                              <PaddingRight>2pt</PaddingRight>
                                              <PaddingTop>2pt</PaddingTop>
                                              <PaddingBottom>2pt</PaddingBottom>
                                            </Style>
                                          </Textbox>
                                        </CellContents>
                                      </TablixCell>
                                    </TablixCells>
                                  </TablixRow>
                                </TablixRows>
                              </TablixBody>
                              <TablixColumnHierarchy>
                                <TablixMembers>
                                  <TablixMember />
                                  <TablixMember />
                                  <TablixMember />
                                </TablixMembers>
                              </TablixColumnHierarchy>
                              <TablixRowHierarchy>
                                <TablixMembers>
                                  <TablixMember />
                                </TablixMembers>
                              </TablixRowHierarchy>
                              <Height>0.20312cm</Height>
                              <Width>2.4238cm</Width>
                              <Style>
                                <Border>
                                  <Style>None</Style>
                                </Border>
                              </Style>
                            </Tablix>
                            <Tablix Name="Tablix3">
                              <TablixBody>
                                <TablixColumns>
                                  <TablixColumn>
                                    <Width>1.60455cm</Width>
                                  </TablixColumn>
                                  <TablixColumn>
                                    <Width>1.45455cm</Width>
                                  </TablixColumn>
                                  <TablixColumn>
                                    <Width>1.45455cm</Width>
                                  </TablixColumn>
                                  <TablixColumn>
                                    <Width>1.45455cm</Width>
                                  </TablixColumn>
                                  <TablixColumn>
                                    <Width>1.45455cm</Width>
                                  </TablixColumn>
                                  <TablixColumn>
                                    <Width>1.45455cm</Width>
                                  </TablixColumn>
                                  <TablixColumn>
                                    <Width>1.15455cm</Width>
                                  </TablixColumn>
                                  <TablixColumn>
                                    <Width>1.75455cm</Width>
                                  </TablixColumn>
                                  <TablixColumn>
                                    <Width>1.45455cm</Width>
                                  </TablixColumn>
                                  <TablixColumn>
                                    <Width>1.15455cm</Width>
                                  </TablixColumn>
                                  <TablixColumn>
                                    <Width>4.60455cm</Width>
                                  </TablixColumn>
                                </TablixColumns>
                                <TablixRows>
                                  <TablixRow>
                                    <Height>0.6cm</Height>
                                    <TablixCells>
                                      <TablixCell>
                                        <CellContents>
                                          <Textbox Name="Textbox33">
                                            <CanGrow>true</CanGrow>
                                            <KeepTogether>true</KeepTogether>
                                            <Paragraphs>
                                              <Paragraph>
                                                <TextRuns>
                                                  <TextRun>
                                                    <Value EvaluationMode="Auto">=Fields!MachineCenterCap.Value</Value>
                                                    <Style>
                                                      <FontSize>7pt</FontSize>
                                                      <FontWeight>Bold</FontWeight>
                                                    </Style>
                                                  </TextRun>
                                                </TextRuns>
                                                <Style />
                                              </Paragraph>
                                            </Paragraphs>
                                            <rd:DefaultName>Textbox33</rd:DefaultName>
                                            <Style>
                                              <Border>
                                                <Color>LightGrey</Color>
                                              </Border>
                                              <VerticalAlign>Bottom</VerticalAlign>
                                              <PaddingLeft>2pt</PaddingLeft>
                                              <PaddingRight>2pt</PaddingRight>
                                              <PaddingTop>2pt</PaddingTop>
                                              <PaddingBottom>2pt</PaddingBottom>
                                            </Style>
                                          </Textbox>
                                          <ColSpan>2</ColSpan>
                                        </CellContents>
                                      </TablixCell>
                                      <TablixCell />
                                      <TablixCell>
                                        <CellContents>
                                          <Textbox Name="Textbox35">
                                            <CanGrow>true</CanGrow>
                                            <KeepTogether>true</KeepTogether>
                                            <Paragraphs>
                                              <Paragraph>
                                                <TextRuns>
                                                  <TextRun>
                                                    <Value EvaluationMode="Auto" />
                                                    <Style>
                                                      <FontSize>7pt</FontSize>
                                                      <FontWeight>Bold</FontWeight>
                                                    </Style>
                                                  </TextRun>
                                                </TextRuns>
                                                <Style />
                                              </Paragraph>
                                            </Paragraphs>
                                            <rd:DefaultName>Textbox35</rd:DefaultName>
                                            <Style>
                                              <Border>
                                                <Color>LightGrey</Color>
                                              </Border>
                                              <VerticalAlign>Bottom</VerticalAlign>
                                              <PaddingLeft>2pt</PaddingLeft>
                                              <PaddingRight>2pt</PaddingRight>
                                              <PaddingTop>2pt</PaddingTop>
                                              <PaddingBottom>2pt</PaddingBottom>
                                            </Style>
                                          </Textbox>
                                        </CellContents>
                                      </TablixCell>
                                      <TablixCell>
                                        <CellContents>
                                          <Textbox Name="Textbox36">
                                            <CanGrow>true</CanGrow>
                                            <KeepTogether>true</KeepTogether>
                                            <Paragraphs>
                                              <Paragraph>
                                                <TextRuns>
                                                  <TextRun>
                                                    <Value EvaluationMode="Auto">=Fields!MachineCenter.Value</Value>
                                                    <Style>
                                                      <FontSize>7pt</FontSize>
                                                      <FontWeight>Bold</FontWeight>
                                                    </Style>
                                                  </TextRun>
                                                </TextRuns>
                                                <Style />
                                              </Paragraph>
                                            </Paragraphs>
                                            <rd:DefaultName>Textbox36</rd:DefaultName>
                                            <Style>
                                              <Border>
                                                <Color>LightGrey</Color>
                                              </Border>
                                              <VerticalAlign>Bottom</VerticalAlign>
                                              <PaddingLeft>2pt</PaddingLeft>
                                              <PaddingRight>2pt</PaddingRight>
                                              <PaddingTop>2pt</PaddingTop>
                                              <PaddingBottom>2pt</PaddingBottom>
                                            </Style>
                                          </Textbox>
                                        </CellContents>
                                      </TablixCell>
                                      <TablixCell>
                                        <CellContents>
                                          <Textbox Name="Textbox37">
                                            <CanGrow>true</CanGrow>
                                            <KeepTogether>true</KeepTogether>
                                            <Paragraphs>
                                              <Paragraph>
                                                <TextRuns>
                                                  <TextRun>
                                                    <Value EvaluationMode="Auto">=Fields!ProdRess_Name.Value</Value>
                                                    <Style>
                                                      <FontSize>7pt</FontSize>
                                                      <FontWeight>Bold</FontWeight>
                                                    </Style>
                                                  </TextRun>
                                                </TextRuns>
                                                <Style />
                                              </Paragraph>
                                            </Paragraphs>
                                            <rd:DefaultName>Textbox37</rd:DefaultName>
                                            <Style>
                                              <Border>
                                                <Color>LightGrey</Color>
                                              </Border>
                                              <VerticalAlign>Bottom</VerticalAlign>
                                              <PaddingLeft>2pt</PaddingLeft>
                                              <PaddingRight>2pt</PaddingRight>
                                              <PaddingTop>2pt</PaddingTop>
                                              <PaddingBottom>2pt</PaddingBottom>
                                            </Style>
                                          </Textbox>
                                          <ColSpan>7</ColSpan>
                                        </CellContents>
                                      </TablixCell>
                                      <TablixCell />
                                      <TablixCell />
                                      <TablixCell />
                                      <TablixCell />
                                      <TablixCell />
                                      <TablixCell />
                                    </TablixCells>
                                  </TablixRow>
                                  <TablixRow>
                                    <Height>0.6cm</Height>
                                    <TablixCells>
                                      <TablixCell>
                                        <CellContents>
                                          <Textbox Name="MachineCenter2">
                                            <CanGrow>true</CanGrow>
                                            <KeepTogether>true</KeepTogether>
                                            <Paragraphs>
                                              <Paragraph>
                                                <TextRuns>
                                                  <TextRun>
                                                    <Value EvaluationMode="Auto">=Fields!AnsattnrCap.Value</Value>
                                                    <Style>
                                                      <FontSize>7pt</FontSize>
                                                      <FontWeight>Bold</FontWeight>
                                                    </Style>
                                                  </TextRun>
                                                </TextRuns>
                                                <Style />
                                              </Paragraph>
                                            </Paragraphs>
                                            <rd:DefaultName>MachineCenter</rd:DefaultName>
                                            <Style>
                                              <Border>
                                                <Color>LightGrey</Color>
                                              </Border>
                                              <VerticalAlign>Bottom</VerticalAlign>
                                              <PaddingLeft>2pt</PaddingLeft>
                                              <PaddingRight>2pt</PaddingRight>
                                              <PaddingTop>2pt</PaddingTop>
                                              <PaddingBottom>2pt</PaddingBottom>
                                            </Style>
                                          </Textbox>
                                        </CellContents>
                                      </TablixCell>
                                      <TablixCell>
                                        <CellContents>
                                          <Textbox Name="StartingDay2">
                                            <CanGrow>true</CanGrow>
                                            <KeepTogether>true</KeepTogether>
                                            <Paragraphs>
                                              <Paragraph>
                                                <TextRuns>
                                                  <TextRun>
                                                    <Value EvaluationMode="Auto">=Fields!StartingDayCap.Value</Value>
                                                    <Style>
                                                      <FontSize>7pt</FontSize>
                                                      <FontWeight>Bold</FontWeight>
                                                      <Format>dd.MM.yy</Format>
                                                    </Style>
                                                  </TextRun>
                                                </TextRuns>
                                                <Style />
                                              </Paragraph>
                                            </Paragraphs>
                                            <rd:DefaultName>StartingDay</rd:DefaultName>
                                            <Style>
                                              <Border>
                                                <Color>LightGrey</Color>
                                              </Border>
                                              <VerticalAlign>Bottom</VerticalAlign>
                                              <PaddingLeft>2pt</PaddingLeft>
                                              <PaddingRight>2pt</PaddingRight>
                                              <PaddingTop>2pt</PaddingTop>
                                              <PaddingBottom>2pt</PaddingBottom>
                                            </Style>
                                          </Textbox>
                                        </CellContents>
                                      </TablixCell>
                                      <TablixCell>
                                        <CellContents>
                                          <Textbox Name="StartDate2">
                                            <CanGrow>true</CanGrow>
                                            <KeepTogether>true</KeepTogether>
                                            <Paragraphs>
                                              <Paragraph>
                                                <TextRuns>
                                                  <TextRun>
                                                    <Value EvaluationMode="Auto">=Fields!StartDateCap.Value</Value>
                                                    <Style>
                                                      <FontSize>7pt</FontSize>
                                                      <FontWeight>Bold</FontWeight>
                                                      <Format>dd.MM.yy</Format>
                                                    </Style>
                                                  </TextRun>
                                                </TextRuns>
                                                <Style />
                                              </Paragraph>
                                            </Paragraphs>
                                            <rd:DefaultName>StartDate</rd:DefaultName>
                                            <Style>
                                              <Border>
                                                <Color>LightGrey</Color>
                                              </Border>
                                              <VerticalAlign>Bottom</VerticalAlign>
                                              <PaddingLeft>2pt</PaddingLeft>
                                              <PaddingRight>2pt</PaddingRight>
                                              <PaddingTop>2pt</PaddingTop>
                                              <PaddingBottom>2pt</PaddingBottom>
                                            </Style>
                                          </Textbox>
                                        </CellContents>
                                      </TablixCell>
                                      <TablixCell>
                                        <CellContents>
                                          <Textbox Name="StartTime2">
                                            <CanGrow>true</CanGrow>
                                            <KeepTogether>true</KeepTogether>
                                            <Paragraphs>
                                              <Paragraph>
                                                <TextRuns>
                                                  <TextRun>
                                                    <Value EvaluationMode="Auto">=Fields!StartTimeCap.Value</Value>
                                                    <Style>
                                                      <FontSize>7pt</FontSize>
                                                      <FontWeight>Bold</FontWeight>
                                                      <Format>HH:mm:ss</Format>
                                                    </Style>
                                                  </TextRun>
                                                </TextRuns>
                                                <Style />
                                              </Paragraph>
                                            </Paragraphs>
                                            <rd:DefaultName>StartTime</rd:DefaultName>
                                            <Style>
                                              <Border>
                                                <Color>LightGrey</Color>
                                              </Border>
                                              <VerticalAlign>Bottom</VerticalAlign>
                                              <PaddingLeft>2pt</PaddingLeft>
                                              <PaddingRight>2pt</PaddingRight>
                                              <PaddingTop>2pt</PaddingTop>
                                              <PaddingBottom>2pt</PaddingBottom>
                                            </Style>
                                          </Textbox>
                                        </CellContents>
                                      </TablixCell>
                                      <TablixCell>
                                        <CellContents>
                                          <Textbox Name="EndDate2">
                                            <CanGrow>true</CanGrow>
                                            <KeepTogether>true</KeepTogether>
                                            <Paragraphs>
                                              <Paragraph>
                                                <TextRuns>
                                                  <TextRun>
                                                    <Value EvaluationMode="Auto">=Fields!EndDateCap.Value</Value>
                                                    <Style>
                                                      <FontSize>7pt</FontSize>
                                                      <FontWeight>Bold</FontWeight>
                                                      <Format>dd.MM.yy</Format>
                                                    </Style>
                                                  </TextRun>
                                                </TextRuns>
                                                <Style />
                                              </Paragraph>
                                            </Paragraphs>
                                            <rd:DefaultName>EndDate</rd:DefaultName>
                                            <Style>
                                              <Border>
                                                <Color>LightGrey</Color>
                                              </Border>
                                              <VerticalAlign>Bottom</VerticalAlign>
                                              <PaddingLeft>2pt</PaddingLeft>
                                              <PaddingRight>2pt</PaddingRight>
                                              <PaddingTop>2pt</PaddingTop>
                                              <PaddingBottom>2pt</PaddingBottom>
                                            </Style>
                                          </Textbox>
                                        </CellContents>
                                      </TablixCell>
                                      <TablixCell>
                                        <CellContents>
                                          <Textbox Name="EndTime2">
                                            <CanGrow>true</CanGrow>
                                            <KeepTogether>true</KeepTogether>
                                            <Paragraphs>
                                              <Paragraph>
                                                <TextRuns>
                                                  <TextRun>
                                                    <Value EvaluationMode="Auto">=Fields!EndTimeCap.Value</Value>
                                                    <Style>
                                                      <FontSize>7pt</FontSize>
                                                      <FontWeight>Bold</FontWeight>
                                                      <Format>HH:mm:ss</Format>
                                                    </Style>
                                                  </TextRun>
                                                </TextRuns>
                                                <Style />
                                              </Paragraph>
                                            </Paragraphs>
                                            <rd:DefaultName>EndTime</rd:DefaultName>
                                            <Style>
                                              <Border>
                                                <Color>LightGrey</Color>
                                              </Border>
                                              <VerticalAlign>Bottom</VerticalAlign>
                                              <PaddingLeft>2pt</PaddingLeft>
                                              <PaddingRight>2pt</PaddingRight>
                                              <PaddingTop>2pt</PaddingTop>
                                              <PaddingBottom>2pt</PaddingBottom>
                                            </Style>
                                          </Textbox>
                                        </CellContents>
                                      </TablixCell>
                                      <TablixCell>
                                        <CellContents>
                                          <Textbox Name="Quantity2">
                                            <CanGrow>true</CanGrow>
                                            <KeepTogether>true</KeepTogether>
                                            <Paragraphs>
                                              <Paragraph>
                                                <TextRuns>
                                                  <TextRun>
                                                    <Value EvaluationMode="Auto">=Fields!QuantityCap.Value</Value>
                                                    <Style>
                                                      <FontSize>7pt</FontSize>
                                                      <FontWeight>Bold</FontWeight>
                                                      <Format>=Fields!QuantityFormat.Value</Format>
                                                    </Style>
                                                  </TextRun>
                                                </TextRuns>
                                                <Style />
                                              </Paragraph>
                                            </Paragraphs>
                                            <rd:DefaultName>Quantity</rd:DefaultName>
                                            <Style>
                                              <Border>
                                                <Color>LightGrey</Color>
                                              </Border>
                                              <VerticalAlign>Bottom</VerticalAlign>
                                              <PaddingLeft>2pt</PaddingLeft>
                                              <PaddingRight>2pt</PaddingRight>
                                              <PaddingTop>2pt</PaddingTop>
                                              <PaddingBottom>2pt</PaddingBottom>
                                            </Style>
                                          </Textbox>
                                        </CellContents>
                                      </TablixCell>
                                      <TablixCell>
                                        <CellContents>
                                          <Textbox Name="OverUnder2">
                                            <CanGrow>true</CanGrow>
                                            <KeepTogether>true</KeepTogether>
                                            <Paragraphs>
                                              <Paragraph>
                                                <TextRuns>
                                                  <TextRun>
                                                    <Value EvaluationMode="Auto">=Fields!OverUnderCap.Value</Value>
                                                    <Style>
                                                      <FontSize>7pt</FontSize>
                                                      <FontWeight>Bold</FontWeight>
                                                      <Format>=Fields!OverUnderFormat.Value</Format>
                                                    </Style>
                                                  </TextRun>
                                                </TextRuns>
                                                <Style />
                                              </Paragraph>
                                            </Paragraphs>
                                            <rd:DefaultName>OverUnder</rd:DefaultName>
                                            <Style>
                                              <Border>
                                                <Color>LightGrey</Color>
                                              </Border>
                                              <VerticalAlign>Bottom</VerticalAlign>
                                              <PaddingLeft>2pt</PaddingLeft>
                                              <PaddingRight>2pt</PaddingRight>
                                              <PaddingTop>2pt</PaddingTop>
                                              <PaddingBottom>2pt</PaddingBottom>
                                            </Style>
                                          </Textbox>
                                        </CellContents>
                                      </TablixCell>
                                      <TablixCell>
                                        <CellContents>
                                          <Textbox Name="SumPrUke2">
                                            <CanGrow>true</CanGrow>
                                            <KeepTogether>true</KeepTogether>
                                            <Paragraphs>
                                              <Paragraph>
                                                <TextRuns>
                                                  <TextRun>
                                                    <Value EvaluationMode="Auto">=Fields!SumPrUkeCap.Value</Value>
                                                    <Style>
                                                      <FontSize>7pt</FontSize>
                                                      <FontWeight>Bold</FontWeight>
                                                      <Format>=Fields!SumPrUkeFormat.Value</Format>
                                                    </Style>
                                                  </TextRun>
                                                </TextRuns>
                                                <Style />
                                              </Paragraph>
                                            </Paragraphs>
                                            <rd:DefaultName>SumPrUke</rd:DefaultName>
                                            <Style>
                                              <Border>
                                                <Color>LightGrey</Color>
                                              </Border>
                                              <VerticalAlign>Bottom</VerticalAlign>
                                              <PaddingLeft>2pt</PaddingLeft>
                                              <PaddingRight>2pt</PaddingRight>
                                              <PaddingTop>2pt</PaddingTop>
                                              <PaddingBottom>2pt</PaddingBottom>
                                            </Style>
                                          </Textbox>
                                        </CellContents>
                                      </TablixCell>
                                      <TablixCell>
                                        <CellContents>
                                          <Textbox Name="Absence2">
                                            <CanGrow>true</CanGrow>
                                            <KeepTogether>true</KeepTogether>
                                            <Paragraphs>
                                              <Paragraph>
                                                <TextRuns>
                                                  <TextRun>
                                                    <Value EvaluationMode="Auto">=Fields!AbsenceCap.Value</Value>
                                                    <Style>
                                                      <FontSize>7pt</FontSize>
                                                      <FontWeight>Bold</FontWeight>
                                                    </Style>
                                                  </TextRun>
                                                </TextRuns>
                                                <Style />
                                              </Paragraph>
                                            </Paragraphs>
                                            <rd:DefaultName>Absence</rd:DefaultName>
                                            <Style>
                                              <Border>
                                                <Color>LightGrey</Color>
                                              </Border>
                                              <VerticalAlign>Bottom</VerticalAlign>
                                              <PaddingLeft>2pt</PaddingLeft>
                                              <PaddingRight>2pt</PaddingRight>
                                              <PaddingTop>2pt</PaddingTop>
                                              <PaddingBottom>2pt</PaddingBottom>
                                            </Style>
                                          </Textbox>
                                        </CellContents>
                                      </TablixCell>
                                      <TablixCell>
                                        <CellContents>
                                          <Textbox Name="Textbox31">
                                            <CanGrow>true</CanGrow>
                                            <KeepTogether>true</KeepTogether>
                                            <Paragraphs>
                                              <Paragraph>
                                                <TextRuns>
                                                  <TextRun>
                                                    <Value EvaluationMode="Constant" />
                                                    <Style>
                                                      <FontSize>7pt</FontSize>
                                                      <FontWeight>Bold</FontWeight>
                                                    </Style>
                                                  </TextRun>
                                                </TextRuns>
                                                <Style />
                                              </Paragraph>
                                            </Paragraphs>
                                            <rd:DefaultName>Textbox31</rd:DefaultName>
                                            <Style>
                                              <Border>
                                                <Color>LightGrey</Color>
                                              </Border>
                                              <VerticalAlign>Bottom</VerticalAlign>
                                              <PaddingLeft>2pt</PaddingLeft>
                                              <PaddingRight>2pt</PaddingRight>
                                              <PaddingTop>2pt</PaddingTop>
                                              <PaddingBottom>2pt</PaddingBottom>
                                            </Style>
                                          </Textbox>
                                        </CellContents>
                                      </TablixCell>
                                    </TablixCells>
                                  </TablixRow>
                                  <TablixRow>
                                    <Height>0.423cm</Height>
                                    <TablixCells>
                                      <TablixCell>
                                        <CellContents>
                                          <Textbox Name="MachineCenter">
                                            <CanGrow>true</CanGrow>
                                            <KeepTogether>true</KeepTogether>
                                            <Paragraphs>
                                              <Paragraph>
                                                <TextRuns>
                                                  <TextRun>
                                                    <Value EvaluationMode="Auto">=Fields!MachineCenter.Value</Value>
                                                    <Style>
                                                      <FontSize>7pt</FontSize>
                                                    </Style>
                                                  </TextRun>
                                                </TextRuns>
                                                <Style />
                                              </Paragraph>
                                            </Paragraphs>
                                            <rd:DefaultName>MachineCenter</rd:DefaultName>
                                            <Style>
                                              <Border>
                                                <Color>LightGrey</Color>
                                              </Border>
                                              <PaddingLeft>2pt</PaddingLeft>
                                              <PaddingRight>2pt</PaddingRight>
                                              <PaddingTop>2pt</PaddingTop>
                                              <PaddingBottom>2pt</PaddingBottom>
                                            </Style>
                                          </Textbox>
                                        </CellContents>
                                      </TablixCell>
                                      <TablixCell>
                                        <CellContents>
                                          <Textbox Name="StartingDay">
                                            <CanGrow>true</CanGrow>
                                            <KeepTogether>true</KeepTogether>
                                            <Paragraphs>
                                              <Paragraph>
                                                <TextRuns>
                                                  <TextRun>
                                                    <Value EvaluationMode="Auto">=Fields!StartingDay.Value</Value>
                                                    <Style>
                                                      <FontSize>7pt</FontSize>
                                                      <Format>dd.MM.yy</Format>
                                                    </Style>
                                                  </TextRun>
                                                </TextRuns>
                                                <Style />
                                              </Paragraph>
                                            </Paragraphs>
                                            <rd:DefaultName>StartingDay</rd:DefaultName>
                                            <Style>
                                              <Border>
                                                <Color>LightGrey</Color>
                                              </Border>
                                              <PaddingLeft>2pt</PaddingLeft>
                                              <PaddingRight>2pt</PaddingRight>
                                              <PaddingTop>2pt</PaddingTop>
                                              <PaddingBottom>2pt</PaddingBottom>
                                            </Style>
                                          </Textbox>
                                        </CellContents>
                                      </TablixCell>
                                      <TablixCell>
                                        <CellContents>
                                          <Textbox Name="StartDate">
                                            <CanGrow>true</CanGrow>
                                            <KeepTogether>true</KeepTogether>
                                            <Paragraphs>
                                              <Paragraph>
                                                <TextRuns>
                                                  <TextRun>
                                                    <Value EvaluationMode="Auto">=Fields!StartDate.Value</Value>
                                                    <Style>
                                                      <FontSize>7pt</FontSize>
                                                      <Format>dd.MM.yy</Format>
                                                    </Style>
                                                  </TextRun>
                                                </TextRuns>
                                                <Style />
                                              </Paragraph>
                                            </Paragraphs>
                                            <rd:DefaultName>StartDate</rd:DefaultName>
                                            <Style>
                                              <Border>
                                                <Color>LightGrey</Color>
                                              </Border>
                                              <PaddingLeft>2pt</PaddingLeft>
                                              <PaddingRight>2pt</PaddingRight>
                                              <PaddingTop>2pt</PaddingTop>
                                              <PaddingBottom>2pt</PaddingBottom>
                                            </Style>
                                          </Textbox>
                                        </CellContents>
                                      </TablixCell>
                                      <TablixCell>
                                        <CellContents>
                                          <Textbox Name="StartTime">
                                            <CanGrow>true</CanGrow>
                                            <KeepTogether>true</KeepTogether>
                                            <Paragraphs>
                                              <Paragraph>
                                                <TextRuns>
                                                  <TextRun>
                                                    <Value EvaluationMode="Auto">=Fields!StartTime.Value</Value>
                                                    <Style>
                                                      <FontSize>7pt</FontSize>
                                                      <Format>HH:mm:ss</Format>
                                                    </Style>
                                                  </TextRun>
                                                </TextRuns>
                                                <Style />
                                              </Paragraph>
                                            </Paragraphs>
                                            <rd:DefaultName>StartTime</rd:DefaultName>
                                            <Style>
                                              <Border>
                                                <Color>LightGrey</Color>
                                              </Border>
                                              <PaddingLeft>2pt</PaddingLeft>
                                              <PaddingRight>2pt</PaddingRight>
                                              <PaddingTop>2pt</PaddingTop>
                                              <PaddingBottom>2pt</PaddingBottom>
                                            </Style>
                                          </Textbox>
                                        </CellContents>
                                      </TablixCell>
                                      <TablixCell>
                                        <CellContents>
                                          <Textbox Name="EndDate">
                                            <CanGrow>true</CanGrow>
                                            <KeepTogether>true</KeepTogether>
                                            <Paragraphs>
                                              <Paragraph>
                                                <TextRuns>
                                                  <TextRun>
                                                    <Value EvaluationMode="Auto">=Fields!EndDate.Value</Value>
                                                    <Style>
                                                      <FontSize>7pt</FontSize>
                                                      <Format>dd.MM.yy</Format>
                                                    </Style>
                                                  </TextRun>
                                                </TextRuns>
                                                <Style />
                                              </Paragraph>
                                            </Paragraphs>
                                            <rd:DefaultName>EndDate</rd:DefaultName>
                                            <Style>
                                              <Border>
                                                <Color>LightGrey</Color>
                                              </Border>
                                              <PaddingLeft>2pt</PaddingLeft>
                                              <PaddingRight>2pt</PaddingRight>
                                              <PaddingTop>2pt</PaddingTop>
                                              <PaddingBottom>2pt</PaddingBottom>
                                            </Style>
                                          </Textbox>
                                        </CellContents>
                                      </TablixCell>
                                      <TablixCell>
                                        <CellContents>
                                          <Textbox Name="EndTime">
                                            <CanGrow>true</CanGrow>
                                            <KeepTogether>true</KeepTogether>
                                            <Paragraphs>
                                              <Paragraph>
                                                <TextRuns>
                                                  <TextRun>
                                                    <Value EvaluationMode="Auto">=Fields!EndTime.Value</Value>
                                                    <Style>
                                                      <FontSize>7pt</FontSize>
                                                      <Format>HH:mm:ss</Format>
                                                    </Style>
                                                  </TextRun>
                                                </TextRuns>
                                                <Style />
                                              </Paragraph>
                                            </Paragraphs>
                                            <rd:DefaultName>EndTime</rd:DefaultName>
                                            <Style>
                                              <Border>
                                                <Color>LightGrey</Color>
                                              </Border>
                                              <PaddingLeft>2pt</PaddingLeft>
                                              <PaddingRight>2pt</PaddingRight>
                                              <PaddingTop>2pt</PaddingTop>
                                              <PaddingBottom>2pt</PaddingBottom>
                                            </Style>
                                          </Textbox>
                                        </CellContents>
                                      </TablixCell>
                                      <TablixCell>
                                        <CellContents>
                                          <Textbox Name="Quantity">
                                            <CanGrow>true</CanGrow>
                                            <KeepTogether>true</KeepTogether>
                                            <Paragraphs>
                                              <Paragraph>
                                                <TextRuns>
                                                  <TextRun>
                                                    <Value EvaluationMode="Auto">=Fields!Quantity.Value</Value>
                                                    <Style>
                                                      <FontSize>7pt</FontSize>
                                                      <Format>=Fields!QuantityFormat.Value</Format>
                                                    </Style>
                                                  </TextRun>
                                                </TextRuns>
                                                <Style />
                                              </Paragraph>
                                            </Paragraphs>
                                            <rd:DefaultName>Quantity</rd:DefaultName>
                                            <Style>
                                              <Border>
                                                <Color>LightGrey</Color>
                                              </Border>
                                              <PaddingLeft>2pt</PaddingLeft>
                                              <PaddingRight>2pt</PaddingRight>
                                              <PaddingTop>2pt</PaddingTop>
                                              <PaddingBottom>2pt</PaddingBottom>
                                            </Style>
                                          </Textbox>
                                        </CellContents>
                                      </TablixCell>
                                      <TablixCell>
                                        <CellContents>
                                          <Textbox Name="OverUnder">
                                            <CanGrow>true</CanGrow>
                                            <KeepTogether>true</KeepTogether>
                                            <Paragraphs>
                                              <Paragraph>
                                                <TextRuns>
                                                  <TextRun>
                                                    <Value EvaluationMode="Auto">=Fields!OverUnder.Value</Value>
                                                    <Style>
                                                      <FontSize>7pt</FontSize>
                                                      <Format>=Fields!OverUnderFormat.Value</Format>
                                                    </Style>
                                                  </TextRun>
                                                </TextRuns>
                                                <Style />
                                              </Paragraph>
                                            </Paragraphs>
                                            <rd:DefaultName>OverUnder</rd:DefaultName>
                                            <Style>
                                              <Border>
                                                <Color>LightGrey</Color>
                                              </Border>
                                              <PaddingLeft>2pt</PaddingLeft>
                                              <PaddingRight>2pt</PaddingRight>
                                              <PaddingTop>2pt</PaddingTop>
                                              <PaddingBottom>2pt</PaddingBottom>
                                            </Style>
                                          </Textbox>
                                        </CellContents>
                                      </TablixCell>
                                      <TablixCell>
                                        <CellContents>
                                          <Textbox Name="SumPrUke">
                                            <CanGrow>true</CanGrow>
                                            <KeepTogether>true</KeepTogether>
                                            <Paragraphs>
                                              <Paragraph>
                                                <TextRuns>
                                                  <TextRun>
                                                    <Value EvaluationMode="Auto">=Fields!SumPrUke.Value</Value>
                                                    <Style>
                                                      <FontSize>7pt</FontSize>
                                                      <Format>=Fields!SumPrUkeFormat.Value</Format>
                                                    </Style>
                                                  </TextRun>
                                                </TextRuns>
                                                <Style />
                                              </Paragraph>
                                            </Paragraphs>
                                            <rd:DefaultName>SumPrUke</rd:DefaultName>
                                            <Style>
                                              <Border>
                                                <Color>LightGrey</Color>
                                              </Border>
                                              <PaddingLeft>2pt</PaddingLeft>
                                              <PaddingRight>2pt</PaddingRight>
                                              <PaddingTop>2pt</PaddingTop>
                                              <PaddingBottom>2pt</PaddingBottom>
                                            </Style>
                                          </Textbox>
                                        </CellContents>
                                      </TablixCell>
                                      <TablixCell>
                                        <CellContents>
                                          <Textbox Name="Absence">
                                            <CanGrow>true</CanGrow>
                                            <KeepTogether>true</KeepTogether>
                                            <Paragraphs>
                                              <Paragraph>
                                                <TextRuns>
                                                  <TextRun>
                                                    <Value EvaluationMode="Auto">=Fields!Absence.Value</Value>
                                                    <Style>
                                                      <FontSize>7pt</FontSize>
                                                    </Style>
                                                  </TextRun>
                                                </TextRuns>
                                                <Style />
                                              </Paragraph>
                                            </Paragraphs>
                                            <rd:DefaultName>Absence</rd:DefaultName>
                                            <Style>
                                              <Border>
                                                <Color>LightGrey</Color>
                                              </Border>
                                              <PaddingLeft>2pt</PaddingLeft>
                                              <PaddingRight>2pt</PaddingRight>
                                              <PaddingTop>2pt</PaddingTop>
                                              <PaddingBottom>2pt</PaddingBottom>
                                            </Style>
                                          </Textbox>
                                        </CellContents>
                                      </TablixCell>
                                      <TablixCell>
                                        <CellContents>
                                          <Textbox Name="Description">
                                            <CanGrow>true</CanGrow>
                                            <KeepTogether>true</KeepTogether>
                                            <Paragraphs>
                                              <Paragraph>
                                                <TextRuns>
                                                  <TextRun>
                                                    <Value EvaluationMode="Auto">=Fields!Description.Value</Value>
                                                    <Style>
                                                      <FontSize>7pt</FontSize>
                                                    </Style>
                                                  </TextRun>
                                                </TextRuns>
                                                <Style />
                                              </Paragraph>
                                            </Paragraphs>
                                            <rd:DefaultName>Description</rd:DefaultName>
                                            <Style>
                                              <Border>
                                                <Color>LightGrey</Color>
                                              </Border>
                                              <PaddingLeft>2pt</PaddingLeft>
                                              <PaddingRight>2pt</PaddingRight>
                                              <PaddingTop>2pt</PaddingTop>
                                              <PaddingBottom>2pt</PaddingBottom>
                                            </Style>
                                          </Textbox>
                                        </CellContents>
                                      </TablixCell>
                                    </TablixCells>
                                  </TablixRow>
                                  <TablixRow>
                                    <Height>0.6cm</Height>
                                    <TablixCells>
                                      <TablixCell>
                                        <CellContents>
                                          <Tablix Name="Tablix5">
                                            <TablixBody>
                                              <TablixColumns>
                                                <TablixColumn>
                                                  <Width>4.545cm</Width>
                                                </TablixColumn>
                                                <TablixColumn>
                                                  <Width>1.245cm</Width>
                                                </TablixColumn>
                                                <TablixColumn>
                                                  <Width>2.545cm</Width>
                                                </TablixColumn>
                                                <TablixColumn>
                                                  <Width>1.845cm</Width>
                                                </TablixColumn>
                                                <TablixColumn>
                                                  <Width>1.545cm</Width>
                                                </TablixColumn>
                                                <TablixColumn>
                                                  <Width>1.845cm</Width>
                                                </TablixColumn>
                                                <TablixColumn>
                                                  <Width>0.945cm</Width>
                                                </TablixColumn>
                                                <TablixColumn>
                                                  <Width>0.945cm</Width>
                                                </TablixColumn>
                                                <TablixColumn>
                                                  <Width>0.645cm</Width>
                                                </TablixColumn>
                                                <TablixColumn>
                                                  <Width>2.895cm</Width>
                                                </TablixColumn>
                                              </TablixColumns>
                                              <TablixRows>
                                                <TablixRow>
                                                  <Height>0.6cm</Height>
                                                  <TablixCells>
                                                    <TablixCell>
                                                      <CellContents>
                                                        <Textbox Name="TotalString">
                                                          <CanGrow>true</CanGrow>
                                                          <KeepTogether>true</KeepTogether>
                                                          <Paragraphs>
                                                            <Paragraph>
                                                              <TextRuns>
                                                                <TextRun>
                                                                  <Value EvaluationMode="Auto">=Fields!TotalString.Value</Value>
                                                                  <Style>
                                                                    <FontSize>7pt</FontSize>
                                                                    <FontWeight>Bold</FontWeight>
                                                                  </Style>
                                                                </TextRun>
                                                              </TextRuns>
                                                              <Style />
                                                            </Paragraph>
                                                          </Paragraphs>
                                                          <rd:DefaultName>TotalString</rd:DefaultName>
                                                          <Style>
                                                            <Border>
                                                              <Color>LightGrey</Color>
                                                            </Border>
                                                            <VerticalAlign>Bottom</VerticalAlign>
                                                            <PaddingLeft>2pt</PaddingLeft>
                                                            <PaddingRight>2pt</PaddingRight>
                                                            <PaddingTop>2pt</PaddingTop>
                                                            <PaddingBottom>2pt</PaddingBottom>
                                                          </Style>
                                                        </Textbox>
                                                      </CellContents>
                                                    </TablixCell>
                                                    <TablixCell>
                                                      <CellContents>
                                                        <Textbox Name="MachineCenter1">
                                                          <CanGrow>true</CanGrow>
                                                          <KeepTogether>true</KeepTogether>
                                                          <Paragraphs>
                                                            <Paragraph>
                                                              <TextRuns>
                                                                <TextRun>
                                                                  <Value EvaluationMode="Auto">=Fields!MachineCenter.Value</Value>
                                                                  <Style>
                                                                    <FontSize>7pt</FontSize>
                                                                    <FontWeight>Bold</FontWeight>
                                                                  </Style>
                                                                </TextRun>
                                                              </TextRuns>
                                                              <Style />
                                                            </Paragraph>
                                                          </Paragraphs>
                                                          <rd:DefaultName>MachineCenter1</rd:DefaultName>
                                                          <Style>
                                                            <Border>
                                                              <Color>LightGrey</Color>
                                                            </Border>
                                                            <VerticalAlign>Bottom</VerticalAlign>
                                                            <PaddingLeft>2pt</PaddingLeft>
                                                            <PaddingRight>2pt</PaddingRight>
                                                            <PaddingTop>2pt</PaddingTop>
                                                            <PaddingBottom>2pt</PaddingBottom>
                                                          </Style>
                                                        </Textbox>
                                                      </CellContents>
                                                    </TablixCell>
                                                    <TablixCell>
                                                      <CellContents>
                                                        <Textbox Name="Textbox118">
                                                          <CanGrow>true</CanGrow>
                                                          <KeepTogether>true</KeepTogether>
                                                          <Paragraphs>
                                                            <Paragraph>
                                                              <TextRuns>
                                                                <TextRun>
                                                                  <Value EvaluationMode="Auto" />
                                                                  <Style>
                                                                    <FontSize>7pt</FontSize>
                                                                    <FontWeight>Bold</FontWeight>
                                                                  </Style>
                                                                </TextRun>
                                                              </TextRuns>
                                                              <Style />
                                                            </Paragraph>
                                                          </Paragraphs>
                                                          <rd:DefaultName>Textbox118</rd:DefaultName>
                                                          <Style>
                                                            <Border>
                                                              <Color>LightGrey</Color>
                                                            </Border>
                                                            <VerticalAlign>Bottom</VerticalAlign>
                                                            <PaddingLeft>2pt</PaddingLeft>
                                                            <PaddingRight>2pt</PaddingRight>
                                                            <PaddingTop>2pt</PaddingTop>
                                                            <PaddingBottom>2pt</PaddingBottom>
                                                          </Style>
                                                        </Textbox>
                                                      </CellContents>
                                                    </TablixCell>
                                                    <TablixCell>
                                                      <CellContents>
                                                        <Textbox Name="RoundedQty">
                                                          <CanGrow>true</CanGrow>
                                                          <KeepTogether>true</KeepTogether>
                                                          <Paragraphs>
                                                            <Paragraph>
                                                              <TextRuns>
                                                                <TextRun>
                                                                  <Value EvaluationMode="Auto">=SUM(Fields!RoundedQty.Value)</Value>
                                                                  <Style>
                                                                    <FontSize>7pt</FontSize>
                                                                    <FontWeight>Bold</FontWeight>
                                                                    <Format>=Fields!RoundedQtyFormat.Value</Format>
                                                                  </Style>
                                                                </TextRun>
                                                              </TextRuns>
                                                              <Style />
                                                            </Paragraph>
                                                          </Paragraphs>
                                                          <rd:DefaultName>RoundedQty</rd:DefaultName>
                                                          <Style>
                                                            <Border>
                                                              <Color>LightGrey</Color>
                                                            </Border>
                                                            <VerticalAlign>Bottom</VerticalAlign>
                                                            <PaddingLeft>2pt</PaddingLeft>
                                                            <PaddingRight>2pt</PaddingRight>
                                                            <PaddingTop>2pt</PaddingTop>
                                                            <PaddingBottom>2pt</PaddingBottom>
                                                          </Style>
                                                        </Textbox>
                                                      </CellContents>
                                                    </TablixCell>
                                                    <TablixCell>
                                                      <CellContents>
                                                        <Textbox Name="SumDagtrekk">
                                                          <CanGrow>true</CanGrow>
                                                          <KeepTogether>true</KeepTogether>
                                                          <Paragraphs>
                                                            <Paragraph>
                                                              <TextRuns>
                                                                <TextRun>
                                                                  <Value EvaluationMode="Auto">=LAST(Fields!SumDagtrekk.Value)</Value>
                                                                  <Style>
                                                                    <FontSize>7pt</FontSize>
                                                                    <FontWeight>Bold</FontWeight>
                                                                    <Format>=Fields!SumDagtrekkFormat.Value</Format>
                                                                  </Style>
                                                                </TextRun>
                                                              </TextRuns>
                                                              <Style />
                                                            </Paragraph>
                                                          </Paragraphs>
                                                          <rd:DefaultName>SumDagtrekk</rd:DefaultName>
                                                          <Style>
                                                            <Border>
                                                              <Color>LightGrey</Color>
                                                            </Border>
                                                            <VerticalAlign>Bottom</VerticalAlign>
                                                            <PaddingLeft>2pt</PaddingLeft>
                                                            <PaddingRight>2pt</PaddingRight>
                                                            <PaddingTop>2pt</PaddingTop>
                                                            <PaddingBottom>2pt</PaddingBottom>
                                                          </Style>
                                                        </Textbox>
                                                      </CellContents>
                                                    </TablixCell>
                                                    <TablixCell>
                                                      <CellContents>
                                                        <Textbox Name="AntallStemplinger">
                                                          <CanGrow>true</CanGrow>
                                                          <KeepTogether>true</KeepTogether>
                                                          <Paragraphs>
                                                            <Paragraph>
                                                              <TextRuns>
                                                                <TextRun>
                                                                  <Value EvaluationMode="Auto">=LAST(Fields!AntallStemplinger.Value)</Value>
                                                                  <Style>
                                                                    <FontSize>7pt</FontSize>
                                                                    <FontWeight>Bold</FontWeight>
                                                                  </Style>
                                                                </TextRun>
                                                              </TextRuns>
                                                              <Style />
                                                            </Paragraph>
                                                          </Paragraphs>
                                                          <rd:DefaultName>AntallStemplinger</rd:DefaultName>
                                                          <Style>
                                                            <Border>
                                                              <Color>LightGrey</Color>
                                                            </Border>
                                                            <VerticalAlign>Bottom</VerticalAlign>
                                                            <PaddingLeft>2pt</PaddingLeft>
                                                            <PaddingRight>2pt</PaddingRight>
                                                            <PaddingTop>2pt</PaddingTop>
                                                            <PaddingBottom>2pt</PaddingBottom>
                                                          </Style>
                                                        </Textbox>
                                                      </CellContents>
                                                    </TablixCell>
                                                    <TablixCell>
                                                      <CellContents>
                                                        <Textbox Name="AntallPoster">
                                                          <CanGrow>true</CanGrow>
                                                          <KeepTogether>true</KeepTogether>
                                                          <Paragraphs>
                                                            <Paragraph>
                                                              <TextRuns>
                                                                <TextRun>
                                                                  <Value EvaluationMode="Auto">=LAST(Fields!AntallPoster.Value)</Value>
                                                                  <Style>
                                                                    <FontSize>7pt</FontSize>
                                                                    <FontWeight>Bold</FontWeight>
                                                                  </Style>
                                                                </TextRun>
                                                              </TextRuns>
                                                              <Style />
                                                            </Paragraph>
                                                          </Paragraphs>
                                                          <rd:DefaultName>AntallPoster</rd:DefaultName>
                                                          <Style>
                                                            <Border>
                                                              <Color>LightGrey</Color>
                                                            </Border>
                                                            <VerticalAlign>Bottom</VerticalAlign>
                                                            <PaddingLeft>2pt</PaddingLeft>
                                                            <PaddingRight>2pt</PaddingRight>
                                                            <PaddingTop>2pt</PaddingTop>
                                                            <PaddingBottom>2pt</PaddingBottom>
                                                          </Style>
                                                        </Textbox>
                                                      </CellContents>
                                                    </TablixCell>
                                                    <TablixCell>
                                                      <CellContents>
                                                        <Textbox Name="Derav">
                                                          <CanGrow>true</CanGrow>
                                                          <KeepTogether>true</KeepTogether>
                                                          <Paragraphs>
                                                            <Paragraph>
                                                              <TextRuns>
                                                                <TextRun>
                                                                  <Value EvaluationMode="Auto">=LAST(Fields!Derav.Value)</Value>
                                                                  <Style>
                                                                    <FontSize>7pt</FontSize>
                                                                    <FontWeight>Bold</FontWeight>
                                                                  </Style>
                                                                </TextRun>
                                                              </TextRuns>
                                                              <Style />
                                                            </Paragraph>
                                                          </Paragraphs>
                                                          <rd:DefaultName>Derav</rd:DefaultName>
                                                          <Style>
                                                            <Border>
                                                              <Color>LightGrey</Color>
                                                            </Border>
                                                            <VerticalAlign>Bottom</VerticalAlign>
                                                            <PaddingLeft>2pt</PaddingLeft>
                                                            <PaddingRight>2pt</PaddingRight>
                                                            <PaddingTop>2pt</PaddingTop>
                                                            <PaddingBottom>2pt</PaddingBottom>
                                                          </Style>
                                                        </Textbox>
                                                      </CellContents>
                                                    </TablixCell>
                                                    <TablixCell>
                                                      <CellContents>
                                                        <Textbox Name="Helgedager">
                                                          <CanGrow>true</CanGrow>
                                                          <KeepTogether>true</KeepTogether>
                                                          <Paragraphs>
                                                            <Paragraph>
                                                              <TextRuns>
                                                                <TextRun>
                                                                  <Value EvaluationMode="Auto">=LAST(Fields!Helgedager.Value)</Value>
                                                                  <Style>
                                                                    <FontSize>7pt</FontSize>
                                                                    <FontWeight>Bold</FontWeight>
                                                                  </Style>
                                                                </TextRun>
                                                              </TextRuns>
                                                              <Style />
                                                            </Paragraph>
                                                          </Paragraphs>
                                                          <rd:DefaultName>Helgedager</rd:DefaultName>
                                                          <Style>
                                                            <Border>
                                                              <Color>LightGrey</Color>
                                                            </Border>
                                                            <VerticalAlign>Bottom</VerticalAlign>
                                                            <PaddingLeft>2pt</PaddingLeft>
                                                            <PaddingRight>2pt</PaddingRight>
                                                            <PaddingTop>2pt</PaddingTop>
                                                            <PaddingBottom>2pt</PaddingBottom>
                                                          </Style>
                                                        </Textbox>
                                                      </CellContents>
                                                    </TablixCell>
                                                    <TablixCell>
                                                      <CellContents>
                                                        <Textbox Name="Helg">
                                                          <CanGrow>true</CanGrow>
                                                          <KeepTogether>true</KeepTogether>
                                                          <Paragraphs>
                                                            <Paragraph>
                                                              <TextRuns>
                                                                <TextRun>
                                                                  <Value EvaluationMode="Auto">=LAST(Fields!Helg.Value)</Value>
                                                                  <Style>
                                                                    <FontSize>7pt</FontSize>
                                                                    <FontWeight>Bold</FontWeight>
                                                                  </Style>
                                                                </TextRun>
                                                              </TextRuns>
                                                              <Style />
                                                            </Paragraph>
                                                          </Paragraphs>
                                                          <rd:DefaultName>Helg</rd:DefaultName>
                                                          <Style>
                                                            <Border>
                                                              <Color>LightGrey</Color>
                                                            </Border>
                                                            <VerticalAlign>Bottom</VerticalAlign>
                                                            <PaddingLeft>2pt</PaddingLeft>
                                                            <PaddingRight>2pt</PaddingRight>
                                                            <PaddingTop>2pt</PaddingTop>
                                                            <PaddingBottom>2pt</PaddingBottom>
                                                          </Style>
                                                        </Textbox>
                                                      </CellContents>
                                                    </TablixCell>
                                                  </TablixCells>
                                                </TablixRow>
                                              </TablixRows>
                                            </TablixBody>
                                            <TablixColumnHierarchy>
                                              <TablixMembers>
                                                <TablixMember />
                                                <TablixMember />
                                                <TablixMember />
                                                <TablixMember />
                                                <TablixMember />
                                                <TablixMember />
                                                <TablixMember />
                                                <TablixMember />
                                                <TablixMember />
                                                <TablixMember />
                                              </TablixMembers>
                                            </TablixColumnHierarchy>
                                            <TablixRowHierarchy>
                                              <TablixMembers>
                                                <TablixMember />
                                              </TablixMembers>
                                            </TablixRowHierarchy>
                                            <DataSetName>DataSet_Result</DataSetName>
                                            <Style>
                                              <Border>
                                                <Style>None</Style>
                                              </Border>
                                            </Style>
                                          </Tablix>
                                          <ColSpan>11</ColSpan>
                                        </CellContents>
                                      </TablixCell>
                                      <TablixCell />
                                      <TablixCell />
                                      <TablixCell />
                                      <TablixCell />
                                      <TablixCell />
                                      <TablixCell />
                                      <TablixCell />
                                      <TablixCell />
                                      <TablixCell />
                                      <TablixCell />
                                    </TablixCells>
                                  </TablixRow>
                                </TablixRows>
                              </TablixBody>
                              <TablixColumnHierarchy>
                                <TablixMembers>
                                  <TablixMember />
                                  <TablixMember />
                                  <TablixMember />
                                  <TablixMember />
                                  <TablixMember />
                                  <TablixMember />
                                  <TablixMember />
                                  <TablixMember />
                                  <TablixMember />
                                  <TablixMember />
                                  <TablixMember />
                                </TablixMembers>
                              </TablixColumnHierarchy>
                              <TablixRowHierarchy>
                                <TablixMembers>
                                  <TablixMember>
                                    <KeepWithGroup>After</KeepWithGroup>
                                  </TablixMember>
                                  <TablixMember>
                                    <KeepWithGroup>After</KeepWithGroup>
                                  </TablixMember>
                                  <TablixMember>
                                    <Group Name="Details1" />
                                  </TablixMember>
                                  <TablixMember>
                                    <KeepWithGroup>Before</KeepWithGroup>
                                  </TablixMember>
                                </TablixMembers>
                              </TablixRowHierarchy>
                              <DataSetName>DataSet_Result</DataSetName>
                              <Top>0.24024cm</Top>
                              <Height>2.223cm</Height>
                              <Width>19cm</Width>
                              <ZIndex>1</ZIndex>
                              <Style>
                                <Border>
                                  <Style>None</Style>
                                </Border>
                              </Style>
                            </Tablix>
                          </ReportItems>
                          <KeepTogether>true</KeepTogether>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                          </Style>
                        </Rectangle>
                      </CellContents>
                    </TablixCell>
                  </TablixCells>
                </TablixRow>
              </TablixRows>
            </TablixBody>
            <TablixColumnHierarchy>
              <TablixMembers>
                <TablixMember />
              </TablixMembers>
            </TablixColumnHierarchy>
            <TablixRowHierarchy>
              <TablixMembers>
                <TablixMember>
                  <Group Name="Details">
                    <GroupExpressions>
                      <GroupExpression>=Fields!MachineCenter.Value</GroupExpression>
                    </GroupExpressions>
                    <PageBreak>
                      <BreakLocation>Between</BreakLocation>
                    </PageBreak>
                  </Group>
                </TablixMember>
              </TablixMembers>
            </TablixRowHierarchy>
            <DataSetName>DataSet_Result</DataSetName>
            <Left>0cm</Left>
            <Height>2.46324cm</Height>
            <Width>19cm</Width>
            <Style>
              <Border>
                <Style>None</Style>
              </Border>
            </Style>
          </Tablix>
        </ReportItems>
        <Height>2.46324cm</Height>
        <Style />
      </Body>
      <Width>19.00001cm</Width>
      <Page>
        <PageHeader>
          <Height>1.32292cm</Height>
          <PrintOnFirstPage>true</PrintOnFirstPage>
          <PrintOnLastPage>true</PrintOnLastPage>
          <ReportItems>
            <Textbox Name="Textbox1">
              <CanGrow>true</CanGrow>
              <KeepTogether>true</KeepTogether>
              <Paragraphs>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Value EvaluationMode="Auto">=Code.GetData(1,1) ''</Value>
                      <Style>
                        <FontSize>7pt</FontSize>
                      </Style>
                    </TextRun>
                  </TextRuns>
                  <Style />
                </Paragraph>
              </Paragraphs>
              <rd:DefaultName>Textbox1</rd:DefaultName>
              <Left>0cm</Left>
              <Height>0.423cm</Height>
              <Width>12.76583cm</Width>
              <Style>
                <Border>
                  <Style>None</Style>
                </Border>
                <PaddingLeft>2pt</PaddingLeft>
                <PaddingRight>2pt</PaddingRight>
                <PaddingTop>2pt</PaddingTop>
                <PaddingBottom>2pt</PaddingBottom>
              </Style>
            </Textbox>
            <Textbox Name="Textbox3">
              <CanGrow>true</CanGrow>
              <KeepTogether>true</KeepTogether>
              <Paragraphs>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Value EvaluationMode="Auto">=Code.GetData(2,1) ''</Value>
                      <Style>
                        <FontSize>7pt</FontSize>
                      </Style>
                    </TextRun>
                  </TextRuns>
                  <Style />
                </Paragraph>
              </Paragraphs>
              <rd:DefaultName>Textbox1</rd:DefaultName>
              <Top>0.423cm</Top>
              <Height>0.423cm</Height>
              <Width>12.76584cm</Width>
              <ZIndex>1</ZIndex>
              <Style>
                <Border>
                  <Style>None</Style>
                </Border>
                <PaddingLeft>2pt</PaddingLeft>
                <PaddingRight>2pt</PaddingRight>
                <PaddingTop>2pt</PaddingTop>
                <PaddingBottom>2pt</PaddingBottom>
              </Style>
            </Textbox>
            <Textbox Name="Textbox5">
              <CanGrow>true</CanGrow>
              <KeepTogether>true</KeepTogether>
              <Paragraphs>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Value EvaluationMode="Auto">=Code.GetData(3,1) ''</Value>
                      <Style>
                        <FontSize>7pt</FontSize>
                      </Style>
                    </TextRun>
                  </TextRuns>
                  <Style>
                    <TextAlign>Right</TextAlign>
                  </Style>
                </Paragraph>
              </Paragraphs>
              <rd:DefaultName>Textbox1</rd:DefaultName>
              <Left>12.76584cm</Left>
              <Height>0.423cm</Height>
              <Width>6.23417cm</Width>
              <ZIndex>2</ZIndex>
              <Style>
                <Border>
                  <Style>None</Style>
                </Border>
                <PaddingLeft>2pt</PaddingLeft>
                <PaddingRight>2pt</PaddingRight>
                <PaddingTop>2pt</PaddingTop>
                <PaddingBottom>2pt</PaddingBottom>
              </Style>
            </Textbox>
            <Textbox Name="Textbox7">
              <CanGrow>true</CanGrow>
              <KeepTogether>true</KeepTogether>
              <Paragraphs>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Value EvaluationMode="Auto">=REPLACE(REPLACE(Code.GetData(4,1), "%1", Globals!PageNumber), "%2", Globals!TotalPages)</Value>
                      <Style>
                        <FontSize>7pt</FontSize>
                      </Style>
                    </TextRun>
                  </TextRuns>
                  <Style>
                    <TextAlign>Right</TextAlign>
                  </Style>
                </Paragraph>
              </Paragraphs>
              <rd:DefaultName>Textbox1</rd:DefaultName>
              <Top>0.423cm</Top>
              <Left>12.76584cm</Left>
              <Height>0.423cm</Height>
              <Width>6.23417cm</Width>
              <ZIndex>3</ZIndex>
              <Style>
                <Border>
                  <Style>None</Style>
                </Border>
                <PaddingLeft>2pt</PaddingLeft>
                <PaddingRight>2pt</PaddingRight>
                <PaddingTop>2pt</PaddingTop>
                <PaddingBottom>2pt</PaddingBottom>
              </Style>
            </Textbox>
          </ReportItems>
          <Style>
            <Border>
              <Style>None</Style>
            </Border>
          </Style>
        </PageHeader>
        <PageHeight>29.7cm</PageHeight>
        <PageWidth>21cm</PageWidth>
        <LeftMargin>1cm</LeftMargin>
        <TopMargin>1cm</TopMargin>
        <BottomMargin>1cm</BottomMargin>
        <ColumnSpacing>1.27cm</ColumnSpacing>
        <Style />
      </Page>
    </ReportSection>
  </ReportSections>
  <Code>Public Function BlankZero(ByVal Value As Decimal)
    if Value = 0 then
        Return ""
    end if
    Return Value
End Function

Public Function BlankPos(ByVal Value As Decimal)
    if Value &gt; 0 then
        Return ""
    end if
    Return Value
End Function

Public Function BlankZeroAndPos(ByVal Value As Decimal)
    if Value &gt;= 0 then
        Return ""
    end if
    Return Value
End Function

Public Function BlankNeg(ByVal Value As Decimal)
    if Value &lt; 0 then
        Return ""
    end if
    Return Value
End Function

Public Function BlankNegAndZero(ByVal Value As Decimal)
    if Value &lt;= 0 then
        Return ""
    end if
    Return Value
End Function


Shared Data1 as Object
Shared Data2 as Object
Shared Data3 as Object
Shared Data4 as Object
Shared Data5 as Object
Shared Data6 as Object
Shared Data7 as Object
Shared Data10 as Object

Public Function GetData(Num as Integer, Group as integer) as Object
if Group = 1 then
   Return Cstr(Choose(Num, Split(Cstr(Data1),Chr(177))))
End If

if Group = 2 then
   Return Cstr(Choose(Num, Split(Cstr(Data2),Chr(177))))
End If

if Group = 3 then
   Return Cstr(Choose(Num, Split(Cstr(Data3),Chr(177))))
End If

if Group = 4 then
   Return Cstr(Choose(Num, Split(Cstr(Data4),Chr(177))))
End If

if Group = 5 then
   Return Cstr(Choose(Num, Split(Cstr(Data5),Chr(177))))
End If

if Group = 6 then
   Return Cstr(Choose(Num, Split(Cstr(Data6),Chr(177))))
End If

if Group = 7 then
   Return Cstr(Choose(Num, Split(Cstr(Data7),Chr(177))))
End If

if Group = 10 then
   Return Cstr(Choose(Num, Split(Cstr(Data10),Chr(177))))
End If
End Function

Public Function SetData(NewData as Object,Group as integer)
  If Group = 1 and NewData &gt; "" Then
      Data1 = NewData
  End If

  If Group = 2 and NewData &gt; "" Then
      Data2 = NewData
  End If

  If Group = 3 and NewData &gt; "" Then
      Data3 = NewData
  End If

  If Group = 4 and NewData &gt; "" Then
      Data4 = NewData
  End If

  If Group = 5 and NewData &gt; "" Then
      Data5 = NewData
  End If

  If Group = 6 and NewData &gt; "" Then
      Data6 = NewData
  End If

  If Group = 7 and NewData &gt; "" Then
      Data7 = NewData
  End If

  If Group = 10 and NewData &gt; "" Then
      Data10 = NewData
  End If
End Function</Code>
  <Language>=User!Language</Language>
  <ConsumeContainerWhitespace>true</ConsumeContainerWhitespace>
  <rd:ReportUnitType>Cm</rd:ReportUnitType>
  <rd:ReportID>0eeb6585-38ae-40f1-885b-8d50088d51b4</rd:ReportID>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 83001 OPC Indirect Time
{
  OBJECT-PROPERTIES
  {
    Date=20.09.17;
    Time=15:17:24;
    Modified=Yes;
    Version List=OPC6.01;
  }
  PROPERTIES
  {
    CaptionML=[ENU=OPC Indirect Time;
               NOR=OPC Indirekte tid];
  }
  DATASET
  {
    { 1101103000;;DataItem;                  ;
               DataItemTable=Table5832;
               DataItemTableView=SORTING(Document No.,Stop Code,No.,Posting Date)
                                 WHERE(Document No.=CONST(IND.TID));
               OnPreDataItem=BEGIN
                               LastFieldNo := FIELDNO("Stop Code");
                             END;

               OnAfterGetRecord=BEGIN
                                  //hhe 17.21.09->
                                  IF MachCenter.GET("No.") THEN BEGIN
                                  END;
                                  //he 17.12.09 <-
                                END;

               ReqFilterFields=Stop Code,Posting Date,Type,No. }

    { 1101103001;1;Column;C_INC_ReportTitle  ;
               SourceExpr=C_INC_ReportTitle }

    { 1101103002;1;Column;COMPANYNAME        ;
               SourceExpr=COMPANYNAME }

    { 1101103003;1;Column;TODAY              ;
               SourceExpr=FORMAT(TODAY,0,4) }

    { 1101103005;1;Column;C_INC_PageCap      ;
               SourceExpr=C_INC_PageCap }

    { 1101103004;1;Column;USERID             ;
               SourceExpr=USERID }

    { 1101103006;1;Column;C_INC_Stoppkode    ;
               SourceExpr=C_INC_Stoppkode }

    { 1101103007;1;Column;C_INC_QtyHours     ;
               SourceExpr=C_INC_QtyHours }

    { 1101103008;1;Column;StopCode           ;
               SourceExpr="Stop Code" }

    { 1101103009;1;Column;DocumentNo         ;
               SourceExpr="Document No." }

    { 1101103010;1;Column;PostingDate        ;
               SourceExpr="Posting Date" }

    { 1101103011;1;Column;No                 ;
               SourceExpr="No." }

    { 1101103012;1;Column;MachCenterName     ;
               SourceExpr=MachCenter.Name }

    { 1101103013;1;Column;Quantity           ;
               SourceExpr=Quantity }

    { 1101103014;1;Column;SumString          ;
               SourceExpr='Sum for ' + "Stop Code" }

    { 1101103015;1;Column;C_INC_TotalQtyHours;
               SourceExpr=C_INC_TotalQtyHours }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      LastFieldNo@1101103002 : Integer;
      FooterPrinted@1101103001 : Boolean;
      MachCenter@1101103000 : Record 99000758;
      TotalFor@1101103003 : TextConst 'NOR="Sum for "';
      C_INC_ReportTitle@1101103004 : TextConst 'ENU=Capacity Ledger Entry;NOR=Indirekte tid';
      C_INC_PageCap@1101103005 : TextConst 'ENU=Page %1 of %2;NOR=Side %1 av %2';
      C_INC_Stoppkode@1101103006 : TextConst 'NOR=Stoppkode';
      C_INC_QtyHours@1101103007 : TextConst 'NOR=Antall timer';
      C_INC_TotalQtyHours@1101103008 : TextConst 'NOR=TOTALT ANTALL TIMER';

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. des2009  hhe Opprettet rapporten
      02. 24.03.10 hhe Ny sorteringsn›kkel " " (skaper Sub-totaler til Mette sin rapport: sum tid pr. ansatt for Ind.tid.kode)
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner" xmlns:cl="http://schemas.microsoft.com/sqlserver/reporting/2010/01/componentdefinition" xmlns="http://schemas.microsoft.com/sqlserver/reporting/2010/01/reportdefinition">
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
      <rd:DataSourceID>0993dfdc-018c-4e90-a154-8503f4cd1ed4</rd:DataSourceID>
    </DataSource>
  </DataSources>
  <DataSets>
    <DataSet Name="DataSet_Result">
      <Query>
        <DataSourceName>DataSource</DataSourceName>
        <CommandText />
      </Query>
      <Fields>
        <Field Name="C_INC_ReportTitle">
          <DataField>C_INC_ReportTitle</DataField>
        </Field>
        <Field Name="COMPANYNAME">
          <DataField>COMPANYNAME</DataField>
        </Field>
        <Field Name="TODAY">
          <DataField>TODAY</DataField>
        </Field>
        <Field Name="C_INC_PageCap">
          <DataField>C_INC_PageCap</DataField>
        </Field>
        <Field Name="USERID">
          <DataField>USERID</DataField>
        </Field>
        <Field Name="C_INC_Stoppkode">
          <DataField>C_INC_Stoppkode</DataField>
        </Field>
        <Field Name="C_INC_QtyHours">
          <DataField>C_INC_QtyHours</DataField>
        </Field>
        <Field Name="StopCode">
          <DataField>StopCode</DataField>
        </Field>
        <Field Name="DocumentNo">
          <DataField>DocumentNo</DataField>
        </Field>
        <Field Name="PostingDate">
          <DataField>PostingDate</DataField>
        </Field>
        <Field Name="No">
          <DataField>No</DataField>
        </Field>
        <Field Name="MachCenterName">
          <DataField>MachCenterName</DataField>
        </Field>
        <Field Name="Quantity">
          <DataField>Quantity</DataField>
        </Field>
        <Field Name="QuantityFormat">
          <DataField>QuantityFormat</DataField>
        </Field>
        <Field Name="SumString">
          <DataField>SumString</DataField>
        </Field>
        <Field Name="C_INC_TotalQtyHours">
          <DataField>C_INC_TotalQtyHours</DataField>
        </Field>
      </Fields>
      <rd:DataSetInfo>
        <rd:DataSetName>DataSet</rd:DataSetName>
        <rd:SchemaPath>Report.xsd</rd:SchemaPath>
        <rd:TableName>Result</rd:TableName>
      </rd:DataSetInfo>
    </DataSet>
  </DataSets>
  <ReportSections>
    <ReportSection>
      <Body>
        <ReportItems>
          <Tablix Name="Tablix1">
            <TablixBody>
              <TablixColumns>
                <TablixColumn>
                  <Width>19cm</Width>
                </TablixColumn>
              </TablixColumns>
              <TablixRows>
                <TablixRow>
                  <Height>1.74174cm</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Rectangle Name="Rectangle1">
                          <ReportItems>
                            <Tablix Name="Tablix2">
                              <TablixBody>
                                <TablixColumns>
                                  <TablixColumn>
                                    <Width>0.64792cm</Width>
                                  </TablixColumn>
                                  <TablixColumn>
                                    <Width>0.64792cm</Width>
                                  </TablixColumn>
                                </TablixColumns>
                                <TablixRows>
                                  <TablixRow>
                                    <Height>0.15021cm</Height>
                                    <TablixCells>
                                      <TablixCell>
                                        <CellContents>
                                          <Textbox Name="Textbox1">
                                            <CanGrow>true</CanGrow>
                                            <KeepTogether>true</KeepTogether>
                                            <Paragraphs>
                                              <Paragraph>
                                                <TextRuns>
                                                  <TextRun>
                                                    <Value EvaluationMode="Auto" />
                                                    <Style />
                                                  </TextRun>
                                                </TextRuns>
                                                <Style />
                                              </Paragraph>
                                            </Paragraphs>
                                            <rd:DefaultName>Textbox1</rd:DefaultName>
                                            <Visibility>
                                              <Hidden>=Code.SetData(
Cstr(Fields!C_INC_ReportTitle.Value) + Chr(177) +
Cstr(Fields!COMPANYNAME.Value) + Chr(177) +
Cstr(Fields!TODAY.Value) + Chr(177) +
Cstr(Fields!C_INC_PageCap.Value) + Chr(177) +
Cstr(Fields!USERID.Value)
,1)</Hidden>
                                            </Visibility>
                                            <Style>
                                              <Border>
                                                <Color>LightGrey</Color>
                                              </Border>
                                              <PaddingLeft>2pt</PaddingLeft>
                                              <PaddingRight>2pt</PaddingRight>
                                              <PaddingTop>2pt</PaddingTop>
                                              <PaddingBottom>2pt</PaddingBottom>
                                            </Style>
                                          </Textbox>
                                        </CellContents>
                                      </TablixCell>
                                      <TablixCell>
                                        <CellContents>
                                          <Textbox Name="Textbox5">
                                            <CanGrow>true</CanGrow>
                                            <KeepTogether>true</KeepTogether>
                                            <Paragraphs>
                                              <Paragraph>
                                                <TextRuns>
                                                  <TextRun>
                                                    <Value EvaluationMode="Auto" />
                                                    <Style />
                                                  </TextRun>
                                                </TextRuns>
                                                <Style />
                                              </Paragraph>
                                            </Paragraphs>
                                            <rd:DefaultName>Textbox5</rd:DefaultName>
                                            <Style>
                                              <Border>
                                                <Color>LightGrey</Color>
                                              </Border>
                                              <PaddingLeft>2pt</PaddingLeft>
                                              <PaddingRight>2pt</PaddingRight>
                                              <PaddingTop>2pt</PaddingTop>
                                              <PaddingBottom>2pt</PaddingBottom>
                                            </Style>
                                          </Textbox>
                                        </CellContents>
                                      </TablixCell>
                                    </TablixCells>
                                  </TablixRow>
                                </TablixRows>
                              </TablixBody>
                              <TablixColumnHierarchy>
                                <TablixMembers>
                                  <TablixMember />
                                  <TablixMember />
                                </TablixMembers>
                              </TablixColumnHierarchy>
                              <TablixRowHierarchy>
                                <TablixMembers>
                                  <TablixMember />
                                </TablixMembers>
                              </TablixRowHierarchy>
                              <Height>0.15021cm</Height>
                              <Width>1.29583cm</Width>
                              <Style>
                                <Border>
                                  <Style>None</Style>
                                </Border>
                              </Style>
                            </Tablix>
                            <Tablix Name="Tablix3">
                              <TablixBody>
                                <TablixColumns>
                                  <TablixColumn>
                                    <Width>1.91892cm</Width>
                                  </TablixColumn>
                                  <TablixColumn>
                                    <Width>1.91892cm</Width>
                                  </TablixColumn>
                                  <TablixColumn>
                                    <Width>1.91892cm</Width>
                                  </TablixColumn>
                                  <TablixColumn>
                                    <Width>2.21892cm</Width>
                                  </TablixColumn>
                                  <TablixColumn>
                                    <Width>3.71892cm</Width>
                                  </TablixColumn>
                                  <TablixColumn>
                                    <Width>2.91892cm</Width>
                                  </TablixColumn>
                                </TablixColumns>
                                <TablixRows>
                                  <TablixRow>
                                    <Height>0.423cm</Height>
                                    <TablixCells>
                                      <TablixCell>
                                        <CellContents>
                                          <Textbox Name="C_INC_Stoppkode">
                                            <CanGrow>true</CanGrow>
                                            <KeepTogether>true</KeepTogether>
                                            <Paragraphs>
                                              <Paragraph>
                                                <TextRuns>
                                                  <TextRun>
                                                    <Value EvaluationMode="Auto">=Fields!C_INC_Stoppkode.Value</Value>
                                                    <Style>
                                                      <FontSize>9pt</FontSize>
                                                      <FontWeight>Bold</FontWeight>
                                                    </Style>
                                                  </TextRun>
                                                </TextRuns>
                                                <Style />
                                              </Paragraph>
                                            </Paragraphs>
                                            <rd:DefaultName>C_INC_Stoppkode</rd:DefaultName>
                                            <Style>
                                              <Border>
                                                <Style>None</Style>
                                              </Border>
                                              <PaddingLeft>2pt</PaddingLeft>
                                              <PaddingRight>2pt</PaddingRight>
                                              <PaddingTop>2pt</PaddingTop>
                                              <PaddingBottom>2pt</PaddingBottom>
                                            </Style>
                                          </Textbox>
                                          <ColSpan>2</ColSpan>
                                        </CellContents>
                                      </TablixCell>
                                      <TablixCell />
                                      <TablixCell>
                                        <CellContents>
                                          <Textbox Name="StopCode">
                                            <CanGrow>true</CanGrow>
                                            <KeepTogether>true</KeepTogether>
                                            <Paragraphs>
                                              <Paragraph>
                                                <TextRuns>
                                                  <TextRun>
                                                    <Value EvaluationMode="Auto">=Fields!StopCode.Value</Value>
                                                    <Style>
                                                      <FontSize>9pt</FontSize>
                                                      <FontWeight>Bold</FontWeight>
                                                    </Style>
                                                  </TextRun>
                                                </TextRuns>
                                                <Style />
                                              </Paragraph>
                                            </Paragraphs>
                                            <rd:DefaultName>StopCode</rd:DefaultName>
                                            <Style>
                                              <Border>
                                                <Style>None</Style>
                                              </Border>
                                              <PaddingLeft>2pt</PaddingLeft>
                                              <PaddingRight>2pt</PaddingRight>
                                              <PaddingTop>2pt</PaddingTop>
                                              <PaddingBottom>2pt</PaddingBottom>
                                            </Style>
                                          </Textbox>
                                          <ColSpan>2</ColSpan>
                                        </CellContents>
                                      </TablixCell>
                                      <TablixCell />
                                      <TablixCell>
                                        <CellContents>
                                          <Textbox Name="Textbox32">
                                            <CanGrow>true</CanGrow>
                                            <KeepTogether>true</KeepTogether>
                                            <Paragraphs>
                                              <Paragraph>
                                                <TextRuns>
                                                  <TextRun>
                                                    <Value EvaluationMode="Auto" />
                                                    <Style>
                                                      <FontSize>9pt</FontSize>
                                                      <FontWeight>Bold</FontWeight>
                                                    </Style>
                                                  </TextRun>
                                                </TextRuns>
                                                <Style />
                                              </Paragraph>
                                            </Paragraphs>
                                            <rd:DefaultName>Textbox32</rd:DefaultName>
                                            <Style>
                                              <Border>
                                                <Style>None</Style>
                                              </Border>
                                              <PaddingLeft>2pt</PaddingLeft>
                                              <PaddingRight>2pt</PaddingRight>
                                              <PaddingTop>2pt</PaddingTop>
                                              <PaddingBottom>2pt</PaddingBottom>
                                            </Style>
                                          </Textbox>
                                        </CellContents>
                                      </TablixCell>
                                      <TablixCell>
                                        <CellContents>
                                          <Textbox Name="C_INC_QtyHours">
                                            <CanGrow>true</CanGrow>
                                            <KeepTogether>true</KeepTogether>
                                            <Paragraphs>
                                              <Paragraph>
                                                <TextRuns>
                                                  <TextRun>
                                                    <Value EvaluationMode="Auto">=Fields!C_INC_QtyHours.Value</Value>
                                                    <Style>
                                                      <FontSize>9pt</FontSize>
                                                      <FontWeight>Bold</FontWeight>
                                                    </Style>
                                                  </TextRun>
                                                </TextRuns>
                                                <Style />
                                              </Paragraph>
                                            </Paragraphs>
                                            <rd:DefaultName>C_INC_QtyHours</rd:DefaultName>
                                            <Style>
                                              <Border>
                                                <Style>None</Style>
                                              </Border>
                                              <PaddingLeft>2pt</PaddingLeft>
                                              <PaddingRight>2pt</PaddingRight>
                                              <PaddingTop>2pt</PaddingTop>
                                              <PaddingBottom>2pt</PaddingBottom>
                                            </Style>
                                          </Textbox>
                                        </CellContents>
                                      </TablixCell>
                                    </TablixCells>
                                  </TablixRow>
                                  <TablixRow>
                                    <Height>0.423cm</Height>
                                    <TablixCells>
                                      <TablixCell>
                                        <CellContents>
                                          <Textbox Name="DocumentNo">
                                            <CanGrow>true</CanGrow>
                                            <KeepTogether>true</KeepTogether>
                                            <Paragraphs>
                                              <Paragraph>
                                                <TextRuns>
                                                  <TextRun>
                                                    <Value EvaluationMode="Auto">=Fields!DocumentNo.Value</Value>
                                                    <Style>
                                                      <FontSize>9pt</FontSize>
                                                    </Style>
                                                  </TextRun>
                                                </TextRuns>
                                                <Style />
                                              </Paragraph>
                                            </Paragraphs>
                                            <rd:DefaultName>DocumentNo</rd:DefaultName>
                                            <Style>
                                              <Border>
                                                <Style>None</Style>
                                              </Border>
                                              <PaddingLeft>2pt</PaddingLeft>
                                              <PaddingRight>2pt</PaddingRight>
                                              <PaddingTop>2pt</PaddingTop>
                                              <PaddingBottom>2pt</PaddingBottom>
                                            </Style>
                                          </Textbox>
                                        </CellContents>
                                      </TablixCell>
                                      <TablixCell>
                                        <CellContents>
                                          <Textbox Name="StopCode1">
                                            <CanGrow>true</CanGrow>
                                            <KeepTogether>true</KeepTogether>
                                            <Paragraphs>
                                              <Paragraph>
                                                <TextRuns>
                                                  <TextRun>
                                                    <Value EvaluationMode="Auto">=Fields!StopCode.Value</Value>
                                                    <Style>
                                                      <FontSize>9pt</FontSize>
                                                    </Style>
                                                  </TextRun>
                                                </TextRuns>
                                                <Style />
                                              </Paragraph>
                                            </Paragraphs>
                                            <rd:DefaultName>StopCode1</rd:DefaultName>
                                            <Style>
                                              <Border>
                                                <Style>None</Style>
                                              </Border>
                                              <PaddingLeft>2pt</PaddingLeft>
                                              <PaddingRight>2pt</PaddingRight>
                                              <PaddingTop>2pt</PaddingTop>
                                              <PaddingBottom>2pt</PaddingBottom>
                                            </Style>
                                          </Textbox>
                                        </CellContents>
                                      </TablixCell>
                                      <TablixCell>
                                        <CellContents>
                                          <Textbox Name="PostingDate">
                                            <CanGrow>true</CanGrow>
                                            <KeepTogether>true</KeepTogether>
                                            <Paragraphs>
                                              <Paragraph>
                                                <TextRuns>
                                                  <TextRun>
                                                    <Value EvaluationMode="Auto">=Fields!PostingDate.Value</Value>
                                                    <Style>
                                                      <FontSize>9pt</FontSize>
                                                      <Format>dd.MM.yy</Format>
                                                    </Style>
                                                  </TextRun>
                                                </TextRuns>
                                                <Style />
                                              </Paragraph>
                                            </Paragraphs>
                                            <rd:DefaultName>PostingDate</rd:DefaultName>
                                            <Style>
                                              <Border>
                                                <Style>None</Style>
                                              </Border>
                                              <PaddingLeft>2pt</PaddingLeft>
                                              <PaddingRight>2pt</PaddingRight>
                                              <PaddingTop>2pt</PaddingTop>
                                              <PaddingBottom>2pt</PaddingBottom>
                                            </Style>
                                          </Textbox>
                                        </CellContents>
                                      </TablixCell>
                                      <TablixCell>
                                        <CellContents>
                                          <Textbox Name="No">
                                            <CanGrow>true</CanGrow>
                                            <KeepTogether>true</KeepTogether>
                                            <Paragraphs>
                                              <Paragraph>
                                                <TextRuns>
                                                  <TextRun>
                                                    <Value EvaluationMode="Auto">=Fields!No.Value</Value>
                                                    <Style>
                                                      <FontSize>9pt</FontSize>
                                                    </Style>
                                                  </TextRun>
                                                </TextRuns>
                                                <Style />
                                              </Paragraph>
                                            </Paragraphs>
                                            <rd:DefaultName>No</rd:DefaultName>
                                            <Style>
                                              <Border>
                                                <Style>None</Style>
                                              </Border>
                                              <PaddingLeft>2pt</PaddingLeft>
                                              <PaddingRight>2pt</PaddingRight>
                                              <PaddingTop>2pt</PaddingTop>
                                              <PaddingBottom>2pt</PaddingBottom>
                                            </Style>
                                          </Textbox>
                                        </CellContents>
                                      </TablixCell>
                                      <TablixCell>
                                        <CellContents>
                                          <Textbox Name="MachCenterName">
                                            <CanGrow>true</CanGrow>
                                            <KeepTogether>true</KeepTogether>
                                            <Paragraphs>
                                              <Paragraph>
                                                <TextRuns>
                                                  <TextRun>
                                                    <Value EvaluationMode="Auto">=Fields!MachCenterName.Value</Value>
                                                    <Style>
                                                      <FontSize>9pt</FontSize>
                                                    </Style>
                                                  </TextRun>
                                                </TextRuns>
                                                <Style />
                                              </Paragraph>
                                            </Paragraphs>
                                            <rd:DefaultName>MachCenterName</rd:DefaultName>
                                            <Style>
                                              <Border>
                                                <Style>None</Style>
                                              </Border>
                                              <PaddingLeft>2pt</PaddingLeft>
                                              <PaddingRight>2pt</PaddingRight>
                                              <PaddingTop>2pt</PaddingTop>
                                              <PaddingBottom>2pt</PaddingBottom>
                                            </Style>
                                          </Textbox>
                                        </CellContents>
                                      </TablixCell>
                                      <TablixCell>
                                        <CellContents>
                                          <Textbox Name="Quantity">
                                            <CanGrow>true</CanGrow>
                                            <KeepTogether>true</KeepTogether>
                                            <Paragraphs>
                                              <Paragraph>
                                                <TextRuns>
                                                  <TextRun>
                                                    <Value EvaluationMode="Auto">=Fields!Quantity.Value</Value>
                                                    <Style>
                                                      <FontSize>9pt</FontSize>
                                                      <Format>=Fields!QuantityFormat.Value</Format>
                                                    </Style>
                                                  </TextRun>
                                                </TextRuns>
                                                <Style />
                                              </Paragraph>
                                            </Paragraphs>
                                            <rd:DefaultName>Quantity</rd:DefaultName>
                                            <Style>
                                              <Border>
                                                <Style>None</Style>
                                              </Border>
                                              <PaddingLeft>2pt</PaddingLeft>
                                              <PaddingRight>2pt</PaddingRight>
                                              <PaddingTop>2pt</PaddingTop>
                                              <PaddingBottom>2pt</PaddingBottom>
                                            </Style>
                                          </Textbox>
                                        </CellContents>
                                      </TablixCell>
                                    </TablixCells>
                                  </TablixRow>
                                  <TablixRow>
                                    <Height>0.423cm</Height>
                                    <TablixCells>
                                      <TablixCell>
                                        <CellContents>
                                          <Textbox Name="SumString">
                                            <CanGrow>true</CanGrow>
                                            <KeepTogether>true</KeepTogether>
                                            <Paragraphs>
                                              <Paragraph>
                                                <TextRuns>
                                                  <TextRun>
                                                    <Value EvaluationMode="Auto">=Fields!SumString.Value</Value>
                                                    <Style>
                                                      <FontSize>9pt</FontSize>
                                                    </Style>
                                                  </TextRun>
                                                </TextRuns>
                                                <Style />
                                              </Paragraph>
                                            </Paragraphs>
                                            <rd:DefaultName>SumString</rd:DefaultName>
                                            <Style>
                                              <Border>
                                                <Style>None</Style>
                                              </Border>
                                              <TopBorder>
                                                <Style>Solid</Style>
                                              </TopBorder>
                                              <PaddingLeft>2pt</PaddingLeft>
                                              <PaddingRight>2pt</PaddingRight>
                                              <PaddingTop>2pt</PaddingTop>
                                              <PaddingBottom>2pt</PaddingBottom>
                                            </Style>
                                          </Textbox>
                                          <ColSpan>4</ColSpan>
                                        </CellContents>
                                      </TablixCell>
                                      <TablixCell />
                                      <TablixCell />
                                      <TablixCell />
                                      <TablixCell>
                                        <CellContents>
                                          <Textbox Name="Textbox34">
                                            <CanGrow>true</CanGrow>
                                            <KeepTogether>true</KeepTogether>
                                            <Paragraphs>
                                              <Paragraph>
                                                <TextRuns>
                                                  <TextRun>
                                                    <Value EvaluationMode="Auto" />
                                                    <Style>
                                                      <FontSize>9pt</FontSize>
                                                    </Style>
                                                  </TextRun>
                                                </TextRuns>
                                                <Style />
                                              </Paragraph>
                                            </Paragraphs>
                                            <rd:DefaultName>Textbox34</rd:DefaultName>
                                            <Style>
                                              <Border>
                                                <Style>None</Style>
                                              </Border>
                                              <TopBorder>
                                                <Style>Solid</Style>
                                              </TopBorder>
                                              <PaddingLeft>2pt</PaddingLeft>
                                              <PaddingRight>2pt</PaddingRight>
                                              <PaddingTop>2pt</PaddingTop>
                                              <PaddingBottom>2pt</PaddingBottom>
                                            </Style>
                                          </Textbox>
                                        </CellContents>
                                      </TablixCell>
                                      <TablixCell>
                                        <CellContents>
                                          <Textbox Name="Quantity2">
                                            <CanGrow>true</CanGrow>
                                            <KeepTogether>true</KeepTogether>
                                            <Paragraphs>
                                              <Paragraph>
                                                <TextRuns>
                                                  <TextRun>
                                                    <Value EvaluationMode="Auto">=SUM(Fields!Quantity.Value)</Value>
                                                    <Style>
                                                      <FontSize>9pt</FontSize>
                                                      <Format>=Fields!QuantityFormat.Value</Format>
                                                    </Style>
                                                  </TextRun>
                                                </TextRuns>
                                                <Style />
                                              </Paragraph>
                                            </Paragraphs>
                                            <rd:DefaultName>Quantity</rd:DefaultName>
                                            <Style>
                                              <Border>
                                                <Style>None</Style>
                                              </Border>
                                              <TopBorder>
                                                <Style>Solid</Style>
                                              </TopBorder>
                                              <PaddingLeft>2pt</PaddingLeft>
                                              <PaddingRight>2pt</PaddingRight>
                                              <PaddingTop>2pt</PaddingTop>
                                              <PaddingBottom>2pt</PaddingBottom>
                                            </Style>
                                          </Textbox>
                                        </CellContents>
                                      </TablixCell>
                                    </TablixCells>
                                  </TablixRow>
                                  <TablixRow>
                                    <Height>0.423cm</Height>
                                    <TablixCells>
                                      <TablixCell>
                                        <CellContents>
                                          <Textbox Name="C_INC_TotalQtyHours">
                                            <CanGrow>true</CanGrow>
                                            <KeepTogether>true</KeepTogether>
                                            <Paragraphs>
                                              <Paragraph>
                                                <TextRuns>
                                                  <TextRun>
                                                    <Value EvaluationMode="Auto">=Fields!C_INC_TotalQtyHours.Value</Value>
                                                    <Style>
                                                      <FontSize>9pt</FontSize>
                                                      <FontWeight>Bold</FontWeight>
                                                    </Style>
                                                  </TextRun>
                                                </TextRuns>
                                                <Style />
                                              </Paragraph>
                                            </Paragraphs>
                                            <rd:DefaultName>C_INC_TotalQtyHours</rd:DefaultName>
                                            <Style>
                                              <Border>
                                                <Style>None</Style>
                                              </Border>
                                              <PaddingLeft>2pt</PaddingLeft>
                                              <PaddingRight>2pt</PaddingRight>
                                              <PaddingTop>2pt</PaddingTop>
                                              <PaddingBottom>2pt</PaddingBottom>
                                            </Style>
                                          </Textbox>
                                          <ColSpan>4</ColSpan>
                                        </CellContents>
                                      </TablixCell>
                                      <TablixCell />
                                      <TablixCell />
                                      <TablixCell />
                                      <TablixCell>
                                        <CellContents>
                                          <Textbox Name="Textbox35">
                                            <CanGrow>true</CanGrow>
                                            <KeepTogether>true</KeepTogether>
                                            <Paragraphs>
                                              <Paragraph>
                                                <TextRuns>
                                                  <TextRun>
                                                    <Value EvaluationMode="Auto" />
                                                    <Style>
                                                      <FontSize>9pt</FontSize>
                                                      <FontWeight>Bold</FontWeight>
                                                    </Style>
                                                  </TextRun>
                                                </TextRuns>
                                                <Style />
                                              </Paragraph>
                                            </Paragraphs>
                                            <rd:DefaultName>Textbox35</rd:DefaultName>
                                            <Style>
                                              <Border>
                                                <Style>None</Style>
                                              </Border>
                                              <PaddingLeft>2pt</PaddingLeft>
                                              <PaddingRight>2pt</PaddingRight>
                                              <PaddingTop>2pt</PaddingTop>
                                              <PaddingBottom>2pt</PaddingBottom>
                                            </Style>
                                          </Textbox>
                                        </CellContents>
                                      </TablixCell>
                                      <TablixCell>
                                        <CellContents>
                                          <Textbox Name="Quantity3">
                                            <CanGrow>true</CanGrow>
                                            <KeepTogether>true</KeepTogether>
                                            <Paragraphs>
                                              <Paragraph>
                                                <TextRuns>
                                                  <TextRun>
                                                    <Value EvaluationMode="Auto">=Sum(Fields!Quantity.Value)</Value>
                                                    <Style>
                                                      <FontSize>9pt</FontSize>
                                                      <FontWeight>Bold</FontWeight>
                                                      <Format>=Fields!QuantityFormat.Value</Format>
                                                    </Style>
                                                  </TextRun>
                                                </TextRuns>
                                                <Style />
                                              </Paragraph>
                                            </Paragraphs>
                                            <rd:DefaultName>Quantity</rd:DefaultName>
                                            <Style>
                                              <Border>
                                                <Style>None</Style>
                                              </Border>
                                              <PaddingLeft>2pt</PaddingLeft>
                                              <PaddingRight>2pt</PaddingRight>
                                              <PaddingTop>2pt</PaddingTop>
                                              <PaddingBottom>2pt</PaddingBottom>
                                            </Style>
                                          </Textbox>
                                        </CellContents>
                                      </TablixCell>
                                    </TablixCells>
                                  </TablixRow>
                                </TablixRows>
                              </TablixBody>
                              <TablixColumnHierarchy>
                                <TablixMembers>
                                  <TablixMember />
                                  <TablixMember />
                                  <TablixMember />
                                  <TablixMember />
                                  <TablixMember />
                                  <TablixMember />
                                </TablixMembers>
                              </TablixColumnHierarchy>
                              <TablixRowHierarchy>
                                <TablixMembers>
                                  <TablixMember>
                                    <Group Name="No">
                                      <GroupExpressions>
                                        <GroupExpression>=Fields!StopCode.Value</GroupExpression>
                                      </GroupExpressions>
                                    </Group>
                                    <SortExpressions>
                                      <SortExpression>
                                        <Value>=Fields!No.Value</Value>
                                      </SortExpression>
                                    </SortExpressions>
                                    <TablixMembers>
                                      <TablixMember>
                                        <KeepWithGroup>After</KeepWithGroup>
                                      </TablixMember>
                                      <TablixMember>
                                        <Group Name="Details1" />
                                      </TablixMember>
                                      <TablixMember>
                                        <KeepWithGroup>Before</KeepWithGroup>
                                      </TablixMember>
                                    </TablixMembers>
                                  </TablixMember>
                                  <TablixMember>
                                    <KeepWithGroup>Before</KeepWithGroup>
                                  </TablixMember>
                                </TablixMembers>
                              </TablixRowHierarchy>
                              <DataSetName>DataSet_Result</DataSetName>
                              <Top>0.04974cm</Top>
                              <Height>1.692cm</Height>
                              <Width>14.61354cm</Width>
                              <ZIndex>1</ZIndex>
                              <Style>
                                <Border>
                                  <Style>None</Style>
                                </Border>
                              </Style>
                            </Tablix>
                          </ReportItems>
                          <KeepTogether>true</KeepTogether>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                          </Style>
                        </Rectangle>
                      </CellContents>
                    </TablixCell>
                  </TablixCells>
                </TablixRow>
              </TablixRows>
            </TablixBody>
            <TablixColumnHierarchy>
              <TablixMembers>
                <TablixMember />
              </TablixMembers>
            </TablixColumnHierarchy>
            <TablixRowHierarchy>
              <TablixMembers>
                <TablixMember>
                  <Group Name="Details">
                    <GroupExpressions>
                      <GroupExpression>=Fields!DocumentNo.Value</GroupExpression>
                    </GroupExpressions>
                    <PageBreak>
                      <BreakLocation>Between</BreakLocation>
                    </PageBreak>
                  </Group>
                </TablixMember>
              </TablixMembers>
            </TablixRowHierarchy>
            <DataSetName>DataSet_Result</DataSetName>
            <Height>1.74174cm</Height>
            <Width>19cm</Width>
            <Style>
              <Border>
                <Style>None</Style>
              </Border>
            </Style>
          </Tablix>
        </ReportItems>
        <Height>1.74174cm</Height>
        <Style />
      </Body>
      <Width>19cm</Width>
      <Page>
        <PageHeader>
          <Height>2.54cm</Height>
          <PrintOnFirstPage>true</PrintOnFirstPage>
          <PrintOnLastPage>true</PrintOnLastPage>
          <ReportItems>
            <Textbox Name="Textbox7">
              <CanGrow>true</CanGrow>
              <KeepTogether>true</KeepTogether>
              <Paragraphs>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Value EvaluationMode="Auto">=Code.GetData(1,1) ''</Value>
                      <Style>
                        <FontWeight>Bold</FontWeight>
                      </Style>
                    </TextRun>
                  </TextRuns>
                  <Style />
                </Paragraph>
              </Paragraphs>
              <rd:DefaultName>Textbox7</rd:DefaultName>
              <Height>0.423cm</Height>
              <Width>9.67021cm</Width>
              <Style>
                <Border>
                  <Style>None</Style>
                </Border>
                <PaddingTop>2pt</PaddingTop>
                <PaddingBottom>2pt</PaddingBottom>
              </Style>
            </Textbox>
            <Textbox Name="Textbox8">
              <CanGrow>true</CanGrow>
              <KeepTogether>true</KeepTogether>
              <Paragraphs>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Value EvaluationMode="Auto">=Code.GetData(2,1) ''</Value>
                      <Style>
                        <FontSize>9pt</FontSize>
                      </Style>
                    </TextRun>
                  </TextRuns>
                  <Style />
                </Paragraph>
              </Paragraphs>
              <rd:DefaultName>Textbox7</rd:DefaultName>
              <Top>0.423cm</Top>
              <Height>0.423cm</Height>
              <Width>9.67021cm</Width>
              <ZIndex>1</ZIndex>
              <Style>
                <Border>
                  <Style>None</Style>
                </Border>
                <PaddingLeft>2pt</PaddingLeft>
                <PaddingRight>2pt</PaddingRight>
                <PaddingTop>2pt</PaddingTop>
                <PaddingBottom>2pt</PaddingBottom>
              </Style>
            </Textbox>
            <Textbox Name="Textbox9">
              <CanGrow>true</CanGrow>
              <KeepTogether>true</KeepTogether>
              <Paragraphs>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Value EvaluationMode="Auto">=Code.GetData(3,1) ''</Value>
                      <Style>
                        <FontSize>9pt</FontSize>
                      </Style>
                    </TextRun>
                  </TextRuns>
                  <Style>
                    <TextAlign>Right</TextAlign>
                  </Style>
                </Paragraph>
              </Paragraphs>
              <rd:DefaultName>Textbox7</rd:DefaultName>
              <Left>10.67916cm</Left>
              <Height>0.423cm</Height>
              <Width>8.32084cm</Width>
              <ZIndex>2</ZIndex>
              <Style>
                <Border>
                  <Style>None</Style>
                </Border>
                <PaddingLeft>2pt</PaddingLeft>
                <PaddingRight>2pt</PaddingRight>
                <PaddingTop>2pt</PaddingTop>
                <PaddingBottom>2pt</PaddingBottom>
              </Style>
            </Textbox>
            <Textbox Name="Textbox10">
              <CanGrow>true</CanGrow>
              <KeepTogether>true</KeepTogether>
              <Paragraphs>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Value EvaluationMode="Auto">=Replace(Replace(Code.GetData(4,1), "%1", Globals!PageNumber), "%2", Globals!TotalPages)</Value>
                      <Style>
                        <FontSize>9pt</FontSize>
                      </Style>
                    </TextRun>
                  </TextRuns>
                  <Style>
                    <TextAlign>Right</TextAlign>
                  </Style>
                </Paragraph>
              </Paragraphs>
              <rd:DefaultName>Textbox7</rd:DefaultName>
              <Top>0.423cm</Top>
              <Left>10.67916cm</Left>
              <Height>0.423cm</Height>
              <Width>8.32084cm</Width>
              <ZIndex>3</ZIndex>
              <Style>
                <Border>
                  <Style>None</Style>
                </Border>
                <PaddingLeft>2pt</PaddingLeft>
                <PaddingRight>2pt</PaddingRight>
                <PaddingTop>2pt</PaddingTop>
                <PaddingBottom>2pt</PaddingBottom>
              </Style>
            </Textbox>
            <Textbox Name="Textbox11">
              <CanGrow>true</CanGrow>
              <KeepTogether>true</KeepTogether>
              <Paragraphs>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Value EvaluationMode="Auto">=Code.GetData(5,1) ''</Value>
                      <Style>
                        <FontSize>9pt</FontSize>
                      </Style>
                    </TextRun>
                  </TextRuns>
                  <Style>
                    <TextAlign>Right</TextAlign>
                  </Style>
                </Paragraph>
              </Paragraphs>
              <rd:DefaultName>Textbox7</rd:DefaultName>
              <Top>0.846cm</Top>
              <Left>10.67916cm</Left>
              <Height>0.423cm</Height>
              <Width>8.32084cm</Width>
              <ZIndex>4</ZIndex>
              <Style>
                <Border>
                  <Style>None</Style>
                </Border>
                <PaddingLeft>2pt</PaddingLeft>
                <PaddingRight>2pt</PaddingRight>
                <PaddingTop>2pt</PaddingTop>
                <PaddingBottom>2pt</PaddingBottom>
              </Style>
            </Textbox>
          </ReportItems>
          <Style>
            <Border>
              <Style>None</Style>
            </Border>
          </Style>
        </PageHeader>
        <PageHeight>29.7cm</PageHeight>
        <PageWidth>21cm</PageWidth>
        <LeftMargin>1cm</LeftMargin>
        <TopMargin>1cm</TopMargin>
        <BottomMargin>1cm</BottomMargin>
        <ColumnSpacing>1.27cm</ColumnSpacing>
        <Style />
      </Page>
    </ReportSection>
  </ReportSections>
  <Code>Public Function BlankZero(ByVal Value As Decimal)
    if Value = 0 then
        Return ""
    end if
    Return Value
End Function

Public Function BlankPos(ByVal Value As Decimal)
    if Value &gt; 0 then
        Return ""
    end if
    Return Value
End Function

Public Function BlankZeroAndPos(ByVal Value As Decimal)
    if Value &gt;= 0 then
        Return ""
    end if
    Return Value
End Function

Public Function BlankNeg(ByVal Value As Decimal)
    if Value &lt; 0 then
        Return ""
    end if
    Return Value
End Function

Public Function BlankNegAndZero(ByVal Value As Decimal)
    if Value &lt;= 0 then
        Return ""
    end if
    Return Value
End Function

Shared Data1 as Object
Shared Data2 as Object
Shared Data3 as Object
Shared Data4 as Object
Shared Data5 as Object
Shared Data6 as Object
Shared Data7 as Object
Shared Data10 as Object

Public Function GetData(Num as Integer, Group as integer) as Object
if Group = 1 then
   Return Cstr(Choose(Num, Split(Cstr(Data1),Chr(177))))
End If

if Group = 2 then
   Return Cstr(Choose(Num, Split(Cstr(Data2),Chr(177))))
End If

if Group = 3 then
   Return Cstr(Choose(Num, Split(Cstr(Data3),Chr(177))))
End If

if Group = 4 then
   Return Cstr(Choose(Num, Split(Cstr(Data4),Chr(177))))
End If

if Group = 5 then
   Return Cstr(Choose(Num, Split(Cstr(Data5),Chr(177))))
End If

if Group = 6 then
   Return Cstr(Choose(Num, Split(Cstr(Data6),Chr(177))))
End If

if Group = 7 then
   Return Cstr(Choose(Num, Split(Cstr(Data7),Chr(177))))
End If

if Group = 10 then
   Return Cstr(Choose(Num, Split(Cstr(Data10),Chr(177))))
End If
End Function

Public Function SetData(NewData as Object,Group as integer)
  If Group = 1 and NewData &gt; "" Then
      Data1 = NewData
  End If

  If Group = 2 and NewData &gt; "" Then
      Data2 = NewData
  End If

  If Group = 3 and NewData &gt; "" Then
      Data3 = NewData
  End If

  If Group = 4 and NewData &gt; "" Then
      Data4 = NewData
  End If

  If Group = 5 and NewData &gt; "" Then
      Data5 = NewData
  End If

  If Group = 6 and NewData &gt; "" Then
      Data6 = NewData
  End If

  If Group = 7 and NewData &gt; "" Then
      Data7 = NewData
  End If

  If Group = 10 and NewData &gt; "" Then
      Data10 = NewData
  End If
End Function</Code>
  <Language>=User!Language</Language>
  <ConsumeContainerWhitespace>true</ConsumeContainerWhitespace>
  <rd:ReportUnitType>Cm</rd:ReportUnitType>
  <rd:ReportID>0eeb6585-38ae-40f1-885b-8d50088d51b4</rd:ReportID>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Codeunit 241 Item Jnl.-Post
{
  OBJECT-PROPERTIES
  {
    Date=21.09.17;
    Time=10:05:18;
    Modified=Yes;
    Version List=NAVW110.00,OPC6.02;
  }
  PROPERTIES
  {
    TableNo=83;
    OnRun=BEGIN
            ItemJnlLine.COPY(Rec);
            Code;
            COPY(ItemJnlLine);
          END;

  }
  CODE
  {
    VAR
      Text000@1000 : TextConst 'ENU=cannot be filtered when posting recurring journals;NOR=kan ikke filtreres n†r du bokf›rer gjentakelseskladder';
      Text001@1001 : TextConst 'ENU=Do you want to post the journal lines?;NOR=Vil du bokf›re kladdelinjene?';
      Text002@1002 : TextConst 'ENU=There is nothing to post.;NOR=Det finnes ingenting † bokf›re.';
      Text003@1003 : TextConst 'ENU=The journal lines were successfully posted.;NOR=Kladdelinjene ble bokf›rt uten problemer.';
      Text004@1004 : TextConst 'ENU="The journal lines were successfully posted. ";NOR="Kladdelinjene ble bokf›rt p† riktig m†te. "';
      Text005@1005 : TextConst 'ENU=You are now in the %1 journal.;NOR=Du er n† i kladd %1.';
      ItemJnlTemplate@1006 : Record 82;
      ItemJnlLine@1007 : Record 83;
      TempJnlBatchName@1009 : Code[10];
      _INC_@1080000 : Boolean;
      OPCSetupG@1080001 : Record 83001;
      PostWithOutMessageG@1080002 : Boolean;

    LOCAL PROCEDURE Code@1();
    BEGIN
      //hhe 23.03.10->
      PostWithOutMessageG := FALSE;
      //hhe 23.03.10<-

      WITH ItemJnlLine DO BEGIN
        ItemJnlTemplate.GET("Journal Template Name");
        ItemJnlTemplate.TESTFIELD("Force Posting Report",FALSE);
        IF ItemJnlTemplate.Recurring AND (GETFILTER("Posting Date") <> '') THEN
          FIELDERROR("Posting Date",Text000);

        //01.-> hhe 10.12.09
        OPCSetupG.GET;
        //hhe 23.03.10: avsnittet under er utvidet ->
        IF (ItemJnlTemplate.Name <> OPCSetupG."Output Jnl. Templ. Name Qty") THEN
          PostWithOutMessageG := TRUE;
        IF (ItemJnlTemplate.Name <> OPCSetupG."Cap. Jnl. Templ. Name Indirect") THEN
          PostWithOutMessageG := TRUE;
        IF (ItemJnlTemplate.Name <> OPCSetupG."Output Jnl. Templ. Name Time") THEN
        PostWithOutMessageG := TRUE;
        //hhe 23.03.10: avsnittet under er utvidet <-
        //01.<- hhe 10.12.09
        IF PostWithOutMessageG = FALSE THEN //hhe 23.03.10: lagt inn denne setning.
        IF NOT CONFIRM(Text001,FALSE) THEN
          EXIT;

        TempJnlBatchName := "Journal Batch Name";

        CODEUNIT.RUN(CODEUNIT::"Item Jnl.-Post Batch",ItemJnlLine);

        IF "Line No." = 0 THEN
          MESSAGE(Text002)
        ELSE
          IF (PostWithOutMessageG = FALSE)  THEN    //hhe 23.03.10: lagt til denne setning
            IF TempJnlBatchName = "Journal Batch Name" THEN
              MESSAGE(Text003)
            ELSE
              MESSAGE(
                Text004 +
                Text005,
                "Journal Batch Name");

        IF NOT FIND('=><') OR (TempJnlBatchName <> "Journal Batch Name") THEN BEGIN
          RESET;
          FILTERGROUP(2);
          SETRANGE("Journal Template Name","Journal Template Name");
          SETRANGE("Journal Batch Name","Journal Batch Name");
          FILTERGROUP(0);
          "Line No." := 1;
        END;
      END;
    END;

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 10.12.09 HHE slipper † bekrefte bokf›ring dersom dette kommer fra OPC
      02. 23.03.10 HHE Slipper † bekrefte bokf›ring dersom dette er kladd for INDIREKTE TID
                       Slipper melding om at "Kladdelinjene ble bokf›rt uten problemer" (Text004) dersom OPC-kladd
    }
    END.
  }
}

OBJECT Codeunit 50012 TAB Event Subscribers
{
  OBJECT-PROPERTIES
  {
    Date=02.11.17;
    Time=14:40:57;
    Modified=Yes;
    Version List=INC1.01,OPC6.01,SER2.01;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      C_Text01@1101103000 : TextConst 'ENU=You must first enter "Vendor No.";NOR=Du m† f›rst angi "Leverand›rnr."';
      C_Text02@1101103001 : TextConst 'ENU=This item can only be used on qoute.;NOR=Denne varen kan kun brukes p† tilbud.';
      C_Text03@1101103002 : TextConst 'ENU=Posted comments cannot be changed.;NOR=Bokf›rte merknader kan ikke endres.';
      C_Text58400@1101103010 : TextConst 'ENU=No Ledger Entry was selected with the filter:\%1;NOR=Det ble ikke funnet en post innen for filteret:\%1';
      C_Text58401@1101103009 : TextConst 'ENU=More than one Ledger Entry was found.\Continue and show list?;NOR=Det ble funnet flere poster.\Fortsett og vise oversikt?';
      C_Text58402@1101103008 : TextConst 'ENU=Apply Credit Memo %1;NOR=Motregning av kreditnota %1';
      C_Text58403@1101103007 : TextConst 'ENU=Payment of Invoice %1;NOR=Innbetaling av faktura %1';
      C_Text58404@1101103006 : TextConst 'ENU=Payment of Document No. %1;NOR=Innbetaling av bilagsnr. %1';
      C_Text58406@1101103004 : TextConst 'ENU=Payment of Invoice %1;NOR=Utbetaling av faktura %1';
      C_Text58407@1101103003 : TextConst 'ENU=Payment of Document No. %1;NOR=Utbetaling av bilagsnr. %1';
      C_Text04@1101103011 : TextConst 'ENU=Posting on simulation item is not allowed.;NOR=Bokf›ring p† simuleringsvare er ikke tillat.';
      C_Text05@1101103012 : TextConst 'ENU=Purch.No. %1;NOR=Best.nr. %1';
      C_Text06@1101103013 : TextConst 'ENU=You cannot delete this production order because there are OPC entries (Time Registration) registered on it.;NOR=Du kan ikke slette denne prod.ordren fordi det finnes OPC poster(tid) p† den';
      C_Text07@1101103014 : TextConst 'ENU=Check clocking on prod.ressurs %1;NOR=Sjekk innstemplinger p† prod.ressurs %1';
      C_Text08@1101103015 : TextConst 'ENU=Production Order for Simulation Items can only have status Simulated;NOR=Produksjonsordre p† Simuleringsvarer kan kun ha status Simulert.';
      C_Text09@1101103016 : TextConst 'ENU=Output is posted on one or more operations. Deletion can not be performed.;NOR=Det er meldt avgangsantall p† en eller flere operasjoner. Sletting kan ikke utf›res.';
      C_Text10@1101103017 : TextConst 'ENU=%1 cannot be earlier than the %2.;NOR=%1 kan ikke v‘re tidligere enn %2.';
      C_Text11@1101103018 : TextConst 'ENU=You must enter new hours used to be able to change repair status to Finished;NOR=Du m† registrere Ny driftstid for † kunne sette linjen til ''''Ferdig'''' reparert';
      C_Text12@1101103019 : TextConst 'ENU=New Hours used is not registrated. Are you sure you want to finish this service item?;NOR=Ny driftstid er ikke registrert. Er du sikkert p† at du vil sette rep. status til Ferdig?';
      C_Text13@1101103020 : TextConst 'ENU=Warrenty can not be changed here -  please change service lines;NOR=Det finnes servicelinjer til denne servicevaren.\ Garanti kan ikke endres her - endre garanti p† den enkelte servicelinje';
      C_Text14@1101103021 : TextConst 'ENU=Do you want to activate a warranty for this service item line?;NOR=Vil du aktivere en garanti for denne servicevarelinjen?''';
      C_Text15@1101103022 : TextConst 'ENU=Do you want to deactivate the warranty for this service item line?;NOR=Vil du deaktivere garantien for denne servicevarelinjen?';
      C_Text16@1101103023 : TextConst 'ENU=New hours used %1 is less than prev. reg hours used %2. Are you sure tou want to registrer %1 hours?;NOR=Ny driftstid %1 er lavere enn tidligere driftstid %2. Er du sikker p† at du vil registrere %1 timer?';
      C_Text17@1101103024 : TextConst 'ENU=Not possible to update log -  registrer hours first!;NOR=Kunne ikke oppdateres i log -  registrer antallet f›rst!';
      C_Text18@1101103025 : TextConst 'ENU=Do you want to change customer SN from %1 to %2 ?;NOR=Vil du endre kundens serienr. fra %1 til %2 ?';
      C_Text19@1101103026 : TextConst 'ENU=Customer Serial No. has been updated!;NOR=Kundens serienr. er endret!';
      C_Text20@1101103027 : TextConst 'ENU=Not possible to update log -  registrer hours first!;NOR=Kunne ikke oppdateres i log -  registrer antallet f›rst!';
      C_Text21@1101103030 : TextConst 'ENU=Do you want to copy this line and use it for creating \lines for all other service items with same qty/amount?;NOR=Vil du kopierelinjen og bruke den til † opprette linjer\for andre servicevarer med samme antall/bel›p?';
      C_Text22@1101103029 : TextConst 'ENU=You must enter new hours used to be able to enter resource lines;NOR=Du m† registrere Ny driftstid for † kunne registrere en ressurslinje';
      C_Text23@1101103028 : TextConst 'ENU=New Hours used is not registrated - are you sure you want to enter a resource line?;NOR=Ny driftstid er ikke registrert - er du sikkert p† at du vil registrere en ressurs linje?';
      C_Text24@1101103031 : TextConst 'ENU=You cannot change the value of the %1 field manually if %2 for this line is %3;NOR=Du kan ikke endre verdien i feltet %1 manuelt hvis %2 for denne linjen er %3';
      C_Text25@1101103032 : TextConst 'ENU=The quantity must be more than %1;NOR=Antallet m† v‘re h›yere enn %1';
      C_Text26@1101103033 : TextConst 'ENU=Qry hours %1 is less than prev. reg %2. Do you want to registrer %1?;NOR=Ant. driftstimer %1 er lavere enn tidligere registert %2. Vil du registrere %1?';
      C_Text27@1101103005 : TextConst 'ENU=Start date cannot be empty;NOR=Startdato kan ikke v‘re blank';
      C_Text28@1101103034 : TextConst 'ENU=Start date %1 cannot be later than ending date %2;NOR=NStartdato %1 kan ikke v‘re tidligere enn sluttdato %2';
      C_Text29@1101103035 : TextConst 'ENU=There are posted entries on the component %1. It can not be deleted.;NOR=Det er bokf›rt poster p† komponent %1. Denne kan ikke slettes.';
      OASMgtG@1101103036 : Codeunit 50015;
      ServiceMgtIncG@1101103037 : Codeunit 72331;
      C_INC_CopyFromServItemGroup@1101103038 : TextConst 'ENU=Do you want to copy components from the Service Item Group?;NOR=nsker du † kopiere inn komponenter fra serv.v.gruppen?';

    [EventSubscriber(Table,18,OnBeforeInsertEvent)]
    LOCAL PROCEDURE TAB18OnBeforeInsertEvent@1101103000(VAR Rec@1101103000 : Record 18;RunTrigger@1101103001 : Boolean);
    BEGIN
      //hhe27.09.04->
      Rec."Shipping Advice" := Rec."Shipping Advice"::Complete;
      //hhe27.09.04<-
    END;

    [EventSubscriber(Table,27,OnBeforeInsertEvent)]
    LOCAL PROCEDURE TAB27OnBeforeInsertEvent@1101103001(VAR Rec@1101103000 : Record 27;RunTrigger@1101103001 : Boolean);
    BEGIN
      //hhe 18.02.13->
      Rec."Item No.(sortering)" := Rec."No.";
      //hhe 18.02.13<-
      //13. hph>>
      Rec.VALIDATE("Order Tracking Policy", Rec."Order Tracking Policy"::"Tracking & Action Msg.");
      //13.<<
    END;

    [EventSubscriber(Table,27,OnAfterValidateEvent,"No.")]
    LOCAL PROCEDURE TAB27OnAfterValidateEventNo@1101103003(VAR Rec@1101103000 : Record 27;VAR xRec@1101103001 : Record 27;CurrFieldNo@1101103002 : Integer);
    BEGIN
      //hhe 18.02.13->
      Rec."Item No.(sortering)" := Rec."No.";
      //hhe 18.02.13<-
    END;

    [EventSubscriber(Table,27,OnAfterValidateEvent,"Vendor No.")]
    LOCAL PROCEDURE TAB27OnAfterValidateEventVendorNo@1101103002(VAR Rec@1101103000 : Record 27;VAR xRec@1101103001 : Record 27;CurrFieldNo@1101103002 : Integer);
    VAR
      ItemVendorL@1101103003 : Record 99;
      VendorL@1101103004 : Record 23;
    BEGIN
      //05 SID ASL09.01.04 Start
      IF xRec."Vendor No." <> Rec."Vendor No." THEN BEGIN
        IF ItemVendorL.GET(Rec."Vendor No.", Rec."No.", '') THEN BEGIN
          Rec."Vendor Item No." := ItemVendorL."Vendor Item No.";
        END ELSE BEGIN
          Rec."Vendor Item No." := '';
          //hhe 09.08.07->
          IF VendorL.GET(Rec."Vendor No.") THEN BEGIN
            ItemVendorL.INIT;
            ItemVendorL.VALIDATE("Vendor No.", Rec."Vendor No.");
            ItemVendorL.VALIDATE("Item No.", Rec."No.");
            ItemVendorL.INSERT;
            //hhe 23.08.07->
            ItemVendorL.VALIDATE("Product connection", Rec."Product Connection");
            ItemVendorL.MODIFY;
            //hhe 23.08.07<-
          END;
          //hhe 09.08.07<-
        END;
      END;
      //05 SID ASL09.01.04 Slutt
    END;

    [EventSubscriber(Table,27,OnAfterValidateEvent,"Vendor Item No.")]
    LOCAL PROCEDURE TAB27OnAfterValidateEventVendorItemNo@1101103005(VAR Rec@1101103000 : Record 27;VAR xRec@1101103001 : Record 27;CurrFieldNo@1101103002 : Integer);
    VAR
      ItemVendorL@1101103003 : Record 99;
    BEGIN
      //hhe 09.08.07->
      IF Rec."Vendor No." <> '' THEN BEGIN
        IF ItemVendorL.GET(Rec."Vendor No.", Rec."No.", '') THEN BEGIN
          ItemVendorL."Vendor Item No." := Rec."Vendor Item No.";
          ItemVendorL.MODIFY;
        END ELSE BEGIN
          ItemVendorL.INIT;
          ItemVendorL.VALIDATE("Vendor No.", Rec."Vendor No.");
          ItemVendorL.VALIDATE("Item No.", Rec."No.");
          ItemVendorL.VALIDATE("Vendor Item No.", Rec."Vendor Item No.");
          ItemVendorL.INSERT;
        END;
      END
      ELSE
        ERROR(C_Text01);
      //hhe 09.08.07<-
    END;

    [EventSubscriber(Table,27,OnAfterValidateEvent,"Item Category Code")]
    LOCAL PROCEDURE TAB27OnAfterValidateEventItemCategoryCode@1101103007(VAR Rec@1101103000 : Record 27;VAR xRec@1101103001 : Record 27;CurrFieldNo@1101103002 : Integer);
    VAR
      ItemCategoryL@1101103003 : Record 5722;
    BEGIN
      //Transfer Item Category "Std.rutenr" og "Std.etterfyllingssystem"
      IF Rec."Item Category Code" <> xRec."Item Category Code" THEN BEGIN
        IF ItemCategoryL.GET(Rec."Item Category Code") THEN BEGIN
      //    //hhe 08.01.04->
          IF Rec."Routing No." = '' THEN
            Rec.VALIDATE("Routing No.", ItemCategoryL."Def. Routing No.");
          Rec.VALIDATE("Replenishment System", ItemCategoryL."Def. etterfyllingssystem");
      //    //hhe 08.01.04 <-
        END;
      END;
    END;

    [EventSubscriber(Table,27,OnAfterValidateEvent,"Product Connection")]
    LOCAL PROCEDURE TAB27OnAfterValidateEventProductConnection@1101103004(VAR Rec@1101103000 : Record 27;VAR xRec@1101103001 : Record 27;CurrFieldNo@1101103002 : Integer);
    VAR
      ItemVendorL@1101103003 : Record 99;
      ItemVendorModifyL@1101103004 : Record 99;
    BEGIN
      //hhe 23.08.07->
      ItemVendorL.RESET;
      ItemVendorL.SETRANGE("Item No.", Rec."No.");
      IF ItemVendorL.FINDFIRST THEN BEGIN
        REPEAT
          ItemVendorModifyL.GET(ItemVendorL."Vendor No.", ItemVendorL."Item No.", ItemVendorL."Variant Code");
          ItemVendorModifyL."Product connection" := Rec."Product Connection";
          ItemVendorModifyL.MODIFY(TRUE);
        UNTIL ItemVendorL.NEXT = 0;
      END;
      //hhe 23.08.07<-
    END;

    [EventSubscriber(Table,36,OnAfterDeleteEvent)]
    LOCAL PROCEDURE TAB36OnAfterDeleteEvent@1101103008(VAR Rec@1101103000 : Record 36;RunTrigger@1101103001 : Boolean);
    VAR
      SalesQuoteTextsL@1101103002 : Record 50010;
    BEGIN
      //SID.OJO 03.02.08 ---------->
      SalesQuoteTextsL.SETRANGE("Document Type", Rec."Document Type");
      SalesQuoteTextsL.SETRANGE("No.", Rec."No.");
      IF SalesQuoteTextsL.FINDFIRST THEN
        SalesQuoteTextsL.DELETE;
      //<---------- SID.OJO 03.02.08
    END;

    [EventSubscriber(Table,36,OnAfterValidateEvent,"Sell-to Customer No.")]
    LOCAL PROCEDURE TAB36OnAfterValidateEventSellToCustomerNo@1101103010(VAR Rec@1101103002 : Record 36;VAR xRec@1101103003 : Record 36;CurrFieldNo@1101103004 : Integer);
    VAR
      ShiptoAddressL@1101103000 : Record 222;
      CustomerL@1101103001 : Record 18;
    BEGIN
      OASMgtG.GetCust(Rec."Sell-to Customer No.", CustomerL);
      //07. ->
      Rec."Sell-to address 3" := CustomerL."Address 3";
      //07. <-
      //hhe ->
      Rec."Quote Valid To" := WORKDATE + 30;
      //hhe <-
      // ASL 09.01.04 ->
      ShiptoAddressL.RESET;
      ShiptoAddressL.SETRANGE("Customer No.", Rec."Sell-to Customer No.");
      IF ShiptoAddressL.FINDLAST THEN
        Rec.VALIDATE("Ship-to Code", ShiptoAddressL.Code);
      // ASL 09.01.04 <-
      //16. hph>>
      IF CustomerL."Default lev.adresse" <> '' THEN
        Rec.VALIDATE("Ship-to Code", CustomerL."Default lev.adresse");
      //16.<<
    END;

    [EventSubscriber(Table,36,OnAfterValidateEvent,"Bill-to Customer No.")]
    LOCAL PROCEDURE TAB36OnAfterValidateEventBillToCustomerNo@1101103009(VAR Rec@1101103002 : Record 36;VAR xRec@1101103003 : Record 36;CurrFieldNo@1101103004 : Integer);
    VAR
      CustomerL@1101103001 : Record 18;
    BEGIN
      OASMgtG.GetCust(Rec."Bill-to Customer No.", CustomerL);
      //07. ->
      Rec."Bill-to adress 3" := CustomerL."Address 3";
      //07. <-
      //01. -->
      Rec."PDF E-Mail" := CustomerL."PDF E-Mail";
      Rec."Send Invoice in E-Mail" := CustomerL."Send Invoice in E-Mail";
      //01. <--
    END;

    [EventSubscriber(Table,36,OnAfterValidateEvent,"Ship-to Code")]
    LOCAL PROCEDURE TAB36OnAfterValidateEventShipToCode@1101103006(VAR Rec@1101103002 : Record 36;VAR xRec@1101103003 : Record 36;CurrFieldNo@1101103004 : Integer);
    VAR
      ShiptoAddressL@1101103000 : Record 222;
      CustomerL@1101103001 : Record 18;
    BEGIN
      IF NOT Rec.IsCreditDocType THEN
        IF Rec."Ship-to Code" <> '' THEN BEGIN
          ShiptoAddressL.GET(Rec."Sell-to Customer No.", Rec."Ship-to Code");
          //07. ->
          Rec."Lever-til adresse 3" := ShiptoAddressL."Address 3";
          //07. <-
        END
        ELSE BEGIN
          OASMgtG.GetCust(Rec."Sell-to Customer No.", CustomerL);
          //07. ->
          Rec."Lever-til adresse 3" :=  CustomerL."Address 3";
          //07. <-
        END;
    END;

    [EventSubscriber(Table,36,OnAfterValidateEvent,"Warranty Text Code")]
    LOCAL PROCEDURE TAB36OnAfterValidateEventWarrantyTextCode@1101103012(VAR Rec@1101103002 : Record 36;VAR xRec@1101103003 : Record 36;CurrFieldNo@1101103004 : Integer);
    VAR
      SandardTextWarrantyL@1101103000 : Record 50002;
      SalesCommentLineL@1101103001 : Record 44;
    BEGIN
      //08. ->
      IF SandardTextWarrantyL.GET(Rec."Warranty Text Code") THEN BEGIN
        IF SandardTextWarrantyL."Text Line 2" <> '' THEN
          InsertSalesCommentLine(Rec, SalesCommentLineL.Code::Garanti, SandardTextWarrantyL."Text Line 1");
        IF SandardTextWarrantyL."Text Line 2" <> '' THEN
          InsertSalesCommentLine(Rec, SalesCommentLineL.Code::Garanti, SandardTextWarrantyL."Text Line 2");
        IF SandardTextWarrantyL."Text Line 3" <> '' THEN
          InsertSalesCommentLine(Rec, SalesCommentLineL.Code::Garanti, SandardTextWarrantyL."Text Line 3");
        IF SandardTextWarrantyL."Text Line 4" <> '' THEN
          InsertSalesCommentLine(Rec, SalesCommentLineL.Code::Garanti, SandardTextWarrantyL."Text Line 4");
      END;
      //08. <-
    END;

    [EventSubscriber(Table,36,OnAfterValidateEvent,"Service Item No.")]
    LOCAL PROCEDURE TAB36OnAfterValidateEventServiceItemNo@1101103011(VAR Rec@1101103002 : Record 36;VAR xRec@1101103003 : Record 36;CurrFieldNo@1101103004 : Integer);
    VAR
      ServiceItemL@1101103000 : Record 5940;
      ServiceItemComponentL@1101103001 : Record 5941;
    BEGIN
      //hhe->
      IF ServiceItemL.GET(Rec."Service Item No.") THEN
        ServiceItemComponentL.RESET;
      ServiceItemComponentL.SETRANGE(Active,TRUE);
      ServiceItemComponentL.SETRANGE("Parent Service Item No.", Rec."Service Item No.");
      ServiceItemComponentL.SETRANGE("Component Type", 1);
      IF ServiceItemComponentL.FINDLAST THEN BEGIN
        Rec.VALIDATE("Engine Type", ServiceItemComponentL."No.");
        Rec.VALIDATE("Engine Type - Description", ServiceItemComponentL.Description);
        END;
      Rec.MODIFY;
      //hhe<-
    END;

    [EventSubscriber(Table,36,OnAfterValidateEvent,"Standard Text Training Code")]
    LOCAL PROCEDURE TAB36OnAfterValidateEventStandardTextTrainingCode@1101103013(VAR Rec@1101103002 : Record 36;VAR xRec@1101103003 : Record 36;CurrFieldNo@1101103004 : Integer);
    VAR
      StandardTextTrainingL@1101103000 : Record 50005;
      SalesCommentLineL@1101103001 : Record 44;
    BEGIN
      //09. ->
      IF StandardTextTrainingL.GET(Rec."Standard Text Training Code") THEN BEGIN
        IF StandardTextTrainingL."Text Line 1" <> '' THEN
         InsertSalesCommentLine(Rec, SalesCommentLineL.Code::Training, StandardTextTrainingL."Text Line 1");
        IF StandardTextTrainingL."Text Line 2" <> '' THEN
         InsertSalesCommentLine(Rec, SalesCommentLineL.Code::Training, StandardTextTrainingL."Text Line 2");
        IF StandardTextTrainingL."Text Line 3" <> '' THEN
          InsertSalesCommentLine(Rec, SalesCommentLineL.Code::Training, StandardTextTrainingL."Text Line 3");
        IF StandardTextTrainingL."Text Line 4" <> '' THEN
          InsertSalesCommentLine(Rec, SalesCommentLineL.Code::Training, StandardTextTrainingL."Text Line 4");
      END;
       //09. <-
    END;

    [EventSubscriber(Table,36,OnCheckSalesPostRestrictions)]
    LOCAL PROCEDURE TAB36OnCheckSalesPostRestrictions@1101103095(VAR Sender@1101103002 : Record 36);
    VAR
      StandardTextTrainingL@1101103000 : Record 50005;
      SalesCommentLineL@1101103001 : Record 44;
    BEGIN
      //03. From COD86 ->
      Sender.TESTFIELD("Order Class");
      //03.<-
    END;

    [EventSubscriber(Table,36,OnAfterInitFromSalesHeader)]
    LOCAL PROCEDURE TAB36OnAfterInitFromSalesHeader@1101103096(VAR SourceSalesHeaderP@1101103002 : Record 36;VAR SalesHeaderP@1101103003 : Record 36);
    VAR
      StandardTextTrainingL@1101103000 : Record 50005;
      SalesCommentLineL@1101103001 : Record 44;
    BEGIN
      //02. From COD86 ->
      IF SourceSalesHeaderP."Document Type" = SourceSalesHeaderP."Document Type"::Quote THEN
        SalesHeaderP."Original Qoute No." := SourceSalesHeaderP."No.";
      //02.<-
    END;

    LOCAL PROCEDURE InsertSalesCommentLine@1101103014(VAR SalesHeaderP@1101103000 : Record 36;CodeP@1101103005 : ' ,Betaling,Rabatt,Leveringstid,Leveringsbet.,Garanti,Training,Dokumentasjon';CommentP@1101103002 : Text);
    VAR
      SalesCommentLineL@1101103001 : Record 44;
      LineNoL@1101103004 : Integer;
    BEGIN
      SalesCommentLineL.RESET;
      SalesCommentLineL.SETRANGE("Document Type", SalesHeaderP."Document Type");
      SalesCommentLineL.SETRANGE("No.", SalesHeaderP."No.");
      IF SalesCommentLineL.FINDLAST THEN
        LineNoL := SalesCommentLineL."Line No."
      ELSE
        LineNoL := LineNoL + 10000;
      SalesCommentLineL.INIT;
      SalesCommentLineL.VALIDATE("Document Type", SalesHeaderP."Document Type");
      SalesCommentLineL.VALIDATE("No.", SalesHeaderP."No.");
      SalesCommentLineL.VALIDATE("Line No.", LineNoL);
      SalesCommentLineL.VALIDATE(Code, CodeP);
      SalesCommentLineL.VALIDATE(Comment, CommentP);
      SalesCommentLineL.INSERT;
    END;

    [EventSubscriber(Table,37,OnAfterValidateEvent,"No.")]
    LOCAL PROCEDURE TAB37OnAfterValidateEventNo@1101103015(VAR Rec@1101103000 : Record 37;VAR xRec@1101103001 : Record 37;CurrFieldNo@1101103002 : Integer);
    VAR
      SalesHeaderL@1101103004 : Record 36;
      ItemL@1101103003 : Record 27;
    BEGIN
      OASMgtG.GetSalesHeader(Rec, SalesHeaderL);
      Rec."Account Code" := SalesHeaderL."Account Code";
      CASE Rec.Type OF
        Rec.Type::Item:
          BEGIN
            //03. ->
            ItemL.GET(Rec."No.");
            IF (Rec."Document Type" <> Rec."Document Type"::Quote) AND ItemL."Simulation Item" THEN
              ERROR(C_Text02);
            //03.<-
            //02.->
            Rec."Shelf No." := ItemL."Shelf No.";
            //02.<-
          END;
      END;
    END;

    [EventSubscriber(Table,37,OnAfterGetItemTranslation)]
    LOCAL PROCEDURE TAB37OnAfterGetItemTranslation@1101103016(VAR SalesLineP@1101103000 : Record 37;VAR ItemTranslationP@1101103001 : Record 30);
    BEGIN
      //05. ->
      IF ItemTranslationP."Description 2" <> '' THEN
      SalesLineP."Description 2" := ItemTranslationP."Description 2";
      //05. <-
    END;

    [EventSubscriber(Table,38,OnBeforeInsertEvent)]
    LOCAL PROCEDURE TAB38OnBeforeInsertEvent@1101103017(VAR Rec@1101103000 : Record 38;RunTrigger@1101103001 : Boolean);
    VAR
      PurchaseHeaderL@1101103002 : Record 38;
    BEGIN
      //hhe27.09.04->
      Rec."Shipping Advice" := Rec."Shipping Advice"::Complete;
      //hhe27.09.04<-
      //03. HEI->
      PurchaseHeaderL.SETRANGE("Document Type", PurchaseHeaderL."Document Type"::Order);
      PurchaseHeaderL.SETCURRENTKEY("Entry Number");
      IF PurchaseHeaderL.FINDLAST THEN
      Rec."Entry Number" := PurchaseHeaderL."Entry Number" + 1;
      //03. HEI<-
    END;

    [EventSubscriber(Table,38,OnAfterValidateEvent,"Buy-from Vendor No.")]
    LOCAL PROCEDURE TAB38OnAfterValidateEventBuyFromVendorNo@1101103018(VAR Rec@1101103002 : Record 38;VAR xRec@1101103003 : Record 38;CurrFieldNo@1101103004 : Integer);
    VAR
      VendorL@1101103000 : Record 23;
    BEGIN
      OASMgtG.GetVend(Rec."Buy-from Vendor No.", VendorL);
      //hhe 16.09.05->
      Rec."Buy-from Address 3" := VendorL."Address 3";
      //hhe 16.09.05<-
    END;

    [EventSubscriber(Table,38,OnAfterValidateEvent,"Pay-to Vendor No.")]
    LOCAL PROCEDURE TAB38OnAfterValidateEventPayToVendorNo@1101103020(VAR Rec@1101103002 : Record 38;VAR xRec@1101103003 : Record 38;CurrFieldNo@1101103004 : Integer);
    VAR
      VendorL@1101103000 : Record 23;
      UserSetupL@1101103001 : Record 91;
    BEGIN
      OASMgtG.GetVend(Rec."Pay-to Vendor No.", VendorL);
      //hhe 16.09.05->
      Rec."Buy-from Address 3" := VendorL."Address 3";
      //hhe 16.09.05<-
      // 04. BVM-->
      IF (UserSetupL.GET(USERID)) AND (UserSetupL.SalesPersonCode <> '') THEN
        Rec."Purchaser Code" := UserSetupL.SalesPersonCode
      ELSE
        Rec."Purchaser Code" := VendorL."Purchaser Code";
      //04. BVM--<
    END;

    [EventSubscriber(Table,39,OnBeforeModifyEvent)]
    LOCAL PROCEDURE TAB39OnBeforeModifyEvent@1101103098(VAR Rec@1101103000 : Record 39;VAR xRec@1101103001 : Record 39;RunTrigger@1101103002 : Boolean);
    BEGIN
      // ASL 09.01.04 Moved from COD90 ->
      IF (Rec."Quality Control Code" <> '') AND (Rec."Qty. to Receive" > 0) THEN
        Rec."Control Performed" := FALSE;
      // ASL 09.01.04 <-
    END;

    [EventSubscriber(Table,38,OnAfterValidateEvent,"Order Address Code")]
    LOCAL PROCEDURE TAB38OnAfterValidateEventOrderAddressCode@1101103021(VAR Rec@1101103002 : Record 38;VAR xRec@1101103003 : Record 38;CurrFieldNo@1101103004 : Integer);
    VAR
      VendorL@1101103000 : Record 23;
    BEGIN
      IF Rec."Order Address Code" = '' THEN BEGIN
        OASMgtG.GetVend(Rec."Buy-from Vendor No.", VendorL);
        //hhe 16.09.05->
        Rec."Buy-from Address 3" := VendorL."Address 3";
        //hhe 16.09.05<-
        IF Rec.IsCreditDocType THEN BEGIN
          //hhe 16.09.05->
          Rec."Ship-to Address 3" := VendorL."Address 3";
          //hhe 16.09.05<-
        END;
      END;
    END;

    [EventSubscriber(Table,39,OnAfterValidateEvent,"No.")]
    LOCAL PROCEDURE TAB39OnAfterValidateEventNo@1101103022(VAR Rec@1101103001 : Record 39;VAR xRec@1101103002 : Record 39;CurrFieldNo@1101103003 : Integer);
    VAR
      ItemL@1101103000 : Record 27;
    BEGIN
      CASE Rec.Type OF
        Rec.Type::Item:
          BEGIN
            OASMgtG.GetItem(Rec."No.", ItemL);
            //02. ->
            IF ItemL."Simulation Item" THEN
              ERROR(C_Text02);
            //02.<-
            //1.0 ->
            Rec."Quality Control Code" := ItemL."Quality Control Code";
            Rec."Shelf No." := ItemL."Shelf No.";
            //1.0<-
          END;
      END;
    END;

    [EventSubscriber(Table,39,OnAfterGetItemTranslation)]
    LOCAL PROCEDURE TAB39OnAfterGetItemTranslation@1101103023(VAR PurchaseLineP@1101103000 : Record 39;VAR ItemTranslationP@1101103001 : Record 30);
    BEGIN
      //05. ->
      IF ItemTranslationP."Description 2" <> '' THEN
      PurchaseLineP."Description 2" := ItemTranslationP."Description 2";
      //05. <-
    END;

    [EventSubscriber(Table,44,OnBeforeModifyEvent)]
    LOCAL PROCEDURE TAB44OnBeforeModifyEvent@1101103024(VAR Rec@1101103000 : Record 44;VAR xRec@1101103001 : Record 44;RunTrigger@1101103002 : Boolean);
    BEGIN
      //03.->
      IF Rec."Document Type" = Rec."Document Type"::"Posted Invoice" THEN
          ERROR(C_Text03);
      //03.<-
    END;

    [EventSubscriber(Table,44,OnBeforeDeleteEvent)]
    LOCAL PROCEDURE TAB44OnBeforeDeleteEvent@1101103025(VAR Rec@1101103000 : Record 44;RunTrigger@1101103001 : Boolean);
    BEGIN
      //03.->
      IF Rec."Document Type" = Rec."Document Type"::"Posted Invoice" THEN
          ERROR(C_Text03);
      //03.<-
    END;

    [EventSubscriber(Table,77,OnPrintWithGUIYesNoBeforeFindPrintUsage)]
    LOCAL PROCEDURE TAB77OnPrintWithGUIYesNoBeforeFindPrintUsage@1101103099(VAR RecP@1101103000 : Record 77;VAR RecordVariantP@1101103001 : Variant;VAR ReportOrderClassP@1101103004 : Code[10]);
    VAR
      SalesHeaderL@1101103003 : Record 36;
      RecordRefL@1101103002 : RecordRef;
    BEGIN
      IF RecordVariantP.ISRECORD THEN BEGIN
        RecordRefL.GETTABLE(RecordVariantP);
        CASE RecordRefL.NUMBER OF
          DATABASE::"Sales Header":
            BEGIN
              RecordRefL.SETTABLE(SalesHeaderL);
               //01. Code moved from COD229->
              ReportOrderClassP := SalesHeaderL."Order Class";
              RecP.SETRANGE("Order Class", ReportOrderClassP);
              // 01.<-
            END;
        END;
      END;
    END;

    [EventSubscriber(Table,77,OnFindPrintUsageBeforeFindSet)]
    LOCAL PROCEDURE TAB77OnFindPrintUsageBeforeFindSet@1101103101(VAR RecP@1101103000 : Record 77;VAR ReportSelectionsP@1101103001 : Record 77;VAR ReportOrderClassP@1101103004 : Code[10]);
    VAR
      SalesHeaderL@1101103003 : Record 36;
      RecordRefL@1101103002 : RecordRef;
    BEGIN
      //01. Code moved from COD229->
      RecP.SETRANGE("Order Class", ReportOrderClassP);
      ReportSelectionsP.SETRANGE("Order Class", ReportOrderClassP);
      // 01.<-
    END;

    [EventSubscriber(Table,81,OnAfterValidateEvent,"Apply Document No.")]
    LOCAL PROCEDURE TAB81OnAfterValidateEventApplyDocumentNo@1101103026(VAR Rec@1101103001 : Record 81;VAR xRec@1101103002 : Record 81;CurrFieldNo@1101103003 : Integer);
    VAR
      CustLedgEntry@1101103007 : Record 21;
      VendLedgEntry@1101103006 : Record 25;
      ApplyCustomerEntries@1101103005 : Page 232;
      ApplyVendorEntries@1101103004 : Page 233;
      LastEntryNo@1101103000 : Integer;
    BEGIN
      // HUU01 >>
      IF Rec."Apply Document No." = '' THEN
        EXIT;
      CASE Rec."Account Type" OF
        Rec."Account Type"::Customer: BEGIN
          CustLedgEntry.SETCURRENTKEY("Document No.","Document Type","Customer No.");
          CustLedgEntry.SETRANGE("Document Type");
          CustLedgEntry.SETFILTER("Document No.",'%1',Rec."Apply Document No.");
          IF Rec."Account No." <> '' THEN
            CustLedgEntry.SETRANGE("Customer No.", Rec."Account No.");
          IF NOT CustLedgEntry.FINDLAST THEN
            ERROR(C_Text58400, CustLedgEntry. GETFILTERS);
          LastEntryNo := CustLedgEntry."Entry No.";
          CustLedgEntry.FINDFIRST;
          IF CustLedgEntry."Entry No." <> LastEntryNo THEN
            IF CONFIRM(C_Text58401,TRUE) THEN BEGIN
              ApplyCustomerEntries.SETTABLEVIEW(CustLedgEntry);
              ApplyCustomerEntries.SETRECORD(CustLedgEntry);
              ApplyCustomerEntries.LOOKUPMODE(TRUE);
              IF ApplyCustomerEntries.RUNMODAL = ACTION::LookupOK THEN
                ApplyCustomerEntries.GETRECORD(CustLedgEntry)
              ELSE
                ERROR('');
            END ELSE
              ERROR('');
          CustLedgEntry.TESTFIELD(Open,TRUE);
          // Copy data to the Gen. Jnl. Line
          Rec."Apply Document No." := CustLedgEntry."Document No.";
          Rec.VALIDATE("Account Type", Rec."Account Type"::Customer);
          Rec.VALIDATE("Account No.",CustLedgEntry."Customer No.");
          CASE CustLedgEntry."Document Type" OF
            CustLedgEntry."Document Type"::"Credit Memo": BEGIN
              Rec.VALIDATE("Document Type", Rec."Document Type"::" ");
              Rec.VALIDATE(Description,STRSUBSTNO(C_Text58402,CustLedgEntry."Document No."));
            END;
            CustLedgEntry."Document Type"::Invoice: BEGIN
              Rec.VALIDATE("Document Type", Rec."Document Type"::Payment);
              Rec.VALIDATE(Description,STRSUBSTNO(C_Text58403,CustLedgEntry."Document No."));
            END;
          ELSE
            Rec.VALIDATE("Document Type", Rec."Document Type"::" ");
            Rec.VALIDATE(Description,STRSUBSTNO(C_Text58404,CustLedgEntry."Document No."));
          END;
          Rec.VALIDATE("Currency Code",CustLedgEntry."Currency Code");
          CustLedgEntry.CALCFIELDS("Remaining Amount");
          Rec.VALIDATE(Amount,-CustLedgEntry."Remaining Amount");
          Rec.VALIDATE("Applies-to Doc. Type",CustLedgEntry."Document Type");
          Rec.VALIDATE("Applies-to Doc. No.",CustLedgEntry."Document No.");
        END;
        Rec."Account Type"::Vendor: BEGIN
          VendLedgEntry.SETCURRENTKEY("External Document No.");
          VendLedgEntry.SETRANGE("Document Type");
          VendLedgEntry.SETFILTER("External Document No.", '%1', Rec."Apply Document No.");
          IF Rec."Account No." <> '' THEN
            VendLedgEntry.SETRANGE("Vendor No.", Rec."Account No.");
          IF NOT VendLedgEntry.FINDLAST THEN
            ERROR(C_Text58400, VendLedgEntry.GETFILTERS);
          LastEntryNo := VendLedgEntry."Entry No.";
          VendLedgEntry.FINDFIRST;
          IF VendLedgEntry."Entry No." <> LastEntryNo THEN
            IF CONFIRM(C_Text58401,TRUE) THEN BEGIN
              ApplyVendorEntries.SETTABLEVIEW(VendLedgEntry);
              ApplyVendorEntries.SETRECORD(VendLedgEntry);
              ApplyVendorEntries.LOOKUPMODE(TRUE);
              IF ApplyVendorEntries.RUNMODAL = ACTION::LookupOK THEN
                ApplyVendorEntries.GETRECORD(VendLedgEntry)
              ELSE
                ERROR('');
            END ELSE
              ERROR('');
          VendLedgEntry.TESTFIELD(Open,TRUE);
          // Copy data to the Gen. Jnl. Line
          Rec."Apply Document No." := VendLedgEntry."External Document No.";
          Rec.VALIDATE("Account Type", Rec."Account Type"::Vendor);
          Rec.VALIDATE("Account No.",VendLedgEntry."Vendor No.");
          Rec.VALIDATE("Document Type", Rec."Document Type"::Payment);
          CASE VendLedgEntry."Document Type" OF
            VendLedgEntry."Document Type"::"Credit Memo": BEGIN
              Rec.VALIDATE("Document Type", Rec."Document Type"::" ");
              Rec.VALIDATE(Description,STRSUBSTNO(C_Text58402,VendLedgEntry."External Document No."));
            END;
            VendLedgEntry."Document Type"::Invoice: BEGIN
              Rec.VALIDATE("Document Type", Rec."Document Type"::Payment);
              Rec.VALIDATE(Description,STRSUBSTNO(C_Text58406,VendLedgEntry."External Document No."));
            END;
          ELSE
            Rec.VALIDATE("Document Type", Rec."Document Type"::" ");
            Rec.VALIDATE(Description,STRSUBSTNO(C_Text58407,VendLedgEntry."External Document No."));
          END;
          Rec.VALIDATE("Currency Code",VendLedgEntry."Currency Code");
          VendLedgEntry.CALCFIELDS("Remaining Amount");
          Rec.VALIDATE(Amount,-VendLedgEntry."Remaining Amount");
          Rec.VALIDATE("Applies-to Doc. Type",VendLedgEntry."Document Type");
          Rec.VALIDATE("Applies-to Doc. No.",VendLedgEntry."Document No.");
        END;
        ELSE
          Rec.FIELDERROR("Account Type");
      END;
      // HUU01 <<
    END;

    [EventSubscriber(Table,83,OnBeforeValidateEvent,"Item No.")]
    LOCAL PROCEDURE TAB83OnAfterValidateEventItemNo@1101103027(VAR Rec@1101103001 : Record 83;VAR xRec@1101103002 : Record 83;CurrFieldNo@1101103003 : Integer);
    VAR
      ItemL@1101103000 : Record 27;
    BEGIN
      IF Rec."Item No." <> '' THEN
        BEGIN
        //01.->
          OASMgtG.GetItem(Rec."Item No.", ItemL);
          IF  ItemL."Simulation Item" THEN
            ERROR(C_Text04);
          //01.<-
          //02.->
          Rec."Description 2" := ItemL."Description 2";
          Rec."Shelf No." := ItemL."Shelf No.";
        //02.<-
        END;
    END;

    [EventSubscriber(Table,83,OnAfterCopyFromSalesLine)]
    LOCAL PROCEDURE TAB83OnAfterCopyFromSalesLine@1101103094(VAR ItemJournalLineP@1101103001 : Record 83;VAR SalesLineP@1101103002 : Record 37);
    VAR
      ItemL@1101103000 : Record 27;
    BEGIN
      //01.->
      OASMgtG.GetItem(ItemJournalLineP."Item No.", ItemL);
      IF  ItemL."Simulation Item" THEN
        ERROR(C_Text04);
      //01.<-
      //02.->
      ItemJournalLineP."Description 2" := ItemL."Description 2";
      ItemJournalLineP."Shelf No." := ItemL."Shelf No.";
      //02.<-
    END;

    [EventSubscriber(Table,99,OnBeforeInsertEvent)]
    LOCAL PROCEDURE TAB98OnBeforeInsertEvent@1101103028(VAR Rec@1101103000 : Record 99;RunTrigger@1101103001 : Boolean);
    VAR
      ItemL@1101103002 : Record 27;
    BEGIN
      //hhe 23.08.07->
      ItemL.GET(Rec."Item No.");
      Rec."Product connection" := ItemL."Product Connection";
      //hhe 23.08.07<-
    END;

    [EventSubscriber(Table,99,OnAfterDeleteEvent)]
    LOCAL PROCEDURE TAB98OnAfterDeleteEvent@1101103030(VAR Rec@1101103000 : Record 99;RunTrigger@1101103001 : Boolean);
    VAR
      ItemL@1101103002 : Record 27;
    BEGIN
      //hhe 09.08.07->
      IF ItemL.GET(Rec."Item No.") THEN BEGIN
        IF ItemL."Vendor No." = Rec."Vendor No." THEN BEGIN
          ItemL."Vendor No." := '';
          ItemL."Vendor Item No." := '';
          ItemL.MODIFY;
        END;
      END;
      //hhe 09.08.07<-
    END;

    [EventSubscriber(Table,99,OnAfterValidateEvent,"Vendor Item No.")]
    LOCAL PROCEDURE TAB98OnAfterValidateEventVendorItemNo@1101103029(VAR Rec@1101103000 : Record 99;VAR xRec@1101103001 : Record 99;CurrFieldNo@1101103003 : Integer);
    VAR
      ItemL@1101103002 : Record 27;
    BEGIN
      //01. ->
      IF ItemL.GET(Rec."Item No.") THEN
        IF ItemL."Vendor No." = Rec."Vendor No." THEN BEGIN
          ItemL."Vendor Item No." := Rec."Vendor Item No.";
          ItemL.MODIFY;
        END;
      //01. <-
    END;

    [EventSubscriber(Table,121,OnBeforeInsertInvLineFromRcptLine)]
    LOCAL PROCEDURE TAB121OnBeforeInsertInvLineFromRcptLine@1101103031(VAR PurchRcptLineP@1101103000 : Record 121;VAR PurchaseLineP@1101103001 : Record 39;Text000P@1101103002 : Text);
    BEGIN
      //hhe 29.09.04->
      PurchaseLineP.Description := STRSUBSTNO(C_Text05, PurchRcptLineP."Order No.");
      PurchaseLineP."Description 2":= STRSUBSTNO(Text000P, PurchRcptLineP."Document No.");
      //hhe 29.09.04<-
    END;

    [EventSubscriber(Table,121,OnAfterInitFromPurchLine)]
    LOCAL PROCEDURE TAB121OnAfterInitFromPurchLine@1101103097(VAR PurchRcptHeaderP@1101103000 : Record 120;VAR PurchaseLineP@1101103001 : Record 39;VAR PurchRcptLineP@1101103002 : Record 121);
    VAR
      InventorySetupL@1101103003 : Record 313;
      SimReceiptDateL@1101103004 : Date;
    BEGIN
      // 05 SID ASL 27.02.07 Moved from COD90 START
      PurchRcptLineP."SID Posting Date" := PurchRcptHeaderP."Posting Date"; // TEST ASL 27.02.07
      InventorySetupL.GET();
      IF PurchRcptLineP."Requested Receipt Date" <> 0D THEN
        SimReceiptDateL := CALCDATE(InventorySetupL."Receipt Buffer", PurchRcptLineP."Requested Receipt Date");
      IF (PurchRcptLineP."Requested Receipt Date" <> 0D) AND (SimReceiptDateL <> 0D) THEN
        PurchRcptLineP."Delivery Days Deviation" := PurchRcptLineP."SID Posting Date" - SimReceiptDateL;
      IF (PurchRcptLineP."Delivery Days Deviation" >= -4) AND (PurchRcptLineP."Delivery Days Deviation" <= 0) THEN
        PurchRcptLineP."Delivery Days Deviation" := 0;
      // 05 SID ASL 27.02.07 SLUTT
    END;

    [EventSubscriber(Table,5062,OnBeforeRunAttachment)]
    LOCAL PROCEDURE TAB5062OnBeforeRunAttachment@1101103032(VAR AttachmentP@1101103000 : Record 5062);
    BEGIN
      //SID.01 Start
      IF AttachmentP."Read Only" = TRUE THEN BEGIN
        AttachmentP."Read Only" := FALSE;
        AttachmentP.MODIFY;
        COMMIT;
      END;
      //SID.01 Stopp
    END;

    [EventSubscriber(Table,5405,OnBeforeInsertEvent)]
    LOCAL PROCEDURE TAB5405OnBeforeInsertEvent@1101103033(VAR Rec@1101103000 : Record 5405;RunTrigger@1101103001 : Boolean);
    VAR
      UserSetupL@1101103002 : Record 91;
      ManufacturingSetupL@1101103003 : Record 99000765;
    BEGIN
      //01.->
      Rec."Location Code" := ManufacturingSetupL."Std. Lokasjon";
      //01.<-
      //08. -->
      IF UserSetupL.GET(USERID) THEN
        Rec."Purchaser Code":= UserSetupL.SalesPersonCode;
      //08.--<
    END;

    [EventSubscriber(Table,5405,OnBeforeDeleteEvent)]
    LOCAL PROCEDURE TAB5405OnBeforeDeleteEvent@1101103034(VAR Rec@1101103000 : Record 5405;RunTrigger@1101103001 : Boolean);
    VAR
      RunTimesL@1101103002 : Record 83010;
    BEGIN
      //07.-> hhe 29.07.10
      RunTimesL.SETRANGE("Prod. Order No.", Rec."No.");
      IF RunTimesL.FINDFIRST THEN
        ERROR(C_Text06 + '. '+ C_Text07, RunTimesL."Work Done at M.C.");
      //07.<- hhe 29.07.10
    END;

    [EventSubscriber(Table,5405,OnBeforeValidateEvent,"Source No.")]
    LOCAL PROCEDURE TAB5405OnBeforeValidateEventSourceNo@1101103035(VAR Rec@1101103000 : Record 5405;VAR xRec@1101103001 : Record 5405;CurrFieldNo@1101103002 : Integer);
    VAR
      ItemL@1101103003 : Record 27;
    BEGIN
      CASE Rec."Source Type" OF
        Rec."Source Type"::Item:
          BEGIN
            ItemL.GET(Rec."Source No.");
            //03.->
            IF (Rec.Status <> Rec.Status::Simulated) AND ItemL."Simulation Item" THEN
              ERROR(C_Text08);
            //03.<-
            ItemL.TESTFIELD(Blocked,FALSE);
            //hhe ->
            Rec."Tegningsnr./versjon" := ItemL."Drawing No./ Revision";
            //hhe <-
          END;
      END;
    END;

    [EventSubscriber(Table,5407,OnBeforeDeleteEvent)]
    LOCAL PROCEDURE TAB5407OnBeforeDeleteEvent@1101103092(VAR Rec@1101103000 : Record 5407;RunTrigger@1101103001 : Boolean);
    VAR
      RunTimesL@1101103002 : Record 83010;
    BEGIN
      IF RunTrigger THEN
        IF Rec.Status = Rec.Status::Released THEN BEGIN
          IF Rec."Item Ledger Enty Exist" THEN
            ERROR(C_Text29, Rec."Item No.");
        END;
    END;

    [EventSubscriber(Table,5407,OnAfterValidateEvent,"Item No.")]
    LOCAL PROCEDURE TAB5407OnAfterValidateEventItemNo@1101103093(VAR Rec@1101103000 : Record 5407;VAR xRec@1101103001 : Record 5407;CurrFieldNo@1101103003 : Integer);
    VAR
      ItemL@1101103002 : Record 27;
      ProductionOrderL@1101103004 : Record 5405;
    BEGIN
      ItemL.GET(Rec."Item No.");
      //hhe 27.11.03 ->
      Rec."Hyllenr." := ItemL."Shelf No.";
      Rec."Vendor No." := ItemL."Vendor No.";
      //hhe 27.11.03 <-
      // 02. ASL 09.01.04 ->
      Rec."Beskrivelse 2" := ItemL."Description 2";
      // 02. ASL 09.01.04 <-
      //hhe 03.11.04->
      Rec."Kopieres til serv.komponent" := ItemL."Copy To Service Component";
      //hhe 03.11.04<-
      //hhe 11.11.08->
      ProductionOrderL.GET(Rec.Status, Rec."Prod. Order No.");
      Rec.VALIDATE("Location Code", ProductionOrderL."Location Code");
      //hhe 11.11.08<-
    END;

    [EventSubscriber(Table,5409,OnBeforeDeleteEvent)]
    LOCAL PROCEDURE TAB5409OnBeforeDeleteEvent@1101103036(VAR Rec@1101103000 : Record 5409;RunTrigger@1101103001 : Boolean);
    VAR
      CapacityLedgerEntryL@1101103002 : Record 5832;
    BEGIN
      IF RunTrigger AND (Rec.Status = Rec.Status::Released) THEN BEGIN
        CapacityLedgerEntryL.SETRANGE("Order Type", CapacityLedgerEntryL."Order Type"::Production);
        CapacityLedgerEntryL.SETRANGE("Order No.", Rec."Prod. Order No.");
        CapacityLedgerEntryL.SETRANGE("Routing Reference No.", Rec."Routing Reference No.");
        CapacityLedgerEntryL.SETRANGE("Routing No.", Rec."Routing No.");
        CapacityLedgerEntryL.SETRANGE("Operation No.", Rec."Operation No.");
        CapacityLedgerEntryL.SETFILTER("Output Quantity", '<>0');
        IF NOT CapacityLedgerEntryL.ISEMPTY THEN
          ERROR(C_Text09);
        //hhe 12.11.07<-
      END;
    END;

    [EventSubscriber(Table,5900,OnAfterValidateEvent,"Customer No.")]
    LOCAL PROCEDURE TAB5900OnAfterValidateEventCustomerNo@1101103037(VAR Rec@1101103000 : Record 5900;VAR xRec@1101103001 : Record 5900;CurrFieldNo@1101103002 : Integer);
    VAR
      CustomerL@1101103003 : Record 18;
      ServiceMgtSetupL@1101103004 : Record 5911;
      ShiptoAddressL@1101103005 : Record 222;
    BEGIN
      OASMgtG.GetCust(Rec."Customer No.", CustomerL);
      IF Rec."Customer No." <> '' THEN BEGIN
        //07->
        ServiceMgtSetupL.GET;
        Rec."Shipment Method Code":= CustomerL."Shipment Method Code";
        Rec."Shipping Agent Code" := CustomerL."Shipping Agent Code";
        IF Rec."Location Code" = '' THEN
          Rec.VALIDATE("Location Code", ServiceMgtSetupL."Default Location Code");
      //07-<
      END;
      // 09. JAL -->
      ShiptoAddressL.SETRANGE("Customer No.", Rec."Customer No.");
      IF ShiptoAddressL.FINDLAST THEN
        Rec.VALIDATE("Ship-to Code", ShiptoAddressL.Code);
      IF (Rec."Customer No." <> '')  AND (CustomerL."Default lev.adresse" <> '') THEN
        Rec.VALIDATE("Ship-to Code", CustomerL."Default lev.adresse");
      //09. JAL <--

      ServiceMgtIncG.CreateServAllocLine(Rec);//06.
    END;

    [EventSubscriber(Table,5900,OnAfterValidateEvent,"Bill-to Customer No.")]
    LOCAL PROCEDURE TAB5900OnAfterValidateEventBillToCustomerNo@1101103038(VAR Rec@1101103000 : Record 5900;VAR xRec@1101103001 : Record 5900;CurrFieldNo@1101103002 : Integer);
    VAR
      CustomerL@1101103003 : Record 18;
      UserSetupL@1101103004 : Record 91;
    BEGIN
      OASMgtG.GetCust(Rec."Customer No.", CustomerL);
      IF Rec."Customer No." <> '' THEN BEGIN
        //01. JAL 17.02.15 -->
        Rec."PDF E-Mail" := CustomerL."PDF E-Mail";
        Rec."Send Invoice in E-Mail" := CustomerL."Send Invoice in E-Mail";
        //01. JAL 17.02.15 <--
      END;
      //01. BVM 31.01.13-->
      IF UserSetupL.GET(USERID) THEN
        Rec.VALIDATE("Salesperson Code", UserSetupL.SalesPersonCode)
      ELSE
      //01. BVM 31.01.13--<
    END;

    [EventSubscriber(Table,5900,OnAfterValidateEvent,"Ship-to Code")]
    LOCAL PROCEDURE TAB5900OnAfterValidateEventShipToCode@1101103040(VAR Rec@1101103000 : Record 5900;VAR xRec@1101103001 : Record 5900;CurrFieldNo@1101103002 : Integer);
    VAR
      ServiceMgtSetupL@1101103003 : Record 5911;
      ShiptoAddressL@1101103004 : Record 222;
      CustomerL@1101103005 : Record 18;
    BEGIN

      IF Rec."Document Type" <> Rec."Document Type"::"Credit Memo" THEN
        IF Rec."Ship-to Code" <> '' THEN BEGIN
          ShiptoAddressL.GET(Rec."Customer No.", Rec."Ship-to Code");
          //07.-->
          ServiceMgtSetupL.GET;
          Rec."Shipment Method Code":= ShiptoAddressL."Shipment Method Code";
          Rec."Shipping Agent Code" := ShiptoAddressL."Shipping Agent Code";
          IF Rec."Location Code" = '' THEN
            Rec."Location Code":= ServiceMgtSetupL."Default Location Code";
          //07--<
        END ELSE
          IF Rec."Customer No." <> '' THEN BEGIN
            OASMgtG.GetCust(Rec."Customer No.", CustomerL);
            //07.-->
            ServiceMgtSetupL.GET;
            Rec."Shipment Method Code":= CustomerL."Shipment Method Code";
            Rec."Shipping Agent Code" := CustomerL."Shipping Agent Code";
            IF Rec."Location Code" = '' THEN
              Rec."Location Code":= ServiceMgtSetupL."Default Location Code";
            //07--<
          END;
    END;

    [EventSubscriber(Table,5900,OnAfterValidateEvent,"Language Code")]
    LOCAL PROCEDURE TAB5900OnAfterValidateEventLanguageCode@1101103044(VAR Rec@1101103000 : Record 5900;VAR xRec@1101103001 : Record 5900;CurrFieldNo@1101103002 : Integer);
    VAR
      ServiceOrderAllocationL@1101103003 : Record 5950;
    BEGIN
      //10.Planning Tool m¹ ha en linje for uplanlagte ordrer
      ServiceOrderAllocationL.SETRANGE("Document No.", Rec."No.");
      IF ServiceOrderAllocationL.FINDFIRST THEN BEGIN
        ServiceOrderAllocationL.VALIDATE("Location Code", Rec."Location Code");
        ServiceOrderAllocationL.MODIFY;
      END;
      //10. --<
    END;

    [EventSubscriber(Table,5900,OnAfterValidateEvent,"Starting Date")]
    LOCAL PROCEDURE TAB5900OnAfterValidateEventStartingDate@1101103041(VAR Rec@1101103000 : Record 5900;VAR xRec@1101103001 : Record 5900;CurrFieldNo@1101103002 : Integer);
    VAR
      ServiceItemLineL@1101103003 : Record 5901;
    BEGIN
      IF Rec."Starting Date" <> 0D THEN BEGIN
        IF Rec."Starting Date" < Rec."Order Date" THEN
          ERROR(C_Text10, Rec.FIELDCAPTION("Starting Date"), Rec.FIELDCAPTION("Order Date"));

        ServiceItemLineL.SETRANGE("Document Type", Rec."Document Type");
        ServiceItemLineL.SETRANGE("Document No.", Rec."No.");
        IF ServiceItemLineL.FINDFIRST THEN BEGIN
          Rec.MODIFY(TRUE); // Save values before start modifying lines and header
          REPEAT
            ServiceItemLineL.VALIDATE("Starting Date", Rec."Starting Date");
            ServiceItemLineL.MODIFY(TRUE);
          UNTIL ServiceItemLineL.NEXT = 0;
          Rec.GET(Rec."Document Type", Rec."No.");//Record is modified when Service Item Line is modified
        END;
      END;
      //09--  ->
    END;

    [EventSubscriber(Table,5900,OnBeforeUpdateCont)]
    LOCAL PROCEDURE TAB5900OnBeforeUpdateCont@1101103042(VAR ServiceHeaderP@1101103000 : Record 5900;VAR ContactNoP@1101103001 : Code[20]);
    VAR
      ContactL@1101103003 : Record 5050;
    BEGIN
      IF ContactL.GET(ContactNoP) THEN
        ServiceHeaderP."Phone No. 2" := ContactL."Mobile Phone No.";//08.
    END;

    [EventSubscriber(Table,5900,OnBeforeUpdateCust)]
    LOCAL PROCEDURE TAB5900OnBeforeUpdateCust@1101103043(VAR ServiceHeaderP@1101103000 : Record 5900;VAR ContactNoP@1101103001 : Code[20]);
    VAR
      ContactL@1101103003 : Record 5050;
    BEGIN
      IF ContactL.GET(ContactNoP) THEN
        ServiceHeaderP."Phone No. 2" := ContactL."Mobile Phone No." //08.
      ELSE BEGIN
        ServiceHeaderP."Phone No. 2" := ''; //08.
      END;
    END;

    [EventSubscriber(Table,5900,OnAfterInitRecord)]
    LOCAL PROCEDURE TAB5900OnAfterInitRecord@1101103045(VAR ServiceHeaderP@1101103000 : Record 5900);
    VAR
      ServiceMgtSetupL@1101103003 : Record 5911;
    BEGIN
      ServiceMgtSetupL.GET;
      //07.-->
      IF  ServiceHeaderP."Location Code" = '' THEN
        ServiceHeaderP."Location Code":= ServiceMgtSetupL."Default Location Code";
      //07..<
      ServiceHeaderP."Notify Customer" := ServiceHeaderP."Notify Customer"::"By Email";
    END;

    [EventSubscriber(Table,5901,OnBeforeValidateEvent,"Service Item No.")]
    LOCAL PROCEDURE TAB5901OnBeforeValidateEventServiceItemNo@1101103046(VAR Rec@1101103000 : Record 5901;VAR xRec@1101103001 : Record 5901;CurrFieldNo@1101103002 : Integer);
    VAR
      ServiceHeaderL@1101103003 : Record 5900;
      ServiceItemL@1101103004 : Record 5940;
      ServiceItemComponentL@1101103005 : Record 5941;
    BEGIN
      //11. Sjekk om Service ordre type er utfylt
      IF ServiceHeaderL.GET(Rec."Document Type", Rec."Document No.") THEN
        ServiceHeaderL.TESTFIELD("Service Order Type");
      //11.
      IF Rec."Service Item No." = '' THEN
        IF xRec."Service Item No." <> Rec."Service Item No." THEN
          Rec.VALIDATE("Customer Serial No.", '');//04.
      //hhe 27.10.04 ->
      IF ServiceItemL.GET(Rec."Service Item No.") THEN
        ServiceItemComponentL.RESET;
        ServiceItemComponentL.SETRANGE(Active, TRUE);
        ServiceItemComponentL.SETRANGE("Parent Service Item No.", Rec."Service Item No.");
        ServiceItemComponentL.SETRANGE("Component Type", 1);
        IF ServiceItemComponentL.FINDLAST THEN BEGIN
          Rec.VALIDATE("Engine Type", ServiceItemComponentL."No.");
          Rec.VALIDATE("Engine Type - Description", ServiceItemComponentL.Description);
          Rec.VALIDATE("Engine Type - Description 2", ServiceItemComponentL."Description 2");
          END;
      //hhe 27.10.04 <-
    END;

    [EventSubscriber(Table,5901,OnBeforeValidateEvent,"Service Item Group Code")]
    LOCAL PROCEDURE TAB5901OnBeforeValidateEventServiceItemGroupCode@1101103047(VAR Rec@1101103000 : Record 5901;VAR xRec@1101103001 : Record 5901;CurrFieldNo@1101103002 : Integer);
    VAR
      ServiceHeaderL@1101103003 : Record 5900;
    BEGIN
      //11. Sjekk om Service ordre type er utfylt
      IF ServiceHeaderL.GET(Rec."Document Type", Rec."Document No.") THEN
        ServiceHeaderL.TESTFIELD("Service Order Type");
      //11.
    END;

    [EventSubscriber(Table,5901,OnBeforeValidateEvent,"Repair Status Code")]
    LOCAL PROCEDURE TAB5901OnBeforeValidateEventRepairStatusCode@1101103048(VAR Rec@1101103000 : Record 5901;VAR xRec@1101103001 : Record 5901;CurrFieldNo@1101103002 : Integer);
    VAR
      ServiceItemGroupL@1101103003 : Record 5904;
      RepairStatusL@1101103004 : Record 5927;
    BEGIN
      IF Rec."Repair Status Code" <> '' THEN BEGIN
        RepairStatusL.GET(Rec."Repair Status Code");
        IF RepairStatusL.Finished THEN BEGIN
          //07. Test p† krav til registrering av driftstid dersom servicevare gruppe er utfyldt
          IF (Rec."Hours Used Registered"=FALSE) AND (Rec."Service Item Group Code" <> '') THEN BEGIN
              ServiceItemGroupL.GET(Rec."Service Item Group Code");
              IF ServiceItemGroupL."Registration Hours Used" = ServiceItemGroupL."Registration Hours Used"::Always THEN
                ERROR(C_Text11);
              IF ServiceItemGroupL."Registration Hours Used" = ServiceItemGroupL."Registration Hours Used"::Alternative THEN BEGIN
                IF NOT DIALOG.CONFIRM(C_Text12,FALSE) THEN
                  ERROR('');
              END;
            END;
          //07. -<
        END;
      END;
    END;

    [EventSubscriber(Table,5901,OnBeforeValidateEvent,"Warranty Starting Date (Parts)")]
    LOCAL PROCEDURE TAB5901OnBeforeValidateEventWarrantyStartingDateParts@1101103051(VAR Rec@1101103000 : Record 5901;VAR xRec@1101103001 : Record 5901;CurrFieldNo@1101103002 : Integer);
    BEGIN
      //10.-->
      IF Rec.ServLineExistsRec(Rec) THEN
        ERROR(C_Text13);
      //10.--<
    END;

    [EventSubscriber(Table,5901,OnBeforeValidateEvent,"Warranty Ending Date (Parts)")]
    LOCAL PROCEDURE TAB5901OnBeforeValidateEventWarrantyEndingDateParts@1101103053(VAR Rec@1101103000 : Record 5901;VAR xRec@1101103001 : Record 5901;CurrFieldNo@1101103002 : Integer);
    BEGIN
      //10.-->
      IF Rec.ServLineExistsRec(Rec) THEN
        ERROR(C_Text13);
      //10.--<
    END;

    [EventSubscriber(Table,5901,OnBeforeValidateEvent,Warranty)]
    LOCAL PROCEDURE TAB5901OnBeforeValidateEventWarranty@1101103054(VAR Rec@1101103000 : Record 5901;VAR xRec@1101103001 : Record 5901;CurrFieldNo@1101103002 : Integer);
    VAR
      ServiceHeaderL@1101103003 : Record 5900;
      ServiceItemL@1101103004 : Record 5940;
    BEGIN
      //10.  -->
      ServiceHeaderL.GET(Rec."Document Type", Rec."Document No.");
      IF NOT Rec.ServLineExistsRec(Rec) THEN BEGIN
        IF NOT xRec.Warranty THEN BEGIN
          IF CONFIRM(C_Text14,TRUE) THEN BEGIN
            IF ServiceItemL.GET(Rec."Service Item No.") THEN BEGIN
              Rec.VALIDATE("Warranty Starting Date (Parts)", ServiceItemL."Warranty Starting Date (Parts)");
              Rec.VALIDATE("Warranty Starting Date (Labor)", ServiceItemL."Warranty Starting Date (Labor)");
              Rec.VALIDATE("Warranty Ending Date (Parts)", ServiceItemL."Warranty Ending Date (Parts)");
              Rec.VALIDATE("Warranty Ending Date (Labor)", ServiceItemL."Warranty Ending Date (Labor)");
              IF ServiceItemL."Warranty % (Parts)" = 0 THEN
                Rec.VALIDATE("Warranty % (Parts)", 100)
              ELSE
                Rec.VALIDATE("Warranty % (Parts)", ServiceItemL."Warranty % (Parts)");
              IF ServiceItemL."Warranty % (Labor)" =0 THEN
                Rec.VALIDATE("Warranty % (Labor)",100)
              ELSE
                Rec.VALIDATE("Warranty % (Labor)", ServiceItemL."Warranty % (Labor)");
              Rec.Warranty:= TRUE;
            END;
          END;
        END;
        IF  xRec.Warranty THEN BEGIN
          IF CONFIRM(C_Text15,TRUE) THEN BEGIN
              Rec.VALIDATE("Warranty % (Parts)",0);
              Rec.VALIDATE("Warranty % (Labor)",0);
              Rec.Warranty := FALSE;
            END;
        END;
        Rec.MODIFY;
      END ELSE BEGIN
        ERROR(C_Text13);
      END;
      //10.--<
    END;

    [EventSubscriber(Table,5901,OnBeforeValidateEvent,"Warranty % (Parts)")]
    LOCAL PROCEDURE TAB5901OnBeforeValidateEventWarrantyParts@1101103057(VAR Rec@1101103000 : Record 5901;VAR xRec@1101103001 : Record 5901;CurrFieldNo@1101103002 : Integer);
    BEGIN
      //10.-->
      IF Rec.ServLineExistsRec(Rec) THEN
        ERROR(C_Text13);
      //10.--<
    END;

    [EventSubscriber(Table,5901,OnBeforeValidateEvent,"Warranty % (Labor)")]
    LOCAL PROCEDURE TAB5901OnBeforeValidateEventWarrantyLabor@1101103058(VAR Rec@1101103000 : Record 5901;VAR xRec@1101103001 : Record 5901;CurrFieldNo@1101103002 : Integer);
    BEGIN
      //10.-->
      IF Rec.ServLineExistsRec(Rec) THEN
        ERROR(C_Text13);
      //10.--<
    END;

    [EventSubscriber(Table,5901,OnBeforeValidateEvent,"Warranty Starting Date (Labor)")]
    LOCAL PROCEDURE TAB5901OnBeforeValidateEventWarrantyStartingDateLabor@1101103059(VAR Rec@1101103000 : Record 5901;VAR xRec@1101103001 : Record 5901;CurrFieldNo@1101103002 : Integer);
    BEGIN
      //10.-->
      IF Rec.ServLineExistsRec(Rec) THEN
        ERROR(C_Text13);
      //10.--<
    END;

    [EventSubscriber(Table,5901,OnBeforeValidateEvent,"Warranty Ending Date (Labor)")]
    LOCAL PROCEDURE TAB5901OnBeforeValidateEventWarrantyEndingDateLabor@1101103060(VAR Rec@1101103000 : Record 5901;VAR xRec@1101103001 : Record 5901;CurrFieldNo@1101103002 : Integer);
    BEGIN
      //10.-->
      IF Rec.ServLineExistsRec(Rec) THEN
        ERROR(C_Text13);
      //10.--<
    END;

    [EventSubscriber(Table,5901,OnAfterValidateEvent,"Qty. Hours Used")]
    LOCAL PROCEDURE TAB5901OnAfterValidateEventQtyHoursUsed@1101103062(VAR Rec@1101103000 : Record 5901;VAR xRec@1101103001 : Record 5901;CurrFieldNo@1101103002 : Integer);
    VAR
      ServiceItemL@1101103003 : Record 5940;
      ServLogManagementL@1101103004 : Codeunit 5906;
    BEGIN
      //05.-->
      IF GUIALLOWED THEN BEGIN
        IF Rec."Qty. Hours Used" < xRec."Qty. Hours Used" THEN
          IF NOT DIALOG.CONFIRM(C_Text16,FALSE, Rec."Qty. Hours Used",xRec."Qty. Hours Used" ) THEN
            ERROR('');
      END;
        //05.--<
        //hhe 27.10.04->
        ServiceItemL.GET(Rec."Service Item No.");
        ServiceItemL."Qty. Hours Used" := Rec."Qty. Hours Used";
        ServiceItemL."Date Last Registered":= TODAY; //05.
        ServiceItemL.MODIFY;
        //hhe 27.10.04<-
        Rec."Date Last Registered":= TODAY;         //05.
        ServLogManagementL.ServItemUsedHoursChange(Rec, xRec);   //05.
        Rec.CheckWarranty(TODAY);                           //06.
        Rec."Hours Used Registered":=TRUE                    //07.
      //END;
    END;

    [EventSubscriber(Table,5901,OnAfterValidateEvent,"Date Last Registered")]
    LOCAL PROCEDURE TAB5901OnAfterValidateEventDateLastRegistered@1101103052(VAR Rec@1101103000 : Record 5901;VAR xRec@1101103001 : Record 5901;CurrFieldNo@1101103002 : Integer);
    VAR
      ServiceItemL@1101103003 : Record 5940;
      ServiceItemLogL@1101103004 : Record 5942;
    BEGIN
      //hhe 27.10.04->
      IF GUIALLOWED THEN BEGIN
        ServiceItemL.GET(Rec."Service Item No.");
        ServiceItemL."Date Last Registered" := Rec."Date Last Registered";
        ServiceItemL.MODIFY;
        //hhe 27.10.04<-
        //05.-->
        // Oppdaterer dato avlest p¹ log
        IF Rec."Date Last Registered" <> xRec."Date Last Registered" THEN BEGIN
          ServiceItemLogL.RESET;
          ServiceItemLogL.SETRANGE("Event No.", 19);
          ServiceItemLogL.SETFILTER(After, FORMAT(Rec."Qty. Hours Used"));
          ServiceItemLogL.SETRANGE("Log Type", ServiceItemLogL."Log Type"::"Hours used");
          IF ServiceItemLogL.FINDFIRST THEN BEGIN
              ServiceItemLogL."Hours Used Registered Date" := Rec."Date Last Registered";
              ServiceItemLogL.MODIFY;
          END ELSE
              MESSAGE(C_Text17);
        END;
      END;
      //05.--<
    END;

    [EventSubscriber(Table,5901,OnAfterValidateEvent,"Customer Serial No.")]
    LOCAL PROCEDURE TAB5901OnAfterValidateEventCustomerSerialNo@1101103056(VAR Rec@1101103000 : Record 5901;VAR xRec@1101103001 : Record 5901;CurrFieldNo@1101103002 : Integer);
    VAR
      ServiceItemL@1101103003 : Record 5940;
    BEGIN
      //04. 30.01.13>
      IF GUIALLOWED THEN BEGIN
        ServiceItemL.GET(Rec."Service Item No.");
        IF ServiceItemL."Customer Serial No." = '' THEN BEGIN
          ServiceItemL."Customer Serial No." := Rec."Customer Serial No.";
          ServiceItemL.MODIFY;
        END;
        IF ServiceItemL."Customer Serial No." <> Rec."Customer Serial No." THEN
          IF DIALOG.CONFIRM(C_Text18, FALSE, ServiceItemL."Customer Serial No.", Rec."Customer Serial No.") THEN BEGIN
            ServiceItemL."Customer Serial No.":= Rec."Customer Serial No.";
            ServiceItemL.MODIFY;
            MESSAGE(C_Text19);
        END;
      END;
      //04. 30.01.13 <-
    END;

    [EventSubscriber(Table,5901,OnCheckWarrantyBeforeSetServLines)]
    LOCAL PROCEDURE TAB5901OnCheckWarrantyBeforeSetServLines@1101103050(VAR ServiceItemLineP@1101103000 : Record 5901;VAR WarrantyP@1101103001 : Boolean;VAR WarrantyPartsP@1101103002 : Boolean;VAR WarrantyLaborP@1101103004 : Boolean);
    BEGIN
      IF WarrantyPartsP AND WarrantyLaborP THEN BEGIN
      //  //06. Garanti skal ogs† settes hvis Driftstid < Garanti (Driftstid) (skal overstyre dato) >>
      //  IF (ServiceItemLineP."Garanti(driftstimer)" > 0) AND (ServiceItemLineP."Garanti(driftstimer)" > ServiceItemLineP."Ant.driftstimer - sist avlest") THEN BEGIN
      //      WarrantyPartsp := TRUE;
      //      WarrantyLaborp := TRUE;
      //  END;
        IF (ServiceItemLineP."Warranty (Hours Used)" > 0) AND (ServiceItemLineP."Warranty (Hours Used)" < ServiceItemLineP."Qty. Hours Used") THEN BEGIN
          WarrantyLaborP := FALSE;
          WarrantyPartsP := FALSE;
        END;
      //  IF (ServiceItemLineP."Garanti(driftstimer)" > 0) AND (ServiceItemLineP."Garanti(driftstimer)" = ServiceItemLineP."Ant.driftstimer - sist avlest") THEN BEGIN
      //      WarrantyPartsp := TRUE;
      //      WarrantyLaborp := TRUE;
      //  END;
      END;
      //BVM 06.1.>>
      IF WarrantyP AND WarrantyPartsP AND WarrantyLaborP THEN
        WarrantyP := TRUE
      ELSE
        WarrantyP := FALSE;
      //BVM 06.1.<<
      //06--<<
    END;

    [EventSubscriber(Table,5901,OnBeforeCheckWarranty)]
    LOCAL PROCEDURE TAB5901OnBeforeCheckWarranty@1101103049(VAR ServiceItemLineP@1101103000 : Record 5901;VAR ServiceItemP@1101103001 : Record 5940);
    BEGIN
      //hhe 27.10.04->
      ServiceItemLineP."Qty. Hours Used" := ServiceItemP."Qty. Hours Used";
      ServiceItemLineP."Warranty (Hours Used)" := ServiceItemP."Warranty (Hours Used)";
      //hhe 27.10.04<-
      //hhe 10.11.04->
      ServiceItemLineP."Date Last Registered" := ServiceItemP."Date Last Registered";
      //hhe 10.11.04<-
      ServiceItemLineP."Customer Serial No.":= ServiceItemP."Customer Serial No.";//04.
    END;

    [EventSubscriber(Table,5902,OnValidateNoAfterSetWarranty)]
    LOCAL PROCEDURE TAB5902OnValidateNoAfterSetWarranty@1101103055(VAR ServiceLineP@1101103000 : Record 5902;VAR ServiceHeaderP@1101103001 : Record 5900;VAR ServiceItemLineP@1101103002 : Record 5901;VAR WarrantyP@1101103003 : Boolean);
    BEGIN
      WarrantyP :=
        ServiceItemLineP.Warranty AND
          //04..-> sjekk om evt. Driftstid  skal gi garanti
        //Org: (ServHeader."Order Date" >= ServItemLine."Warranty Starting Date (Labor)") AND
        //Org: (ServHeader."Order Date" <= ServItemLine."Warranty Ending Date (Labor)") AND
        //AND
        //04..<
        NOT ServiceLineP."Exclude Warranty";
    END;

    [EventSubscriber(Table,5902,OnBeforeValidateEvent,"No.")]
    LOCAL PROCEDURE TAB5902OnBeforeValidateEventNo@1101103061(VAR Rec@1101103000 : Record 5902;VAR xRec@1101103001 : Record 5902;CurrFieldNo@1101103002 : Integer);
    VAR
      ResourceL@1101103003 : Record 156;
      ServiceHeaderL@1101103004 : Record 5900;
      ServiceItemLineL@1101103005 : Record 5901;
      ServiceItemGroupL@1101103006 : Record 5904;
    BEGIN
      CASE Rec.Type OF
        Rec.Type::Resource:
          BEGIN
            ResourceL.GET(Rec."No.");
            ResourceL.TESTFIELD(Blocked,FALSE);
            ResourceL.TESTFIELD("Gen. Prod. Posting Group");

            //06 Test om driftstid er registrert-->
            ServiceHeaderL.GET(Rec."Document Type", Rec."Document No.");
            IF Rec."Service Item Line No." <> 0 THEN
              //ServiceItemLineL.GET(ServiceHeaderL."Document Type", ServiceHeaderL."No.", Rec."Service Item Line No.");
              ServiceItemLineL.GET(Rec."Document Type", Rec."Document No.",Rec. "Service Item Line No.");
            IF (ServiceItemLineL."Hours Used Registered" = FALSE)
                AND (ServiceItemLineL."Service Item No." <> '')
                AND (Rec."Document Type" = Rec."Document Type"::Order)
                AND (ServiceHeaderL.Status IN [ServiceHeaderL.Status::"In Process", ServiceHeaderL.Status::Finished])
            THEN BEGIN
                  ServiceItemGroupL.GET(ServiceItemLineL."Service Item Group Code");
                  IF ServiceItemGroupL."Registration Hours Used" = ServiceItemGroupL."Registration Hours Used"::Always THEN
                    ERROR(C_Text22);
                  IF GUIALLOWED AND (ServiceItemGroupL."Registration Hours Used" = ServiceItemGroupL."Registration Hours Used"::Alternative) THEN BEGIN
                    IF NOT DIALOG.CONFIRM(C_Text23, FALSE) THEN
                      ERROR('');
                  END;
              END;
            //06 Test om driftstid er registrert--<
        END;
      END;
    END;

    [EventSubscriber(Table,5902,OnValidateQuantityAfterSetUnitPrice)]
    LOCAL PROCEDURE TAB5902OnValidateQuantityAfterSetUnitPrice@1101103063(VAR ServiceLine@1101103000 : Record 5902);
    VAR
      ServContractPriceL@1101103001 : Record 50012;
    BEGIN
      //hhe 03.11.04 ->
      IF ServiceLine.Type = ServiceLine.Type::Resource THEN BEGIN
        IF ServContractPriceL.GET(ServiceLine."Contract No.", ServContractPriceL.Type::Resource, ServiceLine."No.", '') THEN
          ServiceLine."Unit Price" := ServContractPriceL."Unit Price";
      END;
      //hhe 03.11.04<-
    END;

    [EventSubscriber(Table,5902,CopyServiceLinetoServItem)]
    PROCEDURE TAB5902CopyServiceLinetoServItem@1101103064(VAR ServiceLineP@1101103002 : Record 5902;VAR ServiceLine2P@1101103003 : Record 5902);
    VAR
      ServiceItemLineL@1101103004 : Record 5901;
      ServiceLineL@1101103005 : Record 5902;
      NoOfServItemsL@1101103000 : Integer;
      NextLineL@1101103001 : Integer;
    BEGIN
      //03. BVM--->
      ServiceLineP.TESTFIELD("No.");
      ServiceLineP.TESTFIELD("Service Item Line No.");
      ServiceLineP.TESTFIELD("Quantity Shipped", 0);

      ServiceItemLineL.RESET;
      ServiceItemLineL.SETRANGE("Document Type", ServiceLineP."Document Type");
      ServiceItemLineL.SETRANGE("Document No.", ServiceLineP."Document No.");
      NoOfServItemsL := ServiceItemLineL.COUNT;
      IF NoOfServItemsL <= 1 THEN
        ERROR(C_Text24);

      IF CONFIRM(C_Text21) THEN BEGIN
        ServiceLineL.RESET;
        ServiceLineL.SETRANGE("Document Type", ServiceLineP."Document Type");
        ServiceLineL.SETRANGE("Document No.", ServiceLineP."Document No.");
        IF ServiceLineL.FINDLAST THEN
          NextLineL := ServiceLineL."Line No." + 10000
        ELSE
          NextLineL := 10000;
        IF ServiceItemLineL.FINDFIRST THEN
          REPEAT
            IF ServiceItemLineL."Line No." <> ServiceLine2P."Service Item Line No." THEN BEGIN
              ServiceLineL.VALIDATE("Document Type", ServiceLine2P."Document Type");
              ServiceLineL.VALIDATE("Document No.", ServiceLine2P."Document No.");
              ServiceLineL."Line No." := NextLineL;
              ServiceLineL.INSERT(TRUE);
              ServiceLineL.VALIDATE("Service Item Line No.", ServiceItemLineL."Line No.");
              ServiceLineL.VALIDATE(Type, ServiceLine2P.Type);
              ServiceLineL.VALIDATE("No.", ServiceLine2P."No.");
              ServiceLineL.VALIDATE("Unit Price", ServiceLine2P."Unit Price");
              ServiceLineL.VALIDATE("Unit of Measure Code", ServiceLine2P."Unit of Measure Code");
              ServiceLineL.VALIDATE("Location Code", ServiceLine2P."Location Code");
              ServiceLineL.VALIDATE(Quantity, ServiceLine2P.Quantity);
              ServiceLineL.VALIDATE("Line Discount %", ServiceLine2P."Line Discount %");
              ServiceLineL.MODIFY(TRUE);
              NextLineL := NextLineL + 10000;
            END;
          UNTIL ServiceItemLineL.NEXT = 0;
      END;
      //03. BVM---<
    END;

    [EventSubscriber(Table,5906,LookupSerialNo)]
    PROCEDURE TAB5906LookupSerialNo@1101103065(VAR ServiceCommentLineP@1101103000 : Record 5906);
    VAR
      ServiceItemLineL@1101103001 : Record 5901;
    BEGIN
      ServiceItemLineL.RESET;
      ServiceItemLineL.SETRANGE("Document No.", ServiceCommentLineP."No.");
      ServiceItemLineL."Serial No." := ServiceCommentLineP."Serial No.";
      IF PAGE.RUNMODAL(0, ServiceItemLineL) = ACTION::LookupOK THEN
        ServiceCommentLineP.VALIDATE("Serial No.", ServiceItemLineL."Serial No.")
      ELSE
        EXIT;
    END;

    [EventSubscriber(Table,5911,OnAfterValidateEvent,"Qty SO In Incade License")]
    LOCAL PROCEDURE TAB5911OnAfterValidateEventQtySOInIncLicence@1101103066(VAR Rec@1101103000 : Record 5911;VAR xRec@1101103001 : Record 5911;CurrFieldNo@1101103002 : Integer);
    BEGIN
      //02.-->
      IF Rec."Qty SO In Incade License" > xRec."Qty SO In Incade License" THEN BEGIN
        Rec."Date Qty In License Changed":= TODAY;
        Rec."Qty In License Changed By":= USERID;
        Rec.MODIFY;
      END ELSE
        MESSAGE(C_Text25, xRec."Qty SO In Incade License" );
      //02.--<
    END;

    [EventSubscriber(Table,5940,OnAfterInsertEvent)]
    LOCAL PROCEDURE TAB5940OnAfterInsertEvent@1101103067(VAR Rec@1101103000 : Record 5940;RunTrigger@1101103001 : Boolean);
    BEGIN
      Rec.Status:= Rec.Status::Delivered;//03. BVM
    END;

    [EventSubscriber(Table,5940,OnAfterValidateEvent,"No.")]
    LOCAL PROCEDURE TAB5940OnAfterValidateEventNo@1101103068(VAR Rec@1101103000 : Record 5940;VAR xRec@1101103001 : Record 5940;CurrFieldNo@1101103002 : Integer);
    BEGIN
      Rec.Status:= Rec.Status::Delivered;//03. BVM
    END;

    [EventSubscriber(Table,5940,OnAfterValidateEvent,Status)]
    LOCAL PROCEDURE TAB5940OnAfterValidateEventStatus@1101103069(VAR Rec@1101103000 : Record 5940;VAR xRec@1101103001 : Record 5940;CurrFieldNo@1101103002 : Integer);
    BEGIN
      // 05. tester om serv vare gruppe er utfylt
      IF (Rec.Status <> xRec.Status) AND (Rec.Status = Rec.Status::Installed) THEN
        Rec.TESTFIELD("Service Item Group Code");
      //05.--<
    END;

    [EventSubscriber(Table,5940,OnAfterValidateEvent,"Service Item Group Code")]
    LOCAL PROCEDURE TAB5940OnAfterValidateEventServiceItemGroupCode@1101103074(VAR Rec@1101103000 : Record 5940;VAR xRec@1101103001 : Record 5940;CurrFieldNo@1101103002 : Integer);
    BEGIN
      //hhe 25.10.04->
      IF CONFIRM(C_INC_CopyFromServItemGroup) THEN BEGIN
        //MODIFY;
        ServiceMgtIncG.CopyServCompFromServItemGroup(Rec."No.");
      END;
      //CODEUNIT.RUN(CODEUNIT::Codeunit50003, ServiceItemL);
      //hhe 25.10.04<-
    END;

    [EventSubscriber(Table,5940,OnValidateShipToCodeBeforeServLogMgt)]
    LOCAL PROCEDURE TAB5940OnValidateShipToCodeBeforeServLogMgt@1101103072(VAR ServiceItemP@1101103000 : Record 5940);
    VAR
      ShiptoAddressL@1101103001 : Record 222;
    BEGIN
      // 03-->
      IF ShiptoAddressL.GET(ServiceItemP."Customer No.", ServiceItemP."Ship-to Code") THEN BEGIN
        ServiceItemP."Ship-to Name":=  ShiptoAddressL.Name;
        ServiceItemP."Ship-to Address":= ShiptoAddressL.Address;
        ServiceItemP."Ship-to Address 2" := ShiptoAddressL."Address 2" ;
        ServiceItemP."Ship-to Post Code":= ShiptoAddressL."Post Code";
        ServiceItemP."Ship-to City":= ShiptoAddressL.City;
        ServiceItemP."Ship-to Contact" := ShiptoAddressL.Contact;
        ServiceItemP."Ship-to Phone No.":=ShiptoAddressL."Phone No.";
        ServiceItemP."Ship-to County":= ShiptoAddressL.County ;
        ServiceItemP."Ship-to Country/Region Code":= ShiptoAddressL."Country/Region Code";
        ServiceItemP."Ship-to Name 2":= ShiptoAddressL."Name 2";
      END;
      //03-<
    END;

    [EventSubscriber(Table,5940,OnAfterValidateEvent,"Warranty (Hours Used)")]
    LOCAL PROCEDURE TAB5940OnAfterValidateEventWarrantyHoursUsed@1101103073(VAR Rec@1101103000 : Record 5940;VAR xRec@1101103001 : Record 5940;CurrFieldNo@1101103002 : Integer);
    VAR
      ServLogManagementL@1101103003 : Codeunit 5906;
    BEGIN
      //04.->
      ServLogManagementL.ServItemWarrentyUsedHours(Rec, xRec);
      //04.-<
    END;

    [EventSubscriber(Table,5940,OnAfterValidateEvent,"Qty. Hours Used")]
    LOCAL PROCEDURE TAB5940OnAfterValidateEventQtyHoursUsed@1101103075(VAR Rec@1101103000 : Record 5940;VAR xRec@1101103001 : Record 5940;CurrFieldNo@1101103002 : Integer);
    VAR
      ServLogManagementL@1101103003 : Codeunit 5906;
    BEGIN
      //04.-->
      IF Rec."Qty. Hours Used" < xRec."Qty. Hours Used" THEN
        IF NOT DIALOG.CONFIRM(C_Text26, FALSE, Rec."Qty. Hours Used", xRec."Qty. Hours Used" ) THEN
          ERROR('');
      ServLogManagementL.ServItemUsedHoursChangeCard(Rec, xRec);
      Rec.VALIDATE(Rec."Date Last Registered", TODAY);
      //04.
    END;

    [EventSubscriber(Table,5940,OnAfterValidateEvent,"Date Last Registered")]
    LOCAL PROCEDURE TAB5940OnAfterValidateEventDateLastRegistered@1101103077(VAR Rec@1101103000 : Record 5940;VAR xRec@1101103001 : Record 5940;CurrFieldNo@1101103002 : Integer);
    VAR
      ServiceItemLogL@1101103003 : Record 5942;
    BEGIN
      //04.  Oppdaterer dato avlest p¹ log
      IF Rec."Date Last Registered" <> xRec."Date Last Registered" THEN BEGIN
        ServiceItemLogL.RESET;
        ServiceItemLogL.SETRANGE("Event No.", 19);
        ServiceItemLogL.SETFILTER(After, FORMAT(Rec."Qty. Hours Used"));
        ServiceItemLogL.SETRANGE("Log Type", ServiceItemLogL."Log Type"::"Hours used");
        IF ServiceItemLogL.FINDFIRST THEN BEGIN
            ServiceItemLogL."Hours Used Registered Date" := Rec."Date Last Registered";
            ServiceItemLogL.MODIFY;
        END ELSE
            MESSAGE(C_Text20);
      END;
      //04.--<
    END;

    [EventSubscriber(Table,5950,OnAfterDeleteEvent)]
    LOCAL PROCEDURE TAB5950OnAfterDeleteEvent@1101103083(VAR Rec@1101103000 : Record 5950;RunTrigger@1101103001 : Boolean);
    BEGIN
      IF RunTrigger THEN
        ServiceMgtIncG.SetDateServHeaderDelete(Rec);
    END;

    [EventSubscriber(Table,5950,OnAfterValidateEvent,"Allocation Date")]
    LOCAL PROCEDURE TAB5950OnAfterValidateEventAllocationDate@1101103071(VAR Rec@1101103000 : Record 5950;VAR xRec@1101103001 : Record 5950;CurrFieldNo@1101103002 : Integer);
    VAR
      NewEndingDateL@1101103003 : Date;
      CalcDateL@1101103004 : Text[30];
    BEGIN
      //01..>
      IF Rec."Allocated Days" <> 0 THEN BEGIN
        CalcDateL := FORMAT(Rec."Allocated Days") + 'D';
        NewEndingDateL:= CALCDATE(CalcDateL, Rec."Allocation Date");
        Rec.VALIDATE("Finishing Date", NewEndingDateL);
      END;
      //01..<
      ServiceMgtIncG.SetDateServHeader(Rec); //MNO
    END;

    [EventSubscriber(Table,5950,OnAfterValidateEvent,"Resource No.")]
    LOCAL PROCEDURE TAB5950OnAfterValidateEventResourceNo@1101103084(VAR Rec@1101103000 : Record 5950;VAR xRec@1101103001 : Record 5950;CurrFieldNo@1101103002 : Integer);
    VAR
      ServiceHeaderL@1101103005 : Record 5900;
      RepairStatusL@1101103003 : Record 5927;
      ServiceItemLineL@1101103004 : Record 5901;
    BEGIN
      //01..->
      //Setter inn lokasjonskode
      IF ServiceHeaderL.GET(Rec."Document Type"::Order, Rec."Document No.") THEN
        Rec.VALIDATE("Location Code", ServiceHeaderL."Location Code");
      Rec.VALIDATE(Status, Rec.Status::Active);
      //Oppdaterer servItemLines med status I gang n†r 1. ressurs tildelse
      RepairStatusL.RESET;
      RepairStatusL.SETRANGE("In Process", TRUE);
      IF RepairStatusL.FINDFIRST THEN BEGIN
        ServiceItemLineL.SETRANGE("Document Type", ServiceItemLineL."Document Type"::Order);
        ServiceItemLineL.SETRANGE("Document No.", Rec."Document No.");
        ServiceItemLineL.SETFILTER("Repair Status Code", '<>%1', RepairStatusL.Code);
        IF ServiceItemLineL.FINDFIRST THEN BEGIN
        REPEAT
          ServiceItemLineL.VALIDATE("Repair Status Code", RepairStatusL.Code);
          ServiceItemLineL.MODIFY;
        UNTIL ServiceItemLineL.NEXT = 0;
        END;
      END;
      //01..<-
    END;

    [EventSubscriber(Table,5950,OnAfterValidateEvent,"Allocated Days")]
    LOCAL PROCEDURE TAB5950OnAfterValidateEventAllocatedDays@1101103085(VAR Rec@1101103000 : Record 5950;VAR xRec@1101103001 : Record 5950;CurrFieldNo@1101103002 : Integer);
    VAR
      AllocDateL@1101103003 : Text[30];
    BEGIN
      //01.-->
      IF (Rec."Allocation Date" <> 0D) THEN BEGIN
        AllocDateL := FORMAT(Rec."Allocated Days") + 'D';
        Rec.VALIDATE("Finishing Date", CALCDATE(AllocDateL, (Rec."Allocation Date" -1)));
      END;
      ServiceMgtIncG.SetDateServHeader(Rec);  //MNO
      //01.--<
    END;

    [EventSubscriber(Table,5950,OnAfterValidateEvent,"Finishing Date")]
    LOCAL PROCEDURE TAB5950OnAfterValidateEventFinishingDate@1101103087(VAR Rec@1101103000 : Record 5950;VAR xRec@1101103001 : Record 5950;CurrFieldNo@1101103002 : Integer);
    VAR
      AllocDateL@1101103003 : Text[30];
    BEGIN
      //01.  -->
      IF Rec."Allocation Date" = 0D THEN
        ERROR(C_Text27);

      IF (Rec."Allocation Date" = 0D) AND (Rec."Finishing Date" = 0D) AND (Rec."Allocation Date" > Rec."Finishing Date")  THEN
        ERROR(C_Text28, Rec."Allocation Date", Rec."Finishing Date");

      IF (Rec."Allocation Date" <> 0D) AND (Rec."Finishing Date" <> 0D) THEN BEGIN
        Rec."Allocated Days" := (Rec."Finishing Date" - Rec."Allocation Date") + 1;
      END;
      //01.  --<
      ServiceMgtIncG.SetDateServHeader(Rec);//MNO
    END;

    [EventSubscriber(Table,7002,OnAfterValidateEvent,"Item No.")]
    LOCAL PROCEDURE TAB7002OnAfterValidateEventItemNo@1101103086(VAR Rec@1101103000 : Record 7002;VAR xRec@1101103001 : Record 7002;CurrFieldNo@1101103002 : Integer);
    VAR
      ItemL@1101103003 : Record 27;
    BEGIN
      //hhe 07.11.06->
      IF ItemL.GET(Rec."Item No.") THEN BEGIN //erstatter foreg¹ende
        Rec."Item Category Code" := ItemL."Item Category Code";  //ny
        Rec."Product Group Code" := ItemL."Product Group Code";
      END;
      //hhe 07.11.06<-
    END;

    [EventSubscriber(Table,99000764,OnAfterValidateEvent,"Alternative priority")]
    LOCAL PROCEDURE TAB99000764OnAfterValidateEventAlternativePriority@1101103089(VAR Rec@1101103000 : Record 99000764;VAR xRec@1101103001 : Record 99000764;CurrFieldNo@1101103002 : Integer);
    BEGIN
      Rec.TESTFIELD(Type, Rec.Type::"Machine Center");
    END;

    [EventSubscriber(Table,99000771,OnAfterValidateEvent,"No.")]
    LOCAL PROCEDURE TAB99000771OnAfterValidateEventNo@1101103090(VAR Rec@1101103000 : Record 99000771;VAR xRec@1101103001 : Record 99000771;CurrFieldNo@1101103002 : Integer);
    VAR
      ItemL@1101103003 : Record 27;
    BEGIN
      //hhe 27.09.04->
      IF Rec.Status <> Rec.Status::Certified THEN
        IF ItemL.GET(Rec."No.") THEN BEGIN
          Rec.VALIDATE(Description, ItemL.Description);
          Rec.VALIDATE("Description 2", ItemL."Description 2");
        END;
      //hhe 27.09.04<-
    END;

    [EventSubscriber(Table,99000772,OnAfterValidateEvent,"No.")]
    LOCAL PROCEDURE TAB99000772OnAfterValidateEventNo@1101103091(VAR Rec@1101103000 : Record 99000772;VAR xRec@1101103001 : Record 99000772;CurrFieldNo@1101103002 : Integer);
    VAR
      ItemL@1101103003 : Record 27;
    BEGIN
      CASE Rec.Type OF
        Rec.Type::Item:
          BEGIN
            ItemL.GET(Rec."No.");
            Rec."Description 2" := ItemL."Description 2"; // SID ASL 10.11.03
          END;
      END;
    END;

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 08.02.17 JAL Tables Event Subcriber functions
    }
    END.
  }
}

OBJECT Codeunit 50015 OAS Mgt.
{
  OBJECT-PROPERTIES
  {
    Date=10.11.17;
    Time=09:59:54;
    Modified=Yes;
    Version List=INC1.02,OPC6.01,SER2.01;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      C_INC_NoAccess@1101103001 : TextConst 'ENU=You don''t have permission.;NOR=Du har ikke tillatelser til dette.';
      SalesDocTypeG@1101103000 : 'Quote,Blanket Order,Order,Invoice,Return Order,Credit Memo,Posted Shipment,Posted Invoice,Posted Return Receipt,Posted Credit Memo';

    PROCEDURE GetCust@2(CustNoP@1000 : Code[20];VAR CustomerP@1101103001 : Record 18);
    BEGIN
      IF CustNoP <> '' THEN
        CustomerP.GET(CustNoP);
    END;

    PROCEDURE GetSalesHeader@1(VAR SalesLineP@1101103000 : Record 37;VAR SalesHeaderP@1101103001 : Record 36);
    BEGIN
      SalesLineP.TESTFIELD("Document No.");
      IF (SalesLineP."Document Type" <> SalesHeaderP."Document Type") OR (SalesLineP."Document No." <> SalesHeaderP."No.") THEN BEGIN
        SalesHeaderP.GET(SalesLineP."Document Type", SalesLineP."Document No.");
      END;
    END;

    PROCEDURE GetVend@1101103019(VendNoP@1000 : Code[20];VAR VendorP@1101103000 : Record 23);
    BEGIN
      VendorP.GET(VendNoP);
    END;

    PROCEDURE GetItem@4(NoP@1101103000 : Code[20];VAR ItemP@1101103001 : Record 27);
    BEGIN
      ItemP.GET(NoP);
    END;

    PROCEDURE CalculateInventory@1101103092(NoP@1101103000 : Code[20];LocationP@1101103001 : Code[20]) : Decimal;
    VAR
      Vare@1000000000 : Record 27;
    BEGIN
      IF Vare.GET(NoP) THEN BEGIN
        Vare.SETRANGE("Location Filter", LocationP);
        Vare.CALCFIELDS(Inventory);
        EXIT(Vare.Inventory);
      END ELSE
        EXIT(0);
    END;

    PROCEDURE HasUserResourceAdminRole@1101103000(ShowErrorMessageP@1101103003 : Boolean) : Boolean;
    VAR
      ResourcesSetupL@1101103001 : Record 314;
      IsResourceAdminL@1101103002 : Boolean;
    BEGIN
      //20.01.05.->
      ResourcesSetupL.GET;
      IsResourceAdminL := CheckUserIDRole(ShowErrorMessageP, ResourcesSetupL."Role for Ress. Admin");
      EXIT(IsResourceAdminL);
      //20.01.05.<-
    END;

    PROCEDURE HasUserInventoryAdminRole@1101103001(ShowErrorMessageP@1101103003 : Boolean) : Boolean;
    VAR
      InventorySetupL@1101103001 : Record 313;
      AccessControlL@1101103000 : Record 2000000053;
      IsUserInventoryAdminL@1101103002 : Boolean;
    BEGIN
      //20.01.05.->
      InventorySetupL.GET;
      IsUserInventoryAdminL := CheckUserIDRole(ShowErrorMessageP, InventorySetupL."Role for Inv. Admin");
      EXIT(IsUserInventoryAdminL);
      //20.01.05.<-
    END;

    PROCEDURE HasUserPurchaseAdminRole@1101103002(ShowErrorMessageP@1101103003 : Boolean) : Boolean;
    VAR
      PurchasesPayablesSetupL@1101103001 : Record 312;
      IsUserPurchaseAdminL@1101103000 : Boolean;
    BEGIN
      //20.01.05.->
      PurchasesPayablesSetupL.GET;
      IsUserPurchaseAdminL := CheckUserIDRole(ShowErrorMessageP, PurchasesPayablesSetupL."Role for Purch Admin");
      EXIT(IsUserPurchaseAdminL);
      //20.01.05.<-
    END;

    PROCEDURE HasUserkGenLedgAdminRole@1101103089() : Boolean;
    VAR
      GeneralLedgerSetupL@1101103001 : Record 98;
      IsUserGLAdminL@1101103000 : Boolean;
    BEGIN
      //JTA 03.05.2017 >> (User ID,Role ID,Company)
      GeneralLedgerSetupL.GET;
      IsUserGLAdminL := CheckUserIDRole(TRUE, GeneralLedgerSetupL."Role for G/L Management");
      EXIT(IsUserGLAdminL);
      //JTA 03.05.2017 <<
    END;

    PROCEDURE HasUserSalesAdminRole@1101103003(ShowErrorMessageP@1101103003 : Boolean) : Boolean;
    VAR
      SalesReceivablesSetupL@1101103001 : Record 311;
      IsUserPurchaseAdminL@1101103000 : Boolean;
    BEGIN
      //20.01.05.->
      SalesReceivablesSetupL.GET;
      IsUserPurchaseAdminL := CheckUserIDRole(ShowErrorMessageP, SalesReceivablesSetupL."Role for Sales Admin");
      EXIT(IsUserPurchaseAdminL);
      //20.01.05.<-
    END;

    PROCEDURE CheckUserIDRole@1101103004(ShowErrorMessageP@1101103003 : Boolean;RoleIDP@1101103004 : Code[20]) : Boolean;
    VAR
      AccessControlL@1101103000 : Record 2000000053;
      HasRoleL@1101103002 : Boolean;
    BEGIN
      AccessControlL.RESET;
      AccessControlL.SETRANGE("User Name", USERID);
      AccessControlL.SETRANGE("Role ID", RoleIDP);
      HasRoleL := (AccessControlL.COUNT > 0);
      IF ShowErrorMessageP AND (NOT HasRoleL) THEN
        ERROR(C_INC_NoAccess);
      EXIT(HasRoleL);
      //20.01.05.<-
    END;

    PROCEDURE InitAndCheckSalesDocuments@143(FromDocTypeP@1001 : Option;FromDocNoP@1003 : Code[20];VAR ToSalesHeaderP@1002 : Record 36) : Boolean;
    VAR
      FromSalesInvoiceHeaderL@1101103001 : Record 112;
      FromSalesCrMemoHeaderL@1101103000 : Record 114;
      FromSalesHeaderL@1101103002 : Record 36;
    BEGIN
      //FromDocType : Option;FromDocNo : Code[20];VAR FromSalesHeader : Record "Sales Header";VAR ToSalesHeader : Record "Sales Header";VAR FromSalesShipmentHeader : Record "Sales Shipment Header";VAR FromSalesInvoiceHeader : Record "Sales Invoice Header
      WITH ToSalesHeaderP DO
        CASE FromDocTypeP OF
          SalesDocTypeG::Quote,
          SalesDocTypeG::"Blanket Order",
          SalesDocTypeG::Order,
          SalesDocTypeG::Invoice,
          SalesDocTypeG::"Return Order",
          SalesDocTypeG::"Credit Memo":
            BEGIN
              FromSalesInvoiceHeaderL.GET(SalesHeaderDocType(FromDocTypeP),FromDocNoP);
              ToSalesHeaderP.VALIDATE("Order Class", FromSalesInvoiceHeaderL."Order Class");
            END;
      //    SalesDocTypeG::"Posted Shipment":
      //      BEGIN
      //        ToalesShipmentHeader.GET(FromDocNo);
      //      END;
          SalesDocTypeG::"Posted Invoice":
            BEGIN
              FromSalesInvoiceHeaderL.GET(FromDocNoP);
              ToSalesHeaderP.VALIDATE("Order Class", FromSalesInvoiceHeaderL."Order Class");
            END;
      //    SalesDocTypeG::"Posted Return Receipt":
      //      BEGIN
      //        ToReturnReceiptHeader.GET(FromDocNo);
      //      END;
          SalesDocTypeG::"Posted Credit Memo":
            BEGIN
              FromSalesCrMemoHeaderL.GET(FromDocNoP);
              ToSalesHeaderP.VALIDATE("Order Class", FromSalesCrMemoHeaderL."Order class");
            END;
        END;
      EXIT(TRUE);
    END;

    PROCEDURE SalesHeaderDocType@1101103005(DocType@1001 : Option) : Integer;
    VAR
      SalesHeader@1000 : Record 36;
    BEGIN
      CASE DocType OF
        SalesDocTypeG::Quote:
          EXIT(SalesHeader."Document Type"::Quote);
        SalesDocTypeG::"Blanket Order":
          EXIT(SalesHeader."Document Type"::"Blanket Order");
        SalesDocTypeG::Order:
          EXIT(SalesHeader."Document Type"::Order);
        SalesDocTypeG::Invoice:
          EXIT(SalesHeader."Document Type"::Invoice);
        SalesDocTypeG::"Return Order":
          EXIT(SalesHeader."Document Type"::"Return Order");
        SalesDocTypeG::"Credit Memo":
          EXIT(SalesHeader."Document Type"::"Credit Memo");
      END;
    END;

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 08.02.17 JAL CodeUnits Event Subcriber functions
      02. 09.11.17 GST Text p† Global Text "C_INC_NoAccess" gjort mer generell.
    }
    END.
  }
}

OBJECT Codeunit 83001 Clocking Mgt
{
  OBJECT-PROPERTIES
  {
    Date=11.10.17;
    Time=17:33:43;
    Modified=Yes;
    Version List=OPC6.16;
  }
  PROPERTIES
  {
    TableNo=99000758;
    OnRun=BEGIN
            DeleteEmptyTimeRegister(Rec."No.");
            RegisterTimeInOut(Rec."No.", WORKDATE, TIME);
          END;

  }
  CODE
  {
    VAR
      C_INC_UserNotRegisteredIn@1101103000 : TextConst 'ENU=The resource %1 must be registered inn before you can register time on task.;NOR=Ressursen %1 m† v‘re m›nstret inn f›r du kan kan registrere tid p† en oppgave.';
      C_INC_LoggedOfTask@1101103001 : TextConst 'ENU=You are now logged out of Prodution Order %1 Operation %2.;NOR=Du blir n† logget ut av prod.ordre %1 operasjon %2.';
      C_INC_LoggedOfIndirectTask@1101103002 : TextConst 'ENU=You are now logged out of indirect task %1.;NOR=Du blir n† logget ut av indirekte oppgaven %1.';
      C_INC_MissingFinishedLine@1101103003 : TextConst 'ENU=No output was posted. There is no line to Finish Now.;NOR=Ikke noe ble ferdigmeldt. Det finnes ingen linje til † Avslutte.';

    PROCEDURE RegisterTimeInOut@1000000000(MachineCenterP@1000000002 : Code[20];RegisterDateP@1000000000 : Date;RegisterTimeP@1000000001 : Time);
    VAR
      TimeRegisterL@1000000003 : Record 83007;
      RunTimesL@1101103000 : Record 83010;
      ClockingRunTimesMgtL@1101103003 : Codeunit 83002;
      ClockingDeductionL@1101103002 : Codeunit 83006;
      StartTimeInL@1101103001 : Time;
    BEGIN
      SetTimeRegisterFilterWithoutEndTime(TimeRegisterL, MachineCenterP);
      IF TimeRegisterL.FINDFIRST THEN
        BEGIN
          //hhe 18.03.10 Tar vare p† starttid for funnet m›nstringspost -> brukes i Deduct
          StartTimeInL := TimeRegisterL."Start Time";
          ClockingRunTimesMgtL.SetRunTimesFilterUnpostedWithStartTime(RunTimesL, MachineCenterP);
          ClockingRunTimesMgtL.AutoPostUnfinishedRunTimes(RunTimesL, RegisterDateP, RegisterTimeP);
          REPEAT
            IF TimeRegisterL."Start Date" < RegisterDateP THEN
              BEGIN
                ModifyTimeRegister(TimeRegisterL);
                InsertTimeRegisterFromMachineCenter(TimeRegisterL, MachineCenterP);
              END ELSE
              BEGIN
                ClockOut(TimeRegisterL, RegisterDateP, RegisterTimeP);
                //hhe 18.03.10 denne vil gi fradrag for Lunch (ikke bare for Prod og Admin, slik det var f›r)
                ClockingDeductionL.DeductLunch(MachineCenterP, RegisterDateP, StartTimeInL, RegisterTimeP);
              END;
          UNTIL TimeRegisterL.NEXT = 0;
      END ELSE
        ClockIn(MachineCenterP, RegisterDateP, RegisterTimeP);
    END;

    PROCEDURE RegisterTimeOnTask@1101103000(VAR RunTimesP@1101103000 : Record 83010;StartDateP@1101103001 : Date;StartTimeP@1101103002 : Time;EndDateP@1101103003 : Date;EndTimeP@1101103004 : Time;VAR OutPutQtyP@1101103013 : Decimal;VAR ScrapQtyP@1101103012 : Decimal;VAR ScrapCodeP@1101103011 : Code[20];VAR ScrapQty2P@1101103010 : Decimal;VAR ScrapCode2P@1101103009 : Code[20];VAR ScrapQty3P@1101103018 : Decimal;VAR ScrapCode3P@1101103017 : Code[20];VAR ScrapCommentP@1101103016 : Text[50];VAR ScrapComment2P@1101103015 : Text[50];VAR ScrapComment3P@1101103014 : Text[50]);
    VAR
      RunTimesL@1101103007 : Record 83010;
      ClockingRunTimesMgtL@1101103021 : Codeunit 83002;
      ClockingPostOutputL@1101103020 : Codeunit 83004;
    BEGIN
      //hhe 16.06.06->  Sletter blanke linjer f›r bokf›ring for † unng† feilmelding
      ClockingRunTimesMgtL.DeleteRunTimesWithoutMachineCenter();
      //hhe 16.06.06<-
      // Setter inn startdato og starttid
      ClockingRunTimesMgtL.SetRunTimesProdFilter(RunTimesP, RunTimesL);
      ClockingRunTimesMgtL.SetRunTimesStart(RunTimesP, RunTimesL, StartDateP, StartTimeP);
      //20.09.17 JAL Deleted the table SetTimeRegistrationWorkStausToDirectProduction(RunTimesP);
      // Setter inn sluttdato og sluttid
      ClockingRunTimesMgtL.SetRunTimesProdFilter(RunTimesP, RunTimesL);
      RunTimesL.SETRANGE("Finish Now", TRUE); //Filter on lines that shall get end time and post capacity through journal
      IF RunTimesL.FINDSET THEN
        BEGIN
          ClockingRunTimesMgtL.SetRunTimesEnd(RunTimesL, EndDateP, EndTimeP);
          //20.09.17 JAL Deleted the table SetTimeRegistrationWorkStausToRegistered(RunTimesP);
          // Post "Run Times" (Bokf›rer tidlinjer)
          ClockingRunTimesMgtL.SetRunTimesProdTimeFilter(RunTimesP, RunTimesL);
          ClockingPostOutputL.PostOutputCapacity(RunTimesL,OutPutQtyP,ScrapQtyP,ScrapCodeP,
                                                ScrapQty2P,ScrapCode2P,ScrapQty3P,ScrapCode3P,
                                                ScrapCommentP,ScrapComment2P,ScrapComment3P);
          OutPutQtyP := 0;
          ScrapQtyP := 0;
          ScrapCodeP := '';
          ScrapQty2P := 0;
          ScrapCode2P := '';
          ScrapCommentP := '';
          ScrapComment2P := '';
          ScrapComment3P := '';
          ScrapQty3P := 0;
          ScrapCode3P := '';
        END ELSE
        BEGIN
          IF (OutPutQtyP <> 0) OR (ScrapQtyP <> 0) OR (ScrapQty2P <> 0) OR (ScrapQty3P <> 0) THEN
            MESSAGE(C_INC_MissingFinishedLine);
        END;
    END;

    PROCEDURE RegisterTimeOnTaskFromRoutingLine@1101103007(VAR ProdOrderRoutingLineP@1101103000 : Record 5409);
    VAR
      OPCSetupL@1101103005 : Record 83001;
      OPCRunTimesL@1101103001 : Record 83010;
      ClockingRunTimesMgtL@1101103002 : Codeunit 83002;
      OPCMachCenteronOperationL@1101103004 : Page 83008;
    BEGIN
      //sjekker om maskinen allerede er innlogget p† operasjonen->
      OPCSetupL.GET();
      ClockingRunTimesMgtL.SetRunTimesFilterFromPORouteUnpostedWithStartTime(OPCRunTimesL, ProdOrderRoutingLineP);
      IF OPCSetupL."Auto Insert Machine Center" AND (NOT OPCRunTimesL.FINDFIRST) THEN BEGIN
        //Set value for Machine Center it does not exists.
        ClockingRunTimesMgtL.InsertRunTimesFromPORouting(OPCRunTimesL, ProdOrderRoutingLineP);
        COMMIT;
      END;
      ClockingRunTimesMgtL.SetRunTimesFilterFromPORouteUnpostedWithStartTime(OPCRunTimesL, ProdOrderRoutingLineP);
      OPCRunTimesL.SETRANGE("Machine Center"); //Empty the filter to be able to register other machine center (Ansatte)
      OPCMachCenteronOperationL.InitForm(ProdOrderRoutingLineP."No.", '');
      OPCMachCenteronOperationL.SETTABLEVIEW(OPCRunTimesL);
      OPCMachCenteronOperationL.RUNMODAL;
    END;

    PROCEDURE OpenRegisterTimeOnIndirectTime@1101103015(MachineCenterNoP@1101103002 : Code[20];IndirectTimeCodeP@1101103003 : Code[15]);
    VAR
      OPCRunTimesL@1101103000 : Record 83010;
      OPCMachCenterOnOperationL@1101103001 : Page 83008;
      ClockingRunTimesMgtL@1101103004 : Codeunit 83002;
    BEGIN
      // 001 START
      ClockingRunTimesMgtL.SetRunTimesIndirectTimeFilter(OPCRunTimesL);
      //hhe 03.04.06 OperasjonsTider.SETRANGE("Work done at M.C.","Machine Center");
      OPCMachCenterOnOperationL.InitForm(MachineCenterNoP, IndirectTimeCodeP);
      OPCMachCenterOnOperationL.SETTABLEVIEW(OPCRunTimesL);
      OPCMachCenterOnOperationL.RUN;
      // 001 STOP
    END;

    LOCAL PROCEDURE ClockIn@1000000001(MachineCenterP@1000000002 : Code[20];RegisterDateP@1000000001 : Date;RegisterTimeP@1000000000 : Time);
    VAR
      TimeRegisterL@1000000003 : Record 83007;
      WorkCenterL@1080000 : Record 99000754;
      MachineCenterL@1080001 : Record 99000758;
    BEGIN
      WITH TimeRegisterL DO BEGIN
        INIT;
        "Machine Center" := MachineCenterP;
        "Actual Start Time" := RegisterTimeP;
        IF MachineCenterL.GET(MachineCenterP) THEN
          IF WorkCenterL.GET(MachineCenterL."Work Center No.") THEN
            IF (WorkCenterL."Earliest Time Reg. Start Time" <> 0T) AND (RegisterTimeP < WorkCenterL."Earliest Time Reg. Start Time") THEN
              "Start Time" := WorkCenterL."Earliest Time Reg. Start Time"
            ELSE
              "Start Time" := RegisterTimeP;
        "Start Date" := RegisterDateP;
        "End Date" := 0D;
        "End Time" := 0T;
        INSERT(TRUE);
      END;
    END;

    LOCAL PROCEDURE ClockOut@1000000002(VAR TimeRegister@1000000002 : Record 83007;RegisterDate@1000000001 : Date;RegisterTime@1000000000 : Time);
    BEGIN
      WITH TimeRegister DO BEGIN
        "End Date" := RegisterDate;
        "End Time" := RegisterTime;
        CalcQty;
        MODIFY(TRUE);
        // Find Overtime
        //hhe 12.03.10 - deaktivert: Overtime.ClockOvertime(TimeRegister);
        // Find unfinished run times
        //21.09.17 JAL Double run? ClockingPostOutputL.RUN(TimeRegister);
      END;
    END;

    PROCEDURE DeleteEmptyTimeRegister@1080003(MachineCenter@1080000 : Code[20]);
    VAR
      TimeRegisterL@1080001 : Record 83007;
    BEGIN
      TimeRegisterL.RESET;
      TimeRegisterL.SETRANGE("Machine Center",MachineCenter);
      TimeRegisterL.SETRANGE("Start Date",0D);
      TimeRegisterL.SETRANGE("Start Time",0T);
      TimeRegisterL.SETRANGE("End Date",0D);
      TimeRegisterL.SETRANGE("End Time",0T);
      IF TimeRegisterL.FINDFIRST THEN
        TimeRegisterL.DELETEALL;
    END;

    PROCEDURE SetTimeRegisterFilterWithoutEndTime@1101103006(VAR TimeRegisterP@1101103000 : Record 83007;MachineCenterP@1101103001 : Code[20]);
    BEGIN
      TimeRegisterP.RESET;
      //TimeRegisterP.SETCURRENTKEY("Machine Center", "End Date","End Time");
      TimeRegisterP.SETRANGE("Machine Center", MachineCenterP);
      TimeRegisterP.SETRANGE("End Date", 0D);
      TimeRegisterP.SETRANGE("End Time", 0T);
    END;

    PROCEDURE GetTimeRegisterFirstLineDeduction@1101103003(VAR OPCTimeRegisterP@1101103000 : Record 83007;MachineCenterP@1101103001 : Code[20];StartDateP@1101103002 : Date) : Boolean;
    BEGIN
      OPCTimeRegisterP.RESET;
      OPCTimeRegisterP.SETRANGE("Machine Center", MachineCenterP);
      OPCTimeRegisterP.SETRANGE("Start Date", StartDateP);
      OPCTimeRegisterP.SETRANGE("Deduction Type", OPCTimeRegisterP."Deduction Type"::Lunch);
      EXIT(OPCTimeRegisterP.FINDFIRST())
    END;

    LOCAL PROCEDURE InsertTimeRegisterFromMachineCenter@1101103009(VAR TimeRegisterP@1101103000 : Record 83007;MachineCenterP@1101103001 : Code[20]);
    BEGIN
      InsertTimeRegister(TimeRegisterP, MachineCenterP, WORKDATE, 000000T, WORKDATE, TIME);
    END;

    PROCEDURE InsertTimeRegisterDeductionLine@1101103004(VAR OPCRunTimesDeductionP@1101103001 : Record 83012;MachineCenterP@1101103002 : Code[20];RegisterDateP@1101103003 : Date);
    VAR
      OPCTimeRegisterL@1101103000 : Record 83007;
    BEGIN
      InsertTimeRegister(OPCTimeRegisterL, MachineCenterP, RegisterDateP, OPCRunTimesDeductionP."To Time", RegisterDateP, OPCRunTimesDeductionP."From Time");
      OPCTimeRegisterL."Deduction Type":= OPCTimeRegisterL."Deduction Type"::Lunch;
      OPCTimeRegisterL.MODIFY(TRUE);
    END;

    LOCAL PROCEDURE InsertTimeRegister@1101103011(VAR TimeRegisterP@1101103000 : Record 83007;MachineCenterP@1101103001 : Code[20];StartDateP@1101103002 : Date;StartTimeP@1101103003 : Time;EndDateP@1101103004 : Date;EndTimeP@1101103005 : Time);
    BEGIN
      TimeRegisterP.INIT;
      TimeRegisterP.VALIDATE("Machine Center", MachineCenterP);
      TimeRegisterP.VALIDATE("Start Date", StartDateP);
      TimeRegisterP.VALIDATE("Start Time", StartTimeP);
      TimeRegisterP.VALIDATE("End Date", EndDateP);
      TimeRegisterP.VALIDATE("End Time", EndTimeP);
      TimeRegisterP.INSERT(TRUE);
    END;

    LOCAL PROCEDURE ModifyTimeRegister@1101103010(VAR TimeRegisterP@1101103000 : Record 83007);
    VAR
      StartDateTimeL@1101103002 : DateTime;
      EndDateTimeL@1101103001 : DateTime;
    BEGIN
      TimeRegisterP.VALIDATE("End Date", WORKDATE - 1);
      TimeRegisterP."End Time" := 235959T;
      StartDateTimeL := CREATEDATETIME(TimeRegisterP."Start Date", TimeRegisterP."Start Time");
      EndDateTimeL := CREATEDATETIME(TimeRegisterP."End Date", TimeRegisterP."End Time");
      TimeRegisterP.Quantity :=((EndDateTimeL - StartDateTimeL) / 3600000);
      TimeRegisterP.MODIFY(TRUE);
    END;

    PROCEDURE OnValidateMachineCenter@1101103001(MachineCenterP@1101103001 : Code[20]);
    VAR
      OPCTimeRegisterL@1101103000 : Record 83007;
    BEGIN
      //hhe 31.01.11->
      SetTimeRegisterFilterWithoutEndTime(OPCTimeRegisterL, MachineCenterP);
      IF NOT OPCTimeRegisterL.FINDFIRST THEN
        ERROR(C_INC_UserNotRegisteredIn, MachineCenterP);
      //hhe 31.01.11<-
    END;

    PROCEDURE OnAfterValidateMachineCenter@1101103002(MachineCenterP@1101103001 : Code[20];EndDateP@1101103003 : Date;EndTimeP@1101103004 : Time);
    VAR
      OPCRunTimesL@1101103000 : Record 83010;
      ClockingRunTimesMgtL@1101103002 : Codeunit 83002;
    BEGIN
      //SID.HHE 091209 ------------>
      ClockingRunTimesMgtL.SetRunTimesFilterUnpostedWithStartTime(OPCRunTimesL, MachineCenterP);
      IF OPCRunTimesL.FINDFIRST THEN BEGIN
        IF OPCRunTimesL."Prod. Order No." <> '' THEN
          MESSAGE(C_INC_LoggedOfTask, OPCRunTimesL."Prod. Order No.", OPCRunTimesL."Operation No.")
        ELSE
          MESSAGE(C_INC_LoggedOfIndirectTask, OPCRunTimesL."Stop Code");
        ClockingRunTimesMgtL.AutoPostUnfinishedRunTimes(OPCRunTimesL, EndDateP, EndTimeP);
      END;
    END;

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 16.06.06 hhe Kode som l›ser problemet med at en person er p†logget den ene dagen, men logger ut p† neste
      02. 20.10.09 hhe Dennne brukes i OPC -> M›nstringskort
      03. 09.12.09 OJO Lagt til funksjon for † ferdigmelde alle p†begynte oppgaver f›r utlogging.
      04. 23.02.10 BVM Funksjoner for fratrekk lunch og middagspauser
      05. 10.03.10 HHE ClockIn:Setter inn "Original Start Time".
                       Dersom det er lagt inn "Tidligste m›nstringstid(inn)" p† Arbeidssenteret -> bruker dette som starttid
      06. 11.03.10 HHE Funksjon: DeleteEmpty ->Sletter blanke linjer p† Prod.ressurs (linje med kun Prod.ress.nr.)
                       Lagt inn INIT p† linjene som skal legge fratrekk for Lunch og Middag
      07. 12.03.10 HHE Ny SETRANGE p† TimeEntry (for † ›ke hastighet p† m›nstre-ut)
                       Ny SETCURRENTKEY p† RunTimes
                       Ny SETCURRENTKEY p† TimeRegister
      08. 12.03.10 HHE Deaktivert "ClockOvertime"
      09. 16.03.10 HHE Flyttet "Utlogging"
                       Aktivert fratrekk av pauser igjen
      10. 17.03.10 HHE Deduct-funksjonene -> Parameters -> fjernet hake p† "Var"
      11. 18.03.10 HHE Lagt inn CLEAR(SumQtyDinner) og CLEAR(SumQty)
      12. 18.03.10 HHE Deaktivert BVM-funksjoner for DeductLunch
                       Ny funksjon HH_DeductLunch som beregner fradrag for Lunch-pause
      13. 17.09.10 HHE Lagt inn en CLEAR(RunTimes) f›r nye filter settes p† RunTimes
      14. 28.07.16 JAL Raskere innstempling p† indirekte tid.
      15. 28.07.16 JAL Cleaning up code. Moving code to functions
    }
    END.
  }
}

OBJECT Codeunit 83002 Clocking Run Times Mgt
{
  OBJECT-PROPERTIES
  {
    Date=28.09.17;
    Time=11:10:31;
    Modified=Yes;
    Version List=OPC6.01;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      C_INC_ItemNotFound@1101103000 : TextConst 'ENU=Item not found %1 !;NOR=Fant ikke vare %1 !';

    PROCEDURE DeleteRunTimesForPOWithEmptyTimes@1101103004(VAR RunTimesP@1101103000 : Record 83010);
    VAR
      RunTimesL@1000000000 : Record 83010;
    BEGIN
      ////010 BVM-->
      RunTimesL.RESET;
      RunTimesL.SETRANGE("Prod. Order No.", RunTimesP."Prod. Order No.");
      RunTimesL.SETRANGE("Routing No.", RunTimesP."Routing No.");
      RunTimesL.SETRANGE("Starting Date", 0D);
      RunTimesL.SETRANGE("Starting Time", 0T);
      RunTimesL.SETRANGE("Ending Date", 0D);
      RunTimesL.SETRANGE("Ending Time", 0T);
      IF RunTimesL.FINDFIRST THEN BEGIN
       RunTimesL.DELETEALL;
      END;
      //010 BVM--<
    END;

    PROCEDURE DeleteRunTimesWithoutMachineCenter@1101103003();
    VAR
      RunTimesL@1000000000 : Record 83010;
    BEGIN
      //hhe 16.06.06->  Sletter blanke linjer f›r bokf›ring for † unng† feilmelding
      RunTimesL.RESET;
      RunTimesL.SETRANGE("Machine Center", '');
      IF RunTimesL.FINDFIRST THEN
        RunTimesL.DELETEALL;
      //hhe 16.06.06<-
    END;

    PROCEDURE AutoPostUnfinishedRunTimes@1101103011(VAR RunTimesP@1000000002 : Record 83010;EndDateP@1101103001 : Date;EndTimeP@1101103002 : Time);
    VAR
      ClockingPostOutputL@1101103000 : Codeunit 83004;
    BEGIN
      IF RunTimesP.FINDFIRST THEN BEGIN
        REPEAT
          RunTimesP.VALIDATE("Finish Now", TRUE);
          RunTimesP.MODIFY(TRUE);
          //hhe 16.3.10 Utlogging.RUN(Runtimes);
        UNTIL RunTimesP.NEXT = 0;
        //ClockingDeductionL.RUN(RunTimesP); //ny 16.3.2010
        ClockingPostOutputL.PostProductionFinishNow(RunTimesP, EndDateP, EndTimeP);
      END;
    END;

    PROCEDURE SetRunTimesFilter@1101103007(VAR RunTimesP@1101103000 : Record 83010;MachineCenterP@1101103001 : Code[20]);
    BEGIN
      RunTimesP.RESET();
      //RunTimesP.SETCURRENTKEY("Machine Center", "Starting Date", "Ending Date");
      RunTimesP.SETRANGE("Machine Center", MachineCenterP);
      RunTimesP.SETFILTER("Starting Date", '<>%1', 0D);
      RunTimesP.SETFILTER("Ending Date", '');
    END;

    PROCEDURE SetRunTimesFilterUnpostedWithStartTime@1101103000(VAR RunTimesP@1101103000 : Record 83010;MachineCenterP@1101103001 : Code[20]);
    BEGIN
      RunTimesP.RESET();
      //RunTimesP.SETCURRENTKEY("Machine Center", "Starting Date", "Starting Time", "Ending Time", Posted);
      RunTimesP.SETRANGE("Machine Center", MachineCenterP);
      RunTimesP.SETFILTER("Starting Date", '<>%1', 0D);
      RunTimesP.SETFILTER("Starting Time", '<>%1', 0T);
      //RunTimesP.SETRANGE("Ending Time", 0T);
      RunTimesP.SETRANGE(Posted,  FALSE);
    END;

    PROCEDURE SetRunTimesFilterFinishNow@1101103005(VAR RunTimesP@1101103000 : Record 83010;MachineCenterP@1101103001 : Code[20]);
    BEGIN
      RunTimesP.RESET();
      //RunTimesP.SETCURRENTKEY("Machine Center", "Starting Date", "Ending Date");
      RunTimesP.SETRANGE("Machine Center", MachineCenterP);
      RunTimesP.SETRANGE("Finish Now",  TRUE);
      RunTimesP.SETRANGE(Posted,  FALSE);
    END;

    PROCEDURE SetRunTimesProdFilter@1101103014(VAR RunTimesFromP@1101103000 : Record 83010;VAR RunTimesToP@1101103002 : Record 83010);
    BEGIN
      RunTimesToP.RESET;
      RunTimesToP.SETRANGE("Prod. Order No.",  RunTimesFromP."Prod. Order No.");
      RunTimesToP.SETRANGE("Routing No.",  RunTimesFromP."Routing No.");
      RunTimesToP.SETRANGE("Operation No.",  RunTimesFromP."Operation No.");
      RunTimesToP.SETRANGE(Posted, FALSE); //14. 28.07.16 JAL
    END;

    PROCEDURE SetRunTimesProdTimeFilter@1101103026(VAR RunTimesFromP@1101103000 : Record 83010;VAR RunTimesToP@1101103002 : Record 83010);
    BEGIN
      SetRunTimesProdFilter(RunTimesFromP, RunTimesToP);
      RunTimesToP.SETRANGE("Finish Now", TRUE);
      RunTimesToP.SETFILTER("Starting Date", '<>%1', 0D);
      RunTimesToP.SETFILTER("Starting Time", '<>%1', 0T);
      RunTimesToP.SETFILTER("Ending Date", '<>%1', 0D);
      RunTimesToP.SETFILTER("Ending Time", '<>%1', 0T);
    END;

    PROCEDURE SetRunTimesFilterFromPORouteUnpostedWithStartTime@1101103012(VAR OPCRunTimesP@1101103000 : Record 83010;VAR ProdOrderRoutingLineP@1101103001 : Record 5409);
    BEGIN
      OPCRunTimesP.RESET();
      //OPCRunTimesP.SETCURRENTKEY("Prod. Order No.", "Operation No.", "Machine Center", Posted);
      OPCRunTimesP.SETRANGE("Prod. Order No.", ProdOrderRoutingLineP."Prod. Order No.");
      OPCRunTimesP.SETRANGE("Routing No.", ProdOrderRoutingLineP."Routing No.");
      OPCRunTimesP.SETRANGE("Operation No.", ProdOrderRoutingLineP."Operation No.");
      OPCRunTimesP.SETRANGE("Machine Center", ProdOrderRoutingLineP."No.");
      //JAL This should not be needed. OPCRunTimesP.SETRANGE("Ending Date", 0D);
      OPCRunTimesP.SETRANGE(Posted,  FALSE);
    END;

    PROCEDURE SetRunTimesDeductionFilter@1101103009(VAR RunTimesFromP@1101103000 : Record 83010;VAR RunTimesToP@1101103002 : Record 83010);
    BEGIN
      SetRunTimesProdFilter(RunTimesFromP, RunTimesToP);
      RunTimesToP.SETRANGE("Finish Now", TRUE);
      RunTimesToP.SETRANGE("Machine Center",  RunTimesFromP."Machine Center");
      RunTimesToP.SETRANGE("Starting Date", RunTimesFromP."Starting Date");
      //hhe 28.09.06  //dersom man avslutter jobben over midnatt
      IF RunTimesFromP."Ending Date" > RunTimesFromP."Starting Date" THEN
        RunTimesToP.SETRANGE("Ending Date", RunTimesFromP."Starting Date")
      ELSE
        RunTimesToP.SETRANGE("Ending Date", RunTimesFromP."Ending Date");
    END;

    PROCEDURE SetRunTimesDeductionExistingLineFilter@1101103010(VAR RunTimesFromP@1101103000 : Record 83010;VAR RunTimesToP@1101103002 : Record 83010);
    BEGIN
      SetRunTimesProdFilter(RunTimesFromP, RunTimesToP);
      RunTimesToP.SETRANGE("Machine Center",  RunTimesFromP."Machine Center");
      RunTimesToP.SETRANGE("Finish Now", RunTimesFromP."Finish Now");
      RunTimesToP.SETRANGE(Posted,  RunTimesFromP.Posted);
      RunTimesToP.SETRANGE("Starting Date", RunTimesFromP."Starting Date");
      RunTimesToP.SETRANGE("Ending Date", RunTimesFromP."Ending Date");
    END;

    PROCEDURE SetRunTimesIndirectTimeFilter@1101103020(VAR OPCRunTimesP@1101103000 : Record 83010);
    BEGIN
      OPCRunTimesP.RESET();
      OPCRunTimesP.SETRANGE("Prod. Order No.", '');
      OPCRunTimesP.SETRANGE("Routing No.",  '');
      OPCRunTimesP.SETRANGE("Operation No.",  '');
      OPCRunTimesP.SETFILTER("Ending Date", '=%1', 0D);
      OPCRunTimesP.SETFILTER("Ending Time", '=%1', 0T);
    END;

    PROCEDURE SetCapacityLedgerEntriesFilterFromRunTimes@1101103015(OPCRunTimesP@1101103000 : Record 83010;VAR CapacityLedgerEntryP@1101103001 : Record 5832);
    BEGIN
      CapacityLedgerEntryP.SETRANGE("Order Type", CapacityLedgerEntryP."Order Type"::Production);
      CapacityLedgerEntryP.SETRANGE("Order No.", OPCRunTimesP."Prod. Order No.");
      CapacityLedgerEntryP.SETRANGE("Routing No.", OPCRunTimesP."Routing No.");
      CapacityLedgerEntryP.SETRANGE(Type, CapacityLedgerEntryP.Type::"Machine Center");
      CapacityLedgerEntryP.SETRANGE("No.", OPCRunTimesP."Machine Center");
      CapacityLedgerEntryP.SETRANGE("Operation No.", OPCRunTimesP."Operation No.");
      CapacityLedgerEntryP.SETRANGE("Starting Time", OPCRunTimesP."Starting Time");
      CapacityLedgerEntryP.SETRANGE("Ending Time", OPCRunTimesP."Ending Time");
      CapacityLedgerEntryP.SETRANGE("Posting Date", OPCRunTimesP."Ending Date");
    END;

    PROCEDURE SetCapacityLedgerEntriesFilterForCorrection@1101103016(VAR CapacityLedgerEntryFromP@1101103000 : Record 5832;VAR CapacityLedgerEntryToP@1101103001 : Record 5832);
    BEGIN
      CapacityLedgerEntryToP.SETRANGE("Order Type", CapacityLedgerEntryFromP."Order Type");
      CapacityLedgerEntryToP.SETRANGE("Order No.", CapacityLedgerEntryFromP."Order No.");
      CapacityLedgerEntryToP.SETRANGE("Routing No.", CapacityLedgerEntryFromP."Routing No.");
      CapacityLedgerEntryToP.SETRANGE(Type, CapacityLedgerEntryFromP.Type);
      CapacityLedgerEntryToP.SETRANGE("No.", CapacityLedgerEntryFromP."No.");
      CapacityLedgerEntryToP.SETRANGE("Operation No.", CapacityLedgerEntryFromP."Operation No.");
      CapacityLedgerEntryToP.SETRANGE("Posting Date", CapacityLedgerEntryFromP."Posting Date");
      CapacityLedgerEntryToP.SETRANGE(Quantity, (CapacityLedgerEntryFromP.Quantity * -1));
      CapacityLedgerEntryToP.SETRANGE("Run Time", (CapacityLedgerEntryFromP."Run Time" * -1));
    END;

    PROCEDURE SetRunTimesStart@1101103001(VAR RunTimesP@1101103000 : Record 83010;VAR RunTimesModifyP@1101103001 : Record 83010;StartDateP@1101103003 : Date;StartTimeP@1101103004 : Time);
    VAR
      ProdOrderRoutingLineL@1101103002 : Record 5409;
    BEGIN
      IF RunTimesModifyP.FINDFIRST THEN
      REPEAT
        RunTimesModifyP.TESTFIELD("Machine Center");
        IF (RunTimesModifyP."Starting Date" = 0D) THEN
          RunTimesModifyP.VALIDATE("Starting Date", StartDateP);
        IF (RunTimesModifyP."Starting Time" = 0T) THEN BEGIN
          RunTimesModifyP.VALIDATE("Starting Time", StartTimeP);
          IF GetProdRouteLineFromRunTimes(RunTimesP, ProdOrderRoutingLineL) THEN
            RunTimesModifyP.VALIDATE("Work Done at M.C.", ProdOrderRoutingLineL."No.");
          END;
        RunTimesModifyP.MODIFY(TRUE);
      UNTIL RunTimesModifyP.NEXT = 0;
    END;

    PROCEDURE SetRunTimesEnd@1101103018(VAR RunTimesP@1101103000 : Record 83010;EndDateP@1101103002 : Date;EndTimeP@1101103003 : Time);
    VAR
      ClockingDeductionL@1101103001 : Codeunit 83006;
    BEGIN
      IF RunTimesP.FINDFIRST THEN
      REPEAT
        IF (RunTimesP."Starting Date" <> 0D) AND (RunTimesP."Ending Date" = 0D) THEN
          RunTimesP.VALIDATE("Ending Date", EndDateP);
        IF (RunTimesP."Starting Time" <> 0T) AND (RunTimesP."Ending Time" = 0T)THEN
          RunTimesP.VALIDATE("Ending Time", EndTimeP);
        RunTimesP.MODIFY(TRUE);;
        ClockingDeductionL.SearchDeductions(RunTimesP);
      UNTIL RunTimesP.NEXT = 0;
    END;

    PROCEDURE SetRunTimesFinished@1101103006(VAR RunTimesP@1101103000 : Record 83010;EndDateP@1101103001 : Date;EndTimeP@1101103002 : Time);
    BEGIN
      RunTimesP.VALIDATE("Ending Date", EndDateP);
      RunTimesP.VALIDATE("Ending Time", EndTimeP);
      RunTimesP.VALIDATE("Finish Now", TRUE);
      RunTimesP.VALIDATE(Posted, TRUE);
    END;

    PROCEDURE GetProdRouteLineFromRunTimes@1101103002(VAR RunTimesP@1101103000 : Record 83010;VAR ProdOrderRoutingLineP@1101103001 : Record 5409) : Boolean;
    BEGIN
      ProdOrderRoutingLineP.RESET();
      ProdOrderRoutingLineP.SETRANGE("Prod. Order No.", RunTimesP."Prod. Order No.");
      ProdOrderRoutingLineP.SETRANGE("Routing No.", RunTimesP."Routing No.");
      ProdOrderRoutingLineP.SETRANGE("Operation No.", RunTimesP."Operation No.");
      ProdOrderRoutingLineP.SETRANGE(Type, ProdOrderRoutingLineP.Type::"Machine Center");
      ProdOrderRoutingLineP.SETRANGE(Status, ProdOrderRoutingLineP.Status::Released);
      EXIT(ProdOrderRoutingLineP.FINDFIRST);
    END;

    PROCEDURE GetProdOrderLineFromRunTimes@1101103008(VAR RunTimesP@1101103000 : Record 83010;VAR ProdOrderLineP@1101103001 : Record 5406) : Boolean;
    VAR
      ItemL@1101103002 : Record 27;
      FoundL@1101103003 : Boolean;
    BEGIN
      ProdOrderLineP.RESET();
      ProdOrderLineP.SETRANGE("Prod. Order No.", RunTimesP."Prod. Order No.");
      ProdOrderLineP.SETRANGE("Routing No.", RunTimesP."Routing No.");
      ProdOrderLineP.SETRANGE(Status, ProdOrderLineP.Status::Released);
      FoundL := ProdOrderLineP.FINDFIRST();
      IF FoundL THEN
        IF ItemL.GET(ProdOrderLineP."Item No.") THEN
          ProdOrderLineP.TESTFIELD("Routing No.")
        ELSE
          ERROR(C_INC_ItemNotFound, ProdOrderLineP."Item No.");
      EXIT(FoundL);
    END;

    PROCEDURE InsertRunTimesFromPORouting@1101103013(VAR RunTimesP@1101103000 : Record 83010;VAR ProdOrderRoutingLineP@1101103001 : Record 5409);
    BEGIN
      RunTimesP.INIT;
      RunTimesP."Entry No." := RunTimesP.GetNextLineNo();;
      RunTimesP.VALIDATE("Prod. Order No.", ProdOrderRoutingLineP."Prod. Order No.");
      RunTimesP.VALIDATE("Routing No.", ProdOrderRoutingLineP."Routing No.");
      RunTimesP.VALIDATE("Operation No.", ProdOrderRoutingLineP."Operation No.");
      RunTimesP.VALIDATE("Machine Center", ProdOrderRoutingLineP."No.");
      RunTimesP.INSERT(TRUE);
    END;

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 19.09.17 JAL Run Times Management
    }
    END.
  }
}

OBJECT Codeunit 83004 Clocking Post Output
{
  OBJECT-PROPERTIES
  {
    Date=16.10.17;
    Time=09:36:20;
    Modified=Yes;
    Version List=OPC6.01;
  }
  PROPERTIES
  {
    TableNo=83007;
    OnRun=BEGIN
            TESTFIELD("End Date");
            TESTFIELD("End Time");
            PostOutput("Machine Center", "End Date", "End Time");
          END;

  }
  CODE
  {
    VAR
      C_INC_ErrorInQty@1101103001 : TextConst 'ENU=Scrap can only be posted together with output quantity.;NOR=Vrak kan kun bokf›res sammen med ferdigantall.';
      C_INC_BatchNameInUse@1101103000 : TextConst 'ENU="This journal (batch name = %1) is used as system journal by OPC. Choose another batch name.";NOR="Denne kladden (bunkenavn = %1) brukes som en systemkladd av OPC. Velg et annet bunkenavn."';

    LOCAL PROCEDURE PostOutput@1000000000(MachineCenterP@1000000002 : Code[20];EndDateP@1000000004 : Date;EndTimeP@1000000005 : Time);
    VAR
      RunTimesL@1000000001 : Record 83010;
      ProdOrderLineL@1000000003 : Record 5406;
      ProdOrderRoutingLineL@1000000010 : Record 5409;
      ItemJournalLineL@1000000000 : Record 83;
      ClockingRunTimesMgtL@1101103000 : Codeunit 83002;
    BEGIN
      ClockingRunTimesMgtL.SetRunTimesFilterUnpostedWithStartTime(RunTimesL, MachineCenterP);
      IF RunTimesL.FINDFIRST THEN
      REPEAT
        IF ClockingRunTimesMgtL.GetProdOrderLineFromRunTimes(RunTimesL, ProdOrderLineL) THEN
          REPEAT
            InsertQuantityItemJournalLine(ItemJournalLineL);
            SetItemJournalLineFromProdOrderLine(ProdOrderLineL, ItemJournalLineL, RunTimesL."Operation No.");
            ItemJournalLineL."Entry Type" := ItemJournalLineL."Entry Type"::Output;
            SetItemJournalLineMachineCenterAndDates(ItemJournalLineL, MachineCenterP, EndDateP, EndDateP);
            ItemJournalLineL."Starting Time" := RunTimesL."Starting Time";
            ItemJournalLineL."Ending Time" := EndTimeP;
            ItemJournalLineL.VALIDATE("Run Time", ROUND(RunTimesL.GetTime(),0.01,'='));

            ItemJournalLineL.PostingItemJnlFromProduction(FALSE);

            IF ClockingRunTimesMgtL.GetProdRouteLineFromRunTimes(RunTimesL, ProdOrderRoutingLineL) THEN
              RunTimesL."Work Done at M.C." := ProdOrderRoutingLineL."No.";

            ClockingRunTimesMgtL.SetRunTimesFinished(RunTimesL, EndDateP, EndTimeP);
            RunTimesL.MODIFY(TRUE);
          UNTIL ProdOrderLineL.NEXT = 0;
      UNTIL RunTimesL.NEXT = 0;
    END;

    PROCEDURE PostOutputItemFromRoutingLine@1101103009(ProdOrderRoutingLineP@1101103000 : Record 5409);
    VAR
      ItemL@1101103002 : Record 27;
      OPCSetupL@1101103001 : Record 83001;
      ProdOrderLineL@1101103004 : Record 5406;
      ItemJournalLineL@1101103015 : Record 83;
      OutputRegistrationL@1101103003 : Page 83010;
      OutputQtyL@1101103005 : Decimal;
      ScrapQty2L@1101103014 : Decimal;
      ScrapDescription2L@1101103013 : Text[50];
      ScrapCode2L@1101103012 : Code[20];
      ScrapCodeL@1101103011 : Code[20];
      ScrapDescriptionL@1101103010 : Text[50];
      ScrapQty3L@1101103009 : Decimal;
      ScrapDescription3L@1101103008 : Text[50];
      ScrapCode3L@1101103007 : Code[20];
      ScrapQtyL@1101103006 : Decimal;
      PageActionL@1101103016 : Action;
      HasPostItem@1101103017 : Boolean;
    BEGIN
      HasPostItem := FALSE;
      OPCSetupL.GET();
      IF GetProdOrderLineFromProdOrderRoutingLine(ProdOrderRoutingLineP, ProdOrderLineL)  THEN BEGIN
        IF ItemL.GET(ProdOrderLineL."Item No.") THEN BEGIN
          ProdOrderLineL.TESTFIELD("Routing No.");
          OPCSetupL.TESTFIELD("Output Jnl. Templ. Name Qty");
          OPCSetupL.TESTFIELD("Output Jnl. Batch Name Qty");

          OutputRegistrationL.SetText(ProdOrderRoutingLineP."Prod. Order No.", ItemL."No.", ItemL.Description, ProdOrderRoutingLineP.Description);
          PageActionL := OutputRegistrationL.RUNMODAL();
          IF (PageActionL = ACTION::Yes) OR (PageActionL = ACTION::LookupOK) THEN
            OutputQtyL := OutputRegistrationL.FindQuantity
          ELSE
            EXIT;
          ScrapQtyL := OutputRegistrationL.ScrapQty;
          ScrapCodeL := OutputRegistrationL.ScrapID;
          ScrapDescriptionL := OutputRegistrationL.ScrapDescription;
          ScrapQty2L := OutputRegistrationL.ScrapQty2;
          ScrapCode2L := OutputRegistrationL.ScrapID2;
          ScrapDescription2L := OutputRegistrationL.ScrapDescription2;
          ScrapQty3L := OutputRegistrationL.ScrapQty3;
          ScrapCode3L := OutputRegistrationL.ScrapID3;
          ScrapDescription3L := OutputRegistrationL.ScrapDescription3;
          IF (OutputQtyL = 0) AND ((ScrapQtyL + ScrapQty2L + ScrapQty3L) > 0) THEN
            ERROR(C_INC_ErrorInQty);
          IF (OutputQtyL > 0) OR (ScrapQtyL > 0) THEN BEGIN
            EmptyQuantityJournal(ItemJournalLineL);
            InsertQuantityItemJournalLineFromQtyAndScrap(ItemJournalLineL, ProdOrderLineL, ProdOrderRoutingLineP, OutputQtyL, ScrapQtyL, ScrapCodeL, ScrapDescriptionL);
            HasPostItem := TRUE;
          END;
          //008 HEI-> Bokf›rer hvis antall "Vrak 2" er registrert
          IF ScrapQty2L <> 0 THEN BEGIN
            InsertQuantityItemJournalLineFromQtyAndScrap(ItemJournalLineL, ProdOrderLineL, ProdOrderRoutingLineP, 0, ScrapQty2L, ScrapCode2L, ScrapDescription2L);
            HasPostItem := TRUE;
          END;
          IF ScrapQty3L <> 0 THEN BEGIN  //Bokf›rer hvis antall "Vrak 3" er registrert
            InsertQuantityItemJournalLineFromQtyAndScrap(ItemJournalLineL, ProdOrderLineL, ProdOrderRoutingLineP, 0, ScrapQty3L, ScrapCode3L, ScrapDescription3L);
            HasPostItem := TRUE;
          END;
          IF HasPostItem THEN
            ItemJournalLineL.PostingItemJnlFromProduction(FALSE);
        END;
      END;
    END;

    PROCEDURE PostOutputCapacity@1101103000(VAR RunTimesP@1101103020 : Record 83010;VAR OutputQtyP@1101103019 : Decimal;VAR ScrapQtyP@1101103018 : Decimal;VAR ScrapCodeP@1101103017 : Code[20];VAR ScrapQty2P@1101103016 : Decimal;VAR ScrapCode2P@1101103015 : Code[20];VAR ScrapQty3P@1101103014 : Decimal;VAR ScrapCode3P@1101103013 : Code[20];VAR ScrapCommentP@1101103012 : Text[50];VAR ScrapComment2P@1101103011 : Text[50];VAR ScrapComment3P@1101103010 : Text[50]);
    VAR
      ProdOrderLineL@1101103007 : Record 5406;
      ItemJournalLineL@1101103005 : Record 83;
      ClockingRunTimesMgtL@1101103002 : Codeunit 83002;
      FirstLineL@1101103001 : Boolean;
      ScrapOutputL@1101103000 : Decimal;
    BEGIN
      FirstLineL := TRUE;
      IF RunTimesP.FINDFIRST THEN BEGIN
        EmptyTimeJournal(ItemJournalLineL);
        ClockingRunTimesMgtL.GetProdOrderLineFromRunTimes(RunTimesP, ProdOrderLineL);
        REPEAT
          InsertTimeItemJournalLine(ItemJournalLineL);
          IF ProdOrderLineL."Prod. Order No." <> '' THEN BEGIN
            SetItemJournalLineFromProdOrderLine(ProdOrderLineL, ItemJournalLineL,RunTimesP."Operation No.");
            IF FirstLineL AND ((OutputQtyP > 0) OR (ScrapQtyP > 0)) THEN BEGIN
              ItemJournalLineL.VALIDATE(ItemJournalLineL."Output Quantity", OutputQtyP);
              ItemJournalLineL.VALIDATE(ItemJournalLineL."Scrap Quantity", ScrapQtyP);
              ItemJournalLineL.VALIDATE(ItemJournalLineL."Scrap Code", ScrapCodeP);
              ItemJournalLineL.VALIDATE("Scrap Comment", ScrapCommentP);
            END;
            SetItemJournalLineFromRunTimes(RunTimesP, ItemJournalLineL);
            ItemJournalLineL.VALIDATE("Run Time", RunTimesP.GetHours());
            //sl†r her over flagget slik at ferdig-/vrak-antall ikke bokf›res p† alle p.ress. som avsluttes
            FirstLineL := FALSE;
          END ELSE BEGIN
            SetItemJournalLineFromRunTimes(RunTimesP, ItemJournalLineL);
            SetItemJournalLineFromIndirectTime(RunTimesP, ItemJournalLineL);
          END;
          ItemJournalLineL.MODIFY(TRUE);
          ItemJournalLineL.PostingItemJnlFromProduction(FALSE);
          //ItemJnlPostLineL.RunWithCheck(ItemJournalLineL);
          //CODEUNIT.RUN(CODEUNIT::"Item Jnl.-Post", ItemJournalLineL);
          RunTimesP.VALIDATE(Posted, TRUE);
          RunTimesP.MODIFY(TRUE);
        UNTIL RunTimesP.NEXT = 0;
        //hhe 12.10.07 bokf. vrakkode2
        ScrapOutputL := 0;
        IF ScrapQty2P <> 0 THEN BEGIN
          InsertTimeItemJournalLineFromQtyAndScrap(ItemJournalLineL, RunTimesP, ProdOrderLineL, ScrapOutputL, ScrapQty2P, ScrapCode2P, ScrapComment2P);
        END;
        //hhe 15.10.07 bokf. vrakkode 3 (hvis det er angitt)
        IF ScrapQty3P <> 0 THEN BEGIN
          InsertTimeItemJournalLineFromQtyAndScrap(ItemJournalLineL, RunTimesP, ProdOrderLineL, ScrapOutputL, ScrapQty3P, ScrapCode3P, ScrapComment3P);
        END;

        IF FindFirstLineInTimeJournal(ItemJournalLineL) THEN BEGIN
          CODEUNIT.RUN(CODEUNIT::"Item Jnl.-Post", ItemJournalLineL);
        END;
      END;
    END;

    PROCEDURE PostProductionFinishNow@1101103010(VAR OPCRunTimesP@1101103008 : Record 83010;EndDateP@1101103000 : Date;EndTimeP@1101103002 : Time);
    VAR
      OPCRunTimesL@1101103007 : Record 83010;
      ProdOrderLineL@1101103005 : Record 5406;
      ItemJournalLineL@1101103003 : Record 83;
      ClockingRunTimesMgtL@1101103001 : Codeunit 83002;
    BEGIN
      //hhe 16.06.06  Sletter blanke linjer f›r bokf›ring for † unng† feilmelding
      //ClockingRunTimesMgtL.DeleteRunTimesWithoutMachineCenter();
      // Setter inn sluttdato og sluttid  for ALLE operasjoner til denne prod.ressurs
      ClockingRunTimesMgtL.SetRunTimesFilterFinishNow(OPCRunTimesL, OPCRunTimesP."Machine Center");
      ClockingRunTimesMgtL.SetRunTimesEnd(OPCRunTimesL, EndDateP, EndTimeP);
      // Bokf›rer tidlinjer
      //OPCRunTimesL.SETCURRENTKEY("Prod. Order No.","Routing No.","Operation No.","Machine Center","Finish Now",Posted,
      //"Starting Time","Starting Date","Ending Time","Ending Date");
      ClockingRunTimesMgtL.SetRunTimesProdTimeFilter(OPCRunTimesP, OPCRunTimesL);
      IF OPCRunTimesL.FINDFIRST  THEN BEGIN
      //hvis det finnes linjer i RunTime for denne //prod.ressurs med Bokf›rt = Nei //og Avlutt n† =ja,  s†...
        ClockingRunTimesMgtL.GetProdOrderLineFromRunTimes(OPCRunTimesL, ProdOrderLineL);
        REPEAT
          //dette skjer ved m›nstring ut fra REELL OPERASJON (ikke Ind.tid) //dersom Ant.timer <> 0
          IF (ProdOrderLineL."Prod. Order No." <> '') AND (OPCRunTimesL.GetHours() <> 0) THEN BEGIN
            InsertTimeItemJournalLine(ItemJournalLineL);
            SetItemJournalLineFromProdOrderLine(ProdOrderLineL, ItemJournalLineL, OPCRunTimesL."Operation No.");
            SetItemJournalLineFromRunTimes(OPCRunTimesL, ItemJournalLineL);
            ItemJournalLineL.VALIDATE("Run Time", OPCRunTimesL.GetHours());
            ItemJournalLineL.MODIFY(TRUE);
            //Her skjer BOKFRING dersom m›nstring av en REELL operasjon (ikke ind.tid):
            IF FindFirstLineInTimeJournal(ItemJournalLineL) THEN
              ItemJournalLineL.PostingItemJnlFromProduction(FALSE);
            OPCRunTimesL.VALIDATE(Posted, TRUE);
            OPCRunTimesL.MODIFY(TRUE);
          END ELSE BEGIN      //her kommer det som skjer dersom det m›nstres ut av INDIREKTE TID...
            IF (ProdOrderLineL."Prod. Order No." = '') AND (OPCRunTimesL.GetHours() <> 0) THEN
              BEGIN
                InsertCapacityItemJournalLine(ItemJournalLineL);
                SetItemJournalLineFromRunTimes(OPCRunTimesL, ItemJournalLineL);
                SetItemJournalLineFromIndirectTime(OPCRunTimesL, ItemJournalLineL);
                ItemJournalLineL.VALIDATE("Stop Time", OPCRunTimesL.GetHours());
                ItemJournalLineL."Stop Code" := OPCRunTimesL."Stop Code";
                ItemJournalLineL.MODIFY(TRUE);
                //Her skjer bokf›ring dersom m›nstring av Indirekte tid:
                IF FindFirstLineInCapacityJournal(ItemJournalLineL) THEN
                  ItemJournalLineL.PostingItemJnlFromProduction(FALSE);
                OPCRunTimesL.VALIDATE(Posted, TRUE);
                OPCRunTimesL.MODIFY(TRUE);
              END;
          END;
        UNTIL OPCRunTimesL.NEXT = 0;
      END;
    END;

    PROCEDURE CorrectCapacityLedgerEntry@1101103021(VAR CapacityLedgerEntryP@1101103000 : Record 5832;ShowPageP@1101103004 : Boolean);
    VAR
      ItemJournalLineL@1101103001 : Record 83;
      OPCCapJournalCorrectionL@1101103002 : Page 83108;
      OPCOutputJournalCorrectionL@1101103003 : Page 83109;
    BEGIN
      IF (CapacityLedgerEntryP."Order Type" = CapacityLedgerEntryP."Order Type"::Production) THEN BEGIN
        IF (CapacityLedgerEntryP."Order No." = '') THEN BEGIN
          EmptyCapacityCorrectionJournal(ItemJournalLineL);
          InsertCapacityCorrectionItemJournalLine(ItemJournalLineL);
          SetItemJournalLineFromCapacityLedgerEntryIndirectTime(CapacityLedgerEntryP, ItemJournalLineL);
          ItemJournalLineL.MODIFY(TRUE);
          IF ShowPageP THEN BEGIN
            OPCCapJournalCorrectionL.SETTABLEVIEW(ItemJournalLineL);
            OPCCapJournalCorrectionL.RUN;
          END;
        END
        ELSE IF (CapacityLedgerEntryP."Order No." <> '') THEN BEGIN
          EmptyOutputCorrectionJournal(ItemJournalLineL);
          InsertOuputCorrectionItemJournalLine(ItemJournalLineL);
          SetItemJournalLineFromCapacityLedgerEntryOutput(CapacityLedgerEntryP, ItemJournalLineL);
          ItemJournalLineL.MODIFY(TRUE);
          IF ShowPageP THEN BEGIN
            OPCOutputJournalCorrectionL.SETTABLEVIEW(ItemJournalLineL);
            OPCOutputJournalCorrectionL.RUN;
          END;
        END;
      END;
    END;

    LOCAL PROCEDURE EmptyTimeJournal@1101103001(VAR ItemJournalLineP@1101103000 : Record 83);
    BEGIN
      SetTimeJournalFilter(ItemJournalLineP);
      IF ItemJournalLineP.FINDSET THEN
        ItemJournalLineP.DELETEALL;
    END;

    LOCAL PROCEDURE EmptyQuantityJournal@1101103013(VAR ItemJournalLineP@1101103000 : Record 83);
    BEGIN
      SetQuantityJournalFilter(ItemJournalLineP);
      IF ItemJournalLineP.FINDSET THEN
        ItemJournalLineP.DELETEALL;
    END;

    LOCAL PROCEDURE EmptyCapacityCorrectionJournal@1101103025(VAR ItemJournalLineP@1101103000 : Record 83);
    BEGIN
      SetCapacityCorrectionJournalFilter(ItemJournalLineP);
      IF ItemJournalLineP.FINDSET THEN
        ItemJournalLineP.DELETEALL;
    END;

    LOCAL PROCEDURE EmptyOutputCorrectionJournal@1101103034(VAR ItemJournalLineP@1101103000 : Record 83);
    BEGIN
      SetOutputCorrectionJournalFilter(ItemJournalLineP);
      IF ItemJournalLineP.FINDSET THEN
        ItemJournalLineP.DELETEALL;
    END;

    LOCAL PROCEDURE InsertTimeItemJournalLine@1101103003(VAR ItemJournalLineP@1101103000 : Record 83);
    VAR
      OPCSetupL@1101103001 : Record 83001;
    BEGIN
      OPCSetupL.GET();
      ItemJournalLineP.INIT;
      ItemJournalLineP.VALIDATE("Journal Template Name", OPCSetupL."Output Jnl. Templ. Name Time");
      ItemJournalLineP.VALIDATE("Journal Batch Name", OPCSetupL."Output Jnl. Batch Name Time");
      InsertItemJournalLine(ItemJournalLineP);
    END;

    LOCAL PROCEDURE InsertQuantityItemJournalLine@1101103014(VAR ItemJournalLineP@1101103000 : Record 83);
    VAR
      OPCSetupL@1101103001 : Record 83001;
    BEGIN
      OPCSetupL.GET();
      ItemJournalLineP.INIT;
      ItemJournalLineP.VALIDATE("Journal Template Name", OPCSetupL."Output Jnl. Templ. Name Qty");
      ItemJournalLineP.VALIDATE("Journal Batch Name", OPCSetupL."Output Jnl. Batch Name Qty");
      InsertItemJournalLine(ItemJournalLineP);
    END;

    LOCAL PROCEDURE InsertCapacityItemJournalLine@1101103029(VAR ItemJournalLineP@1101103000 : Record 83);
    VAR
      OPCSetupL@1101103001 : Record 83001;
    BEGIN
      OPCSetupL.GET();
      ItemJournalLineP.INIT;
      ItemJournalLineP.VALIDATE("Journal Template Name", OPCSetupL."Cap. Jnl. Templ. Name Indirect");
      ItemJournalLineP.VALIDATE("Journal Batch Name", OPCSetupL."Cap. Jnl. Batch Name Indirect");
      InsertItemJournalLine(ItemJournalLineP);
    END;

    LOCAL PROCEDURE InsertCapacityCorrectionItemJournalLine@1101103022(VAR ItemJournalLineP@1101103000 : Record 83);
    VAR
      OPCSetupL@1101103001 : Record 83001;
    BEGIN
      OPCSetupL.GET();
      ItemJournalLineP.INIT;
      ItemJournalLineP.VALIDATE("Journal Template Name", OPCSetupL."Cap. Jnl. Templ. Name Corr");
      ItemJournalLineP.VALIDATE("Journal Batch Name", OPCSetupL."Cap. Jnl. Batch Name Corr");
      InsertItemJournalLine(ItemJournalLineP);
    END;

    LOCAL PROCEDURE InsertOuputCorrectionItemJournalLine@1101103033(VAR ItemJournalLineP@1101103000 : Record 83);
    VAR
      OPCSetupL@1101103001 : Record 83001;
    BEGIN
      OPCSetupL.GET();
      ItemJournalLineP.INIT;
      ItemJournalLineP.VALIDATE("Journal Template Name", OPCSetupL."Output Jnl. Templ. Name Corr");
      ItemJournalLineP.VALIDATE("Journal Batch Name", OPCSetupL."Output Jnl. Batch Name Corr");
      InsertItemJournalLine(ItemJournalLineP);
    END;

    LOCAL PROCEDURE InsertItemJournalLine@1101103017(VAR ItemJournalLineP@1101103000 : Record 83);
    BEGIN
      ItemJournalLineP."Line No." := GetLastLineNoForItemJournalLine(ItemJournalLineP) + 10000;
      ItemJournalLineP.VALIDATE("Entry Type", ItemJournalLineP."Entry Type"::Output);
      ItemJournalLineP.INSERT(TRUE);
    END;

    LOCAL PROCEDURE InsertTimeItemJournalLineFromQtyAndScrap@1101103007(VAR ItemJournalLineP@1101103002 : Record 83;VAR RunTimesP@1101103000 : Record 83010;VAR ProdOrderLineP@1101103003 : Record 5406;VAR OutPutQtyP@1101103007 : Decimal;VAR ScrapQtyP@1101103006 : Decimal;VAR ScrapCodeP@1101103005 : Code[20];VAR ScrapCommentP@1101103004 : Text[50]);
    BEGIN
      InsertTimeItemJournalLine(ItemJournalLineP);
      InsertItemJournalLineFromScrap(ItemJournalLineP, ProdOrderLineP, RunTimesP."Machine Center", RunTimesP."Operation No.", OutPutQtyP, ScrapQtyP, ScrapCodeP, ScrapCommentP);
    END;

    LOCAL PROCEDURE InsertQuantityItemJournalLineFromQtyAndScrap@1101103043(VAR ItemJournalLineP@1101103002 : Record 83;VAR ProdOrderLineP@1101103003 : Record 5406;VAR ProdOrderRoutingLineP@1101103000 : Record 5409;OutPutQtyP@1101103007 : Decimal;VAR ScrapQtyP@1101103006 : Decimal;VAR ScrapCodeP@1101103005 : Code[20];VAR ScrapCommentP@1101103004 : Text[50]);
    BEGIN
      InsertQuantityItemJournalLine(ItemJournalLineP);
      InsertItemJournalLineFromScrap(ItemJournalLineP, ProdOrderLineP, ProdOrderRoutingLineP."No.", ProdOrderRoutingLineP."Operation No.", OutPutQtyP, ScrapQtyP, ScrapCodeP, ScrapCommentP);
    END;

    LOCAL PROCEDURE InsertItemJournalLineFromScrap@1101103036(VAR ItemJournalLineP@1101103002 : Record 83;VAR ProdOrderLineP@1101103000 : Record 5406;MachineCenterP@1101103009 : Code[10];OperationNoP@1101103008 : Code[10];VAR OutPutQtyP@1101103007 : Decimal;VAR ScrapQtyP@1101103006 : Decimal;VAR ScrapCodeP@1101103005 : Code[20];VAR ScrapCommentP@1101103004 : Text[50]);
    BEGIN
      IF ProdOrderLineP."Prod. Order No." <> '' THEN BEGIN
        SetItemJournalLineFromProdOrderLine(ProdOrderLineP, ItemJournalLineP, OperationNoP);
        IF OutPutQtyP <> 0 THEN
          ItemJournalLineP.VALIDATE("Output Quantity", OutPutQtyP);
        ItemJournalLineP.VALIDATE("Scrap Quantity", ScrapQtyP);
        ItemJournalLineP.VALIDATE("Scrap Code", ScrapCodeP);
        ItemJournalLineP.VALIDATE("Scrap Comment", ScrapCommentP);
      END;
      SetItemJournalLineMachineCenterAndDates(ItemJournalLineP, MachineCenterP, TODAY, TODAY);
      //ItemJournalLineP."Document No." := 'T00001';
      ItemJournalLineP.MODIFY(TRUE);;
    END;

    LOCAL PROCEDURE GetLastLineNoForItemJournalLine@1101103026(VAR ItemJournalLineP@1101103000 : Record 83) : Integer;
    VAR
      ItemJournalLineL@1101103001 : Record 83;
    BEGIN
      ItemJournalLineL.SETRANGE("Journal Template Name", ItemJournalLineP."Journal Template Name");
      ItemJournalLineL.SETRANGE("Journal Batch Name", ItemJournalLineP."Journal Batch Name");
      IF ItemJournalLineL.FINDLAST THEN
        EXIT(ItemJournalLineL."Line No.");
      EXIT(0);
    END;

    PROCEDURE SetTimeJournalFilter@1101103016(VAR ItemJournalLineP@1101103000 : Record 83);
    VAR
      OPCSetupL@1101103008 : Record 83001;
    BEGIN
      OPCSetupL.GET();
      OPCSetupL.CheckOutputJnlTimeSetup();
      ItemJournalLineP.RESET();
      ItemJournalLineP.SETRANGE("Journal Template Name", OPCSetupL."Output Jnl. Templ. Name Time");
      ItemJournalLineP.SETRANGE("Journal Batch Name", OPCSetupL."Output Jnl. Batch Name Time");
    END;

    PROCEDURE SetQuantityJournalFilter@1101103018(VAR ItemJournalLineP@1101103000 : Record 83);
    VAR
      OPCSetupL@1101103008 : Record 83001;
    BEGIN
      OPCSetupL.GET();
      OPCSetupL.CheckOutputJnlQtySetup();
      ItemJournalLineP.RESET();
      ItemJournalLineP.SETRANGE("Journal Template Name", OPCSetupL."Output Jnl. Templ. Name Qty");
      ItemJournalLineP.SETRANGE("Journal Batch Name", OPCSetupL."Output Jnl. Batch Name Qty");
    END;

    PROCEDURE SetCapacityJournalFilter@1101103012(VAR ItemJournalLineP@1101103000 : Record 83);
    VAR
      OPCSetupL@1101103008 : Record 83001;
    BEGIN
      OPCSetupL.GET();
      OPCSetupL.CheckCapacityJnlSetup();
      ItemJournalLineP.RESET();
      ItemJournalLineP.SETRANGE("Journal Template Name", OPCSetupL."Cap. Jnl. Templ. Name Indirect");
      ItemJournalLineP.SETRANGE("Journal Batch Name", OPCSetupL."Cap. Jnl. Batch Name Indirect");
    END;

    PROCEDURE SetCapacityCorrectionJournalFilter@1101103028(VAR ItemJournalLineP@1101103000 : Record 83);
    VAR
      OPCSetupL@1101103008 : Record 83001;
    BEGIN
      OPCSetupL.GET();
      OPCSetupL.CheckCapacityCorrectionJnlSetup();
      ItemJournalLineP.RESET();
      ItemJournalLineP.SETRANGE("Journal Template Name", OPCSetupL."Cap. Jnl. Templ. Name Corr");
      ItemJournalLineP.SETRANGE("Journal Batch Name", OPCSetupL."Cap. Jnl. Batch Name Corr");
    END;

    PROCEDURE SetOutputCorrectionJournalFilter@1101103030(VAR ItemJournalLineP@1101103000 : Record 83);
    VAR
      OPCSetupL@1101103008 : Record 83001;
    BEGIN
      OPCSetupL.GET();
      OPCSetupL.CheckOutputCorrectionJnlSetup();
      ItemJournalLineP.RESET();
      ItemJournalLineP.SETRANGE("Journal Template Name", OPCSetupL."Output Jnl. Templ. Name Corr");
      ItemJournalLineP.SETRANGE("Journal Batch Name", OPCSetupL."Output Jnl. Batch Name Corr");
    END;

    LOCAL PROCEDURE FindFirstLineInTimeJournal@1101103019(VAR ItemJournalLineP@1101103000 : Record 83) : Boolean;
    BEGIN
      SetTimeJournalFilter(ItemJournalLineP);
      EXIT(ItemJournalLineP.FINDFIRST);
    END;

    LOCAL PROCEDURE FindLastLineInTimeJournal@1101103008(VAR ItemJournalLineP@1101103000 : Record 83) : Boolean;
    BEGIN
      SetTimeJournalFilter(ItemJournalLineP);
      EXIT(ItemJournalLineP.FINDLAST);
    END;

    LOCAL PROCEDURE FindFirstLineInQuantityJournal@1101103020(VAR ItemJournalLineP@1101103000 : Record 83) : Boolean;
    BEGIN
      SetQuantityJournalFilter(ItemJournalLineP);
      EXIT(ItemJournalLineP.FINDFIRST);
    END;

    LOCAL PROCEDURE FindLastLineInQuantityJournal@1101103015(VAR ItemJournalLineP@1101103000 : Record 83) : Boolean;
    BEGIN
      SetQuantityJournalFilter(ItemJournalLineP);
      EXIT(ItemJournalLineP.FINDLAST);
    END;

    LOCAL PROCEDURE FindFirstLineInCapacityJournal@1101103011(VAR ItemJournalLineP@1101103000 : Record 83) : Boolean;
    BEGIN
      SetCapacityJournalFilter(ItemJournalLineP);
      EXIT(ItemJournalLineP.FINDFIRST);
    END;

    LOCAL PROCEDURE SetItemJournalLineFromProdOrderLine@1101103004(VAR ProdOrderLineP@1101103001 : Record 5406;VAR ItemJournalLineP@1101103002 : Record 83;OperationNoP@1101103000 : Code[10]);
    BEGIN
      ItemJournalLineP.VALIDATE("Order Type", ItemJournalLineP."Order Type"::Production);
      ItemJournalLineP.VALIDATE("Order No.", ProdOrderLineP."Prod. Order No.");
      ItemJournalLineP.VALIDATE("Item No.", ProdOrderLineP."Item No.");
      ItemJournalLineP.VALIDATE("Operation No.", OperationNoP);
      ItemJournalLineP.VALIDATE("Order Line No.", ProdOrderLineP."Line No.");
      ItemJournalLineP.VALIDATE("Location Code", ProdOrderLineP."Location Code");
      ItemJournalLineP.CopyDim(ProdOrderLineP."Dimension Set ID"); //JAL
    END;

    LOCAL PROCEDURE SetItemJournalLineFromIndirectTime@1101103005(VAR RunTimesP@1101103000 : Record 83010;VAR ItemJournalLineP@1101103002 : Record 83);
    VAR
      OPCSetupL@1101103001 : Record 83001;
    BEGIN
      OPCSetupL.GET();
      ItemJournalLineP."Document No." := OPCSetupL."Document No. Ind.Time";
      ItemJournalLineP.VALIDATE("Stop Time", RunTimesP.GetHours());
      //22.01.10->
      ItemJournalLineP."Stop Code" := RunTimesP."Stop Code";
    END;

    LOCAL PROCEDURE SetItemJournalLineFromRunTimes@1101103006(VAR RunTimesP@1101103000 : Record 83010;VAR ItemJournalLineP@1101103002 : Record 83);
    BEGIN
      ItemJournalLineP.VALIDATE(Type, ItemJournalLineP.Type::"Machine Center");
      ItemJournalLineP.VALIDATE("No.", RunTimesP."Machine Center");
      ItemJournalLineP."Posting Date" := RunTimesP."Ending Date";
      ItemJournalLineP."Document Date" := TODAY;
      ItemJournalLineP."Starting Time" := RunTimesP."Starting Time";
      ItemJournalLineP."Ending Time" := RunTimesP."Ending Time";
    END;

    LOCAL PROCEDURE SetItemJournalLineMachineCenterAndDates@1101103027(VAR ItemJournalLineP@1101103002 : Record 83;MachineCenterP@1101103003 : Code[20];PostingDateP@1101103000 : Date;DocumentDateP@1101103004 : Date);
    BEGIN
      ItemJournalLineP.VALIDATE(Type, ItemJournalLineP.Type::"Machine Center");
      ItemJournalLineP.VALIDATE("No.", MachineCenterP);
      ItemJournalLineP."Posting Date" := PostingDateP;
      ItemJournalLineP."Document Date" := DocumentDateP;
    END;

    LOCAL PROCEDURE SetItemJournalLineFromCapacityLedgerEntryIndirectTime@1101103023(VAR CapacityLedgerEntryP@1101103000 : Record 5832;VAR ItemJournalLineP@1101103002 : Record 83);
    BEGIN
      ItemJournalLineP.VALIDATE(Description, CapacityLedgerEntryP.Description);
      ItemJournalLineP."Document No." := CapacityLedgerEntryP."Document No.";
      ItemJournalLineP."Cap. Unit of Measure Code" := CapacityLedgerEntryP."Cap. Unit of Measure Code";
      ItemJournalLineP.VALIDATE("Posting Date", CapacityLedgerEntryP."Posting Date");
      ItemJournalLineP.VALIDATE(Type, CapacityLedgerEntryP.Type);
      ItemJournalLineP.VALIDATE("No.", CapacityLedgerEntryP."No.");
      ItemJournalLineP.VALIDATE("Stop Time", (CapacityLedgerEntryP."Invoiced Quantity" *-1));
      ItemJournalLineP.VALIDATE("Stop Code", CapacityLedgerEntryP."Stop Code");
    END;

    LOCAL PROCEDURE SetItemJournalLineFromCapacityLedgerEntryOutput@1101103024(VAR CapacityLedgerEntryP@1101103000 : Record 5832;VAR ItemJournalLineP@1101103002 : Record 83);
    BEGIN
      ItemJournalLineP.VALIDATE("Order Type", ItemJournalLineP."Order Type"::Production);
      ItemJournalLineP.VALIDATE("Order No.", CapacityLedgerEntryP."Order No.");
      ItemJournalLineP.VALIDATE("Order Line No.", CapacityLedgerEntryP."Order Line No.");
      ItemJournalLineP."Operation No.":= CapacityLedgerEntryP."Operation No.";
      ItemJournalLineP.VALIDATE("Item No.", CapacityLedgerEntryP."Item No.");
      ItemJournalLineP.VALIDATE("Work Center No.", CapacityLedgerEntryP."Work Center No.");
      ItemJournalLineP.VALIDATE("Routing No.", CapacityLedgerEntryP."Routing No.");
      ItemJournalLineP.VALIDATE("Routing Reference No.", CapacityLedgerEntryP."Routing Reference No.");
      ItemJournalLineP.VALIDATE(Description, CapacityLedgerEntryP.Description);
      ItemJournalLineP."Document No.":= CapacityLedgerEntryP."Document No.";
      ItemJournalLineP.VALIDATE("Posting Date", CapacityLedgerEntryP."Posting Date");
      ItemJournalLineP.VALIDATE(Type, CapacityLedgerEntryP.Type);
      ItemJournalLineP.VALIDATE("No.", CapacityLedgerEntryP."No.");
      ItemJournalLineP.VALIDATE("Run Time", (CapacityLedgerEntryP."Invoiced Quantity" * -1));
    END;

    LOCAL PROCEDURE GetProdOrderLineFromProdOrderRoutingLine@1101103002(VAR ProdOrderRoutingLineP@1101103000 : Record 5409;VAR ProdOrderLineP@1101103001 : Record 5406) : Boolean;
    BEGIN
      ProdOrderLineP.RESET();
      ProdOrderLineP.SETRANGE("Prod. Order No.", ProdOrderRoutingLineP."Prod. Order No.");
      ProdOrderLineP.SETRANGE("Routing No.", ProdOrderRoutingLineP."Routing No.");
      ProdOrderLineP.SETRANGE(Status, ProdOrderRoutingLineP.Status::Released);
      EXIT(ProdOrderLineP.FINDFIRST);
    END;

    PROCEDURE CheckJournalNameOPC@1101103093(VAR CurrentJnlBatchNameP@1101103005 : Code[10]);
    VAR
      OPCSetupL@1101103004 : Record 83001;
    BEGIN
      OPCSetupL.GET;
      //01. hhe 07.10.10->
      IF (CurrentJnlBatchNameP = OPCSetupL."Output Jnl. Batch Name Qty") OR (CurrentJnlBatchNameP = OPCSetupL."Output Jnl. Batch Name Time") THEN
        ERROR(C_INC_BatchNameInUse, CurrentJnlBatchNameP);
      //01. hhe 07.10.10<-
    END;

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 18.09.17 JAL Post Output and Scrap for Machine Center
    }
    END.
  }
}

OBJECT Codeunit 83006 Clocking Deduction
{
  OBJECT-PROPERTIES
  {
    Date=26.09.17;
    Time=12:03:49;
    Modified=Yes;
    Version List=OPC6.12;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    PROCEDURE SearchDeductions@1000000003(VAR OPCRunTimesP@1000000000 : Record 83010);
    VAR
      OPCRunTimesDeductionL@1000000003 : Record 83012;
      OPCRunTimesL@1000000002 : Record 83010;
      ClockingRunTimesMgtL@1101103000 : Codeunit 83002;
    BEGIN
      OPCRunTimesDeductionL.RESET;
      IF OPCRunTimesDeductionL.FINDFIRST THEN
        REPEAT
          ClockingRunTimesMgtL.SetRunTimesDeductionFilter(OPCRunTimesP, OPCRunTimesL);
          OPCRunTimesL.SETFILTER("Starting Time", '<=%1', OPCRunTimesDeductionL."From Time");
          OPCRunTimesL.SETFILTER("Ending Time", '>=%1', OPCRunTimesDeductionL."To Time");
          IF OPCRunTimesL.FINDFIRST THEN
            //IF NOT ExisitingDeductionLine(RunTimes, RunTimeDeduction)
            IF (NOT ExisitingDeductionLine(OPCRunTimesP, OPCRunTimesDeductionL)) AND (DATE2DWY(OPCRunTimesP."Starting Date",1) < 6) THEN// XX BVM
              InsertDeductionLine(OPCRunTimesP, OPCRunTimesDeductionL);
         UNTIL OPCRunTimesDeductionL.NEXT = 0;
    END;

    PROCEDURE ExisitingDeductionLine@1000000002(VAR OPCRunTimesP@1000000001 : Record 83010;VAR OPCRunTimesDeductionP@1000000000 : Record 83012) : Boolean;
    VAR
      OPCRunTimesL@1000000002 : Record 83010;
      ClockingRunTimesMgtL@1101103000 : Codeunit 83002;
    BEGIN
      ClockingRunTimesMgtL.SetRunTimesDeductionExistingLineFilter(OPCRunTimesP, OPCRunTimesL);
      OPCRunTimesL.SETRANGE("Starting Time", OPCRunTimesDeductionP."To Time");
      OPCRunTimesL.SETRANGE("Ending Time", OPCRunTimesDeductionP."From Time");
      EXIT(OPCRunTimesL.FINDFIRST());
    END;

    PROCEDURE InsertDeductionLine@1000000000(VAR OPCRunTimesP@1000000000 : Record 83010;VAR OPCRunTimesDeductionP@1000000004 : Record 83012);
    VAR
      OPCRunTimesL@1000000001 : Record 83010;
      NewEntryNoL@1000000002 : Integer;
    BEGIN
      NewEntryNoL := OPCRunTimesL.GetNextLineNo();
      OPCRunTimesL.INIT;
      OPCRunTimesL."Entry No." := NewEntryNoL;
      OPCRunTimesL."Prod. Order No." := OPCRunTimesP."Prod. Order No.";
      OPCRunTimesL."Routing No." := OPCRunTimesP."Routing No.";
      OPCRunTimesL."Operation No." := OPCRunTimesP."Operation No.";
      OPCRunTimesL."Machine Center" := OPCRunTimesP."Machine Center";
      OPCRunTimesL.Description := OPCRunTimesP.Description;
      //From and To time are registered reverse to get minus quantity
      OPCRunTimesL."Starting Date" := OPCRunTimesP."Starting Date";
      OPCRunTimesL."Starting Time" := OPCRunTimesDeductionP."To Time";
      OPCRunTimesL."Ending Date" := OPCRunTimesP."Starting Date";
      OPCRunTimesL."Ending Time" := OPCRunTimesDeductionP."From Time";
      OPCRunTimesL."Finish Now" := TRUE;
      OPCRunTimesL.Posted := FALSE;
      OPCRunTimesL."Work Done at M.C." := OPCRunTimesP."Work Done at M.C.";
      OPCRunTimesL."Stop Code" :=   OPCRunTimesP."Stop Code";
      OPCRunTimesL.INSERT;
    END;

    PROCEDURE DeductLunch@1080002(MachineCenterP@1080001 : Code[20];RegisterDateP@1080000 : Date;StartedTimeP@1080004 : Time;EndTimeP@1101103001 : Time);
    VAR
      WorkCenterL@1080002 : Record 99000754;
      OPCRunTimesDeductionL@1080003 : Record 83012;
      OPCTimeRegisterL@1080005 : Record 83007;
      ClockingMgtL@1101103000 : Codeunit 83001;
    BEGIN
      IF WorkCenterHasDeductLunch(MachineCenterP, WorkCenterL) THEN BEGIN //krever at Prod.ressurs-kortet finnes
        OPCRunTimesDeductionL.GET(WorkCenterL."Time Reg. Deduct Code Lunch");
        //kun hvis B†de Start- og Slutt-tid er //sjekker om lunch-pausen er trukket fra f›r.... //UTENFOR intervallet for lunch-pause
        //IF (TIME > OPCRunTimesDeductionL."To Time") AND (StartedTimeP < OPCRunTimesDeductionL."From Time") THEN BEGIN
        IF (EndTimeP > OPCRunTimesDeductionL."To Time") AND (StartedTimeP < OPCRunTimesDeductionL."From Time") THEN BEGIN
          //hvis ikke fratrukket pause for lunch, oppretter fradragslinje
          IF NOT ClockingMgtL.GetTimeRegisterFirstLineDeduction(OPCTimeRegisterL, MachineCenterP, RegisterDateP) THEN BEGIN
            ClockingMgtL.InsertTimeRegisterDeductionLine(OPCRunTimesDeductionL, MachineCenterP, RegisterDateP);
          END;
        END;
      END;
    END;

    PROCEDURE WorkCenterHasDeductLunch@1101103003(MachineCenterP@1101103001 : Code[20];VAR WorkCenterP@1101103000 : Record 99000754) : Boolean;
    VAR
      MachineCenterL@1101103002 : Record 99000758;
    BEGIN
      IF MachineCenterL.GET(MachineCenterP) THEN //krever at Prod.ressurs-kortet finnes
        IF WorkCenterP.GET(MachineCenterL."Work Center No.") THEN //fradrag kun dersom Arbeidssenteret til prod.ressurs finnes
          IF WorkCenterP."Time Reg. Deduct Code Lunch" <> '' THEN //fradrag kun dersom Arb.senter har Lunch-fradragskode
            EXIT(TRUE);
      EXIT(FALSE);
    END;

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 2009     OJO Opprettet denne Codeunit med kopiering av programkode fra Elas sin OPC.
                       Koden er hentet fra knappen "Registrer". Elas brukte denne b†de til † sette start- og slutttid
      02.17.09.10  HHE Sette starttidspunkter i.f.m. M›nstre av....
                       Jfr. OJO-avsnitt (01.) det skal vi ikke gj›re p† AS (med denne CU). Denne CU brukes kun for † M›nstre av &
                       stoppe operasjontid. Jeg har derfor kommentert ut et helt avsnitt
      03. 17.09.10 HHE Sette slutttidspunkter i.f.m. M›nstre av....
                        Jfr. OJO-avsnitt (01.)
                        Dette var nok mer riktig † kopiere inn, men en ting blir feil:
                        Inn i denne CU f†r vi KUN Prod.ressursnr., (ikke hverken Prod.o.nr. og op. nr.)
                        Har derfor skrevet om koden.
      04. 17.09.10 HHE Kun linjer vedr. denne prod.ressurs overf›res til Bokf. i kladden
      05. 17.09.10 HHE Jfr. 01 - OJO: programkode vedr. bokf. av Vrak, ferdig antall m.m. skal ikke kopieres over
                        Er derfor kommentert ut
      06. 20.09.10 HHE Jfr. 01.: Kommentert ut programkode som vedr. bokf›ring av Ferdig- og vrakkantall
      07. 20.09.10 HHE Ind.tid: Setter poster som "Post" tidligere i programkoden
      08. 20.09.10 HHE Sjekker at kladdemal &-navn finnes for Indirekte tid
      09. 20.09.10 HHE Dersom posten = INDIREKTE TID -> bokf›res i egen kladd
      10. 21.09.10 HHE Forbedret tildeling av Linjenr -> Ferdigmeldingskladd
                       Tar med Stop Code p† Fratrekk Lunch/Middag (Deductions)
      11. 29.08.13 OJO Lagt til bruk av ny n›kkel ved bokf›ring av tidslinjer.
      12. 21.09.17 JAL Code Cleaning. Moving code to functions.
    }
    END.
  }
}

OBJECT Codeunit 91061 Library - OPC
{
  OBJECT-PROPERTIES
  {
    Date=11.10.17;
    Time=18:04:47;
    Modified=Yes;
    Version List=TST1.01,OPC6.01;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      FileManagementG@1101103001 : Codeunit 419;
      LibraryProductionIncG@1101103000 : Codeunit 91062;
      LibraryRandomG@1101103002 : Codeunit 130440;
      LibraryManufacturingG@1101103003 : Codeunit 132202;
      LibraryUtilityG@1101103007 : Codeunit 131000;
      AssertG@1101103005 : Codeunit 130000;
      ClockingMgtG@1101103004 : Codeunit 83001;
      ClockingRunTimesMgtG@1101103006 : Codeunit 83002;
      ClockingPostOutputG@1101103008 : Codeunit 83004;

    PROCEDURE OPCSetup@1101103005();
    VAR
      OPCSetupL@1101103000 : Record 83001;
      TempBlobL@1101103003 : Record 99008535;
      FilePathL@1101103001 : Text;
      NameL@1101103002 : Text;
      ServerFilePathL@1101103004 : Text;
    BEGIN
      IF NOT OPCSetupL.GET THEN
        OPCSetupL.INSERT(TRUE);
      LibraryProductionIncG.OutputJournalSetup('AVGANG', 'OPC');
      OPCSetupL.VALIDATE("Output Jnl. Templ. Name Qty", 'AVGANG');
      OPCSetupL.VALIDATE("Output Jnl. Batch Name Qty", 'OPC');
      OPCSetupL.VALIDATE("Output Jnl. Templ. Name Time", 'AVGANG');
      OPCSetupL.VALIDATE("Output Jnl. Batch Name Time", 'OPC');
      LibraryProductionIncG.CapacityJournalSetup('KAPASITET', 'AUTO');
      OPCSetupL.VALIDATE("Cap. Jnl. Templ. Name Corr", 'KAPASITET');
      OPCSetupL.VALIDATE("Cap. Jnl. Batch Name Corr", 'AUTO');
      LibraryProductionIncG.CapacityJournalSetup('KAPASITET', 'OPC-TO');
      OPCSetupL.VALIDATE("Cap. Jnl. Templ. Name Indirect", 'KAPASITET');
      OPCSetupL.VALIDATE("Cap. Jnl. Batch Name Indirect", 'OPC-TO');
      OPCSetupL.VALIDATE("Work Center Prod time", 'PROD');
      OPCSetupL.VALIDATE("Work Center Adm. time", 'ADMIN');
      OPCSetupL.VALIDATE("Document No. Ind.Time", 'IND.TID');
      FilePathL := 'C:\Git\NAV AddOns\OPC\Pictures\warning.png';
      IF FileManagementG.ClientFileExists(FilePathL) THEN BEGIN
        //FileManagementG.UploadFileSilent(FilePathL);
        //FileManagementG.BLOBImport(TempBlobL, FilePathL);
        ServerFilePathL := FileManagementG.UploadFileSilent(FilePathL);
        //OPCSetupL."Warning Icon".IMPORTFILE(ServerFilePathL, 'warning');
        FileManagementG.BLOBImportFromServerFile(TempBlobL,ServerFilePathL);
        OPCSetupL."Warning Picture" := TempBlobL.Blob;
      END;
      OPCSetupL.MODIFY(TRUE);
    END;

    PROCEDURE OPCGetRandomMachineCenterShowInOPC@1101103001() CodeR : Code[10];
    VAR
      MachineCenterL@1101103000 : Record 99000758;
    BEGIN
      MachineCenterL.SETRANGE("Show in OPC", TRUE);
      EXIT(GetMachineCenter(MachineCenterL));
    END;

    PROCEDURE OPCGetRandomMachineCenterClocking@1101103000() CodeR : Code[10];
    VAR
      MachineCenterL@1101103000 : Record 99000758;
    BEGIN
      MachineCenterL.SETRANGE(Clocking, TRUE);
      EXIT(GetMachineCenter(MachineCenterL));
    END;

    PROCEDURE OPCGetRandomProdOrderRoutingLine@1101103002(VAR ProdOrderRoutingLine@1101103001 : Record 5409);
    VAR
      ProdOrderRoutingLineL@1101103000 : Record 5409;
    BEGIN
      IF ProdOrderRoutingLine.FINDSET THEN
        ProdOrderRoutingLine.NEXT(LibraryRandomG.RandIntInRange(0, (ProdOrderRoutingLine.COUNT - 1)));
    END;

    PROCEDURE OPCGetRandomIndirectTime@1101103015() CodeR : Code[15];
    VAR
      OPCIndirectTimeL@1101103000 : Record 83011;
    BEGIN
      IF OPCIndirectTimeL.FINDSET THEN BEGIN
        OPCIndirectTimeL.NEXT(LibraryRandomG.RandIntInRange(0, (OPCIndirectTimeL.COUNT - 1)));
        CodeR := OPCIndirectTimeL.Code;
      END ELSE BEGIN
        CodeR := LibraryUtilityG.GenerateRandomCode(OPCIndirectTimeL.FIELDNO(Code),DATABASE::"OPC Indirect Time");
        OPCIndirectTimeL.INIT;
        OPCIndirectTimeL.VALIDATE(Code, CodeR);
        OPCIndirectTimeL.VALIDATE(Description, LibraryUtilityG.GenerateRandomText(MAXSTRLEN(OPCIndirectTimeL.Description)));
        OPCIndirectTimeL.INSERT(TRUE);
      END;
      EXIT(CodeR);
    END;

    PROCEDURE OPCCreateMachineCenter@1101103003(VAR MachineCenterP@1101103000 : Record 99000758);
    VAR
      WorkCenterL@1101103001 : Record 99000754;
    BEGIN
      LibraryManufacturingG.CreateWorkCenterWithCalendar(WorkCenterL);
      WorkCenterL.VALIDATE("Flushing Method", WorkCenterL."Flushing Method"::Manual);
      WorkCenterL.MODIFY(TRUE);
      LibraryManufacturingG.CreateMachineCenterWithCalendar(MachineCenterP, WorkCenterL."No.", LibraryRandomG.RandDec(100, 2));
      MachineCenterP.VALIDATE("Show in OPC", TRUE);
      MachineCenterP.MODIFY(TRUE);
    END;

    PROCEDURE OPCRegisterTimeInOut@1101103006(MachineCenterNoP@1101103003 : Code[20];RegisterDateP@1101103002 : Date;RegisterTimeP@1101103001 : Time);
    BEGIN
      IF MachineCenterNoP = '' THEN
        MachineCenterNoP := OPCGetRandomMachineCenterClocking();
      IF RegisterDateP = 0D THEN
        RegisterDateP := TODAY;
      IF RegisterTimeP = 0T THEN
        RegisterTimeP := 080000T;
      ClockingMgtG.RegisterTimeInOut(MachineCenterNoP, RegisterDateP, RegisterTimeP);
    END;

    PROCEDURE OPCRegisterTimeOnTask@1101103013(VAR ProdOrderRoutingLineP@1101103008 : Record 5409;VAR OPCRunTimesP@1101103007 : Record 83010;MachineCenterNoP@1101103003 : Code[20];StartDateP@1101103002 : Date;StartTimeP@1101103001 : Time;EndDateP@1101103013 : Date;EndTimeP@1101103012 : Time;OutPutQtyP@1101103006 : Decimal;ScrapQtyP@1101103005 : Decimal;ScrapCodeP@1101103004 : Code[20];ScrapCommentP@1101103000 : Text[50]);
    VAR
      ScrapQty2L@1101103009 : Decimal;
      ScrapCode2L@1101103011 : Code[10];
      ScrapComment2L@1101103010 : Text;
    BEGIN
      IF ProdOrderRoutingLineP.ISEMPTY THEN BEGIN
        ProdOrderRoutingLineP.SETRANGE(Status, ProdOrderRoutingLineP.Status::Released);
        OPCGetRandomProdOrderRoutingLine(ProdOrderRoutingLineP);
      END;
      AssertG.AreEqual(OPCRunTimesP.GETFILTERS, '' , '');
      OPCRunTimesP.INIT;
      OPCRunTimesP."Entry No." := OPCRunTimesP.GetNextLineNo();
      OPCRunTimesP.VALIDATE("Machine Center", MachineCenterNoP);
      OPCRunTimesP.INSERT(TRUE);
      //Start time for the Production Order Operation task will be the end time for the closing task
      ClockingMgtG.OnAfterValidateMachineCenter(MachineCenterNoP, StartDateP, StartTimeP);
      OPCRunTimesP.VALIDATE("Work Done at M.C.", MachineCenterNoP); // 002 ASL 29.03.06
      OPCRunTimesP.VALIDATE("Prod. Order No.", ProdOrderRoutingLineP."Prod. Order No.");
      OPCRunTimesP.VALIDATE("Routing No.", ProdOrderRoutingLineP."Routing No.");
      OPCRunTimesP.VALIDATE("Operation No.", ProdOrderRoutingLineP."Operation No.");
      OPCRunTimesP.VALIDATE("Starting Date", StartDateP);
      OPCRunTimesP.VALIDATE("Starting Time", StartTimeP);
      OPCRunTimesP.MODIFY(TRUE);
      ScrapQty2L := 0;
      ScrapCode2L := '';
      ScrapComment2L := '';
      ClockingMgtG.RegisterTimeOnTask(OPCRunTimesP, StartDateP, StartTimeP, EndDateP, EndTimeP, OutPutQtyP, ScrapQtyP, ScrapCodeP, ScrapQty2L, ScrapCode2L, ScrapQty2L, ScrapCode2L, ScrapCommentP, ScrapComment2L, ScrapComment2L);
    END;

    PROCEDURE OPCRegisterTimeOnIndirectTime@1101103016(VAR IndirectTimeCodeP@1101103000 : Code[15];MachineCenterNoP@1101103003 : Code[20];StartDateP@1101103005 : Date;StartTimeP@1101103004 : Time;EndDateP@1101103002 : Date;EndTimeP@1101103001 : Time);
    VAR
      OPCRunTimesL@1101103007 : Record 83010;
      OPCIndirectTimeL@1101103008 : Record 83011;
      ScrapQty2L@1101103009 : Decimal;
      ScrapCode2L@1101103011 : Code[10];
      ScrapComment2L@1101103010 : Text;
    BEGIN
      IF IndirectTimeCodeP = '' THEN
        IndirectTimeCodeP := OPCGetRandomIndirectTime();
      OPCIndirectTimeL.GET(IndirectTimeCodeP);
      OPCRunTimesL.INIT;
      OPCRunTimesL."Entry No." := OPCRunTimesL.GetNextLineNo();
      OPCRunTimesL.VALIDATE("Machine Center", MachineCenterNoP);
      OPCRunTimesL.VALIDATE("Stop Code", OPCIndirectTimeL.Code);
      //OPCRunTimesL.VALIDATE("Starting Date", RegisterDateP);
      //OPCRunTimesL.VALIDATE("Starting Time", RegisterTimeP);
      OPCRunTimesL.INSERT(TRUE);
      ScrapQty2L := 0;
      ScrapCode2L := '';
      ScrapComment2L := '';
      ClockingMgtG.RegisterTimeOnTask(OPCRunTimesL, StartDateP,  StartTimeP, EndDateP, EndTimeP, ScrapQty2L, ScrapQty2L, ScrapCode2L, ScrapQty2L, ScrapCode2L, ScrapQty2L, ScrapCode2L, ScrapComment2L, ScrapComment2L, ScrapComment2L);
    END;

    PROCEDURE OPCCorrectCapacityEntry@1101103019(VAR CapacityLedgerEntryP@1101103000 : Record 5832);
    VAR
      ItemJournalLineL@1101103001 : Record 83;
    BEGIN
      ClockingPostOutputG.CorrectCapacityLedgerEntry(CapacityLedgerEntryP, FALSE);
      IF (CapacityLedgerEntryP."Order Type" = CapacityLedgerEntryP."Order Type"::Production) THEN
        IF (CapacityLedgerEntryP."Order No." = '') THEN
          ClockingPostOutputG.SetCapacityCorrectionJournalFilter(ItemJournalLineL)
        ELSE
          ClockingPostOutputG.SetOutputCorrectionJournalFilter(ItemJournalLineL);
      ItemJournalLineL.FINDLAST;
      ItemJournalLineL.PostingItemJnlFromProduction(FALSE);
    END;

    PROCEDURE VerifyRegisterTimeInLine@1101103007(MachineCenterNoP@1101103003 : Code[20];StartDateP@1101103002 : Date;StartTimeP@1101103001 : Time);
    VAR
      OPCTimeRegisterL@1101103000 : Record 83007;
    BEGIN
      GetTimeRegisterStartLine(OPCTimeRegisterL, MachineCenterNoP);
      AssertG.RecordCount(OPCTimeRegisterL, 1);
      AssertG.AreEqual(OPCTimeRegisterL."Machine Center", MachineCenterNoP, '');
      AssertG.AreEqual(OPCTimeRegisterL."Start Date", StartDateP, '');
      AssertG.AreEqual(OPCTimeRegisterL."Start Time", StartTimeP, '');
      AssertG.AreEqual(OPCTimeRegisterL."End Date", 0D, '');
      AssertG.AreEqual(OPCTimeRegisterL."End Time", 0T, '');
    END;

    PROCEDURE VerifyRegisterTimeOutLine@1101103008(MachineCenterNoP@1101103003 : Code[20];StartDateP@1101103002 : Date;StartTimeP@1101103001 : Time;EndDateP@1101103005 : Date;EndTimeP@1101103000 : Time);
    VAR
      OPCTimeRegisterL@1101103004 : Record 83007;
    BEGIN
      GetTimeRegisterEndLine(OPCTimeRegisterL, MachineCenterNoP, EndDateP, EndTimeP);
      AssertG.RecordCount(OPCTimeRegisterL, 1);
      AssertG.AreEqual(OPCTimeRegisterL."Machine Center", MachineCenterNoP, '');
      AssertG.AreEqual(OPCTimeRegisterL."Start Date", StartDateP, '');
      AssertG.AreEqual(OPCTimeRegisterL."Start Time", StartTimeP, '');
      AssertG.AreEqual(OPCTimeRegisterL."End Date", EndDateP, '');
      AssertG.AreEqual(OPCTimeRegisterL."End Time", EndTimeP, '');
    END;

    PROCEDURE VerifyRegisterTimeOutDeductLunch@1101103012(MachineCenterNoP@1101103003 : Code[20];StartDateP@1101103002 : Date;StartTimeP@1101103001 : Time;EndDateP@1101103005 : Date;EndTimeP@1101103000 : Time);
    VAR
      OPCTimeRegisterL@1101103004 : Record 83007;
      OPCRunTimesDeductionL@1101103006 : Record 83012;
      WorkCenterL@1101103007 : Record 99000754;
      ClockingDeductionL@1101103008 : Codeunit 83006;
    BEGIN
      ClockingMgtG.GetTimeRegisterFirstLineDeduction(OPCTimeRegisterL, MachineCenterNoP, EndDateP);
      AssertG.RecordCount(OPCTimeRegisterL, 1);
      ClockingDeductionL.WorkCenterHasDeductLunch(MachineCenterNoP, WorkCenterL);
      OPCRunTimesDeductionL.GET(WorkCenterL."Time Reg. Deduct Code Lunch");
      AssertG.AreEqual(OPCTimeRegisterL."Deduction Type", OPCTimeRegisterL."Deduction Type"::Lunch, '');
      AssertG.AreEqual(OPCTimeRegisterL."Machine Center", MachineCenterNoP, '');
      AssertG.AreEqual(OPCTimeRegisterL."Start Date", StartDateP, '');
      AssertG.AreEqual(OPCTimeRegisterL."End Date", EndDateP, '');
      //From and To time are registered reverse to get minus quantity
      AssertG.AreEqual(OPCTimeRegisterL."Start Time", OPCRunTimesDeductionL."To Time", '');
      AssertG.AreEqual(OPCTimeRegisterL."End Time", OPCRunTimesDeductionL."From Time", '');
    END;

    PROCEDURE VerifyRunTimesIndirectTime@1101103014(MachineCenterNoP@1101103003 : Code[20];StartDateP@1101103002 : Date;StartTimeP@1101103001 : Time;IndirectTimeCodeL@1101103000 : Code[15]);
    VAR
      OPCRunTimesL@1101103004 : Record 83010;
    BEGIN
      //ClockingRunTimesMgtG.SetRunTimesFilterUnpostedWithStartTime(OPCRunTimesL, MachineCenterNoP);
      OPCRunTimesL.SETRANGE("Machine Center", MachineCenterNoP);
      OPCRunTimesL.SETRANGE("Starting Date", StartDateP);
      OPCRunTimesL.SETRANGE("Starting Time", StartTimeP);
      AssertG.RecordCount(OPCRunTimesL, 1);
      OPCRunTimesL.FINDFIRST;
      AssertG.AreEqual(OPCRunTimesL."Machine Center", MachineCenterNoP, '');
      AssertG.AreEqual(OPCRunTimesL."Starting Date", StartDateP, '');
      AssertG.AreEqual(OPCRunTimesL."Starting Time", StartTimeP, '');
      AssertG.AreEqual(OPCRunTimesL."Ending Date", 0D, '');
      AssertG.AreEqual(OPCRunTimesL."Ending Time", 0T, '');
      AssertG.AreEqual(OPCRunTimesL."Stop Code", IndirectTimeCodeL, '');
      AssertG.AreEqual(OPCRunTimesL.Posted, FALSE, '');
      AssertG.AreEqual(OPCRunTimesL."Finish Now", FALSE, '');
    END;

    PROCEDURE VerifyRunTimesTaskTime@1101103018(ProdOrderRoutingLineP@1101103000 : Record 5409;MachineCenterNoP@1101103003 : Code[20];StartDateP@1101103002 : Date;StartTimeP@1101103001 : Time);
    VAR
      OPCRunTimesL@1101103004 : Record 83010;
    BEGIN
      ClockingRunTimesMgtG.SetRunTimesFilterUnpostedWithStartTime(OPCRunTimesL, MachineCenterNoP);
      AssertG.RecordCount(OPCRunTimesL, 1);
      OPCRunTimesL.FINDFIRST;
      AssertG.AreEqual(OPCRunTimesL."Machine Center", MachineCenterNoP, '');
      AssertG.AreEqual(OPCRunTimesL."Starting Date", StartDateP, '');
      AssertG.AreEqual(OPCRunTimesL."Starting Time", StartTimeP, '');
      AssertG.AreEqual(OPCRunTimesL."Ending Date", 0D, '');
      AssertG.AreEqual(OPCRunTimesL."Ending Time", 0T, '');
      AssertG.AreEqual(OPCRunTimesL."Prod. Order No.", ProdOrderRoutingLineP."Prod. Order No.", '');
      AssertG.AreEqual(OPCRunTimesL."Routing No.", ProdOrderRoutingLineP."Routing No.", '');
      AssertG.AreEqual(OPCRunTimesL."Operation No.", ProdOrderRoutingLineP."Operation No.", '');
      AssertG.AreEqual(OPCRunTimesL."Stop Code", '', '');
    END;

    PROCEDURE VerifyCapacityLedgerEntriesFromRunTimes@1101103017(VAR CapacityLedgerEntryP@1101103002 : Record 5832;OPCRunTimesP@1101103000 : Record 83010);
    VAR
      OPCRunTimesL@1101103001 : Record 83010;
    BEGIN
      OPCRunTimesL.GET(OPCRunTimesP."Entry No."); // Get the newest version of the record. After posting.
      AssertG.AreNotEqual(OPCRunTimesL."Machine Center", '', '');
      AssertG.AreNotEqual(OPCRunTimesL."Starting Date", 0D, '');
      AssertG.AreNotEqual(OPCRunTimesL."Starting Time", 0T, '');
      AssertG.AreNotEqual(OPCRunTimesL."Ending Date", 0D, '');
      AssertG.AreNotEqual(OPCRunTimesL."Ending Time", 0T, '');
      AssertG.AreEqual(OPCRunTimesL.Posted, TRUE, '');
      AssertG.AreEqual(OPCRunTimesL."Finish Now", TRUE, '');
      ClockingRunTimesMgtG.SetCapacityLedgerEntriesFilterFromRunTimes(OPCRunTimesL, CapacityLedgerEntryP);
      AssertG.RecordCount(CapacityLedgerEntryP, 1);
      CapacityLedgerEntryP.FINDFIRST;
      AssertG.AreEqual(CapacityLedgerEntryP.Quantity, OPCRunTimesL.GetHours(), '');
      // Run Times is registered on Production Order not Indirect Time
      IF OPCRunTimesL."Prod. Order No." <> '' THEN BEGIN
        AssertG.AreNotEqual(OPCRunTimesL."Routing No.", '', '');
        AssertG.AreNotEqual(OPCRunTimesL."Operation No.", '', '');
        AssertG.AreEqual(CapacityLedgerEntryP."Run Time", OPCRunTimesL.GetHours(), '');
      END;
    END;

    PROCEDURE VerifyCapacityLedgerEntriesCorrection@1101103021(VAR CapacityLedgerEntryP@1101103002 : Record 5832);
    VAR
      CapacityLedgerEntryL@1101103001 : Record 5832;
    BEGIN
      ClockingRunTimesMgtG.SetCapacityLedgerEntriesFilterForCorrection(CapacityLedgerEntryP, CapacityLedgerEntryL);
      AssertG.RecordIsNotEmpty(CapacityLedgerEntryP);
      AssertG.AreNotEqual(CapacityLedgerEntryP."No.", '', '');
      AssertG.AreNotEqual(CapacityLedgerEntryP."Starting Time", 0T, '');
      AssertG.AreNotEqual(CapacityLedgerEntryP."Ending Time", 0T, '');
      CapacityLedgerEntryL.FINDFIRST;
      AssertG.AreNotEqual(CapacityLedgerEntryL.COUNT, 0, '');
      AssertG.AreEqual(CapacityLedgerEntryL.Quantity, (CapacityLedgerEntryP.Quantity * -1), '');
      // Capacity Ledger Entry is registered on Production Order not Indirect Time
      IF CapacityLedgerEntryP."Order No." <> '' THEN BEGIN
        AssertG.AreNotEqual(CapacityLedgerEntryP."Routing No.", '', '');
        AssertG.AreNotEqual(CapacityLedgerEntryP."Operation No.", '', '');
        AssertG.AreEqual(CapacityLedgerEntryL."Run Time", (CapacityLedgerEntryP."Run Time"  * -1), '');
      END;
    END;

    LOCAL PROCEDURE GetTimeRegisterStartLine@1101103009(VAR OPCTimeRegisterP@1101103000 : Record 83007;MachineCenterP@1101103001 : Code[20]) : Boolean;
    BEGIN
      ClockingMgtG.SetTimeRegisterFilterWithoutEndTime(OPCTimeRegisterP, MachineCenterP);
      IF OPCTimeRegisterP.FINDSET THEN
        EXIT(OPCTimeRegisterP.FINDFIRST())
      ELSE
        EXIT(FALSE);
    END;

    LOCAL PROCEDURE GetTimeRegisterEndLine@1101103011(VAR OPCTimeRegisterP@1101103000 : Record 83007;MachineCenterP@1101103001 : Code[20];EndDateP@1101103002 : Date;EndTimeP@1101103003 : Time) : Boolean;
    BEGIN
      OPCTimeRegisterP.RESET;
      OPCTimeRegisterP.SETRANGE("Machine Center", MachineCenterP);
      OPCTimeRegisterP.SETRANGE("End Date", EndDateP);
      OPCTimeRegisterP.SETRANGE("End Time", EndTimeP);
      IF OPCTimeRegisterP.FINDSET THEN
        EXIT(OPCTimeRegisterP.FINDFIRST())
      ELSE
        EXIT(FALSE);
    END;

    PROCEDURE CheckRegisterTimeIn@1101103010(VAR MachineCenterNoP@1101103003 : Code[20];EndDateP@1101103005 : Date;EndTimeP@1101103000 : Time);
    VAR
      OPCTimeRegisterL@1101103004 : Record 83007;
    BEGIN
      GetTimeRegisterStartLine(OPCTimeRegisterL, MachineCenterNoP);
      IF OPCTimeRegisterL.FINDSET THEN
        ClockingMgtG.RegisterTimeInOut(MachineCenterNoP, EndDateP, EndTimeP);
      GetTimeRegisterStartLine(OPCTimeRegisterL, MachineCenterNoP);
      AssertG.RecordIsEmpty(OPCTimeRegisterL);
    END;

    PROCEDURE GetMachineCenter@1101103004(VAR MachineCenterP@1101103001 : Record 99000758) CodeR : Code[10];
    VAR
      CountL@1101103000 : Integer;
      IndexL@1101103002 : Integer;
    BEGIN
      IF MachineCenterP.FINDSET THEN BEGIN
        CountL := MachineCenterP.COUNT;
        IndexL := LibraryRandomG.RandInt(CountL);//.RandIntInRange(0, (CountL - 1));
        MachineCenterP.NEXT(IndexL);
        CodeR := MachineCenterP."No.";
      END;
      EXIT(CodeR);
    END;

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 18.08.17 JAL Common Incadea functions for OPC
                       Hard coded text should be replaced with variables or config file.
    }
    END.
  }
}

OBJECT Codeunit 91064 OPC Production Order
{
  OBJECT-PROPERTIES
  {
    Date=11.10.17;
    Time=17:24:39;
    Modified=Yes;
    Version List=NAVW110.00.00,TST1.01,OPC6.01;
  }
  PROPERTIES
  {
    Subtype=Test;
    TestPermissions=Disabled;
    OnRun=BEGIN
            IsInitialized := FALSE;
          END;

  }
  CODE
  {
    VAR
      InventorySetup@1013 : Record 313;
      LibraryERM@1010 : Codeunit 131300;
      LibraryInventory@1007 : Codeunit 132201;
      LibraryManufacturing@1016 : Codeunit 132202;
      LibraryRandomG@1001 : Codeunit 130440;
      LibrarySales@1008 : Codeunit 130509;
      LibraryWarehouse@1019 : Codeunit 132204;
      LibraryProductionIncG@1101103002 : Codeunit 91062;
      LibraryOPCG@1101103000 : Codeunit 91061;
      LibraryItemIncG@1101103001 : Codeunit 91008;
      IsInitialized@1000 : Boolean;

    PROCEDURE CreateSingleLineRouting@11(VAR RoutingHeader@1000 : Record 99000763) : Code[20];
    VAR
      RoutingLine@1001 : Record 99000764;
      WorkCenter@1002 : Record 99000754;
      MachineCenterL@1101103000 : Record 99000758;
    BEGIN
      LibraryOPCG.OPCCreateMachineCenter(MachineCenterL);

      LibraryManufacturing.CreateRoutingHeader(RoutingHeader,RoutingHeader.Type::Serial);
      LibraryManufacturing.CreateRoutingLine(RoutingHeader, RoutingLine, '', '', RoutingLine.Type::"Machine Center", MachineCenterL."No.");

      RoutingLine.VALIDATE("Run Time",LibraryRandomG.RandDecInRange(1, 10, 2));
      RoutingLine.MODIFY(TRUE);

      RoutingHeader.VALIDATE(Status,RoutingHeader.Status::Certified);
      RoutingHeader.MODIFY(TRUE);
      EXIT(RoutingHeader."No.");
    END;

    PROCEDURE CreateProdOrder@1101103003(VAR ProductionOrderP@1101103002 : Record 5405);
    VAR
      TempItemJournalLine@1007 : TEMPORARY Record 83;
      ItemJournalTemplate@1013 : Record 82;
      Item@1000 : Record 27;
      Item1@1006 : Record 27;
      RoutingHeader@1001 : Record 99000763;
      ProductionBOMHeader@1002 : Record 99000771;
      PurchaseHeader@1003 : Record 38;
      PurchInvHeader@1004 : Record 122;
      PurchaseLine@1012 : Record 39;
      ItemCharge@1008 : Record 5800;
      ValueEntry@1010 : Record 5802;
      PurchInvHeader1@1011 : Record 122;
      LocationL@1101103000 : Record 14;
      QuantityL@1101103001 : Decimal;
    BEGIN
      Initialize;

      // [GIVEN] Component item with costing method Average.
      LibraryItemIncG.CreateItemByCostingAndReplenishment(Item1,Item1."Costing Method"::Average,Item1."Replenishment System"::Purchase);
      // [GIVEN] Location exists
      LibraryWarehouse.CreateLocationWithInventoryPostingSetup(LocationL);

      // [GIVEN] BOM with component item on line.
      LibraryProductionIncG.CreateSingleLineBOM(ProductionBOMHeader,Item1);
      // [GIVEN] Single line routing for a random Machine center.
      // [GIVEN] Machine Center is marked as Show in OPC.
      CreateSingleLineRouting(RoutingHeader);

      // [GIVEN] Parent item with costing method Average.
      LibraryItemIncG.CreateItemByCostingAndReplenishment(Item,Item."Costing Method"::Average,Item."Replenishment System"::"Prod. Order");
      // [GIVEN] Routing and BOM assigned to parent item.
      Item.VALIDATE("Routing No.",RoutingHeader."No.");
      Item.VALIDATE("Production BOM No.",ProductionBOMHeader."No.");
      Item.VALIDATE("Flushing Method",Item."Flushing Method"::Manual);
      Item.MODIFY(TRUE);

      Item1.CALCFIELDS(Inventory);
      //ProductionOrderP.DELETEALL;
      // [GIVEN] Created and refreshed production order for parent item.
      IF Item1.Inventory = 0 THEN
        QuantityL := LibraryRandomG.RandDecInRange(1, 1000, 2)
      ELSE
        QuantityL := Item1.Inventory;
      LibraryManufacturing.CreateProductionOrder(ProductionOrderP,ProductionOrderP.Status::Released,ProductionOrderP."Source Type"::Item,
        Item."No.", QuantityL );
      ProductionOrderP.VALIDATE("Starting Time", TIME);
      ProductionOrderP.VALIDATE("Due Date", CALCDATE('<+7D>',WORKDATE));
      ProductionOrderP.VALIDATE("Location Code", LocationL.Code);
      ProductionOrderP.MODIFY(TRUE);
      //Backward
      LibraryManufacturing.RefreshProdOrder(ProductionOrderP,FALSE,TRUE,TRUE,TRUE,FALSE);
      //Forward
      //LibraryManufacturing.RefreshProdOrder(ProductionOrderP, TRUE, TRUE, TRUE, TRUE, FALSE);
    END;

    LOCAL PROCEDURE Initialize@88();
    VAR
      LibraryERMCountryData@1001 : Codeunit 131305;
    BEGIN
      IF IsInitialized THEN
        EXIT;

      //LibraryERMCountryData.CreateVATData;
      //LibraryERMCountryData.UpdateSalesReceivablesSetup;
      //17.08.17 JAL LibraryERMCountryData.UpdateGeneralPostingSetup;//Fails
      //LibraryERMCountryData.CreateGeneralPostingSetupData;
      IsInitialized := TRUE;
      COMMIT;
    END;

    PROCEDURE PostProductionOrder@22(VAR TempItemJournalLine@1005 : TEMPORARY Record 83;ProductionOrderNo@1003 : Code[20];Type@1001 : Option);
    VAR
      ItemJournalTemplate@1000 : Record 82;
      ItemJournalBatch@1002 : Record 233;
      ItemJournalLine@1004 : Record 83;
    BEGIN
      LibraryInventory.SelectItemJournalTemplateName(ItemJournalTemplate,Type);
      LibraryInventory.SelectItemJournalBatchName(
        ItemJournalBatch,ItemJournalBatch."Template Type"::Consumption,ItemJournalTemplate.Name);

      CASE Type OF
        ItemJournalTemplate.Type::Consumption:
          LibraryManufacturing.CalculateConsumption(ProductionOrderNo,ItemJournalBatch."Journal Template Name",ItemJournalBatch.Name);
        ItemJournalTemplate.Type::Output:
          BEGIN
            LibraryInventory.ClearItemJournal(ItemJournalTemplate,ItemJournalBatch);
            LibraryManufacturing.CreateOutputJournal(ItemJournalLine,ItemJournalTemplate,ItemJournalBatch,'',ProductionOrderNo);
            LibraryInventory.OutputJnlExplRoute(ItemJournalLine);
          END;
      END;

      ItemJournalLine.SETRANGE("Journal Template Name",ItemJournalBatch."Journal Template Name");
      ItemJournalLine.SETRANGE("Journal Batch Name",ItemJournalBatch.Name);
      ItemJournalLine.FINDSET;
      REPEAT
        TempItemJournalLine := ItemJournalLine;
        TempItemJournalLine.INSERT;
      UNTIL ItemJournalLine.NEXT = 0;

      LibraryInventory.PostItemJournalLine(ItemJournalBatch."Journal Template Name",ItemJournalBatch.Name);
    END;

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 18.08.17 JAL Object is copied from COD137001 SCM Online Adjustment
                       Property on function changed to Local = No
    }
    END.
  }
}

OBJECT Codeunit 91066 Library - OPC Pages
{
  OBJECT-PROPERTIES
  {
    Date=11.10.17;
    Time=16:50:04;
    Modified=Yes;
    Version List=OPC6.01,TST1.01;
  }
  PROPERTIES
  {
    Subtype=Test;
    OnRun=BEGIN
            IsInitializedG := TRUE
          END;

  }
  CODE
  {
    VAR
      LibraryRandomG@1101103007 : Codeunit 130440;
      AssertG@1101103002 : Codeunit 130000;
      C_INC_ErrorNearlyEqual@1101103003 : TextConst 'ENU=There is too much difference between expected value %1 and current %2;NOR=Det er for mye forskjell mellom forventet verdi %1 og n†v‘rende %2';
      LibraryVariableStorageG@1101103004 : Codeunit 131004;
      LibraryUtilityIncG@1101103000 : Codeunit 91001;
      LibraryOPCG@1101103005 : Codeunit 91061;
      OPCProductionOrderG@1101103006 : Codeunit 91064;
      IsInitializedG@1101103001 : Boolean;

    LOCAL PROCEDURE Initialize@6();
    VAR
      LibraryERMCountryData@1000 : Codeunit 131305;
    BEGIN
      LibraryVariableStorageG.Clear;
      IF IsInitializedG THEN
        EXIT;
      IsInitializedG := TRUE
    END;

    [Test]
    PROCEDURE UI_RegisterTimeInPage@1101103003();
    VAR
      OPCInformationBoardL@1101103000 : TestPage 83001;
      OPCTimeRegisterListL@1101103001 : TestPage 83017;
      TimeL@1101103002 : Time;
      StartTimeL@1101103003 : Time;
      StartDateL@1101103004 : Date;
      MachineCenterNoL@1101103005 : Code[10];
    BEGIN
      // [GIVEN] Stored test values are cleared.
      Initialize();
      // [GIVEN] Information Board is open
      OPCInformationBoardL.OPENVIEW;
      // [GIVEN] Register Time Card is opened from Information Board
      OPCTimeRegisterListL.TRAP;// The next page that is invoked will be trapped and assigned to the variable.
      OPCInformationBoardL."Time Registration".INVOKE;
      // [GIVEN] Machine Center is selected and not empty
      MachineCenterNoL := LibraryOPCG.OPCGetRandomMachineCenterClocking();
      AssertG.AreNotEqual('', MachineCenterNoL,'');
      OPCTimeRegisterListL.FILTER.SETFILTER("No.", MachineCenterNoL);
      OPCTimeRegisterListL."No.".ASSERTEQUALS(MachineCenterNoL);
      // [WHEN] The user clocks in (Register in time).
      OPCTimeRegisterListL."Register Time".INVOKE();
      //SLEEP(1000); //To test the TimeAreNearlyEqual
      TimeL := TIME;
      OPCTimeRegisterListL."OPC Time Register Subform".LAST;
      // [THEN] Clocking in time is registered on the last line in the subform
      EVALUATE(StartTimeL, OPCTimeRegisterListL."OPC Time Register Subform"."Start Time".VALUE);
      LibraryUtilityIncG.TimeAreNearlyEqual(TimeL, StartTimeL, 2000, '');
      StartDateL := TODAY;
      OPCTimeRegisterListL."OPC Time Register Subform"."Start Date".ASSERTEQUALS(StartDateL);
      OPCTimeRegisterListL.CLOSE;
      OPCInformationBoardL.CLOSE;
      LibraryVariableStorageG.Enqueue(StartTimeL);
      LibraryVariableStorageG.Enqueue(StartDateL);
      LibraryVariableStorageG.Enqueue(MachineCenterNoL);
    END;

    [Test]
    PROCEDURE UI_RegisterTimeOutPage@1101103000();
    VAR
      OPCInformationBoardL@1101103000 : TestPage 83001;
      OPCTimeRegisterListL@1101103001 : TestPage 83017;
      TimeL@1101103002 : Time;
      StartTimeL@1101103003 : Time;
      EndTimeL@1101103005 : Time;
      StartDateL@1101103004 : Date;
      MachineCenterNoL@1101103006 : Code[20];
      DurationL@1101103007 : Duration;
    BEGIN
      // [GIVEN] Information Board is open
      OPCInformationBoardL.OPENVIEW;
      // [GIVEN] Register Time Card is opened from Information Board
      OPCTimeRegisterListL.TRAP;// The next page that is invoked will be trapped and assigned to the variable.
      OPCInformationBoardL."Time Registration".INVOKE;
      // [GIVEN] Machine Center is selected and not empty. Get value from stored value or get random value.
      IF LibraryVariableStorageG.Length > 0 THEN
        MachineCenterNoL := LibraryVariableStorageG.PeekText(3)
      ELSE
        MachineCenterNoL := LibraryOPCG.OPCGetRandomMachineCenterClocking();
      AssertG.AreNotEqual('', MachineCenterNoL,'');
      OPCTimeRegisterListL.FILTER.SETFILTER("No.", MachineCenterNoL);
      OPCTimeRegisterListL."No.".ASSERTEQUALS(MachineCenterNoL);
      // [GIVEN] Last line has start date and time but end date and time is empty.
      //         If the function RegisterTimeInPage has been run before this test we get the stored values for date and time,
      //         else check that start date and time are not empty
      OPCTimeRegisterListL."OPC Time Register Subform".LAST;
      // [GIVEN] Start Time is registered
      IF (OPCTimeRegisterListL."OPC Time Register Subform"."End Date".VALUE <> '') OR (OPCTimeRegisterListL."OPC Time Register Subform"."Start Time".VALUE = '') THEN
      BEGIN
        OPCTimeRegisterListL."Register Time".INVOKE();
        OPCTimeRegisterListL."OPC Time Register Subform".LAST;
        LibraryVariableStorageG.Clear;
      END;
      IF LibraryVariableStorageG.Length > 0 THEN BEGIN
        StartTimeL := LibraryVariableStorageG.PeekTime(1);
        StartDateL := LibraryVariableStorageG.PeekDate(2);
        OPCTimeRegisterListL."OPC Time Register Subform"."Start Time".ASSERTEQUALS(StartTimeL);
        OPCTimeRegisterListL."OPC Time Register Subform"."Start Date".ASSERTEQUALS(TODAY);
      END ELSE BEGIN
        AssertG.AreNotEqual(0D, OPCTimeRegisterListL."OPC Time Register Subform"."Start Time".VALUE, '');
        AssertG.AreNotEqual('', OPCTimeRegisterListL."OPC Time Register Subform"."Start Time".VALUE, '');
        AssertG.AreNotEqual(0T, OPCTimeRegisterListL."OPC Time Register Subform"."Start Time".VALUE, '');
        AssertG.AreNotEqual('', OPCTimeRegisterListL."OPC Time Register Subform"."Start Time".VALUE, '');
      END;
      OPCTimeRegisterListL."OPC Time Register Subform"."End Date".ASSERTEQUALS(0D);
      OPCTimeRegisterListL."OPC Time Register Subform"."End Time".ASSERTEQUALS(0T);
      // [WHEN] The user clocks out (Register out time).
      StartTimeL := TIME;
      OPCTimeRegisterListL."Register Time".INVOKE();
      TimeL := TIME;
      // [THEN] Clocking out time is registered on the last line in the subform
      OPCTimeRegisterListL."OPC Time Register Subform"."End Date".ASSERTEQUALS(TODAY);
      EVALUATE(EndTimeL, OPCTimeRegisterListL."OPC Time Register Subform"."End Time".VALUE);
      DurationL := (TimeL - StartTimeL);
      IF DurationL < 1000 THEN
        DurationL := 1000;
      LibraryUtilityIncG.TimeAreNearlyEqual(StartTimeL, EndTimeL, DurationL, '');
      OPCTimeRegisterListL.CLOSE;
      OPCInformationBoardL.CLOSE;
    END;

    [Test]
    PROCEDURE UI_PostOutputOnOperationPage@1101103001();
    VAR
      OPCInformationBoardL@1101103000 : TestPage 83001;
      OPCTaskListL@1101103001 : TestPage 83002;
      OPCOutputRegistrationL@1101103008 : TestPage 83010;
      ProdOrderRoutingLineL@1101103007 : Record 5409;
      ProductionOrderL@1101103009 : Record 5405;
      TimeL@1101103002 : Time;
      StartTimeL@1101103003 : Time;
      EndTimeL@1101103005 : Time;
      StartDateL@1101103004 : Date;
      MachineCenterNoL@1101103006 : Code[10];
    BEGIN
      // [GIVEN] The page OPC Information Board" is open
      OPCInformationBoardL.OPENVIEW;
      // [GIVEN] The page "OPC Task List" is opened from Information Board
      OPCTaskListL.TRAP;
      OPCInformationBoardL.Tasks.INVOKE;
      // [GIVEN] Production Order exists
      // [GIVEN] Machine Center is marked as Show in OPC.
      OPCProductionOrderG.CreateProdOrder(ProductionOrderL);
      // [GIVEN] Production Order Routing Line is selected and exists
      ProdOrderRoutingLineL.SETRANGE("Prod. Order No.", ProductionOrderL."No.");
      ProdOrderRoutingLineL.SETRANGE(Status, ProdOrderRoutingLineL.Status::Released);
      ProdOrderRoutingLineL.SETRANGE(Type, ProdOrderRoutingLineL.Type::"Machine Center");
      LibraryOPCG.OPCGetRandomProdOrderRoutingLine(ProdOrderRoutingLineL);
      AssertG.RecordIsNotEmpty(ProdOrderRoutingLineL);
      // [GIVEN] Machine Center is selected and not empty. Get value from stored value or get random value.
      MachineCenterNoL := ProdOrderRoutingLineL."No.";
      AssertG.AreNotEqual('', MachineCenterNoL,'');
      OPCInformationBoardL.FILTER.SETFILTER("No.", MachineCenterNoL);
      OPCInformationBoardL."No.".ASSERTEQUALS(MachineCenterNoL);
      // [GIVEN] The page "OPC Output Registration" is opened from the page "OPC Task List"
      //OPCOutputRegistrationL.TRAP();
      OPCTaskListL.PostOutputItem.INVOKE();
      // The ModalPageHandler PostOutputModalPageHandler handles the posting of output
      OPCTaskListL.CLOSE;
      OPCInformationBoardL.CLOSE;
    END;

    BEGIN
    {
      // [FEATURE] [UI] [Manufacturing] [Production Order] [OPC]
      Tests for OPC Pages:
    }
    END.
  }
}

OBJECT Codeunit 91068 OPC Testing
{
  OBJECT-PROPERTIES
  {
    Date=11.10.17;
    Time=18:06:53;
    Modified=Yes;
    Version List=OPC6.01,TST1.01;
  }
  PROPERTIES
  {
    Subtype=Test;
    OnRun=BEGIN
            IsInitializedG := FALSE;
          END;

  }
  CODE
  {
    VAR
      LibraryVariableStorageG@1101103000 : Codeunit 131004;
      LibraryManufacturingG@1101103002 : Codeunit 132202;
      LibraryInventoryG@1101103006 : Codeunit 132201;
      LibraryWarehouseG@1101103010 : Codeunit 132204;
      LibraryCostingG@1101103008 : Codeunit 132200;
      LibraryRandomG@1101103003 : Codeunit 130440;
      AssertG@1101103007 : Codeunit 130000;
      ErrorNoPurchLine@1101103045 : TextConst 'ENU=No purchase line has been found for item %1.';
      ErrorNoEntryFound@1101103044 : TextConst 'ENU=No value entry found for item %1 of type %2.';
      ErrorWrongCost@1101103043 : TextConst 'ENU=Cost per unit should be %1 (2 decimals) for item %2.';
      ErrorWrongTotal@1101103042 : TextConst 'ENU=Total cost for value entries should be %1 for item %2.';
      ErrorValueEntries@1101103041 : TextConst 'ENU=Expected %1 entries of ILE Type: %2, Entry Type: %3, Document Type: %4 for item %5.';
      ErrorValueEntry@1101103040 : TextConst 'ENU="Value mismatch in value entry %1, field %2. "';
      ErrorZeroQty@1101103039 : TextConst 'ENU=Transfer Qty should not be 0.';
      DummyMessage@1101103038 : TextConst 'ENU=Message?';
      ItemDeletionErr@1101103037 : TextConst '@@@="%1= Item.TABLECAPTION,%2= Item.No,%3=Planning Component.TABLECAPTION";ENU=You cannot delete %1 %2 because there is at least one %3 that includes this item.';
      LibraryProductionIncG@1101103004 : Codeunit 91062;
      LibraryOPCG@1101103009 : Codeunit 91061;
      OPCProductionOrderG@1101103005 : Codeunit 91064;
      LibraryOPCPagesG@1101103011 : Codeunit 91066;
      IsInitializedG@1101103001 : Boolean;

    LOCAL PROCEDURE Initialize@6();
    VAR
      LibraryERMCountryData@1000 : Codeunit 131305;
    BEGIN
      LibraryVariableStorageG.Clear;
      IF IsInitializedG THEN
        EXIT;

      //LibraryERMCountryData.UpdateGeneralPostingSetup;
      //LibraryERMCountryData.CreateVATData;
      LibraryProductionIncG.CreateLocationSetup();
      LibraryProductionIncG.ItemJournalSetup('', '');
      LibraryProductionIncG.ConsumptionJournalSetup('', '');
      LibraryProductionIncG.OutputJournalSetup('', '');
      LibraryProductionIncG.ManufacturingSetup();
      LibraryOPCG.OPCSetup();
      COMMIT;

      IsInitializedG := TRUE
    END;

    [ConfirmHandler]
    PROCEDURE ConfirmHandler@19(Question@1000 : Text[1024];VAR Reply@1001 : Boolean);
    BEGIN
      Reply := TRUE;
    END;

    [MessageHandler]
    PROCEDURE MessageHandler@10(Message@1000 : Text[1024]);
    BEGIN
    END;

    [ModalPageHandler]
    PROCEDURE PostOutputModalPageHandler@182(VAR OPCOutputRegistrationP@1101103000 : TestPage 83010);
    VAR
      ProductionOrderL@1101103002 : Record 5405;
      QuantityL@1101103001 : Decimal;
      MaxQtyL@1101103003 : Decimal;
    BEGIN
      ProductionOrderL.SETRANGE("No.", OPCOutputRegistrationP."Prod Order No".VALUE());
      ProductionOrderL.FINDFIRST;
      // 1.2.3.1.Angi antall som er ferdig produsert.
      MaxQtyL := ROUND(ProductionOrderL.Quantity, 1, '<');
      QuantityL := LibraryRandomG.RandIntInRange(1, MaxQtyL);
      OPCOutputRegistrationP."Output Quantity".VALUE := FORMAT(QuantityL);
      OPCOutputRegistrationP.OK.INVOKE;
    END;

    LOCAL PROCEDURE ExecuteUIHandlers@1101103002();
    BEGIN
      MESSAGE('');
      IF CONFIRM(DummyMessage) THEN ;
    END;

    [Test]
    PROCEDURE OPCSetup@1101103006();
    VAR
      SCMProductionOrdersL@1101103000 : Codeunit 137069;
      TempManufacturingSetupL@1101103001 : TEMPORARY Record 99000765;
      TempSalesReceivablesSetupL@1101103002 : TEMPORARY Record 311;
      ProductionOrderL@1101103003 : Record 5405;
      MachineCenterL@1101103004 : Record 99000758;
      WorkCenterL@1101103005 : Record 99000754;
    BEGIN
      // [FEATURE] [Manufacturing] [Production Order] [OPC]
      // [SCENARIO 1.] Test Case OPC Setup
      LibraryOPCG.OPCSetup();
    END;

    [Test]
    PROCEDURE CreateMachineCenter@1101103000();
    VAR
      SCMProductionOrdersL@1101103000 : Codeunit 137069;
      TempManufacturingSetupL@1101103001 : TEMPORARY Record 99000765;
      TempSalesReceivablesSetupL@1101103002 : TEMPORARY Record 311;
      ProductionOrderL@1101103003 : Record 5405;
      MachineCenterL@1101103004 : Record 99000758;
      WorkCenterL@1101103005 : Record 99000754;
    BEGIN
      Initialize;
      LibraryManufacturingG.CreateWorkCenter(WorkCenterL);
      LibraryManufacturingG.CreateMachineCenter(MachineCenterL, WorkCenterL."No.", LibraryRandomG.RandDec(100,2));
    END;

    [Test]
    [HandlerFunctions(MessageHandler)]
    PROCEDURE CreateProductionOrder@1101103008();
    VAR
      SCMProductionOrdersL@1101103000 : Codeunit 137069;
      TempManufacturingSetupL@1101103001 : TEMPORARY Record 99000765;
      TempSalesReceivablesSetupL@1101103002 : TEMPORARY Record 311;
      ProductionOrderL@1101103003 : Record 5405;
      MachineCenterL@1101103004 : Record 99000758;
      WorkCenterL@1101103005 : Record 99000754;
    BEGIN
      // [FEATURE] [Manufacturing] [Production Order] [OPC]
      // [SCENARIO 9.] Test Case Create Production Order
      OPCProductionOrderG.CreateProdOrder(ProductionOrderL);
    END;

    [Test]
    PROCEDURE UI_OPCRegisterTimeIn@1101103003();
    BEGIN
      // [FEATURE] [Manufacturing] [Production Order] [OPC]
      // [SCENARIO 13.] Test Case Register Time In
      LibraryOPCPagesG.UI_RegisterTimeInPage();
    END;

    [Test]
    PROCEDURE UI_OPCRegisterTimeOut@1101103010();
    BEGIN
      // [FEATURE] [Manufacturing] [Production Order] [OPC]
      // [SCENARIO 14.] Test Case Register Time Out
      LibraryOPCPagesG.UI_RegisterTimeOutPage();
    END;

    [Test]
    [HandlerFunctions(MessageHandler,PostOutputModalPageHandler)]
    PROCEDURE UI_OPCPostOutputOnOperation@1101103009();
    BEGIN
      // [FEATURE] [Manufacturing] [Production Order] [OPC]
      // [SCENARIO 18.] Test Case Post Output on Production Operation
      Initialize();
      LibraryOPCPagesG.UI_PostOutputOnOperationPage();
    END;

    [Test]
    [HandlerFunctions(MessageHandler,PostOutputModalPageHandler)]
    PROCEDURE UI_OPCRegisterTimInPostOutputRegisterOut@1101103001();
    VAR
      ProductionOrderL@1101103000 : Record 5405;
    BEGIN
      // [FEATURE] [Manufacturing] [Production Order] [OPC]
      // [SCENARIO 19.] Test Case Register Time In, Post Output on Production Operation and Register Time Out
      // [GIVEN] OPC Setup is configured
      Initialize();
      OPCSetup();
      // [GIVEN] Production Order Exists
      OPCProductionOrderG.CreateProdOrder(ProductionOrderL);
      // [GIVEN] User has Register Time In
      LibraryOPCPagesG.UI_RegisterTimeInPage();
      // [GIVEN] User has Posted Output on Production Operation
      LibraryOPCPagesG.UI_PostOutputOnOperationPage();
      // [GIVEN] User has Register Time Out
      LibraryOPCPagesG.UI_RegisterTimeOutPage();
    END;

    [Test]
    PROCEDURE RegisterTimeInOut@1101103005();
    VAR
      MachineCenterNoL@1101103000 : Code[20];
      StartDateL@1101103001 : Date;
      StartTimeL@1101103002 : Time;
      EndDateL@1101103004 : Date;
      EndTimeL@1101103003 : Time;
    BEGIN
      // [FEATURE] [Manufacturing] [OPC]
      // [SCENARIO 13.] Test Case Create Production Order
      // [GIVEN] Machine Center is selected and not empty
      MachineCenterNoL := LibraryOPCG.OPCGetRandomMachineCenterClocking();
      AssertG.AreNotEqual('', MachineCenterNoL,'');
      //GIVEN Start date and time
      StartDateL := TODAY;
      StartTimeL := 080000T;
      //GIVEN End date and time
      EndDateL := TODAY;
      EndTimeL := 160000T;
      //GIVEN User is not clocked in
      LibraryOPCG.CheckRegisterTimeIn(MachineCenterNoL, (StartDateL - 1), 235900T);
      // [WHEN] The user clocks in (Register time) and the user has not been registered in for the day.
      LibraryOPCG.OPCRegisterTimeInOut(MachineCenterNoL, StartDateL, StartTimeL);
      // [THEN] Clocking in time is registered.
      LibraryOPCG.VerifyRegisterTimeInLine(MachineCenterNoL, StartDateL, StartTimeL);
      // [WHEN] The user clocks out (Register time) and the user has been registered in for the day.
      LibraryOPCG.OPCRegisterTimeInOut(MachineCenterNoL, EndDateL, EndTimeL);
      // [THEN] Clocking out time is registered.
      LibraryOPCG.VerifyRegisterTimeOutLine(MachineCenterNoL, StartDateL, StartTimeL, EndDateL, EndTimeL);
      // [THEN] Deducting lunch time is registered.
      LibraryOPCG.VerifyRegisterTimeOutDeductLunch(MachineCenterNoL, StartDateL, StartTimeL, EndDateL, EndTimeL);
    END;

    [Test]
    [HandlerFunctions(MessageHandler)]
    PROCEDURE RegisterTimeInTaskOut@1101103004();
    VAR
      ProdOrderRoutingLineL@1101103005 : Record 5409;
      OPCRunTimesL@1101103009 : Record 83010;
      OPCRunTimesVerifyL@1101103012 : Record 83010;
      MachineCenterL@1101103008 : Record 99000758;
      CapacityLedgerEntryL@1101103013 : Record 5832;
      ClockingRunTimesMgtL@1101103011 : Codeunit 83002;
      MachineCenterNoL@1101103000 : Code[20];
      StartDateL@1101103001 : Date;
      StartTimeL@1101103002 : Time;
      EndDateL@1101103004 : Date;
      EndTimeL@1101103003 : Time;
      IndirectTimeStartL@1101103006 : Time;
      IndirectTimeCodeL@1101103007 : Code[15];
      TaskStartTimeL@1101103010 : Time;
    BEGIN
      // [FEATURE] [Manufacturing] [OPC]
      // [SCENARIO 13.] Test Case Create Production Order
      Initialize();
      // [GIVEN] Start date and time
      StartDateL := TODAY;
      //StartDateL := CALCDATE('<CD+7D>', TODAY);
      StartTimeL := 080000T;
      // [GIVEN] End date and time
      EndDateL := StartDateL;
      EndTimeL := 160000T;
      // [GIVEN] Start time for indirect time
      IndirectTimeStartL := 081000T;
      //[GIVEN] Start time for task time
      TaskStartTimeL := 090000T;
      // [GIVEN] Machine Center is selected and not empty
      MachineCenterNoL := LibraryOPCG.OPCGetRandomMachineCenterClocking();
      AssertG.AreNotEqual('', MachineCenterNoL,'');
      MachineCenterL.SETRANGE(Clocking, TRUE);
      MachineCenterL.FINDFIRST;
      // Register all employee in to work
      REPEAT
        MachineCenterNoL := MachineCenterL."No.";
        // [GIVEN] User is not clocked in
        LibraryOPCG.CheckRegisterTimeIn(MachineCenterNoL, (StartDateL - 1), 235900T);
        // [GIVEN]  The user clocks in (Register time) and the user has not been registered in for the day.
        LibraryOPCG.OPCRegisterTimeInOut(MachineCenterNoL, StartDateL, StartTimeL);
        // [GIVEN] Clocking in time is registered.
        LibraryOPCG.VerifyRegisterTimeInLine(MachineCenterNoL, StartDateL, StartTimeL);
        // [GIVEN] Machine Center has registered start time on indirect time code
        LibraryOPCG.OPCRegisterTimeOnIndirectTime(IndirectTimeCodeL, MachineCenterNoL, StartDateL, IndirectTimeStartL, 0D, 0T);
        // [THEN] Machine Center is registered out of indirect time code
        LibraryOPCG.VerifyRunTimesIndirectTime(MachineCenterNoL, StartDateL, IndirectTimeStartL, IndirectTimeCodeL);
      UNTIL MachineCenterL.NEXT = 0;
      MachineCenterL.RESET;
      MachineCenterL.SETRANGE(Clocking, TRUE);
      MachineCenterL.FINDFIRST;
      // Register all employee on indirect time
      REPEAT
        MachineCenterNoL := MachineCenterL."No.";
        // [GIVEN] Production Order Route Line is selected
        ProdOrderRoutingLineL.SETRANGE(Status, ProdOrderRoutingLineL.Status::Released);
        LibraryOPCG.OPCGetRandomProdOrderRoutingLine(ProdOrderRoutingLineL);
        // [WHEN] Machine Center is registered on Production Order Operation
        LibraryOPCG.OPCRegisterTimeOnTask(ProdOrderRoutingLineL, OPCRunTimesL, MachineCenterNoL, StartDateL, TaskStartTimeL, 0D, 0T, 0, 0, '', '');
        // [THEN] Machine Center is registered out of indirect time code
        LibraryOPCG.VerifyRunTimesTaskTime(ProdOrderRoutingLineL,MachineCenterNoL, StartDateL, TaskStartTimeL);
      UNTIL MachineCenterL.NEXT = 0;
      MachineCenterL.RESET;
      MachineCenterL.SETRANGE(Clocking, TRUE);
      MachineCenterL.FINDFIRST;
      OPCRunTimesL.RESET;
      OPCRunTimesL.SETFILTER("Starting Date", '<>%1', 0D);
      OPCRunTimesL.SETFILTER("Starting Time", '<>%1', 0T);
      OPCRunTimesL.SETRANGE(Posted, FALSE);
      OPCRunTimesL.FINDFIRST;
      // Register all employee out off work
      REPEAT
        //MachineCenterNoL := MachineCenterL."No.";
        MachineCenterNoL := OPCRunTimesL."Machine Center";
        // [WHEN] The user clocks out (Register time) and the user has been registered in for the day.
        LibraryOPCG.OPCRegisterTimeInOut(MachineCenterNoL, EndDateL, EndTimeL);
        // [THEN] Clocking out time is registered.
        LibraryOPCG.VerifyRegisterTimeOutLine(MachineCenterNoL, StartDateL, StartTimeL, EndDateL, EndTimeL);
        // [THEN] Deducting lunch time is registered.
        LibraryOPCG.VerifyRegisterTimeOutDeductLunch(MachineCenterNoL, StartDateL, StartTimeL, EndDateL, EndTimeL);
        // [THEN] Capacity Ledger Entries line has been added for the Production Order Operation
        CapacityLedgerEntryL.RESET;
        OPCRunTimesVerifyL.GET(OPCRunTimesL."Entry No.");
        LibraryOPCG.VerifyCapacityLedgerEntriesFromRunTimes(CapacityLedgerEntryL, OPCRunTimesVerifyL);
        // [WHEN] Capacity Ledger Entry is corrected
        LibraryOPCG.OPCCorrectCapacityEntry(CapacityLedgerEntryL);
        // [THEN] Capacity Ledger Entries line has been added with reverse quantity
        LibraryOPCG.VerifyCapacityLedgerEntriesCorrection(CapacityLedgerEntryL);
      UNTIL OPCRunTimesL.NEXT = 0;
    END;

    [Test]
    PROCEDURE CorrectCapacityLedgerEntry@1101103007();
    VAR
      CapacityLedgerEntryL@1101103000 : Record 5832;
    BEGIN
      // [GIVEN] Capacity Ledger Entry is selected
      CapacityLedgerEntryL.SETRANGE("Order Type",  CapacityLedgerEntryL."Order Type"::Production);
      CapacityLedgerEntryL.SETFILTER("Order No.", '<>%1', '');
      CapacityLedgerEntryL.SETFILTER("Routing No.", '<>%1', '');
      CapacityLedgerEntryL.SETRANGE(Type, CapacityLedgerEntryL.Type::"Machine Center");
      CapacityLedgerEntryL.SETFILTER("No.", '<>%1', '');
      CapacityLedgerEntryL.SETFILTER("Operation No.", '<>%1', '');
      CapacityLedgerEntryL.SETFILTER("Starting Time", '<>%1', 0T);
      CapacityLedgerEntryL.SETFILTER("Ending Time", '<>%1', 0T);
      CapacityLedgerEntryL.SETFILTER("Posting Date", '<>%1', 0D);
      CapacityLedgerEntryL.SETFILTER(Quantity, '<>%1', 0);
      CapacityLedgerEntryL.SETFILTER("Run Time", '<>%1', 0);
      IF CapacityLedgerEntryL.FINDFIRST THEN BEGIN
        // [WHEN] Capacity Ledger Entry is corrected
        LibraryOPCG.OPCCorrectCapacityEntry(CapacityLedgerEntryL);
        // [THEN] Capacity Ledger Entries line has been added with reverse quantity
        LibraryOPCG.VerifyCapacityLedgerEntriesCorrection(CapacityLedgerEntryL);
      END;
    END;

    BEGIN
    {
      // [FEATURE] [Manufacturing] [Production Order] [OPC]
      Tests for OPC:
    }
    END.
  }
}

OBJECT Codeunit 91090 Testing Customer Data
{
  OBJECT-PROPERTIES
  {
    Date=28.09.17;
    Time=20:17:12;
    Modified=Yes;
    Version List=TST1.01,OPC6.01;
  }
  PROPERTIES
  {
    OnRun=BEGIN
            CloseAllOPCTimeRegister();
          END;

  }
  CODE
  {
    VAR
      LibraryProductionIncG@1101103000 : Codeunit 91062;
      LibraryOPCG@1101103001 : Codeunit 91061;
      ClockingMgtG@1101103002 : Codeunit 83001;

    [Normal]
    PROCEDURE ManufacturingSetup@14();
    VAR
      ManufacturingSetupL@1101103001 : Record 99000765;
      DateFormulaL@1101103000 : DateFormula;
    BEGIN
      //Numbering
      LibraryProductionIncG.NoSeriesSetupManufacturing();

      ManufacturingSetupL.GET;
      //General
      // Values used are important for test.
      ManufacturingSetupL.VALIDATE("Normal Starting Time",070000T);
      ManufacturingSetupL.VALIDATE("Normal Ending Time",153000T);
      ManufacturingSetupL.VALIDATE("Preset Output Quantity", ManufacturingSetupL."Preset Output Quantity"::"Zero on All Operations");
      ManufacturingSetupL.VALIDATE("Planning Warning", TRUE);
      ManufacturingSetupL.VALIDATE("Doc. No. Is Prod. Order No.", TRUE);
      ManufacturingSetupL.VALIDATE("Dynamic Low-Level Code", TRUE);
      ManufacturingSetupL.VALIDATE("Cost Incl. Setup", TRUE);
      //Planning
      ManufacturingSetupL.VALIDATE("Use Forecast on Locations", TRUE);
      EVALUATE(DateFormulaL, '<3D>');
      ManufacturingSetupL.VALIDATE("Default Safety Lead Time", DateFormulaL);
      LibraryProductionIncG.LocationSetup('001');
      ManufacturingSetupL.VALIDATE("Components at Location", '001');
      //Planlegginsbilde (Customized OPC?)
      ManufacturingSetupL.VALIDATE("Start status planlegging", ManufacturingSetupL."Start status planlegging"::Released);
      ManufacturingSetupL.MODIFY(TRUE);
      ManufacturingSetupL.VALIDATE(Retning, ManufacturingSetupL.Retning::Bakover);
      ManufacturingSetupL.VALIDATE("Std. Lokasjon", '001');
      //AS oppsett (Customized OPC?)
      LibraryProductionIncG.ItemJournalSetup('VARE', 'KORRVIA');
      ManufacturingSetupL.VALIDATE("Undo Via Item Journal Template", 'VARE');
      ManufacturingSetupL.VALIDATE("Undo Via Item Journal Name", 'KORRVIA');
      LibraryProductionIncG.ConsumptionJournalSetup('FORBRUK', 'STANDARD');
      ManufacturingSetupL.VALIDATE("Undo Consumption Template", 'FORBRUK');
      ManufacturingSetupL.VALIDATE("Undo Consumption Journal", 'STANDARD');

      ManufacturingSetupL.MODIFY(TRUE);
    END;

    LOCAL PROCEDURE CorrectCapasityLedgerEntry@1101103000();
    VAR
      CapacityLedgerEntryL@1101103000 : Record 5832;
    BEGIN
      // [GIVEN] Capacity Ledger Entry is selected
      CapacityLedgerEntryL.SETRANGE("Order Type",  CapacityLedgerEntryL."Order Type"::Production);
      CapacityLedgerEntryL.SETFILTER("Order No.", '<>%1', '');
      CapacityLedgerEntryL.SETFILTER("Routing No.", '<>%1', '');
      CapacityLedgerEntryL.SETRANGE(Type, CapacityLedgerEntryL.Type::"Machine Center");
      CapacityLedgerEntryL.SETFILTER("No.", '<>%1', '');
      CapacityLedgerEntryL.SETFILTER("Operation No.", '<>%1', '');
      CapacityLedgerEntryL.SETFILTER("Starting Time", '<>%1', 0T);
      CapacityLedgerEntryL.SETFILTER("Ending Time", '<>%1', 0T);
      CapacityLedgerEntryL.SETFILTER("Posting Date", '<>%1', 0D);
      CapacityLedgerEntryL.SETFILTER(Quantity, '<>%1', 0);
      CapacityLedgerEntryL.SETFILTER("Run Time", '<>%1', 0);
      CapacityLedgerEntryL.FINDFIRST;
      // [WHEN] Capacity Ledger Entry is corrected
      LibraryOPCG.OPCCorrectCapacityEntry(CapacityLedgerEntryL);
      // [THEN] Capacity Ledger Entries line has been added with reverse quantity
      //LibraryOPCG.VerifyCapacityLedgerEntriesCorrection(CapacityLedgerEntryL);
    END;

    LOCAL PROCEDURE CloseAllOPCTimeRegister@1101103001();
    VAR
      OPCTimeRegisterL@1101103000 : Record 83007;
      MachineCenterL@1101103001 : Record 99000758;
    BEGIN
      MachineCenterL.SETRANGE(Clocking, TRUE);
      MachineCenterL.FINDFIRST;
      REPEAT
        ClockingMgtG.SetTimeRegisterFilterWithoutEndTime(OPCTimeRegisterL, MachineCenterL."No.");
        IF OPCTimeRegisterL.FINDFIRST THEN BEGIN
          OPCTimeRegisterL.VALIDATE("End Date", OPCTimeRegisterL."Start Date");
          OPCTimeRegisterL.VALIDATE("End Time", 160000T);
          OPCTimeRegisterL.MODIFY(TRUE);
        END;
      UNTIL MachineCenterL.NEXT = 0;
    END;

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 18.08.17 JAL Customer data customization
    }
    END.
  }
}

OBJECT MenuSuite 1054 Dept OPC
{
  OBJECT-PROPERTIES
  {
    Date=02.11.17;
    Time=09:11:36;
    Modified=Yes;
    Version List=OPC6.01;
  }
  PROPERTIES
  {
  }
  MENUNODES
  {
    {                ;[{8B53F309-FB1D-47BA-A2FE-1460E0D5ECDB}] ;NextNodeID=[{7D84E2C7-9D7A-4DA2-87C1-DDBB9435B63C}] }
    { MenuItem       ;[{7D84E2C7-9D7A-4DA2-87C1-DDBB9435B63C}] ;Name=Item Tracking Codes;
                                                                CaptionML=[ENU=Item Tracking Codes;
                                                                           NOR=Varesporingskoder];
                                                                RunObjectType=Page;
                                                                RunObjectID=6502;
                                                                Visible=Yes;
                                                                DepartmentCategory=Lists }
    { MenuItem       ;[{49448471-4DCE-4BAC-B6A9-BD8614D01A48}] ;Name=Transfer Routes;
                                                                CaptionML=[ENU=Transfer Routes;
                                                                           NOR=Overf›ringsruter];
                                                                RunObjectType=Page;
                                                                RunObjectID=5747;
                                                                Visible=Yes;
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{81D2CE2C-6499-43ED-9A0B-398248B6B87B}] ;Name=Item Journal Templates;
                                                                CaptionML=[ENU=Item Journal Templates;
                                                                           NOR=Varekladdemaler];
                                                                RunObjectType=Page;
                                                                RunObjectID=102;
                                                                Visible=Yes;
                                                                DepartmentCategory=Lists }
    { MenuItem       ;[{7CEA59FF-A695-44FD-A274-BF6178760FD7}] ;Name=Report Selections Inventory;
                                                                CaptionML=[ENU=Report Selections Inventory;
                                                                           NOR=Rapportvalg - beholdning];
                                                                RunObjectType=Page;
                                                                RunObjectID=5754;
                                                                Visible=Yes;
                                                                NextNodeID=[{00000000-0000-0000-0000-000000000000}];
                                                                DepartmentCategory=Tasks }
    {                ;[{502E3FFC-A7CC-48F7-88A4-89A841F0C628}] ;NextNodeID=[{F17F96B7-D5DF-4C82-B90E-D172A36E4942}] }
    { MenuItem       ;[{F17F96B7-D5DF-4C82-B90E-D172A36E4942}] ;Name=Incoming Documents Setup;
                                                                CaptionML=[ENU=Incoming Documents Setup;
                                                                           NOR=Oppsett for inng†ende dokumenter];
                                                                ApplicationArea=#Suite;
                                                                RunObjectType=Page;
                                                                RunObjectID=191;
                                                                Visible=Yes;
                                                                DepartmentCategory=Tasks }
    {                ;[{BAD8AF38-254A-4266-AF07-EDC55674B5FA}] ;NextNodeID=[{A2E2F2F9-5AB0-4C65-9A60-F9BAE2B24023}] }
    { MenuItem       ;[{A2E2F2F9-5AB0-4C65-9A60-F9BAE2B24023}] ;Name=VAT Clauses;
                                                                CaptionML=[ENU=VAT Clauses;
                                                                           NOR=Mva-setninger];
                                                                ApplicationArea=#Basic,#Suite;
                                                                RunObjectType=Page;
                                                                RunObjectID=747;
                                                                Visible=Yes;
                                                                DepartmentCategory=Administration }
    {                ;[{9474DF8C-B0E7-4FED-AF54-367E0639F7B0}] ;NextNodeID=[{C68C0462-288A-42CC-8BC7-6F224D8846CE}] }
    { MenuItem       ;[{C68C0462-288A-42CC-8BC7-6F224D8846CE}] ;Name=VAT Clauses;
                                                                CaptionML=[ENU=VAT Clauses;
                                                                           NOR=Mva-setninger];
                                                                ApplicationArea=#Basic,#Suite;
                                                                RunObjectType=Page;
                                                                RunObjectID=747;
                                                                Visible=Yes;
                                                                DepartmentCategory=Tasks }
    {                ;[{44DC36A4-3D38-427C-B37D-02811193E52A}] ;NextNodeID=[{E0433AFB-5B38-4E2F-ADE7-0317B7ADE93D}] }
    { MenuItem       ;[{E0433AFB-5B38-4E2F-ADE7-0317B7ADE93D}] ;Name=Application Area;
                                                                CaptionML=[ENU=Application Area;
                                                                           NOR=Modul];
                                                                ApplicationArea=#All;
                                                                RunObjectType=Page;
                                                                RunObjectID=9179;
                                                                Visible=Yes;
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{9CBA63AC-73D3-438F-818D-476B76D5DB75}] ;Name=Data Exchange Definition;
                                                                CaptionML=[ENU=Data Exchange Definitions;
                                                                           NOR=Datautvekslingsdefinisjoner];
                                                                ApplicationArea=#Basic,#Suite;
                                                                RunObjectType=Page;
                                                                RunObjectID=1211;
                                                                Visible=Yes;
                                                                DepartmentCategory=Lists }
    { MenuItem       ;[{BB2D12FC-2EEB-4165-869B-098BBB42C6F6}] ;Name=Bank Export/Import Setup;
                                                                CaptionML=[ENU=Bank Export/Import Setup;
                                                                           NOR=Konfigurasjon av bankeksport/-import];
                                                                ApplicationArea=#Basic,#Suite;
                                                                RunObjectType=Page;
                                                                RunObjectID=1200;
                                                                Visible=Yes;
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{C0BECAC0-F100-4C39-BBCA-714333A54406}] ;Name=SEPA Schema Viewer;
                                                                CaptionML=[ENU=SEPA Schema Viewer;
                                                                           NOR=Visningsprogram for SEPA-skjema];
                                                                ApplicationArea=#Basic,#Suite;
                                                                RunObjectType=Page;
                                                                RunObjectID=9610;
                                                                Visible=Yes;
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{7FD6154D-F047-4A31-B857-0DA1E0BA97D8}] ;Name=XML Schemas;
                                                                CaptionML=[ENU=XML Schemas;
                                                                           NOR=XML-skjemaer];
                                                                ApplicationArea=#Basic,#Suite;
                                                                RunObjectType=Page;
                                                                RunObjectID=9600;
                                                                Visible=Yes;
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{E55ED739-BBB9-4063-AF58-225E99C5FE72}] ;Name=Document Sending Profiles;
                                                                CaptionML=[ENU=Document Sending Profiles;
                                                                           NOR=Profiler for dokumentsending];
                                                                ApplicationArea=#Basic,#Suite;
                                                                RunObjectType=Page;
                                                                RunObjectID=359;
                                                                Visible=Yes;
                                                                DepartmentCategory=Lists }
    { MenuItem       ;[{379BBC3B-5EBB-4617-8419-8D76352F8337}] ;Name=Electronic Document Formats;
                                                                CaptionML=[ENU=Electronic Document Formats;
                                                                           NOR=Elektroniske dokumentformater];
                                                                ApplicationArea=#Suite;
                                                                RunObjectType=Page;
                                                                RunObjectID=363;
                                                                Visible=Yes;
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{8A3934DD-BE0A-4851-B8E0-50A64106B98A}] ;Name=Data Exchange Types;
                                                                CaptionML=[ENU=Data Exchange Types;
                                                                           NOR=Datautvekslingstyper];
                                                                ApplicationArea=#Basic,#Suite;
                                                                RunObjectType=Page;
                                                                RunObjectID=1213;
                                                                Visible=Yes;
                                                                DepartmentCategory=Administration }
    { MenuItem       ;[{0D3D0EB4-59D7-4D3E-95AC-49CD269C6C04}] ;Name=Data Migration Settings;
                                                                AccessByPermission=TableData 1806=R;
                                                                CaptionML=[ENU=Data Migration Settings;
                                                                           NOR=Innstillinger for datamigrering];
                                                                ApplicationArea=#Basic,#Suite;
                                                                RunObjectType=Page;
                                                                RunObjectID=1807;
                                                                Visible=Yes;
                                                                DepartmentCategory=Administration }
    { MenuItem       ;[{00646221-3EEF-4883-8640-FECFD9BEC705}] ;Name=Report Configuration;
                                                                AccessByPermission=TableData 2000000196=IMD;
                                                                CaptionML=[ENU=Report Settings;
                                                                           NOR=Rapportinnstillinger];
                                                                ApplicationArea=#Basic,#Suite;
                                                                RunObjectType=Page;
                                                                RunObjectID=1560;
                                                                Visible=Yes;
                                                                DepartmentCategory=Administration }
    { MenuItem       ;[{A1E3A413-B0C4-4D20-8B1F-AFF7DFFDB43C}] ;Name=Setup and Help Resources;
                                                                CaptionML=[ENU=Setup and Help Resources;
                                                                           NOR=Ressurser for oppsett og hjelp];
                                                                ApplicationArea=#Basic,#Suite;
                                                                RunObjectType=Page;
                                                                RunObjectID=1822;
                                                                Visible=Yes;
                                                                NextNodeID=[{4D3D68E9-6A4A-4F4A-8D33-747D76821EC8}];
                                                                DepartmentCategory=Administration }
    {                ;[{387B2D8D-4249-4D63-BE9C-850416EA6E81}] ;NextNodeID=[{34E4BEA4-29EB-4579-8568-973A8449A4A1}] }
    { MenuItem       ;[{34E4BEA4-29EB-4579-8568-973A8449A4A1}] ;Name=Certificates of Supply;
                                                                CaptionML=[ENU=Certificates of Supply;
                                                                           NOR=Mottaksdeklarasjoner];
                                                                RunObjectType=Page;
                                                                RunObjectID=780;
                                                                Visible=Yes;
                                                                NextNodeID=[{3E2FEC16-BE73-41A6-94E5-BAFFDE0CFB12}];
                                                                DepartmentCategory=Lists }
    {                ;[{A07A2127-D15F-4AF6-8301-EC0DA819FAE6}] ;NextNodeID=[{B0697E0F-6AD6-425A-9E5C-F0BD41F9BC72}] }
    { MenuGroup      ;[{B0697E0F-6AD6-425A-9E5C-F0BD41F9BC72}] ;Name=New Group;
                                                                CaptionML=[ENU=Employee Portal;
                                                                           NOR=Employee Portal];
                                                                Visible=Yes }
    { Menu           ;[{6A1856B5-E3EC-406B-80EB-05C5EF4631BD}] ;Name=OPC;
                                                                CaptionML=[ENU=Online Production Control;
                                                                           NOR=Online produksjonskontroll];
                                                                MemberOfMenu=[{6A1856B5-E3EC-406B-80EB-05C5EF4631BD}];
                                                                ParentNodeID=[{00000000-0000-0000-0000-000000000000}];
                                                                Image=12;
                                                                IsShortcut=No;
                                                                Visible=Yes;
                                                                Enabled=Yes;
                                                                NextNodeID=[{7D7FE6BF-817A-4E6B-AB93-BEBEE1AA2C1C}];
                                                                FirstChild=[{DB86519A-3B17-46EE-87CF-033D4EC9D288}] }
    { MenuItem       ;[{0983E9E7-CD0C-4216-8ADC-CEE0B6FB86C2}] ;Name=OPC - informasjonssentral;
                                                                CaptionML=[ENU=OPC Information Board;
                                                                           NOR=OPC Informasjonssentral];
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{6A1856B5-E3EC-406B-80EB-05C5EF4631BD}];
                                                                RunObjectType=Page;
                                                                RunObjectID=83001;
                                                                ParentNodeID=[{DB86519A-3B17-46EE-87CF-033D4EC9D288}];
                                                                Visible=Yes;
                                                                NextNodeID=[{CCF7B636-C0E0-4C21-871A-7A78E2E832E8}];
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{4C955B3D-9D98-4D1F-A64C-5F05C16BF56E}] ;Name=OPC - ressursstatus;
                                                                CaptionML=[ENU=OPC Resource Status;
                                                                           NOR=OPC Produksjonsressursstatus];
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{6A1856B5-E3EC-406B-80EB-05C5EF4631BD}];
                                                                RunObjectType=Page;
                                                                RunObjectID=83020;
                                                                ParentNodeID=[{DB86519A-3B17-46EE-87CF-033D4EC9D288}];
                                                                Visible=Yes;
                                                                NextNodeID=[{2223B645-39D8-43D5-958A-349B46BFE9B9}];
                                                                DepartmentCategory=Lists }
    { MenuItem       ;[{2223B645-39D8-43D5-958A-349B46BFE9B9}] ;Name=OPC Frigitt produksjonsordre;
                                                                CaptionML=[ENU=OPC Released Production Orders;
                                                                           NOR=OPC Frigitte produksjonsordrer];
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{6A1856B5-E3EC-406B-80EB-05C5EF4631BD}];
                                                                RunObjectType=Page;
                                                                RunObjectID=83043;
                                                                ParentNodeID=[{DB86519A-3B17-46EE-87CF-033D4EC9D288}];
                                                                Visible=Yes;
                                                                NextNodeID=[{2E10244B-64EA-4054-95BF-2060226BF3E8}];
                                                                DepartmentCategory=Lists }
    { MenuItem       ;[{D5029A82-7436-42FC-B6AC-7A6C6A094315}] ;Name=Vareoversikt;
                                                                CaptionML=[ENU=Item List;
                                                                           NOR=Vareoversikt];
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{6A1856B5-E3EC-406B-80EB-05C5EF4631BD}];
                                                                RunObjectType=Page;
                                                                RunObjectID=31;
                                                                ParentNodeID=[{DB86519A-3B17-46EE-87CF-033D4EC9D288}];
                                                                Visible=Yes;
                                                                NextNodeID=[{1DFFFF31-23F5-4194-A005-300E32167653}];
                                                                DepartmentCategory=Lists }
    { MenuItem       ;[{2E10244B-64EA-4054-95BF-2060226BF3E8}] ;Name=OPC M›nstringsliste;
                                                                CaptionML=[ENU=OPC Time Register List;
                                                                           NOR=M›nstringsliste];
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{6A1856B5-E3EC-406B-80EB-05C5EF4631BD}];
                                                                RunObjectType=Page;
                                                                RunObjectID=83017;
                                                                ParentNodeID=[{DB86519A-3B17-46EE-87CF-033D4EC9D288}];
                                                                Visible=Yes;
                                                                NextNodeID=[{D5029A82-7436-42FC-B6AC-7A6C6A094315}];
                                                                DepartmentCategory=Lists }
    { MenuItem       ;[{1DFFFF31-23F5-4194-A005-300E32167653}] ;Name=Forbrukskladd;
                                                                CaptionML=[ENU=Consumption Journal;
                                                                           NOR=Forbrukskladd];
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{6A1856B5-E3EC-406B-80EB-05C5EF4631BD}];
                                                                RunObjectType=Page;
                                                                RunObjectID=99000846;
                                                                ParentNodeID=[{DB86519A-3B17-46EE-87CF-033D4EC9D288}];
                                                                Visible=Yes;
                                                                NextNodeID=[{E1F1A8E0-9757-4AF9-AA74-C14B9C2233FC}];
                                                                DepartmentCategory=Tasks }
    { MenuGroup      ;[{E1F1A8E0-9757-4AF9-AA74-C14B9C2233FC}] ;Name=Reports;
                                                                CaptionML=[ENU=Reports;
                                                                           NOR=Rapporter];
                                                                MemberOfMenu=[{6A1856B5-E3EC-406B-80EB-05C5EF4631BD}];
                                                                ParentNodeID=[{DB86519A-3B17-46EE-87CF-033D4EC9D288}];
                                                                Visible=Yes;
                                                                NextNodeID=[{00000000-0000-0000-0000-000000000000}];
                                                                FirstChild=[{C91F855A-33D1-4AEE-A741-1BBE88270DB9}];
                                                                IsDepartmentPage=No }
    { MenuItem       ;[{C91F855A-33D1-4AEE-A741-1BBE88270DB9}] ;Name=Indirekte tid;
                                                                CaptionML=[ENU=OPC Indirect Time;
                                                                           NOR=OPC Indirekte tid];
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{6A1856B5-E3EC-406B-80EB-05C5EF4631BD}];
                                                                RunObjectType=Report;
                                                                RunObjectID=83001;
                                                                ParentNodeID=[{E1F1A8E0-9757-4AF9-AA74-C14B9C2233FC}];
                                                                Visible=Yes;
                                                                NextNodeID=[{00000000-0000-0000-0000-000000000000}];
                                                                DepartmentCategory=Reports and Analysis }
    {                ;[{4444D15F-6F71-4058-A823-C35BD171B04A}] ;NextNodeID=[{6A1856B5-E3EC-406B-80EB-05C5EF4631BD}] }
    { MenuItem       ;[{B27AA02A-A18D-49F8-ADDE-D8D290737593}] ;Name=OPC Oppsett;
                                                                CaptionML=[ENU=OPC Setup;
                                                                           NOR=OPC Oppsett];
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{6A1856B5-E3EC-406B-80EB-05C5EF4631BD}];
                                                                RunObjectType=Page;
                                                                RunObjectID=83011;
                                                                ParentNodeID=[{0DAD1316-1367-4BCD-B71C-9634353A0D29}];
                                                                Visible=Yes;
                                                                NextNodeID=[{00000000-0000-0000-0000-000000000000}];
                                                                DepartmentCategory=Administration }
    { MenuGroup      ;[{0DAD1316-1367-4BCD-B71C-9634353A0D29}] ;Name=Setup;
                                                                CaptionML=[ENU=Setup;
                                                                           NOR=Oppsett];
                                                                MemberOfMenu=[{6A1856B5-E3EC-406B-80EB-05C5EF4631BD}];
                                                                ParentNodeID=[{6A1856B5-E3EC-406B-80EB-05C5EF4631BD}];
                                                                Visible=Yes;
                                                                NextNodeID=[{4FD54D94-E35F-4502-ACBB-A94C6ABAD2A6}];
                                                                FirstChild=[{B27AA02A-A18D-49F8-ADDE-D8D290737593}];
                                                                IsDepartmentPage=No }
    { MenuGroup      ;[{DB86519A-3B17-46EE-87CF-033D4EC9D288}] ;Name=Production;
                                                                CaptionML=[ENU=Production;
                                                                           NOR=Produksjon];
                                                                MemberOfMenu=[{6A1856B5-E3EC-406B-80EB-05C5EF4631BD}];
                                                                ParentNodeID=[{6A1856B5-E3EC-406B-80EB-05C5EF4631BD}];
                                                                Visible=Yes;
                                                                NextNodeID=[{0DAD1316-1367-4BCD-B71C-9634353A0D29}];
                                                                FirstChild=[{0983E9E7-CD0C-4216-8ADC-CEE0B6FB86C2}];
                                                                IsDepartmentPage=Yes }
    { MenuGroup      ;[{4FD54D94-E35F-4502-ACBB-A94C6ABAD2A6}] ;Name=Admin;
                                                                CaptionML=[ENU=Admin;
                                                                           NOR=Admin];
                                                                MemberOfMenu=[{6A1856B5-E3EC-406B-80EB-05C5EF4631BD}];
                                                                ParentNodeID=[{6A1856B5-E3EC-406B-80EB-05C5EF4631BD}];
                                                                Visible=Yes;
                                                                NextNodeID=[{00000000-0000-0000-0000-000000000000}];
                                                                FirstChild=[{33BE73AD-BD7F-4450-9AC9-C7408A8D1CD9}];
                                                                IsDepartmentPage=Yes }
    { MenuGroup      ;[{33BE73AD-BD7F-4450-9AC9-C7408A8D1CD9}] ;Name=Time Registration;
                                                                CaptionML=[ENU=Time Registration;
                                                                           NOR=M›nstring];
                                                                MemberOfMenu=[{6A1856B5-E3EC-406B-80EB-05C5EF4631BD}];
                                                                ParentNodeID=[{4FD54D94-E35F-4502-ACBB-A94C6ABAD2A6}];
                                                                Visible=Yes;
                                                                NextNodeID=[{193DFC3E-3297-4541-B800-27B9562AE727}];
                                                                FirstChild=[{F8776E2C-0F5D-40C5-8132-F093B2B7308A}];
                                                                IsDepartmentPage=No }
    { MenuItem       ;[{F8776E2C-0F5D-40C5-8132-F093B2B7308A}] ;Name=Registrert m›nstret tid;
                                                                CaptionML=[ENU=OPC Time Registered;
                                                                           NOR=Registrert m›nstret tid];
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{6A1856B5-E3EC-406B-80EB-05C5EF4631BD}];
                                                                RunObjectType=Page;
                                                                RunObjectID=83013;
                                                                ParentNodeID=[{33BE73AD-BD7F-4450-9AC9-C7408A8D1CD9}];
                                                                Visible=Yes;
                                                                NextNodeID=[{E3CCC9DD-0626-4B37-86AE-945C090D0046}];
                                                                DepartmentCategory=Lists }
    { MenuItem       ;[{E3CCC9DD-0626-4B37-86AE-945C090D0046}] ;Name=Stemplingsliste;
                                                                CaptionML=[ENU=OPC Time Register List;
                                                                           NOR=OPC Stemplingsliste];
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{6A1856B5-E3EC-406B-80EB-05C5EF4631BD}];
                                                                RunObjectType=Report;
                                                                RunObjectID=58001;
                                                                ParentNodeID=[{33BE73AD-BD7F-4450-9AC9-C7408A8D1CD9}];
                                                                Visible=Yes;
                                                                NextNodeID=[{00000000-0000-0000-0000-000000000000}];
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{193DFC3E-3297-4541-B800-27B9562AE727}] ;Name=[OPC - koder for Ikke produktiv tid ];
                                                                CaptionML=[ENU=OPC Indirect Time Admin;
                                                                           NOR=OPC Koder for indirekte  tid];
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{6A1856B5-E3EC-406B-80EB-05C5EF4631BD}];
                                                                RunObjectType=Page;
                                                                RunObjectID=83027;
                                                                ParentNodeID=[{4FD54D94-E35F-4502-ACBB-A94C6ABAD2A6}];
                                                                Visible=Yes;
                                                                NextNodeID=[{1E5F1A7F-F9B1-43E8-98DD-AE39CF42FDA7}];
                                                                DepartmentCategory=Lists }
    { MenuItem       ;[{1E5F1A7F-F9B1-43E8-98DD-AE39CF42FDA7}] ;Name=OPC Koder for ikke produktiv tid;
                                                                CaptionML=[ENU=OPC Time Registration Deduction;
                                                                           NOR=OPC Timeregistering fradrag];
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{6A1856B5-E3EC-406B-80EB-05C5EF4631BD}];
                                                                RunObjectType=Page;
                                                                RunObjectID=83022;
                                                                ParentNodeID=[{4FD54D94-E35F-4502-ACBB-A94C6ABAD2A6}];
                                                                Visible=Yes;
                                                                NextNodeID=[{01401CCA-3342-43D8-87B2-1C811D6A5156}];
                                                                DepartmentCategory=Lists }
    { MenuItem       ;[{01401CCA-3342-43D8-87B2-1C811D6A5156}] ;Name=OPC kapasitetsposter;
                                                                CaptionML=[ENU=OPC Capacity Ledger Entry;
                                                                           NOR=OPC kapasitetsposter];
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{6A1856B5-E3EC-406B-80EB-05C5EF4631BD}];
                                                                RunObjectType=Page;
                                                                RunObjectID=83105;
                                                                ParentNodeID=[{4FD54D94-E35F-4502-ACBB-A94C6ABAD2A6}];
                                                                Visible=Yes;
                                                                NextNodeID=[{00000000-0000-0000-0000-000000000000}];
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{CCF7B636-C0E0-4C21-871A-7A78E2E832E8}] ;Name=OPC Information Message;
                                                                CaptionML=[ENU=OPC Information Message;
                                                                           NOR=OPC Melding p† informasjonssentral];
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{6A1856B5-E3EC-406B-80EB-05C5EF4631BD}];
                                                                RunObjectType=Page;
                                                                RunObjectID=83003;
                                                                ParentNodeID=[{DB86519A-3B17-46EE-87CF-033D4EC9D288}];
                                                                Visible=Yes;
                                                                NextNodeID=[{4C955B3D-9D98-4D1F-A64C-5F05C16BF56E}];
                                                                DepartmentCategory=Tasks }
  }
}
OBJECT Page 83001 OPC Information Board
{
  OBJECT-PROPERTIES
  {
    Date=29.09.17;
    Time=21:20:11;
    Modified=Yes;
    Version List=OPC6.06;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=OPC Information Board;
               NOR=OPC Informasjonssentral];
    SourceTable=Table99000758;
    SourceTableView=SORTING(No.)
                    ORDER(Ascending)
                    WHERE(Show in OPC=FILTER(Yes));
    PageType=List;
    TimerUpdate=2000;
    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000000;1 ;Action    ;
                      Name=Time Registration;
                      CaptionML=[ENU=Time Registration;
                                 NOR=M›nstring];
                      RunObject=Page 83017;
                      RunPageOnRec=No;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Timesheet;
                      PromotedCategory=Process }
      { 1000000003;1 ;Action    ;
                      Name=Planned tasks;
                      CaptionML=[ENU=Planned tasks;
                                 NOR=Planlagte oppgaver];
                      RunObject=Page 83023;
                      RunPageOnRec=No;
                      RunPageLink=No.=FIELD(No.),
                                  Status=CONST(Firm Planned);
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PlanningWorksheet;
                      PromotedCategory=Process }
      { 11      ;1   ;Action    ;
                      Name=Indirect Time List;
                      CaptionML=[ENU=Indirect Time;
                                 NOR=Indirekte tid];
                      RunPageOnRec=No;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=AbsenceCategory;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 OPCIndirectTimeL@1101103000 : Page 83028;
                               BEGIN
                                 OPCIndirectTimeL.InitForm("No.");
                                 OPCIndirectTimeL.RUN;
                               END;
                                }
      { 1000000001;1 ;Action    ;
                      Name=Tasks;
                      CaptionML=[ENU=Tasks;
                                 NOR=Oppgaver];
                      RunObject=Page 83002;
                      RunPageOnRec=No;
                      RunPageLink=No.=FIELD(No.),
                                  Status=CONST(Released);
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=TaskList;
                      PromotedCategory=Process }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1101103000;1;Group  ;
                GroupType=Group }

    { 1101103001;2;Field  ;
                Name=PingPong;
                Visible=false;
                Enabled=false;
                Editable=false;
                ControlAddIn=[Microsoft.Dynamics.Nav.Client.PingPong;PublicKeyToken=31bf3856ad364e35] }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                SourceExpr="No." }

    { 4   ;2   ;Field     ;
                SourceExpr=Name }

    { 1000000002;1;Part   ;
                Name=OPC Information Message;
                SubPageView=SORTING(Entry No.)
                            ORDER(Ascending);
                PagePartID=Page83003;
                ProviderID=2;
                Editable=false }

  }
  CODE
  {
    VAR
      OPCOppsett@1000000000 : Record 83001;
      FerdigMeldKladdLinje@1000000001 : Record 83;
      OPCInformationMessageG@1101103000 : Record 83002;

    EVENT PingPong@-1101103001::AddInReady@2();
    BEGIN
      CurrPage.PingPong.Ping(1000);
    END;

    EVENT PingPong@-1101103001::Pong@3();
    BEGIN
      CurrPage."OPC Information Message".PAGE.UpdatePage();
      CurrPage.UPDATE(FALSE);
      CurrPage.PingPong.Ping(1000);
    END;

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 14.12.05 HHE Endret oppslag p† knapp="indirekte tid"
      02  29.03.06 ASL Endret p† oppslag Ikke produktiv tid
      03. 03.04.06 HHE sub-frm: melding p† Info.sentral - endret "glue" til right/bottom. Samme med Ress.liste (vert= Both)
      04. 15.12.06 HHE Utvidet antall tekstlinjer p† Oppslagstavle (8->15 linjer)
      05. 17.06.09 HHE Ny knapp:"Planlagte oppgaver"  (›nsket av PTL)
      06. 14.11.16 JAL Added PingPong control to refresh message every 30 seconds.
    }
    END.
  }
}

OBJECT Page 83002 OPC Task List
{
  OBJECT-PROPERTIES
  {
    Date=28.09.17;
    Time=14:09:57;
    Modified=Yes;
    Version List=OPC6.12;
  }
  PROPERTIES
  {
    CaptionML=[ENU=OPC - Task List;
               NOR=OPC Oppgaveliste];
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=No;
    SourceTable=Table5409;
    SourceTableView=SORTING(Type,No.,Starting Date)
                    ORDER(Ascending)
                    WHERE(Type=FILTER(Machine Center),
                          Routing Status=FILTER(<>Finished));
    DataCaptionFields=No.;
    PageType=List;
    RefreshOnActivate=Yes;
    OnAfterGetRecord=BEGIN
                       CLEAR(WarningIndex);
                       CLEAR(OrgQty);
                       ProdOrderLineG.SETRANGE(Status, ProdOrderLineG.Status::Released);
                       ProdOrderLineG.SETRANGE("Prod. Order No.", "Prod. Order No.");
                       ProdOrderLineG.SETRANGE("Routing No.", "Routing No.");

                       IF ProdOrderLineG.FINDFIRST THEN BEGIN
                         OrgQty := ProdOrderLineG.Quantity;
                         IF ItemG.GET(ProdOrderLineG."Item No.") THEN BEGIN
                           VareNr := ItemG."No.";
                           VareBesk := ItemG.Description;
                           ProdOrderComponentG.RESET;
                           ProdOrderComponentG.SETRANGE(Status,Status::Released);
                           ProdOrderComponentG.SETRANGE("Prod. Order No.", "Prod. Order No.");
                           ProdOrderComponentG.SETRANGE("Routing Link Code","Routing Link Code");

                           IF ProdOrderComponentG.FINDFIRST THEN
                             REPEAT
                               CLEAR(ItemInventory);
                               CLEAR(Item);
                               IF Item.GET(ProdOrderComponentG."Item No.") THEN BEGIN
                                 Item.SETRANGE("Location Filter", ProdOrderComponentG."Location Code");
                                 Item.CALCFIELDS(Inventory);
                                 ItemInventory := Item.Inventory;
                                 IF (ItemInventory - ProdOrderComponentG."Remaining Quantity") < 0 THEN
                                   WarningIndex := 1;
                               END;
                             UNTIL ProdOrderComponentG.NEXT = 0;
                         END;
                       END;
                       RemQty := OrgQty - "Finished Qty";
                       IF WarningIndex = 1 THEN BEGIN
                         OPCSetupG.GET;
                         OPCSetupG.CALCFIELDS("Warning Picture");
                       END
                       ELSE
                         OPCSetupG.INIT;
                       IF "Expected Capacity Need" <> 0 THEN
                         ExpectedCapacityNeedG := ("Expected Capacity Need"/1000/60/60)
                       ELSE
                         ExpectedCapacityNeedG := 0;
                     END;

    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000017;1 ;Action    ;
                      Name=Move Components;
                      CaptionML=[ENU=Move Components;
                                 NOR=Flytt komponenter];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=TransferToLines;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 OPCSetup@1000000003 : Record 83001;
                                 ProdRessurs@1000000004 : Record 99000758;
                               BEGIN
                                 //012->
                                 ProdRessurs.GET("No.");
                                 IF NOT ProdRessurs."Allow OPC Move" THEN
                                   ERROR('Denne produksjonsressursen kan ikke benytte denne funksjonen');
                                 //012<-
                                 //011->
                                 OPCSetup.GET;
                                 ProdOrderCompG.SETRANGE(Status, Status);
                                 ProdOrderCompG.SETRANGE("Prod. Order No.", "Prod. Order No.");
                                 ProdOrderCompG.SETRANGE("Location Code", OPCSetup."OPC-Move Location Code");
                                 IF ProdOrderCompG.FINDFIRST THEN
                                   ERROR('Du kan ikke bruke denne funksjonen n†r komponentene har Lokasjonskode %1',OPCSetup."OPC-Move Location Code");
                                 //011<-
                                 //bygger opp filter for hva som skal synes i "OPC-Move components"
                                 CLEAR(ProdOrderCompG);
                                 ProdOrderCompG.SETRANGE(Status, Status);
                                 ProdOrderCompG.SETRANGE("Prod. Order No.", "Prod. Order No.");
                                 PAGE.RUNMODAL(PAGE::"OPC Move Components", ProdOrderCompG);
                                 CLEAR(ProdOrderCompG); //hhe: for † l›se opp i filter som skapte feilmelding p† "Stykkliste"-knapp
                               END;
                                }
      { 1000000008;1 ;Action    ;
                      Name=Prod. Order Rtng. Comment;
                      CaptionML=[ENU=Comments;
                                 NOR=Merknader];
                      RunObject=Page 99000840;
                      RunPageLink=Status=FIELD(Status),
                                  Prod. Order No.=FIELD(Prod. Order No.),
                                  Routing Reference No.=FIELD(Routing Reference No.),
                                  Routing No.=FIELD(Routing No.),
                                  Operation No.=FIELD(Operation No.);
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Comment;
                      PromotedCategory=Process }
      { 1000000004;1 ;Action    ;
                      Name=Document Link;
                      CaptionML=[ENU=Document Link;
                                 NOR=&Tilknyttet dokument];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Link;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 HYPERLINK("Dokument Link");
                               END;
                                }
      { 1000000005;1 ;Action    ;
                      Name=Stykkliste;
                      CaptionML=[ENU=BOM List;
                                 NOR=Stykkliste];
                      RunObject=Page 83004;
                      RunPageView=WHERE(Status=FILTER(Released),
                                        Prod. Order Line No.=CONST(10000));
                      RunPageLink=Prod. Order No.=FIELD(Prod. Order No.);
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=BOM;
                      PromotedCategory=Process;
                      RunPageMode=View }
      { 1000000006;1 ;Action    ;
                      Name=Start/Stop Time;
                      CaptionML=[ENU=Start/Stop Time;
                                 NOR=Start/stopp tid];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Start;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ClockingMgtL@1101103000 : Codeunit 83001;
                               BEGIN
                                 ClockingMgtL.RegisterTimeOnTaskFromRoutingLine(Rec);
                               END;
                                }
      { 1000000007;1 ;Action    ;
                      Name=PostOutputItem;
                      CaptionML=[ENU=Post Output;
                                 NOR=Ferdigmeld];
                      RunPageOnRec=Yes;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=ReleaseShipment;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 ClockingPostOutputG.PostOutputItemFromRoutingLine(Rec);
                               END;
                                }
      { 1101103000;1 ;Action    ;
                      Name=Route;
                      CaptionML=[ENU=Route;
                                 NOR=Rute];
                      RunObject=Page 83104;
                      RunPageOnRec=Yes;
                      RunPageLink=Prod. Order No.=FIELD(Prod. Order No.);
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Route;
                      PromotedCategory=Process }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                Editable=FALSE;
                GroupType=Repeater }

    { 10  ;2   ;Field     ;
                SourceExpr="Starting Date" }

    { 16  ;2   ;Field     ;
                SourceExpr="Prod. Order No." }

    { 2   ;2   ;Field     ;
                CaptionML=[ENU=Operation No.;
                           NOR=Op.nr.];
                SourceExpr="Operation No." }

    { 1000000000;2;Field  ;
                CaptionML=NOR=Varenr.;
                SourceExpr=VareNr }

    { 1000000002;2;Field  ;
                CaptionML=NOR=Varebeskr.;
                SourceExpr=VareBesk }

    { 6   ;2   ;Field     ;
                CaptionML=[ENU=Description;
                           NOR=Operasj.beskr.];
                SourceExpr=Description }

    { 1101103001;2;Field  ;
                Name=Warning;
                CaptionML=[ENU=Warning;
                           NOR=Varsel];
                SourceExpr=OPCSetupG."Warning Picture";
                Editable=false }

    { 1000000013;2;Field  ;
                CaptionML=[ENU=Ordred qty.;
                           NOR=Ordreantall];
                DecimalPlaces=0:0;
                SourceExpr=OrgQty }

    { 18  ;2   ;Field     ;
                CaptionML=[ENU=Planned qty;
                           NOR=Planlagt];
                SourceExpr="Input Quantity";
                Visible=FALSE }

    { 22  ;2   ;Field     ;
                CaptionML=[ENU=Finished Quantity;
                           NOR=Ferdig];
                DecimalPlaces=0:2;
                SourceExpr="Finished Qty" }

    { 1000000015;2;Field  ;
                CaptionML=[ENU=Remaining Qty;
                           NOR=Restantall];
                DecimalPlaces=0:0;
                SourceExpr=RemQty;
                Style=Standard;
                StyleExpr=TRUE }

    { 1101103003;2;Field  ;
                CaptionML=[ENU=Expected Capacity Need;
                           NOR=Forventet kapasitetsbehov];
                SourceExpr=ExpectedCapacityNeedG }

    { 1101103002;2;Field  ;
                SourceExpr="Expected Capacity Need";
                Visible=false }

    { 26  ;2   ;Field     ;
                DecimalPlaces=0:2;
                SourceExpr="Actual Run Time" }

    { 24  ;2   ;Field     ;
                SourceExpr="Dokument Link" }

  }
  CODE
  {
    VAR
      ProdOrderLineG@1000000000 : Record 5406;
      ItemG@1000000001 : Record 27;
      ProdOrderComponentG@1101103002 : Record 5407;
      ProdOrderCompG@1101103001 : Record 5407;
      OPCSetupG@1101103003 : Record 83001;
      ClockingPostOutputG@1101103000 : Codeunit 83004;
      VareBesk@1000000002 : Text[50];
      VareNr@1000000003 : Text[50];
      WarningIndex@1000000015 : Integer;
      ItemInventory@1000000017 : Decimal;
      Item@1000000018 : Record 27;
      OrgQty@1000000020 : Decimal;
      RemQty@1000000021 : Decimal;
      ExpectedCapacityNeedG@1101103004 : Decimal;

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 15.12.05 ASL Tar med vrakantall + vrakkode fra ferdigmelding
      02. 15.12.05 HHE Fjernet kolonnen "Arb.senter", Forkortet til "Op.nr."
                            Frm:Insert/delete/modify = No
                            Satt kolonnen "Startdato" fremst
                            Knapp= Stykkliste->sl†r opp i ny BESKYTTET frm (ikke som f›r = std. stk.l. p† p.o.)
                            Ny knapp = Merknader (tekst fra stamrute->p.o.rute->OPC)
      03. 01.03.06 HHE Overf›rer Lokasjonskoden fra Prod.o.linjen til f.meld.kladden
      04. 05.05.06 HHE Byttet ut kode p† "Tilknyttet dokument"
      05. 19.05.06 HHE Kode for auto.innlegg av maskin
      06. 30.01.07 HHE Routing StatusFILTER<>Finished
      07. 28.06.07 HHE Knapp=Stykkliste ->Properties=RunFormView:WHERE(Status=FILTER(Released),Prod. Order Line No.=CONST(10000))
      08. 30.04.08 HEI Vrakkode 2 og 3. Henter fra FromFerdigMeld, og bokf›rer hvis de har verdi
      09. 06.02.09 BVM Fremvist operasjonstid og nytt felt for Antall, endret ledetekst p† planlagtantall til restantall
      10. 17.08.10 HHE Ny knapp: Flytt komponenter
      11. 19.08.10 HHE Sjekker om Lokasjonskode p† komponenter er ULIK OPC-flytt-lokasjon i OPC Setup
      12. 19.08.10 HHE Sjekker om det er tillatt † flytte komponenter via denne Prod.ressurs
    }
    END.
  }
}

OBJECT Page 83003 OPC Information Message
{
  OBJECT-PROPERTIES
  {
    Date=28.09.17;
    Time=11:17:33;
    Modified=Yes;
    Version List=OPC6.02;
  }
  PROPERTIES
  {
    CaptionML=[ENU=OPC Information Message;
               NOR=OPC Melding p† informasjonssentral];
    SourceTable=Table83002;
    PageType=CardPart;
    TimerUpdate=60000;
    RefreshOnActivate=Yes;
    OnClosePage=BEGIN
                  IF CurrPage.EDITABLE THEN
                    Rec.MODIFYALL("Last Modified", CURRENTDATETIME);
                END;

    OnInsertRecord=BEGIN
                     Rec."Entry No." := Rec.GetNextEntryNo() ;
                   END;

  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1101103001;1;Group  ;
                GroupType=Group }

    { 1101103002;2;Field  ;
                Name=PingPong;
                ControlAddIn=[Microsoft.Dynamics.Nav.Client.PingPong;PublicKeyToken=31bf3856ad364e35] }

    { 1101103000;1;Group  ;
                GroupType=Repeater }

    { 1000000003;2;Field  ;
                SourceExpr=Description }

  }
  CODE
  {

    PROCEDURE UpdatePage@1101103000();
    VAR
      OPCInformationMessageL@1101103000 : Record 83002;
    BEGIN
      IF OPCInformationMessageL.FINDLAST THEN
        IF Rec."Last Modified" <> OPCInformationMessageL."Last Modified" THEN
          CurrPage.ACTIVATE(TRUE);
    END;

    EVENT PingPong@-1101103002::AddInReady@2();
    BEGIN
      CurrPage.PingPong.Ping(10000);
    END;

    EVENT PingPong@-1101103002::Pong@3();
    BEGIN
      IF NOT CurrPage.EDITABLE THEN
        UpdatePage();

      CurrPage.PingPong.Ping(10000);
    END;

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 23.03.06 HHE  Endret timer fra 5 sek. til 60 sek
      02. 15.12.06 HHE  Lagt til tekstlinje 11-15
    }
    END.
  }
}

OBJECT Page 83004 OPC P.O. Comp. Line List
{
  OBJECT-PROPERTIES
  {
    Date=20.09.17;
    Time=15:17:29;
    Modified=Yes;
    Version List=OPC6.07;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Prod. Order Comp. Line List;
               NOR=Prod.ordre komponentlinje oversikt];
    SourceTable=Table5407;
    PageType=List;
    OnAfterGetRecord=BEGIN
                       ShowShortcutDimCode(ShortcutDimCode);
                       //hhe 18.05.06->
                       ItemInventoryG := 0;
                       GetItemInventory();
                       //hhe 18.05.06<-
                     END;

    OnNewRecord=BEGIN
                  CLEAR(ShortcutDimCode);
                  ItemInventoryG := 0;
                END;

    OnInsertRecord=BEGIN
                     //hhe 28.06.07->
                     OnBeforeInsertRecord();
                     "Line No." := LineNoG;
                     //hhe 28.06.07<-
                   END;

    OnAfterGetCurrRecord=BEGIN
                           GetItemInventory();
                         END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 12      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Line;
                                 NOR=&Linje];
                      Visible=FALSE }
      { 6500    ;2   ;Action    ;
                      CaptionML=[ENU=Item &Tracking Lines;
                                 NOR=Vare&sporingslinjer];
                      Image=ItemTrackingLines;
                      OnAction=BEGIN
                                 OpenItemTrackingLines;
                               END;
                                }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000000;1 ;Action    ;
                      CaptionML=NOR=Skriv ut;
                      Promoted=Yes;
                      Image=Report;
                      PromotedCategory=Report;
                      OnAction=BEGIN
                                 PO_nr := Rec."Prod. Order No.";
                                 ProdOrdre.SETRANGE(Status,Status::Released);
                                 ProdOrdre.SETRANGE("No.",PO_nr);
                                 REPORT.RUN(REPORT::"Prod. Order - Mat. Requisition",TRUE,FALSE,ProdOrdre);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 8   ;2   ;Field     ;
                SourceExpr="Item No." }

    { 53  ;2   ;Field     ;
                SourceExpr="Variant Code";
                Visible=FALSE }

    { 51  ;2   ;Field     ;
                SourceExpr=Description }

    { 1000000001;2;Field  ;
                CaptionML=[ENU=Inventory;
                           NOR=Beholdning];
                DecimalPlaces=0:2;
                SourceExpr=ItemInventoryG;
                Editable=FALSE;
                Style=Standard;
                StyleExpr=TRUE }

    { 14  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 1 Code";
                Visible=FALSE }

    { 16  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 2 Code";
                Visible=FALSE }

    { 300 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[3];
                CaptionClass='1,2,3';
                Visible=FALSE;
                OnLookup=BEGIN
                           LookupShortcutDimCode(3,ShortcutDimCode[3]);
                         END;
                          }

    { 302 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[4];
                CaptionClass='1,2,4';
                Visible=FALSE;
                OnLookup=BEGIN
                           LookupShortcutDimCode(4,ShortcutDimCode[4]);
                         END;
                          }

    { 304 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[5];
                CaptionClass='1,2,5';
                Visible=FALSE;
                OnLookup=BEGIN
                           LookupShortcutDimCode(5,ShortcutDimCode[5]);
                         END;
                          }

    { 306 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[6];
                CaptionClass='1,2,6';
                Visible=FALSE;
                OnLookup=BEGIN
                           LookupShortcutDimCode(6,ShortcutDimCode[6]);
                         END;
                          }

    { 308 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[7];
                CaptionClass='1,2,7';
                Visible=FALSE;
                OnLookup=BEGIN
                           LookupShortcutDimCode(7,ShortcutDimCode[7]);
                         END;
                          }

    { 310 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[8];
                CaptionClass='1,2,8';
                Visible=FALSE;
                OnLookup=BEGIN
                           LookupShortcutDimCode(8,ShortcutDimCode[8]);
                         END;
                          }

    { 10  ;2   ;Field     ;
                SourceExpr="Location Code";
                Visible=TRUE }

    { 55  ;2   ;Field     ;
                SourceExpr="Quantity per" }

    { 57  ;2   ;Field     ;
                SourceExpr="Expected Quantity" }

    { 59  ;2   ;Field     ;
                SourceExpr="Remaining Quantity" }

    { 1000000008;2;Field  ;
                SourceExpr="Routing Link Code" }

    { 1000000003;2;Field  ;
                SourceExpr="Flushing Method" }

    { 46  ;2   ;Field     ;
                SourceExpr="Due Date" }

    { 61  ;2   ;Field     ;
                SourceExpr="Unit Cost";
                Visible=FALSE }

    { 44  ;2   ;Field     ;
                SourceExpr="Cost Amount";
                Visible=FALSE }

    { 20  ;2   ;Field     ;
                SourceExpr=Position;
                Visible=FALSE }

    { 22  ;2   ;Field     ;
                SourceExpr="Position 2";
                Visible=FALSE }

    { 24  ;2   ;Field     ;
                SourceExpr="Position 3";
                Visible=FALSE }

    { 63  ;2   ;Field     ;
                SourceExpr="Lead-Time Offset";
                Visible=FALSE }

  }
  CODE
  {
    VAR
      ShortcutDimCode@1000 : ARRAY [8] OF Code[20];
      "--si-data--"@1000000002 : Boolean;
      ManuPrintReport@1000000000 : Codeunit 99000817;
      ProdOrdreKomponent@1000000001 : Record 5407;
      ProdOrdre@1000000003 : Record 5405;
      PO_nr@1000000004 : Code[10];
      ItemInventoryG@1000000005 : Decimal;
      ItemG@1000000006 : Record 27;
      LineNoG@1101104000 : Integer;

    LOCAL PROCEDURE OnBeforeInsertRecord@19001631();
    VAR
      P_ordre@1101104000 : Record 5405;
    BEGIN
      //hhe 28.06.07->
      ProdOrdreKomponent.RESET;
      ProdOrdreKomponent.SETRANGE(Status,Status::Released);
      ProdOrdreKomponent.SETRANGE("Prod. Order No.","Prod. Order No.");
      ProdOrdreKomponent.SETRANGE("Prod. Order Line No.",10000);
      IF ProdOrdreKomponent.FIND('+') THEN
         LineNoG := ProdOrdreKomponent."Line No." + 10000
      ELSE
         "Line No." := 10000;
      IF P_ordre.GET(Status::Released,"Prod. Order No.") THEN  //17.06.09: lagt inn IF
        "Location Code" := P_ordre."Location Code";
      //hhe 28.06.07<-
    END;

    LOCAL PROCEDURE GetItemInventory@1101103001();
    BEGIN
      IF ItemG.GET("Item No.") THEN BEGIN
        ItemG.SETRANGE("Location Filter", "Location Code");
        ItemG.CALCFIELDS(Inventory);
        ItemInventoryG := ItemG.Inventory;
      END;
    END;

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 14.12.05 hhe Fjernet: "p.o.nr", "status" ++
      02. 30.03.06 hhe Lagt inn knapp for utskrift av "Materialrekv."
      03. 18.05.06 hhe Fremviser Beholdning for den enkelte komponent
      04. 26.06.07 hhe Setter FRM: Editable=False ved †pning
                       Ny knapp=Funksjoner -> Rediger / Skrivebeskytt
                       Properties: har gitt lov til † endre/sette inn/slette
      05. 28.06.07 hhe Mulig † legge til en komponentlinje
      06. 17.06.09 hhe Lagt inn et IF vedr. s›k etter prod.ordre
      07. 17.11.16 JAL Added Init of ItemInventoryG variable
                       Moved calculation of ItemInventory to function
    }
    END.
  }
}

OBJECT Page 83008 OPC Mach. Center On Operation
{
  OBJECT-PROPERTIES
  {
    Date=27.09.17;
    Time=13:36:33;
    Modified=Yes;
    Version List=OPC6.12;
  }
  PROPERTIES
  {
    CaptionML=[ENU=OPC Machine Center On Operation;
               NOR=OPC Prod.ress. p† operasjonen];
    SourceTable=Table83010;
    SourceTableView=SORTING(Machine Center)
                    ORDER(Descending);
    PageType=Card;
    OnOpenPage=BEGIN
                 IF (IndirectTimeCodeG = '') THEN BEGIN
                   GetItemInfo();
                   ShowStopCodeG := FALSE;
                 END ELSE
                   ShowStopCodeG := TRUE;
               END;

    OnInsertRecord=BEGIN
                     InitRecord();
                   END;

    OnQueryClosePage=BEGIN
                       //010 BVM-->
                       ClockingRunTimesMgtG.DeleteRunTimesForPOWithEmptyTimes(Rec);
                       //010 BVM--<
                     END;

    OnAfterGetCurrRecord=BEGIN
                           // //JAL BugFix when selecting lines -->
                           // OutPutQtyG := OutPutQtyG;
                           // ScrapQtyG := ScrapQtyG;
                           // ScrapQty2G := ScrapQty2G;
                           // ScrapQty3G := ScrapQty3G;
                           // ScrapCodeG := ScrapCodeG;
                           // ScrapCode2G := ScrapCode2G;
                           // ScrapCode3G := ScrapCode3G;
                           // ScrapCommentG := ScrapCommentG;
                           // ScrapComment2G := ScrapComment2G;
                           // ScrapComment3G := ScrapComment3G;
                           // OperationDescriptionG := OperationDescriptionG;
                           // MachineNameG := MachineNameG;
                           // ProdOrderNoG := ProdOrderNoG;
                           // ItemNoG := ItemNoG;
                           // ItemDescriptionG := ItemDescriptionG;
                           // //JAL BugFix when selecting lines <--
                         END;

    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000001;1 ;Action    ;
                      Name=RegisterTimeOnTask;
                      CaptionML=[ENU=Register;
                                 NOR=Registrer];
                      Promoted=Yes;
                      Image=Register;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 ClockingMgtG.RegisterTimeOnTask(Rec, TODAY, TIME, TODAY, TIME, OutPutQtyG, ScrapQtyG, ScrapCodeG,
                                                                    ScrapQty2G, ScrapCode2G, ScrapQty3G, ScrapCode3G,
                                                                    ScrapCommentG, ScrapComment2G, ScrapComment3G);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1101103000;1;Group  ;
                Name=Output Information;
                CaptionML=[ENU=Output Information;
                           NOR=Ferdigmeldingsinformasjon];
                Visible=OutputFieldsVisibleG;
                GroupType=Group }

    { 1101104016;2;Field  ;
                CaptionML=[ENU=Machine Center;
                           NOR=Produksjonsressurs];
                SourceExpr=MachineNameG;
                Enabled=FALSE;
                Editable=FALSE }

    { 1101104001;2;Field  ;
                CaptionML=[ENU=Prod. Order No.;
                           NOR=Prod.ordrenr.];
                SourceExpr=ProdOrderNoG;
                Enabled=FALSE;
                Editable=FALSE }

    { 1101104003;2;Field  ;
                CaptionML=[ENU=Item No.;
                           NOR=Varenr.];
                SourceExpr=ItemNoG;
                Enabled=FALSE;
                Editable=FALSE }

    { 1101104005;2;Field  ;
                CaptionML=[ENU=Description;
                           NOR=Varebeskrivelse];
                SourceExpr=ItemDescriptionG;
                Enabled=FALSE;
                Editable=FALSE }

    { 1101104013;2;Field  ;
                CaptionML=[ENU=Operation Description;
                           NOR=Operasjonsbeskrivelse];
                SourceExpr=OperationDescriptionG;
                Enabled=FALSE;
                Editable=FALSE;
                Style=Standard;
                StyleExpr=TRUE }

    { 1101104007;2;Field  ;
                Name=Ouput Quantity;
                CaptionML=[ENU=Output Quantity;
                           NOR=Ferdigmeld antall];
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=OutPutQtyG;
                Style=Standard;
                StyleExpr=TRUE;
                OnValidate=BEGIN
                             CheckQuantity();
                           END;
                            }

    { 1101104008;2;Field  ;
                Name=Scrap Quantity;
                CaptionML=[ENU=Scrap Quantity;
                           NOR=Vraket antall];
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=ScrapQtyG;
                OnValidate=BEGIN
                             CheckQuantity();
                           END;
                            }

    { 1101104009;2;Field  ;
                Name=Scrap Code;
                CaptionML=[ENU=Scrap Code;
                           NOR=Vrakkode];
                SourceExpr=ScrapCodeG;
                TableRelation=Scrap.Code }

    { 1000000012;2;Field  ;
                Name=Scrap Comment;
                CaptionML=[ENU=Scrap Comment;
                           NOR=Kommentar til Vrakkode];
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=ScrapCommentG }

    { 1000000000;2;Field  ;
                Name=Scrap Quantity 2;
                CaptionML=[ENU=Scrap Quantity;
                           NOR=Vraket ant. (type 2)];
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=ScrapQty2G;
                Visible=false;
                OnValidate=BEGIN
                             CheckQuantity();
                           END;
                            }

    { 1000000004;2;Field  ;
                Name=Scrap Code 2;
                CaptionML=[ENU=Scrap Code;
                           NOR=Vrakkode(type2)];
                SourceExpr=ScrapCode2G;
                TableRelation=Scrap.Code;
                Visible=false }

    { 1000000013;2;Field  ;
                Name=Scrap Comment 2;
                CaptionML=[ENU=Scrap Comment 2;
                           NOR=Kommentar til Vrakkode(type2)];
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=ScrapComment2G;
                Visible=false }

    { 1000000007;2;Field  ;
                Name=Scrap Quantity 3;
                CaptionML=[ENU=Scrap Quantity;
                           NOR=Vraket ant. (type 3)];
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=ScrapQty3G;
                Visible=false;
                OnValidate=BEGIN
                             CheckQuantity();
                           END;
                            }

    { 1000000006;2;Field  ;
                Name=Scrap Code 3;
                CaptionML=[ENU=Scrap Code;
                           NOR=Vrakkode(type3)];
                SourceExpr=ScrapCode3G;
                TableRelation=Scrap.Code;
                Visible=false }

    { 1000000014;2;Field  ;
                Name=Scrap Comment 3;
                CaptionML=[ENU=Scrap Comment 3;
                           NOR=Kommentar til Vrakkode(type3)];
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=ScrapComment3G;
                Visible=false }

    { 1   ;1   ;Group     ;
                Editable=TRUE;
                GroupType=Repeater }

    { 10  ;2   ;Field     ;
                SourceExpr="Machine Center";
                OnValidate=BEGIN
                             MachineCenterOnAfterValidate();
                           END;
                            }

    { 12  ;2   ;Field     ;
                SourceExpr=Description;
                Editable=FALSE }

    { 1000000015;2;Field  ;
                SourceExpr="Stop Code";
                Visible=ShowStopCodeG }

    { 14  ;2   ;Field     ;
                SourceExpr="Starting Date" }

    { 16  ;2   ;Field     ;
                SourceExpr="Starting Time" }

    { 18  ;2   ;Field     ;
                SourceExpr="Ending Date";
                Editable=FALSE }

    { 20  ;2   ;Field     ;
                SourceExpr="Ending Time";
                Editable=FALSE }

    { 22  ;2   ;Field     ;
                SourceExpr="Finish Now" }

  }
  CODE
  {
    VAR
      ClockingRunTimesMgtG@1101103000 : Codeunit 83002;
      ClockingMgtG@1101103007 : Codeunit 83001;
      MachineCenterNoG@1000000000 : Code[20];
      ProdOrderNoG@1101103004 : Code[20];
      ProdOrderRouteNoG@1101103008 : Code[20];
      OperationNoG@1101103001 : Code[10];
      IndirectTimeCodeG@1000000001 : Code[20];
      TXT001@1000000002 : TextConst 'NOR=Startdato avviker fra dagens. Vil du bruke dagens dato?';
      ItemNoG@1101104000 : Code[20];
      ItemDescriptionG@1101104001 : Text[50];
      OutPutQtyG@1101104002 : Decimal;
      ScrapQtyG@1101104003 : Decimal;
      ScrapCodeG@1101104004 : Code[20];
      OperationDescriptionG@1101104005 : Text[50];
      MachineNameG@1101104006 : Text[30];
      ScrapQty2G@1000000004 : Decimal;
      ScrapCode2G@1000000005 : Code[20];
      ScrapQty3G@1000000006 : Decimal;
      ScrapCode3G@1000000007 : Code[20];
      ScrapCommentG@1000000008 : Text[50];
      ScrapComment2G@1000000009 : Text[50];
      ScrapComment3G@1000000010 : Text[50];
      C_ErrorInQty@1101103005 : TextConst 'ENU=Scrap can only be posted together with output quantity.;NOR=Vrak kan kun bokf›res sammen med ferdigantall.';
      OutputFieldsVisibleG@1101103006 : Boolean;
      ShowStopCodeG@1101103002 : Boolean;

    PROCEDURE InitForm@1000000001(MachineNo@1000000000 : Code[20];NoneProdTimeCode@1000000001 : Code[20]);
    BEGIN
      MachineCenterNoG := MachineNo;
      IndirectTimeCodeG := NoneProdTimeCode;
      IF IndirectTimeCodeG = '' THEN
        MachineNameG :=  MachineNo;
      OutputFieldsVisibleG := (IndirectTimeCodeG = '');
    END;

    LOCAL PROCEDURE InitRecord@1101103004();
    BEGIN
      Rec."Entry No." := Rec.GetNextLineNo();
      Rec.VALIDATE("Work Done at M.C.", MachineCenterNoG); // 002 ASL 29.03.06
      Rec.VALIDATE("Prod. Order No.", ProdOrderNoG);
      Rec.VALIDATE("Routing No.", ProdOrderRouteNoG);
      Rec.VALIDATE("Operation No.", OperationNoG);
    END;

    PROCEDURE GetItemInfo@1101104000();
    VAR
      ProdOrderLineL@1101104000 : Record 5406;
      ItemL@1101104001 : Record 27;
      ProdOrderRoutingLineL@1101104002 : Record 5409;
      MachineCenterL@1101103000 : Record 99000758;
    BEGIN
      IF Rec.FINDFIRST THEN BEGIN
        ProdOrderNoG := Rec."Prod. Order No.";
        ProdOrderRouteNoG := Rec."Routing No.";
        OperationNoG := Rec."Operation No.";
      END ELSE
      BEGIN
        ProdOrderNoG := Rec.GETFILTER("Prod. Order No.");
        ProdOrderRouteNoG := Rec.GETFILTER("Routing No.");
        OperationNoG := Rec.GETFILTER("Operation No.");
      END;
      ProdOrderLineL.RESET;
      ProdOrderLineL.SETRANGE(Status, ProdOrderLineL.Status::Released);
      ProdOrderLineL.SETRANGE("Prod. Order No.", ProdOrderNoG);
      ProdOrderLineL.SETRANGE("Routing No.", ProdOrderRouteNoG);
      IF ProdOrderLineL.FINDFIRST THEN BEGIN
        IF ItemL.GET(ProdOrderLineL."Item No.") THEN BEGIN
          ProdOrderLineL.TESTFIELD("Routing No.");
          ItemNoG := ItemL."No.";
          ItemDescriptionG := ItemL.Description;
        END;
      END;
      //hhe 20.04.06->
      ProdOrderRoutingLineL.RESET;
      ProdOrderRoutingLineL.SETRANGE(Status, ProdOrderRoutingLineL.Status::Released);
      ProdOrderRoutingLineL.SETRANGE("Prod. Order No.", ProdOrderNoG);
      ProdOrderRoutingLineL.SETRANGE("Routing No.", ProdOrderRouteNoG);
      ProdOrderRoutingLineL.SETRANGE("Operation No.", OperationNoG);
      IF ProdOrderRoutingLineL.FINDFIRST THEN BEGIN
        OperationDescriptionG := ProdOrderRoutingLineL.Description;
        MachineCenterL.GET(ProdOrderRoutingLineL."No.");
        MachineNameG := MachineCenterL.Name;
        END
      ELSE
        OperationDescriptionG := '';
      //hhe 20.04.06<-
    END;

    LOCAL PROCEDURE MachineCenterOnAfterValidate@19005651();
    VAR
      ClockingMgtL@1101103000 : Codeunit 83001;
    BEGIN
      ClockingMgtL.OnValidateMachineCenter(Rec."Machine Center");
      //012 hhe 26.11.09->
      IF IndirectTimeCodeG <> '' THEN
        Rec.VALIDATE("Stop Code", IndirectTimeCodeG);
      //012 hhe 26.11.09<-
      ClockingMgtL.OnAfterValidateMachineCenter(Rec."Machine Center", TODAY, TIME);
      //CurrPage.UPDATE(TRUE);
    END;

    LOCAL PROCEDURE CheckQuantity@1101103000();
    BEGIN
      //Because of limitation of posting scrap in standard NAV
      IF (OutPutQtyG = 0) AND ((ScrapQtyG + ScrapQty2G + ScrapQty3G) <> 0) THEN
          ERROR(C_ErrorInQty);
    END;

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 14.12.05 hhe Fjernet kolonne "Bokf›r"
      02. 29.03.06 ASL Bokf›ring av ikke produktiv tid.
      03. 29.03.06 ASL Satt inn ny Funksjon:InitForm som tar med maskin +
                       kode for ikke produktiv tid.
      04. 03.04.06 hhe Regner Operasjonstid over til timer
      05. 20.04.06 hhe Bokf›rer ferdig- og vrakantall, samt vrakkode n†r operasjonstider bokf›res
      06. 18.05.06 hhe Lagt inn "BlankZero" p† feltene "Ferdig. antall" og "Vrakantall"
      07. 28.09.06 hhe Kode som bokf›rer fradragslinjer dersom pauser/lunch
      08. 28.09.07 hhe Utvidet feltlengde p† global variabel="ScrapCode" fra 10 -> 20 tegn
      09. 24.10.07 hhe Overf›rer kommentaren til vraket ->kapasitetspost (via ItemJrnLine)
      10. 09.06.09 BVM Ekstra sjekk for † rydde opp i evt. blankelinjer som oppst†r (b†de start og sluttdato/tid er blanke)
      11. 22.01.10 HHE Fremvist kolonne "Indirekte tid (kode)"
      12. 22.01.10 HHE Kode som setter riktig kode for Indirekte tid.
    }
    END.
  }
}

OBJECT Page 83010 OPC Output Registration
{
  OBJECT-PROPERTIES
  {
    Date=27.09.17;
    Time=10:31:27;
    Modified=Yes;
    Version List=OPC6.01;
  }
  PROPERTIES
  {
    CaptionML=[ENU=OPC Output Registration;
               NOR=OPC Ferdigmeld antall];
    PageType=Card;
    OnInit=BEGIN
             CurrPage.LOOKUPMODE := TRUE;
           END;

  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=NOR=Ferdigmeld antall }

    { 4   ;2   ;Field     ;
                Name=Prod Order No;
                CaptionML=[ENU=Production Order No.;
                           NOR=Prodordrenr.];
                SourceExpr=ProdOrderNoG;
                Editable=FALSE }

    { 5   ;2   ;Field     ;
                Name=Item No;
                CaptionML=[ENU=Item No.;
                           NOR=Varenr.];
                SourceExpr=ItemNoG;
                Editable=FALSE }

    { 2   ;2   ;Field     ;
                Name=Item Description;
                CaptionML=[ENU=Description;
                           NOR=Beskrivelse];
                SourceExpr=ItemDescriptionG;
                Editable=FALSE }

    { 1101104001;2;Field  ;
                Name=Operation Description;
                CaptionML=[ENU=Operation No.;
                           NOR=Operasjonsbeskrivelse];
                SourceExpr=OperationDescriptionG;
                Editable=FALSE;
                Style=Standard;
                StyleExpr=TRUE }

    { 6   ;2   ;Field     ;
                Name=Output Quantity;
                CaptionML=[ENU=Output Quantity;
                           NOR=Ferdigmeld antall];
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=OutputQtyG;
                Style=Standard;
                StyleExpr=TRUE;
                OnValidate=BEGIN
                             CheckQuantity();
                           END;
                            }

    { 11  ;2   ;Field     ;
                Name=Scrap Qty;
                CaptionML=[ENU=Scrap Quantity;
                           NOR=Vraket antall];
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=ScrapQtyG;
                OnValidate=BEGIN
                             CheckQuantity();
                           END;
                            }

    { 13  ;2   ;Field     ;
                Name=Scrap Code;
                CaptionML=[ENU=Scrap Code;
                           NOR=Vrakkode];
                SourceExpr=ScrapCodeG;
                TableRelation=Scrap.Code }

    { 1000000001;2;Field  ;
                Name=Scrap Description;
                CaptionML=[ENU=Scrap Comment;
                           NOR=Kommentar til Vrakkode];
                SourceExpr=ScrapDescriptionG }

    { 1000000002;2;Field  ;
                Name=Scrap Qty2;
                CaptionML=[ENU=Scrap Quantity;
                           NOR=Vraket ant. (type 2)];
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=ScrapQty2G;
                Visible=false;
                OnValidate=BEGIN
                             CheckQuantity();
                           END;
                            }

    { 1000000005;2;Field  ;
                Name=Scrap Code2;
                CaptionML=[ENU=Scrap Code;
                           NOR=Vrakkode(type2)];
                SourceExpr=ScrapCode2G;
                TableRelation=Scrap.Code;
                Visible=false;
                OnLookup=VAR
                           ScrapCode@1000000001 : Record 99000762;
                           ScrapCodes@1101103001 : Page 99000780;
                         BEGIN
                         END;
                          }

    { 1000000007;2;Field  ;
                Name=Scrap Description2;
                CaptionML=[ENU=Scrap Comment 2;
                           NOR=Kommentar til Vrakkode(type2)];
                SourceExpr=ScrapDescription2G;
                Visible=false }

    { 1000000011;2;Field  ;
                Name=Scrap Qty3;
                CaptionML=[ENU=Scrap Quantity;
                           NOR=Vraket ant. (type 3)];
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=ScrapQty3G;
                Visible=false;
                OnValidate=BEGIN
                             CheckQuantity();
                           END;
                            }

    { 1000000012;2;Field  ;
                Name=Scrap Code3;
                CaptionML=[ENU=Scrap Code;
                           NOR=Vrakkode(type3)];
                SourceExpr=ScrapCode3G;
                TableRelation=Scrap.Code;
                Visible=false;
                OnLookup=VAR
                           ScrapCode@1000000001 : Record 99000762;
                           ScrapCodes@1101103001 : Page 99000780;
                         BEGIN
                         END;
                          }

    { 1000000013;2;Field  ;
                Name=Scrap Description3;
                CaptionML=[ENU=Scrap Comment 3;
                           NOR=Kommentar til Vrakkode(type3)];
                SourceExpr=ScrapDescription3G;
                Visible=false }

  }
  CODE
  {
    VAR
      OutputQtyG@1000000000 : Decimal;
      ProdOrderNoG@1000000001 : Code[10];
      ItemNoG@1000000002 : Code[20];
      ItemDescriptionG@1000000003 : Text[50];
      ScrapQtyG@1000000004 : Decimal;
      ScrapCodeG@1000000005 : Code[20];
      OperationDescriptionG@1101104000 : Text[50];
      ScrapQty2G@1000000006 : Decimal;
      ScrapCode2G@1000000007 : Code[20];
      ScrapDescription2G@1000000008 : Text[50];
      ScrapDescriptionG@1000000009 : Text[50];
      ScrapQty3G@1000000010 : Decimal;
      ScrapCode3G@1000000011 : Code[20];
      ScrapDescription3G@1000000012 : Text[50];
      C_INC_ErrorInQty@1101103000 : TextConst 'ENU=Scrap can only be posted together with output quantity.;NOR=Vrak kan kun bokf›res sammen med ferdigantall.';

    PROCEDURE SetText@1(ProdOrderNoP@1000000000 : Code[10];ItemNoP@1000000001 : Code[20];ItemDescriptionP@1000000002 : Text[50];DescriptionP@1101104000 : Text[50]);
    BEGIN
      ProdOrderNoG := ProdOrderNoP;
      ItemNoG := ItemNoP;
      ItemDescriptionG := ItemDescriptionP;
      OperationDescriptionG := DescriptionP;
    END;

    PROCEDURE FindQuantity@2() : Decimal;
    BEGIN
      EXIT(OutputQtyG);
    END;

    PROCEDURE ScrapQty@3() : Decimal;
    BEGIN
      EXIT(ScrapQtyG);
    END;

    PROCEDURE ScrapID@4() : Code[20];
    BEGIN
      EXIT(ScrapCodeG);
    END;

    PROCEDURE ScrapDescription@1000000001() : Text[50];
    BEGIN
      EXIT(ScrapDescriptionG);
    END;

    PROCEDURE ScrapQty2@1000000005() : Decimal;
    BEGIN
      EXIT(ScrapQty2G);
    END;

    PROCEDURE ScrapID2@1000000008() : Code[20];
    BEGIN
      EXIT(ScrapCode2G);
    END;

    PROCEDURE ScrapDescription2@1000000004() : Text[50];
    BEGIN
      EXIT(ScrapDescription2G);
    END;

    PROCEDURE ScrapQty3@1000000000() : Decimal;
    BEGIN
      EXIT(ScrapQty3G);
    END;

    PROCEDURE ScrapID3@1000000002() : Code[20];
    BEGIN
      EXIT(ScrapCode3G);
    END;

    PROCEDURE ScrapDescription3@1000000003() : Text[50];
    BEGIN
      EXIT(ScrapDescription3G);
    END;

    LOCAL PROCEDURE CheckQuantity@1101103001();
    BEGIN
      //Because of limitation of posting scrap in standard NAV
      IF (OutputQtyG = 0) AND ((ScrapQtyG + ScrapQty2G + ScrapQty3G) <> 0) THEN
          ERROR(C_INC_ErrorInQty);
    END;

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01.  28.09.07  HHE    Utvidet feltlengde p† Global var.=Vrakkode fra 10->20 tegn
      02.  02.05.08  HEI    Vrakkode 2 og 3. Henter fra FromFerdigMeld, og bokf›rer hvis de har verdi
    }
    END.
  }
}

OBJECT Page 83011 OPC Setup
{
  OBJECT-PROPERTIES
  {
    Date=27.09.17;
    Time=15:55:35;
    Modified=Yes;
    Version List=OPC6.01;
  }
  PROPERTIES
  {
    CaptionML=[ENU=OPC Setup;
               NOR=OPC Oppsett];
    SourceTable=Table83001;
    PageType=Card;
    ActionList=ACTIONS
    {
      { 1101103003;  ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1101103004;1 ;ActionGroup }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=ENU=General }

    { 2   ;2   ;Field     ;
                SourceExpr="Output Jnl. Templ. Name Qty" }

    { 5   ;2   ;Field     ;
                SourceExpr="Output Jnl. Batch Name Qty" }

    { 7   ;2   ;Field     ;
                SourceExpr="Output Jnl. Templ. Name Time" }

    { 9   ;2   ;Field     ;
                SourceExpr="Output Jnl. Batch Name Time" }

    { 1101103011;2;Field  ;
                SourceExpr="Output Jnl. Templ. Name Corr" }

    { 1101103012;2;Field  ;
                SourceExpr="Output Jnl. Batch Name Corr" }

    { 1000000000;2;Field  ;
                SourceExpr="Document No. Ind.Time" }

    { 1101103010;2;Field  ;
                SourceExpr="Auto Insert Machine Center" }

    { 1000000002;2;Field  ;
                SourceExpr="Item Reclass. Jnl Templ. Name" }

    { 1000000004;2;Field  ;
                SourceExpr="Item Reclass. Jnl.Batch  Name" }

    { 1101103005;2;Field  ;
                SourceExpr="Cap. Jnl. Templ. Name Corr" }

    { 1101103006;2;Field  ;
                SourceExpr="Cap. Jnl. Batch Name Corr" }

    { 1101103007;2;Field  ;
                SourceExpr="Cap. Jnl. Templ. Name Indirect" }

    { 1101103009;2;Field  ;
                SourceExpr="Cap. Jnl. Batch Name Indirect" }

    { 1000000006;2;Field  ;
                SourceExpr="OPC-Move Location Code" }

    { 1101103008;1;Group  ;
                Name=Error Log Group;
                CaptionML=[ENU=Error Log;
                           NOR=Feillog];
                GroupType=Group }

    { 1101103001;2;Field  ;
                SourceExpr="Item Journal Template Name" }

    { 1101103002;2;Field  ;
                SourceExpr="Item Journal Batch Name" }

    { 1101103000;1;Field  ;
                SourceExpr="Warning Picture" }

  }
  CODE
  {

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 29.03.06 ASL Hentet frem felt:"Document No. Ind.Time"
      02. 17.08.10 HHE Nytt felt:"Item Reclass. Journal (templ.)" (brukes i OPC - flytt komponent)
                       Nytt felt:"Item Reclass. Journal (Name)"   (brukes i OPC - flytt komponent)
      03. 19.08.10 HHE Nytt felt: "OPC-flytt fra"
    }
    END.
  }
}

OBJECT Page 83013 OPC Time Registered
{
  OBJECT-PROPERTIES
  {
    Date=28.09.17;
    Time=13:16:29;
    Modified=Yes;
    Version List=OPC6.01;
  }
  PROPERTIES
  {
    CaptionML=[ENU=OPC Time Registered;
               NOR=OPC Registrert m›nstret tid];
    SourceTable=Table83007;
    PageType=List;
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1101104000;1;Group  ;
                GroupType=Repeater }

    { 1000000000;2;Field  ;
                SourceExpr="Machine Center" }

    { 1101104017;2;Field  ;
                SourceExpr="Machine Center Name" }

    { 1101104003;2;Field  ;
                SourceExpr="Start Date" }

    { 1101104005;2;Field  ;
                SourceExpr="Start Time" }

    { 1101104007;2;Field  ;
                SourceExpr="End Date" }

    { 1101104009;2;Field  ;
                SourceExpr="End Time" }

    { 1101104011;2;Field  ;
                SourceExpr=Quantity }

    { 1101104015;2;Field  ;
                SourceExpr="Time Type" }

    { 1000000002;2;Field  ;
                SourceExpr=Absence }

  }
  CODE
  {

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 28.09.17 JAL Upgraded to NAV 2017
    }
    END.
  }
}

OBJECT Page 83015 OPC Time Register Card
{
  OBJECT-PROPERTIES
  {
    Date=20.09.17;
    Time=15:17:30;
    Modified=Yes;
    Version List=OPC6.01;
  }
  PROPERTIES
  {
    CaptionML=[ENU=OPC Time Register Card;
               NOR=OPC M›nstringskort];
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=Yes;
    SourceTable=Table99000758;
    SourceTableView=SORTING(No.)
                    ORDER(Ascending)
                    WHERE(Clocking=CONST(Yes));
    PageType=Card;
    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000009;1 ;Action    ;
                      Name=Register Time;
                      CaptionML=[ENU=&Register Time;
                                 NOR=&Registrer tid];
                      Promoted=Yes;
                      Image=Register;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 ClockingMgt.RUN(Rec);
                               END;
                                }
      { 1101103000;1 ;Action    ;
                      Name=Absence;
                      CaptionML=[ENU=A&bsence;
                                 NOR=Fr&av‘r];
                      Promoted=Yes;
                      Image=WorkCenterAbsence;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 CalendarAbsenceEntry@1000000000 : Record 99000760;
                               BEGIN
                                  CalendarAbsenceEntry.RESET;
                                  CalendarAbsenceEntry.SETRANGE("Capacity Type", CalendarAbsenceEntry."Capacity Type"::"Machine Center");
                                  CalendarAbsenceEntry.SETRANGE("No.", "No.");
                                  CalendarAbsenceEntry.SETFILTER(Date, GETFILTER("Date Filter"));
                                  PAGE.RUNMODAL(PAGE::"Capacity Absence", CalendarAbsenceEntry);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000000;1;Group  ;
                CaptionML=NOR=Generelt }

    { 1000000005;2;Field  ;
                SourceExpr="No.";
                Editable=FALSE }

    { 1000000003;2;Field  ;
                SourceExpr=Name;
                Editable=FALSE }

    { 1000000007;2;Field  ;
                Name=DateFilter;
                CaptionML=[ENU=Date Filter;
                           NOR=Datofilter];
                SourceExpr="Date Filter";
                Visible=false }

    { 1000000002;1;Part   ;
                Name=Time Register Subform;
                SubPageLink=Machine Center=FIELD(No.),
                            Start Date=FIELD(Date Filter);
                PagePartID=Page83016 }

  }
  CODE
  {
    VAR
      ClockingMgt@1000000000 : Codeunit 83001;
      DateFilterG@1101103000 : Text;

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 16.08.17 JAL Migrated to NAV 2017
    }
    END.
  }
}

OBJECT Page 83016 OPC Time Register Subform
{
  OBJECT-PROPERTIES
  {
    Date=02.10.17;
    Time=01:31:42;
    Modified=Yes;
    Version List=OPC6.01;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=OPC Time Register;
               NOR=OPC M›nstring];
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=No;
    SourceTable=Table83007;
    PageType=ListPart;
    OnOpenPage=BEGIN
                 SetDateFilter(WORKDATE);
               END;

  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000000;1;Group  ;
                Name=RepeaterRunTimes;
                CaptionML=[ENU=Run Times;
                           NOR=Tidslinjer];
                GroupType=Repeater }

    { 1000000001;2;Field  ;
                SourceExpr="Start Date" }

    { 1000000003;2;Field  ;
                SourceExpr="Start Time" }

    { 1000000005;2;Field  ;
                SourceExpr="End Date" }

    { 1000000007;2;Field  ;
                SourceExpr="End Time" }

    { 1000000009;2;Field  ;
                SourceExpr=Quantity }

    { 1000000013;2;Field  ;
                SourceExpr=Absence }

  }
  CODE
  {

    PROCEDURE SetDateFilter@1101103000(DateFilterL@1101103000 : Date);
    BEGIN
      Rec.SETRANGE("Start Date", DateFilterL);
    END;

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 16.08.17 JAL Migrated to NAV 2017
    }
    END.
  }
}

OBJECT Page 83017 OPC Time Register List
{
  OBJECT-PROPERTIES
  {
    Date=20.09.17;
    Time=15:17:30;
    Modified=Yes;
    Version List=OPC6.02;
  }
  PROPERTIES
  {
    CaptionML=[ENU=OPC Time Register List;
               NOR=OPC M›nstringsliste];
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=No;
    SourceTable=Table99000758;
    SourceTableView=WHERE(Clocking=CONST(Yes));
    PageType=List;
    CardPageID=OPC Time Register Card;
    ActionList=ACTIONS
    {
      { 1101103002;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1101103000;1 ;Action    ;
                      Name=Register Time;
                      CaptionML=[ENU=&Register Time;
                                 NOR=&Registrer tid];
                      Promoted=Yes;
                      Image=Register;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ClockingMgtL@1101103000 : Codeunit 83001;
                                 MachineCenterL@1101103001 : Record 99000758;
                               BEGIN
                                 CurrPage.SETSELECTIONFILTER(MachineCenterL);
                                 IF MachineCenterL.FINDFIRST THEN
                                   REPEAT
                                     ClockingMgtL.RUN(MachineCenterL);
                                   UNTIL MachineCenterL.NEXT = 0;
                               END;
                                }
      { 1101103001;1 ;Action    ;
                      Name=Absence;
                      CaptionML=[ENU=A&bsence;
                                 NOR=Fr&av‘r];
                      Promoted=Yes;
                      Image=WorkCenterAbsence;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 CalendarAbsenceEntry@1000000000 : Record 99000760;
                               BEGIN
                                  CalendarAbsenceEntry.RESET;
                                  CalendarAbsenceEntry.SETRANGE("Capacity Type", CalendarAbsenceEntry."Capacity Type"::"Machine Center");
                                  CalendarAbsenceEntry.SETRANGE("No.", "No.");
                                  CalendarAbsenceEntry.SETFILTER(Date, GETFILTER("Date Filter"));
                                  PAGE.RUNMODAL(PAGE::"Capacity Absence", CalendarAbsenceEntry);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000000;1;Group  ;
                Editable=FALSE;
                GroupType=Repeater }

    { 1000000001;2;Field  ;
                SourceExpr="No." }

    { 1000000003;2;Field  ;
                SourceExpr=Name }

    { 1101103003;1;Part   ;
                Name=OPC Time Register Subform;
                SubPageLink=Machine Center=FIELD(No.);
                PagePartID=Page83016;
                PartType=Page;
                UpdatePropagation=Both }

  }
  CODE
  {

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 15.08.17 JAL Merged object to NAV 2017
      02. 16.08.17 JAL Added Actions from card page.
                       Added multiple selection for time registering.
    }
    END.
  }
}

OBJECT Page 83020 OPC Machine Center Status
{
  OBJECT-PROPERTIES
  {
    Date=20.09.17;
    Time=15:17:30;
    Modified=Yes;
    Version List=OPC6.03;
  }
  PROPERTIES
  {
    CaptionML=[ENU=OPC Resource Status;
               NOR=OPC Produksjonsressursstatus];
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=No;
    SourceTable=Table83010;
    SourceTableView=SORTING(Entry No.,Prod. Order No.,Routing No.,Operation No.,Machine Center)
                    ORDER(Ascending)
                    WHERE(Ending Date=FILTER(''),
                          Machine Center=FILTER(<>''),
                          Starting Date=FILTER(>01.01.00));
    PageType=List;
    TimerUpdate=5000;
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000000;1;Field  ;
                CaptionClass=Text19071011;
                Style=Strong;
                StyleExpr=TRUE }

    { 1   ;1   ;Group     ;
                Editable=FALSE;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                SourceExpr="Machine Center" }

    { 4   ;2   ;Field     ;
                SourceExpr=Description }

    { 1000000002;2;Field  ;
                SourceExpr="Stop Code" }

    { 1000000001;2;Field  ;
                SourceExpr="Prod. Order No.";
                OnLookup=VAR
                           ProdOrder@1101110000 : Record 5405;
                         BEGIN
                           //02.->
                           ProdOrder.SETRANGE(Status,ProdOrder.Status::Released);
                           ProdOrder.SETRANGE("No.","Prod. Order No.");
                           PAGE.RUNMODAL(PAGE::"Production Order List",ProdOrder);
                           //02.<-
                         END;
                          }

    { 8   ;2   ;Field     ;
                SourceExpr="Operation No." }

    { 10  ;2   ;Field     ;
                CaptionML=[ENU=Starting Date;
                           NOR=Startdato];
                SourceExpr="Starting Date" }

    { 12  ;2   ;Field     ;
                CaptionML=[ENU=Starting Time;
                           NOR=Starttid];
                SourceExpr="Starting Time" }

    { 1000000004;2;Field  ;
                CaptionML=NOR=P†logget ved prod.ress;
                SourceExpr="Work Done at M.C." }

  }
  CODE
  {
    VAR
      Text19071011@19015358 : TextConst 'NOR=P†logget operasjon';

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 14.12.05 HHE Insert/delete/modify = no
                       Fremvist P.o.nr
      02. 24.08.09 HHE Felt "Prod.o.nr." - ved oppslag kommer man direkte inn p† frigitt p.o. (jfr. PTL)
      03. 22.01.10 HHE Fremvist kolonne for "Indirekte tid (kode)"
    }
    END.
  }
}

OBJECT Page 83022 OPC Run Times Deduction
{
  OBJECT-PROPERTIES
  {
    Date=28.09.17;
    Time=13:20:02;
    Modified=Yes;
    Version List=OPC6.01;
  }
  PROPERTIES
  {
    CaptionML=[ENU=OPC Run Times Deduction;
               NOR=OPC Fratrekk i operasjonstid];
    SourceTable=Table83012;
    PageType=List;
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000000;1;Group  ;
                GroupType=Repeater }

    { 1000000001;2;Field  ;
                SourceExpr=Code }

    { 1000000003;2;Field  ;
                SourceExpr=Description }

    { 1000000005;2;Field  ;
                SourceExpr="From Time" }

    { 1000000007;2;Field  ;
                SourceExpr="To Time" }

    { 1000000009;2;Field  ;
                SourceExpr="Deduct Prod. Order" }

  }
  CODE
  {

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 28.09.17 JAL Upgraded to NAV 2017
    }
    END.
  }
}

OBJECT Page 83023 OPC Firm Planned Tasks
{
  OBJECT-PROPERTIES
  {
    Date=28.09.17;
    Time=13:21:28;
    Modified=Yes;
    Version List=OPC6.01;
  }
  PROPERTIES
  {
    CaptionML=[ENU=OPC Firm Planned Tasks;
               NOR=OPC Fast planlagte oppgaver];
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=No;
    SourceTable=Table5409;
    SourceTableView=SORTING(Type,No.,Starting Date)
                    ORDER(Ascending)
                    WHERE(Type=FILTER(Machine Center),
                          Routing Status=FILTER(<>Finished));
    DataCaptionFields=No.;
    PageType=List;
    RefreshOnActivate=Yes;
    OnAfterGetRecord=BEGIN
                       CLEAR(WarningIndex);
                       CLEAR(OrgQty);
                       ProdOrdrelinje.SETRANGE(ProdOrdrelinje.Status, ProdOrdrelinje.Status::"Firm Planned"); //hhe 17.06.09: Endret fra Released
                       ProdOrdrelinje.SETRANGE(ProdOrdrelinje."Prod. Order No.", "Prod. Order No.");
                       ProdOrdrelinje.SETRANGE(ProdOrdrelinje."Routing No.", "Routing No.");

                       IF ProdOrdrelinje.FINDFIRST THEN BEGIN
                         //BVM--->
                         OrgQty := ProdOrdrelinje.Quantity;
                         //BVM---<
                         IF Vare.GET(ProdOrdrelinje."Item No.") THEN BEGIN
                           VareNr := Vare."No.";
                           VareBesk := Vare.Description;
                           //SID.OJO ----------->
                           ProdOrdreKomponent.RESET;
                           //02 +
                           //ProdOrdreKomponent.SETRANGE(Status,Status::Released);
                           ProdOrdreKomponent.SETRANGE(Status, Status::"Firm Planned");
                           // 02-
                           ProdOrdreKomponent.SETRANGE("Prod. Order No.", "Prod. Order No.");
                           //hhe
                           ProdOrdreKomponent.SETRANGE("Routing Link Code", "Routing Link Code");
                           //hhe
                           IF ProdOrdreKomponent.FINDFIRST THEN
                             REPEAT
                               CLEAR(ItemInventory);
                               CLEAR(Item);
                               IF Item.GET(ProdOrdreKomponent."Item No.") THEN BEGIN
                                 Item.SETRANGE("Location Filter", ProdOrdreKomponent."Location Code");
                                 Item.CALCFIELDS(Inventory);
                                 ItemInventory := Item.Inventory;
                                 IF (ItemInventory - ProdOrdreKomponent."Remaining Quantity") < 0 THEN
                                   WarningIndex := 1;
                               END;
                             UNTIL ProdOrdreKomponent.NEXT = 0;
                       //<---------- SID.OJO
                         END;
                       END;
                       //BVM -->
                        RemQty := OrgQty - "Finished Qty";
                       //BVM --<
                       IF WarningIndex = 1 THEN BEGIN
                         OPCSetupG.GET;
                         OPCSetupG.CALCFIELDS("Warning Picture");
                       END
                       ELSE
                         OPCSetupG.INIT;
                     END;

    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000008;1 ;Action    ;
                      CaptionML=[ENU=Comments;
                                 NOR=Merknader];
                      RunObject=Page 99000840;
                      RunPageLink=Status=FIELD(Status),
                                  Prod. Order No.=FIELD(Prod. Order No.),
                                  Routing Reference No.=FIELD(Routing Reference No.),
                                  Routing No.=FIELD(Routing No.),
                                  Operation No.=FIELD(Operation No.);
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Comment;
                      PromotedCategory=Process }
      { 1000000004;1 ;Action    ;
                      Name=Related document;
                      CaptionML=[ENU=Related document;
                                 NOR=Tilknyttet dokument];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Relationship;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 //004.->
                                 //TESTFIELD("Dokument Link");
                                 HYPERLINK("Dokument Link");
                                 //SHELL(ENVIRON('windir')+'\'+'Explorer.exe', "Dokument Link");

                                 //004.<-
                               END;
                                }
      { 1000000005;1 ;Action    ;
                      Name=Stykkliste;
                      CaptionML=[ENU=BOM List;
                                 NOR=Stykkliste];
                      RunObject=Page 83004;
                      RunPageView=WHERE(Status=FILTER(Firm Planned),
                                        Prod. Order Line No.=CONST(10000));
                      RunPageLink=Prod. Order No.=FIELD(Prod. Order No.);
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=BOM;
                      PromotedCategory=Process }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                Editable=FALSE;
                GroupType=Repeater }

    { 10  ;2   ;Field     ;
                SourceExpr="Starting Date" }

    { 16  ;2   ;Field     ;
                SourceExpr="Prod. Order No." }

    { 2   ;2   ;Field     ;
                CaptionML=[ENU=Operation No.;
                           NOR=Op.nr.];
                SourceExpr="Operation No." }

    { 1000000000;2;Field  ;
                CaptionML=NOR=Varenr.;
                SourceExpr=VareNr }

    { 1000000002;2;Field  ;
                CaptionML=NOR=Varebeskr.;
                SourceExpr=VareBesk }

    { 6   ;2   ;Field     ;
                CaptionML=[ENU=Description;
                           NOR=Operasj.beskr.];
                SourceExpr=Description }

    { 1101103000;2;Field  ;
                Name=Warning;
                CaptionML=[ENU=Warning;
                           NOR=Varsel];
                SourceExpr=OPCSetupG."Warning Picture";
                Editable=false }

    { 1000000013;2;Field  ;
                CaptionML=[ENU=Ordred qty.;
                           NOR=Ordreantall];
                DecimalPlaces=0:0;
                SourceExpr=OrgQty }

    { 18  ;2   ;Field     ;
                CaptionML=[ENU=Planned qty;
                           NOR=Planlagt];
                SourceExpr="Input Quantity";
                Visible=FALSE }

    { 22  ;2   ;Field     ;
                CaptionML=[ENU=Finished Quantity;
                           NOR=Ferdig];
                DecimalPlaces=0:2;
                SourceExpr="Finished Qty" }

    { 1000000015;2;Field  ;
                CaptionML=[ENU=Remaining Qty;
                           NOR=Restantall];
                DecimalPlaces=0:0;
                SourceExpr=RemQty;
                Style=Standard;
                StyleExpr=TRUE }

    { 1000000011;2;Field  ;
                CaptionML=NOR=Plan ress tid;
                SourceExpr="Expected Capacity Need" }

    { 26  ;2   ;Field     ;
                DecimalPlaces=0:2;
                SourceExpr="Actual Run Time" }

    { 24  ;2   ;Field     ;
                SourceExpr="Dokument Link" }

  }
  CODE
  {
    VAR
      ProdOrdrelinje@1000000000 : Record 5406;
      Vare@1000000001 : Record 27;
      OPCOppsett@1000000004 : Record 83001;
      VareBesk@1000000002 : Text[50];
      VareNr@1000000003 : Text[50];
      FerdigmeldAntall@1000000005 : Decimal;
      FerdigMeldKladdLinje@1000000006 : Record 83;
      tilDok@1000000012 : Record 5409;
      ScrapCode@1000000009 : Code[20];
      "-Si-data-"@1000000010 : Text[30];
      VrakAnt2@1000000019 : Decimal;
      VrakBeskr2@1000000022 : Text[50];
      VrakKode2@1000000023 : Code[20];
      VrakKode@1000000024 : Code[20];
      VrakBeskr@1000000025 : Text[50];
      VrakAnt3@1000000014 : Decimal;
      VrakBeskr3@1000000013 : Text[50];
      VrakKode3@1000000011 : Code[20];
      WarningIndex@1000000015 : Integer;
      ProdOrdreKomponent@1000000016 : Record 5407;
      OPCSetupG@1101103000 : Record 83001;
      ItemInventory@1000000017 : Decimal;
      Item@1000000018 : Record 27;
      OrgQty@1000000020 : Decimal;
      RemQty@1000000021 : Decimal;

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 17.06.09 HHE Opprettet etter ›nske fra PTL.
                       Basert p† FRM 83001. Fjernet knapper for Tidreg. + Ferdigmelding
                       Filter p† Fast planlagte operasjoner
      02. 13.08.15 MNO Fix Change setrange from "Released" -> "Firm Planned"
    }
    END.
  }
}

OBJECT Page 83027 OPC Indirect Time Admin
{
  OBJECT-PROPERTIES
  {
    Date=20.09.17;
    Time=15:30:46;
    Modified=Yes;
    Version List=OPC6.01;
  }
  PROPERTIES
  {
    CaptionML=[ENU=OPC Indirect Time Admin;
               NOR=OPC Indirekte tid Admin];
    SourceTable=Table83011;
    PageType=List;
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1101104000;1;Group  ;
                GroupType=Repeater }

    { 1101104001;2;Field  ;
                SourceExpr=Code }

    { 1101104003;2;Field  ;
                SourceExpr=Description }

  }
  CODE
  {

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 15.09.17 JAL Migrated from Form to Page
    }
    END.
  }
}

OBJECT Page 83028 OPC Indirect Time
{
  OBJECT-PROPERTIES
  {
    Date=01.10.17;
    Time=22:21:13;
    Modified=Yes;
    Version List=OPC6.02;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=OPC Indirect Time;
               NOR=OPC Indirekte tid];
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=No;
    SourceTable=Table83011;
    PageType=List;
    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1101104008;1 ;Action    ;
                      Name=Register Time;
                      CaptionML=[ENU=Start/Stop Time;
                                 NOR=Start/stopp tid];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Start;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ClockingMgtL@1101103001 : Codeunit 83001;
                               BEGIN
                                 ClockingMgtL.OpenRegisterTimeOnIndirectTime(MachineCenterNoG, Rec.Code);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1101104000;1;Group  ;
                GroupType=Repeater }

    { 1101104001;2;Field  ;
                SourceExpr=Code }

    { 1101104003;2;Field  ;
                SourceExpr=Description }

  }
  CODE
  {
    VAR
      MachineCenterNoG@1000000000 : Code[20];

    PROCEDURE InitForm@1000000000(MachineNo@1000000000 : Code[20]);
    BEGIN
      MachineCenterNoG := MachineNo;
    END;

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 29.03.06 ASL Endret p† kode Start / stopp tid
      02. 03.04.06 HHE Fjernet filter "Work done at M.C"
    }
    END.
  }
}

OBJECT Page 83030 OPC Move Components
{
  OBJECT-PROPERTIES
  {
    Date=28.09.17;
    Time=13:25:32;
    Modified=Yes;
    Version List=OPC6.01;
  }
  PROPERTIES
  {
    CaptionML=[ENU=OPC Move Components;
               NOR=OPC Flytt komponenter];
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=Yes;
    SourceTable=Table5407;
    PageType=List;
    OnInit=BEGIN
             //hhe 19.08.10->
             OPCOppsett.GET;
             //hhe 19.08.10<-
           END;

    OnAfterGetRecord=BEGIN
                       //hhe 18.08.10->
                       "Shipped qty - remaining" := "Remaining Quantity" - Shipped;
                       Beholdning := 0;
                       IF rec_Item.GET("Item No.") THEN BEGIN
                         rec_Item.SETRANGE("Location Filter",OPCOppsett."OPC-Move Location Code");
                         rec_Item.CALCFIELDS(Inventory);
                         Beholdning := rec_Item.Inventory;
                       END;
                       //hhe 18.08.10<-
                     END;

    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000026;1 ;Action    ;
                      CaptionML=NOR=Bokf›r flytting;
                      Promoted=Yes;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ProdOrderComp@1000000001 : Record 5407;
                                 ProdOrderComp2@1000000002 : Record 5407;
                               BEGIN
                                 //17.08.10->
                                 IF NewLocationCode = '' THEN
                                   ERROR('Du m† angi "Flytt til lokasjonskode"');

                                 IF NewLocationCode = OPCOppsett."OPC-Move Location Code" THEN
                                   ERROR('Du kan ikke angi %1 som "Flytt til lokasjonskode"',OPCOppsett."OPC-Move Location Code");

                                 ProdOrderComp.COPY(Rec);
                                 ProdOrderComp.SETFILTER("Ship now",'>0');
                                 IF ProdOrderComp.FIND('-') THEN BEGIN
                                   //overf›rer Prod.o.komponentlinjene inn i Overf›ringskladd
                                   OverfKladdLinje.SETRANGE(OverfKladdLinje."Journal Template Name", OPCOppsett."Item Reclass. Jnl Templ. Name");
                                   OverfKladdLinje.SETRANGE(OverfKladdLinje."Journal Batch Name", OPCOppsett."Item Reclass. Jnl.Batch  Name");
                                   IF OverfKladdLinje.FIND('-') THEN
                                    OverfKladdLinje.DELETEALL;
                                   OverfKladdLinje."Line No." := 0;
                                   REPEAT
                                     OverfKladdLinje.INIT;
                                     OverfKladdLinje.VALIDATE("Journal Template Name", OPCOppsett."Item Reclass. Jnl Templ. Name");
                                     OverfKladdLinje.VALIDATE("Journal Batch Name", OPCOppsett."Item Reclass. Jnl.Batch  Name");
                                     OverfKladdLinje."Line No." := OverfKladdLinje."Line No." +10000;
                                     OverfKladdLinje.INSERT(TRUE);

                                     OverfKladdLinje."Entry Type" := OverfKladdLinje."Entry Type"::Transfer;
                                     OverfKladdLinje."Posting Date" := TODAY;
                                     OverfKladdLinje."Document Date" := TODAY;
                                     OverfKladdLinje."Document No." := 'OPC-flytt';
                                     OverfKladdLinje.VALIDATE("Item No.", ProdOrderComp."Item No.");
                                     OverfKladdLinje.VALIDATE("Location Code",OPCOppsett."OPC-Move Location Code");
                                     OverfKladdLinje.VALIDATE(Quantity,ProdOrderComp."Ship now");
                                     OverfKladdLinje.VALIDATE("New Location Code",NewLocationCode);
                                     OverfKladdLinje.VALIDATE("Order Type", OverfKladdLinje."Order Type"::Production);
                                     OverfKladdLinje.VALIDATE("Order No.", "Prod. Order No.");
                                     OverfKladdLinje.MODIFY(TRUE);
                                     ProdOrderComp2.COPY(ProdOrderComp);
                                     ProdOrderComp2."Ship now" := 0;
                                     ProdOrderComp2.MODIFY;

                                   UNTIL ProdOrderComp.NEXT = 0;
                                 END;

                                 //bokf›rer overf›ringskladden
                                 CODEUNIT.RUN(CODEUNIT::"Item Jnl.-Post",OverfKladdLinje);

                                 //hvis vellykket bokf›ring, s† ...
                                 //ProdOrderComp2.COPY(Rec);
                                 {
                                 IF ProdOrderComp.FIND('-') THEN BEGIN
                                   ProdOrderComp2."Ship now" := 0;
                                   ProdOrderComp2.MODIFY;
                                 END;
                                 }
                                 //18.08.10<-
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000000;1;Group  ;
                Editable=TRUE;
                GroupType=Repeater }

    { 1000000005;2;Field  ;
                SourceExpr="Item No.";
                Editable=FALSE }

    { 1000000007;2;Field  ;
                SourceExpr=Description;
                Editable=FALSE }

    { 1000000031;2;Field  ;
                CaptionML=NOR=Beholdn. - Hoved;
                DecimalPlaces=0:2;
                SourceExpr=Beholdning;
                Editable=FALSE }

    { 1000000009;2;Field  ;
                SourceExpr="Unit of Measure Code";
                Editable=FALSE }

    { 1000000027;2;Field  ;
                DecimalPlaces=0:2;
                SourceExpr=Shipped;
                Editable=FALSE }

    { 1000000011;2;Field  ;
                CaptionML=NOR=Gjenst†r † flytte;
                DecimalPlaces=0:2;
                SourceExpr="Remaining Quantity" - Shipped;
                Editable=FALSE }

    { 1000000029;2;Field  ;
                DecimalPlaces=0:2;
                SourceExpr="Ship now" }

    { 1000000002;1;Field  ;
                SourceExpr=OPCOppsett."OPC-Move Location Code";
                TableRelation=Location.Code;
                Editable=FALSE }

    { 1000000024;1;Field  ;
                SourceExpr=NewLocationCode;
                TableRelation=Location.Code }

    { 1000000025;1;Field  ;
                CaptionClass=Text19028583 }

    { 1000000001;1;Field  ;
                CaptionClass=Text19076695 }

    { 1000000021;1;Field  ;
                CaptionClass=Text19042457 }

    { 1000000020;1;Field  ;
                CaptionClass=Text19028137 }

    { 1000000003;1;Field  ;
                CaptionClass=Text19027444 }

    { 1000000019;1;Field  ;
                CaptionClass=Text19015144 }

    { 1000000018;1;Field  ;
                CaptionClass=Text19006185 }

  }
  CODE
  {
    VAR
      NewLocationCode@1000000000 : Code[10];
      OverfKladdLinje@1000000001 : Record 83;
      OPCOppsett@1000000002 : Record 83001;
      Beholdning@1000000003 : Decimal;
      rec_Item@1000000004 : Record 27;
      Text19006185@19047498 : TextConst 'NOR=Dette bildet brukes for † flytte komponenter fra en lokasjon til en ny';
      Text19015144@19061235 : TextConst 'NOR="For † flytte beholdningen fra angitt lokasjon til en ny, s† skal du gj›re f›lgende: "';
      Text19027444@19029557 : TextConst 'NOR=1) For de varelinjer du vil flytte: angi enn verdi i feltet "Flytt n† (antall)"';
      Text19028137@19008317 : TextConst 'NOR=2) Angi en verdi i feltet "Flytt til lokasjonskode"';
      Text19042457@19034517 : TextConst 'NOR=3) Trykk p† knappen "Bokf›r flytting"';
      Text19076695@19025829 : TextConst 'NOR=Flytt fra lokasjonskode:';
      Text19028583@19034388 : TextConst 'NOR=Flytt til lokasjonskode:';

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 28.09.17 JAL Upgraded to NAV 2017
    }
    END.
  }
}

OBJECT Page 83040 OPC Sales Order List
{
  OBJECT-PROPERTIES
  {
    Date=20.09.17;
    Time=15:17:32;
    Modified=Yes;
    Version List=NAVW110.00,NAVNO10.00,OPC6.01;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Sales Orders;
               NOR=Ordrer];
    SourceTable=Table36;
    SourceTableView=WHERE(Document Type=CONST(Order));
    DataCaptionFields=Sell-to Customer No.;
    PageType=List;
    CardPageID=OPC Sales Order List;
    RefreshOnActivate=Yes;
    PromotedActionCategoriesML=[ENU=New,Process,Report,Request Approval,Order;
                                NOR=Ny,Behandle,Rapporter,Be om godkjenning,Ordre];
    OnOpenPage=VAR
                 SalesSetup@1000 : Record 311;
                 CRMIntegrationManagement@1001 : Codeunit 5330;
                 OfficeMgt@1002 : Codeunit 1630;
               BEGIN
                 IF UserMgt.GetSalesFilter <> '' THEN BEGIN
                   FILTERGROUP(2);
                   SETRANGE("Responsibility Center",UserMgt.GetSalesFilter);
                   FILTERGROUP(0);
                 END;

                 SETRANGE("Date Filter",0D,WORKDATE - 1);

                 JobQueueActive := SalesSetup.JobQueueActive;
                 CRMIntegrationEnabled := CRMIntegrationManagement.IsCRMIntegrationEnabled;
                 IsOfficeAddin := OfficeMgt.IsAvailable;

                 CopySellToCustomerFilter;
               END;

    OnFindRecord=BEGIN
                   EXIT(FIND(Which) AND ShowHeader);
                 END;

    OnNextRecord=VAR
                   NewStepCount@1000 : Integer;
                 BEGIN
                   REPEAT
                     NewStepCount := NEXT(Steps);
                   UNTIL (NewStepCount = 0) OR ShowHeader;

                   EXIT(NewStepCount);
                 END;

    OnAfterGetCurrRecord=BEGIN
                           SetControlVisibility;
                           CurrPage.IncomingDocAttachFactBox.PAGE.LoadDataFromRecord(Rec);
                         END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1102601000;1 ;ActionGroup;
                      CaptionML=[ENU=O&rder;
                                 NOR=O&rdre];
                      Image=Order }
      { 1102601013;2 ;Action    ;
                      AccessByPermission=TableData 348=R;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 NOR=Dimensjoner];
                      ToolTipML=[ENU=View or edits dimensions, such as area, project, or department, that you can assign to sales and purchase documents to distribute costs and analyze transaction history.;
                                 NOR=Vis eller rediger dimensjoner, for eksempel omr†de, prosjekt eller avdeling, som du kan tilordne til salgs- og kj›psdokumenter for † distribuere kostnader og analysere transaksjonshistorikk.];
                      ApplicationArea=#Suite;
                      Image=Dimensions;
                      OnAction=BEGIN
                                 ShowDocDim;
                               END;
                                }
      { 1102601006;2 ;Action    ;
                      Name=Statistics;
                      ShortCutKey=F7;
                      CaptionML=[ENU=Statistics;
                                 NOR=Statistikk];
                      Promoted=Yes;
                      Image=Statistics;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 OpenSalesOrderStatistics;
                               END;
                                }
      { 1102601014;2 ;Action    ;
                      Name=Approvals;
                      CaptionML=[ENU=Approvals;
                                 NOR=Godkjenninger];
                      ToolTipML=[ENU=View a list of the records that are waiting to be approved. For example, you can see who requested the record to be approved, when it was sent, and when it is due to be approved.;
                                 NOR=Vis en liste med poster dom venter p† † bli godkjent. Du kan for eksempel se hvem som har bedt om godkjenning av posten, n†r den ble sendt og n†r den forfaller til godkjenning.];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      Image=Approvals;
                      PromotedCategory=Category5;
                      PromotedOnly=Yes;
                      OnAction=VAR
                                 ApprovalEntries@1001 : Page 658;
                               BEGIN
                                 ApprovalEntries.Setfilters(DATABASE::"Sales Header","Document Type","No.");
                                 ApprovalEntries.RUN;
                               END;
                                }
      { 1102601008;2 ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 NOR=&Merknader];
                      RunObject=Page 67;
                      RunPageLink=Document Type=FIELD(Document Type),
                                  No.=FIELD(No.),
                                  Document Line No.=CONST(0);
                      Image=ViewComments }
      { 9       ;1   ;ActionGroup;
                      CaptionML=[ENU=Documents;
                                 NOR=Dokumenter];
                      Image=Documents }
      { 1102601009;2 ;Action    ;
                      CaptionML=[ENU=S&hipments;
                                 NOR=F&›lgesedler];
                      ToolTipML=[ENU=View the history of posted sales shipments that have been posted for the document.;
                                 NOR=Vis historikken for bokf›rte f›lgesedler som har blitt bokf›rt for dokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 142;
                      RunPageView=SORTING(Order No.);
                      RunPageLink=Order No.=FIELD(No.);
                      Image=Shipment }
      { 1102601010;2 ;Action    ;
                      Name=PostedSalesInvoices;
                      CaptionML=[ENU=Invoices;
                                 NOR=Fakturaer];
                      ToolTipML=[ENU=View the history of posted sales invoices that have been posted for the document.;
                                 NOR=Vis historikken for bokf›rte salgsfakturaer som har blitt bokf›rt for dokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 143;
                      RunPageView=SORTING(Order No.);
                      RunPageLink=Order No.=FIELD(No.);
                      Image=Invoice }
      { 1102601011;2 ;Action    ;
                      Name=PostedSalesPrepmtInvoices;
                      CaptionML=[ENU=Prepa&yment Invoices;
                                 NOR=F&orskuddsfakturaer];
                      RunObject=Page 143;
                      RunPageView=SORTING(Prepayment Order No.);
                      RunPageLink=Prepayment Order No.=FIELD(No.);
                      Image=PrepaymentInvoice }
      { 1102601012;2 ;Action    ;
                      CaptionML=[ENU=Prepayment Credi&t Memos;
                                 NOR=Kredi&tnotaer for forskudd];
                      RunObject=Page 144;
                      RunPageView=SORTING(Prepayment Order No.);
                      RunPageLink=Prepayment Order No.=FIELD(No.);
                      Image=PrepaymentCreditMemo }
      { 10      ;1   ;ActionGroup;
                      CaptionML=[ENU=Warehouse;
                                 NOR=Lager];
                      Image=Warehouse }
      { 1102601016;2 ;Action    ;
                      CaptionML=[ENU=Whse. Shipment Lines;
                                 NOR=Lagerleveringslinjer];
                      RunObject=Page 7341;
                      RunPageView=SORTING(Source Type,Source Subtype,Source No.,Source Line No.);
                      RunPageLink=Source Type=CONST(37),
                                  Source Subtype=FIELD(Document Type),
                                  Source No.=FIELD(No.);
                      Image=ShipmentLines }
      { 1102601017;2 ;Action    ;
                      CaptionML=[ENU=In&vt. Put-away/Pick Lines;
                                 NOR=&Lagerplass.-/-plukklinjer];
                      RunObject=Page 5774;
                      RunPageView=SORTING(Source Document,Source No.,Location Code);
                      RunPageLink=Source Document=CONST(Sales Order),
                                  Source No.=FIELD(No.);
                      Image=PickLines }
      { 32      ;1   ;ActionGroup;
                      Name=ActionGroupCRM;
                      CaptionML=[ENU=Dynamics CRM;
                                 NOR=Dynamics CRM];
                      Visible=CRMIntegrationEnabled }
      { 31      ;2   ;Action    ;
                      Name=CRMGoToSalesOrderListInNAV;
                      CaptionML=[ENU=Sales Order List;
                                 NOR=Ordreoversikt];
                      ToolTipML=[ENU=Open the Dynamics CRM Sales Order List page in Dynamics NAV;
                                 NOR=pne siden for Dynamics CRM-ordreoversikt i Dynamics NAV];
                      ApplicationArea=#Basic,#Suite;
                      Visible=CRMIntegrationEnabled;
                      Enabled=CRMIntegrationEnabled;
                      Image=Order;
                      OnAction=VAR
                                 CRMSalesorder@1000 : Record 5353;
                               BEGIN
                                 PAGE.RUN(PAGE::"CRM Sales Order List",CRMSalesorder);
                               END;
                                }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 12      ;1   ;ActionGroup;
                      CaptionML=[ENU=Release;
                                 NOR=Frigi];
                      Image=ReleaseDoc }
      { 1102601049;2 ;Action    ;
                      Name=Release;
                      ShortCutKey=Ctrl+F9;
                      CaptionML=[ENU=Re&lease;
                                 NOR=Fri&gi];
                      Promoted=Yes;
                      Image=ReleaseDoc;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ReleaseSalesDoc@1000 : Codeunit 414;
                               BEGIN
                                 ReleaseSalesDoc.PerformManualRelease(Rec);
                               END;
                                }
      { 1102601050;2 ;Action    ;
                      Name=Reopen;
                      CaptionML=[ENU=Re&open;
                                 NOR=&pne p† nytt];
                      ToolTipML=[ENU=Reopen the document to change it after it has been approved. Approved documents have the Released status and must be opened before they can be changed.;
                                 NOR=pne dokumentet p† nytt for † endre det etter at det har blitt godkjent. Godkjente dokumenter har statusen Frigitt, og de m† †pnes f›r de kan endres.];
                      Promoted=Yes;
                      Image=ReOpen;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ReleaseSalesDoc@1001 : Codeunit 414;
                               BEGIN
                                 ReleaseSalesDoc.PerformManualReopen(Rec);
                               END;
                                }
      { 1102601001;1 ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 NOR=F&unksjoner];
                      Image=Action }
      { 102     ;2   ;Action    ;
                      CaptionML=[ENU=Pla&nning;
                                 NOR=Pla&nlegging];
                      Image=Planning;
                      OnAction=VAR
                                 SalesOrderPlanningForm@1001 : Page 99000883;
                               BEGIN
                                 SalesOrderPlanningForm.SetSalesOrder("No.");
                                 SalesOrderPlanningForm.RUNMODAL;
                               END;
                                }
      { 1102601020;2 ;Action    ;
                      AccessByPermission=TableData 99000880=R;
                      CaptionML=[ENU=Order &Promising;
                                 NOR=Ordr&ebekreftelse];
                      Image=OrderPromising;
                      OnAction=VAR
                                 OrderPromisingLine@1000 : TEMPORARY Record 99000880;
                               BEGIN
                                 OrderPromisingLine.SETRANGE("Source Type","Document Type");
                                 OrderPromisingLine.SETRANGE("Source ID","No.");
                                 PAGE.RUNMODAL(PAGE::"Order Promising Lines",OrderPromisingLine);
                               END;
                                }
      { 1102601053;2 ;Action    ;
                      AccessByPermission=TableData 410=R;
                      CaptionML=[ENU=Send IC Sales Order Cnfmn.;
                                 NOR=Send bekreftelse p† KI-ordre];
                      Image=IntercompanyOrder;
                      OnAction=VAR
                                 ICInOutboxMgt@1000 : Codeunit 427;
                                 ApprovalsMgmt@1003 : Codeunit 1535;
                               BEGIN
                                 IF ApprovalsMgmt.PrePostApprovalCheckSales(Rec) THEN
                                   ICInOutboxMgt.SendSalesDoc(Rec,FALSE);
                               END;
                                }
      { 24      ;1   ;ActionGroup;
                      CaptionML=[ENU=Request Approval;
                                 NOR=Be om godkjenning] }
      { 1102601046;2 ;Action    ;
                      Name=SendApprovalRequest;
                      CaptionML=[ENU=Send A&pproval Request;
                                 NOR=&Send godkjenningsforesp›rsel];
                      ToolTipML=[ENU=Send an approval request.;
                                 NOR=Send en godkjenningsforesp›rsel.];
                      Promoted=Yes;
                      Enabled=NOT OpenApprovalEntriesExist;
                      PromotedIsBig=Yes;
                      Image=SendApprovalRequest;
                      PromotedCategory=Category4;
                      PromotedOnly=Yes;
                      OnAction=VAR
                                 ApprovalsMgmt@1001 : Codeunit 1535;
                               BEGIN
                                 IF ApprovalsMgmt.CheckSalesApprovalPossible(Rec) THEN
                                   ApprovalsMgmt.OnSendSalesDocForApproval(Rec);
                               END;
                                }
      { 1102601047;2 ;Action    ;
                      Name=CancelApprovalRequest;
                      CaptionML=[ENU=Cancel Approval Re&quest;
                                 NOR=&Annuller godkjenningsforesp›rsel];
                      ToolTipML=[ENU=Cancel the approval request.;
                                 NOR=Annuller godkjenningsforesp›rselen.];
                      Promoted=Yes;
                      Enabled=CanCancelApprovalForRecord;
                      PromotedIsBig=Yes;
                      Image=CancelApprovalRequest;
                      PromotedCategory=Category4;
                      PromotedOnly=Yes;
                      OnAction=VAR
                                 ApprovalsMgmt@1001 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.OnCancelSalesApprovalRequest(Rec);
                               END;
                                }
      { 3       ;1   ;ActionGroup;
                      CaptionML=[ENU=Warehouse;
                                 NOR=Lager];
                      Image=Warehouse }
      { 100     ;2   ;Action    ;
                      AccessByPermission=TableData 7342=R;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Create Inventor&y Put-away/Pick;
                                 NOR=Opprett lagerplas&sering/-plukk];
                      Image=CreatePutawayPick;
                      OnAction=BEGIN
                                 CreateInvtPutAwayPick;

                                 IF NOT FIND('=><') THEN
                                   INIT;
                               END;
                                }
      { 1102601043;2 ;Action    ;
                      AccessByPermission=TableData 7320=R;
                      CaptionML=[ENU=Create &Whse. Shipment;
                                 NOR=Opprett la&gerlevering];
                      Image=NewShipment;
                      OnAction=VAR
                                 GetSourceDocOutbound@1001 : Codeunit 5752;
                               BEGIN
                                 GetSourceDocOutbound.CreateFromSalesOrder(Rec);

                                 IF NOT FIND('=><') THEN
                                   INIT;
                               END;
                                }
      { 49      ;1   ;ActionGroup;
                      CaptionML=[ENU=P&osting;
                                 NOR=B&okf›ring];
                      Image=Post }
      { 1102601003;2 ;Action    ;
                      Name=Post;
                      ShortCutKey=F9;
                      Ellipsis=Yes;
                      CaptionML=[ENU=P&ost;
                                 NOR=B&okf›r];
                      ToolTipML=[ENU=Finalize the document or journal by posting the amounts and quantities to the related accounts in your company books.;
                                 NOR=Fullf›r dokumentet eller kladden ved † bokf›re bel›pene og antallene til de relaterte kontoene i selskapstabl†ene.];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PostOrder;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Post(CODEUNIT::"Sales-Post (Yes/No)");
                               END;
                                }
      { 25      ;2   ;Action    ;
                      Name=PostAndSend;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Post and Send;
                                 NOR=Bokf›r og send];
                      ToolTipML=[ENU=Finalize and prepare to send the document according to the customer's sending profile, such as attached to an email. The Send document to window opens where you can confirm or select a sending profile.;
                                 NOR=Fullf›r og klargj›r for † sende dokumentet i henhold til kundens sendingsprofil, for eksempel vedlagt i en e-post. Vinduet Send dokument til †pnes, og der kan du bekrefte eller velge en sendingsprofil.];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PostMail;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Post(CODEUNIT::"Sales-Post and Send");
                               END;
                                }
      { 1102601002;2 ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Test Report;
                                 NOR=Kontrollrapport];
                      ToolTipML=[ENU=View a test report so that you can find and correct any errors before you perform the actual posting of the journal or document.;
                                 NOR=Vis en kontrollrapport slik at du kan finne og rette eventuelle feil f›r du bokf›rer kladden eller dokumentet.];
                      Image=TestReport;
                      OnAction=BEGIN
                                 ReportPrint.PrintSalesHeader(Rec);
                               END;
                                }
      { 50      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Post &Batch;
                                 NOR=Masse&bokf›r];
                      Promoted=Yes;
                      Image=PostBatch;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 REPORT.RUNMODAL(REPORT::"Batch Post Sales Orders",TRUE,TRUE,Rec);
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 8       ;2   ;Action    ;
                      CaptionML=[ENU=Remove From Job Queue;
                                 NOR=Fjern fra jobbk›];
                      ToolTipML=[ENU=Remove the scheduled processing of this record from the job queue.;
                                 NOR=Fjern den planlagte behandlingen av denne posten fra prosjektk›en.];
                      ApplicationArea=#All;
                      Visible=JobQueueActive;
                      Image=RemoveLine;
                      OnAction=BEGIN
                                 CancelBackgroundPosting;
                               END;
                                }
      { 22      ;2   ;Action    ;
                      CaptionML=[ENU=Preview Posting;
                                 NOR=Forh†ndsvis bokf›ring];
                      ToolTipML=[ENU=Review the different types of entries that will be created when you post the document or journal.;
                                 NOR=Se gjennom de ulike typene poster som blir opprettet n†r du bokf›rer dokumentet eller kladden.];
                      Image=ViewPostedOrder;
                      OnAction=BEGIN
                                 ShowPreview
                               END;
                                }
      { 150     ;1   ;ActionGroup;
                      CaptionML=[ENU=&Print;
                                 NOR=&Skriv ut];
                      Image=Print }
      { 152     ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Work Order;
                                 NOR=Arbeidsordre];
                      Image=Print;
                      OnAction=BEGIN
                                 DocPrint.PrintSalesOrder(Rec,Usage::"Work Order");
                               END;
                                }
      { 7       ;2   ;Action    ;
                      CaptionML=[ENU=Pick Instruction;
                                 NOR=Plukkinstruksjon];
                      Image=Print;
                      OnAction=BEGIN
                                 DocPrint.PrintSalesOrder(Rec,Usage::"Pick Instruction");
                               END;
                                }
      { 1080000 ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Print Picking List;
                                 NOR=Skriv ut plukkliste];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Image=Print;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 DocPrint.PrintSalesOrder(Rec,Usage::"Sales Order Picking List");
                               END;
                                }
      { 19      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Order Confirmation;
                                 NOR=&Ordrebekreftelse];
                      Image=Email }
      { 18      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Email Confirmation;
                                 NOR=Send bekreftelse p† e-post];
                      ToolTipML=[ENU=Send an order confirmation by email. The Send Email window opens prefilled for the customer so you can add or change information before you send the email.;
                                 NOR=Send en ordrebekreftelse via e-post. Vinduet Send e-post †pnes forh†ndsutfylt for kunder, slik at du kan legge til eller endre informasjon f›r du sender e-posten.];
                      Image=Email;
                      OnAction=BEGIN
                                 DocPrint.EmailSalesHeader(Rec);
                               END;
                                }
      { 151     ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Print Confirmation;
                                 NOR=Skriv ut bekreftelse];
                      ToolTipML=[ENU=Print an order confirmation. A report request window opens where you can specify what to include on the print-out.;
                                 NOR=Skriv ut en ordrebekreftelse. Et rapportforesp›rselsvindu vises, der du kan angi hva som skal inkluderes p† utskriften.];
                      Promoted=Yes;
                      Visible=NOT IsOfficeAddin;
                      Image=Print;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 DocPrint.PrintSalesOrder(Rec,Usage::"Order Confirmation");
                               END;
                                }
      { 1900000006;0 ;ActionContainer;
                      ActionContainerType=Reports }
      { 1904702706;1 ;Action    ;
                      CaptionML=[ENU=Sales Reservation Avail.;
                                 NOR=Salgsreserv. tilgjengelighet];
                      RunObject=Report 209;
                      Promoted=Yes;
                      Image=Report;
                      PromotedCategory=Report }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the sales document.;
                           NOR=Angir nummeret p† salgsdokumentet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="No." }

    { 4   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the customer who will receive the products and be billed by default.;
                           NOR=Angir nummeret p† kunden som mottar produktene og faktureres som standard.];
                SourceExpr="Sell-to Customer No." }

    { 6   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the name of the customer who will receive the products and be billed by default.;
                           NOR=Angir navnet p† kunden som mottar produktene og faktureres som standard.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Sell-to Customer Name" }

    { 1101103000;2;Field  ;
                SourceExpr=Ship }

    { 17  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number that the customer uses in their own system to refer to this sales document.;
                           NOR=Angir nummeret som kunden bruker i sitt eget system for † referere til dette salgsdokumentet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="External Document No." }

    { 33  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the postal code of the address.;
                           NOR=Angir postnummeret for adressen.];
                SourceExpr="Sell-to Post Code";
                Visible=FALSE }

    { 29  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the country/region code of the address.;
                           NOR=Angir lands-/omr†dekoden for adressen.];
                SourceExpr="Sell-to Country/Region Code";
                Visible=FALSE }

    { 41  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the name of the person to contact at the customer.;
                           NOR=Angir navnet p† kontaktpersonen hos kunden.];
                SourceExpr="Sell-to Contact";
                Visible=FALSE }

    { 13  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the customer to whom you will send the sales invoice when this customer is different from the sell-to customer.;
                           NOR=Angir kunden som du sender salgsfakturaen til, n†r denne kunden ikke er den samme personen som du selger til.];
                SourceExpr="Bill-to Customer No.";
                Visible=FALSE }

    { 15  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the customer to whom you will send the sales invoice, when different from the customer that you are selling to.;
                           NOR=Angir kunden som du sender salgsfakturaen til, n†r det er en annen enn kunden som du selger til.];
                SourceExpr="Bill-to Name";
                Visible=FALSE }

    { 39  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the postal code of the address.;
                           NOR=Angir postnummeret for adressen.];
                SourceExpr="Bill-to Post Code";
                Visible=FALSE }

    { 35  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the country/region code of the address.;
                           NOR=Angir lands-/omr†dekoden for adressen.];
                SourceExpr="Bill-to Country/Region Code";
                Visible=FALSE }

    { 159 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the name of the person you should contact at the customer who you are sending the invoice to.;
                           NOR=Angir navnet p† kontaktperson hos kunden som fakturaen blir sendt til.];
                SourceExpr="Bill-to Contact";
                Visible=FALSE }

    { 155 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for another shipment address than the customer's own address, which is entered by default.;
                           NOR=Angir koden for en annen leveringsadresse enn kundens egen adresse, som er angitt som standard.];
                SourceExpr="Ship-to Code";
                Visible=FALSE }

    { 153 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the name that products on the sales document will be shipped to.;
                           NOR=Angir navnet som produkter p† salgsdokumentet skal leveres til.];
                SourceExpr="Ship-to Name";
                Visible=FALSE }

    { 27  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the postal code of the address.;
                           NOR=Angir postnummeret for adressen.];
                SourceExpr="Ship-to Post Code";
                Visible=FALSE }

    { 23  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the country/region code of the address.;
                           NOR=Angir lands-/omr†dekoden for adressen.];
                SourceExpr="Ship-to Country/Region Code";
                Visible=FALSE }

    { 143 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the name of the contact person at the address that products will be shipped to.;
                           NOR=Angir navnet p† kontaktpersonen i adressen som produkter skal leveres til.];
                SourceExpr="Ship-to Contact";
                Visible=FALSE }

    { 139 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date when the posting of the sales document will be recorded.;
                           NOR=Angir datoen n†r bokf›ringen av salgsdokumentet blir registrert.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Posting Date";
                Visible=FALSE }

    { 121 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for Shortcut Dimension 1.;
                           NOR=Angir koden for Snarveisdimensjon 1.];
                ApplicationArea=#Suite;
                SourceExpr="Shortcut Dimension 1 Code";
                Visible=FALSE }

    { 119 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for Shortcut Dimension 2.;
                           NOR=Angir koden for Snarveisdimensjon 2.];
                ApplicationArea=#Suite;
                SourceExpr="Shortcut Dimension 2 Code";
                Visible=FALSE }

    { 123 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the location from where inventory items to the customer on the sales document are to be shipped by default.;
                           NOR=Angir plasseringen der lagervarer til kunden p† salgsdokumentet leveres fra som standard.];
                SourceExpr="Location Code" }

    { 99  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the name of the salesperson who is assigned to the customer.;
                           NOR=Angir navnet p† selgeren som er knyttet til kunden.];
                ApplicationArea=#Suite;
                SourceExpr="Salesperson Code";
                Visible=FALSE }

    { 21  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the ID of the user who is responsible for the document.;
                           NOR=Angir ID-en til brukeren som er ansvarlig for dokumentet.];
                SourceExpr="Assigned User ID" }

    { 11  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the currency of amounts on the sales document.;
                           NOR=Angir valutaen til bel›pene p† salgsdokumentet.];
                ApplicationArea=#Suite;
                SourceExpr="Currency Code";
                Visible=FALSE }

    { 1102601025;2;Field  ;
                ToolTipML=[ENU=Specifies the date on which you created the sales document.;
                           NOR=Angir datoen da du opprettet salgsdokumentet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Document Date" }

    { 1102601027;2;Field  ;
                ToolTipML=[ENU=Specifies the date that the customer has asked for the order to be delivered.;
                           NOR=Angir p† hvilken dato kunden har bedt om at ordren skal leveres.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Requested Delivery Date";
                Visible=FALSE }

    { 1102601005;2;Field  ;
                ToolTipML=[ENU=Specifies the campaign number the document is linked to.;
                           NOR=Angir kampanjenummeret som dokumentet er koblet til.];
                SourceExpr="Campaign No.";
                Visible=FALSE }

    { 1102601029;2;Field  ;
                ToolTipML=[ENU=Specifies whether the document is open, waiting to be approved, has been invoiced for prepayment, or has been released to the next stage of processing.;
                           NOR=Angir om dokumentet er †pent, om det venter p† godkjenning, om det er fakturert for forskudd eller om det er frigitt til neste fase i behandlingen.];
                SourceExpr=Status }

    { 1102601039;2;Field  ;
                ToolTipML=[ENU=Specifies a formula that calculates the payment due date, payment discount date, and payment discount amount on the sales document.;
                           NOR=Angir en formel som beregner forfallsdatoen for betalingen, kontantrabattdatoen og kontantrabattbel›pet, p† salgsdokumentet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Payment Terms Code";
                Visible=FALSE }

    { 1102601041;2;Field  ;
                ToolTipML=[ENU=Specifies when the sales invoice must be paid.;
                           NOR=Angir n†r salgsfakturaen m† betales.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Due Date";
                Visible=FALSE }

    { 1102601054;2;Field  ;
                ToolTipML=[ENU=Specifies the payment discount percentage that is granted if the customer pays on or before the date entered in the Pmt. Discount Date field. The discount percentage is specified in the Payment Terms Code field.;
                           NOR=Angir kontantrabattprosenten som gis hvis kunden betaler p† eller f›r datoen som er angitt i feltet Kont.rabattdato. Rabattprosenten er angitt i feltet Betalingsbet.kode.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Payment Discount %";
                Visible=FALSE }

    { 1102601035;2;Field  ;
                ToolTipML=[ENU=Specifies how items on the sales document are shipped to the customer.;
                           NOR=Angir hvordan varer p† salgsdokumentet leveres til kunden.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Shipment Method Code";
                Visible=FALSE }

    { 1102601033;2;Field  ;
                ToolTipML=[ENU=Specifies which shipping agent is used to transport the items on the sales document to the customer.;
                           NOR=Angir hvilken transport›r som skal brukes til † transportere varene p† salgsdokumentet til kunden.];
                ApplicationArea=#Suite;
                SourceExpr="Shipping Agent Code";
                Visible=FALSE }

    { 14  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies which shipping agent service is used to transport the items on the sales document to the customer.;
                           NOR=Angir hvilken transport›rtjeneste som skal brukes til † transportere varene p† salgsdokumentet til kunden.];
                ApplicationArea=#Suite;
                SourceExpr="Shipping Agent Service Code";
                Visible=FALSE }

    { 26  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the shipping agent's package number.;
                           NOR=Angir transport›rens pakkenummer.];
                ApplicationArea=#Suite;
                SourceExpr="Package Tracking No.";
                Visible=FALSE }

    { 1102601031;2;Field  ;
                ToolTipML=[ENU=Specifies the date you expect to ship items on the sales document.;
                           NOR=Angir datoen du forventer † levere varer, p† salgsdokumentet.];
                SourceExpr="Shipment Date";
                Visible=FALSE }

    { 1102601037;2;Field  ;
                ToolTipML=[ENU=Specifies if the customer accepts partial shipment of orders.;
                           NOR=Angir om kunden godtar dellevering av ordrer.];
                SourceExpr="Shipping Advice";
                Visible=FALSE }

    { 16  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies whether all the items on the order have been shipped or, in the case of inbound items, completely received.;
                           NOR=Angir om alle varene i ordren er levert eller, i tilfelle inng†ende varer, er fullstendig mottatt.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Completely Shipped" }

    { 5   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the status of a job queue entry or task that handles the posting of sales orders.;
                           NOR=Angir status for en jobbk›post eller oppgave som h†ndterer bokf›ring av ordrer.];
                ApplicationArea=#All;
                SourceExpr="Job Queue Status";
                Visible=JobQueueActive }

    { 28  ;2   ;Field     ;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Amount }

    { 30  ;2   ;Field     ;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Amount Including VAT" }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1902018507;1;Part   ;
                ApplicationArea=#Basic,#Suite;
                SubPageLink=No.=FIELD(Bill-to Customer No.),
                            Date Filter=FIELD(Date Filter);
                PagePartID=Page9082;
                PartType=Page }

    { 1900316107;1;Part   ;
                ApplicationArea=#Basic,#Suite;
                SubPageLink=No.=FIELD(Bill-to Customer No.),
                            Date Filter=FIELD(Date Filter);
                PagePartID=Page9084;
                PartType=Page }

    { 20  ;1   ;Part      ;
                Name=IncomingDocAttachFactBox;
                ApplicationArea=#Basic,#Suite;
                PagePartID=Page193;
                Visible=FALSE;
                PartType=Page;
                ShowFilter=No }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      ApplicationAreaSetup@1007 : Record 9178;
      DocPrint@1102601000 : Codeunit 229;
      ReportPrint@1102601002 : Codeunit 228;
      UserMgt@1000 : Codeunit 5700;
      Usage@1001 : 'Order Confirmation,Work Order,Pick Instruction,Sales Order Picking List';
      JobQueueActive@1004 : Boolean INDATASET;
      OpenApprovalEntriesExist@1006 : Boolean;
      CRMIntegrationEnabled@1002 : Boolean;
      IsOfficeAddin@1003 : Boolean;
      CanCancelApprovalForRecord@1005 : Boolean;
      SkipLinesWithoutVAT@1008 : Boolean;

    PROCEDURE ShowPreview@1();
    VAR
      SalesPostYesNo@1001 : Codeunit 81;
    BEGIN
      SalesPostYesNo.Preview(Rec);
    END;

    LOCAL PROCEDURE SetControlVisibility@5();
    VAR
      ApprovalsMgmt@1000 : Codeunit 1535;
    BEGIN
      OpenApprovalEntriesExist := ApprovalsMgmt.HasOpenApprovalEntries(RECORDID);

      CanCancelApprovalForRecord := ApprovalsMgmt.CanCancelApprovalForRecord(RECORDID);
    END;

    LOCAL PROCEDURE Post@4(PostingCodeunitID@1000 : Integer);
    VAR
      LinesInstructionMgt@1002 : Codeunit 1320;
    BEGIN
      IF ApplicationAreaSetup.IsFoundationEnabled THEN
        LinesInstructionMgt.SalesCheckAllLinesHaveQuantityAssigned(Rec);

      SendToPosting(PostingCodeunitID);

      CurrPage.UPDATE(FALSE);
    END;

    PROCEDURE SkipShowingLinesWithoutVAT@2();
    BEGIN
      SkipLinesWithoutVAT := TRUE;
    END;

    LOCAL PROCEDURE ShowHeader@6() : Boolean;
    VAR
      CashFlowManagement@1000 : Codeunit 841;
    BEGIN
      IF NOT SkipLinesWithoutVAT THEN
        EXIT(TRUE);

      EXIT(CashFlowManagement.GetTaxAmountFromSalesOrder(Rec) <> 0);
    END;

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 15.08.17 JAL Based on PAG9305
                       Changed CardPageID and added "Ship" field.
    }
    END.
  }
}

OBJECT Page 83041 OPC Sales Order
{
  OBJECT-PROPERTIES
  {
    Date=20.09.17;
    Time=15:17:33;
    Modified=Yes;
    Version List=NAVW110.00.00.15140,NAVNO10.00.00.15140,OPC6.01;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Sales Order;
               NOR=Ordre];
    SourceTable=Table36;
    SourceTableView=WHERE(Document Type=FILTER(Order));
    PageType=Document;
    RefreshOnActivate=Yes;
    PromotedActionCategoriesML=[ENU=New,Process,Report,Approve,Release,Posting,Prepare,Invoice,Request Approval;
                                NOR=Ny,Prosess,Rapport,Godkjenn,Frigi,Bokf›ring,Klargj›r,Faktura,Be om godkjenning];
    OnInit=VAR
             SalesReceivablesSetup@1000 : Record 311;
           BEGIN
             SetExtDocNoMandatoryCondition;

             JobQueuesUsed := SalesReceivablesSetup."Post & Print with Job Queue" OR SalesReceivablesSetup."Post with Job Queue";
             SellToCustomerUsesEInvoicing := CustomerUsesEInvoicing("Sell-to Customer No.")
           END;

    OnOpenPage=VAR
                 CRMIntegrationManagement@1000 : Codeunit 5330;
                 OfficeMgt@1001 : Codeunit 1630;
               BEGIN
                 IF UserMgt.GetSalesFilter <> '' THEN BEGIN
                   FILTERGROUP(2);
                   SETRANGE("Responsibility Center",UserMgt.GetSalesFilter);
                   FILTERGROUP(0);
                 END;

                 SETRANGE("Date Filter",0D,WORKDATE - 1);

                 SetDocNoVisible;

                 CRMIntegrationEnabled := CRMIntegrationManagement.IsCRMIntegrationEnabled;
                 IsOfficeHost := OfficeMgt.IsAvailable;

                 IF "Quote No." <> '' THEN
                   ShowQuoteNo := TRUE;
               END;

    OnAfterGetRecord=BEGIN
                       SetControlVisibility;
                       UpdateShipToBillToGroupVisibility;
                     END;

    OnNewRecord=BEGIN
                  "Responsibility Center" := UserMgt.GetSalesFilter;
                  IF (NOT DocNoVisible) AND ("No." = '') THEN
                    SetSellToCustomerFromFilter;

                  SetDefaultPaymentServices;
                END;

    OnInsertRecord=BEGIN
                     IF DocNoVisible THEN
                       CheckCreditMaxBeforeInsert;

                     IF ("Sell-to Customer No." = '') AND (GETFILTER("Sell-to Customer No.") <> '') THEN
                       CurrPage.UPDATE(FALSE);
                   END;

    OnDeleteRecord=BEGIN
                     CurrPage.SAVERECORD;
                     EXIT(ConfirmDeletion);
                   END;

    OnQueryClosePage=BEGIN
                       IF NOT DocumentIsPosted THEN
                         EXIT(ConfirmCloseUnposted);
                     END;

    OnAfterGetCurrRecord=VAR
                           CRMCouplingManagement@1000 : Codeunit 5331;
                         BEGIN
                           DynamicEditable := CurrPage.EDITABLE;
                           SellToCustomerUsesEInvoicing := CustomerUsesEInvoicing("Sell-to Customer No.");
                           CurrPage.IncomingDocAttachFactBox.PAGE.LoadDataFromRecord(Rec);
                           CurrPage.ApprovalFactBox.PAGE.UpdateApprovalEntriesFromSourceRecord(RECORDID);
                           CRMIsCoupledToRecord := CRMIntegrationEnabled AND CRMCouplingManagement.IsRecordCoupledToCRM(RECORDID);
                           ShowWorkflowStatus := CurrPage.WorkflowStatus.PAGE.SetFilterOnWorkflowRecord(RECORDID);

                           UpdatePaymentService;
                         END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 59      ;1   ;ActionGroup;
                      CaptionML=[ENU=O&rder;
                                 NOR=&Ordre];
                      Image=Order }
      { 61      ;2   ;Action    ;
                      Name=Statistics;
                      ShortCutKey=F7;
                      CaptionML=[ENU=Statistics;
                                 NOR=Statistikk];
                      ToolTipML=[ENU=View statistical information, such as the value of posted entries, for the record.;
                                 NOR=Vis statistikkinformasjon, for eksempel verdien for bokf›rte poster, for posten.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Image=Statistics;
                      PromotedCategory=Process;
                      PromotedOnly=Yes;
                      OnAction=VAR
                                 Handled@1000 : Boolean;
                               BEGIN
                                 OnBeforeStatisticsAction(Rec,Handled);
                                 IF NOT Handled THEN BEGIN
                                   OpenSalesOrderStatistics;
                                   SalesCalcDiscountByType.ResetRecalculateInvoiceDisc(Rec);
                                 END
                               END;
                                }
      { 62      ;2   ;Action    ;
                      ShortCutKey=Shift+F7;
                      CaptionML=[ENU=Card;
                                 NOR=Kort];
                      ToolTipML=[ENU=View or create the standard sales lines that are represented by the code on the recurring sales line.;
                                 NOR=Vis eller opprett standardsalgslinjene som representeres av koden p† den gjentakende salgslinjen.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 21;
                      RunPageLink=No.=FIELD(Sell-to Customer No.);
                      Image=EditLines }
      { 122     ;2   ;Action    ;
                      Name=Dimensions;
                      AccessByPermission=TableData 348=R;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 NOR=Dimensjoner];
                      ToolTipML=[ENU=View or edits dimensions, such as area, project, or department, that you can assign to sales and purchase documents to distribute costs and analyze transaction history.;
                                 NOR=Vis eller rediger dimensjoner, for eksempel omr†de, prosjekt eller avdeling, som du kan tilordne til salgs- og kj›psdokumenter for † distribuere kostnader og analysere transaksjonshistorikk.];
                      ApplicationArea=#Suite;
                      Enabled="No." <> '';
                      Image=Dimensions;
                      OnAction=BEGIN
                                 ShowDocDim;
                                 CurrPage.SAVERECORD;
                               END;
                                }
      { 78      ;2   ;Action    ;
                      Name=Approvals;
                      AccessByPermission=TableData 454=R;
                      CaptionML=[ENU=Approvals;
                                 NOR=Godkjenninger];
                      ToolTipML=[ENU=View a list of the records that are waiting to be approved. For example, you can see who requested the record to be approved, when it was sent, and when it is due to be approved.;
                                 NOR=Vis en liste med poster dom venter p† † bli godkjent. Du kan for eksempel se hvem som har bedt om godkjenning av posten, n†r den ble sendt og n†r den forfaller til godkjenning.];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      Image=Approvals;
                      PromotedCategory=Category9;
                      PromotedOnly=Yes;
                      OnAction=VAR
                                 ApprovalEntries@1001 : Page 658;
                               BEGIN
                                 ApprovalEntries.Setfilters(DATABASE::"Sales Header","Document Type","No.");
                                 ApprovalEntries.RUN;
                               END;
                                }
      { 63      ;2   ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 NOR=&Merknader];
                      RunObject=Page 67;
                      RunPageLink=Document Type=FIELD(Document Type),
                                  No.=FIELD(No.),
                                  Document Line No.=CONST(0);
                      Image=ViewComments }
      { 11      ;2   ;Action    ;
                      AccessByPermission=TableData 90=R;
                      CaptionML=[ENU=Assembly Orders;
                                 NOR=Monteringsordrer];
                      Image=AssemblyOrder;
                      OnAction=VAR
                                 AssembleToOrderLink@1000 : Record 904;
                               BEGIN
                                 AssembleToOrderLink.ShowAsmOrders(Rec);
                               END;
                                }
      { 79      ;1   ;ActionGroup;
                      Name=ActionGroupCRM;
                      CaptionML=[ENU=Dynamics CRM;
                                 NOR=Dynamics CRM];
                      Visible=CRMIntegrationEnabled }
      { 71      ;2   ;Action    ;
                      Name=CRMGoToSalesOrder;
                      CaptionML=[ENU=Sales Order;
                                 NOR=Ordre];
                      ToolTipML=[ENU=View the selected sales order.;
                                 NOR=Vis den valgte ordren.];
                      ApplicationArea=#Basic,#Suite;
                      Enabled=CRMIntegrationEnabled AND CRMIsCoupledToRecord;
                      Image=CoupledOrder;
                      OnAction=VAR
                                 CRMIntegrationManagement@1000 : Codeunit 5330;
                               BEGIN
                                 CRMIntegrationManagement.ShowCRMEntityFromRecordID(RECORDID);
                               END;
                                }
      { 13      ;1   ;ActionGroup;
                      CaptionML=[ENU=Documents;
                                 NOR=Dokumenter];
                      Image=Documents }
      { 64      ;2   ;Action    ;
                      CaptionML=[ENU=S&hipments;
                                 NOR=F&›lgesedler];
                      ToolTipML=[ENU=View a list of the sales shipments you have posted.;
                                 NOR=Vis en liste over f›lgesedlene du har bokf›rt.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 142;
                      RunPageView=SORTING(Order No.);
                      RunPageLink=Order No.=FIELD(No.);
                      Image=Shipment }
      { 65      ;2   ;Action    ;
                      CaptionML=[ENU=Invoices;
                                 NOR=Fakturaer];
                      ToolTipML=[ENU=View the history of posted sales invoices that have been posted for the document.;
                                 NOR=Vis historikken for bokf›rte salgsfakturaer som har blitt bokf›rt for dokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 143;
                      RunPageView=SORTING(Order No.);
                      RunPageLink=Order No.=FIELD(No.);
                      Image=Invoice }
      { 15      ;1   ;ActionGroup;
                      CaptionML=[ENU=Warehouse;
                                 NOR=Lager];
                      Image=Warehouse }
      { 150     ;2   ;Action    ;
                      CaptionML=[ENU=In&vt. Put-away/Pick Lines;
                                 NOR=Lagerp&lass.-/-plukklinjer];
                      RunObject=Page 5774;
                      RunPageView=SORTING(Source Document,Source No.,Location Code);
                      RunPageLink=Source Document=CONST(Sales Order),
                                  Source No.=FIELD(No.);
                      Image=PickLines }
      { 168     ;2   ;Action    ;
                      CaptionML=[ENU=Whse. Shipment Lines;
                                 NOR=Lagerleveringslinjer];
                      RunObject=Page 7341;
                      RunPageView=SORTING(Source Type,Source Subtype,Source No.,Source Line No.);
                      RunPageLink=Source Type=CONST(37),
                                  Source Subtype=FIELD(Document Type),
                                  Source No.=FIELD(No.);
                      Image=ShipmentLines }
      { 17      ;1   ;ActionGroup;
                      CaptionML=[ENU=Prepayment;
                                 NOR=Forskudd];
                      Image=Prepayment }
      { 234     ;2   ;Action    ;
                      Name=PagePostedSalesPrepaymentInvoices;
                      CaptionML=[ENU=Prepa&yment Invoices;
                                 NOR=F&orskuddsfakturaer];
                      RunObject=Page 143;
                      RunPageView=SORTING(Prepayment Order No.);
                      RunPageLink=Prepayment Order No.=FIELD(No.);
                      Image=PrepaymentInvoice }
      { 235     ;2   ;Action    ;
                      Name=PagePostedSalesPrepaymentCrMemos;
                      CaptionML=[ENU=Prepayment Credi&t Memos;
                                 NOR=Kredi&tnotaer for forskudd];
                      RunObject=Page 144;
                      RunPageView=SORTING(Prepayment Order No.);
                      RunPageLink=Prepayment Order No.=FIELD(No.);
                      Image=PrepaymentCreditMemo }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 47      ;1   ;ActionGroup;
                      CaptionML=[ENU=Approval;
                                 NOR=Godkjenning] }
      { 43      ;2   ;Action    ;
                      Name=Approve;
                      CaptionML=[ENU=Approve;
                                 NOR=Godkjenn];
                      ToolTipML=[ENU=Approve the requested changes.;
                                 NOR=Godkjenn de forespurte endringene.];
                      ApplicationArea=#All;
                      Promoted=Yes;
                      Visible=OpenApprovalEntriesExistForCurrUser;
                      PromotedIsBig=Yes;
                      Image=Approve;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.ApproveRecordApprovalRequest(RECORDID);
                               END;
                                }
      { 41      ;2   ;Action    ;
                      Name=Reject;
                      CaptionML=[ENU=Reject;
                                 NOR=Avvis];
                      ToolTipML=[ENU=Reject the approval request.;
                                 NOR=Avvis godkjenningsforesp›rselen.];
                      ApplicationArea=#All;
                      Promoted=Yes;
                      Visible=OpenApprovalEntriesExistForCurrUser;
                      PromotedIsBig=Yes;
                      Image=Reject;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.RejectRecordApprovalRequest(RECORDID);
                               END;
                                }
      { 39      ;2   ;Action    ;
                      Name=Delegate;
                      CaptionML=[ENU=Delegate;
                                 NOR=Deleger];
                      ToolTipML=[ENU=Delegate the approval to a substitute approver.;
                                 NOR=Deleger godkjenningen til en stedfortredende godkjenner.];
                      ApplicationArea=#All;
                      Promoted=Yes;
                      Visible=OpenApprovalEntriesExistForCurrUser;
                      Image=Delegate;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.DelegateRecordApprovalRequest(RECORDID);
                               END;
                                }
      { 37      ;2   ;Action    ;
                      Name=Comment;
                      CaptionML=[ENU=Comments;
                                 NOR=Merknader];
                      ToolTipML=[ENU=View or add comments.;
                                 NOR=Vis eller legg til merknader.];
                      ApplicationArea=#All;
                      Promoted=Yes;
                      Visible=OpenApprovalEntriesExistForCurrUser;
                      Image=ViewComments;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.GetApprovalComment(Rec);
                               END;
                                }
      { 21      ;1   ;ActionGroup;
                      CaptionML=[ENU=Release;
                                 NOR=Frigi];
                      Image=ReleaseDoc }
      { 133     ;2   ;Action    ;
                      Name=Release;
                      ShortCutKey=Ctrl+F9;
                      CaptionML=[ENU=Re&lease;
                                 NOR=&Frigi];
                      Promoted=Yes;
                      Image=ReleaseDoc;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ReleaseSalesDoc@1000 : Codeunit 414;
                               BEGIN
                                 ReleaseSalesDoc.PerformManualRelease(Rec);
                               END;
                                }
      { 134     ;2   ;Action    ;
                      Name=Reopen;
                      CaptionML=[ENU=Re&open;
                                 NOR=&pne p† nytt];
                      ToolTipML=[ENU=Reopen the document to change it after it has been approved. Approved documents have the Released status and must be opened before they can be changed.;
                                 NOR=pne dokumentet p† nytt for † endre det etter at det har blitt godkjent. Godkjente dokumenter har statusen Frigitt, og de m† †pnes f›r de kan endres.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Enabled=Status <> Status::Open;
                      Image=ReOpen;
                      PromotedCategory=Process;
                      PromotedOnly=Yes;
                      OnAction=VAR
                                 ReleaseSalesDoc@1001 : Codeunit 414;
                               BEGIN
                                 ReleaseSalesDoc.PerformManualReopen(Rec);
                               END;
                                }
      { 66      ;1   ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 NOR=F&unksjoner];
                      Image=Action }
      { 87      ;2   ;Action    ;
                      Name=CreatePurchaseInvoice;
                      CaptionML=[ENU=Create Purchase Invoice;
                                 NOR=Opprett kj›psfaktura];
                      ToolTipML=[ENU=Create a new purchase invoice so you can buy items from a vendor.;
                                 NOR=Opprett en ny kj›psfaktura slik at du kan kj›pe varer fra en leverand›r.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=No;
                      PromotedIsBig=Yes;
                      Image=NewPurchaseInvoice;
                      PromotedCategory=Category8;
                      OnAction=VAR
                                 SelectedSalesLine@1001 : Record 37;
                                 PurchInvFromSalesInvoice@1000 : Codeunit 1314;
                               BEGIN
                                 CurrPage.SalesLines.PAGE.SETSELECTIONFILTER(SelectedSalesLine);
                                 PurchInvFromSalesInvoice.CreatePurchaseInvoice(Rec,SelectedSalesLine);
                               END;
                                }
      { 67      ;2   ;Action    ;
                      Name=CalculateInvoiceDiscount;
                      AccessByPermission=TableData 19=R;
                      CaptionML=[ENU=Calculate &Invoice Discount;
                                 NOR=Beregn fakt&urarabatt];
                      ToolTipML=[ENU=Calculate the invoice discount that applies to the sales order.;
                                 NOR=Beregn fakturarabatten som gjelder for ordren.];
                      ApplicationArea=#Basic,#Suite;
                      Image=CalculateInvoiceDiscount;
                      OnAction=BEGIN
                                 ApproveCalcInvDisc;
                                 SalesCalcDiscountByType.ResetRecalculateInvoiceDisc(Rec);
                               END;
                                }
      { 167     ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Get St&d. Cust. Sales Codes;
                                 NOR=Hent st&d. salgskoder for kunde];
                      ToolTipML=[ENU=View a list of the standard sales codes that have been assigned to the current customer.;
                                 NOR=Vis en liste over standard salgskoder som er tilordnet den aktuelle kunden.];
                      ApplicationArea=#Suite;
                      Image=CustomerCode;
                      OnAction=VAR
                                 StdCustSalesCode@1000 : Record 172;
                               BEGIN
                                 StdCustSalesCode.InsertSalesLines(Rec);
                               END;
                                }
      { 68      ;2   ;Action    ;
                      Name=CopyDocument;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Copy Document;
                                 NOR=Kopier dokument];
                      ToolTipML=[ENU=Copy document lines and header information from another sales document to this document. You can copy a posted sales invoice into a new sales invoice to quickly create a similar document.;
                                 NOR=Kopier dokumentlinjer og hodeopplysninger fra et annet salgsdokument til dette dokumentet. Du kan kopiere en bokf›rt salgsfaktura til en ny salgsfaktura for † opprette et lignende dokument raskt.];
                      ApplicationArea=#Suite;
                      Image=CopyDocument;
                      OnAction=BEGIN
                                 CopySalesDoc.SetSalesHeader(Rec);
                                 CopySalesDoc.RUNMODAL;
                                 CLEAR(CopySalesDoc);
                                 IF GET("Document Type","No.") THEN;
                               END;
                                }
      { 154     ;2   ;Action    ;
                      Name=MoveNegativeLines;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Move Negative Lines;
                                 NOR=Flytt negative linjer];
                      Image=MoveNegativeLines;
                      OnAction=BEGIN
                                 CLEAR(MoveNegSalesLines);
                                 MoveNegSalesLines.SetSalesHeader(Rec);
                                 MoveNegSalesLines.RUNMODAL;
                                 MoveNegSalesLines.ShowDocument;
                               END;
                                }
      { 196     ;2   ;Action    ;
                      Name=Archive Document;
                      CaptionML=[ENU=Archi&ve Document;
                                 NOR=Arki&ver dokument];
                      Image=Archive;
                      OnAction=BEGIN
                                 ArchiveManagement.ArchiveSalesDocument(Rec);
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 204     ;2   ;Action    ;
                      AccessByPermission=TableData 410=R;
                      CaptionML=[ENU=Send IC Sales Order Cnfmn.;
                                 NOR=Send bekreftelse p† KI-ordre];
                      Image=IntercompanyOrder;
                      OnAction=VAR
                                 ICInOutboxMgt@1000 : Codeunit 427;
                                 ApprovalsMgmt@1003 : Codeunit 1535;
                               BEGIN
                                 IF ApprovalsMgmt.PrePostApprovalCheckSales(Rec) THEN
                                   ICInOutboxMgt.SendSalesDoc(Rec,FALSE);
                               END;
                                }
      { 69      ;2   ;ActionGroup;
                      Name=IncomingDocument;
                      CaptionML=[ENU=Incoming Document;
                                 NOR=Inng†ende dokument];
                      ActionContainerType=NewDocumentItems;
                      Image=Documents }
      { 60      ;3   ;Action    ;
                      Name=IncomingDocCard;
                      CaptionML=[ENU=View Incoming Document;
                                 NOR=Vis inng†ende dokument];
                      ToolTipML=[ENU=View any incoming document records and file attachments that exist for the entry or document.;
                                 NOR=Vis poster og filvedlegg for innkommende dokument som finnes for oppf›ringen eller dokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      Enabled=HasIncomingDocument;
                      Image=ViewOrder;
                      OnAction=VAR
                                 IncomingDocument@1000 : Record 130;
                               BEGIN
                                 IncomingDocument.ShowCardFromEntryNo("Incoming Document Entry No.");
                               END;
                                }
      { 57      ;3   ;Action    ;
                      Name=SelectIncomingDoc;
                      AccessByPermission=TableData 130=R;
                      CaptionML=[ENU=Select Incoming Document;
                                 NOR=Velg inng†ende dokument];
                      ToolTipML=[ENU=Select an incoming document record and file attachment that you want to link to the entry or document.;
                                 NOR=Velg en post og et filvedlegg for innkommende dokument som du vil koble til oppf›ringen eller dokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      Image=SelectLineToApply;
                      OnAction=VAR
                                 IncomingDocument@1000 : Record 130;
                               BEGIN
                                 VALIDATE("Incoming Document Entry No.",IncomingDocument.SelectIncomingDocument("Incoming Document Entry No.",RECORDID));
                               END;
                                }
      { 55      ;3   ;Action    ;
                      Name=IncomingDocAttachFile;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Create Incoming Document from File;
                                 NOR=Opprett inng†ende dokument fra fil];
                      ToolTipML=[ENU=Create an incoming document record by selecting a file to attach, and then link the incoming document record to the entry or document.;
                                 NOR=Opprett en post for innkommende dokument ved † velge en fil som skal legges ved, og koble deretter posten for det innkommende dokumentet til oppf›ringen eller dokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      Enabled=NOT HasIncomingDocument;
                      Image=Attach;
                      OnAction=VAR
                                 IncomingDocumentAttachment@1000 : Record 133;
                               BEGIN
                                 IncomingDocumentAttachment.NewAttachmentFromSalesDocument(Rec);
                               END;
                                }
      { 53      ;3   ;Action    ;
                      Name=RemoveIncomingDoc;
                      CaptionML=[ENU=Remove Incoming Document;
                                 NOR=Fjern inng†ende dokument];
                      ToolTipML=[ENU=Remove incoming document records and file attachments.;
                                 NOR=Fjern innkommende dokumentposter og filvedlegg.];
                      ApplicationArea=#Basic,#Suite;
                      Enabled=HasIncomingDocument;
                      Image=RemoveLine;
                      OnAction=VAR
                                 IncomingDocument@1000 : Record 130;
                               BEGIN
                                 IF IncomingDocument.GET("Incoming Document Entry No.") THEN
                                   IncomingDocument.RemoveLinkToRelatedRecord;
                                 "Incoming Document Entry No." := 0;
                                 MODIFY(TRUE);
                               END;
                                }
      { 23      ;1   ;ActionGroup;
                      CaptionML=[ENU=Plan;
                                 NOR=Planlegging];
                      Image=Planning }
      { 197     ;2   ;Action    ;
                      Name=OrderPromising;
                      AccessByPermission=TableData 99000880=R;
                      CaptionML=[ENU=Order &Promising;
                                 NOR=Ordr&ebekreftelse];
                      Image=OrderPromising;
                      OnAction=VAR
                                 OrderPromisingLine@1000 : TEMPORARY Record 99000880;
                               BEGIN
                                 OrderPromisingLine.SETRANGE("Source Type","Document Type");
                                 OrderPromisingLine.SETRANGE("Source ID","No.");
                                 PAGE.RUNMODAL(PAGE::"Order Promising Lines",OrderPromisingLine);
                               END;
                                }
      { 248     ;2   ;Action    ;
                      CaptionML=[ENU=Demand Overview;
                                 NOR=Behovsoversikt];
                      Image=Forecast;
                      OnAction=VAR
                                 DemandOverview@1000 : Page 5830;
                               BEGIN
                                 DemandOverview.SetCalculationParameter(TRUE);
                                 DemandOverview.Initialize(0D,1,"No.",'','');
                                 DemandOverview.RUNMODAL;
                               END;
                                }
      { 121     ;2   ;Action    ;
                      CaptionML=[ENU=Pla&nning;
                                 NOR=Pla&nlegging];
                      Image=Planning;
                      OnAction=VAR
                                 SalesPlanForm@1001 : Page 99000883;
                               BEGIN
                                 SalesPlanForm.SetSalesOrder("No.");
                                 SalesPlanForm.RUNMODAL;
                               END;
                                }
      { 25      ;1   ;ActionGroup;
                      CaptionML=[ENU=Request Approval;
                                 NOR=Be om godkjenning];
                      Image=SendApprovalRequest }
      { 250     ;2   ;Action    ;
                      Name=SendApprovalRequest;
                      CaptionML=[ENU=Send A&pproval Request;
                                 NOR=&Send godkjenningsforesp›rsel];
                      ToolTipML=[ENU=Send an approval request.;
                                 NOR=Send en godkjenningsforesp›rsel.];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      Enabled=NOT OpenApprovalEntriesExist;
                      Image=SendApprovalRequest;
                      PromotedCategory=Category9;
                      PromotedOnly=Yes;
                      OnAction=VAR
                                 ApprovalsMgmt@1001 : Codeunit 1535;
                               BEGIN
                                 IF ApprovalsMgmt.CheckSalesApprovalPossible(Rec) THEN
                                   ApprovalsMgmt.OnSendSalesDocForApproval(Rec);
                               END;
                                }
      { 251     ;2   ;Action    ;
                      Name=CancelApprovalRequest;
                      CaptionML=[ENU=Cancel Approval Re&quest;
                                 NOR=&Annuller godkjenningsforesp›rsel];
                      ToolTipML=[ENU=Cancel the approval request.;
                                 NOR=Annuller godkjenningsforesp›rselen.];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      Enabled=CanCancelApprovalForRecord;
                      Image=CancelApprovalRequest;
                      PromotedCategory=Category9;
                      PromotedOnly=Yes;
                      OnAction=VAR
                                 ApprovalsMgmt@1001 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.OnCancelSalesApprovalRequest(Rec);
                               END;
                                }
      { 3       ;1   ;ActionGroup;
                      CaptionML=[ENU=Warehouse;
                                 NOR=Lager];
                      Image=Warehouse }
      { 148     ;2   ;Action    ;
                      AccessByPermission=TableData 7342=R;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Create Inventor&y Put-away/Pick;
                                 NOR=Opprett lagerplas&sering/-plukk];
                      Promoted=Yes;
                      Visible=FALSE;
                      Image=CreateInventoryPickup;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CreateInvtPutAwayPick;

                                 IF NOT FIND('=><') THEN
                                   INIT;
                               END;
                                }
      { 149     ;2   ;Action    ;
                      AccessByPermission=TableData 7320=R;
                      CaptionML=[ENU=Create &Whse. Shipment;
                                 NOR=Opprett la&gerlevering];
                      Image=NewShipment;
                      OnAction=VAR
                                 GetSourceDocOutbound@1001 : Codeunit 5752;
                               BEGIN
                                 GetSourceDocOutbound.CreateFromSalesOrder(Rec);

                                 IF NOT FIND('=><') THEN
                                   INIT;
                               END;
                                }
      { 73      ;1   ;ActionGroup;
                      CaptionML=[ENU=P&osting;
                                 NOR=&Bokf›ring];
                      Image=Post }
      { 75      ;2   ;Action    ;
                      Name=Post;
                      ShortCutKey=F9;
                      Ellipsis=Yes;
                      CaptionML=[ENU=P&ost;
                                 NOR=B&okf›r];
                      ToolTipML=[ENU=Finalize the document or journal by posting the amounts and quantities to the related accounts in your company books.;
                                 NOR=Fullf›r dokumentet eller kladden ved † bokf›re bel›pene og antallene til de relaterte kontoene i selskapstabl†ene.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PostOrder;
                      PromotedCategory=Category6;
                      PromotedOnly=Yes;
                      OnAction=BEGIN
                                 Post(CODEUNIT::"Sales-Post (Yes/No)",NavigateAfterPost::"Posted Document");
                               END;
                                }
      { 19      ;2   ;Action    ;
                      Name=PostAndNew;
                      ShortCutKey=Shift+F9;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Post and New;
                                 NOR=Bokf›r og ny];
                      Promoted=Yes;
                      Image=PostOrder;
                      PromotedCategory=Category6;
                      OnAction=BEGIN
                                 Post(CODEUNIT::"Sales-Post (Yes/No)",NavigateAfterPost::"New Document");
                               END;
                                }
      { 29      ;2   ;Action    ;
                      Name=PostAndSend;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Post and Send;
                                 NOR=Bokf›r og Send];
                      ToolTipML=[ENU=Finalize and prepare to send the document according to the customer's sending profile, such as attached to an email. The Send document to window opens first so you can confirm or select a sending profile.;
                                 NOR=Fullf›r og klargj›r for † sende dokumentet i henhold til kundens sendingsprofil, for eksempel vedlagt i en e-post. Vinduet Send dokument til †pnes slik at du kan bekrefte eller velge en sendingsprofil.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Image=PostMail;
                      PromotedCategory=Category6;
                      PromotedOnly=Yes;
                      OnAction=BEGIN
                                 Post(CODEUNIT::"Sales-Post and Send",NavigateAfterPost::Nowhere);
                               END;
                                }
      { 74      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Test Report;
                                 NOR=Kontrollrapport];
                      ToolTipML=[ENU=View a test report so that you can find and correct any errors before you perform the actual posting of the journal or document.;
                                 NOR=Vis en kontrollrapport slik at du kan finne og rette eventuelle feil f›r du bokf›rer kladden eller dokumentet.];
                      Image=TestReport;
                      OnAction=BEGIN
                                 ReportPrint.PrintSalesHeader(Rec);
                               END;
                                }
      { 7       ;2   ;Action    ;
                      CaptionML=[ENU=Remove From Job Queue;
                                 NOR=Fjern fra jobbk›];
                      ToolTipML=[ENU=Remove the scheduled processing of this record from the job queue.;
                                 NOR=Fjern den planlagte behandlingen av denne posten fra prosjektk›en.];
                      ApplicationArea=#All;
                      Visible=JobQueueVisible;
                      Image=RemoveLine;
                      OnAction=BEGIN
                                 CancelBackgroundPosting;
                               END;
                                }
      { 51      ;2   ;Action    ;
                      Name=PreviewPosting;
                      CaptionML=[ENU=Preview Posting;
                                 NOR=Forh†ndsvis bokf›ring];
                      ToolTipML=[ENU=Review the different types of entries that will be created when you post the document or journal.;
                                 NOR=Se gjennom de ulike typene poster som blir opprettet n†r du bokf›rer dokumentet eller kladden.];
                      ApplicationArea=#Basic,#Suite;
                      Image=ViewPostedOrder;
                      OnAction=BEGIN
                                 ShowPreview;
                               END;
                                }
      { 236     ;2   ;ActionGroup;
                      CaptionML=[ENU=Prepa&yment;
                                 NOR=&Forskudd];
                      Image=Prepayment }
      { 231     ;3   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Prepayment &Test Report;
                                 NOR=&Testrapport for forskudd];
                      Image=PrepaymentSimulation;
                      OnAction=BEGIN
                                 ReportPrint.PrintSalesHeaderPrepmt(Rec);
                               END;
                                }
      { 232     ;3   ;Action    ;
                      Name=PostPrepaymentInvoice;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Post Prepayment &Invoice;
                                 NOR=Bo&kf›r forskuddsfaktura];
                      Image=PrepaymentPost;
                      OnAction=VAR
                                 SalesPostYNPrepmt@1000 : Codeunit 443;
                               BEGIN
                                 IF ApprovalsMgmt.PrePostApprovalCheckSales(Rec) THEN
                                   SalesPostYNPrepmt.PostPrepmtInvoiceYN(Rec,FALSE);
                               END;
                                }
      { 237     ;3   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Post and Print Prepmt. Invoic&e;
                                 NOR=Bokf›&r og skriv ut forskuddsfaktura];
                      Image=PrepaymentPostPrint;
                      OnAction=VAR
                                 SalesPostYNPrepmt@1000 : Codeunit 443;
                               BEGIN
                                 IF ApprovalsMgmt.PrePostApprovalCheckSales(Rec) THEN
                                   SalesPostYNPrepmt.PostPrepmtInvoiceYN(Rec,TRUE);
                               END;
                                }
      { 233     ;3   ;Action    ;
                      Name=PostPrepaymentCreditMemo;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Post Prepayment &Credit Memo;
                                 NOR=Bokf›r kredit&nota for forskudd];
                      Image=PrepaymentPost;
                      OnAction=VAR
                                 SalesPostYNPrepmt@1000 : Codeunit 443;
                               BEGIN
                                 IF ApprovalsMgmt.PrePostApprovalCheckSales(Rec) THEN
                                   SalesPostYNPrepmt.PostPrepmtCrMemoYN(Rec,FALSE);
                               END;
                                }
      { 238     ;3   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Post and Print Prepmt. Cr. Mem&o;
                                 NOR=Bokf›r og skriv &ut kreditnota for forskudd];
                      Image=PrepaymentPostPrint;
                      OnAction=VAR
                                 SalesPostYNPrepmt@1000 : Codeunit 443;
                               BEGIN
                                 IF ApprovalsMgmt.PrePostApprovalCheckSales(Rec) THEN
                                   SalesPostYNPrepmt.PostPrepmtCrMemoYN(Rec,TRUE);
                               END;
                                }
      { 223     ;1   ;ActionGroup;
                      CaptionML=[ENU=&Print;
                                 NOR=&Skriv ut];
                      Image=Print }
      { 225     ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Work Order;
                                 NOR=Arbeidsordre];
                      Image=Print;
                      OnAction=BEGIN
                                 DocPrint.PrintSalesOrder(Rec,Usage::"Work Order");
                               END;
                                }
      { 5       ;2   ;Action    ;
                      CaptionML=[ENU=Pick Instruction;
                                 NOR=Plukkinstruksjon];
                      Image=Print;
                      OnAction=BEGIN
                                 DocPrint.PrintSalesOrder(Rec,Usage::"Pick Instruction");
                               END;
                                }
      { 31      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Order Confirmation;
                                 NOR=&Ordrebekreftelse];
                      Image=Email }
      { 33      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Email Confirmation;
                                 NOR=Send bekreftelse p† e-post];
                      ToolTipML=[ENU=Send a sales order confirmation by email. The attachment is sent as a .pdf.;
                                 NOR=Send en ordrebekreftelse via e-post. Vedlegget sendes i PDF-format.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Image=Email;
                      PromotedCategory=Process;
                      PromotedOnly=Yes;
                      OnAction=BEGIN
                                 DocPrint.EmailSalesHeader(Rec);
                               END;
                                }
      { 96      ;2   ;ActionGroup;
                      Visible=FALSE }
      { 224     ;3   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Print Confirmation;
                                 NOR=Skriv ut bekreftelse];
                      ToolTipML=[ENU=Print a sales order confirmation.;
                                 NOR=Skriv ut en ordrebekreftelse.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Visible=NOT IsOfficeHost;
                      Image=Print;
                      PromotedCategory=Process;
                      PromotedOnly=Yes;
                      OnAction=BEGIN
                                 DocPrint.PrintSalesOrder(Rec,Usage::"Order Confirmation");
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=[ENU=General;
                           NOR=Generelt] }

    { 2   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the sales document. The field can be filled automatically or manually and can be set up to be invisible.;
                           NOR=Angir antall salgsdokumenter. Feltet kan fylles ut automatisk eller manuelt, og kan settes opp til † v‘re usynlig.];
                ApplicationArea=#All;
                SourceExpr="No.";
                Visible=DocNoVisible;
                Editable=FALSE;
                OnAssistEdit=BEGIN
                               IF AssistEdit(xRec) THEN
                                 CurrPage.UPDATE;
                             END;
                              }

    { 6   ;2   ;Field     ;
                CaptionML=[ENU=Customer;
                           NOR=Kunde];
                ToolTipML=[ENU=Specifies the name of the customer who will receive the products and be billed by default.;
                           NOR=Angir navnet p† kunden som mottar produktene og faktureres som standard.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Sell-to Customer Name";
                OnValidate=BEGIN
                             IF GETFILTER("Sell-to Customer No.") = xRec."Sell-to Customer No." THEN
                               IF "Sell-to Customer No." <> xRec."Sell-to Customer No." THEN
                                 SETRANGE("Sell-to Customer No.");

                             IF ApplicationAreaSetup.IsFoundationEnabled THEN
                               SalesCalcDiscountByType.ApplyDefaultInvoiceDiscount(0,Rec);

                             SellToCustomerUsesEInvoicing := CustomerUsesEInvoicing("Sell-to Customer No.");

                             CurrPage.UPDATE;
                           END;

                ShowMandatory=TRUE }

    { 190 ;2   ;Group     ;
                CaptionML=[ENU=Sell-to;
                           NOR=Salg til];
                GroupType=Group }

    { 157 ;3   ;Field     ;
                CaptionML=[ENU=Contact No.;
                           NOR=Kontaktnr.];
                ToolTipML=[ENU=Specifies the number of the contact that the sales document will be sent to.;
                           NOR=Angir nummeret til kontakten som salgsdokumentet vil bli sendt til.];
                SourceExpr="Sell-to Contact No.";
                Importance=Additional;
                OnValidate=BEGIN
                             IF GETFILTER("Sell-to Contact No.") = xRec."Sell-to Contact No." THEN
                               IF "Sell-to Contact No." <> xRec."Sell-to Contact No." THEN
                                 SETRANGE("Sell-to Contact No.");
                           END;
                            }

    { 8   ;3   ;Field     ;
                CaptionML=[ENU=Contact;
                           NOR=Kontakt];
                ToolTipML=[ENU=Specifies the name of the person to contact at the customer.;
                           NOR=Angir navnet p† kontaktpersonen hos kunden.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Sell-to Contact" }

    { 81  ;3   ;Field     ;
                CaptionML=[ENU=Address;
                           NOR=Adresse];
                ToolTipML=[ENU=Specifies the address where the customer is located.;
                           NOR=Angir adressen der kunden befinner seg.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Sell-to Address";
                Importance=Standard }

    { 83  ;3   ;Field     ;
                CaptionML=[ENU=Address 2;
                           NOR=Adresse 2];
                ToolTipML=[ENU=Specifies additional address information.;
                           NOR=Angir ekstra adresseinformasjon.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Sell-to Address 2";
                Importance=Standard }

    { 1101103001;3;Field  ;
                CaptionML=[ENU=Address 3;
                           NOR=Adresse 3];
                SourceExpr="Sell-to address 3" }

    { 72  ;3   ;Field     ;
                CaptionML=[ENU=Post Code;
                           NOR=Postnr.];
                ToolTipML=[ENU=Specifies the postal code.;
                           NOR=Angir postnummeret.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Sell-to Post Code";
                Importance=Standard }

    { 86  ;3   ;Field     ;
                CaptionML=[ENU=City;
                           NOR=Sted];
                ToolTipML=[ENU=Specifies the city where the customer is located.;
                           NOR=Angir poststedet der kunden befinner seg.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Sell-to City";
                Importance=Standard }

    { 1080016;2;Field     ;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Your Reference";
                ShowMandatory=SellToCustomerUsesEInvoicing }

    { 45  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date on which you created the sales document.;
                           NOR=Angir datoen da du opprettet salgsdokumentet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Document Date";
                Importance=Additional }

    { 12  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date when the posting of the sales document will be recorded.;
                           NOR=Angir datoen n†r bokf›ringen av salgsdokumentet blir registrert.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Posting Date";
                Importance=Promoted }

    { 14  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date on which the exchange rate applies to prices listed in a foreign currency on the sales order.;
                           NOR=Angir datoen for gjeldende valutakurs for priser som er oppf›rt i en fremmed valuta p† ordren.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Order Date";
                Importance=Promoted;
                QuickEntry=FALSE }

    { 30  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies when the sales invoice must be paid.;
                           NOR=Angir n†r salgsfakturaen m† betales.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Due Date";
                Importance=Promoted }

    { 135 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date that the customer has asked for the order to be delivered.;
                           NOR=Angir p† hvilken dato kunden har bedt om at ordren skal leveres.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Requested Delivery Date" }

    { 137 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date that you have promised to deliver the order, as a result of the Order Promising function.;
                           NOR=Angir datoen da du har lovet † levere ordren som et resultat av funksjonen Ordrebekreftelse.];
                SourceExpr="Promised Delivery Date";
                Importance=Additional }

    { 155 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number that the customer uses in their own system to refer to this sales document.;
                           NOR=Angir nummeret som kunden bruker i sitt eget system for † referere til dette salgsdokumentet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="External Document No.";
                Importance=Promoted;
                ShowMandatory=ExternalDocNoMandatory OR SellToCustomerUsesEInvoicing }

    { 50  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date you expect to ship items on the sales document.;
                           NOR=Angir datoen du forventer † levere varer, p† salgsdokumentet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Shipment Date";
                Importance=Promoted }

    { 10  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the name of the salesperson who is assigned to the customer.;
                           NOR=Angir navnet p† selgeren som er knyttet til kunden.];
                ApplicationArea=#Suite;
                SourceExpr="Salesperson Code";
                Importance=Additional;
                OnValidate=BEGIN
                             SalespersonCodeOnAfterValidate;
                           END;

                QuickEntry=FALSE }

    { 1148;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the campaign that the document is linked to.;
                           NOR=Angir nummeret p† kampanjen som dokumentet er knyttet til.];
                SourceExpr="Campaign No.";
                Importance=Additional }

    { 245 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the opportunity that the sales quote is assigned to.;
                           NOR=Angir nummeret for salgsmuligheten som tilbudet er tilordnet til.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Opportunity No.";
                Importance=Additional }

    { 124 ;2   ;Field     ;
                AccessByPermission=TableData 5714=R;
                ToolTipML=[ENU=Specifies the code of the responsibility center that is associated with the user, company, or vendor.;
                           NOR=Angir koden for ansvarssentret som er knyttet til brukeren, selskapet eller leverand›ren.];
                SourceExpr="Responsibility Center";
                Importance=Additional }

    { 241 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the ID of the user who is responsible for the document.;
                           NOR=Angir ID-en til brukeren som er ansvarlig for dokumentet.];
                SourceExpr="Assigned User ID";
                Importance=Additional }

    { 9   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the status of a job queue entry or task that handles the posting of sales orders.;
                           NOR=Angir status for en jobbk›post eller oppgave som h†ndterer bokf›ring av ordrer.];
                ApplicationArea=#All;
                SourceExpr="Job Queue Status";
                Importance=Additional;
                Visible=JobQueuesUsed }

    { 1101103003;2;Field  ;
                SourceExpr="Original Qoute No." }

    { 1101103004;2;Field  ;
                SourceExpr=Note }

    { 129 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies whether the document is open, waiting to be approved, has been invoiced for prepayment, or has been released to the next stage of processing.;
                           NOR=Angir om dokumentet er †pent, om det venter p† godkjenning, om det er fakturert for forskudd eller om det er frigitt til neste fase i behandlingen.];
                SourceExpr=Status;
                Importance=Promoted;
                QuickEntry=FALSE }

    { 1101103000;2;Field  ;
                SourceExpr="Order Class" }

    { 198 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of archived versions for this sales document.;
                           NOR=Angir antall arkiverte versjoner for dette salgsdokumentet.];
                SourceExpr="No. of Archived Versions";
                Importance=Additional }

    { 58  ;1   ;Part      ;
                Name=SalesLines;
                ApplicationArea=#Basic,#Suite;
                SubPageLink=Document No.=FIELD(No.);
                PagePartID=Page83042;
                Enabled="Sell-to Customer No." <> '';
                Editable=DynamicEditable;
                UpdatePropagation=Both }

    { 1905885101;1;Group  ;
                CaptionML=[ENU=Invoice Details;
                           NOR=Fakturadetaljer];
                GroupType=Group }

    { 111 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the currency of amounts on the sales document.;
                           NOR=Angir valutaen til bel›pene p† salgsdokumentet.];
                ApplicationArea=#Suite;
                SourceExpr="Currency Code";
                Importance=Promoted;
                OnValidate=BEGIN
                             CurrPage.UPDATE;
                             SalesCalcDiscountByType.ApplyDefaultInvoiceDiscount(0,Rec);
                           END;

                OnAssistEdit=BEGIN
                               CLEAR(ChangeExchangeRate);
                               IF "Posting Date" <> 0D THEN
                                 ChangeExchangeRate.SetParameter("Currency Code","Currency Factor","Posting Date")
                               ELSE
                                 ChangeExchangeRate.SetParameter("Currency Code","Currency Factor",WORKDATE);
                               IF ChangeExchangeRate.RUNMODAL = ACTION::OK THEN BEGIN
                                 VALIDATE("Currency Factor",ChangeExchangeRate.GetParameter);
                                 CurrPage.UPDATE;
                               END;
                               CLEAR(ChangeExchangeRate);
                             END;
                              }

    { 243 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the sales quote that the sales order was created from. You can track the number to sales quote documents that you have printed, saved, or emailed.;
                           NOR=Angir nummeret p† tilbudet som ordren ble opprettet fra. Du kan spore nummeret til tilbudsdokumenter du har skrevet ut, lagret eller sendt via e-post.];
                ApplicationArea=#All;
                SourceExpr="Quote No.";
                Visible=ShowQuoteNo }

    { 131 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies whether the unit price on the line should be displayed including or excluding VAT.;
                           NOR=Angir om salgsprisen p† linjen skal vises inklusiv eller eksklusiv mva.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Prices Including VAT";
                OnValidate=BEGIN
                             PricesIncludingVATOnAfterValid;
                           END;
                            }

    { 221 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the customer's VAT specification to link transactions made for this customer to.;
                           NOR=Angir kundens mva-spesifikasjon for † koble transaksjoner som er gjort for kunden, til.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="VAT Bus. Posting Group";
                OnValidate=BEGIN
                             IF ApplicationAreaSetup.IsFoundationEnabled THEN
                               SalesCalcDiscountByType.ApplyDefaultInvoiceDiscount(0,Rec);

                             CurrPage.UPDATE;
                           END;
                            }

    { 28  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a formula that calculates the payment due date, payment discount date, and payment discount amount on the sales document.;
                           NOR=Angir en formel som beregner forfallsdatoen for betalingen, kontantrabattdatoen og kontantrabattbel›pet, p† salgsdokumentet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Payment Terms Code";
                Importance=Promoted }

    { 105 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies how the customer must pay for products on the sales document.;
                           NOR=Angir hvordan kunden m† betale for produkter p† salgsdokumentet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Payment Method Code";
                Importance=Additional;
                OnValidate=BEGIN
                             UpdatePaymentService;
                           END;
                            }

    { 76  ;2   ;Group     ;
                Visible=PaymentServiceVisible;
                GroupType=Group }

    { 16  ;3   ;Field     ;
                Name=SelectedPayments;
                CaptionML=[ENU=Payment Service;
                           NOR=Betalingstjeneste];
                ToolTipML=[ENU=Specifies the online payment service, such as PayPal, that customers can use to pay the sales document.;
                           NOR=Angir den elektroniske betalingstjenesten, for eksempel PayPal, som kunder kan bruke til † betale salgsdokumentet.];
                ApplicationArea=#All;
                SourceExpr=GetSelectedPaymentServicesText;
                Enabled=PaymentServiceEnabled;
                Editable=FALSE;
                MultiLine=Yes;
                OnAssistEdit=BEGIN
                               ChangePaymentServiceSetting;
                             END;
                              }

    { 54  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the type of transaction that the sales document represents, for the purpose of reporting to INTRASTAT.;
                           NOR=Angir transaksjonstypen som salgsdokumentet representerer ved rapportering til INTRASTAT.];
                SourceExpr="Transaction Type" }

    { 84  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the dimension value code associated with the sales header.;
                           NOR=Angir dimensjonsverdikoden som er knyttet til salgshodet.];
                SourceExpr="Shortcut Dimension 1 Code";
                OnValidate=BEGIN
                             ShortcutDimension1CodeOnAfterV;
                           END;
                            }

    { 92  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the dimension value code associated with the sales header.;
                           NOR=Angir dimensjonsverdikoden som er knyttet til salgshodet.];
                SourceExpr="Shortcut Dimension 2 Code";
                OnValidate=BEGIN
                             ShortcutDimension2CodeOnAfterV;
                           END;
                            }

    { 32  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the payment discount percentage granted if the customer pays on or before the date entered in the Pmt. Discount Date field.;
                           NOR=Angir kontantrabattprosenten som gis hvis kunden betaler innen den datoen som er satt inn i feltet Kont.rabattdato.];
                SourceExpr="Payment Discount %" }

    { 34  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the last date the customer can pay the invoice and still receive a payment discount.;
                           NOR=Angir den datoen som fakturaen senest skal betales, hvis kunden skal oppn† kontantrabatt.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pmt. Discount Date";
                Importance=Additional }

    { 27  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the direct-debit mandate that the customer has signed to allow direct debit collection of payments.;
                           NOR=Angir Direct Debit-belastningsfullmakten som kunden har signert for † tillate Direct Debit-oppkreving av utbetalinger.];
                SourceExpr="Direct Debit Mandate ID" }

    { 94  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the location from where inventory items to the customer on the sales document are to be shipped by default.;
                           NOR=Angir plasseringen der lagervarer til kunden p† salgsdokumentet leveres fra som standard.];
                SourceExpr="Location Code" }

    { 143 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies how long it takes from when the sales order is shipped from the warehouse to when the order is delivered.;
                           NOR=Angir hvor lang tid det tar fra ordren leveres fra lageret til ordren er levert til kundens adresse.];
                SourceExpr="Shipping Time";
                Importance=Additional }

    { 145 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies that the shipment of one or more lines has been delayed, or that the shipment date is before the work date.;
                           NOR=Angir at leveringen av ‚n eller flere linjer er forsinket, eller at leveringsdatoen er f›r arbeidsdatoen.];
                SourceExpr="Late Order Shipping";
                Importance=Additional }

    { 119 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies if the customer accepts partial shipment of orders.;
                           NOR=Angir om kunden godtar dellevering av ordrer.];
                SourceExpr="Shipping Advice";
                Importance=Additional;
                OnValidate=BEGIN
                             IF "Shipping Advice" <> xRec."Shipping Advice" THEN
                               IF NOT CONFIRM(Text001,FALSE,FIELDCAPTION("Shipping Advice")) THEN
                                 ERROR(Text002);
                           END;
                            }

    { 141 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the outbound warehouse handling time.;
                           NOR=Angir utg†ende lagerbehandlingstid.];
                SourceExpr="Outbound Whse. Handling Time";
                Importance=Additional }

    { 1101103024;2;Field  ;
                SourceExpr="PDF E-Mail" }

    { 1101103025;2;Field  ;
                SourceExpr="Send Invoice in E-Mail" }

    { 1906801201;1;Group  ;
                CaptionML=[ENU=Shipping and Billing;
                           NOR=Levering og fakturering];
                GroupType=Group }

    { 91  ;2   ;Group     ;
                GroupType=Group }

    { 90  ;3   ;Group     ;
                GroupType=Group }

    { 88  ;4   ;Field     ;
                Name=ShippingOptions;
                CaptionML=[ENU=Ship-to;
                           NOR=Lever til];
                ToolTipML=[ENU=Specifies the address that the products on the sales document are shipped to. Default (Sell-to Address): The same as the customer's sell-to address. Alternate Ship-to Address: One of the customer's alternate ship-to addresses. Custom Address: Any ship-to address that you specify in the fields below.;
                           NOR=Angir adressen som produkter i salgsdokumentet leveres til. Standard (Salg til-adresse): Det samme som kundens salg til-adresse. Alternativ lever til-adresse: n av kundens alternative lever til-adresser. Kundeadresse: Lever til-adresse som du angir i feltene nedenfor.];
                OptionCaptionML=[ENU=Default (Sell-to Address),Alternate Shipping Address,Custom Address;
                                 NOR=Standard (Salg til-adresse),Alternativ leveringsadresse,Kundeadresse];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=ShipToOptions;
                OnValidate=VAR
                             ShipToAddress@1001 : Record 222;
                             ShipToAddressList@1000 : Page 301;
                           BEGIN
                             CASE ShipToOptions OF
                               ShipToOptions::"Default (Sell-to Address)":
                                 BEGIN
                                   VALIDATE("Ship-to Code",'');
                                   CopySellToAddressToShipToAddress;
                                 END;
                               ShipToOptions::"Alternate Shipping Address":
                                 BEGIN
                                   ShipToAddress.SETRANGE("Customer No.","Sell-to Customer No.");
                                   ShipToAddressList.LOOKUPMODE := TRUE;
                                   ShipToAddressList.SETTABLEVIEW(ShipToAddress);

                                   IF ShipToAddressList.RUNMODAL = ACTION::LookupOK THEN BEGIN
                                     ShipToAddressList.GETRECORD(ShipToAddress);
                                     VALIDATE("Ship-to Code",ShipToAddress.Code);
                                   END ELSE
                                     ShipToOptions := ShipToOptions::"Custom Address";
                                 END;
                               ShipToOptions::"Custom Address":
                                 VALIDATE("Ship-to Code",'');
                             END;
                           END;
                            }

    { 4   ;4   ;Group     ;
                Visible=NOT (ShipToOptions = ShipToOptions::"Default (Sell-to Address)");
                GroupType=Group }

    { 36  ;5   ;Field     ;
                CaptionML=[ENU=Code;
                           NOR=Kode];
                ToolTipML=[ENU=Specifies the code for another shipment address than the customer's own address, which is entered by default.;
                           NOR=Angir koden for en annen leveringsadresse enn kundens egen adresse, som er angitt som standard.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Code";
                Importance=Promoted;
                Editable=ShipToOptions = ShipToOptions::"Alternate Shipping Address";
                OnValidate=BEGIN
                             IF (xRec."Ship-to Code" <> '') AND ("Ship-to Code" = '') THEN
                               ERROR(EmptyShipToCodeErr);
                           END;
                            }

    { 38  ;5   ;Field     ;
                CaptionML=[ENU=Name;
                           NOR=Navn];
                ToolTipML=[ENU=Specifies the name that products on the sales document will be shipped to.;
                           NOR=Angir navnet som produkter p† salgsdokumentet skal leveres til.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Name";
                Editable=ShipToOptions = ShipToOptions::"Custom Address" }

    { 40  ;5   ;Field     ;
                CaptionML=[ENU=Address;
                           NOR=Adresse];
                ToolTipML=[ENU=Specifies the address that products on the sales document will be shipped to.;
                           NOR=Angir adressen som produkter p† salgsdokumentet skal leveres til.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Address";
                Editable=ShipToOptions = ShipToOptions::"Custom Address" }

    { 42  ;5   ;Field     ;
                CaptionML=[ENU=Address 2;
                           NOR=Adresse 2];
                ToolTipML=[ENU=Specifies additional address information.;
                           NOR=Angir ekstra adresseinformasjon.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Address 2";
                Editable=ShipToOptions = ShipToOptions::"Custom Address" }

    { 1101103005;5;Field  ;
                CaptionML=[ENU=Address 3;
                           NOR=Adresse 3];
                SourceExpr="Lever-til adresse 3" }

    { 97  ;5   ;Field     ;
                CaptionML=[ENU=Post Code;
                           NOR=Postnr.];
                ToolTipML=[ENU=Specifies the postal code.;
                           NOR=Angir postnummeret.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Post Code";
                Editable=ShipToOptions = ShipToOptions::"Custom Address" }

    { 44  ;5   ;Field     ;
                CaptionML=[ENU=City;
                           NOR=Sted];
                ToolTipML=[ENU=Specifies the city that products on the sales document will be shipped to.;
                           NOR=Angir poststedet som produkter p† salgsdokumentet skal leveres til.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to City";
                Editable=ShipToOptions = ShipToOptions::"Custom Address" }

    { 95  ;5   ;Field     ;
                CaptionML=[ENU=Country/Region;
                           NOR=Land/omr†de];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Country/Region Code";
                Importance=Additional;
                Editable=ShipToOptions = ShipToOptions::"Custom Address" }

    { 1101103002;5;Field  ;
                SourceExpr="Lever-til telefonnr." }

    { 46  ;5   ;Field     ;
                CaptionML=[ENU=Contact;
                           NOR=Kontakt];
                ToolTipML=[ENU=Specifies the name of the contact person at the address that products on the sales document will be shipped to.;
                           NOR=Angir navnet p† kontaktpersonen i adressen som produkter p† salgsdokumentet skal leveres til.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Contact";
                Editable=ShipToOptions = ShipToOptions::"Custom Address" }

    { 77  ;3   ;Group     ;
                CaptionML=[ENU=Shipment Method;
                           NOR=Leveringsm†te];
                GroupType=Group }

    { 48  ;4   ;Field     ;
                CaptionML=[ENU=Code;
                           NOR=Kode];
                ToolTipML=[ENU=Specifies how items on the sales document are shipped to the customer.;
                           NOR=Angir hvordan varer p† salgsdokumentet leveres til kunden.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Shipment Method Code";
                Importance=Additional }

    { 107 ;4   ;Field     ;
                CaptionML=[ENU=Agent;
                           NOR=Selger];
                ToolTipML=[ENU=Specifies which shipping agent is used to transport the items on the sales document to the customer.;
                           NOR=Angir hvilken transport›r som skal brukes til † transportere varene p† salgsdokumentet til kunden.];
                ApplicationArea=#Suite;
                SourceExpr="Shipping Agent Code";
                Importance=Additional }

    { 139 ;4   ;Field     ;
                CaptionML=[ENU=Agent Service;
                           NOR=Selgertjeneste];
                ToolTipML=[ENU=Specifies the code that represents the default shipping agent service you are using for this sales order.;
                           NOR=Angir koden som representerer standard transport›rservice som du bruker for denne ordren.];
                ApplicationArea=#Suite;
                SourceExpr="Shipping Agent Service Code";
                Importance=Additional }

    { 109 ;4   ;Field     ;
                ToolTipML=[ENU=Specifies the shipping agent's package number.;
                           NOR=Angir transport›rens pakkenummer.];
                ApplicationArea=#Suite;
                SourceExpr="Package Tracking No.";
                Importance=Additional }

    { 85  ;2   ;Group     ;
                GroupType=Group }

    { 93  ;3   ;Field     ;
                CaptionML=[ENU=Bill-to;
                           NOR=Faktura til];
                ToolTipML=[ENU=Specifies the customer that the sales invoice will be sent to. Default (Customer): The same as the customer on the sales invoice. Another Customer: Any customer that you specify in the fields below.;
                           NOR=Angir kunden som salgsfakturaen sendes til. Standard (Kunde): De samme som kunden p† salgsfakturaen. En annen kunde: En kunde du angir i feltene nedenfor.];
                OptionCaptionML=[ENU=Default (Customer),Another Customer;
                                 NOR=Standard (kunde),En annen kunde];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=BillToOptions;
                OnValidate=BEGIN
                             IF BillToOptions = BillToOptions::"Default (Customer)" THEN
                               VALIDATE("Bill-to Customer No.","Sell-to Customer No.");
                           END;
                            }

    { 82  ;3   ;Group     ;
                Visible=BillToOptions = BillToOptions::"Another Customer";
                GroupType=Group }

    { 18  ;4   ;Field     ;
                CaptionML=[ENU=Name;
                           NOR=Navn];
                ToolTipML=[ENU=Specifies the customer to whom you will send the sales invoice, when different from the customer that you are selling to.;
                           NOR=Angir kunden som du sender salgsfakturaen til, n†r det er en annen enn kunden som du selger til.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Bill-to Name";
                Importance=Promoted;
                OnValidate=BEGIN
                             IF GETFILTER("Bill-to Customer No.") = xRec."Bill-to Customer No." THEN
                               IF "Bill-to Customer No." <> xRec."Bill-to Customer No." THEN
                                 SETRANGE("Bill-to Customer No.");

                             IF ApplicationAreaSetup.IsFoundationEnabled THEN
                               SalesCalcDiscountByType.ApplyDefaultInvoiceDiscount(0,Rec);

                             CurrPage.UPDATE;
                           END;
                            }

    { 20  ;4   ;Field     ;
                CaptionML=[ENU=Address;
                           NOR=Adresse];
                ToolTipML=[ENU=Specifies the address of the customer that you will send the invoice to.;
                           NOR=Angir adressen til kunden som fakturaen skal sendes til.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Bill-to Address";
                Importance=Additional }

    { 22  ;4   ;Field     ;
                CaptionML=[ENU=Address 2;
                           NOR=Adresse 2];
                ToolTipML=[ENU=Specifies additional address information.;
                           NOR=Angir ekstra adresseinformasjon.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Bill-to Address 2";
                Importance=Additional }

    { 89  ;4   ;Field     ;
                CaptionML=[ENU=Post Code;
                           NOR=Postnr.];
                ToolTipML=[ENU=Specifies the postal code.;
                           NOR=Angir postnummeret.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Bill-to Post Code";
                Importance=Additional }

    { 24  ;4   ;Field     ;
                CaptionML=[ENU=City;
                           NOR=Sted];
                ToolTipML=[ENU=Specifies the city you will send the invoice to.;
                           NOR=Angir poststedet som fakturaen skal sendes til.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Bill-to City";
                Importance=Additional }

    { 159 ;4   ;Field     ;
                CaptionML=[ENU=Contact No.;
                           NOR=Kontaktnr.];
                ToolTipML=[ENU=Specifies the number of the contact the invoice will be sent to.;
                           NOR=Angir nummeret til kontakten som fakturaen vil bli sendt til.];
                SourceExpr="Bill-to Contact No.";
                Importance=Additional }

    { 26  ;4   ;Field     ;
                CaptionML=[ENU=Contact;
                           NOR=Kontakt];
                ToolTipML=[ENU=Specifies the name of the person you should contact at the customer who you are sending the invoice to.;
                           NOR=Angir navnet p† kontaktperson hos kunden som fakturaen blir sendt til.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Bill-to Contact" }

    { 1080006;2;Field     ;
                ToolTipML=[ENU=Specifies the global location number of the customer.;
                           NOR=Angir det globale lokasjonsnummeret for kunden.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=GLN }

    { 1080012;2;Field     ;
                ToolTipML=[ENU=Specifies the account code of the customer.;
                           NOR=Angir kontokoden for kunden.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Account Code";
                OnValidate=BEGIN
                             AccountCodeOnAfterValidate;
                           END;
                            }

    { 1080008;2;Field     ;
                ToolTipML=[ENU=Specifies whether the customer is part of the EHF system and requires an electronic sales order.;
                           NOR=Angir om kunden er en del av EHF-systemet og krever en elektronisk ordre.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="E-Invoice" }

    { 1907468901;1;Group  ;
                CaptionML=[ENU=Foreign Trade;
                           NOR=Utenrikshandel] }

    { 52  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies whether the sales document is part of a three-party trade.;
                           NOR=Angir om salgsdokumentet er en del av en tredjepartshandel.];
                SourceExpr="EU 3-Party Trade" }

    { 103 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a code for the sales document's transaction specification, for the purpose of reporting to INTRASTAT.;
                           NOR=Angir en kode for salgsdokumentets transaksjonsspesifikasjon ved rapportering til INTRASTAT.];
                SourceExpr="Transaction Specification" }

    { 56  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the transport method, for the purpose of reporting to INTRASTAT.;
                           NOR=Angir transportm†ten ved rapportering til INTRASTAT.];
                SourceExpr="Transport Method" }

    { 99  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the point of exit through which you ship the items out of your country/region, for reporting to Intrastat.;
                           NOR=Angir utskipningshavnen du sender varene ut av landet/regionen fra ved rapportering til Intrastat.];
                SourceExpr="Exit Point" }

    { 101 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the area of the customer's address, for the purpose of reporting to INTRASTAT.;
                           NOR=Angir omr†det i kundens adresse for rapportering til INTRASTAT.];
                SourceExpr=Area }

    { 1900201301;1;Group  ;
                CaptionML=[ENU=Prepayment;
                           NOR=Forskudd] }

    { 228 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the prepayment percentage if you want to apply a prepayment to all lines on the sales order.;
                           NOR=Angir forskuddsprosenten hvis du vil bruke et forskudd p† alle linjer p† ordren.];
                SourceExpr="Prepayment %";
                Importance=Promoted;
                OnValidate=BEGIN
                             Prepayment37OnAfterValidate;
                           END;
                            }

    { 229 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies that prepayments on the sales order are combined if they have the same general ledger account for prepayments or the same dimensions.;
                           NOR=Angir at forskudd p† ordren er kombinert hvis de har samme finanskonto for forskudd eller de samme dimensjonene.];
                SourceExpr="Compress Prepayment" }

    { 162 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code that represents the payment terms for prepayment invoices related to the sales document.;
                           NOR=Angir koden som representerer betalingsbetingelsene for forskuddsfakturaer som er knyttet til salgsdokumentet.];
                SourceExpr="Prepmt. Payment Terms Code" }

    { 239 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies when the prepayment invoice for this sales order is due.;
                           NOR=Angir n†r forskuddsfakturaen for denne ordren forfaller.];
                SourceExpr="Prepayment Due Date";
                Importance=Promoted }

    { 164 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the payment discount percent granted on the prepayment if the customer pays on or before the date entered in the Prepmt. Pmt. Discount Date field.;
                           NOR=Angir kontantrabattprosenten som gis for forskuddet hvis kunden betaler innen den datoen som er satt inn i feltet Rabattdato for betaling for forskudd.];
                SourceExpr="Prepmt. Payment Discount %" }

    { 70  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the last date the customer can pay the prepayment invoice and still receive a payment discount on the prepayment amount.;
                           NOR=Angir den siste datoen for n†r kunden kan betale forskuddsfakturaen og likevel motta kontantrabatt p† forskuddsbel›pet.];
                SourceExpr="Prepmt. Pmt. Discount Date" }

    { 1101103017;1;Group  ;
                Name=Progress;
                CaptionML=[ENU=Progress;
                           NOR=Progress];
                GroupType=Group }

    { 1101103018;2;Field  ;
                SourceExpr=Konfigurert }

    { 1101103019;2;Field  ;
                SourceExpr="Simulert prod.o." }

    { 1101103020;2;Field  ;
                SourceExpr="Opprettet prod.ordre" }

    { 1101103021;2;Field  ;
                SourceExpr=Levert }

    { 1101103022;2;Field  ;
                SourceExpr=Delfakturert }

    { 1101103007;1;Group  ;
                Name=Service;
                CaptionML=[ENU=Service;
                           NOR=Service];
                GroupType=Group }

    { 1101103008;2;Field  ;
                SourceExpr="Type of Task" }

    { 1101103009;2;Field  ;
                SourceExpr="Service Item No." }

    { 1101103010;2;Field  ;
                SourceExpr="Running Hours" }

    { 1101103011;2;Field  ;
                SourceExpr="Engine Type" }

    { 1101103012;2;Field  ;
                SourceExpr="Engine Type - Description" }

    { 1101103013;2;Field  ;
                SourceExpr="Service Done" }

    { 1101103014;2;Field  ;
                SourceExpr="Service Note" }

    { 1101103015;2;Field  ;
                SourceExpr="Reklamasjon godkjent" }

    { 1101103016;2;Field  ;
                SourceExpr=Servicemann }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 35  ;1   ;Part      ;
                ApplicationArea=#All;
                SubPageLink=Table ID=CONST(36),
                            Document Type=FIELD(Document Type),
                            Document No.=FIELD(No.);
                PagePartID=Page9103;
                Visible=OpenApprovalEntriesExistForCurrUser;
                PartType=Page }

    { 1903720907;1;Part   ;
                SubPageLink=No.=FIELD(Sell-to Customer No.);
                PagePartID=Page9080;
                PartType=Page }

    { 1902018507;1;Part   ;
                SubPageLink=No.=FIELD(Bill-to Customer No.);
                PagePartID=Page9082;
                Visible=FALSE;
                PartType=Page }

    { 1900316107;1;Part   ;
                SubPageLink=No.=FIELD(Sell-to Customer No.);
                PagePartID=Page9084;
                PartType=Page }

    { 1906127307;1;Part   ;
                ApplicationArea=#Suite;
                SubPageLink=Document Type=FIELD(Document Type),
                            Document No.=FIELD(Document No.),
                            Line No.=FIELD(Line No.);
                PagePartID=Page9087;
                ProviderID=58;
                PartType=Page }

    { 1901314507;1;Part   ;
                SubPageLink=No.=FIELD(No.);
                PagePartID=Page9089;
                ProviderID=58;
                PartType=Page }

    { 1906354007;1;Part   ;
                Name=ApprovalFactBox;
                PagePartID=Page9092;
                Visible=FALSE;
                PartType=Page }

    { 49  ;1   ;Part      ;
                Name=IncomingDocAttachFactBox;
                PagePartID=Page193;
                Visible=FALSE;
                PartType=Page;
                ShowFilter=No }

    { 1907012907;1;Part   ;
                SubPageLink=No.=FIELD(No.);
                PagePartID=Page9108;
                ProviderID=58;
                Visible=FALSE;
                PartType=Page }

    { 1901796907;1;Part   ;
                SubPageLink=No.=FIELD(No.);
                PagePartID=Page9109;
                ProviderID=58;
                Visible=FALSE;
                PartType=Page }

    { 1907234507;1;Part   ;
                SubPageLink=No.=FIELD(Bill-to Customer No.);
                PagePartID=Page9081;
                Visible=FALSE;
                PartType=Page }

    { 80  ;1   ;Part      ;
                Name=WorkflowStatus;
                ApplicationArea=#All;
                PagePartID=Page1528;
                Visible=ShowWorkflowStatus;
                Enabled=FALSE;
                Editable=FALSE;
                PartType=Page;
                ShowFilter=No }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      ApplicationAreaSetup@1022 : Record 9178;
      CopySalesDoc@1001 : Report 292;
      MoveNegSalesLines@1007 : Report 6699;
      ApprovalsMgmt@1012 : Codeunit 1535;
      ReportPrint@1002 : Codeunit 228;
      DocPrint@1003 : Codeunit 229;
      ArchiveManagement@1008 : Codeunit 5063;
      SalesCalcDiscountByType@1014 : Codeunit 56;
      UserMgt@1006 : Codeunit 5700;
      ChangeExchangeRate@1005 : Page 511;
      Usage@1010 : 'Order Confirmation,Work Order,Pick Instruction';
      NavigateAfterPost@1029 : 'Posted Document,New Document,Nowhere';
      JobQueueVisible@1004 : Boolean INDATASET;
      Text001@1015 : TextConst 'ENU=Do you want to change %1 in all related records in the warehouse?;NOR=Vil du endre %1 i alle tilh›rende poster p† lager?';
      Text002@1011 : TextConst 'ENU=The update has been interrupted to respect the warning.;NOR=Oppdateringen er avbrutt som en reaksjon p† advarselen.';
      DynamicEditable@1009 : Boolean;
      HasIncomingDocument@1020 : Boolean;
      DocNoVisible@1013 : Boolean;
      SellToCustomerUsesEInvoicing@1080000 : Boolean;
      ExternalDocNoMandatory@1016 : Boolean;
      OpenApprovalEntriesExistForCurrUser@1024 : Boolean;
      OpenApprovalEntriesExist@1023 : Boolean;
      CRMIntegrationEnabled@1000 : Boolean;
      CRMIsCoupledToRecord@1017 : Boolean;
      ShowWorkflowStatus@1018 : Boolean;
      IsOfficeHost@1019 : Boolean;
      CanCancelApprovalForRecord@1021 : Boolean;
      JobQueuesUsed@1026 : Boolean;
      ShowQuoteNo@1025 : Boolean;
      DocumentIsPosted@1027 : Boolean;
      OpenPostedSalesOrderQst@1028 : TextConst 'ENU=The order has been posted and moved to the Posted Sales Invoices window.\\Do you want to open the posted invoice?;NOR=Ordren er bokf›rt og flyttet til vinduet Bokf›rte salgsfakturaer.\\Vil du †pne den bokf›rte fakturaen?';
      PaymentServiceVisible@1030 : Boolean;
      PaymentServiceEnabled@1031 : Boolean;
      ShipToOptions@1033 : 'Default (Sell-to Address),Alternate Shipping Address,Custom Address';
      BillToOptions@1032 : 'Default (Customer),Another Customer';
      EmptyShipToCodeErr@1034 : TextConst 'ENU=The Code field can only be empty if you select Custom Address in the Ship-to field.;NOR=Kode-feltet kan bare v‘re tomt hvis du velger Kundeadresse i Lever til-feltet.';

    LOCAL PROCEDURE Post@4(PostingCodeunitID@1000 : Integer;Navigate@1004 : Option);
    VAR
      SalesHeader@1001 : Record 36;
      LinesInstructionMgt@1002 : Codeunit 1320;
      InstructionMgt@1003 : Codeunit 1330;
    BEGIN
      IF ApplicationAreaSetup.IsFoundationEnabled THEN
        LinesInstructionMgt.SalesCheckAllLinesHaveQuantityAssigned(Rec);

      SendToPosting(PostingCodeunitID);
      DocumentIsPosted := NOT SalesHeader.GET("Document Type","No.");

      IF "Job Queue Status" = "Job Queue Status"::"Scheduled for Posting" THEN
        CurrPage.CLOSE;
      CurrPage.UPDATE(FALSE);

      IF PostingCodeunitID <> CODEUNIT::"Sales-Post (Yes/No)" THEN
        EXIT;

      CASE Navigate OF
        NavigateAfterPost::"Posted Document":
          IF InstructionMgt.IsEnabled(InstructionMgt.ShowPostedConfirmationMessageCode) THEN
            ShowPostedConfirmationMessage;
        NavigateAfterPost::"New Document":
          IF DocumentIsPosted THEN BEGIN
            SalesHeader.INIT;
            SalesHeader.VALIDATE("Document Type",SalesHeader."Document Type"::Order);
            SalesHeader.INSERT(TRUE);
            PAGE.RUN(PAGE::"Sales Order",SalesHeader);
          END;
      END;
    END;

    LOCAL PROCEDURE ApproveCalcInvDisc@3();
    BEGIN
      CurrPage.SalesLines.PAGE.ApproveCalcInvDisc;
    END;

    LOCAL PROCEDURE SalespersonCodeOnAfterValidate@19011896();
    BEGIN
      CurrPage.SalesLines.PAGE.UpdateForm(TRUE);
    END;

    LOCAL PROCEDURE ShortcutDimension1CodeOnAfterV@19029405();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE ShortcutDimension2CodeOnAfterV@19008725();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE PricesIncludingVATOnAfterValid@19009096();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE AccountCodeOnAfterValidate@19007267();
    BEGIN
      CurrPage.SalesLines.PAGE.UpdateForm(TRUE)
    END;

    LOCAL PROCEDURE Prepayment37OnAfterValidate@19040510();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE SetDocNoVisible@2();
    VAR
      DocumentNoVisibility@1000 : Codeunit 1400;
      DocType@1003 : 'Quote,Order,Invoice,Credit Memo,Blanket Order,Return Order,Reminder,FinChMemo';
    BEGIN
      DocNoVisible := DocumentNoVisibility.SalesDocumentNoIsVisible(DocType::Order,"No.");
    END;

    LOCAL PROCEDURE CustomerUsesEInvoicing@1060002(CustomerNo@1060000 : Code[20]) : Boolean;
    VAR
      Customer@1060001 : Record 18;
    BEGIN
      IF Customer.GET(CustomerNo) THEN
        EXIT (Customer."E-Invoice");
      EXIT(FALSE)
    END;

    LOCAL PROCEDURE SetExtDocNoMandatoryCondition@5();
    VAR
      SalesReceivablesSetup@1000 : Record 311;
    BEGIN
      SalesReceivablesSetup.GET;
      ExternalDocNoMandatory := SalesReceivablesSetup."Ext. Doc. No. Mandatory"
    END;

    LOCAL PROCEDURE ShowPreview@6();
    VAR
      SalesPostYesNo@1000 : Codeunit 81;
    BEGIN
      SalesPostYesNo.Preview(Rec);
    END;

    LOCAL PROCEDURE SetControlVisibility@7();
    VAR
      ApprovalsMgmt@1002 : Codeunit 1535;
    BEGIN
      JobQueueVisible := "Job Queue Status" = "Job Queue Status"::"Scheduled for Posting";
      HasIncomingDocument := "Incoming Document Entry No." <> 0;
      SetExtDocNoMandatoryCondition;

      OpenApprovalEntriesExistForCurrUser := ApprovalsMgmt.HasOpenApprovalEntriesForCurrentUser(RECORDID);
      OpenApprovalEntriesExist := ApprovalsMgmt.HasOpenApprovalEntries(RECORDID);
      CanCancelApprovalForRecord := ApprovalsMgmt.CanCancelApprovalForRecord(RECORDID);
    END;

    LOCAL PROCEDURE ShowPostedConfirmationMessage@17();
    VAR
      OrderSalesHeader@1003 : Record 36;
      SalesInvoiceHeader@1000 : Record 112;
      InstructionMgt@1002 : Codeunit 1330;
    BEGIN
      IF NOT OrderSalesHeader.GET("Document Type","No.") THEN BEGIN
        SalesInvoiceHeader.SETRANGE("No.","Last Posting No.");
        IF SalesInvoiceHeader.FINDFIRST THEN
          IF InstructionMgt.ShowConfirm(OpenPostedSalesOrderQst,InstructionMgt.ShowPostedConfirmationMessageCode) THEN
            PAGE.RUN(PAGE::"Posted Sales Invoice",SalesInvoiceHeader);
      END;
    END;

    LOCAL PROCEDURE UpdatePaymentService@1();
    VAR
      PaymentServiceSetup@1000 : Record 1060;
    BEGIN
      PaymentServiceVisible := PaymentServiceSetup.IsPaymentServiceVisible;
      PaymentServiceEnabled := PaymentServiceSetup.CanChangePaymentService(Rec);
    END;

    LOCAL PROCEDURE UpdateShipToBillToGroupVisibility@9();
    BEGIN
      CASE TRUE OF
        ("Ship-to Code" = '') AND ShipToAddressEqualsSellToAddress:
          ShipToOptions := ShipToOptions::"Default (Sell-to Address)";
        ("Ship-to Code" = '') AND (NOT ShipToAddressEqualsSellToAddress):
          ShipToOptions := ShipToOptions::"Custom Address";
        "Ship-to Code" <> '':
          ShipToOptions := ShipToOptions::"Alternate Shipping Address";
      END;

      IF "Bill-to Customer No." = "Sell-to Customer No." THEN
        BillToOptions := BillToOptions::"Default (Customer)"
      ELSE
        BillToOptions := BillToOptions::"Another Customer";
    END;

    [Integration]
    LOCAL PROCEDURE OnBeforeStatisticsAction@8(VAR SalesHeader@1000 : Record 36;VAR Handled@1001 : Boolean);
    BEGIN
    END;

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 15.08.17 JAL Based on PAG42
                       Changed CardPageID added fields and Actions.
    }
    END.
  }
}

OBJECT Page 83042 OPC Sales Order Subform
{
  OBJECT-PROPERTIES
  {
    Date=20.09.17;
    Time=15:17:34;
    Modified=Yes;
    Version List=NAVW110.00.00.15140,NAVNO10.00.00.15140,OPC6.01;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Lines;
               NOR=Linjer];
    MultipleNewLines=Yes;
    LinksAllowed=No;
    SourceTable=Table37;
    DelayedInsert=Yes;
    SourceTableView=WHERE(Document Type=FILTER(Order));
    PageType=ListPart;
    AutoSplitKey=Yes;
    OnInit=BEGIN
             SalesSetup.GET;
             Currency.InitRoundingPrecision;
           END;

    OnOpenPage=VAR
                 Location@1000 : Record 14;
               BEGIN
                 IF Location.READPERMISSION THEN
                   LocationCodeVisible := NOT Location.ISEMPTY;
               END;

    OnAfterGetRecord=BEGIN
                       ShowShortcutDimCode(ShortcutDimCode);
                     END;

    OnNewRecord=BEGIN
                  IF ApplicationAreaSetup.IsFoundationEnabled THEN
                    Type := Type::Item
                  ELSE
                    InitType;
                  CLEAR(ShortcutDimCode);
                END;

    OnInsertRecord=BEGIN
                     IF ApplicationAreaSetup.IsFoundationEnabled THEN
                       Type := Type::Item;
                   END;

    OnDeleteRecord=VAR
                     ReserveSalesLine@1000 : Codeunit 99000832;
                   BEGIN
                     IF (Quantity <> 0) AND ItemExists("No.") THEN BEGIN
                       COMMIT;
                       IF NOT ReserveSalesLine.DeleteLineConfirm(Rec) THEN
                         EXIT(FALSE);
                       ReserveSalesLine.DeleteLine(Rec);
                     END;
                   END;

    OnAfterGetCurrRecord=BEGIN
                           CalculateTotals;
                           SetLocationCodeMandatory;
                           UpdateEditableOnRow;
                         END;

    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1907935204;1 ;ActionGroup;
                      CaptionML=[ENU=&Line;
                                 NOR=&Linje];
                      Image=Line }
      { 1906587504;2 ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 NOR=F&unksjoner];
                      Image=Action }
      { 1905623604;3 ;Action    ;
                      Name=GetPrice;
                      AccessByPermission=TableData 7002=R;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Get Price;
                                 NOR=Hent pris];
                      Image=Price;
                      OnAction=BEGIN
                                 ShowPrices;
                               END;
                                }
      { 1901770504;3 ;Action    ;
                      AccessByPermission=TableData 7004=R;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Get Li&ne Discount;
                                 NOR=Hent li&njerabatt];
                      Image=LineDiscount;
                      OnAction=BEGIN
                                 ShowLineDisc
                               END;
                                }
      { 1901741804;3 ;Action    ;
                      Name=ExplodeBOM_Functions;
                      AccessByPermission=TableData 90=R;
                      CaptionML=[ENU=E&xplode BOM;
                                 NOR=U&tfold stykkliste];
                      Image=ExplodeBOM;
                      OnAction=BEGIN
                                 ExplodeBOM;
                               END;
                                }
      { 1903099004;3 ;Action    ;
                      Name=Insert Ext. Texts;
                      AccessByPermission=TableData 279=R;
                      CaptionML=[ENU=Insert &Ext. Texts;
                                 NOR=Sett inn &utv. tekster];
                      ToolTipML=[ENU=Insert the extended item description that is set up for the item on the sales document line.;
                                 NOR=Sett inn den utvidede varebeskrivelsen som er definert for varen p† salgsdokumentlinjen.];
                      ApplicationArea=#Basic,#Suite;
                      Image=Text;
                      OnAction=BEGIN
                                 InsertExtendedText(TRUE);
                               END;
                                }
      { 1905427504;3 ;Action    ;
                      Name=Reserve;
                      Ellipsis=Yes;
                      CaptionML=[ENU=&Reserve;
                                 NOR=Re&server];
                      Image=Reserve;
                      OnAction=BEGIN
                                 FIND;
                                 ShowReservation;
                               END;
                                }
      { 1903502504;3 ;Action    ;
                      Name=OrderTracking;
                      CaptionML=[ENU=Order &Tracking;
                                 NOR=&Ordresporing];
                      Image=OrderTracking;
                      OnAction=BEGIN
                                 ShowTracking;
                               END;
                                }
      { 1905968604;3 ;Action    ;
                      AccessByPermission=TableData 5718=R;
                      CaptionML=[ENU=Nonstoc&k Items;
                                 NOR=&Katalogvarer];
                      ApplicationArea=#Basic,#Suite;
                      Image=NonStockItem;
                      OnAction=BEGIN
                                 ShowNonstockItems;
                               END;
                                }
      { 1900580804;2 ;ActionGroup;
                      CaptionML=[ENU=Item Availability by;
                                 NOR=Varetilgjengelighet per];
                      Image=ItemAvailability }
      { 5       ;3   ;Action    ;
                      Name=<Action3>;
                      CaptionML=[ENU=Event;
                                 NOR=Hendelse];
                      Image=Event;
                      OnAction=BEGIN
                                 ItemAvailFormsMgt.ShowItemAvailFromSalesLine(Rec,ItemAvailFormsMgt.ByEvent)
                               END;
                                }
      { 1904522204;3 ;Action    ;
                      CaptionML=[ENU=Period;
                                 NOR=Periode];
                      Image=Period;
                      OnAction=BEGIN
                                 ItemAvailFormsMgt.ShowItemAvailFromSalesLine(Rec,ItemAvailFormsMgt.ByPeriod)
                               END;
                                }
      { 1902056104;3 ;Action    ;
                      CaptionML=[ENU=Variant;
                                 NOR=Variant];
                      Image=ItemVariant;
                      OnAction=BEGIN
                                 ItemAvailFormsMgt.ShowItemAvailFromSalesLine(Rec,ItemAvailFormsMgt.ByVariant)
                               END;
                                }
      { 1900639404;3 ;Action    ;
                      AccessByPermission=TableData 14=R;
                      CaptionML=[ENU=Location;
                                 NOR=Lokasjon];
                      Image=Warehouse;
                      OnAction=BEGIN
                                 ItemAvailFormsMgt.ShowItemAvailFromSalesLine(Rec,ItemAvailFormsMgt.ByLocation)
                               END;
                                }
      { 15      ;3   ;Action    ;
                      CaptionML=[ENU=BOM Level;
                                 NOR=Stykklisteniv†];
                      Image=BOMLevel;
                      OnAction=BEGIN
                                 ItemAvailFormsMgt.ShowItemAvailFromSalesLine(Rec,ItemAvailFormsMgt.ByBOM)
                               END;
                                }
      { 33      ;2   ;ActionGroup;
                      CaptionML=[ENU=Related Information;
                                 NOR=Relatert informasjon] }
      { 1900186704;3 ;Action    ;
                      AccessByPermission=TableData 27=R;
                      CaptionML=[ENU=Reservation Entries;
                                 NOR=Reservasjonsposter];
                      Image=ReservationLedger;
                      OnAction=BEGIN
                                 ShowReservationEntries(TRUE);
                               END;
                                }
      { 1905987604;3 ;Action    ;
                      Name=ItemTrackingLines;
                      ShortCutKey=Shift+Ctrl+I;
                      CaptionML=[ENU=Item &Tracking Lines;
                                 NOR=Vare&sporingslinjer];
                      Image=ItemTrackingLines;
                      OnAction=BEGIN
                                 OpenItemTrackingLines;
                               END;
                                }
      { 1901633104;3 ;Action    ;
                      AccessByPermission=TableData 5715=R;
                      CaptionML=[ENU=Select Item Substitution;
                                 NOR=Velg vareerstatning];
                      ToolTipML=[ENU=Select another item that has been set up to be sold instead of the original item if it is unavailable.;
                                 NOR=Velg en annen vare som har blitt definert til † bli solgt i stedet for den opprinnelige varen, hvis den er utilgjengelig.];
                      ApplicationArea=#Suite;
                      Image=SelectItemSubstitution;
                      OnAction=BEGIN
                                 ShowItemSub;
                               END;
                                }
      { 1902085804;3 ;Action    ;
                      Name=Dimensions;
                      AccessByPermission=TableData 348=R;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 NOR=Dimensjoner];
                      Image=Dimensions;
                      OnAction=BEGIN
                                 ShowDimensions;
                               END;
                                }
      { 1903418704;3 ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 NOR=&Merknader];
                      Image=ViewComments;
                      OnAction=BEGIN
                                 ShowLineComments;
                               END;
                                }
      { 1907184504;3 ;Action    ;
                      AccessByPermission=TableData 5800=R;
                      CaptionML=[ENU=Item Charge &Assignment;
                                 NOR=V&aregebyrtilordning];
                      Image=ItemCosts;
                      OnAction=BEGIN
                                 ItemChargeAssgnt;
                               END;
                                }
      { 1905403704;3 ;Action    ;
                      Name=OrderPromising;
                      AccessByPermission=TableData 99000880=R;
                      CaptionML=[ENU=Order &Promising;
                                 NOR=Ordr&ebekreftelse];
                      Image=OrderPromising;
                      OnAction=BEGIN
                                 OrderPromisingLine;
                               END;
                                }
      { 7       ;3   ;ActionGroup;
                      CaptionML=[ENU=Assemble to Order;
                                 NOR=Monter til ordre];
                      ActionContainerType=NewDocumentItems;
                      Image=AssemblyBOM }
      { 9       ;4   ;Action    ;
                      Name=AssembleToOrderLines;
                      AccessByPermission=TableData 90=R;
                      CaptionML=[ENU=Assemble-to-Order Lines;
                                 NOR=Montere til ordre - linjer];
                      OnAction=BEGIN
                                 ShowAsmToOrderLines;
                               END;
                                }
      { 11      ;4   ;Action    ;
                      AccessByPermission=TableData 90=R;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Roll Up &Price;
                                 NOR=Oppruller &pris];
                      OnAction=BEGIN
                                 RollupAsmPrice;
                               END;
                                }
      { 13      ;4   ;Action    ;
                      AccessByPermission=TableData 90=R;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Roll Up &Cost;
                                 NOR=Oppruller &kost];
                      OnAction=BEGIN
                                 RollUpAsmCost;
                               END;
                                }
      { 31      ;3   ;Action    ;
                      Name=DeferralSchedule;
                      CaptionML=[ENU=Deferral Schedule;
                                 NOR=Tidsplan for periodisering];
                      ToolTipML=[ENU=View or edit the deferral schedule that governs how revenue made with this sales document is deferred to different accounting periods when the document is posted.;
                                 NOR=Vis eller rediger tidsplanen for periodisering som styrer hvordan inntekter fra dette salgsdokumentet periodiseres til ulike regnskapsperioder n†r dokumentet bokf›res.];
                      ApplicationArea=#Suite;
                      Enabled="Deferral Code" <> '';
                      Image=PaymentPeriod;
                      OnAction=BEGIN
                                 SalesHeader.GET("Document Type","Document No.");
                                 ShowDeferrals(SalesHeader."Posting Date",SalesHeader."Currency Code");
                               END;
                                }
      { 1905926804;1 ;ActionGroup;
                      CaptionML=[ENU=O&rder;
                                 NOR=&Ordre];
                      Image=Order }
      { 1903645604;2 ;ActionGroup;
                      CaptionML=[ENU=Dr&op Shipment;
                                 NOR=Dire&kte levering];
                      Image=Delivery }
      { 1907981104;3 ;Action    ;
                      AccessByPermission=TableData 120=R;
                      CaptionML=[ENU=Purchase &Order;
                                 NOR=&Bestilling];
                      ToolTipML=[ENU=View the purchase order that is linked to the sales order, for drop shipment.;
                                 NOR=Vis bestillingen som er knyttet til ordren, for direktelevering.];
                      ApplicationArea=#Suite;
                      Image=Document;
                      OnAction=BEGIN
                                 OpenPurchOrderForm;
                               END;
                                }
      { 1903587004;2 ;ActionGroup;
                      CaptionML=[ENU=Speci&al Order;
                                 NOR=Spesi&albestilling];
                      Image=SpecialOrder }
      { 1903192904;3 ;Action    ;
                      Name=OpenSpecialPurchaseOrder;
                      AccessByPermission=TableData 120=R;
                      CaptionML=[ENU=Purchase &Order;
                                 NOR=&Bestilling];
                      Image=Document;
                      OnAction=BEGIN
                                 OpenSpecialPurchOrderForm;
                               END;
                                }
      { 666     ;2   ;Action    ;
                      Name=BlanketOrder;
                      CaptionML=[ENU=Blanket Order;
                                 NOR=Rammebestilling];
                      ToolTipML=[ENU=View the blanket sales order.;
                                 NOR=Vis rammeordren.];
                      Image=BlanketOrder;
                      OnAction=VAR
                                 SalesHeader@1000 : Record 36;
                                 BlanketSalesOrder@1001 : Page 507;
                               BEGIN
                                 TESTFIELD("Blanket Order No.");
                                 SalesHeader.SETRANGE("No.","Blanket Order No.");
                                 IF NOT SalesHeader.ISEMPTY THEN BEGIN
                                   BlanketSalesOrder.SETTABLEVIEW(SalesHeader);
                                   BlanketSalesOrder.EDITABLE := FALSE;
                                   BlanketSalesOrder.RUN;
                                 END;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the type of entity that will be posted for this sales line, such as Item, Resource, or G/L Account.;
                           NOR=Angir enhetstypen som skal bokf›res for denne salgslinjen, for eksempel vare, ressurs eller finanskonto.];
                SourceExpr=Type;
                OnValidate=BEGIN
                             NoOnAfterValidate;
                             SetLocationCodeMandatory;

                             IF xRec."No." <> '' THEN
                               RedistributeTotalsOnAfterValidate;
                           END;
                            }

    { 4   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of a general ledger account, item, resource, additional cost, or fixed asset, depending on the contents of the Type field.;
                           NOR=Angir nummeret til en finanskonto, en vare, en ressurs, en tilleggskostnad eller aktiva, avhengig av innholdet i feltet Type.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="No.";
                OnValidate=BEGIN
                             NoOnAfterValidate;
                             UpdateEditableOnRow;
                             ShowShortcutDimCode(ShortcutDimCode);

                             QuantityOnAfterValidate;
                             IF xRec."No." <> '' THEN
                               RedistributeTotalsOnAfterValidate;
                           END;
                            }

    { 1101103002;2;Field  ;
                SourceExpr=Bold }

    { 1101103003;2;Field  ;
                SourceExpr="Shelf No." }

    { 68  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the cross-referenced item number. If you enter a cross reference between yours and your vendor's or customer's item number, then this number will override the standard item number when you enter the cross-reference number on a sales or purchase document.;
                           NOR=Angir varens kryssreferansenummer. Hvis du oppgir en kryssreferanse mellom ditt og leverand›rens eller kundens varenummer, vil dette nummeret overstyre standardvarenummeret n†r du oppgir kryssreferansenummeret i et salgs- eller kj›psdokument.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Cross-Reference No.";
                Visible=FALSE;
                OnValidate=BEGIN
                             NoOnAfterValidate;
                           END;

                OnLookup=BEGIN
                           CrossReferenceNoLookUp;
                           NoOnAfterValidate;
                         END;
                          }

    { 1136;2   ;Field     ;
                ToolTipML=[ENU=Specifies the IC partner code of the partner to whom you want to distribute the revenue of the sales line.;
                           NOR=Angi KI-partnerkoden for partneren som du vil distribuere inntektene for salgslinjen til.];
                SourceExpr="IC Partner Code";
                Visible=FALSE }

    { 130 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the item or account in your IC partner's company that corresponds to the item or account on the line.;
                           NOR=Angir varen eller kontoen i KI-partnerselskapet som tilsvarer varen eller kontoen p† linjen.];
                SourceExpr="IC Partner Ref. Type";
                Visible=FALSE }

    { 132 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the item or account in your IC partner's company that corresponds to the item or account on the line.;
                           NOR=Angir varen eller kontoen i KI-partnerselskapet som tilsvarer varen eller kontoen p† linjen.];
                SourceExpr="IC Partner Reference";
                Visible=FALSE }

    { 30  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a variant code for the item.;
                           NOR=Angir en variantkode for varen.];
                SourceExpr="Variant Code";
                Visible=FALSE;
                OnValidate=BEGIN
                             VariantCodeOnAfterValidate;
                           END;
                            }

    { 104 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies that a substitute is available for the item on the sales line.;
                           NOR=Angir at en erstatning er tilgjengelig for varen p† salgslinjen.];
                ApplicationArea=#Suite;
                SourceExpr="Substitution Available";
                Visible=FALSE }

    { 1101103004;2;Field  ;
                SourceExpr="Description 2" }

    { 74  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the purchasing code for the item.;
                           NOR=Angir kj›pskoden for varen.];
                SourceExpr="Purchasing Code" }

    { 70  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies that this item is a nonstock item.;
                           NOR=Angir at denne varen er en katalogvare.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Nonstock;
                Visible=FALSE }

    { 78  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for the VAT product posting group of the item, resource, or general ledger account on this line.;
                           NOR=Angir koden for mva.-varebokf›ringsgruppen som gjelder for varen, ressursen eller finanskontoen p† linjen.];
                SourceExpr="VAT Prod. Posting Group";
                Visible=FALSE;
                OnValidate=BEGIN
                             RedistributeTotalsOnAfterValidate;
                           END;
                            }

    { 6   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a description of the entry, which is based on the contents of the Type and No. fields.;
                           NOR=Angir en beskrivelse av posten, som er basert p† innholdet i feltene Type og Nr.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Description;
                OnValidate=BEGIN
                             UpdateEditableOnRow;

                             IF "No." = xRec."No." THEN
                               EXIT;

                             NoOnAfterValidate;
                             ShowShortcutDimCode(ShortcutDimCode);
                             IF xRec."No." <> '' THEN
                               RedistributeTotalsOnAfterValidate;
                           END;

                ShowMandatory=TRUE;
                QuickEntry=FALSE }

    { 26  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies if your vendor will ship the items on the line directly to your customer.;
                           NOR=Angir om varene p† linjen skal leveres direkte fra leverand›ren til kunden.];
                ApplicationArea=#Suite;
                SourceExpr="Drop Shipment";
                Visible=FALSE }

    { 106 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies that the item on the sales line is a special-order item.;
                           NOR=Angir at varen p† salgslinjen er en vare som m† spesialbestilles.];
                SourceExpr="Special Order";
                Visible=FALSE }

    { 110 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a code that explains why the item is returned.;
                           NOR=Angir en kode som forklarer hvorfor varen ble returnert.];
                SourceExpr="Return Reason Code";
                Visible=FALSE }

    { 42  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the inventory location from which the items sold should be picked and where the inventory decrease is registered.;
                           NOR=Angir lagerlokasjonen som de solgte varene skal plukkes fra, og hvor lagerreduksjonen registreres.];
                SourceExpr="Location Code";
                Visible=LocationCodeVisible;
                OnValidate=BEGIN
                             LocationCodeOnAfterValidate;
                           END;

                ShowMandatory=LocationCodeMandatory;
                QuickEntry=FALSE }

    { 114 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the bin from where items on the sales order line are taken from when they are shipped.;
                           NOR=Angir hvilken hylle varene p† salgsordrelinjen skal hentes fra n†r de leveres.];
                SourceExpr="Bin Code";
                Visible=FALSE }

    { 50  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies whether a reservation can be made for items on this line.;
                           NOR=Angir om en reservasjon kan gj›res for varene p† denne linjen.];
                SourceExpr=Reserve;
                Visible=FALSE;
                OnValidate=BEGIN
                             ReserveOnAfterValidate;
                           END;
                            }

    { 8   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies how many units are being sold.;
                           NOR=Angir hvor mange enheter som selges.];
                ApplicationArea=#Basic,#Suite;
                BlankZero=Yes;
                SourceExpr=Quantity;
                Enabled=RowIsNotText;
                Editable=RowIsNotText;
                OnValidate=BEGIN
                             QuantityOnAfterValidate;
                             RedistributeTotalsOnAfterValidate;
                           END;

                ShowMandatory="No." <> '' }

    { 3   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies how many units of the sales line quantity that you want to supply by assembly.;
                           NOR=Angir hvor mange enheter av salgslinjeantallet som du vil forsyne gjennom montering.];
                BlankZero=Yes;
                SourceExpr="Qty. to Assemble to Order";
                Visible=FALSE;
                OnValidate=BEGIN
                             QtyToAsmToOrderOnAfterValidate;
                           END;

                OnDrillDown=BEGIN
                              ShowAsmToOrderLines;
                            END;
                             }

    { 48  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies how many units of the item on the line have been reserved.;
                           NOR=Angir hvor mange enheter av varen som er reservert p† linjen.];
                BlankZero=Yes;
                SourceExpr="Reserved Quantity";
                QuickEntry=FALSE }

    { 44  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the unit of measure that is used to determine the value in the Unit Price field on the sales line.;
                           NOR=Angir enheten som brukes til † fastsl† verdien i feltet Salgspris p† salgslinjen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Unit of Measure Code";
                Enabled=UnitofMeasureCodeIsChangeable;
                Editable=UnitofMeasureCodeIsChangeable;
                OnValidate=BEGIN
                             UnitofMeasureCodeOnAfterValida;
                             RedistributeTotalsOnAfterValidate;
                           END;

                QuickEntry=FALSE }

    { 10  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the unit of measure for the item or resource on the sales line.;
                           NOR=Angir enheten for varen eller ressursen p† salgslinjen.];
                SourceExpr="Unit of Measure";
                Visible=FALSE }

    { 38  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the unit cost of the item on the line.;
                           NOR=Angir enhetskosten for varen p† linjen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Unit Cost (LCY)";
                Visible=FALSE }

    { 112 ;2   ;Field     ;
                Name=SalesPriceExist;
                CaptionML=[ENU=Sales Price Exists;
                           NOR=Salgspris finnes];
                ToolTipML=[ENU=Specifies that there is a specific price for this customer.;
                           NOR=Angir at det finnes en bestemt pris for denne kunden.];
                SourceExpr=PriceExists;
                Visible=FALSE;
                Editable=FALSE }

    { 12  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the price for one unit on the sales line.;
                           NOR=Angir salgsprisen for ‚n enhet p† salgslinjen.];
                ApplicationArea=#Basic,#Suite;
                BlankZero=Yes;
                SourceExpr="Unit Price";
                Enabled=RowIsNotText;
                Editable=RowIsNotText;
                OnValidate=BEGIN
                             RedistributeTotalsOnAfterValidate;
                           END;

                ShowMandatory="No." <> '' }

    { 76  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the net amount (before subtracting the invoice discount amount) that must be paid for the items on the line.;
                           NOR=Angir nettobel›pet (f›r fakturarabattbel›pet trekkes fra) som skal betales for varene p† linjen.];
                ApplicationArea=#Basic,#Suite;
                BlankZero=Yes;
                SourceExpr="Line Amount";
                Enabled=RowIsNotText;
                Editable=RowIsNotText;
                OnValidate=BEGIN
                             RedistributeTotalsOnAfterValidate;
                           END;
                            }

    { 116 ;2   ;Field     ;
                Name=SalesLineDiscExists;
                CaptionML=[ENU=Sales Line Disc. Exists;
                           NOR=Salgslinjerab. finnes];
                ToolTipML=[ENU=Specifies that there is a specific discount for this customer.;
                           NOR=Angir at det finnes en bestemt rabatt for denne kunden.];
                SourceExpr=LineDiscExists;
                Visible=FALSE;
                Editable=FALSE }

    { 16  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the line discount percentage that is valid for the item quantity on the line.;
                           NOR=Angir linjerabattprosenten som blir gitt for vareantallet p† linjen.];
                ApplicationArea=#Basic,#Suite;
                BlankZero=Yes;
                SourceExpr="Line Discount %";
                Enabled=RowIsNotText;
                Editable=RowIsNotText;
                OnValidate=BEGIN
                             RedistributeTotalsOnAfterValidate;
                           END;
                            }

    { 52  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the amount of the discount that will be given on the invoice line.;
                           NOR=Angir rabattbel›pet som gis p† fakturalinjen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Line Discount Amount";
                Visible=FALSE;
                OnValidate=BEGIN
                             RedistributeTotalsOnAfterValidate;
                           END;
                            }

    { 136 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the prepayment percentage if a prepayment should apply to the sales line.;
                           NOR=Angir forskuddsprosenten hvis et forskudd skal gjelde for salgslinjen.];
                SourceExpr="Prepayment %";
                Visible=FALSE;
                OnValidate=BEGIN
                             RedistributeTotalsOnAfterValidate;
                           END;
                            }

    { 138 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the prepayment amount of the line in the currency of the sales document if a prepayment percentage is specified for the sales line.;
                           NOR=Angir forskuddsbel›pet for linjen i valutaen som gjelder for salgsdokumentet hvis det er angitt en forskuddsprosent for salgslinjen.];
                SourceExpr="Prepmt. Line Amount";
                Visible=FALSE;
                OnValidate=BEGIN
                             RedistributeTotalsOnAfterValidate;
                           END;
                            }

    { 140 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the prepayment amount that has already been invoiced to the customer for this sales line.;
                           NOR=Angir forskuddsbel›pet som allerede er fakturert til kunden for denne salgslinjen.];
                SourceExpr="Prepmt. Amt. Inv.";
                Visible=FALSE;
                OnValidate=BEGIN
                             RedistributeTotalsOnAfterValidate;
                           END;
                            }

    { 54  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies whether the invoice line is included when the invoice discount is calculated.;
                           NOR=Angir om fakturalinjen er inkludert n†r fakturarabatten beregnes.];
                SourceExpr="Allow Invoice Disc.";
                Visible=FALSE }

    { 90  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the invoice discount amount for the line.;
                           NOR=Angir fakturarabattbel›pet for linjen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Inv. Discount Amount";
                Visible=FALSE }

    { 18  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies how many units of the item are to be shipped when the sales order is posted.;
                           NOR=Angir hvor mange enheter av varen som skal leveres n†r ordren bokf›res.];
                ApplicationArea=#Basic,#Suite;
                BlankZero=Yes;
                SourceExpr="Qty. to Ship";
                OnValidate=BEGIN
                             IF "Qty. to Asm. to Order (Base)" <> 0 THEN BEGIN
                               CurrPage.SAVERECORD;
                               CurrPage.UPDATE(FALSE);
                             END;
                           END;
                            }

    { 20  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of units of the ordered item that have been shipped.;
                           NOR=Angir hvor mange enheter av den bestilte varen som er levert.];
                ApplicationArea=#Basic,#Suite;
                BlankZero=Yes;
                SourceExpr="Quantity Shipped";
                QuickEntry=FALSE }

    { 22  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies how much of the line should be invoiced.;
                           NOR=Angir hvor mye av linjen som skal faktureres.];
                ApplicationArea=#Basic,#Suite;
                BlankZero=Yes;
                SourceExpr="Qty. to Invoice" }

    { 24  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies how many units of the item on the line have already been invoiced.;
                           NOR=Angir hvor mange enheter av varen som allerede er fakturert p† linjen.];
                ApplicationArea=#Basic,#Suite;
                BlankZero=Yes;
                SourceExpr="Quantity Invoiced" }

    { 142 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the prepayment amount that will be deducted from the next ordinary invoice for this line.;
                           NOR=Angir forskuddsbel›pet som blir trukket fra den neste ordin‘re fakturaen for denne linjen.];
                SourceExpr="Prepmt Amt to Deduct";
                Visible=FALSE }

    { 144 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the prepayment amount that has already been deducted from ordinary invoices posted for this sales order line.;
                           NOR=Angir forskuddsbel›pet som allerede er trukket fra ordin‘re fakturaer som er bokf›rt for denne ordrelinjen.];
                SourceExpr="Prepmt Amt Deducted";
                Visible=FALSE }

    { 46  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies that you can assign item charges to this line.;
                           NOR=Angir at du kan tilordne varegebyr til denne linjen.];
                SourceExpr="Allow Item Charge Assignment";
                Visible=FALSE }

    { 5800;2   ;Field     ;
                ToolTipML=[ENU=Specifies the quantity of the item charge that will be assigned to a specified item when you post this sales line. You fill this field through the Qty. to Assign field in the Item Charge Assignment (Sales) window that you open with the Item Charge Assignment action on the Lines FastTab.;
                           NOR=Angir antallet for varegebyret som blir tilordnet til en angitt vare n†r du bokf›rer denne salgslinjen. Du fyller ut dette feltet via feltet Ant. som skal tilordnes i vinduet Varegebyrtilordning (salg), som du †pner med handlingen Varegebyrtilordning i hurtigfanen Linjer.];
                BlankZero=Yes;
                SourceExpr="Qty. to Assign";
                OnDrillDown=BEGIN
                              CurrPage.SAVERECORD;
                              ShowItemChargeAssgnt;
                              UpdateForm(FALSE);
                            END;

                QuickEntry=FALSE }

    { 102 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the quantity of the item charge that was assigned to a specified item when you posted this sales line.;
                           NOR=Angir antallet av varegebyret som ble tilordnet til en bestemt vare da du bokf›rte salgslinjen.];
                BlankZero=Yes;
                SourceExpr="Qty. Assigned";
                OnDrillDown=BEGIN
                              CurrPage.SAVERECORD;
                              ShowItemChargeAssgnt;
                              CurrPage.UPDATE(FALSE);
                            END;

                QuickEntry=FALSE }

    { 82  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date that the customer has asked for the order to be delivered.;
                           NOR=Angir p† hvilken dato kunden har bedt om at ordren skal leveres.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Requested Delivery Date";
                Visible=FALSE;
                OnValidate=BEGIN
                             UpdateForm(TRUE);
                           END;
                            }

    { 84  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date that you have promised to deliver the order, as a result of the Order Promising function.;
                           NOR=Angir datoen da du har lovet † levere ordren som et resultat av funksjonen Ordrebekreftelse.];
                SourceExpr="Promised Delivery Date";
                Visible=FALSE;
                OnValidate=BEGIN
                             UpdateForm(TRUE);
                           END;
                            }

    { 86  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the planned date that the shipment will be delivered at the customer's address.;
                           NOR=Angir planlagt dato for n†r leveringen skal leveres til kundens adresse.];
                SourceExpr="Planned Delivery Date";
                OnValidate=BEGIN
                             UpdateForm(TRUE);
                           END;

                QuickEntry=FALSE }

    { 88  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date that the shipment should ship from the warehouse.;
                           NOR=Angir datoen for n†r leveringen skal sendes fra lageret.];
                SourceExpr="Planned Shipment Date";
                OnValidate=BEGIN
                             UpdateForm(TRUE);
                           END;
                            }

    { 100 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date that the items on the line are in inventory and available to be picked.;
                           NOR=Angir datoen for n†r varene p† linjen finnes p† lager og er tilgjengelig for plukking.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Shipment Date";
                OnValidate=BEGIN
                             ShipmentDateOnAfterValidate;
                           END;

                QuickEntry=FALSE }

    { 92  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code that represents the shipping agent.;
                           NOR=Angir koden som representerer transport›ren.];
                ApplicationArea=#Suite;
                SourceExpr="Shipping Agent Code";
                Visible=FALSE }

    { 94  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code that represents a shipping agent service.;
                           NOR=Angir koden som representerer en transport›rtjeneste.];
                ApplicationArea=#Suite;
                SourceExpr="Shipping Agent Service Code";
                Visible=FALSE }

    { 96  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies how long it takes from when the sales order line is shipped from the warehouse to when the order is delivered.;
                           NOR=Angir hvor lang tid det tar fra ordren leveres fra lageret til ordrelinjen er levert til kundens adresse.];
                SourceExpr="Shipping Time";
                Visible=FALSE }

    { 134 ;2   ;Field     ;
                ToolTipML=[ENU=Belongs to the Job application area.;
                           NOR=H›rer til modulen Prosjekt.];
                SourceExpr="Work Type Code";
                Visible=FALSE }

    { 17  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies how many units on the sales order line remain to be handled in warehouse documents.;
                           NOR=Angir hvor mange enheter p† ordrelinjen som fremdeles m† h†ndteres i lagerdokumenter.];
                SourceExpr="Whse. Outstanding Qty.";
                Visible=FALSE }

    { 58  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies how many units on the sales order line remain to be handled in warehouse documents.;
                           NOR=Angir hvor mange enheter p† ordrelinjen som fremdeles m† h†ndteres i lagerdokumenter.];
                SourceExpr="Whse. Outstanding Qty. (Base)";
                Visible=FALSE }

    { 19  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies how many assemble-to-order units on the sales order line need to be assembled and handled in warehouse documents.;
                           NOR=Angir hvor mange monter-til-ordre-enheter p† salgsordrelinjen som m† monteres og h†ndteres i lagerdokumenter.];
                SourceExpr="ATO Whse. Outstanding Qty.";
                Visible=FALSE }

    { 21  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies how many assemble-to-order units on the sales order line remain to be assembled and handled in warehouse documents.;
                           NOR=Angir hvor mange monter-til-ordre-enheter p† ordrelinjen som m† monteres og h†ndteres i lagerdokumenter.];
                SourceExpr="ATO Whse. Outstd. Qty. (Base)";
                Visible=FALSE }

    { 98  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the outbound warehouse handling time.;
                           NOR=Angir utg†ende lagerbehandlingstid.];
                SourceExpr="Outbound Whse. Handling Time";
                Visible=FALSE }

    { 62  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the document number of the blanket order from which this sales line originates.;
                           NOR=Angir dokumentnummeret til rammeordren som denne ordrelinjen stammer fra.];
                SourceExpr="Blanket Order No.";
                Visible=FALSE }

    { 66  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the line number of the blanket order line from which this sales line originates.;
                           NOR=Angir linjenummeret til rammebestillingslinjen som denne salgslinjen stammer fra.];
                SourceExpr="Blanket Order Line No.";
                Visible=FALSE }

    { 14  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date that will be used as the FA posting date on FA ledger entries.;
                           NOR=Angir datoen som skal brukes som aktivabokf›ringsdatoen i aktivaposter.];
                SourceExpr="FA Posting Date";
                Visible=FALSE }

    { 40  ;2   ;Field     ;
                ToolTipML=[ENU=You can use this field if you have selected Fixed Asset in the Type field for this line.;
                           NOR=Du kan bruke dette feltet hvis du har valgt Aktiva i feltet Type for denne linjen.];
                SourceExpr="Depr. until FA Posting Date";
                Visible=FALSE }

    { 36  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for the depreciation book to which the line will be posted if you have selected Fixed Asset in the Type field for this line.;
                           NOR=Angir koden for avskrivningstabl†et som linjen skal bokf›res i hvis du har valgt Aktiva i feltet Type for denne linjen.];
                SourceExpr="Depreciation Book Code";
                Visible=FALSE }

    { 80  ;2   ;Field     ;
                ToolTipML=[ENU=You can use this field if you have selected Fixed Asset in the Type field for this line.;
                           NOR=Du kan bruke dette feltet hvis du har valgt Aktiva i feltet Type for denne linjen.];
                SourceExpr="Use Duplication List";
                Visible=FALSE }

    { 56  ;2   ;Field     ;
                ToolTipML=[ENU=You can use this field if you have selected Fixed Asset in the Type field for this line.;
                           NOR=Du kan bruke dette feltet hvis du har valgt Aktiva i feltet Type for denne linjen.];
                SourceExpr="Duplicate in Depreciation Book";
                Visible=FALSE }

    { 108 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the item ledger entry that the sales credit memo line is applied from.;
                           NOR=Angir nummeret p† vareposten som salgskreditnotalinjen er utlignet fra.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Appl.-from Item Entry";
                Visible=FALSE }

    { 60  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the item ledger entry number the line should be applied to.;
                           NOR=Angir varepostnummeret som linjen skal utlignes mot.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Appl.-to Item Entry";
                Visible=FALSE }

    { 29  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the deferral template that governs how revenue earned with this sales document is deferred to the different accounting periods when the good or service was delivered.;
                           NOR=Angir periodiseringsmalen som styrer hvordan inntekter fra dette salgsdokumentet periodiseres til de ulike regnskapsperiodene n†r varen eller servicen ble levert.];
                ApplicationArea=#Suite;
                SourceExpr="Deferral Code";
                TableRelation="Deferral Template"."Deferral Code";
                Visible=FALSE;
                Enabled=(Type <> Type::"Fixed Asset") AND (Type <> Type::" ") }

    { 32  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for Shortcut Dimension 1.;
                           NOR=Angir koden for Snarveisdimensjon 1.];
                ApplicationArea=#Suite;
                SourceExpr="Shortcut Dimension 1 Code";
                Visible=FALSE }

    { 34  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for Shortcut Dimension 2.;
                           NOR=Angir koden for Snarveisdimensjon 2.];
                ApplicationArea=#Suite;
                SourceExpr="Shortcut Dimension 2 Code";
                Visible=FALSE }

    { 300 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[3];
                CaptionClass='1,2,3';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(3),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(3,ShortcutDimCode[3]);
                           END;
                            }

    { 302 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[4];
                CaptionClass='1,2,4';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(4),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(4,ShortcutDimCode[4]);
                           END;
                            }

    { 304 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[5];
                CaptionClass='1,2,5';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(5),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateSaveShortcutDimCode(5,ShortcutDimCode[5]);
                           END;
                            }

    { 306 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[6];
                CaptionClass='1,2,6';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(6),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateSaveShortcutDimCode(6,ShortcutDimCode[6]);
                           END;
                            }

    { 308 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[7];
                CaptionClass='1,2,7';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(7),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateSaveShortcutDimCode(7,ShortcutDimCode[7]);
                           END;
                            }

    { 1101103000;2;Field  ;
                SourceExpr="Gross Weight";
                Editable=FALSE }

    { 1101103001;2;Field  ;
                SourceExpr="Unit Volume";
                Editable=FALSE }

    { 310 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[8];
                CaptionClass='1,2,8';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(8),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateSaveShortcutDimCode(8,ShortcutDimCode[8]);
                           END;
                            }

    { 146 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the document number.;
                           NOR=Angir dokumentnummeret.];
                SourceExpr="Document No.";
                Visible=FALSE;
                Editable=FALSE }

    { 148 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the line number.;
                           NOR=Angir linjenummeret.];
                SourceExpr="Line No.";
                Visible=FALSE;
                Editable=FALSE }

    { 1080002;2;Field     ;
                ToolTipML=[ENU=Specifies the account code of the customer.;
                           NOR=Angir kontokoden for kunden.];
                SourceExpr="Account Code";
                Visible=FALSE }

    { 51  ;1   ;Group     ;
                GroupType=Group }

    { 45  ;2   ;Group     ;
                GroupType=Group }

    { 35  ;3   ;Field     ;
                CaptionML=[ENU=Subtotal Excl. VAT;
                           NOR=Delsum ekskl. mva];
                ToolTipML=[ENU=Specifies the sum of the value in the Line Amount Excl. VAT field on all lines in the document.;
                           NOR=Angir summen av verdien i feltet Linjebel›p ekskl. mva p† alle linjer i dokumentet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=TotalSalesLine."Line Amount";
                AutoFormatType=1;
                AutoFormatExpr=Currency.Code;
                CaptionClass=DocumentTotals.GetTotalLineAmountWithVATAndCurrencyCaption(Currency.Code,TotalSalesHeader."Prices Including VAT");
                Editable=FALSE }

    { 43  ;3   ;Field     ;
                Name=Invoice Discount Amount;
                CaptionML=[ENU=Invoice Discount Amount;
                           NOR=Fakturarabattbel›p];
                ToolTipML=[ENU=Specifies a discount amount that is deducted from the value in the Total Incl. VAT field. You can enter or change the amount manually.;
                           NOR=Angir et rabattbel›p som blir trukket fra verdien i feltet Totalt inkl. mva. Du kan oppgi eller endre bel›pet manuelt.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=InvoiceDiscountAmount;
                AutoFormatType=1;
                AutoFormatExpr=Currency.Code;
                CaptionClass=DocumentTotals.GetInvoiceDiscAmountWithVATAndCurrencyCaption(FIELDCAPTION("Inv. Discount Amount"),Currency.Code);
                Editable=InvDiscAmountEditable;
                OnValidate=BEGIN
                             ValidateInvoiceDiscountAmount;
                           END;
                            }

    { 41  ;3   ;Field     ;
                Name=Invoice Disc. Pct.;
                CaptionML=[ENU=Invoice Discount %;
                           NOR=Fakturarabatt %];
                ToolTipML=[ENU=Specifies a discount percentage that is granted if criteria that you have set up for the customer are met.;
                           NOR=Angir en rabattprosent som gis hvis kriteriene du har definert for kunden, oppfylles.];
                ApplicationArea=#Basic,#Suite;
                DecimalPlaces=0:2;
                SourceExpr=InvoiceDiscountPct;
                Editable=InvDiscAmountEditable;
                OnValidate=BEGIN
                             InvoiceDiscountAmount := ROUND(TotalSalesLine."Line Amount" * InvoiceDiscountPct / 100,Currency."Amount Rounding Precision");
                             ValidateInvoiceDiscountAmount;
                           END;
                            }

    { 28  ;2   ;Group     ;
                GroupType=Group }

    { 27  ;3   ;Field     ;
                Name=Total Amount Excl. VAT;
                DrillDown=No;
                CaptionML=[ENU=Total Amount Excl. VAT;
                           NOR=Totalbel›p ekskl. mva];
                ToolTipML=[ENU=Specifies the sum of the value in the Line Amount Excl. VAT field on all lines in the document minus any discount amount in the Invoice Discount Amount field.;
                           NOR=Angir summen av verdien i feltet Linjebel›p ekskl. MVA p† alle linjer i dokumentet, minus eventuelle rabattbel›p i feltet Fakturarabattbel›p.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=TotalSalesLine.Amount;
                AutoFormatType=1;
                AutoFormatExpr=Currency.Code;
                CaptionClass=DocumentTotals.GetTotalExclVATCaption(Currency.Code);
                Editable=FALSE }

    { 25  ;3   ;Field     ;
                Name=Total VAT Amount;
                CaptionML=[ENU=Total VAT;
                           NOR=Total mva];
                ToolTipML=[ENU=Specifies the sum of VAT amounts on all lines in the document.;
                           NOR=Angir summen av mva-bel›pene p† alle linjene i dokumentet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=VATAmount;
                AutoFormatType=1;
                AutoFormatExpr=Currency.Code;
                CaptionClass=DocumentTotals.GetTotalVATCaption(Currency.Code);
                Editable=FALSE }

    { 23  ;3   ;Field     ;
                Name=Total Amount Incl. VAT;
                CaptionML=[ENU=Total Amount Incl. VAT;
                           NOR=Totalbel›p inkl. mva];
                ToolTipML=[ENU=Specifies the sum of the value in the Line Amount Incl. VAT field on all lines in the document minus any discount amount in the Invoice Discount Amount field.;
                           NOR=Angir summen av verdien i feltet Linjebel›p inkl. MVA p† alle linjer i dokumentet, minus eventuelle rabattbel›p i feltet Fakturarabattbel›p.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=TotalSalesLine."Amount Including VAT";
                AutoFormatType=1;
                AutoFormatExpr=Currency.Code;
                CaptionClass=DocumentTotals.GetTotalInclVATCaption(Currency.Code);
                Editable=FALSE }

  }
  CODE
  {
    VAR
      Currency@1021 : Record 4;
      TotalSalesHeader@1016 : Record 36;
      TotalSalesLine@1009 : Record 37;
      SalesHeader@1000 : Record 36;
      ApplicationAreaSetup@1010 : Record 9178;
      SalesSetup@1015 : Record 311;
      SalesPriceCalcMgt@1006 : Codeunit 7000;
      TransferExtendedText@1002 : Codeunit 378;
      ItemAvailFormsMgt@1001 : Codeunit 353;
      SalesCalcDiscountByType@1008 : Codeunit 56;
      DocumentTotals@1007 : Codeunit 57;
      VATAmount@1005 : Decimal;
      ShortcutDimCode@1003 : ARRAY [8] OF Code[20];
      Text001@1004 : TextConst 'ENU=You cannot use the Explode BOM function because a prepayment of the sales order has been invoiced.;NOR=Du kan ikke bruke funksjonen Utfold stykkliste fordi det er fakturert et forskudd p† ordren.';
      LocationCodeMandatory@1017 : Boolean;
      InvDiscAmountEditable@1014 : Boolean;
      RowIsNotText@1019 : Boolean;
      UnitofMeasureCodeIsChangeable@1011 : Boolean;
      LocationCodeVisible@1020 : Boolean;
      InvoiceDiscountAmount@1022 : Decimal;
      InvoiceDiscountPct@1023 : Decimal;

    PROCEDURE ApproveCalcInvDisc@1();
    BEGIN
      CODEUNIT.RUN(CODEUNIT::"Sales-Disc. (Yes/No)",Rec);
    END;

    LOCAL PROCEDURE ValidateInvoiceDiscountAmount@30();
    VAR
      SalesHeader@1000 : Record 36;
    BEGIN
      SalesHeader.GET("Document Type","Document No.");
      SalesCalcDiscountByType.ApplyInvDiscBasedOnAmt(InvoiceDiscountAmount,SalesHeader);
      CurrPage.UPDATE(FALSE);
    END;

    PROCEDURE CalcInvDisc@6();
    BEGIN
      CODEUNIT.RUN(CODEUNIT::"Sales-Calc. Discount",Rec);
    END;

    PROCEDURE ExplodeBOM@3();
    BEGIN
      IF "Prepmt. Amt. Inv." <> 0 THEN
        ERROR(Text001);
      CODEUNIT.RUN(CODEUNIT::"Sales-Explode BOM",Rec);
    END;

    PROCEDURE OpenPurchOrderForm@4();
    VAR
      PurchHeader@1000 : Record 38;
      PurchOrder@1001 : Page 50;
    BEGIN
      TESTFIELD("Purchase Order No.");
      PurchHeader.SETRANGE("No.","Purchase Order No.");
      PurchOrder.SETTABLEVIEW(PurchHeader);
      PurchOrder.EDITABLE := FALSE;
      PurchOrder.RUN;
    END;

    PROCEDURE OpenSpecialPurchOrderForm@14();
    VAR
      PurchHeader@1001 : Record 38;
      PurchRcptHeader@1002 : Record 120;
      PurchOrder@1000 : Page 50;
    BEGIN
      TESTFIELD("Special Order Purchase No.");
      PurchHeader.SETRANGE("No.","Special Order Purchase No.");
      IF NOT PurchHeader.ISEMPTY THEN BEGIN
        PurchOrder.SETTABLEVIEW(PurchHeader);
        PurchOrder.EDITABLE := FALSE;
        PurchOrder.RUN;
      END ELSE BEGIN
        PurchRcptHeader.SETRANGE("Order No.","Special Order Purchase No.");
        IF PurchRcptHeader.COUNT = 1 THEN
          PAGE.RUN(PAGE::"Posted Purchase Receipt",PurchRcptHeader)
        ELSE
          PAGE.RUN(PAGE::"Posted Purchase Receipts",PurchRcptHeader);
      END;
    END;

    PROCEDURE InsertExtendedText@5(Unconditionally@1000 : Boolean);
    BEGIN
      IF TransferExtendedText.SalesCheckIfAnyExtText(Rec,Unconditionally) THEN BEGIN
        CurrPage.SAVERECORD;
        COMMIT;
        TransferExtendedText.InsertSalesExtText(Rec);
      END;
      IF TransferExtendedText.MakeUpdate THEN
        UpdateForm(TRUE);
    END;

    PROCEDURE ShowNonstockItems@11();
    BEGIN
      ShowNonstock;
    END;

    PROCEDURE ShowTracking@13();
    VAR
      TrackingForm@1000 : Page 99000822;
    BEGIN
      TrackingForm.SetSalesLine(Rec);
      TrackingForm.RUNMODAL;
    END;

    PROCEDURE ItemChargeAssgnt@5800();
    BEGIN
      ShowItemChargeAssgnt;
    END;

    PROCEDURE UpdateForm@12(SetSaveRecord@1000 : Boolean);
    BEGIN
      CurrPage.UPDATE(SetSaveRecord);
    END;

    PROCEDURE ShowPrices@15();
    BEGIN
      SalesHeader.GET("Document Type","Document No.");
      CLEAR(SalesPriceCalcMgt);
      SalesPriceCalcMgt.GetSalesLinePrice(SalesHeader,Rec);
    END;

    PROCEDURE ShowLineDisc@16();
    BEGIN
      SalesHeader.GET("Document Type","Document No.");
      CLEAR(SalesPriceCalcMgt);
      SalesPriceCalcMgt.GetSalesLineLineDisc(SalesHeader,Rec);
    END;

    PROCEDURE OrderPromisingLine@17();
    VAR
      OrderPromisingLine@1000 : TEMPORARY Record 99000880;
      OrderPromisingLines@1001 : Page 99000959;
    BEGIN
      OrderPromisingLine.SETRANGE("Source Type","Document Type");
      OrderPromisingLine.SETRANGE("Source ID","Document No.");
      OrderPromisingLine.SETRANGE("Source Line No.","Line No.");

      OrderPromisingLines.SetSourceType(OrderPromisingLine."Source Type"::Sales);
      OrderPromisingLines.SETTABLEVIEW(OrderPromisingLine);
      OrderPromisingLines.RUNMODAL;
    END;

    LOCAL PROCEDURE NoOnAfterValidate@19066594();
    BEGIN
      IF ApplicationAreaSetup.IsFoundationEnabled THEN
        TESTFIELD(Type,Type::Item);

      InsertExtendedText(FALSE);
      IF (Type = Type::"Charge (Item)") AND ("No." <> xRec."No.") AND
         (xRec."No." <> '')
      THEN
        CurrPage.SAVERECORD;

      SaveAndAutoAsmToOrder;

      IF Reserve = Reserve::Always THEN BEGIN
        CurrPage.SAVERECORD;
        IF ("Outstanding Qty. (Base)" <> 0) AND ("No." <> xRec."No.") THEN BEGIN
          AutoReserve;
          CurrPage.UPDATE(FALSE);
        END;
      END;
    END;

    LOCAL PROCEDURE VariantCodeOnAfterValidate@21();
    BEGIN
      SaveAndAutoAsmToOrder;
    END;

    LOCAL PROCEDURE LocationCodeOnAfterValidate@19034787();
    BEGIN
      SaveAndAutoAsmToOrder;

      IF (Reserve = Reserve::Always) AND
         ("Outstanding Qty. (Base)" <> 0) AND
         ("Location Code" <> xRec."Location Code")
      THEN BEGIN
        CurrPage.SAVERECORD;
        AutoReserve;
        CurrPage.UPDATE(FALSE);
      END;
    END;

    LOCAL PROCEDURE ReserveOnAfterValidate@19004502();
    BEGIN
      IF (Reserve = Reserve::Always) AND ("Outstanding Qty. (Base)" <> 0) THEN BEGIN
        CurrPage.SAVERECORD;
        AutoReserve;
        CurrPage.UPDATE(FALSE);
      END;
    END;

    LOCAL PROCEDURE QuantityOnAfterValidate@19032465();
    VAR
      UpdateIsDone@1001 : Boolean;
    BEGIN
      IF Type = Type::Item THEN
        CASE Reserve OF
          Reserve::Always:
            BEGIN
              CurrPage.SAVERECORD;
              AutoReserve;
              CurrPage.UPDATE(FALSE);
              UpdateIsDone := TRUE;
            END;
          Reserve::Optional:
            IF (Quantity < xRec.Quantity) AND (xRec.Quantity > 0) THEN BEGIN
              CurrPage.SAVERECORD;
              CurrPage.UPDATE(FALSE);
              UpdateIsDone := TRUE;
            END;
        END;

      IF (Type = Type::Item) AND
         (Quantity <> xRec.Quantity) AND
         NOT UpdateIsDone
      THEN
        CurrPage.UPDATE(TRUE);
    END;

    LOCAL PROCEDURE QtyToAsmToOrderOnAfterValidate@19();
    BEGIN
      CurrPage.SAVERECORD;
      IF Reserve = Reserve::Always THEN
        AutoReserve;
      CurrPage.UPDATE(TRUE);
    END;

    LOCAL PROCEDURE UnitofMeasureCodeOnAfterValida@19057939();
    BEGIN
      IF Reserve = Reserve::Always THEN BEGIN
        CurrPage.SAVERECORD;
        AutoReserve;
        CurrPage.UPDATE(FALSE);
      END;
    END;

    LOCAL PROCEDURE ShipmentDateOnAfterValidate@19068710();
    BEGIN
      IF (Reserve = Reserve::Always) AND
         ("Outstanding Qty. (Base)" <> 0) AND
         ("Shipment Date" <> xRec."Shipment Date")
      THEN BEGIN
        CurrPage.SAVERECORD;
        AutoReserve;
        CurrPage.UPDATE(FALSE);
      END ELSE
        CurrPage.UPDATE(TRUE);
    END;

    LOCAL PROCEDURE SaveAndAutoAsmToOrder@20();
    BEGIN
      IF (Type = Type::Item) AND IsAsmToOrderRequired THEN BEGIN
        CurrPage.SAVERECORD;
        AutoAsmToOrder;
        CurrPage.UPDATE(FALSE);
      END;
    END;

    LOCAL PROCEDURE SetLocationCodeMandatory@22();
    VAR
      InventorySetup@1000 : Record 313;
    BEGIN
      InventorySetup.GET;
      LocationCodeMandatory := InventorySetup."Location Mandatory" AND (Type = Type::Item);
    END;

    LOCAL PROCEDURE GetTotalSalesHeader@9();
    BEGIN
      IF NOT TotalSalesHeader.GET("Document Type","Document No.") THEN
        CLEAR(TotalSalesHeader);
      IF Currency.Code <> TotalSalesHeader."Currency Code" THEN
        IF NOT Currency.GET(TotalSalesHeader."Currency Code") THEN
          Currency.InitRoundingPrecision;
    END;

    LOCAL PROCEDURE CalculateTotals@8();
    BEGIN
      GetTotalSalesHeader;
      TotalSalesHeader.CALCFIELDS("Recalculate Invoice Disc.");

      IF SalesSetup."Calc. Inv. Discount" AND ("Document No." <> '') AND (TotalSalesHeader."Customer Posting Group" <> '') AND
         TotalSalesHeader."Recalculate Invoice Disc."
      THEN
        IF FIND THEN
          CalcInvDisc;

      DocumentTotals.CalculateSalesTotals(TotalSalesLine,VATAmount,Rec);
      InvoiceDiscountAmount := TotalSalesLine."Inv. Discount Amount";
      InvoiceDiscountPct := SalesCalcDiscountByType.GetCustInvoiceDiscountPct(Rec);
    END;

    LOCAL PROCEDURE RedistributeTotalsOnAfterValidate@2();
    BEGIN
      CurrPage.SAVERECORD;

      SalesHeader.GET("Document Type","Document No.");
      DocumentTotals.SalesRedistributeInvoiceDiscountAmounts(Rec,VATAmount,TotalSalesLine);
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE ValidateSaveShortcutDimCode@7(FieldNumber@1001 : Integer;VAR ShortcutDimCode@1000 : Code[20]);
    BEGIN
      ValidateShortcutDimCode(FieldNumber,ShortcutDimCode);
      CurrPage.SAVERECORD;
    END;

    LOCAL PROCEDURE UpdateEditableOnRow@18();
    VAR
      SalesLine@1000 : Record 37;
    BEGIN
      RowIsNotText := NOT (("No." = '') AND (Description <> ''));
      IF RowIsNotText THEN
        UnitofMeasureCodeIsChangeable := CanEditUnitOfMeasureCode
      ELSE
        UnitofMeasureCodeIsChangeable := FALSE;

      IF TotalSalesHeader."No." <> '' THEN BEGIN
        SalesLine.SETRANGE("Document No.",TotalSalesHeader."No.");
        SalesLine.SETRANGE("Document Type",TotalSalesHeader."Document Type");
        IF NOT SalesLine.ISEMPTY THEN
          InvDiscAmountEditable :=
            SalesCalcDiscountByType.InvoiceDiscIsAllowed(TotalSalesHeader."Invoice Disc. Code") AND CurrPage.EDITABLE;
      END;
    END;

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. SID1.0  05.09.03 HHE Fremvist Beskrivelse2
    }
    END.
  }
}

OBJECT Page 83043 OPC Released Production Orders
{
  OBJECT-PROPERTIES
  {
    Date=20.09.17;
    Time=15:17:35;
    Modified=Yes;
    Version List=NAVW110.00,OPC6.01;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=OPC Released Production Orders;
               NOR=OPC Frigitte produksjonsordrer];
    SourceTable=Table5405;
    SourceTableView=WHERE(Status=CONST(Released));
    PageType=List;
    CardPageID=OPC Released Production Order;
    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 10      ;1   ;ActionGroup;
                      CaptionML=[ENU=Pro&d. Order;
                                 NOR=Pro&d.ordre];
                      Image=Order }
      { 12      ;2   ;ActionGroup;
                      CaptionML=[ENU=E&ntries;
                                 NOR=P&oster];
                      Image=Entries }
      { 13      ;3   ;Action    ;
                      ShortCutKey=Ctrl+F7;
                      CaptionML=[ENU=Item Ledger E&ntries;
                                 NOR=&Vareposter];
                      RunObject=Page 38;
                      RunPageView=SORTING(Order Type,Order No.);
                      RunPageLink=Order Type=CONST(Production),
                                  Order No.=FIELD(No.);
                      Image=ItemLedger }
      { 27      ;3   ;Action    ;
                      CaptionML=[ENU=Capacity Ledger Entries;
                                 NOR=Kapasitetsposter];
                      RunObject=Page 5832;
                      RunPageView=SORTING(Order Type,Order No.);
                      RunPageLink=Order Type=CONST(Production),
                                  Order No.=FIELD(No.);
                      Image=CapacityLedger }
      { 28      ;3   ;Action    ;
                      CaptionML=[ENU=Value Entries;
                                 NOR=Verdiposter];
                      RunObject=Page 5802;
                      RunPageView=SORTING(Order Type,Order No.);
                      RunPageLink=Order Type=CONST(Production),
                                  Order No.=FIELD(No.);
                      Image=ValueLedger }
      { 33      ;3   ;Action    ;
                      CaptionML=[ENU=&Warehouse Entries;
                                 NOR=&Lagerposter];
                      RunObject=Page 7318;
                      RunPageView=SORTING(Source Type,Source Subtype,Source No.);
                      RunPageLink=Source Type=FILTER(83|5407),
                                  Source Subtype=FILTER(3|4|5),
                                  Source No.=FIELD(No.);
                      Image=BinLedger }
      { 29      ;2   ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 NOR=&Merknader];
                      RunObject=Page 99000838;
                      RunPageLink=Status=FIELD(Status),
                                  Prod. Order No.=FIELD(No.);
                      Image=ViewComments }
      { 30      ;2   ;Action    ;
                      AccessByPermission=TableData 348=R;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 NOR=Dimensjoner];
                      ToolTipML=[ENU=View or edit dimensions, such as area, project, or department, that you can assign to sales and purchase documents to distribute costs and analyze transaction history.;
                                 NOR=Vis eller rediger dimensjoner, for eksempel omr†de, prosjekt eller avdeling, som du kan tilordne til salgs- og kj›psdokumenter for † distribuere kostnader og analysere transaksjonshistorikk.];
                      Image=Dimensions;
                      OnAction=BEGIN
                                 ShowDocDim;
                               END;
                                }
      { 31      ;2   ;Separator  }
      { 32      ;2   ;Action    ;
                      ShortCutKey=F7;
                      CaptionML=[ENU=Statistics;
                                 NOR=Statistikk];
                      RunObject=Page 99000816;
                      RunPageLink=Status=FIELD(Status),
                                  No.=FIELD(No.),
                                  Date Filter=FIELD(Date Filter);
                      Promoted=Yes;
                      Image=Statistics;
                      PromotedCategory=Process }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 150     ;1   ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 NOR=F&unksjoner];
                      Image=Action }
      { 152     ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Change &Status;
                                 NOR=Endring&sstatus];
                      RunObject=Codeunit 5407;
                      Promoted=Yes;
                      Image=ChangeStatus;
                      PromotedCategory=Process }
      { 151     ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=&Update Unit Cost;
                                 NOR=&Oppdater enhetskost];
                      Promoted=Yes;
                      Image=UpdateUnitCost;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ProdOrder@1001 : Record 5405;
                               BEGIN
                                 ProdOrder.SETRANGE(Status,Status);
                                 ProdOrder.SETRANGE("No.","No.");

                                 REPORT.RUNMODAL(REPORT::"Update Unit Cost",TRUE,TRUE,ProdOrder);
                               END;
                                }
      { 153     ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Create Inventor&y Put-away/Pick/Movement;
                                 NOR=Opprett lagerplas&sering/-plukk/-flytting];
                      Promoted=Yes;
                      Image=CreatePutAway;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CreateInvtPutAwayPick;
                               END;
                                }
      { 1900000006;0 ;ActionContainer;
                      ActionContainerType=Reports }
      { 1903759606;1 ;Action    ;
                      CaptionML=[ENU=Prod. Order - Detail Calc.;
                                 NOR=Produksjonsordre - detaljberegning];
                      RunObject=Report 99000768;
                      Promoted=No;
                      Image=Report;
                      PromotedCategory=Report }
      { 1905556906;1 ;Action    ;
                      CaptionML=[ENU=Prod. Order - Precalc. Time;
                                 NOR=Prod.ordre - forh†ndsberegnet tid];
                      RunObject=Report 99000764;
                      Promoted=No;
                      Image=Report;
                      PromotedCategory=Report }
      { 1906587906;1 ;Action    ;
                      CaptionML=[ENU=Production Order - Comp. and Routing;
                                 NOR=Produksjonsordre - komponenter og rute];
                      RunObject=Report 5500;
                      Promoted=Yes;
                      Image=Report;
                      PromotedCategory=Report }
      { 1903594306;1 ;Action    ;
                      Name=ProdOrderJobCard;
                      CaptionML=[ENU=Production Order Job Card;
                                 NOR=Produksjonsordre - prosjektkort];
                      Promoted=No;
                      Image=Report;
                      PromotedCategory=Report;
                      OnAction=BEGIN
                                 ManuPrintReport.PrintProductionOrder(Rec,0);
                               END;
                                }
      { 1902850806;1 ;Action    ;
                      CaptionML=[ENU=Production Order - Picking List;
                                 NOR=Produksjonsordre - plukkliste];
                      RunObject=Report 99000766;
                      Promoted=No;
                      Image=Report;
                      PromotedCategory=Report }
      { 1902917606;1 ;Action    ;
                      Name=ProdOrderMaterialRequisition;
                      CaptionML=[ENU=Production Order - Material Requisition;
                                 NOR=Produksjonsordre - materialbehov];
                      Promoted=Yes;
                      Image=Report;
                      PromotedCategory=Report;
                      OnAction=BEGIN
                                 ManuPrintReport.PrintProductionOrder(Rec,1);
                               END;
                                }
      { 1906372006;1 ;Action    ;
                      CaptionML=[ENU=Production Order List;
                                 NOR=Produksjonsordreoversikt];
                      RunObject=Report 99000763;
                      Promoted=Yes;
                      Image=Report;
                      PromotedCategory=Report }
      { 1903746906;1 ;Action    ;
                      Name=ProdOrderShortageList;
                      CaptionML=[ENU=Production Order - Shortage List;
                                 NOR=Produksjonsordre - mankoliste];
                      Promoted=Yes;
                      Image=Report;
                      PromotedCategory=Report;
                      OnAction=BEGIN
                                 ManuPrintReport.PrintProductionOrder(Rec,2);
                               END;
                                }
      { 1901854406;1 ;Action    ;
                      CaptionML=[ENU=Production Order Statistics;
                                 NOR=Produksjonsordrestatistikk];
                      RunObject=Report 99000791;
                      Promoted=Yes;
                      Image=Report;
                      PromotedCategory=Report }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                Lookup=No;
                ToolTipML=[ENU=Specifies the number of the production order.;
                           NOR=Angir nummeret p† produksjonsordren.];
                SourceExpr="No." }

    { 4   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the description of the production order.;
                           NOR=Angir beskrivelsen for produksjonsordren.];
                SourceExpr=Description }

    { 6   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the source number of the production order.;
                           NOR=Angir kildenummeret p† produksjonsordren.];
                SourceExpr="Source No." }

    { 8   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the routing number used for this production order.;
                           NOR=Angir rutenummeret som skal brukes for produksjonsordren.];
                SourceExpr="Routing No." }

    { 45  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies how many units of the item or the family to produce (production quantity).;
                           NOR=Angir hvor mange enheter av varen eller familien som skal produseres (produksjonsantall).];
                SourceExpr=Quantity }

    { 49  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for the dimension associated with the production order.;
                           NOR=Angir koden for dimensjonen som er knyttet til produksjonsordren.];
                SourceExpr="Shortcut Dimension 1 Code";
                Visible=FALSE }

    { 51  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for the dimension associated with the production order.;
                           NOR=Angir koden for dimensjonen som er knyttet til produksjonsordren.];
                SourceExpr="Shortcut Dimension 2 Code";
                Visible=FALSE }

    { 53  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the location code to which you want to post the finished product from this production order.;
                           NOR=Angir i hvilken lokasjonskode du vil bokf›re det ferdige produktet fra produksjonsordren.];
                SourceExpr="Location Code";
                Visible=FALSE }

    { 14  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the starting time of the production order.;
                           NOR=Angir starttidspunktet for produksjonsordren.];
                SourceExpr="Starting Time";
                Visible=FALSE }

    { 16  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the starting date of the production order.;
                           NOR=Angir startdatoen for produksjonsordren.];
                SourceExpr="Starting Date" }

    { 18  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the ending time of the production order.;
                           NOR=Angir sluttidspunktet for produksjonsordren.];
                SourceExpr="Ending Time";
                Visible=FALSE }

    { 20  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the ending date of the production order.;
                           NOR=Angir sluttdatoen for produksjonsordren.];
                SourceExpr="Ending Date" }

    { 22  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the due date of the production order.;
                           NOR=Angir forfallsdatoen for produksjonsordren.];
                SourceExpr="Due Date" }

    { 34  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the ID of the user who is responsible for the document.;
                           NOR=Angir ID-en til brukeren som er ansvarlig for dokumentet.];
                SourceExpr="Assigned User ID" }

    { 41  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the actual finishing date of a finished production order.;
                           NOR=Angir den faktiske ferdigdatoen for en ferdig produksjonsordre.];
                SourceExpr="Finished Date";
                Visible=FALSE }

    { 43  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the status of the production order.;
                           NOR=Angir statusen p† produksjonsordren.];
                SourceExpr=Status }

    { 65  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the search description.;
                           NOR=Angir s›kebeskrivelsen.];
                SourceExpr="Search Description" }

    { 67  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies when the production order card was last modified.;
                           NOR=Angir n†r produksjonsordren sist ble endret.];
                SourceExpr="Last Date Modified";
                Visible=FALSE }

    { 69  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a bin to which you want to post the finished items.;
                           NOR=Angir i hvilken hylle du vil bokf›re de ferdige varene.];
                SourceExpr="Bin Code";
                Visible=FALSE }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=TRUE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      ManuPrintReport@1000 : Codeunit 99000817;

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 15.08.17 JAL The page is based on PAG 9326 "Released Production Orders"
                       New PagePartID
    }
    END.
  }
}

OBJECT Page 83044 OPC Released Production Order
{
  OBJECT-PROPERTIES
  {
    Date=20.09.17;
    Time=15:17:35;
    Modified=Yes;
    Version List=NAVW110.00,OPC6.01;
  }
  PROPERTIES
  {
    CaptionML=[ENU=OPC Released Production Order;
               NOR=OPC Frigitt produksjonsordre];
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=No;
    SourceTable=Table5405;
    SourceTableView=WHERE(Status=CONST(Released));
    PageType=Document;
    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 49      ;1   ;ActionGroup;
                      CaptionML=[ENU=O&rder;
                                 NOR=&Ordre];
                      Image=Order }
      { 55      ;2   ;ActionGroup;
                      CaptionML=[ENU=E&ntries;
                                 NOR=P&oster];
                      Image=Entries }
      { 66      ;3   ;Action    ;
                      ShortCutKey=Ctrl+F7;
                      CaptionML=[ENU=Item Ledger E&ntries;
                                 NOR=&Vareposter];
                      RunObject=Page 38;
                      RunPageView=SORTING(Order Type,Order No.);
                      RunPageLink=Order Type=CONST(Production),
                                  Order No.=FIELD(No.);
                      Image=ItemLedger }
      { 69      ;3   ;Action    ;
                      CaptionML=[ENU=Capacity Ledger Entries;
                                 NOR=Kapasitetsposter];
                      RunObject=Page 5832;
                      RunPageView=SORTING(Order Type,Order No.);
                      RunPageLink=Order Type=CONST(Production),
                                  Order No.=FIELD(No.);
                      Image=CapacityLedger }
      { 70      ;3   ;Action    ;
                      CaptionML=[ENU=Value Entries;
                                 NOR=Verdiposter];
                      RunObject=Page 5802;
                      RunPageView=SORTING(Order Type,Order No.);
                      RunPageLink=Order Type=CONST(Production),
                                  Order No.=FIELD(No.);
                      Image=ValueLedger }
      { 7300    ;3   ;Action    ;
                      CaptionML=[ENU=&Warehouse Entries;
                                 NOR=&Lagerposter];
                      RunObject=Page 7318;
                      RunPageView=SORTING(Source Type,Source Subtype,Source No.);
                      RunPageLink=Source Type=FILTER(83|5406|5407),
                                  Source Subtype=FILTER(3|4|5),
                                  Source No.=FIELD(No.);
                      Image=BinLedger }
      { 76      ;2   ;Action    ;
                      AccessByPermission=TableData 348=R;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 NOR=Dimensjoner];
                      ToolTipML=[ENU=View or edit dimensions, such as area, project, or department, that you can assign to sales and purchase documents to distribute costs and analyze transaction history.;
                                 NOR=Vis eller rediger dimensjoner, for eksempel omr†de, prosjekt eller avdeling, som du kan tilordne til salgs- og kj›psdokumenter for † distribuere kostnader og analysere transaksjonshistorikk.];
                      Image=Dimensions;
                      OnAction=BEGIN
                                 ShowDocDim;
                               END;
                                }
      { 75      ;2   ;Separator  }
      { 90      ;2   ;Action    ;
                      Name=Planning;
                      CaptionML=[ENU=Plannin&g;
                                 NOR=Pla&nlegging];
                      Image=Planning;
                      OnAction=VAR
                                 OrderPlanning@1000 : Page 5522;
                               BEGIN
                                 OrderPlanning.SetProdOrder(Rec);
                                 OrderPlanning.RUNMODAL;
                               END;
                                }
      { 77      ;2   ;Separator  }
      { 78      ;2   ;Action    ;
                      ShortCutKey=F7;
                      CaptionML=[ENU=Statistics;
                                 NOR=Statistikk];
                      RunObject=Page 99000816;
                      RunPageLink=Status=FIELD(Status),
                                  No.=FIELD(No.),
                                  Date Filter=FIELD(Date Filter);
                      Promoted=Yes;
                      Image=Statistics;
                      PromotedCategory=Process }
      { 79      ;2   ;Separator  }
      { 71      ;2   ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 NOR=&Merknader];
                      RunObject=Page 99000838;
                      RunPageLink=Status=FIELD(Status),
                                  Prod. Order No.=FIELD(No.);
                      Image=ViewComments }
      { 7301    ;2   ;Action    ;
                      CaptionML=[ENU=Put-away/Pick Lines/Movement Lines;
                                 NOR=Plassering/plukklinjer/flyttingslinjer];
                      RunObject=Page 5785;
                      RunPageView=SORTING(Source Type,Source Subtype,Source No.,Source Line No.,Source Subline No.,Unit of Measure Code,Action Type,Breakbulk No.,Original Breakbulk);
                      RunPageLink=Source Type=FILTER(5406|5407),
                                  Source Subtype=CONST(3),
                                  Source No.=FIELD(No.);
                      Image=PutawayLines }
      { 7302    ;2   ;Action    ;
                      CaptionML=[ENU=Registered P&ick Lines;
                                 NOR=Registrerte plukkl&injer];
                      RunObject=Page 7364;
                      RunPageView=SORTING(Source Type,Source Subtype,Source No.,Source Line No.,Source Subline No.);
                      RunPageLink=Source Type=CONST(5407),
                                  Source Subtype=CONST(3),
                                  Source No.=FIELD(No.);
                      Image=RegisteredDocs }
      { 7303    ;2   ;Action    ;
                      CaptionML=[ENU=Registered Invt. Movement Lines;
                                 NOR=Registrerte lagerflyttingslinjer];
                      RunObject=Page 7387;
                      RunPageView=SORTING(Source Type,Source Subtype,Source No.,Source Line No.,Source Subline No.);
                      RunPageLink=Source Type=CONST(5407),
                                  Source Subtype=CONST(3),
                                  Source No.=FIELD(No.);
                      Image=RegisteredDocs }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 22      ;1   ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 NOR=F&unksjoner];
                      Image=Action }
      { 24      ;2   ;Action    ;
                      Name=RefreshProductionOrder;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Re&fresh Production Order;
                                 NOR=Opp&dater produksjonsordre];
                      Promoted=Yes;
                      Image=Refresh;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ProdOrder@1001 : Record 5405;
                               BEGIN
                                 ProdOrder.SETRANGE(Status,Status);
                                 ProdOrder.SETRANGE("No.","No.");
                                 REPORT.RUNMODAL(REPORT::"Refresh Production Order",TRUE,TRUE,ProdOrder);
                               END;
                                }
      { 25      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Re&plan;
                                 NOR=&Planlegg p† nytt];
                      Promoted=Yes;
                      Image=Replan;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ProdOrder@1001 : Record 5405;
                               BEGIN
                                 ProdOrder.SETRANGE(Status,Status);
                                 ProdOrder.SETRANGE("No.","No.");
                                 REPORT.RUNMODAL(REPORT::"Replan Production Order",TRUE,TRUE,ProdOrder);
                               END;
                                }
      { 36      ;2   ;Separator  }
      { 53      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Change &Status;
                                 NOR=&Endre status];
                      Promoted=Yes;
                      Image=ChangeStatus;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CurrPage.UPDATE;
                                 CODEUNIT.RUN(CODEUNIT::"Prod. Order Status Management",Rec);
                               END;
                                }
      { 57      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=&Update Unit Cost;
                                 NOR=Oppdater en&hetskost];
                      Promoted=Yes;
                      Image=UpdateUnitCost;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ProdOrder@1001 : Record 5405;
                               BEGIN
                                 ProdOrder.SETRANGE(Status,Status);
                                 ProdOrder.SETRANGE("No.","No.");

                                 REPORT.RUNMODAL(REPORT::"Update Unit Cost",TRUE,TRUE,ProdOrder);
                               END;
                                }
      { 58      ;2   ;Separator  }
      { 72      ;2   ;Action    ;
                      CaptionML=[ENU=&Reserve;
                                 NOR=Re&server];
                      Image=Reserve;
                      OnAction=BEGIN
                                 CurrPage.ProdOrderLines.PAGE.PageShowReservation;
                               END;
                                }
      { 73      ;2   ;Action    ;
                      Name=OrderTracking;
                      CaptionML=[ENU=Order &Tracking;
                                 NOR=Ordre&sporing];
                      Image=OrderTracking;
                      OnAction=BEGIN
                                 CurrPage.ProdOrderLines.PAGE.ShowTracking;
                               END;
                                }
      { 23      ;2   ;Separator ;
                      CaptionML=[ENU="";
                                 NOR=""] }
      { 87      ;2   ;Separator  }
      { 74      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=C&opy Prod. Order Document;
                                 NOR=&Kopier prod.ordredokument];
                      Image=CopyDocument;
                      OnAction=BEGIN
                                 CopyProdOrderDoc.SetProdOrder(Rec);
                                 CopyProdOrderDoc.RUNMODAL;
                                 CLEAR(CopyProdOrderDoc);
                               END;
                                }
      { 5       ;1   ;ActionGroup;
                      CaptionML=[ENU=Warehouse;
                                 NOR=Lager];
                      Image=Worksheets }
      { 48      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Create Inventor&y Put-away/Pick/Movement;
                                 NOR=Opprett lagerplas&sering/-plukk/-flytting];
                      Image=CreatePutAway;
                      OnAction=BEGIN
                                 CreateInvtPutAwayPick;
                               END;
                                }
      { 80      ;2   ;Action    ;
                      CaptionML=[ENU=Create I&nbound Whse. Request;
                                 NOR=Opprett i&nng. lagerforesp›rsel];
                      Image=NewToDo;
                      OnAction=VAR
                                 WhseOutputProdRelease@1000 : Codeunit 7325;
                               BEGIN
                                 IF WhseOutputProdRelease.CheckWhseRqst(Rec) THEN
                                   MESSAGE(Text002)
                                 ELSE BEGIN
                                   CLEAR(WhseOutputProdRelease);
                                   IF WhseOutputProdRelease.Release(Rec) THEN
                                     MESSAGE(Text000)
                                   ELSE
                                     MESSAGE(Text001);
                                 END;
                               END;
                                }
      { 62      ;2   ;Action    ;
                      AccessByPermission=TableData 7302=R;
                      CaptionML=[ENU=Create Whse. Pick;
                                 NOR=Opprett plukk];
                      Image=CreateWarehousePick;
                      OnAction=BEGIN
                                 SetHideValidationDialog(FALSE);
                                 CreatePick(USERID,0,FALSE,FALSE,FALSE);
                               END;
                                }
      { 20      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Print;
                                 NOR=&Skriv ut];
                      Image=Print }
      { 21      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Job Card;
                                 NOR=Prosjektkort];
                      Promoted=Yes;
                      Image=Report;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 ManuPrintReport.PrintProductionOrder(Rec,0);
                               END;
                                }
      { 37      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Mat. &Requisition;
                                 NOR=Mate&rialbehov];
                      Promoted=Yes;
                      Image=Report;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 ManuPrintReport.PrintProductionOrder(Rec,1);
                               END;
                                }
      { 46      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Shortage List;
                                 NOR=Mankoliste];
                      Promoted=Yes;
                      Image=Report;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 ManuPrintReport.PrintProductionOrder(Rec,2);
                               END;
                                }
      { 1900000006;0 ;ActionContainer;
                      ActionContainerType=Reports }
      { 1906187306;1 ;Action    ;
                      CaptionML=[ENU=Subcontractor - Dispatch List;
                                 NOR=Servicefordeling - underleverand›r];
                      RunObject=Report 99000789;
                      Promoted=No;
                      Image=Report;
                      PromotedCategory=Report }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=[ENU=General;
                           NOR=Generelt] }

    { 16  ;2   ;Field     ;
                Lookup=No;
                ToolTipML=[ENU=Specifies the number of the production order.;
                           NOR=Angir nummeret p† produksjonsordren.];
                SourceExpr="No.";
                Importance=Promoted;
                OnAssistEdit=BEGIN
                               IF AssistEdit(xRec) THEN
                                 CurrPage.UPDATE;
                             END;
                              }

    { 4   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the description of the production order.;
                           NOR=Angir beskrivelsen for produksjonsordren.];
                SourceExpr=Description;
                Importance=Promoted;
                QuickEntry=FALSE }

    { 3   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies an additional part of the production order description.;
                           NOR=Angir en tilleggsdel av produksjonsordrebeskrivelsen.];
                SourceExpr="Description 2";
                QuickEntry=FALSE }

    { 11  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the source type of the production order.;
                           NOR=Angir kildetypen for produksjonsordren.];
                SourceExpr="Source Type";
                OnValidate=BEGIN
                             IF xRec."Source Type" <> "Source Type" THEN
                               "Source No." := '';
                           END;
                            }

    { 6   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the source number of the production order.;
                           NOR=Angir kildenummeret p† produksjonsordren.];
                SourceExpr="Source No." }

    { 18  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the search description.;
                           NOR=Angir s›kebeskrivelsen.];
                SourceExpr="Search Description";
                QuickEntry=FALSE }

    { 19  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies how many units of the item or the family to produce (production quantity).;
                           NOR=Angir hvor mange enheter av varen eller familien som skal produseres (produksjonsantall).];
                SourceExpr=Quantity;
                Importance=Promoted }

    { 44  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the due date of the production order.;
                           NOR=Angir forfallsdatoen for produksjonsordren.];
                SourceExpr="Due Date" }

    { 68  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the ID of the user who is responsible for the document.;
                           NOR=Angir ID-en til brukeren som er ansvarlig for dokumentet.];
                SourceExpr="Assigned User ID";
                QuickEntry=FALSE }

    { 27  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies whether the posting of consumption and output for the released production order is blocked.;
                           NOR=Angir om bokf›ring av forbruk og avgang for den frigitte produksjonsordren er sperret.];
                SourceExpr=Blocked;
                QuickEntry=FALSE }

    { 45  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies when the production order card was last modified.;
                           NOR=Angir n†r produksjonsordren sist ble endret.];
                SourceExpr="Last Date Modified";
                QuickEntry=FALSE }

    { 26  ;1   ;Part      ;
                Name=ProdOrderLines;
                SubPageLink=Prod. Order No.=FIELD(No.);
                PagePartID=Page83045 }

    { 1907170701;1;Group  ;
                CaptionML=[ENU=Schedule;
                           NOR=Estimat] }

    { 28  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the starting time of the production order.;
                           NOR=Angir starttidspunktet for produksjonsordren.];
                SourceExpr="Starting Time";
                Importance=Promoted }

    { 30  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the starting date of the production order.;
                           NOR=Angir startdatoen for produksjonsordren.];
                SourceExpr="Starting Date";
                Importance=Promoted }

    { 32  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the ending time of the production order.;
                           NOR=Angir sluttidspunktet for produksjonsordren.];
                SourceExpr="Ending Time";
                Importance=Promoted }

    { 34  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the ending date of the production order.;
                           NOR=Angir sluttdatoen for produksjonsordren.];
                SourceExpr="Ending Date";
                Importance=Promoted }

    { 1904784501;1;Group  ;
                CaptionML=[ENU=Posting;
                           NOR=Bokf›ring] }

    { 81  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the inventory posting group in order to assign the WIP to the correct general ledger account.;
                           NOR=Angir lagerbokf›ringsgruppen, slik at varer i arbeid tilordnes riktig finanskonto.];
                SourceExpr="Inventory Posting Group";
                Importance=Promoted }

    { 83  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a product posting group associated with manufactured items in this production order.;
                           NOR=Angir en varebokf›ringsgruppe som er tilknyttet produserte varer i denne produksjonsordren.];
                SourceExpr="Gen. Prod. Posting Group" }

    { 85  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a business posting group.;
                           NOR=Angir en bokf›ringsgruppe for firma.];
                SourceExpr="Gen. Bus. Posting Group" }

    { 38  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for the dimension associated with the production order.;
                           NOR=Angir koden for dimensjonen som er knyttet til produksjonsordren.];
                SourceExpr="Shortcut Dimension 1 Code";
                OnValidate=BEGIN
                             ShortcutDimension1CodeOnAfterV;
                           END;
                            }

    { 40  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for the dimension associated with the production order.;
                           NOR=Angir koden for dimensjonen som er knyttet til produksjonsordren.];
                SourceExpr="Shortcut Dimension 2 Code";
                OnValidate=BEGIN
                             ShortcutDimension2CodeOnAfterV;
                           END;
                            }

    { 42  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the location code to which you want to post the finished product from this production order.;
                           NOR=Angir i hvilken lokasjonskode du vil bokf›re det ferdige produktet fra produksjonsordren.];
                SourceExpr="Location Code";
                Importance=Promoted }

    { 88  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a bin to which you want to post the finished items.;
                           NOR=Angir i hvilken hylle du vil bokf›re de ferdige varene.];
                SourceExpr="Bin Code";
                Importance=Promoted }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=TRUE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      CopyProdOrderDoc@1000 : Report 99003802;
      ManuPrintReport@1001 : Codeunit 99000817;
      Text000@1002 : TextConst 'ENU=Inbound Whse. Requests are created.;NOR=Det er opprettet inng†ende lagerforesp›rsler.';
      Text001@1003 : TextConst 'ENU=No Inbound Whse. Request is created.;NOR=Det er ikke opprettet noen inng†ende lagerforesp›rsel.';
      Text002@1004 : TextConst 'ENU=Inbound Whse. Requests have already been created.;NOR=Inng†ende lagerforesp›rsler er allerede opprettet.';

    LOCAL PROCEDURE ShortcutDimension1CodeOnAfterV@19029405();
    BEGIN
      CurrPage.ProdOrderLines.PAGE.UpdateForm(TRUE);
    END;

    LOCAL PROCEDURE ShortcutDimension2CodeOnAfterV@19008725();
    BEGIN
      CurrPage.ProdOrderLines.PAGE.UpdateForm(TRUE);
    END;

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 09.06.16 JAL The page is based on PAG 99000831 "Released Production Order"
                       InsertAllowed, DeleteAllowed and ModifyAllowed set to No;
                       New PagePartID
    }
    END.
  }
}

OBJECT Page 83045 OPC Released Prod. Order Lines
{
  OBJECT-PROPERTIES
  {
    Date=20.09.17;
    Time=15:17:35;
    Modified=Yes;
    Version List=NAVW110.00,OPC6.01;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Lines;
               NOR=Linjer];
    MultipleNewLines=Yes;
    LinksAllowed=No;
    SourceTable=Table5406;
    DelayedInsert=Yes;
    SourceTableView=WHERE(Status=CONST(Released));
    PageType=ListPart;
    AutoSplitKey=Yes;
    OnAfterGetRecord=BEGIN
                       DescriptionIndent := 0;
                       ShowShortcutDimCode(ShortcutDimCode);
                       DescriptionOnFormat;
                     END;

    OnNewRecord=BEGIN
                  CLEAR(ShortcutDimCode);
                END;

    OnDeleteRecord=VAR
                     ReserveProdOrderLine@1000 : Codeunit 99000837;
                   BEGIN
                     COMMIT;
                     IF NOT ReserveProdOrderLine.DeleteLineConfirm(Rec) THEN
                       EXIT(FALSE);
                   END;

    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1906587504;1 ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 NOR=F&unksjoner];
                      Image=Action }
      { 1902759304;2 ;Action    ;
                      CaptionML=[ENU=&Reserve;
                                 NOR=Re&server];
                      Image=Reserve;
                      OnAction=BEGIN
                                 PageShowReservation;
                               END;
                                }
      { 1900205704;2 ;Action    ;
                      CaptionML=[ENU=Order &Tracking;
                                 NOR=&Sporing];
                      Image=OrderTracking;
                      OnAction=BEGIN
                                 ShowTracking;
                               END;
                                }
      { 1907935204;1 ;ActionGroup;
                      CaptionML=[ENU=&Line;
                                 NOR=&Linje];
                      Image=Line }
      { 1901313104;2 ;ActionGroup;
                      CaptionML=[ENU=Item Availability by;
                                 NOR=Varetilgjengelighet per];
                      Image=ItemAvailability }
      { 5       ;3   ;Action    ;
                      Name=ItemAvailabilityByEvent;
                      CaptionML=[ENU=Event;
                                 NOR=Hendelse];
                      Image=Event;
                      OnAction=BEGIN
                                 ItemAvailability(ItemAvailFormsMgt.ByEvent);
                               END;
                                }
      { 1901741904;3 ;Action    ;
                      Name=ItemAvailabilityByPeriod;
                      CaptionML=[ENU=Period;
                                 NOR=Periode];
                      Image=Period;
                      OnAction=BEGIN
                                 ItemAvailability(ItemAvailFormsMgt.ByPeriod);
                               END;
                                }
      { 1903866604;3 ;Action    ;
                      Name=ItemAvailabilityByVariant;
                      CaptionML=[ENU=Variant;
                                 NOR=Variant];
                      Image=ItemVariant;
                      OnAction=BEGIN
                                 ItemAvailability(ItemAvailFormsMgt.ByVariant);
                               END;
                                }
      { 1901313004;3 ;Action    ;
                      Name=ItemAvailabilityByLocation;
                      AccessByPermission=TableData 14=R;
                      CaptionML=[ENU=Location;
                                 NOR=Lokasjon];
                      Image=Warehouse;
                      OnAction=BEGIN
                                 ItemAvailability(ItemAvailFormsMgt.ByLocation);
                               END;
                                }
      { 3       ;3   ;Action    ;
                      Name=ItemAvailabilityByBOMLevel;
                      CaptionML=[ENU=BOM Level;
                                 NOR=Stykklisteniv†];
                      Image=BOMLevel;
                      OnAction=BEGIN
                                 ItemAvailability(ItemAvailFormsMgt.ByBOM);
                               END;
                                }
      { 1900205804;2 ;Action    ;
                      Name=ReservationEntries;
                      AccessByPermission=TableData 27=R;
                      CaptionML=[ENU=Reservation Entries;
                                 NOR=Reservasjonsposter];
                      Image=ReservationLedger;
                      OnAction=BEGIN
                                 ShowReservation;
                               END;
                                }
      { 1901288104;2 ;Action    ;
                      Name=Dimensions;
                      AccessByPermission=TableData 348=R;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 NOR=Dimensjoner];
                      ToolTipML=[ENU=View or edit dimensions, such as area, project, or department, that you can assign to sales and purchase documents to distribute costs and analyze transaction history.;
                                 NOR=Vis eller rediger dimensjoner, for eksempel omr†de, prosjekt eller avdeling, som du kan tilordne til salgs- og kj›psdokumenter for † distribuere kostnader og analysere transaksjonshistorikk.];
                      Image=Dimensions;
                      OnAction=BEGIN
                                 ShowDimensions;
                               END;
                                }
      { 1903098604;2 ;Action    ;
                      Name=Routing;
                      CaptionML=[ENU=Ro&uting;
                                 NOR=R&ute];
                      Image=Route;
                      OnAction=BEGIN
                                 ShowRouting;
                               END;
                                }
      { 1901991404;2 ;Action    ;
                      Name=Components;
                      CaptionML=[ENU=Components;
                                 NOR=Komponenter];
                      Image=Components;
                      OnAction=BEGIN
                                 ShowComponents;
                               END;
                                }
      { 1905987604;2 ;Action    ;
                      Name=ItemTrackingLines;
                      ShortCutKey=Shift+Ctrl+I;
                      CaptionML=[ENU=Item &Tracking Lines;
                                 NOR=Vare&sporingslinjer];
                      Image=ItemTrackingLines;
                      OnAction=BEGIN
                                 OpenItemTrackingLines;
                               END;
                                }
      { 1902760704;2 ;Action    ;
                      Name=ProductionJournal;
                      CaptionML=[ENU=&Production Journal;
                                 NOR=&Produksjonskladd];
                      Image=Journal;
                      OnAction=BEGIN
                                 ShowProductionJournal;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                IndentationColumnName=DescriptionIndent;
                IndentationControls=Description;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the item that is to be produced.;
                           NOR=Angir nummeret for varen som skal produseres.];
                SourceExpr="Item No." }

    { 4   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a code if you have set up variant codes in the Item Variants window.;
                           NOR=Angir en kode hvis du har definert variantkoder i vinduet Varevarianter.];
                SourceExpr="Variant Code";
                Visible=FALSE }

    { 8   ;2   ;Field     ;
                ToolTipML=[ENU=Copies the date in this field from the corresponding field on the production order header.;
                           NOR=Kopierer datoen i dette feltet fra tilh›rende felt i produksjonsordrehodet.];
                SourceExpr="Due Date" }

    { 50  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies whether the supply represented by this line is considered by the planning system when calculating action messages.;
                           NOR=Angir om forsyningen, som representeres denne linjen, vurderes av planleggingssystemet ved beregning av handlingsmeldinger.];
                SourceExpr="Planning Flexibility";
                Visible=FALSE }

    { 6   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the value of the Description field on the item card. If you enter a variant code, the variant description is copied to this field instead.;
                           NOR=Angir verdien i feltet Beskrivelse p† varekortet. Hvis du angir en variantkode, kopieres variantbeskrivelsen i stedet.];
                SourceExpr=Description }

    { 10  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies an additional description.;
                           NOR=Angir en tilleggsbeskrivelse.];
                SourceExpr="Description 2";
                Visible=FALSE }

    { 46  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the production BOM that is the basis for creating the Prod. Order Component list for this line.;
                           NOR=Angir nummeret p† produksjonsstykklisten som er grunnlaget for † opprette listen Prod.ordrekomponent for denne linjen.];
                SourceExpr="Production BOM No.";
                Visible=FALSE }

    { 44  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the routing used as the basis for creating the production order routing for this line.;
                           NOR=Angir nummeret p† ruten som brukes for † opprette produksjonsordrerute for denne linjen.];
                SourceExpr="Routing No.";
                Visible=FALSE }

    { 42  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the version number of the routing.;
                           NOR=Angir versjonsnummeret for ruten.];
                SourceExpr="Routing Version Code";
                Visible=FALSE }

    { 38  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the version code of the production BOM.;
                           NOR=Angir versjonskoden for produksjonsstykklisten.];
                SourceExpr="Production BOM Version Code";
                Visible=FALSE }

    { 24  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the location code, if the produced items should be stored in a specific location.;
                           NOR=Angir lokasjonskoden, hvis de produserte varene blir lagret p† en bestemt lokasjon.];
                SourceExpr="Location Code";
                Visible=FALSE }

    { 26  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the bin that the produced item is posted to as output, and from where it can be taken to storage or cross-docked.;
                           NOR=Angir hyllen som den produserte varen er postert til som avgang, og hvor den kan tas fra til lager eller kryssoverf›ring.];
                SourceExpr="Bin Code";
                Visible=FALSE }

    { 54  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the starting date and the starting time, which are combined in a format called "starting date-time".;
                           NOR=Angir startdatoen og starttidspunktet som er kombinert i et format som kalles "Startdato-tidsp.".];
                SourceExpr="Starting Date-Time" }

    { 16  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the entry's starting time, which is retrieved from the production order routing.;
                           NOR=Angir postens startklokkeslett, som hentes fra produksjonsordreruten.];
                SourceExpr="Starting Time";
                Visible=FALSE }

    { 14  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the entry's starting date, which is retrieved from the production order routing.;
                           NOR=Angir postens startdato, som hentes fra produksjonsordreruten.];
                SourceExpr="Starting Date";
                Visible=FALSE }

    { 56  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the ending date and the ending time, which are combined in a format called "ending date-time".;
                           NOR=Angir sluttdatoen og sluttidspunktet som er kombinert i et format som kalles "Sluttdato-tidsp.".];
                SourceExpr="Ending Date-Time" }

    { 20  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the entry's ending time, which is retrieved from the production order routing.;
                           NOR=Angir postens sluttklokkeslett, som hentes fra produksjonsordreruten.];
                SourceExpr="Ending Time";
                Visible=FALSE }

    { 18  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the entry's ending date, which is retrieved from the production order routing.;
                           NOR=Angir postens sluttdato, som hentes fra produksjonsordreruten.];
                SourceExpr="Ending Date";
                Visible=FALSE }

    { 40  ;2   ;Field     ;
                ToolTipML=[ENU=Copies the value in this field from the Scrap Percentage field on the item card when the Item No. field is filled in.;
                           NOR=Kopierer verdien i dette feltet fra feltet Vrakprosent p† varekortet n†r feltet Varenr. fylles ut.];
                SourceExpr="Scrap %";
                Visible=FALSE }

    { 28  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the quantity to be produced if you manually fill in this line.;
                           NOR=Angir antallet som skal produseres hvis du fyller ut denne linjen manuelt.];
                SourceExpr=Quantity }

    { 52  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies how many units of this item have been reserved.;
                           NOR=Angir hvor mange enheter av denne varen som er reservert.];
                SourceExpr="Reserved Quantity";
                Visible=FALSE }

    { 48  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the base unit of measure code for the item.;
                           NOR=Angir lagerenhetskoden for varen.];
                SourceExpr="Unit of Measure Code" }

    { 30  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies how much of the quantity on this line has been produced.;
                           NOR=Angir hvor mye av antallet p† linjen som har blitt produsert.];
                SourceExpr="Finished Quantity" }

    { 32  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the difference between the finished and planned quantities, or zero if the finished quantity is greater than the remaining quantity.;
                           NOR=Angir avviket mellom ferdig antall og planlagt antall, eller null hvis ferdig antall er st›rre enn restantall.];
                SourceExpr="Remaining Quantity" }

    { 34  ;2   ;Field     ;
                ToolTipML=[ENU=Calculates the unit cost, based on the cost of the components in the production order component list, and the routing, if the costing method is not standard.;
                           NOR=Beregner enhetskosten, basert p† kosten for komponenter i listen over produksjonsordrekomponenter, og ruten, hvis kostmetoden ikke er standard.];
                SourceExpr="Unit Cost" }

    { 36  ;2   ;Field     ;
                ToolTipML=[ENU=Calculates the amount by multiplying the Unit Cost by the Quantity.;
                           NOR=Beregner bel›pet ved † multiplisere enhetskosten med antallet.];
                SourceExpr="Cost Amount" }

    { 12  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a dimension value code for a dimension.;
                           NOR=Angir en dimensjonsverdikode for en dimensjon.];
                SourceExpr="Shortcut Dimension 1 Code";
                Visible=FALSE }

    { 22  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a dimension value code for a dimension.;
                           NOR=Angir en dimensjonsverdikode for en dimensjon.];
                SourceExpr="Shortcut Dimension 2 Code";
                Visible=FALSE }

    { 300 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[3];
                CaptionClass='1,2,3';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(3),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(3,ShortcutDimCode[3]);
                           END;
                            }

    { 302 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[4];
                CaptionClass='1,2,4';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(4),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(4,ShortcutDimCode[4]);
                           END;
                            }

    { 304 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[5];
                CaptionClass='1,2,5';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(5),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(5,ShortcutDimCode[5]);
                           END;
                            }

    { 306 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[6];
                CaptionClass='1,2,6';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(6),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(6,ShortcutDimCode[6]);
                           END;
                            }

    { 308 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[7];
                CaptionClass='1,2,7';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(7),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(7,ShortcutDimCode[7]);
                           END;
                            }

    { 310 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[8];
                CaptionClass='1,2,8';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(8),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(8,ShortcutDimCode[8]);
                           END;
                            }

  }
  CODE
  {
    VAR
      ItemAvailFormsMgt@1000 : Codeunit 353;
      ShortcutDimCode@1001 : ARRAY [8] OF Code[20];
      DescriptionIndent@19057867 : Integer INDATASET;

    LOCAL PROCEDURE ShowComponents@1();
    VAR
      ProdOrderComp@1000 : Record 5407;
    BEGIN
      ProdOrderComp.SETRANGE(Status,Status);
      ProdOrderComp.SETRANGE("Prod. Order No.","Prod. Order No.");
      ProdOrderComp.SETRANGE("Prod. Order Line No.","Line No.");

      PAGE.RUN(PAGE::"Prod. Order Components",ProdOrderComp);
    END;

    PROCEDURE ShowTracking@4();
    VAR
      TrackingForm@1000 : Page 99000822;
    BEGIN
      TrackingForm.SetProdOrderLine(Rec);
      TrackingForm.RUNMODAL;
    END;

    LOCAL PROCEDURE ItemAvailability@8(AvailabilityType@1000 : Option);
    BEGIN
      ItemAvailFormsMgt.ShowItemAvailFromProdOrderLine(Rec,AvailabilityType);
    END;

    LOCAL PROCEDURE ShowReservationEntries@9();
    BEGIN
      ShowReservationEntries(TRUE);
    END;

    LOCAL PROCEDURE ShowProductionJournal@7();
    VAR
      ProdOrder@1000 : Record 5405;
      ProductionJrnlMgt@1001 : Codeunit 5510;
    BEGIN
      CurrPage.SAVERECORD;

      ProdOrder.GET(Status,"Prod. Order No.");

      CLEAR(ProductionJrnlMgt);
      ProductionJrnlMgt.Handling(ProdOrder,"Line No.");
    END;

    PROCEDURE UpdateForm@6(SetSaveRecord@1000 : Boolean);
    BEGIN
      CurrPage.UPDATE(SetSaveRecord);
    END;

    LOCAL PROCEDURE DescriptionOnFormat@19023855();
    BEGIN
      DescriptionIndent := "Planning Level Code";
    END;

    PROCEDURE PageShowReservation@16();
    BEGIN
      CurrPage.SAVERECORD;
      ShowReservation;
    END;

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 09.06.16 JAL The page is based on PAG 99000832 "Released Prod. Order Lines"
    }
    END.
  }
}

OBJECT Page 83050 OPC Role Center
{
  OBJECT-PROPERTIES
  {
    Date=02.11.17;
    Time=09:29:03;
    Modified=Yes;
    Version List=OPC6.01;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Role Center;
               NOR=Rollesenter];
    PageType=RoleCenter;
    ActionList=ACTIONS
    {
      { 1900000006;0 ;ActionContainer;
                      ActionContainerType=Reports }
      { 107     ;1   ;Action    ;
                      CaptionML=[ENU=Ro&uting Sheet;
                                 NOR=&Ruteark];
                      RunObject=Report 99000787;
                      Image=Report }
      { 109     ;1   ;Separator  }
      { 108     ;1   ;Action    ;
                      CaptionML=[ENU=Inventory - &Availability Plan;
                                 NOR=L&ager - disponeringsoversikt];
                      RunObject=Report 707;
                      Image=ItemAvailability }
      { 110     ;1   ;Action    ;
                      CaptionML=[ENU=&Planning Availability;
                                 NOR=&Disponeringsplanlegging];
                      RunObject=Report 99001048;
                      Image=Report }
      { 13      ;1   ;Action    ;
                      CaptionML=[ENU=&Capacity Task List;
                                 NOR=&Oversikt over kapasitetsoppgaver];
                      RunObject=Report 99000780;
                      Image=Report }
      { 18      ;1   ;Action    ;
                      CaptionML=[ENU=Subcontractor - &Dispatch List;
                                 NOR=&Servicefordeling - underleverand›r];
                      RunObject=Report 99000789;
                      Image=Report }
      { 111     ;1   ;Separator  }
      { 112     ;1   ;Action    ;
                      CaptionML=[ENU=Production Order - &Shortage List;
                                 NOR=&Produksjonsordre - mankoliste];
                      RunObject=Report 99000788;
                      Image=Report }
      { 49      ;1   ;Action    ;
                      CaptionML=[ENU=D&etailed Calculation;
                                 NOR=D&etaljert beregning];
                      RunObject=Report 99000756;
                      Image=Report }
      { 113     ;1   ;Separator  }
      { 114     ;1   ;Action    ;
                      CaptionML=[ENU=P&roduction Order - Calculation;
                                 NOR=Prod&uksjonsordre - beregning];
                      RunObject=Report 99000767;
                      Image=Report }
      { 115     ;1   ;Action    ;
                      CaptionML=[ENU=Sta&tus;
                                 NOR=S&tatus];
                      RunObject=Report 706;
                      Image=Report }
      { 116     ;1   ;Action    ;
                      CaptionML=[ENU=Inventory &Valuation WIP;
                                 NOR=&Lagerverdisetting - VIA];
                      RunObject=Report 5802;
                      Image=Report }
      { 1900000011;0 ;ActionContainer;
                      ActionContainerType=HomeItems }
      { 5       ;1   ;Action    ;
                      CaptionML=[ENU=Simulated Production Orders;
                                 NOR=Simulerte produksjonsordrer];
                      RunObject=Page 9323;
                      Visible=FALSE }
      { 7       ;1   ;Action    ;
                      CaptionML=[ENU=Planned Production Orders;
                                 NOR=Planlagte produksjonsordrer];
                      RunObject=Page 9324;
                      Visible=FALSE }
      { 9       ;1   ;Action    ;
                      CaptionML=[ENU=Firm Planned Production Orders;
                                 NOR=Fast planlagte produksjonsordrer];
                      RunObject=Page 9325 }
      { 12      ;1   ;Action    ;
                      CaptionML=[ENU=Released Production Orders;
                                 NOR=Frigitte produksjonsordrer];
                      RunObject=Page 9326 }
      { 10      ;1   ;Action    ;
                      CaptionML=[ENU=Finished Production Orders;
                                 NOR=Ferdige produksjonsordrer];
                      RunObject=Page 9327 }
      { 101     ;1   ;Action    ;
                      CaptionML=[ENU=Production Forecast;
                                 NOR=Produksjonsprognose];
                      RunObject=Page 99000921;
                      Visible=FALSE }
      { 102     ;1   ;Action    ;
                      CaptionML=[ENU=Blanket Sales Orders;
                                 NOR=Rammeordrer];
                      RunObject=Page 9303;
                      Visible=FALSE }
      { 14      ;1   ;Action    ;
                      CaptionML=[ENU=Sales Orders;
                                 NOR=Ordrer];
                      RunObject=Page 9305;
                      Visible=FALSE;
                      Image=Order }
      { 103     ;1   ;Action    ;
                      CaptionML=[ENU=Blanket Purchase Orders;
                                 NOR=Rammebestillinger];
                      RunObject=Page 9310;
                      Visible=FALSE }
      { 6       ;1   ;Action    ;
                      CaptionML=[ENU=Purchase Orders;
                                 NOR=Bestillinger];
                      RunObject=Page 9307;
                      Visible=FALSE }
      { 106     ;1   ;Action    ;
                      CaptionML=[ENU=Transfer Orders;
                                 NOR=Overf›ringsordrer];
                      RunObject=Page 5742;
                      Visible=FALSE;
                      Image=Document }
      { 3       ;1   ;Action    ;
                      CaptionML=[ENU=Vendors;
                                 NOR=Leverand›rer];
                      RunObject=Page 27;
                      Visible=FALSE;
                      Image=Vendor }
      { 17      ;1   ;Action    ;
                      Name=Items;
                      CaptionML=[ENU=Items;
                                 NOR=Varer];
                      RunObject=Page 31;
                      Image=Item }
      { 11      ;1   ;Action    ;
                      Name=ItemsProduced;
                      CaptionML=[ENU=Produced;
                                 NOR=Produsert];
                      RunObject=Page 31;
                      RunPageView=WHERE(Replenishment System=CONST(Prod. Order));
                      Visible=FALSE }
      { 94      ;1   ;Action    ;
                      Name=ItemsRawMaterials;
                      CaptionML=[ENU=Raw Materials;
                                 NOR=R†varer];
                      RunObject=Page 31;
                      RunPageView=WHERE(Low-Level Code=FILTER(>0),
                                        Replenishment System=CONST(Purchase),
                                        Production BOM No.=FILTER(=''));
                      Visible=FALSE }
      { 95      ;1   ;Action    ;
                      CaptionML=[ENU=Stockkeeping Units;
                                 NOR=Lagerf›ringsenheter];
                      RunObject=Page 5701;
                      Visible=FALSE;
                      Image=SKU }
      { 16      ;1   ;Action    ;
                      Name=ProductionBOMs;
                      CaptionML=[ENU=Production BOMs;
                                 NOR=Produksjonsstykklister];
                      RunObject=Page 99000787;
                      Visible=FALSE }
      { 63      ;1   ;Action    ;
                      Name=ProductionBOMsCertified;
                      CaptionML=[ENU=Certified;
                                 NOR=Sertifisert];
                      RunObject=Page 99000787;
                      RunPageView=WHERE(Status=CONST(Certified));
                      Visible=FALSE }
      { 83      ;1   ;Action    ;
                      CaptionML=[ENU=Routings;
                                 NOR=Ruter];
                      RunObject=Page 99000764;
                      Visible=FALSE }
      { 1900000012;0 ;ActionContainer;
                      ActionContainerType=ActivityButtons }
      { 19      ;1   ;ActionGroup;
                      CaptionML=[ENU=Journals;
                                 NOR=Kladder];
                      Visible=FALSE;
                      Image=Journals }
      { 22      ;2   ;Action    ;
                      Name=ItemJournals;
                      CaptionML=[ENU=Item Journals;
                                 NOR=Varekladder];
                      RunObject=Page 262;
                      RunPageView=WHERE(Template Type=CONST(Item),
                                        Recurring=CONST(No)) }
      { 23      ;2   ;Action    ;
                      Name=ItemReclassificationJournals;
                      CaptionML=[ENU=Item Reclassification Journals;
                                 NOR=Varereklassifiseringskladder];
                      RunObject=Page 262;
                      RunPageView=WHERE(Template Type=CONST(Transfer),
                                        Recurring=CONST(No)) }
      { 24      ;2   ;Action    ;
                      Name=RevaluationJournals;
                      CaptionML=[ENU=Revaluation Journals;
                                 NOR=Revalueringskladder];
                      RunObject=Page 262;
                      RunPageView=WHERE(Template Type=CONST(Revaluation),
                                        Recurring=CONST(No)) }
      { 20      ;1   ;ActionGroup;
                      CaptionML=[ENU=Worksheets;
                                 NOR=Forslag];
                      Visible=FALSE;
                      Image=Worksheets }
      { 33      ;2   ;Action    ;
                      Name=PlanningWorksheets;
                      CaptionML=[ENU=Planning Worksheets;
                                 NOR=Planleggingsforslag];
                      RunObject=Page 295;
                      RunPageView=WHERE(Template Type=CONST(Planning),
                                        Recurring=CONST(No)) }
      { 32      ;2   ;Action    ;
                      Name=RequisitionWorksheets;
                      CaptionML=[ENU=Requisition Worksheets;
                                 NOR=Bestillingsforslag];
                      RunObject=Page 295;
                      RunPageView=WHERE(Template Type=CONST(Req.),
                                        Recurring=CONST(No)) }
      { 34      ;2   ;Action    ;
                      Name=SubcontractingWorksheets;
                      CaptionML=[ENU=Subcontracting Worksheets;
                                 NOR=Underleveranseforslag];
                      RunObject=Page 295;
                      RunPageView=WHERE(Template Type=CONST(For. Labor),
                                        Recurring=CONST(No)) }
      { 35      ;2   ;Action    ;
                      CaptionML=[ENU=Standard Cost Worksheet;
                                 NOR=Standardkost - forslag];
                      RunObject=Page 5840 }
      { 2       ;1   ;ActionGroup;
                      CaptionML=[ENU=Product Design;
                                 NOR=Produktdesign];
                      Image=ProductDesign }
      { 15      ;2   ;Action    ;
                      Name=ProductionBOM;
                      CaptionML=[ENU=Production BOM;
                                 NOR=Produksjonsstykkliste];
                      RunObject=Page 99000787;
                      Image=BOM }
      { 25      ;2   ;Action    ;
                      Name=ProductionBOMCertified;
                      CaptionML=[ENU=Certified;
                                 NOR=Sertifisert];
                      RunObject=Page 99000787;
                      RunPageView=WHERE(Status=CONST(Certified)) }
      { 26      ;2   ;Action    ;
                      CaptionML=[ENU=Routings;
                                 NOR=Ruter];
                      RunObject=Page 99000764 }
      { 27      ;2   ;Action    ;
                      CaptionML=[ENU=Routing Links;
                                 NOR=Rutekoblinger];
                      RunObject=Page 99000798 }
      { 28      ;2   ;Action    ;
                      CaptionML=[ENU=Standard Tasks;
                                 NOR=Standardoppgaver];
                      RunObject=Page 99000799 }
      { 29      ;2   ;Action    ;
                      CaptionML=[ENU=Families;
                                 NOR=Familier];
                      RunObject=Page 99000791 }
      { 30      ;2   ;Action    ;
                      Name=ProdDesign_Items;
                      CaptionML=[ENU=Items;
                                 NOR=Varer];
                      RunObject=Page 31;
                      Image=Item }
      { 31      ;2   ;Action    ;
                      Name=ProdDesign_ItemsProduced;
                      CaptionML=[ENU=Produced;
                                 NOR=Produsert];
                      RunObject=Page 31;
                      RunPageView=WHERE(Replenishment System=CONST(Prod. Order)) }
      { 36      ;2   ;Action    ;
                      Name=ProdDesign_ItemsRawMaterials;
                      CaptionML=[ENU=Raw Materials;
                                 NOR=R†varer];
                      RunObject=Page 31;
                      RunPageView=WHERE(Low-Level Code=FILTER(>0),
                                        Replenishment System=CONST(Purchase)) }
      { 37      ;2   ;Action    ;
                      CaptionML=[ENU=Stockkeeping Units;
                                 NOR=Lagerf›ringsenheter];
                      RunObject=Page 5701;
                      Image=SKU }
      { 38      ;1   ;ActionGroup;
                      CaptionML=[ENU=Capacities;
                                 NOR=Kapasiteter];
                      Visible=FALSE;
                      Image=Capacities }
      { 39      ;2   ;Action    ;
                      Name=WorkCenters;
                      CaptionML=[ENU=Work Centers;
                                 NOR=Arbeidssentre];
                      RunObject=Page 99000755 }
      { 40      ;2   ;Action    ;
                      Name=WorkCentersInternal;
                      CaptionML=[ENU=Internal;
                                 NOR=Internt];
                      RunObject=Page 99000755;
                      RunPageView=WHERE(Subcontractor No.=FILTER(=''));
                      Image=Comment }
      { 41      ;2   ;Action    ;
                      Name=WorkCentersSubcontracted;
                      CaptionML=[ENU=Subcontracted;
                                 NOR=Underleveranse];
                      RunObject=Page 99000755;
                      RunPageView=WHERE(Subcontractor No.=FILTER(<>'')) }
      { 42      ;2   ;Action    ;
                      CaptionML=[ENU=Machine Centers;
                                 NOR=Produksjonsressurser];
                      RunObject=Page 99000761 }
      { 43      ;2   ;Action    ;
                      CaptionML=[ENU=Registered Absence;
                                 NOR=Registrert frav‘r];
                      RunObject=Page 99000920 }
      { 44      ;2   ;Action    ;
                      CaptionML=[ENU=Vendors;
                                 NOR=Leverand›rer];
                      RunObject=Page 27;
                      Image=Vendor }
      { 1       ;0   ;ActionContainer;
                      ActionContainerType=NewDocumentItems }
      { 53      ;1   ;Action    ;
                      CaptionML=[ENU=&Item;
                                 NOR=V&are];
                      RunObject=Page 30;
                      Promoted=No;
                      Image=Item;
                      PromotedCategory=Process;
                      RunPageMode=Create }
      { 52      ;1   ;Action    ;
                      CaptionML=[ENU=Production &Order;
                                 NOR=&Produksjonsordre];
                      RunObject=Page 99000813;
                      Promoted=No;
                      Image=Order;
                      PromotedCategory=Process;
                      RunPageMode=Create }
      { 51      ;1   ;Action    ;
                      CaptionML=[ENU=Production &BOM;
                                 NOR=Produksjonsst&ykkliste];
                      RunObject=Page 99000786;
                      Promoted=No;
                      Image=BOM;
                      PromotedCategory=Process;
                      RunPageMode=Create }
      { 50      ;1   ;Action    ;
                      CaptionML=[ENU=&Routing;
                                 NOR=&Ruteoversikt];
                      RunObject=Page 99000766;
                      Promoted=No;
                      Image=Route;
                      PromotedCategory=Process;
                      RunPageMode=Create }
      { 21      ;1   ;Action    ;
                      CaptionML=[ENU=&Purchase Order;
                                 NOR=&Bestilling];
                      RunObject=Page 50;
                      Promoted=No;
                      Image=Document;
                      PromotedCategory=Process;
                      RunPageMode=Create }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1101103000;1 ;Action    ;
                      Name=OPC Information Board;
                      CaptionML=[ENU=OPC Information Board;
                                 NOR=OPC Informasjonssentral];
                      RunObject=Page 83001;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Production;
                      PromotedCategory=Process }
      { 67      ;1   ;Separator ;
                      CaptionML=[ENU=Tasks;
                                 NOR=Oppgaver];
                      IsHeader=Yes }
      { 46      ;1   ;Action    ;
                      CaptionML=[ENU=Item &Journal;
                                 NOR=&Varekladd];
                      RunObject=Page 40;
                      Image=Journals }
      { 47      ;1   ;Action    ;
                      CaptionML=[ENU=Re&quisition Worksheet;
                                 NOR=Best&illingsforslag];
                      RunObject=Page 291;
                      Image=Worksheet }
      { 48      ;1   ;Action    ;
                      CaptionML=[ENU=Planning Works&heet;
                                 NOR=P&lanleggingsforslag];
                      RunObject=Page 99000852;
                      Image=PlanningWorksheet }
      { 4       ;1   ;Action    ;
                      CaptionML=[ENU=Item Availability by Timeline;
                                 NOR=Disponibelt per tidslinje];
                      RunObject=Page 5540;
                      Image=Timeline }
      { 8       ;1   ;Action    ;
                      CaptionML=[ENU=Subcontracting &Worksheet;
                                 NOR=Un&derleveranseforslag];
                      RunObject=Page 99000886;
                      Image=SubcontractingWorksheet }
      { 45      ;1   ;Separator  }
      { 122     ;1   ;Action    ;
                      CaptionML=[ENU=Change Pro&duction Order Status;
                                 NOR=&Endre produksjonsordrestatus];
                      RunObject=Page 99000914;
                      Visible=FALSE;
                      Image=ChangeStatus }
      { 123     ;1   ;Action    ;
                      CaptionML=[ENU=Order Pla&nning;
                                 NOR=&Ordreplanlegging];
                      RunObject=Page 5522;
                      Visible=FALSE;
                      Image=Planning }
      { 84      ;1   ;Separator ;
                      CaptionML=[ENU=Administration;
                                 NOR=Administrasjon];
                      IsHeader=Yes }
      { 124     ;1   ;Action    ;
                      CaptionML=[ENU=Order Promising S&etup;
                                 NOR=Oppse&tt for ordrebekreftelse];
                      RunObject=Page 99000958;
                      Visible=FALSE;
                      Image=OrderPromisingSetup }
      { 125     ;1   ;Action    ;
                      CaptionML=[ENU=&Manufacturing Setup;
                                 NOR=P&roduksjonsoppsett];
                      RunObject=Page 99000768;
                      Visible=FALSE;
                      Image=ProductionSetup }
      { 89      ;1   ;Separator ;
                      CaptionML=[ENU=History;
                                 NOR=Historikk];
                      IsHeader=Yes }
      { 126     ;1   ;Action    ;
                      CaptionML=[ENU=Item &Tracing;
                                 NOR=Vare&sporing];
                      RunObject=Page 6520;
                      Visible=FALSE;
                      Image=ItemTracing }
      { 90      ;1   ;Action    ;
                      CaptionML=[ENU=Navi&gate;
                                 NOR=&Naviger];
                      RunObject=Page 344;
                      Image=Navigate }
    }
  }
  CONTROLS
  {
    { 1900000008;0;Container;
                ContainerType=RoleCenterArea }

    { 1900724808;1;Group   }

    { 1905113808;2;Part   ;
                PagePartID=Page83051;
                PartType=Page }

    { 1000000001;2;Part   ;
                Name=OPC - melding p† info.sentral;
                PagePartID=Page83003;
                UpdatePropagation=Both }

    { 1900724708;1;Group  ;
                Visible=false }

    { 54  ;2   ;Part      ;
                PagePartID=Page675;
                Visible=false;
                PartType=Page }

    { 1905989608;2;Part   ;
                PagePartID=Page9152;
                PartType=Page }

    { 55  ;2   ;Part      ;
                PagePartID=Page681;
                PartType=Page }

    { 1903012608;2;Part   ;
                PagePartID=Page9175;
                PartType=Page }

    { 1901377608;2;Part   ;
                PartType=System;
                SystemPartID=MyNotes }

  }
  CODE
  {

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 28.09.17 JAL Created
    }
    END.
  }
}

OBJECT Page 83051 OPC Activities
{
  OBJECT-PROPERTIES
  {
    Date=01.11.17;
    Time=22:50:22;
    Modified=Yes;
    Version List=OPC6.01;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Activities;
               NOR=Aktiviteter];
    SourceTable=Table83013;
    PageType=CardPart;
    OnOpenPage=BEGIN
                 RESET;
                 IF NOT GET THEN BEGIN
                   INIT;
                   INSERT;
                 END;

                 //SETRANGE("User ID Filter", USERID);
               END;

  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 2   ;1   ;Group     ;
                CaptionML=[ENU=OPC;
                           NOR=OPC];
                GroupType=CueGroup;
                ActionList=ACTIONS
                {
                  { 21      ;0   ;Action    ;
                                  CaptionML=[ENU=Change Production Order Status;
                                             NOR=Endre produksjonsordrestatus];
                                  RunObject=Page 99000914;
                                  Visible=False;
                                  Image=ChangeStatus }
                  { 12      ;0   ;Action    ;
                                  CaptionML=[ENU=New Production Order;
                                             NOR=Ny produksjonsordre];
                                  RunObject=Page 99000813;
                                  Visible=False;
                                  RunPageMode=Create }
                  { 28      ;0   ;Action    ;
                                  CaptionML=[ENU=Navigate;
                                             NOR=Naviger];
                                  RunObject=Page 344;
                                  Image=Navigate }
                  { 1101103001;  ;Action    ;
                                  Name=OPC - Information board;
                                  CaptionML=[ENU=OPC - Information board;
                                             NOR=OPC Informasjonssentral];
                                  RunObject=Page 83001;
                                  Promoted=Yes;
                                  PromotedIsBig=Yes;
                                  Image=Production;
                                  PromotedCategory=Process }
                  { 1101103002;0 ;Action    ;
                                  Name=Time Registration;
                                  CaptionML=[ENU=Time Registration;
                                             NOR=M›nstring];
                                  RunObject=Page 83017;
                                  Promoted=Yes;
                                  PromotedIsBig=Yes;
                                  Image=Timesheet;
                                  PromotedCategory=Process }
                }
                 }

    { 1   ;2   ;Field     ;
                SourceExpr="Resource Status";
                DrillDownPageID=OPC Machine Center Status }

    { 5   ;2   ;Field     ;
                SourceExpr="Production Order- Released";
                DrillDownPageID=Released Production Orders }

    { 1101103000;2;Field  ;
                SourceExpr="Firm planned tasks";
                DrillDownPageID=OPC Firm Planned Tasks }

  }
  CODE
  {

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 28.09.17 JAL Created
    }
    END.
  }
}

OBJECT Page 83052 OPC Order Processor Role
{
  OBJECT-PROPERTIES
  {
    Date=01.11.17;
    Time=22:59:16;
    Modified=Yes;
    Version List=NAVW110.00,OPC6.01;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Role Center;
               NOR=Rollesenter];
    PageType=RoleCenter;
    ActionList=ACTIONS
    {
      { 1900000011;0 ;ActionContainer;
                      ToolTipML=[ENU=Manage sales processes. See KPIs and your favorite items and customers.;
                                 NOR=Behandle salgsprosesser. Se KPIer og dine favorittvarer og -kunder.];
                      ActionContainerType=HomeItems }
      { 23      ;1   ;Action    ;
                      CaptionML=[ENU=Items;
                                 NOR=Varer];
                      ToolTipML=[ENU=Open the list of items that you trade in.;
                                 NOR=pne listen over varer du handler i.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 31;
                      Image=Item }
      { 3       ;1   ;Action    ;
                      CaptionML=[ENU=Item Journals;
                                 NOR=Varekladder];
                      ToolTipML=[ENU=Open a list of journals where you can adjust the physical quantity of items on inventory.;
                                 NOR=pne en liste over kladder der du kan justere det fysiske antallet for varer p† lager.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 262;
                      RunPageView=WHERE(Template Type=CONST(Item),
                                        Recurring=CONST(No)) }
      { 1000000007;1 ;Action    ;
                      Name=Page Bestillinger;
                      CaptionML=[ENU=Purchase Orders;
                                 NOR=Bestillinger];
                      RunObject=Page 53 }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 35      ;1   ;ActionGroup;
                      CaptionML=[ENU=Tasks;
                                 NOR=Oppgaver] }
      { 1000000001;2 ;Action    ;
                      Name=Page Req. Worksheet;
                      CaptionML=[ENU=Req. worksheet MT;
                                 NOR=Bestillingsforslag];
                      RunObject=Page 291;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Worksheet;
                      PromotedCategory=Process }
      { 1000000000;2 ;Action    ;
                      Name=Page Phys. Inventory Wrksheet;
                      CaptionML=[ENU=Phys. Inventory Wksht_MT;
                                 NOR=Vareopptellingskladd];
                      RunObject=Page 392;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PhysicalInventory;
                      PromotedCategory=Process }
    }
  }
  CONTROLS
  {
    { 1900000008;0;Container;
                ContainerType=RoleCenterArea }

    { 1900724808;1;Group   }

    { 1901851508;2;Part   ;
                AccessByPermission=TableData 110=R;
                ApplicationArea=#Basic,#Suite;
                PagePartID=Page9060;
                PartType=Page }

    { 14  ;2   ;Part      ;
                ApplicationArea=#Suite;
                PagePartID=Page9042;
                PartType=Page }

    { 1907692008;2;Part   ;
                ApplicationArea=#Basic,#Suite;
                PagePartID=Page9150;
                PartType=Page }

    { 13  ;2   ;Part      ;
                ApplicationArea=#Basic,#Suite;
                PagePartID=Page6303;
                PartType=Page }

    { 1900724708;1;Group   }

    { 1   ;2   ;Part      ;
                AccessByPermission=TableData 110=R;
                ApplicationArea=#Basic,#Suite;
                PagePartID=Page760;
                PartType=Page }

    { 4   ;2   ;Part      ;
                PagePartID=Page675;
                Visible=false;
                PartType=Page }

    { 1905989608;2;Part   ;
                AccessByPermission=TableData 9152=R;
                ApplicationArea=#Basic,#Suite;
                PagePartID=Page9152;
                PartType=Page }

    { 21  ;2   ;Part      ;
                AccessByPermission=TableData 477=R;
                ApplicationArea=#Suite;
                PagePartID=Page681;
                PartType=Page }

    { 1903012608;2;Part   ;
                PagePartID=Page9175;
                Visible=FALSE;
                PartType=Page }

    { 1901377608;2;Part   ;
                PartType=System;
                SystemPartID=MyNotes }

  }
  CODE
  {

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 31.01.17 JAL Added the Action "Posted Purchase Credit Memos"
    }
    END.
  }
}

OBJECT Page 83104 OPC Prod. Order Routing
{
  OBJECT-PROPERTIES
  {
    Date=20.09.17;
    Time=15:17:38;
    Modified=Yes;
    Version List=NAVW110.00,OPC6.02;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=OPC Prod. Order Routing;
               NOR=OPC Prod.ordrerute];
    SourceTable=Table5409;
    DataCaptionExpr=Caption;
    PageType=List;
    OnInit=BEGIN
             ProdOrderNoVisible := TRUE;
           END;

    OnOpenPage=BEGIN
                 ProdOrderNoVisible := TRUE;
                 IF GETFILTER("Prod. Order No.") <> '' THEN
                   ProdOrderNoVisible := GETRANGEMIN("Prod. Order No.") <> GETRANGEMAX("Prod. Order No.");
               END;

    OnDeleteRecord=BEGIN
                     CheckPreviousAndNext;
                   END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 30      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Line;
                                 NOR=&Linje];
                      Image=Line }
      { 21      ;2   ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 NOR=&Merknader];
                      RunObject=Page 99000840;
                      RunPageLink=Status=FIELD(Status),
                                  Prod. Order No.=FIELD(Prod. Order No.),
                                  Routing Reference No.=FIELD(Routing Reference No.),
                                  Routing No.=FIELD(Routing No.),
                                  Operation No.=FIELD(Operation No.);
                      Image=ViewComments }
      { 29      ;2   ;Action    ;
                      CaptionML=[ENU=Tools;
                                 NOR=Verkt›y];
                      RunObject=Page 99000844;
                      RunPageLink=Status=FIELD(Status),
                                  Prod. Order No.=FIELD(Prod. Order No.),
                                  Routing Reference No.=FIELD(Routing Reference No.),
                                  Routing No.=FIELD(Routing No.),
                                  Operation No.=FIELD(Operation No.);
                      Image=Tools }
      { 37      ;2   ;Action    ;
                      CaptionML=[ENU=Personnel;
                                 NOR=Personell];
                      RunObject=Page 99000845;
                      RunPageLink=Status=FIELD(Status),
                                  Prod. Order No.=FIELD(Prod. Order No.),
                                  Routing Reference No.=FIELD(Routing Reference No.),
                                  Routing No.=FIELD(Routing No.),
                                  Operation No.=FIELD(Operation No.);
                      Image=User }
      { 38      ;2   ;Action    ;
                      CaptionML=[ENU=Quality Measures;
                                 NOR=Kvalitetsm†l];
                      RunObject=Page 99000834;
                      RunPageLink=Status=FIELD(Status),
                                  Prod. Order No.=FIELD(Prod. Order No.),
                                  Routing Reference No.=FIELD(Routing Reference No.),
                                  Routing No.=FIELD(Routing No.),
                                  Operation No.=FIELD(Operation No.);
                      Image=TaskQualityMeasure }
      { 56      ;2   ;Separator  }
      { 57      ;2   ;Action    ;
                      CaptionML=[ENU=Allocated Capacity;
                                 NOR=Kapasitetstildeling];
                      Image=AllocatedCapacity;
                      OnAction=VAR
                                 ProdOrderCapNeed@1001 : Record 5410;
                               BEGIN
                                 IF Status = Status::Finished THEN
                                   EXIT;
                                 ProdOrderCapNeed.SETCURRENTKEY(Type,"No.","Starting Date-Time");
                                 ProdOrderCapNeed.SETRANGE(Type,Type);
                                 ProdOrderCapNeed.SETRANGE("No.","No.");
                                 ProdOrderCapNeed.SETRANGE(Date,"Starting Date","Ending Date");
                                 ProdOrderCapNeed.SETRANGE("Prod. Order No.","Prod. Order No.");
                                 ProdOrderCapNeed.SETRANGE(Status,Status);
                                 ProdOrderCapNeed.SETRANGE("Routing Reference No.","Routing Reference No.");
                                 ProdOrderCapNeed.SETRANGE("Operation No.","Operation No.");

                                 PAGE.RUNMODAL(0,ProdOrderCapNeed);
                               END;
                                }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 20      ;1   ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 NOR=F&unksjoner];
                      Image=Action }
      { 39      ;2   ;Action    ;
                      CaptionML=[ENU=Order &Tracking;
                                 NOR=&Sporing];
                      Image=OrderTracking;
                      OnAction=VAR
                                 ProdOrderLine@1001 : Record 5406;
                                 TrackingForm@1002 : Page 99000822;
                               BEGIN
                                 ProdOrderLine.SETRANGE(Status,Status);
                                 ProdOrderLine.SETRANGE("Prod. Order No.","Prod. Order No.");
                                 ProdOrderLine.SETRANGE("Routing No.","Routing No.");
                                 IF ProdOrderLine.FINDFIRST THEN BEGIN
                                   TrackingForm.SetProdOrderLine(ProdOrderLine);
                                   TrackingForm.RUNMODAL;
                                 END;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 68  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the production order that this operation is assigned to.;
                           NOR=Angir nummeret p† produksjonsordren som operasjonen er tilordnet.];
                SourceExpr="Prod. Order No.";
                Visible=ProdOrderNoVisible }

    { 58  ;2   ;Field     ;
                ToolTipML=[ENU=Recalculates the underlying capacity need each time a change is made in the schedule of the routing.;
                           NOR=Beregner det underliggende kapasitetsbehovet p† nytt hver gang ruteplanen endres.];
                SourceExpr="Schedule Manually";
                Visible=FALSE }

    { 2   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the operation number.;
                           NOR=Angir operasjonsnummeret.];
                SourceExpr="Operation No." }

    { 22  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the previous operation number.;
                           NOR=Angir det forrige operasjonsnummeret.];
                SourceExpr="Previous Operation No.";
                Visible=FALSE }

    { 18  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the next operation number.;
                           NOR=Angir det neste operasjonsnummeret.];
                SourceExpr="Next Operation No.";
                Visible=FALSE }

    { 4   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the type of operation.;
                           NOR=Angir operasjonstypen.];
                SourceExpr=Type }

    { 6   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a work center number or a machine number, depending on the entry in the Type field.;
                           NOR=Angir nummeret for arbeidssenter eller produksjonsressurs, avhengig av hva som er angitt i feltet Type.];
                SourceExpr="No." }

    { 8   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the description of the operation.;
                           NOR=Angir beskrivelsen av den †pne operasjonen.];
                SourceExpr=Description }

    { 48  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a flushing method for this production order routing line.;
                           NOR=Angir en trekkmetode for produksjonsordrerutelinjen.];
                SourceExpr="Flushing Method";
                Visible=FALSE }

    { 42  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the starting date and the starting time, which are combined in a format called "starting date-time".;
                           NOR=Angir startdatoen og starttidspunktet som er kombinert i et format som kalles "Startdato-tidsp.".];
                SourceExpr="Starting Date-Time" }

    { 10  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the starting time of the routing line (operation).;
                           NOR=Angir starttidspunktet for rutelinjen (operasjonen).];
                SourceExpr="Starting Time";
                Visible=FALSE;
                OnValidate=BEGIN
                             StartingTimeOnAfterValidate;
                           END;
                            }

    { 12  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the starting date of the routing line (operation).;
                           NOR=Angir startdato for rutelinjen (operasjonen).];
                SourceExpr="Starting Date";
                Visible=FALSE;
                OnValidate=BEGIN
                             StartingDateOnAfterValidate;
                           END;
                            }

    { 50  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the ending date and the ending time, which are combined in a format called "ending date-time".;
                           NOR=Angir sluttdatoen og sluttidspunktet som er kombinert i et format som kalles "Sluttdato-tidsp.".];
                SourceExpr="Ending Date-Time" }

    { 14  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the ending time of the routing line (operation).;
                           NOR=Angir sluttidspunktet for rutelinjen (operasjonen).];
                SourceExpr="Ending Time";
                Visible=FALSE;
                OnValidate=BEGIN
                             EndingTimeOnAfterValidate;
                           END;
                            }

    { 16  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the ending date of the routing line (operation).;
                           NOR=Angir sluttdato for rutelinjen (operasjonen).];
                SourceExpr="Ending Date";
                Visible=FALSE;
                OnValidate=BEGIN
                             EndingDateOnAfterValidate;
                           END;
                            }

    { 24  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the setup time of the operation.;
                           NOR=Angir oppstillingstiden for operasjonen.];
                SourceExpr="Setup Time" }

    { 31  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the run time of the operation.;
                           NOR=Angir operasjonstiden for operasjonen.];
                SourceExpr="Run Time" }

    { 33  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the wait time after processing.;
                           NOR=Angir ventetiden etter behandlingen.];
                SourceExpr="Wait Time" }

    { 35  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the move time.;
                           NOR=Angir transporttiden.];
                SourceExpr="Move Time" }

    { 40  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the fixed scrap quantity.;
                           NOR=Angir det faste vrakantallet.];
                SourceExpr="Fixed Scrap Quantity";
                Visible=FALSE }

    { 70  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a routing link code.;
                           NOR=Angir en rutekoblingskode.];
                SourceExpr="Routing Link Code";
                Visible=FALSE }

    { 43  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the scrap factor in percent.;
                           NOR=Angir vrakfaktoren i prosent.];
                SourceExpr="Scrap Factor %";
                Visible=FALSE }

    { 54  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the send-ahead quantity of the operation.;
                           NOR=Angir overlappantall for operasjonen.];
                SourceExpr="Send-Ahead Quantity";
                Visible=FALSE }

    { 52  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the con capacity of the operation.;
                           NOR=Angir forbrukskapasitet for operasjonen.];
                SourceExpr="Concurrent Capacities";
                Visible=FALSE }

    { 60  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the Unit Cost per.;
                           NOR=Angir Enhetskost per.];
                SourceExpr="Unit Cost per";
                Visible=FALSE }

    { 62  ;2   ;Field     ;
                ToolTipML=[ENU=Automatically calculates a value based on the capacity need, when a production order is refreshed or replanned.;
                           NOR=Beregner automatisk verdien basert p† kapasitetsbehovet ved oppdatering eller ny planlegging av en produksjonsordre.];
                SourceExpr="Expected Operation Cost Amt.";
                Visible=FALSE }

    { 64  ;2   ;Field     ;
                ToolTipML=[ENU=Automatically calculates a value based on the capacity need, when a production order is refreshed or replanned.;
                           NOR=Beregner automatisk verdien basert p† kapasitetsbehovet ved oppdatering eller ny planlegging av en produksjonsordre.];
                SourceExpr="Expected Capacity Ovhd. Cost";
                Visible=FALSE }

    { 66  ;2   ;Field     ;
                Name=Expected Capacity Need;
                CaptionML=[ENU=Expected Capacity Need;
                           NOR=Forventet kapasitetsbehov];
                DecimalPlaces=0:5;
                SourceExpr="Expected Capacity Need" / ExpCapacityNeed;
                Visible=FALSE }

    { 45  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the status of the routing line, such as Planned, In Progress, or Finished.;
                           NOR=Angir status for rutelinjen, for eksempel Planlagt, I arbeid eller Ferdig.];
                SourceExpr="Routing Status";
                Visible=FALSE }

    { 78  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the location where the machine or work center on the production order routing line operates.;
                           NOR=Angir lokasjonen der produksjonsressursen eller arbeidssenteret p† produksjonsordrerutelinjen opererer.];
                SourceExpr="Location Code";
                Visible=FALSE }

    { 72  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the corresponding bin at the machine or work center, if the location code matches the setup of that machine or work center.;
                           NOR=Angir den tilsvarende hyllen p† produksjonsressursen eller arbeidssenteret hvis lokasjonskoden samsvarer med oppsettet for produksjonsressursen eller arbeidssenteret.];
                SourceExpr="Open Shop Floor Bin Code";
                Visible=FALSE }

    { 74  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the bin that holds components with a flushing method, that involves a warehouse activity to bring the items to the bin.;
                           NOR=Angir hyllen som har komponenter med en trekkmetode som omfatter en lageraktivitet for † plassere varene p† hyllen.];
                SourceExpr="To-Production Bin Code";
                Visible=FALSE }

    { 76  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the corresponding bin at the machine or work center if the location code matches the setup of that machine or work center.;
                           NOR=Angir den tilsvarende hyllen p† produksjonsressursen eller arbeidssenteret hvis lokasjonskoden samsvarer med oppsettet for produksjonsressursen eller arbeidssenteret.];
                SourceExpr="From-Production Bin Code";
                Visible=FALSE }

    { 1101103000;2;Field  ;
                SourceExpr="Scrap Quantity" }

    { 1101103001;2;Field  ;
                SourceExpr="Minimum Starting Date" }

    { 1101103002;2;Field  ;
                SourceExpr="Minimum Starting Time" }

    { 1101103003;2;Field  ;
                SourceExpr="Output Quantity" }

    { 1101103004;2;Field  ;
                SourceExpr="Queue time (minutes)" }

    { 1101103005;2;Field  ;
                SourceExpr="Dokument Link" }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      ProdOrderNoVisible@19039876 : Boolean INDATASET;

    LOCAL PROCEDURE ExpCapacityNeed@2() : Decimal;
    VAR
      WorkCenter@1001 : Record 99000754;
      CalendarMgt@1000 : Codeunit 99000755;
    BEGIN
      IF "Work Center No." = '' THEN
        EXIT(1);
      WorkCenter.GET("Work Center No.");
      EXIT(CalendarMgt.TimeFactor(WorkCenter."Unit of Measure Code"));
    END;

    LOCAL PROCEDURE StartingTimeOnAfterValidate@19008557();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE StartingDateOnAfterValidate@19020273();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE EndingTimeOnAfterValidate@19075483();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE EndingDateOnAfterValidate@19076447();
    BEGIN
      CurrPage.UPDATE;
    END;

    PROCEDURE Initialize@1(NewCaption@1000 : Text);
    BEGIN
      CurrPage.CAPTION(NewCaption);
    END;

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 16.12.09 HHE Fremvist "Tilknyttet dokument" (OPC)
      02. 11.08.17 JAL Copy of the PAGE 99000817 "Prod. Order Routing"
    }
    END.
  }
}

OBJECT Page 83105 OPC Capacity Ledger Entry
{
  OBJECT-PROPERTIES
  {
    Date=28.09.17;
    Time=09:52:04;
    Modified=Yes;
    Version List=OPC6.01;
  }
  PROPERTIES
  {
    CaptionML=[ENU=OPC Capacity Ledger Entry;
               NOR=OPC kapasitetsposter];
    SaveValues=Yes;
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=No;
    LinksAllowed=No;
    SourceTable=Table99000758;
    DataCaptionExpr='';
    PageType=ListPlus;
    OnOpenPage=BEGIN
                 MATRIX_GenerateColumnCaptions(SetWanted::Initial);
                 UpdateMatrixSubform;
               END;

    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1102601014;1 ;Action    ;
                      Name=Previous Set;
                      CaptionML=[ENU=Previous Set;
                                 NOR=Forrige sett];
                      ToolTipML=[ENU=Go to the previous set of data.;
                                 NOR=G† til forrige datasett.];
                      ApplicationArea=#Jobs;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PreviousSet;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 MATRIX_GenerateColumnCaptions(SetWanted::Previus);
                                 UpdateMatrixSubform;
                               END;
                                }
      { 5       ;1   ;Action    ;
                      Name=Next Set;
                      CaptionML=[ENU=Next Set;
                                 NOR=Neste sett];
                      ToolTipML=[ENU=Go to the next set of data.;
                                 NOR=G† til neste datasett.];
                      ApplicationArea=#Jobs;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=NextSet;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 MATRIX_GenerateColumnCaptions(SetWanted::Next);
                                 UpdateMatrixSubform;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=[ENU=Matrix Options;
                           NOR=Matrisealternativer] }

    { 6   ;2   ;Field     ;
                CaptionML=[ENU=View by;
                           NOR=Vis etter];
                ToolTipML=[ENU=Specifies by which period amounts are displayed.;
                           NOR=Angir hvilken periode bel›p vises basert p†.];
                OptionCaptionML=[ENU=Day,Week,Month,Quarter,Year,Accounting Period;
                                 NOR=Dag,Uke,M†ned,Kvartal,r,Regnskapsperiode];
                ApplicationArea=#Jobs;
                SourceExpr=PeriodType;
                OnValidate=BEGIN
                             MATRIX_GenerateColumnCaptions(SetWanted::Initial);
                             UpdateMatrixSubform;
                           END;
                            }

    { 1102601000;1;Part   ;
                Name=MatrixForm;
                PagePartID=Page83106 }

  }
  CODE
  {
    VAR
      MATRIX_MatrixRecords@1101103010 : ARRAY [32] OF Record 2000000007;
      MatrixMgt@1101103009 : Codeunit 9200;
      MATRIX_CaptionSet@1101103008 : ARRAY [32] OF Text[1024];
      MATRIX_CaptionRange@1101103007 : Text[1024];
      MATRIX_PrimKeyFirstCaptionInCu@1101103006 : Text[1024];
      MATRIX_CurrentNoOfColumns@1101103005 : Integer;
      MATRIX_UseNameForCaption@1101103004 : Boolean;
      MATRIX_DateFilter@1101103003 : Text[1024];
      MATRIX_CurrentSetLenght@1101103002 : Integer;
      PeriodType@1101103001 : 'Day,Week,Month,Quarter,Year,Accounting Period';
      SetWanted@1101103000 : 'Initial,Previus,Same,Next';

    LOCAL PROCEDURE MATRIX_GenerateColumnCaptions@1106(SetWanted@1000 : 'Initial,Previus,Same,Next');
    BEGIN
      MatrixMgt.GeneratePeriodMatrixData(SetWanted,ARRAYLEN(MATRIX_CaptionSet),MATRIX_UseNameForCaption,PeriodType,MATRIX_DateFilter,
        MATRIX_PrimKeyFirstCaptionInCu,MATRIX_CaptionSet,MATRIX_CaptionRange,MATRIX_CurrentSetLenght,MATRIX_MatrixRecords
        );
    END;

    LOCAL PROCEDURE UpdateMatrixSubform@1102601000();
    BEGIN
      //CurrPage.MatrixForm.PAGE.Load(QtyType,MatrixColumnCaptions,MatrixRecords,CurrSetLength);
      CurrPage.MatrixForm.PAGE.Load(MATRIX_CaptionSet,MATRIX_MatrixRecords,MATRIX_CurrentSetLenght);
      CurrPage.UPDATE(FALSE);
    END;

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 14.08.17 JAL Based on PAG99000770 "Machine Center Calendar"
    }
    END.
  }
}

OBJECT Page 83106 OPC Cap.Ledger Entry Matrix
{
  OBJECT-PROPERTIES
  {
    Date=27.09.17;
    Time=13:50:58;
    Modified=Yes;
    Version List=OPC6.01;
  }
  PROPERTIES
  {
    CaptionML=[ENU=OPC Cap. Ledger Entry;
               NOR=OPC Bokf. kapasitetsposter];
    SaveValues=Yes;
    InsertAllowed=No;
    DeleteAllowed=No;
    SourceTable=Table99000758;
    PageType=ListPart;
    OnOpenPage=BEGIN
                 MATRIX_CurrentNoOfMatrixColumn := ARRAYLEN(MATRIX_CaptionSet);
               END;

    OnAfterGetRecord=VAR
                       MATRIX_CurrentColumnOrdinal@1101103000 : Integer;
                     BEGIN
                       MATRIX_CurrentColumnOrdinal := 0;
                       WHILE MATRIX_CurrentColumnOrdinal < MATRIX_CurrentNoOfMatrixColumn DO BEGIN
                         MATRIX_CurrentColumnOrdinal := MATRIX_CurrentColumnOrdinal + 1;
                         MATRIX_OnAfterGetRecord(MATRIX_CurrentColumnOrdinal);
                       END;
                     END;

  }
  CONTROLS
  {
    { 1101103035;0;Container;
                ContainerType=ContentArea }

    { 1101103034;1;Group  ;
                GroupType=Repeater }

    { 1101103033;2;Field  ;
                ToolTipML=[ENU=Specifies the number of the machine center.;
                           NOR=Angir nummeret p† produksjonsressursen.];
                SourceExpr="No." }

    { 1101103032;2;Field  ;
                ToolTipML=[ENU=Specifies a name for the machine center.;
                           NOR=Angir et navn for produksjonsressursen.];
                SourceExpr=Name }

    { 1101103031;2;Field  ;
                Name=Field1;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[1];
                CaptionClass='3,' + MATRIX_CaptionSet[1];
                OnDrillDown=BEGIN
                              MATRIX_OnDrillDown(1);
                            END;
                             }

    { 1101103030;2;Field  ;
                Name=Field2;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[2];
                CaptionClass='3,' + MATRIX_CaptionSet[2];
                OnDrillDown=BEGIN
                              MATRIX_OnDrillDown(2);
                            END;
                             }

    { 1101103029;2;Field  ;
                Name=Field3;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[3];
                CaptionClass='3,' + MATRIX_CaptionSet[3];
                OnDrillDown=BEGIN
                              MATRIX_OnDrillDown(3);
                            END;
                             }

    { 1101103028;2;Field  ;
                Name=Field4;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[4];
                CaptionClass='3,' + MATRIX_CaptionSet[4];
                OnDrillDown=BEGIN
                              MATRIX_OnDrillDown(4);
                            END;
                             }

    { 1101103027;2;Field  ;
                Name=Field5;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[5];
                CaptionClass='3,' + MATRIX_CaptionSet[5];
                OnDrillDown=BEGIN
                              MATRIX_OnDrillDown(5);
                            END;
                             }

    { 1101103026;2;Field  ;
                Name=Field6;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[6];
                CaptionClass='3,' + MATRIX_CaptionSet[6];
                OnDrillDown=BEGIN
                              MATRIX_OnDrillDown(6);
                            END;
                             }

    { 1101103025;2;Field  ;
                Name=Field7;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[7];
                CaptionClass='3,' + MATRIX_CaptionSet[7];
                OnDrillDown=BEGIN
                              MATRIX_OnDrillDown(7);
                            END;
                             }

    { 1101103024;2;Field  ;
                Name=Field8;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[8];
                CaptionClass='3,' + MATRIX_CaptionSet[8];
                OnDrillDown=BEGIN
                              MATRIX_OnDrillDown(8);
                            END;
                             }

    { 1101103023;2;Field  ;
                Name=Field9;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[9];
                CaptionClass='3,' + MATRIX_CaptionSet[9];
                OnDrillDown=BEGIN
                              MATRIX_OnDrillDown(9);
                            END;
                             }

    { 1101103022;2;Field  ;
                Name=Field10;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[10];
                CaptionClass='3,' + MATRIX_CaptionSet[10];
                OnDrillDown=BEGIN
                              MATRIX_OnDrillDown(10);
                            END;
                             }

    { 1101103021;2;Field  ;
                Name=Field11;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[11];
                CaptionClass='3,' + MATRIX_CaptionSet[11];
                OnDrillDown=BEGIN
                              MATRIX_OnDrillDown(11);
                            END;
                             }

    { 1101103020;2;Field  ;
                Name=Field12;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[12];
                CaptionClass='3,' + MATRIX_CaptionSet[12];
                OnDrillDown=BEGIN
                              MATRIX_OnDrillDown(12);
                            END;
                             }

    { 1101103019;2;Field  ;
                Name=Field13;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[13];
                CaptionClass='3,' + MATRIX_CaptionSet[13];
                OnDrillDown=BEGIN
                              MATRIX_OnDrillDown(13);
                            END;
                             }

    { 1101103018;2;Field  ;
                Name=Field14;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[14];
                CaptionClass='3,' + MATRIX_CaptionSet[14];
                OnDrillDown=BEGIN
                              MATRIX_OnDrillDown(14);
                            END;
                             }

    { 1101103017;2;Field  ;
                Name=Field15;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[15];
                CaptionClass='3,' + MATRIX_CaptionSet[15];
                OnDrillDown=BEGIN
                              MATRIX_OnDrillDown(15);
                            END;
                             }

    { 1101103016;2;Field  ;
                Name=Field16;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[16];
                CaptionClass='3,' + MATRIX_CaptionSet[16];
                OnDrillDown=BEGIN
                              MATRIX_OnDrillDown(16);
                            END;
                             }

    { 1101103015;2;Field  ;
                Name=Field17;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[17];
                CaptionClass='3,' + MATRIX_CaptionSet[17];
                OnDrillDown=BEGIN
                              MATRIX_OnDrillDown(17);
                            END;
                             }

    { 1101103014;2;Field  ;
                Name=Field18;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[18];
                CaptionClass='3,' + MATRIX_CaptionSet[18];
                OnDrillDown=BEGIN
                              MATRIX_OnDrillDown(18);
                            END;
                             }

    { 1101103013;2;Field  ;
                Name=Field19;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[19];
                CaptionClass='3,' + MATRIX_CaptionSet[19];
                OnDrillDown=BEGIN
                              MATRIX_OnDrillDown(19);
                            END;
                             }

    { 1101103012;2;Field  ;
                Name=Field20;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[20];
                CaptionClass='3,' + MATRIX_CaptionSet[20];
                OnDrillDown=BEGIN
                              MATRIX_OnDrillDown(20);
                            END;
                             }

    { 1101103011;2;Field  ;
                Name=Field21;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[21];
                CaptionClass='3,' + MATRIX_CaptionSet[21];
                OnDrillDown=BEGIN
                              MATRIX_OnDrillDown(21);
                            END;
                             }

    { 1101103010;2;Field  ;
                Name=Field22;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[22];
                CaptionClass='3,' + MATRIX_CaptionSet[22];
                OnDrillDown=BEGIN
                              MATRIX_OnDrillDown(22);
                            END;
                             }

    { 1101103009;2;Field  ;
                Name=Field23;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[23];
                CaptionClass='3,' + MATRIX_CaptionSet[23];
                OnDrillDown=BEGIN
                              MATRIX_OnDrillDown(23);
                            END;
                             }

    { 1101103008;2;Field  ;
                Name=Field24;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[24];
                CaptionClass='3,' + MATRIX_CaptionSet[24];
                OnDrillDown=BEGIN
                              MATRIX_OnDrillDown(24);
                            END;
                             }

    { 1101103007;2;Field  ;
                Name=Field25;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[25];
                CaptionClass='3,' + MATRIX_CaptionSet[25];
                OnDrillDown=BEGIN
                              MATRIX_OnDrillDown(25);
                            END;
                             }

    { 1101103006;2;Field  ;
                Name=Field26;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[26];
                CaptionClass='3,' + MATRIX_CaptionSet[26];
                OnDrillDown=BEGIN
                              MATRIX_OnDrillDown(26);
                            END;
                             }

    { 1101103005;2;Field  ;
                Name=Field27;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[27];
                CaptionClass='3,' + MATRIX_CaptionSet[27];
                OnDrillDown=BEGIN
                              MATRIX_OnDrillDown(27);
                            END;
                             }

    { 1101103004;2;Field  ;
                Name=Field28;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[28];
                CaptionClass='3,' + MATRIX_CaptionSet[28];
                OnDrillDown=BEGIN
                              MATRIX_OnDrillDown(28);
                            END;
                             }

    { 1101103003;2;Field  ;
                Name=Field29;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[29];
                CaptionClass='3,' + MATRIX_CaptionSet[29];
                OnDrillDown=BEGIN
                              MATRIX_OnDrillDown(29);
                            END;
                             }

    { 1101103002;2;Field  ;
                Name=Field30;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[30];
                CaptionClass='3,' + MATRIX_CaptionSet[30];
                OnDrillDown=BEGIN
                              MATRIX_OnDrillDown(30);
                            END;
                             }

    { 1101103001;2;Field  ;
                Name=Field31;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[31];
                CaptionClass='3,' + MATRIX_CaptionSet[31];
                OnDrillDown=BEGIN
                              MATRIX_OnDrillDown(31);
                            END;
                             }

    { 1101103000;2;Field  ;
                Name=Field32;
                BlankZero=Yes;
                SourceExpr=MATRIX_CellData[32];
                CaptionClass='3,' + MATRIX_CaptionSet[32];
                OnDrillDown=BEGIN
                              MATRIX_OnDrillDown(32);
                            END;
                             }

  }
  CODE
  {
    VAR
      MatrixRecords@1101103003 : ARRAY [32] OF Record 2000000007;
      MATRIX_CurrentNoOfMatrixColumn@1101103002 : Integer;
      MATRIX_CellData@1101103001 : ARRAY [32] OF Decimal;
      MATRIX_CaptionSet@1101103000 : ARRAY [32] OF Text[1024];

    LOCAL PROCEDURE SetDateFilter@1085(MATRIX_ColumnOrdinal@1000 : Integer);
    BEGIN
      IF MatrixRecords[MATRIX_ColumnOrdinal]."Period Start" = MatrixRecords[MATRIX_ColumnOrdinal]."Period End" THEN
        SETRANGE("Date Filter",MatrixRecords[MATRIX_ColumnOrdinal]."Period Start")
      ELSE
        SETRANGE("Date Filter",MatrixRecords[MATRIX_ColumnOrdinal]."Period Start",MatrixRecords[MATRIX_ColumnOrdinal]."Period End")
    END;

    PROCEDURE Load@1086(MatrixColumns1@1005 : ARRAY [32] OF Text[1024];VAR MatrixRecords1@1006 : ARRAY [32] OF Record 2000000007;CurrentNoOfMatrixColumns@1007 : Integer);
    BEGIN
      COPYARRAY(MATRIX_CaptionSet,MatrixColumns1,1);
      COPYARRAY(MatrixRecords,MatrixRecords1,1);
      MATRIX_CurrentNoOfMatrixColumn := CurrentNoOfMatrixColumns;
    END;

    LOCAL PROCEDURE MATRIX_OnDrillDown@1087(MATRIX_ColumnOrdinal@1008 : Integer);
    VAR
      CapacityLedgerEntryL@1001 : Record 5832;
    BEGIN
      CapacityLedgerEntryL.SETRANGE(Type, CapacityLedgerEntryL.Type::"Machine Center");
      CapacityLedgerEntryL.SETRANGE("No.", "No.");

      IF MatrixRecords[MATRIX_ColumnOrdinal]."Period Start" = MatrixRecords[MATRIX_ColumnOrdinal]."Period End" THEN
        CapacityLedgerEntryL.SETRANGE("Posting Date",MatrixRecords[MATRIX_ColumnOrdinal]."Period Start")
      ELSE
        CapacityLedgerEntryL.SETRANGE("Posting Date",
          MatrixRecords[MATRIX_ColumnOrdinal]."Period Start",MatrixRecords[MATRIX_ColumnOrdinal]."Period End");

      PAGE.RUNMODAL(PAGE::"OPC Cap.  Ledger Entry List",CapacityLedgerEntryL);
    END;

    LOCAL PROCEDURE MATRIX_OnAfterGetRecord@1089(MATRIX_ColumnOrdinal@1010 : Integer);
    BEGIN
      SetDateFilter(MATRIX_ColumnOrdinal);
      CALCFIELDS("Invoiced Qty.");
      MATRIX_CellData[MATRIX_ColumnOrdinal] := "Invoiced Qty." ;
    END;

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 14.08.17 JAL Based on PAG9293 "Machine Center Calendar Matrix"
                       Changed to show Machine Center record value.
                       Uses the PAGE "OPC Cap.  Ledger Entry List" for drilldown.
    }
    END.
  }
}

OBJECT Page 83107 OPC Cap.  Ledger Entry List
{
  OBJECT-PROPERTIES
  {
    Date=28.09.17;
    Time=09:07:50;
    Modified=Yes;
    Version List=OPC6.03;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=OPC Cap. Ledger Entry List;
               NOR=OPC Kapasitetsposter oversikt];
    SourceTable=Table5832;
    PageType=List;
    OnInit=BEGIN
             CurrPage.LOOKUPMODE := TRUE;
           END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1080023 ;1   ;ActionGroup;
                      CaptionML=NOR=Funksjoner }
      { 1080025 ;2   ;Action    ;
                      Name=Correct Entry;
                      CaptionML=[ENU=Correct Entry;
                                 NOR=Korrigere post];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=CancelLine;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ClockingPostOutputL@1101103000 : Codeunit 83004;
                               BEGIN
                                 ClockingPostOutputL.CorrectCapacityLedgerEntry(Rec, TRUE);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1080000;1;Group     ;
                GroupType=Repeater }

    { 1080001;2;Field     ;
                SourceExpr="No." }

    { 1080022;2;Field     ;
                SourceExpr="Order No." }

    { 1080003;2;Field     ;
                SourceExpr="Posting Date" }

    { 1080005;2;Field     ;
                SourceExpr="Setup Time" }

    { 1080007;2;Field     ;
                SourceExpr="Run Time" }

    { 1080009;2;Field     ;
                SourceExpr="Stop Time" }

    { 1080026;2;Field     ;
                SourceExpr="Stop Code" }

    { 1080011;2;Field     ;
                SourceExpr="Invoiced Quantity" }

    { 1080013;2;Field     ;
                SourceExpr="Cap. Unit of Measure Code" }

    { 1080015;2;Field     ;
                SourceExpr="Starting Time" }

    { 1080017;2;Field     ;
                SourceExpr="Ending Time" }

  }
  CODE
  {
    VAR
      ItemJnlLine@1080000 : Record 83;
      OPCSetup@1080001 : Record 83001;
      ItemJnlMgt@1080004 : Codeunit 240;
      JnlSelected@1080005 : Boolean;

    BEGIN
    {
      +---------------------------------------------+
      | SI-Data                                     |
      +---------------------------------------------+
      Nr. Dato     Id  Beskrivelse
      01. 2010?    BVM Utviklet av BVM
      02. 19.03.10 hhe Fremvist "Stop Code"
      03. 09.11.10 HHE Styrer korreksjonspost fra kladd=OPC -> kladd=korreksjon(OPC-oppsett)
    }
    END.
  }
}

OBJECT Page 83108 OPC Cap. Journal Correction
{
  OBJECT-PROPERTIES
  {
    Date=20.09.17;
    Time=15:17:39;
    Modified=Yes;
    Version List=NAVW110.00,OPC6.01;
  }
  PROPERTIES
  {
    CaptionML=[ENU=OPC Cap. Journal Correction;
               NOR=OPC Kapasitetskorreksjonskladd];
    SaveValues=Yes;
    SourceTable=Table83;
    DelayedInsert=Yes;
    DataCaptionFields=Journal Batch Name;
    PageType=Worksheet;
    AutoSplitKey=Yes;
    OnOpenPage=VAR
                 JnlSelected@1000 : Boolean;
               BEGIN
                 //01. 15.01.10 -->
                 // IF IsOpenedFromBatch THEN BEGIN
                 //  CurrentJnlBatchName := "Journal Batch Name";
                 //  ItemJnlMgt.OpenJnl(CurrentJnlBatchName,Rec);
                 //  EXIT;
                 // END;
                 OPCSetupG.GET;
                 CurrentJnlBatchName:= OPCSetupG."Cap. Jnl. Templ. Name Corr";
                 //01. 15.01.10 <--
                 ItemJnlMgt.TemplateSelection(PAGE::"Capacity Journal",6,FALSE,Rec,JnlSelected);
                 IF NOT JnlSelected THEN
                   ERROR('');
                 ItemJnlMgt.OpenJnl(CurrentJnlBatchName,Rec);
               END;

    OnAfterGetRecord=BEGIN
                       ShowShortcutDimCode(ShortcutDimCode);
                     END;

    OnNewRecord=BEGIN
                  SetUpNewLine(xRec);
                  VALIDATE("Entry Type","Entry Type"::Output);
                  CLEAR(ShortcutDimCode);
                END;

    OnAfterGetCurrRecord=BEGIN
                           ItemJnlMgt.GetCapacity(Type,"No.",CapDescription);
                         END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 18      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Line;
                                 NOR=&Linje];
                      Image=Line }
      { 38      ;2   ;Action    ;
                      AccessByPermission=TableData 348=R;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 NOR=Dimensjoner];
                      ToolTipML=[ENU=View or edit dimensions, such as area, project, or department, that you can assign to sales and purchase documents to distribute costs and analyze transaction history.;
                                 NOR=Vis eller rediger dimensjoner, for eksempel omr†de, prosjekt eller avdeling, som du kan tilordne til salgs- og kj›psdokumenter for † distribuere kostnader og analysere transaksjonshistorikk.];
                      Image=Dimensions;
                      OnAction=BEGIN
                                 ShowDimensions;
                                 CurrPage.SAVERECORD;
                               END;
                                }
      { 61      ;2   ;Action    ;
                      ShortCutKey=Shift+Ctrl+I;
                      CaptionML=[ENU=Item &Tracking Lines;
                                 NOR=Vare&sporingslinjer];
                      Image=ItemTrackingLines;
                      OnAction=BEGIN
                                 OpenItemTrackingLines(FALSE);
                               END;
                                }
      { 14      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Capacity;
                                 NOR=&Kapasitet];
                      Image=Capacity }
      { 15      ;2   ;Action    ;
                      ShortCutKey=Shift+F7;
                      CaptionML=[ENU=Card;
                                 NOR=Kort];
                      Image=EditLines;
                      OnAction=VAR
                                 WorkCenter@1000 : Record 99000754;
                                 MachCenter@1001 : Record 99000758;
                               BEGIN
                                 CASE Type OF
                                   Type::"Work Center":
                                     BEGIN
                                       WorkCenter.SETRANGE("No.","No.");
                                       PAGE.RUN(PAGE::"Work Center Card",WorkCenter);
                                     END;
                                   Type::"Machine Center":
                                     BEGIN
                                       MachCenter.SETRANGE("No.","No.");
                                       PAGE.RUN(PAGE::"Machine Center Card",MachCenter);
                                     END;
                                 END;
                               END;
                                }
      { 20      ;2   ;Action    ;
                      ShortCutKey=Ctrl+F7;
                      CaptionML=[ENU=Ledger E&ntries;
                                 NOR=Post&er];
                      RunObject=Page 5832;
                      RunPageLink=Order Type=CONST(Production),
                                  Order No.=FIELD(Order No.);
                      Image=CustomerLedger }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 29      ;1   ;ActionGroup;
                      CaptionML=[ENU=P&osting;
                                 NOR=B&okf›ring];
                      Image=Post }
      { 41      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Test Report;
                                 NOR=Kontrollrapport];
                      ToolTipML=[ENU=View a test report so that you can find and correct any errors before you perform the actual posting of the journal or document.;
                                 NOR=Vis en kontrollrapport slik at du kan finne og rette eventuelle feil f›r du bokf›rer kladden eller dokumentet.];
                      Image=TestReport;
                      OnAction=BEGIN
                                 ReportPrint.PrintItemJnlLine(Rec);
                               END;
                                }
      { 56      ;2   ;Action    ;
                      ShortCutKey=F9;
                      CaptionML=[ENU=P&ost;
                                 NOR=B&okf›r];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PostOrder;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CODEUNIT.RUN(CODEUNIT::"Item Jnl.-Post",Rec);
                                 CurrentJnlBatchName := GETRANGEMAX("Journal Batch Name");
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 57      ;2   ;Action    ;
                      ShortCutKey=Shift+F9;
                      CaptionML=[ENU=Post and &Print;
                                 NOR=Bokf›r og &skriv ut];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PostPrint;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CODEUNIT.RUN(CODEUNIT::"Item Jnl.-Post+Print",Rec);
                                 CurrentJnlBatchName := GETRANGEMAX("Journal Batch Name");
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 78  ;1   ;Field     ;
                Lookup=Yes;
                CaptionML=[ENU=Batch Name;
                           NOR=Bunkenavn];
                ToolTipML=[ENU=Specifies the name of the journal batch of the capacity journal.;
                           NOR=Angir navnet p† kladden for kapasitetskladden.];
                SourceExpr=CurrentJnlBatchName;
                OnValidate=BEGIN
                             ItemJnlMgt.CheckName(CurrentJnlBatchName,Rec);
                             CurrentJnlBatchNameOnAfterVali;
                           END;

                OnLookup=BEGIN
                           CurrPage.SAVERECORD;
                           ItemJnlMgt.LookupName(CurrentJnlBatchName,Rec);
                           CurrPage.UPDATE(FALSE);
                         END;
                          }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 4   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the posting date for the entry.;
                           NOR=Angir postens bokf›ringsdato.];
                SourceExpr="Posting Date" }

    { 34  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the order that created the entry.;
                           NOR=Angir nummeret for ordren som opprettet posten.];
                SourceExpr="Order No.";
                Visible=FALSE }

    { 6   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a document number for the journal line.;
                           NOR=Angir et dokumentnummer for kladdelinjen.];
                SourceExpr="Document No." }

    { 32  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the item on the journal line.;
                           NOR=Angir nummeret p† varen p† kladdelinjen.];
                SourceExpr="Item No.";
                Visible=FALSE;
                OnValidate=BEGIN
                             ShowShortcutDimCode(ShortcutDimCode);
                           END;

                OnLookup=BEGIN
                           LookupItemNo;
                           ShowShortcutDimCode(ShortcutDimCode);
                         END;
                          }

    { 16  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the production operation on the item journal line when the journal functions as an output journal.;
                           NOR=Angir nummeret for produksjonsoperasjonen p† varekladdelinjen n†r kladden fungerer som en ferdigmeldingskladd.];
                SourceExpr="Operation No.";
                Visible=FALSE }

    { 10  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the journal type, which is either Work Center or Machine Center.;
                           NOR=Angir kladdetypen, som er enten Arbeidssenter eller Produksjonsressurs.];
                OptionCaptionML=[ENU=Work Center,Machine Center;
                                 NOR=Arbeidssenter,Maskinsenter];
                SourceExpr=Type;
                OnValidate=BEGIN
                             ItemJnlMgt.GetCapacity(Type,"No.",CapDescription);
                           END;
                            }

    { 2   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of a work center or a machine center, depending on the entry in the Type field.;
                           NOR=Angir nummeret for produksjonsressursen eller arbeidssenteret, avhengig av hva som er angitt i feltet Type.];
                SourceExpr="No.";
                OnValidate=BEGIN
                             ItemJnlMgt.GetCapacity(Type,"No.",CapDescription);
                           END;
                            }

    { 12  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a description of the item on the journal line.;
                           NOR=Angir en beskrivelse av varen p† kladdelinjen.];
                SourceExpr=Description }

    { 43  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the work shift code for this Journal line.;
                           NOR=Angir arbeidsskiftkoden for denne kladdelinjen.];
                SourceExpr="Work Shift Code";
                Visible=FALSE }

    { 22  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the starting time of the operation on the item journal line.;
                           NOR=Angir starttidspunktet for operasjonen p† varekladdelinjen.];
                SourceExpr="Starting Time";
                Visible=FALSE }

    { 24  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the ending time of the operation on the item journal line.;
                           NOR=Angir sluttidspunktet for operasjonen p† varekladdelinjen.];
                SourceExpr="Ending Time";
                Visible=FALSE }

    { 26  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the concurrent capacity.;
                           NOR=Angir den samtidige kapasiteten.];
                SourceExpr="Concurrent Capacity";
                Visible=FALSE }

    { 62  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the stop time of this capacity ledger entry.;
                           NOR=Angir stopptiden for kapasitetsposten.];
                SourceExpr="Stop Time" }

    { 30  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the unit of measure code for the capacity usage.;
                           NOR=Angir enhetskoden for kapasitetsbruken.];
                SourceExpr="Cap. Unit of Measure Code" }

    { 36  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the stop code.;
                           NOR=Angir stoppkoden.];
                SourceExpr="Stop Code" }

    { 40  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the scrap code.;
                           NOR=Angir vrakkoden.];
                SourceExpr="Scrap Code";
                Visible=FALSE }

    { 49  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the quantity of the produced item that can be posted as output on the journal line.;
                           NOR=Angir mengden av den produserte varen som kan bokf›res som avgang p† kladdelinjen.];
                SourceExpr="Output Quantity";
                Visible=FALSE }

    { 51  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of units produced incorrectly, and therefore cannot be used.;
                           NOR=Angir antall enheter som ble feilprodusert, og som dermed ikke kan brukes.];
                SourceExpr="Scrap Quantity";
                Visible=FALSE }

    { 53  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code if you have filled in the Sales Unit of Measure field on the item card.;
                           NOR=Angir koden hvis du har fylt ut feltet Salgsenhet p† varekortet.];
                SourceExpr="Unit of Measure Code";
                Visible=FALSE }

    { 45  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the dimension value code that the item journal line is linked to.;
                           NOR=Angir dimensjonsverdikoden som varekladdelinjen er knyttet til.];
                SourceExpr="Shortcut Dimension 1 Code";
                Visible=FALSE }

    { 47  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the dimension value code that the item journal line is linked to.;
                           NOR=Angir dimensjonsverdikoden som varekladdelinjen er knyttet til.];
                SourceExpr="Shortcut Dimension 2 Code";
                Visible=FALSE }

    { 300 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[3];
                CaptionClass='1,2,3';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(3),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(3,ShortcutDimCode[3]);
                           END;
                            }

    { 302 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[4];
                CaptionClass='1,2,4';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(4),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(4,ShortcutDimCode[4]);
                           END;
                            }

    { 304 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[5];
                CaptionClass='1,2,5';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(5),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(5,ShortcutDimCode[5]);
                           END;
                            }

    { 306 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[6];
                CaptionClass='1,2,6';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(6),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(6,ShortcutDimCode[6]);
                           END;
                            }

    { 308 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[7];
                CaptionClass='1,2,7';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(7),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(7,ShortcutDimCode[7]);
                           END;
                            }

    { 310 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[8];
                CaptionClass='1,2,8';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(8),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(8,ShortcutDimCode[8]);
                           END;
                            }

    { 55  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date on the document that provides the basis for the entry on the item journal line.;
                           NOR=Angir datoen p† bilaget som danner grunnlaget for posten p† varekladdelinjen.];
                SourceExpr="Document Date";
                Visible=FALSE }

    { 8   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the reason code that will be inserted on the journal lines.;
                           NOR=Angir †rsakskoden som skal settes inn p† kladdelinjene.];
                SourceExpr="Reason Code";
                Visible=FALSE }

    { 59  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a document number referring to the customer or vendor numbering system with whom you are trading items on this journal line.;
                           NOR=Angir et dokumentnummer som refererer til nummereringssystemet for en kunde eller en leverand›r du handler varer med p† denne kladdelinjen.];
                SourceExpr="External Document No.";
                Visible=FALSE }

    { 73  ;1   ;Group      }

    { 1902114901;2;Group  ;
                GroupType=FixedLayout }

    { 1903098501;3;Group  ;
                CaptionML=[ENU=Capacity Name;
                           NOR=Kapasitetsnavn] }

    { 74  ;4   ;Field     ;
                SourceExpr=CapDescription;
                Editable=FALSE;
                ShowCaption=No }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      ItemJnlMgt@1000 : Codeunit 240;
      ReportPrint@1001 : Codeunit 228;
      CapDescription@1002 : Text[30];
      CurrentJnlBatchName@1003 : Code[10];
      ShortcutDimCode@1004 : ARRAY [8] OF Code[20];
      _INC_@1101103000 : Integer;
      OPCSetupG@1101103001 : Record 83001;

    LOCAL PROCEDURE CurrentJnlBatchNameOnAfterVali@19002411();
    BEGIN
      CurrPage.SAVERECORD;
      ItemJnlMgt.SetName(CurrentJnlBatchName,Rec);
      CurrPage.UPDATE(FALSE);
    END;

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 15.01.10 BVM Made by BVM for Overaasen
      02. 14.08.17 JAL Based on PAG99000773 "Capacity Journal"
    }
    END.
  }
}

OBJECT Page 83109 OPC Output Journal Correction
{
  OBJECT-PROPERTIES
  {
    Date=28.09.17;
    Time=10:00:34;
    Modified=Yes;
    Version List=NAVW110.00,OPC1.00,INC1.01,OPC6.02;
  }
  PROPERTIES
  {
    CaptionML=[ENU=OPC Output Journal Correction;
               NOR=OPC Ferdigmeldingskladd korreksjon];
    SaveValues=Yes;
    SourceTable=Table83;
    DelayedInsert=Yes;
    DataCaptionFields=Journal Batch Name;
    PageType=Worksheet;
    AutoSplitKey=Yes;
    OnOpenPage=VAR
                 JnlSelected@1000 : Boolean;
               BEGIN
                 OPCSetupG.GET;
                 CurrentJnlBatchName := OPCSetupG."Output Jnl. Batch Name Corr"; //09.11.10 HHE
                 ItemJnlMgt.TemplateSelection(PAGE::"Output Journal",5,FALSE,Rec,JnlSelected);
                 IF NOT JnlSelected THEN
                   ERROR('');
                 ItemJnlMgt.OpenJnl(CurrentJnlBatchName,Rec);
               END;

    OnAfterGetRecord=BEGIN
                       ShowShortcutDimCode(ShortcutDimCode);
                     END;

    OnNewRecord=BEGIN
                  SetUpNewLine(xRec);
                  VALIDATE("Entry Type","Entry Type"::Output);
                  CLEAR(ShortcutDimCode);
                END;

    OnDeleteRecord=VAR
                     ReserveItemJnlLine@1000 : Codeunit 99000835;
                   BEGIN
                     COMMIT;
                     IF NOT ReserveItemJnlLine.DeleteLineConfirm(Rec) THEN
                       EXIT(FALSE);
                     ReserveItemJnlLine.DeleteLine(Rec);
                   END;

    OnAfterGetCurrRecord=BEGIN
                           ItemJnlMgt.GetOutput(Rec,ProdOrderDescription,OperationName);
                         END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 35      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Line;
                                 NOR=&Linje];
                      Image=Line }
      { 44      ;2   ;Action    ;
                      AccessByPermission=TableData 348=R;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 NOR=Dimensjoner];
                      ToolTipML=[ENU=View or edit dimensions, such as area, project, or department, that you can assign to sales and purchase documents to distribute costs and analyze transaction history.;
                                 NOR=Vis eller rediger dimensjoner, for eksempel omr†de, prosjekt eller avdeling, som du kan tilordne til salgs- og kj›psdokumenter for † distribuere kostnader og analysere transaksjonshistorikk.];
                      Promoted=Yes;
                      Image=Dimensions;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 ShowDimensions;
                                 CurrPage.SAVERECORD;
                               END;
                                }
      { 45      ;2   ;Action    ;
                      Name=Item Tracking Lines;
                      ShortCutKey=Shift+Ctrl+I;
                      CaptionML=[ENU=Item &Tracking Lines;
                                 NOR=Vare&sporingslinjer];
                      Image=ItemTrackingLines;
                      OnAction=BEGIN
                                 OpenItemTrackingLines(FALSE);
                               END;
                                }
      { 46      ;2   ;Action    ;
                      CaptionML=[ENU=Bin Contents;
                                 NOR=Hylleinnhold];
                      RunObject=Page 7305;
                      RunPageView=SORTING(Location Code,Bin Code,Item No.,Variant Code);
                      RunPageLink=Location Code=FIELD(Location Code),
                                  Item No.=FIELD(Item No.),
                                  Variant Code=FIELD(Variant Code);
                      Image=BinContent }
      { 18      ;1   ;ActionGroup;
                      CaptionML=[ENU=Pro&d. Order;
                                 NOR=Pro&d.ordre];
                      Image=Order }
      { 19      ;2   ;Action    ;
                      ShortCutKey=Shift+F7;
                      CaptionML=[ENU=Card;
                                 NOR=Kort];
                      RunObject=Page 99000831;
                      RunPageLink=No.=FIELD(Order No.);
                      Image=EditLines }
      { 20      ;2   ;ActionGroup;
                      CaptionML=[ENU=Ledger E&ntries;
                                 NOR=Post&er];
                      Image=Entries }
      { 21      ;3   ;Action    ;
                      ShortCutKey=Ctrl+F7;
                      CaptionML=[ENU=Item Ledger E&ntries;
                                 NOR=&Vareposter];
                      RunObject=Page 38;
                      RunPageView=SORTING(Order Type,Order No.);
                      RunPageLink=Order Type=CONST(Production),
                                  Order No.=FIELD(Order No.);
                      Image=ItemLedger }
      { 22      ;3   ;Action    ;
                      CaptionML=[ENU=Capacity Ledger Entries;
                                 NOR=Kapasitetsposter];
                      RunObject=Page 5832;
                      RunPageView=SORTING(Order Type,Order No.);
                      RunPageLink=Order Type=CONST(Production),
                                  Order No.=FIELD(Order No.);
                      Promoted=No;
                      Image=CapacityLedger;
                      PromotedCategory=Process }
      { 25      ;3   ;Action    ;
                      CaptionML=[ENU=Value Entries;
                                 NOR=Verdiposter];
                      RunObject=Page 5802;
                      RunPageView=SORTING(Order Type,Order No.);
                      RunPageLink=Order Type=CONST(Production),
                                  Order No.=FIELD(Order No.);
                      Image=ValueLedger }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 36      ;1   ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 NOR=F&unksjoner];
                      Image=Action }
      { 39      ;2   ;Action    ;
                      CaptionML=[ENU=Explode &Routing;
                                 NOR=Utfold &rute];
                      RunObject=Codeunit 5406;
                      Promoted=Yes;
                      Image=ExplodeRouting;
                      PromotedCategory=Process }
      { 1101103002;2 ;Action    ;
                      Name=Import Times from Kronos;
                      CaptionML=NOR=Les inn tider fra Kronos;
                      Promoted=Yes;
                      Image=Import;
                      PromotedCategory=Process }
      { 29      ;1   ;ActionGroup;
                      CaptionML=[ENU=P&osting;
                                 NOR=B&okf›ring];
                      Image=Post }
      { 41      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Test Report;
                                 NOR=Kontrollrapport];
                      ToolTipML=[ENU=View a test report so that you can find and correct any errors before you perform the actual posting of the journal or document.;
                                 NOR=Vis en kontrollrapport slik at du kan finne og rette eventuelle feil f›r du bokf›rer kladden eller dokumentet.];
                      Image=TestReport;
                      OnAction=BEGIN
                                 ReportPrint.PrintItemJnlLine(Rec);
                               END;
                                }
      { 56      ;2   ;Action    ;
                      Name=Post;
                      ShortCutKey=F9;
                      CaptionML=[ENU=P&ost;
                                 NOR=B&okf›r];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PostOrder;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 TrySetApplyToEntries;
                                 PostingItemJnlFromProduction(FALSE);
                                 CurrentJnlBatchName := GETRANGEMAX("Journal Batch Name");
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 57      ;2   ;Action    ;
                      ShortCutKey=Shift+F9;
                      CaptionML=[ENU=Post and &Print;
                                 NOR=Bokf›r og &skriv ut];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PostPrint;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 TrySetApplyToEntries;
                                 PostingItemJnlFromProduction(TRUE);
                                 CurrentJnlBatchName := GETRANGEMAX("Journal Batch Name");
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 31      ;1   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=&Print;
                                 NOR=&Skriv ut];
                      Promoted=Yes;
                      Image=Print;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ItemJnlLine@1001 : Record 83;
                               BEGIN
                                 ItemJnlLine.COPY(Rec);
                                 ItemJnlLine.SETRANGE("Journal Template Name","Journal Template Name");
                                 ItemJnlLine.SETRANGE("Journal Batch Name","Journal Batch Name");
                                 REPORT.RUNMODAL(REPORT::"Inventory Movement",TRUE,TRUE,ItemJnlLine);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 78  ;1   ;Field     ;
                Lookup=Yes;
                CaptionML=[ENU=Batch Name;
                           NOR=Bunkenavn];
                ToolTipML=[ENU=Specifies the name of the journal batch of the output journal.;
                           NOR=Angir navnet p† kladden for ferdigmeldingskladden.];
                SourceExpr=CurrentJnlBatchName;
                OnValidate=BEGIN
                             ItemJnlMgt.CheckName(CurrentJnlBatchName,Rec);
                             CurrentJnlBatchNameOnAfterVali;
                           END;

                OnLookup=BEGIN
                           CurrPage.SAVERECORD;
                           ItemJnlMgt.LookupName(CurrentJnlBatchName,Rec);
                           CurrPage.UPDATE(FALSE);
                           ItemJnlMgt.CheckName(CurrentJnlBatchName,Rec);
                         END;
                          }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 66  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the posting date for the entry.;
                           NOR=Angir postens bokf›ringsdato.];
                SourceExpr="Posting Date" }

    { 1101103000;2;Field  ;
                SourceExpr="Innlesnings status" }

    { 60  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the order that created the entry.;
                           NOR=Angir nummeret for ordren som opprettet posten.];
                SourceExpr="Order No.";
                OnValidate=BEGIN
                             ItemJnlMgt.GetOutput(Rec,ProdOrderDescription,OperationName);
                           END;
                            }

    { 2   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a document number for the journal line.;
                           NOR=Angir et dokumentnummer for kladdelinjen.];
                SourceExpr="Document No." }

    { 14  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the item on the journal line.;
                           NOR=Angir nummeret p† varen p† kladdelinjen.];
                SourceExpr="Item No.";
                OnValidate=BEGIN
                             ShowShortcutDimCode(ShortcutDimCode);
                           END;

                OnLookup=BEGIN
                           LookupItemNo;
                           ShowShortcutDimCode(ShortcutDimCode);
                         END;
                          }

    { 64  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the production operation on the item journal line when the journal functions as an output journal.;
                           NOR=Angir nummeret for produksjonsoperasjonen p† varekladdelinjen n†r kladden fungerer som en ferdigmeldingskladd.];
                SourceExpr="Operation No.";
                OnValidate=BEGIN
                             ItemJnlMgt.GetOutput(Rec,ProdOrderDescription,OperationName);
                           END;
                            }

    { 4   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the line number of the order that created the entry.;
                           NOR=Angir linjenummeret til ordren som opprettet posten.];
                SourceExpr="Order Line No." }

    { 80  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the journal type, which is either Work Center or Machine Center.;
                           NOR=Angir kladdetypen, som er enten Arbeidssenter eller Produksjonsressurs.];
                OptionCaptionML=[ENU=Work Center,Machine Center;
                                 NOR=Arbeidssenter,Maskinsenter];
                SourceExpr=Type }

    { 82  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of a work center or a machine center, depending on the entry in the Type field.;
                           NOR=Angir nummeret for produksjonsressursen eller arbeidssenteret, avhengig av hva som er angitt i feltet Type.];
                SourceExpr="No." }

    { 5   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a variant code for the item.;
                           NOR=Angir en variantkode for varen.];
                SourceExpr="Variant Code";
                Visible=FALSE }

    { 84  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a description of the item on the journal line.;
                           NOR=Angir en beskrivelse av varen p† kladdelinjen.];
                SourceExpr=Description }

    { 114 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the work shift code for this Journal line.;
                           NOR=Angir arbeidsskiftkoden for denne kladdelinjen.];
                SourceExpr="Work Shift Code";
                Visible=FALSE }

    { 118 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the dimension value code that the item journal line is linked to.;
                           NOR=Angir dimensjonsverdikoden som varekladdelinjen er knyttet til.];
                SourceExpr="Shortcut Dimension 1 Code";
                Visible=FALSE }

    { 10  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code of the general business posting group that will be used when you post the entry on the item journal line.;
                           NOR=Angir firmabokf›ringsgruppen som brukes n†r du bokf›rer posten p† varekladdelinjen.];
                SourceExpr="Gen. Bus. Posting Group";
                Visible=FALSE }

    { 12  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code of the general product posting group that will be used for this item when you post the entry on the item journal line.;
                           NOR=Angir koden for varebokf›ringsgruppen som skal brukes for varen n†r du bokf›rer posten p† varekladdelinjen.];
                SourceExpr="Gen. Prod. Posting Group";
                Visible=FALSE }

    { 120 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the dimension value code that the item journal line is linked to.;
                           NOR=Angir dimensjonsverdikoden som varekladdelinjen er knyttet til.];
                SourceExpr="Shortcut Dimension 2 Code";
                Visible=FALSE }

    { 300 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[3];
                CaptionClass='1,2,3';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(3),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(3,ShortcutDimCode[3]);
                           END;
                            }

    { 302 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[4];
                CaptionClass='1,2,4';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(4),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(4,ShortcutDimCode[4]);
                           END;
                            }

    { 304 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[5];
                CaptionClass='1,2,5';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(5),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(5,ShortcutDimCode[5]);
                           END;
                            }

    { 306 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[6];
                CaptionClass='1,2,6';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(6),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(6,ShortcutDimCode[6]);
                           END;
                            }

    { 308 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[7];
                CaptionClass='1,2,7';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(7),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(7,ShortcutDimCode[7]);
                           END;
                            }

    { 310 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[8];
                CaptionClass='1,2,8';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(8),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(8,ShortcutDimCode[8]);
                           END;
                            }

    { 94  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the starting time of the operation on the item journal line.;
                           NOR=Angir starttidspunktet for operasjonen p† varekladdelinjen.];
                SourceExpr="Starting Time";
                Visible=FALSE }

    { 96  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the ending time of the operation on the item journal line.;
                           NOR=Angir sluttidspunktet for operasjonen p† varekladdelinjen.];
                SourceExpr="Ending Time";
                Visible=FALSE }

    { 98  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the concurrent capacity.;
                           NOR=Angir den samtidige kapasiteten.];
                SourceExpr="Concurrent Capacity";
                Visible=FALSE }

    { 8   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the time required to set up the machines for this journal line.;
                           NOR=Angir hvor lang tid det tar † konfigurere maskinene for denne kladdelinjen.];
                SourceExpr="Setup Time";
                Visible=FALSE }

    { 86  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the run time of the operations represented by this journal line.;
                           NOR=Angir kj›retiden for operasjonene som representeres av denne kladdelinjen.];
                SourceExpr="Run Time" }

    { 3   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the unit of measure code for the capacity usage.;
                           NOR=Angir enhetskoden for kapasitetsbruken.];
                SourceExpr="Cap. Unit of Measure Code" }

    { 88  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the unit cost of the item on the line.;
                           NOR=Angir enhetskosten for varen p† linjen.];
                SourceExpr="Unit Cost";
                Visible=FALSE }

    { 100 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for the inventory location where the item on the journal line will be registered.;
                           NOR=Angir koden for lagerlokasjonen der varen p† kladdelinjen skal registreres.];
                SourceExpr="Location Code";
                Visible=FALSE }

    { 28  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a bin code for the item.;
                           NOR=Angir en hyllekode for varen.];
                SourceExpr="Bin Code";
                Visible=FALSE }

    { 112 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the scrap code.;
                           NOR=Angir vrakkoden.];
                SourceExpr="Scrap Code";
                Visible=FALSE }

    { 126 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the quantity of the produced item that can be posted as output on the journal line.;
                           NOR=Angir mengden av den produserte varen som kan bokf›res som avgang p† kladdelinjen.];
                SourceExpr="Output Quantity" }

    { 1101103001;2;Field  ;
                SourceExpr="Employee no." }

    { 128 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of units produced incorrectly, and therefore cannot be used.;
                           NOR=Angir antall enheter som ble feilprodusert, og som dermed ikke kan brukes.];
                SourceExpr="Scrap Quantity" }

    { 26  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code if you have filled in the Sales Unit of Measure field on the item card.;
                           NOR=Angir koden hvis du har fylt ut feltet Salgsenhet p† varekortet.];
                SourceExpr="Unit of Measure Code" }

    { 122 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies that the operation represented by the output journal line is finished.;
                           NOR=Angir at operasjonen som er representert av ferdigmeldingskladdelinjen, er fullf›rt.];
                SourceExpr=Finished }

    { 33  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies if the quantity in the item journal line should be applied to an already-posted document.;
                           NOR=Angir om antallet p† varekladdelinjen skal utlignes mot et bilag som allerede er bokf›rt.];
                SourceExpr="Applies-to Entry" }

    { 134 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date on the document that provides the basis for the entry on the item journal line.;
                           NOR=Angir datoen p† bilaget som danner grunnlaget for posten p† varekladdelinjen.];
                SourceExpr="Document Date";
                Visible=FALSE }

    { 136 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a document number referring to the customer or vendor numbering system with whom you are trading items on this journal line.;
                           NOR=Angir et dokumentnummer som refererer til nummereringssystemet for en kunde eller en leverand›r du handler varer med p† denne kladdelinjen.];
                SourceExpr="External Document No.";
                Visible=FALSE }

    { 73  ;1   ;Group      }

    { 1902114901;2;Group  ;
                GroupType=FixedLayout }

    { 1903098501;3;Group  ;
                CaptionML=[ENU=Prod. Order Name;
                           NOR=Prod.ordrenavn] }

    { 74  ;4   ;Field     ;
                SourceExpr=ProdOrderDescription;
                Editable=FALSE;
                ShowCaption=No }

    { 1901991301;3;Group  ;
                CaptionML=[ENU=Operation;
                           NOR=Operasjon] }

    { 76  ;4   ;Field     ;
                CaptionML=[ENU=Operation;
                           NOR=Operasjon];
                ToolTipML=[ENU=Specifies the abbreviated task description.;
                           NOR=Angir den forkortede oppgavebeskrivelsen.];
                SourceExpr=OperationName;
                Editable=FALSE }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      ItemJnlMgt@1000 : Codeunit 240;
      ReportPrint@1001 : Codeunit 228;
      ProdOrderDescription@1002 : Text[50];
      OperationName@1003 : Text[50];
      CurrentJnlBatchName@1004 : Code[10];
      ShortcutDimCode@1005 : ARRAY [8] OF Code[20];
      _INC_@1101103000 : Integer;
      OPCSetupG@1101103001 : Record 83001;

    LOCAL PROCEDURE CurrentJnlBatchNameOnAfterVali@19002411();
    BEGIN
      CurrPage.SAVERECORD;
      ItemJnlMgt.SetName(CurrentJnlBatchName,Rec);
      CurrPage.UPDATE(FALSE);
    END;

    LOCAL PROCEDURE TrySetApplyToEntries@101();
    VAR
      ItemLedgerEntry@1005 : Record 32;
      ItemJournalLine2@1001 : Record 83;
      ReservationEntry@1002 : Record 337;
    BEGIN
      ItemJournalLine2.COPY(Rec);
      IF ItemJournalLine2.FINDSET THEN
        REPEAT
          IF FindReservationsReverseOutput(ReservationEntry,ItemJournalLine2) THEN
            REPEAT
              IF FindILEFromReservation(ItemLedgerEntry,ItemJournalLine2,ReservationEntry,"Order No.") THEN BEGIN
                ReservationEntry.VALIDATE("Appl.-to Item Entry",ItemLedgerEntry."Entry No.");
                ReservationEntry.MODIFY(TRUE);
              END;
            UNTIL ReservationEntry.NEXT = 0;

        UNTIL ItemJournalLine2.NEXT = 0;
    END;

    LOCAL PROCEDURE FindReservationsReverseOutput@19(VAR ReservationEntry@1001 : Record 337;ItemJnlLine@1000 : Record 83) : Boolean;
    BEGIN
      IF ItemJnlLine.Quantity >= 0 THEN
        EXIT(FALSE);

      ReservationEntry.SETCURRENTKEY(
        "Source ID","Source Ref. No.","Source Type","Source Subtype",
        "Source Batch Name","Source Prod. Order Line");
      ReservationEntry.SETRANGE("Source ID",ItemJnlLine."Journal Template Name");
      ReservationEntry.SETRANGE("Source Ref. No.",ItemJnlLine."Line No.");
      ReservationEntry.SETRANGE("Source Type",DATABASE::"Item Journal Line");
      ReservationEntry.SETRANGE("Source Subtype",ItemJnlLine."Entry Type");
      ReservationEntry.SETRANGE("Source Batch Name",ItemJnlLine."Journal Batch Name");

      ReservationEntry.SETFILTER("Serial No.",'<>%1','');
      ReservationEntry.SETRANGE("Qty. to Handle (Base)",-1);
      ReservationEntry.SETRANGE("Appl.-to Item Entry",0);

      EXIT(ReservationEntry.FINDSET);
    END;

    LOCAL PROCEDURE FindILEFromReservation@20(VAR ItemLedgerEntry@1000 : Record 32;ItemJnlLine@1001 : Record 83;ReservationEntry@1002 : Record 337;ProductionOrderNo@1003 : Code[20]) : Boolean;
    BEGIN
      ItemLedgerEntry.SETCURRENTKEY("Item No.",Open,"Variant Code",Positive,
        "Location Code","Posting Date","Expiration Date","Lot No.","Serial No.");

      ItemLedgerEntry.SETRANGE("Item No.",ItemJnlLine."Item No.");
      ItemLedgerEntry.SETRANGE(Open,TRUE);
      ItemLedgerEntry.SETRANGE("Variant Code",ItemJnlLine."Variant Code");
      ItemLedgerEntry.SETRANGE(Positive,TRUE);
      ItemLedgerEntry.SETRANGE("Location Code",ItemJnlLine."Location Code");
      ItemLedgerEntry.SETRANGE("Serial No.",ReservationEntry."Lot No.");
      ItemLedgerEntry.SETRANGE("Serial No.",ReservationEntry."Serial No.");
      ItemLedgerEntry.SETRANGE("Document No.",ProductionOrderNo);

      EXIT(ItemLedgerEntry.FINDSET);
    END;

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 25.01.10 BVM Made by BVM, copy from PAG99000823 "Output Journal"
      02. 09.11.10 HHE Styrer korreksjonsposten til kladdnavn=AUTO (org.=OPC)
    }
    END.
  }
}

OBJECT Page 83110 OPC MC. Std. Reg. Time Subform
{
  OBJECT-PROPERTIES
  {
    Date=28.09.17;
    Time=14:00:50;
    Modified=Yes;
    Version List=OPC6.02;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Machine Center Std. Time Compared Reg. Time;
               NOR="Prod.ress normtid sammenlignet med m›nstret tid "];
    SaveValues=Yes;
    InsertAllowed=No;
    DeleteAllowed=No;
    SourceTable=Table2000000007;
    PageType=ListPart;
    OnOpenPage=BEGIN
                 RESET;
               END;

    OnFindRecord=BEGIN
                   EXIT(PeriodFormMgt.FindDate(Which,Rec,MachineCPeriodLength));
                 END;

    OnNextRecord=BEGIN
                   EXIT(PeriodFormMgt.NextDate(Steps,Rec,MachineCPeriodLength));
                 END;

    OnAfterGetRecord=BEGIN
                       SetDateFilter;
                       //hhe 04.03.10->
                       MachineCenter.CALCFIELDS("Capacity (Effective)","Time Registrations","Earliest Time Reg.","Latest Time Reg.","Deduct Lunch");
                       //hhe 19.03.10: lagt til "Deduct - Lunch" i setningen over
                       Avvik := MachineCenter."Time Registrations" - MachineCenter."Capacity (Effective)";
                       //hhe 04.03.10<-
                       IF MachineCenter."Capacity (Effective)" <> 0 THEN
                         CapacityEfficiency := ROUND(MachineCenter."Prod. Order Need (Qty.)" / MachineCenter."Capacity (Effective)" * 100, 0.1)
                       ELSE
                         CapacityEfficiency := 0;

                       //hhe 19.03.10->
                       Deduct_Lunch := FALSE;
                       IF MachineCenter."Deduct Lunch" THEN
                         Deduct_Lunch := TRUE;
                       //hhe 19.03.10<-
                       AvvikOnFormat;
                     END;

  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                SourceExpr="Period Start" }

    { 14  ;2   ;Field     ;
                SourceExpr="Period Name" }

    { 4   ;2   ;Field     ;
                CaptionML=[ENU=Capacity;
                           NOR=Normtid];
                DecimalPlaces=1:1;
                BlankZero=Yes;
                SourceExpr=MachineCenter."Capacity (Effective)";
                OnDrillDown=VAR
                              CalendarEntry@1001 : Record 99000757;
                            BEGIN
                              CalendarEntry.SETRANGE("Capacity Type",CalendarEntry."Capacity Type"::"Machine Center");
                              CalendarEntry.SETRANGE("No.",MachineCenter."No.");
                              CalendarEntry.SETRANGE(Date,"Period Start","Period End");

                              PAGE.RUN(0,CalendarEntry);
                            END;
                             }

    { 6   ;2   ;Field     ;
                CaptionML=[ENU=Time - reg.(hours);
                           NOR=M›nstret tid (timer)];
                DecimalPlaces=1:1;
                BlankZero=Yes;
                SourceExpr=MachineCenter."Time Registrations";
                OnDrillDown=VAR
                              TimeRegistrations@1001 : Record 83007;
                            BEGIN
                              //hhe 04.03.10->
                              TimeRegistrations.SETRANGE("Machine Center",MachineCenter."No.");
                              TimeRegistrations.SETRANGE("Start Date","Period Start","Period End");
                              PAGE.RUN(0,TimeRegistrations);
                              //hhe 04.03.10<-
                            END;
                             }

    { 8   ;2   ;Field     ;
                Name=Avvik;
                CaptionML=[ENU=Std - Time reg.;
                           NOR=Avvik (m›nstret - normtid)];
                DecimalPlaces=1:1;
                BlankZero=Yes;
                SourceExpr=Avvik }

    { 1080000;2;Field     ;
                CaptionML=NOR=Tidligste m›nstring(inn);
                SourceExpr=MachineCenter."Earliest Time Reg." }

    { 1080003;2;Field     ;
                CaptionML=NOR=Seneste m›nstringtid (ut);
                SourceExpr=MachineCenter."Latest Time Reg." }

    { 1080006;2;Field     ;
                CaptionML=NOR=Fradrag lunch;
                SourceExpr=Deduct_Lunch }

  }
  CODE
  {
    VAR
      MachineCenter@1000 : Record 99000758;
      PeriodFormMgt@1001 : Codeunit 359;
      CapacityAvailable@1002 : Decimal;
      CapacityEfficiency@1003 : Decimal;
      MachineCPeriodLength@1004 : 'Day,Week,Month,Quarter,Year,Period';
      AmountType@1005 : 'Net Change,Balance at Date';
      "--si-data--"@1080000 : Boolean;
      Avvik@1080001 : Decimal;
      Deduct_Lunch@1080002 : Boolean;

    PROCEDURE Set@1(VAR NewMachineCenter@1000 : Record 99000758;NewMachineCPeriodLength@1001 : Integer;NewAmountType@1002 : 'Net Change,Balance at Date');
    BEGIN
      MachineCenter.COPY(NewMachineCenter);
      MachineCPeriodLength := NewMachineCPeriodLength;
      AmountType := NewAmountType;
      CurrPage.UPDATE(FALSE);
    END;

    LOCAL PROCEDURE SetDateFilter@4();
    BEGIN
      IF AmountType = AmountType::"Net Change" THEN
        MachineCenter.SETRANGE("Date Filter","Period Start","Period End")
      ELSE
        MachineCenter.SETRANGE("Date Filter",0D,"Period End");
    END;

    LOCAL PROCEDURE AvvikOnFormat@19061396();
    BEGIN
      //hhe 04.03.10->
      IF Avvik <0 THEN;
      //hhe 04.03.10->
    END;

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 04.03.10 hhe Opprette denne FRM for † forenkle beregning av l›nn
      02. 19.03.10 hhe Fremvist "Deduct lunch" (for enkelt † se om det finnes fradrag lunch)
    }
    END.
  }
}

OBJECT Page 83111 OPC MC. Std. Reg. Time
{
  OBJECT-PROPERTIES
  {
    Date=28.09.17;
    Time=14:02:01;
    Modified=Yes;
    Version List=OPC6.01;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Machine Center Std. compared with Time Reg.;
               NOR=Prod.ressurs Norm.tid sammenlignet med M›nstret tid];
    SaveValues=Yes;
    InsertAllowed=No;
    DeleteAllowed=No;
    SourceTable=Table99000758;
    PageType=Card;
    OnAfterGetRecord=BEGIN
                       UpdateSubForm;
                     END;

  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1903121901;1;Group  ;
                CaptionML=ENU=Options }

    { 6   ;2   ;Field     ;
                Name=Period Type;
                CaptionML=ENU=View by;
                ToolTipML=[ENU=Day;
                           NOR=Dag];
                OptionCaptionML=ENU=Day,Week,Month,Quarter,Year,Period;
                SourceExpr=PeriodType;
                OnValidate=BEGIN
                             UpdateSubForm();
                           END;
                            }

    { 2   ;2   ;Field     ;
                Name=Amount Type;
                CaptionML=ENU=View as;
                ToolTipML=[ENU=Net Change;
                           NOR=Bevegelse];
                OptionCaptionML=ENU=Net Change,Balance at Date;
                SourceExpr=AmountType;
                OnValidate=BEGIN
                             UpdateSubForm();
                           END;
                            }

    { 5   ;1   ;Part      ;
                Name=MachineCLoadLines;
                PagePartID=Page83110 }

  }
  CODE
  {
    VAR
      PeriodType@1000 : 'Day,Week,Month,Quarter,Year,Period';
      AmountType@1001 : 'Net Change,Balance at Date';

    PROCEDURE UpdateSubForm@1();
    BEGIN
      CurrPage.MachineCLoadLines.PAGE.Set(Rec,PeriodType,AmountType);
    END;

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 14.08.17 JAL Upgraded from Form to Page
    }
    END.
  }
}

OBJECT Page 99000754 Work Center Card
{
  OBJECT-PROPERTIES
  {
    Date=28.09.17;
    Time=13:55:22;
    Modified=Yes;
    Version List=NAVW110.00,INC1.03,OPC6.03;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Work Center Card;
               NOR=Arbeidssenterkort];
    SourceTable=Table99000754;
    PageType=Card;
    OnInit=BEGIN
             FromProductionBinCodeEnable := TRUE;
             ToProductionBinCodeEnable := TRUE;
             OpenShopFloorBinCodeEnable := TRUE;
           END;

    OnOpenPage=BEGIN
                 OnActivateForm;
               END;

    OnAfterGetCurrRecord=BEGIN
                           UpdateEnabled;
                         END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 54      ;1   ;ActionGroup;
                      CaptionML=[ENU=Wor&k Ctr.;
                                 NOR=Arb.&sent.];
                      Image=WorkCenter }
      { 45      ;2   ;Action    ;
                      ShortCutKey=Ctrl+F7;
                      CaptionML=[ENU=Capacity Ledger E&ntries;
                                 NOR=&Kapasitetsposter];
                      RunObject=Page 5832;
                      RunPageView=SORTING(Work Center No.,Work Shift Code,Posting Date);
                      RunPageLink=Work Center No.=FIELD(No.),
                                  Posting Date=FIELD(Date Filter);
                      Image=CapacityLedger }
      { 63      ;2   ;Action    ;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 NOR=Dimensjoner];
                      ToolTipML=[ENU=View or edit dimensions, such as area, project, or department, that you can assign to sales and purchase documents to distribute costs and analyze transaction history.;
                                 NOR=Vis eller rediger dimensjoner, for eksempel omr†de, prosjekt eller avdeling, som du kan tilordne til salgs- og kj›psdokumenter for † distribuere kostnader og analysere transaksjonshistorikk.];
                      RunObject=Page 540;
                      RunPageLink=Table ID=CONST(99000754),
                                  No.=FIELD(No.);
                      Image=Dimensions }
      { 46      ;2   ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 NOR=&Merknader];
                      RunObject=Page 99000784;
                      RunPageView=WHERE(Table Name=CONST(Work Center));
                      RunPageLink=No.=FIELD(No.);
                      Image=ViewComments }
      { 48      ;2   ;Action    ;
                      CaptionML=[ENU=Lo&ad;
                                 NOR=Bel&astning];
                      RunObject=Page 99000887;
                      RunPageLink=No.=FIELD(No.),
                                  Work Shift Filter=FIELD(Work Shift Filter);
                      Promoted=Yes;
                      Image=WorkCenterLoad;
                      PromotedCategory=Process }
      { 47      ;2   ;Separator  }
      { 56      ;2   ;Action    ;
                      ShortCutKey=F7;
                      CaptionML=[ENU=Statistics;
                                 NOR=Statistikk];
                      RunObject=Page 99000756;
                      RunPageLink=No.=FIELD(No.),
                                  Date Filter=FIELD(Date Filter),
                                  Work Shift Filter=FIELD(Work Shift Filter);
                      Promoted=Yes;
                      Image=Statistics;
                      PromotedCategory=Process }
      { 53      ;1   ;ActionGroup;
                      CaptionML=[ENU=Pla&nning;
                                 NOR=Pla&nlegging];
                      Image=Planning }
      { 59      ;2   ;Action    ;
                      CaptionML=[ENU=&Calendar;
                                 NOR=&Kalender];
                      RunObject=Page 99000769;
                      Promoted=Yes;
                      Image=MachineCenterCalendar;
                      PromotedCategory=Process }
      { 74      ;2   ;Action    ;
                      CaptionML=[ENU=A&bsence;
                                 NOR=Fr&av‘r];
                      RunObject=Page 99000772;
                      RunPageView=SORTING(Capacity Type,No.,Date,Starting Time);
                      RunPageLink=Capacity Type=CONST(Work Center),
                                  No.=FIELD(No.),
                                  Date=FIELD(Date Filter);
                      Promoted=Yes;
                      Image=WorkCenterAbsence;
                      PromotedCategory=Process }
      { 36      ;2   ;Action    ;
                      CaptionML=[ENU=Ta&sk List;
                                 NOR=&Oppg.oversikt];
                      RunObject=Page 99000915;
                      RunPageView=SORTING(Type,No.)
                                  WHERE(Type=CONST(Work Center),
                                        Status=FILTER(..Released),
                                        Routing Status=FILTER(<>Finished));
                      RunPageLink=No.=FIELD(No.);
                      Image=TaskList }
      { 1900000006;0 ;ActionContainer;
                      ActionContainerType=Reports }
      { 1906187306;1 ;Action    ;
                      CaptionML=[ENU=Subcontractor - Dispatch List;
                                 NOR=Servicefordeling - underleverand›r];
                      RunObject=Report 99000789;
                      Promoted=No;
                      Image=Report;
                      PromotedCategory=Report }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=[ENU=General;
                           NOR=Generelt] }

    { 2   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the work center.;
                           NOR=Angir nummeret for arbeidssenteret.];
                SourceExpr="No.";
                Importance=Promoted;
                OnAssistEdit=BEGIN
                               IF AssistEdit(xRec) THEN
                                 CurrPage.UPDATE;
                             END;
                              }

    { 4   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the name of the work center.;
                           NOR=Angir navnet p† arbeidssenteret.];
                SourceExpr=Name;
                Importance=Promoted }

    { 6   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the work center group, if the work center or underlying machine center is assigned to a work center group.;
                           NOR=Angir arbeidssentergruppen hvis arbeidssenteret eller underliggende produksjonsressurs er tilordnet en arbeidssentergruppe.];
                SourceExpr="Work Center Group Code";
                Importance=Promoted }

    { 69  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies an alternate work center.;
                           NOR=Angir et alternativt arbeidssenter.];
                SourceExpr="Alternate Work Center" }

    { 12  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the search name for the work center.;
                           NOR=Angir s›kenavnet p† arbeidssenteret.];
                SourceExpr="Search Name" }

    { 18  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies whether the work center account is blocked.;
                           NOR=Angir om arbeidssenterkontoen er sperret.];
                SourceExpr=Blocked }

    { 14  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies when the work center card was last modified.;
                           NOR=Angir n†r arbeidssenteret sist ble endret.];
                SourceExpr="Last Date Modified" }

    { 1904784501;1;Group  ;
                CaptionML=[ENU=Posting;
                           NOR=Bokf›ring] }

    { 20  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the direct unit cost of the work center at one unit of measure.;
                           NOR=Angir den direkte enhetskosten for arbeidssenteret i ‚n enhet.];
                SourceExpr="Direct Unit Cost";
                Importance=Promoted }

    { 22  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the indirect costs of the work center, in percent.;
                           NOR=Angir indirekte kostnader i prosent for arbeidssenteret.];
                SourceExpr="Indirect Cost %" }

    { 49  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the overhead rate of this work center.;
                           NOR=Angir indirekte kostnadssats for arbeidssenteret.];
                SourceExpr="Overhead Rate" }

    { 24  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the unit cost at one unit of measure for the machine center.;
                           NOR=Angir enhetskosten for ‚n enhet for produksjonsressursen.];
                SourceExpr="Unit Cost" }

    { 26  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the unit cost calculation that is to be made.;
                           NOR=Angir enhetskostberegningen som skal utf›res.];
                SourceExpr="Unit Cost Calculation";
                Importance=Promoted }

    { 42  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies where to define the unit costs.;
                           NOR=Angir hvor du vil definere enhetskostene.];
                SourceExpr="Specific Unit Cost" }

    { 10  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the dimension value code linked to the work center.;
                           NOR=Angir dimensjonsverdikoden som er knyttet til arbeidssenteret.];
                SourceExpr="Global Dimension 1 Code" }

    { 8   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the dimension value code that the work center is linked to.;
                           NOR=Angir dimensjonsverdikoden som arbeidssenteret er knyttet til.];
                SourceExpr="Global Dimension 2 Code" }

    { 50  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of a subcontractor who supplies this work center.;
                           NOR=Angir nummeret p† en underleverand›r som forsyner dette arbeidssenteret.];
                SourceExpr="Subcontractor No." }

    { 38  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the method to use to calculate the output quantity at this work center.;
                           NOR=Angir metoden som skal brukes til † beregne avgangsantallet ved dette arbeidssenteret.];
                SourceExpr="Flushing Method";
                Importance=Promoted }

    { 58  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a general product posting group.;
                           NOR=Angir en generell varebokf›ringsgruppe.];
                SourceExpr="Gen. Prod. Posting Group";
                Importance=Promoted }

    { 1905773001;1;Group  ;
                CaptionML=[ENU=Scheduling;
                           NOR=Planlegging] }

    { 28  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a unit for production at the work center.;
                           NOR=Angir en produksjonsenhet ved arbeidssenteret.];
                SourceExpr="Unit of Measure Code";
                Importance=Promoted }

    { 30  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the capacity of the work center.;
                           NOR=Angir kapasiteten til arbeidssenteret.];
                SourceExpr=Capacity;
                Importance=Promoted }

    { 32  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the efficiency factor as a percentage of the work center.;
                           NOR=Angir effektivitetsfaktoren i prosent for arbeidssenteret.];
                SourceExpr=Efficiency }

    { 37  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies whether the consolidated calendar is used.;
                           NOR=Angir om den konsoliderte kalenderen brukes.];
                SourceExpr="Consolidated Calendar" }

    { 40  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the shop calendar code that the planning of this work center refers to.;
                           NOR=Angir produksjonskalenderkoden som planleggingen av dette arbeidssenteret viser til.];
                SourceExpr="Shop Calendar Code";
                Importance=Promoted }

    { 60  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the queue time of the work center.;
                           NOR=Angir k›tiden for arbeidssenteret.];
                SourceExpr="Queue Time" }

    { 34  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the queue time unit of measure code.;
                           NOR=Angir enhetskoden for k›tiden.];
                SourceExpr="Queue Time Unit of Meas. Code" }

    { 1907509201;1;Group  ;
                CaptionML=[ENU=Warehouse;
                           NOR=Lager] }

    { 64  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the location where the work center operates by default.;
                           NOR=Angir lokasjonen der arbeidssenteret fungerer som standard.];
                SourceExpr="Location Code";
                OnValidate=BEGIN
                             UpdateEnabled;
                           END;
                            }

    { 66  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the bin that functions as the default open shop floor bin at the work center.;
                           NOR=Angir hyllen som fungerer som standard †pen produksjonshylle p† dette arbeidssenteret.];
                SourceExpr="Open Shop Floor Bin Code";
                Enabled=OpenShopFloorBinCodeEnable }

    { 68  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the bin in the production area where components that are picked for production are placed by default before they can be consumed.;
                           NOR=Angir hyllen i produksjonsomr†det der komponentene som plukkes for produksjon, blir plassert som standard f›r de kan brukes.];
                SourceExpr="To-Production Bin Code";
                Enabled=ToProductionBinCodeEnable }

    { 72  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the bin in the production area where finished end items are taken by default when the process involves warehouse activity.;
                           NOR=Angir hvilken hylle i produksjonsomr†det ferdige varer som standard blir tatt fra, n†r prosessen involverer lageraktivitet.];
                SourceExpr="From-Production Bin Code";
                Enabled=FromProductionBinCodeEnable }

    { 1101103000;1;Group  ;
                Name=Hours registration;
                CaptionML=[ENU=Time Registration;
                           NOR=M›nstring];
                GroupType=Group }

    { 1101103001;2;Field  ;
                SourceExpr="Earliest Time Reg. Start Time" }

    { 1101103002;2;Field  ;
                SourceExpr="Time Reg. Deduct Code Lunch" }

    { 1101103003;2;Field  ;
                SourceExpr="Time Reg. Deduct Code Dinner" }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=TRUE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      OpenShopFloorBinCodeEnable@19054478 : Boolean INDATASET;
      ToProductionBinCodeEnable@19078604 : Boolean INDATASET;
      FromProductionBinCodeEnable@19048183 : Boolean INDATASET;

    LOCAL PROCEDURE UpdateEnabled@1();
    VAR
      Location@1000 : Record 14;
    BEGIN
      IF "Location Code" <> '' THEN
        Location.GET("Location Code");

      OpenShopFloorBinCodeEnable := Location."Bin Mandatory";
      ToProductionBinCodeEnable := Location."Bin Mandatory";
      FromProductionBinCodeEnable := Location."Bin Mandatory";
    END;

    LOCAL PROCEDURE OnActivateForm@19002417();
    BEGIN
      UpdateEnabled;
    END;

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 23.02.10 BVM Nytt faneblad MÛnstring med 2 nye felter
      02. 10.03.10 HHE Fremvist "Earliest start time - time reg"
      03. 11.03.10 HHE Fjernet BVM sine felt i pkt. 1
                       Fremvist felt: "Time reg. deduct code - lunch" og "Time reg. deduct code - dinner"
    }
    END.
  }
}

OBJECT Page 99000760 Machine Center Card
{
  OBJECT-PROPERTIES
  {
    Date=28.09.17;
    Time=13:56:35;
    Modified=Yes;
    Version List=NAVW110.00,INC1.04,OPC6.02;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Machine Center Card;
               NOR=Maskinsenterkort];
    SourceTable=Table99000758;
    PageType=Card;
    OnInit=BEGIN
             FromProductionBinCodeEnable := TRUE;
             ToProductionBinCodeEnable := TRUE;
             OpenShopFloorBinCodeEnable := TRUE;
           END;

    OnOpenPage=BEGIN
                 OnActivateForm;
               END;

    OnAfterGetCurrRecord=BEGIN
                           UpdateEnabled;
                         END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 62      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Mach. Ctr.;
                                 NOR=&Prod.ress];
                      Image=MachineCenter }
      { 66      ;2   ;Action    ;
                      ShortCutKey=Ctrl+F7;
                      CaptionML=[ENU=Capacity Ledger E&ntries;
                                 NOR=&Kapasitetsposter];
                      RunObject=Page 5832;
                      RunPageView=SORTING(Type,No.,Work Shift Code,Item No.,Posting Date);
                      RunPageLink=Type=CONST(Machine Center),
                                  No.=FIELD(No.),
                                  Posting Date=FIELD(Date Filter);
                      Image=CapacityLedger }
      { 19      ;2   ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 NOR=&Merknader];
                      RunObject=Page 99000784;
                      RunPageView=WHERE(Table Name=CONST(Machine Center));
                      RunPageLink=No.=FIELD(No.);
                      Image=ViewComments }
      { 26      ;2   ;Action    ;
                      CaptionML=[ENU=Lo&ad;
                                 NOR=Bel&astning];
                      RunObject=Page 99000889;
                      RunPageLink=No.=FIELD(No.),
                                  Work Shift Filter=FIELD(Work Shift Filter);
                      Promoted=Yes;
                      Image=WorkCenterLoad;
                      PromotedCategory=Process }
      { 18      ;2   ;Separator  }
      { 11      ;2   ;Action    ;
                      ShortCutKey=F7;
                      CaptionML=[ENU=Statistics;
                                 NOR=Statistikk];
                      RunObject=Page 99000762;
                      RunPageLink=No.=FIELD(No.),
                                  Date Filter=FIELD(Date Filter),
                                  Work Shift Filter=FIELD(Work Shift Filter);
                      Promoted=Yes;
                      Image=Statistics;
                      PromotedCategory=Process }
      { 1101103009;2 ;Separator  }
      { 1101103010;2 ;Action    ;
                      Name=Clocking - Normal Time;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Clocking - Normal Time;
                                 NOR=M›nstret - normtid];
                      RunObject=Page 83111;
                      RunPageOnRec=Yes;
                      RunPageLink=No.=FIELD(No.);
                      Promoted=Yes;
                      Image=Timeline;
                      PromotedCategory=Process }
      { 61      ;1   ;ActionGroup;
                      CaptionML=[ENU=Pla&nning;
                                 NOR=Pla&nlegging];
                      Image=Planning }
      { 68      ;2   ;Action    ;
                      CaptionML=[ENU=&Calendar;
                                 NOR=&Kalender];
                      RunObject=Page 99000770;
                      Promoted=Yes;
                      Image=MachineCenterCalendar;
                      PromotedCategory=Process }
      { 40      ;2   ;Action    ;
                      CaptionML=[ENU=A&bsence;
                                 NOR=Fr&av‘r];
                      RunObject=Page 99000772;
                      RunPageLink=Capacity Type=CONST(Machine Center),
                                  No.=FIELD(No.),
                                  Date=FIELD(Date Filter);
                      Promoted=Yes;
                      Image=WorkCenterAbsence;
                      PromotedCategory=Process }
      { 10      ;2   ;Action    ;
                      CaptionML=[ENU=Ta&sk List;
                                 NOR=&Oppg.oversikt];
                      RunObject=Page 99000916;
                      RunPageView=SORTING(Type,No.)
                                  WHERE(Type=CONST(Machine Center),
                                        Status=FILTER(..Released),
                                        Routing Status=FILTER(<>Finished));
                      RunPageLink=No.=FIELD(No.);
                      Image=TaskList }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=[ENU=General;
                           NOR=Generelt] }

    { 2   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the machine center.;
                           NOR=Angir nummeret p† produksjonsressursen.];
                SourceExpr="No.";
                Importance=Promoted;
                OnAssistEdit=BEGIN
                               IF AssistEdit(xRec) THEN
                                 CurrPage.UPDATE;
                             END;
                              }

    { 4   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a name for the machine center.;
                           NOR=Angir et navn for produksjonsressursen.];
                SourceExpr=Name;
                Importance=Promoted }

    { 6   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the work center to assign this machine center to.;
                           NOR=Angir nummeret p† arbeidssenteret som denne produksjonsressursen skal tilordnes.];
                SourceExpr="Work Center No.";
                Importance=Promoted;
                OnValidate=BEGIN
                             UpdateEnabled;
                           END;
                            }

    { 1101103006;2;Field  ;
                SourceExpr="Show in OPC" }

    { 1101103007;2;Field  ;
                SourceExpr=Clocking }

    { 12  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the search name for the machine center.;
                           NOR=Angir s›kenavnet for produksjonsressursen.];
                SourceExpr="Search Name" }

    { 16  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies whether the machine center account is blocked.;
                           NOR=Angir om produksjonsressurskontoen er sperret.];
                SourceExpr=Blocked }

    { 14  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies when the machine center card was last modified.;
                           NOR=Angir n†r produksjonsressurssenteret sist ble endret.];
                SourceExpr="Last Date Modified" }

    { 1904784501;1;Group  ;
                CaptionML=[ENU=Posting;
                           NOR=Bokf›ring] }

    { 20  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the direct unit cost of the machine center at one unit of measure.;
                           NOR=Angir den direkte enhetskosten for produksjonsressursen i ‚n enhet.];
                SourceExpr="Direct Unit Cost";
                Importance=Promoted }

    { 22  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the indirect costs of the machine center in percent.;
                           NOR=Angir indirekte kostnader i prosent for produksjonsressursen.];
                SourceExpr="Indirect Cost %" }

    { 35  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the overhead rate of this machine center.;
                           NOR=Angir indirekte kostnadssats for produksjonsressursen.];
                SourceExpr="Overhead Rate" }

    { 24  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the unit cost at one unit of measure for the machine center.;
                           NOR=Angir enhetskosten for ‚n enhet for produksjonsressursen.];
                SourceExpr="Unit Cost" }

    { 29  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the method to use to calculate the output quantity of the item in the production process.;
                           NOR=Angir metoden som skal brukes til † beregne avgangsantallet for varen i produksjonsprosessen.];
                SourceExpr="Flushing Method";
                Importance=Promoted }

    { 37  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a general product posting group.;
                           NOR=Angir en generell varebokf›ringsgruppe.];
                SourceExpr="Gen. Prod. Posting Group";
                Importance=Promoted }

    { 1905773001;1;Group  ;
                CaptionML=[ENU=Scheduling;
                           NOR=Planlegging] }

    { 31  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the capacity of the machine center.;
                           NOR=Angir kapasiteten til produksjonsressursen.];
                SourceExpr=Capacity;
                Importance=Promoted }

    { 33  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the efficiency factor as a percentage of the machine center.;
                           NOR=Angir effektivitetsfaktoren i prosent for produksjonsressursen.];
                SourceExpr=Efficiency }

    { 8   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the queue time of the machine center.;
                           NOR=Angir k›tiden for produksjonsressursen.];
                SourceExpr="Queue Time" }

    { 27  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the queue time unit of measure code.;
                           NOR=Angir enhetskoden for k›tiden.];
                SourceExpr="Queue Time Unit of Meas. Code" }

    { 1906729701;1;Group  ;
                CaptionML=[ENU=Routing Setup;
                           NOR=Ruteoppsett] }

    { 57  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies how long it takes to set up the machine.;
                           NOR=Angir hvor lang tid det tar † konfigurere maskinen.];
                SourceExpr="Setup Time";
                Importance=Promoted }

    { 77  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the time a job remains at the machine center after an operation is completed, until it is moved to the next operation.;
                           NOR=Angir tiden et prosjekt forblir i produksjonsressursen etter at operasjonen er fullf›rt, f›r det flyttes til neste operasjon.];
                SourceExpr="Wait Time";
                Importance=Promoted }

    { 85  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the move time required for a production lot on this machine.;
                           NOR=Angir transporttiden som er n›dvendig for et produksjonsparti p† denne maskinen.];
                SourceExpr="Move Time";
                Importance=Promoted }

    { 87  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the fixed scrap quantity.;
                           NOR=Angir det faste vrakantallet.];
                SourceExpr="Fixed Scrap Quantity" }

    { 89  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the scrap in percent.;
                           NOR=Angir vrak i prosent.];
                SourceExpr="Scrap %" }

    { 94  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the send-ahead quantity.;
                           NOR=Angir overlappantallet.];
                SourceExpr="Send-Ahead Quantity" }

    { 97  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the minimum process time of the machine center.;
                           NOR=Angir minimum behandlingstid for produksjonsressursen.];
                SourceExpr="Minimum Process Time" }

    { 99  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the maximum process time of the machine center.;
                           NOR=Angir maksimum behandlingstid for produksjonsressursen.];
                SourceExpr="Maximum Process Time" }

    { 32  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies how much available capacity must be concurrently planned for one operation at this machine center.;
                           NOR=Angir hvor mye disponibel kapasitet som m† planlegge samtidig for ‚n operasjon i denne produksjonsressursen.];
                SourceExpr="Concurrent Capacities" }

    { 1907509201;1;Group  ;
                CaptionML=[ENU=Warehouse;
                           NOR=Lager] }

    { 39  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the location where the machine center operates by default.;
                           NOR=Angir lokasjonen der produksjonsressursen fungerer som standard.];
                SourceExpr="Location Code";
                OnValidate=BEGIN
                             UpdateEnabled;
                           END;
                            }

    { 44  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the bin that functions as the default open shop floor bin at the work center.;
                           NOR=Angir hyllen som fungerer som standard †pen produksjonshylle p† dette arbeidssenteret.];
                SourceExpr="Open Shop Floor Bin Code";
                Enabled=OpenShopFloorBinCodeEnable }

    { 46  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the bin where components picked for production are placed by default before they can be consumed.;
                           NOR=Angir hyllen der komponentene som plukkes for produksjon, blir plassert som standard f›r de kan brukes.];
                SourceExpr="To-Production Bin Code";
                Enabled=ToProductionBinCodeEnable }

    { 50  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the bin where finished end items are taken from by default when the process involves warehouse activity.;
                           NOR=Angir hvilken hylle ferdige varer som standard blir tatt fra, n†r prosessen omfatter lageraktivitet.];
                SourceExpr="From-Production Bin Code";
                Enabled=FromProductionBinCodeEnable }

    { 1101103000;1;Group  ;
                Name=Personlig info.;
                CaptionML=[ENU=Person Information;
                           NOR=Personlig informasjoon];
                GroupType=Group }

    { 1101103001;2;Field  ;
                Name=Name 2;
                SourceExpr=Name }

    { 1101103002;2;Field  ;
                SourceExpr=Address }

    { 1101103003;2;Field  ;
                SourceExpr="Address 2" }

    { 1101103004;2;Field  ;
                SourceExpr=City }

    { 1101103005;2;Field  ;
                SourceExpr="Post Code" }

    { 1101103008;2;Field  ;
                SourceExpr="Birth Date" }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=TRUE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      OpenShopFloorBinCodeEnable@19054478 : Boolean INDATASET;
      ToProductionBinCodeEnable@19078604 : Boolean INDATASET;
      FromProductionBinCodeEnable@19048183 : Boolean INDATASET;

    LOCAL PROCEDURE UpdateEnabled@1();
    VAR
      Location@1000 : Record 14;
      EditEnabled@1001 : Boolean;
    BEGIN
      IF "Location Code" <> '' THEN
        Location.GET("Location Code");

      EditEnabled := ("Location Code" <> '') AND Location."Bin Mandatory";
      OpenShopFloorBinCodeEnable := EditEnabled;
      ToProductionBinCodeEnable := EditEnabled;
      FromProductionBinCodeEnable := EditEnabled;
    END;

    LOCAL PROCEDURE OnActivateForm@19002417();
    BEGIN
      UpdateEnabled;
    END;

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01.          ASL Sperret redigering av "Nr."
      02. 16.09.09 HHE Mulig ¹ editere "Nr."-feltet fordi det skal angis gjenkjennbare koder m.h.t. FCS
      -------------------------------------------------                                                                         =>
      OPC:                                                                                                                      =>
          opc1.0 04.11.09 HHE Fremvist felt for "Vises i OPC" og "MÛnstring"                                                    =>
                 17.02.10 HHE Ny fane: Personlig info. (Ûnsket av FRSK: brukes i rapport av mÛnstring)                          =>
                                        fane: Pers.info-> nye felt = Navn, Adr, Adr2, Postnr., Poststed, Birth date              =>
          opc1.0 04.03.10 HHE knapp=Prod.ressurs ->nytt menu item=MÛnstring - normtid
    }
    END.
  }
}

OBJECT Page 99000817 Prod. Order Routing
{
  OBJECT-PROPERTIES
  {
    Date=29.06.17;
    Time=15:04:59;
    Modified=Yes;
    Version List=NAVW110.00,INC1.01,OPC6.01;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Prod. Order Routing;
               NOR=Prod.ordrerute];
    SourceTable=Table5409;
    DataCaptionExpr=Caption;
    PageType=List;
    OnInit=BEGIN
             ProdOrderNoVisible := TRUE;
           END;

    OnOpenPage=BEGIN
                 ProdOrderNoVisible := TRUE;
                 IF GETFILTER("Prod. Order No.") <> '' THEN
                   ProdOrderNoVisible := GETRANGEMIN("Prod. Order No.") <> GETRANGEMAX("Prod. Order No.");
               END;

    OnDeleteRecord=BEGIN
                     CheckPreviousAndNext;
                   END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 30      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Line;
                                 NOR=&Linje];
                      Image=Line }
      { 21      ;2   ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 NOR=&Merknader];
                      RunObject=Page 99000840;
                      RunPageLink=Status=FIELD(Status),
                                  Prod. Order No.=FIELD(Prod. Order No.),
                                  Routing Reference No.=FIELD(Routing Reference No.),
                                  Routing No.=FIELD(Routing No.),
                                  Operation No.=FIELD(Operation No.);
                      Image=ViewComments }
      { 29      ;2   ;Action    ;
                      CaptionML=[ENU=Tools;
                                 NOR=Verkt›y];
                      RunObject=Page 99000844;
                      RunPageLink=Status=FIELD(Status),
                                  Prod. Order No.=FIELD(Prod. Order No.),
                                  Routing Reference No.=FIELD(Routing Reference No.),
                                  Routing No.=FIELD(Routing No.),
                                  Operation No.=FIELD(Operation No.);
                      Image=Tools }
      { 37      ;2   ;Action    ;
                      CaptionML=[ENU=Personnel;
                                 NOR=Personell];
                      RunObject=Page 99000845;
                      RunPageLink=Status=FIELD(Status),
                                  Prod. Order No.=FIELD(Prod. Order No.),
                                  Routing Reference No.=FIELD(Routing Reference No.),
                                  Routing No.=FIELD(Routing No.),
                                  Operation No.=FIELD(Operation No.);
                      Image=User }
      { 38      ;2   ;Action    ;
                      CaptionML=[ENU=Quality Measures;
                                 NOR=Kvalitetsm†l];
                      RunObject=Page 99000834;
                      RunPageLink=Status=FIELD(Status),
                                  Prod. Order No.=FIELD(Prod. Order No.),
                                  Routing Reference No.=FIELD(Routing Reference No.),
                                  Routing No.=FIELD(Routing No.),
                                  Operation No.=FIELD(Operation No.);
                      Image=TaskQualityMeasure }
      { 56      ;2   ;Separator  }
      { 57      ;2   ;Action    ;
                      CaptionML=[ENU=Allocated Capacity;
                                 NOR=Kapasitetstildeling];
                      Image=AllocatedCapacity;
                      OnAction=VAR
                                 ProdOrderCapNeed@1001 : Record 5410;
                               BEGIN
                                 IF Status = Status::Finished THEN
                                   EXIT;
                                 ProdOrderCapNeed.SETCURRENTKEY(Type,"No.","Starting Date-Time");
                                 ProdOrderCapNeed.SETRANGE(Type,Type);
                                 ProdOrderCapNeed.SETRANGE("No.","No.");
                                 ProdOrderCapNeed.SETRANGE(Date,"Starting Date","Ending Date");
                                 ProdOrderCapNeed.SETRANGE("Prod. Order No.","Prod. Order No.");
                                 ProdOrderCapNeed.SETRANGE(Status,Status);
                                 ProdOrderCapNeed.SETRANGE("Routing Reference No.","Routing Reference No.");
                                 ProdOrderCapNeed.SETRANGE("Operation No.","Operation No.");

                                 PAGE.RUNMODAL(0,ProdOrderCapNeed);
                               END;
                                }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 20      ;1   ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 NOR=F&unksjoner];
                      Image=Action }
      { 39      ;2   ;Action    ;
                      CaptionML=[ENU=Order &Tracking;
                                 NOR=&Sporing];
                      Image=OrderTracking;
                      OnAction=VAR
                                 ProdOrderLine@1001 : Record 5406;
                                 TrackingForm@1002 : Page 99000822;
                               BEGIN
                                 ProdOrderLine.SETRANGE(Status,Status);
                                 ProdOrderLine.SETRANGE("Prod. Order No.","Prod. Order No.");
                                 ProdOrderLine.SETRANGE("Routing No.","Routing No.");
                                 IF ProdOrderLine.FINDFIRST THEN BEGIN
                                   TrackingForm.SetProdOrderLine(ProdOrderLine);
                                   TrackingForm.RUNMODAL;
                                 END;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 68  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the production order that this operation is assigned to.;
                           NOR=Angir nummeret p† produksjonsordren som operasjonen er tilordnet.];
                SourceExpr="Prod. Order No.";
                Visible=ProdOrderNoVisible }

    { 58  ;2   ;Field     ;
                ToolTipML=[ENU=Recalculates the underlying capacity need each time a change is made in the schedule of the routing.;
                           NOR=Beregner det underliggende kapasitetsbehovet p† nytt hver gang ruteplanen endres.];
                SourceExpr="Schedule Manually";
                Visible=FALSE }

    { 2   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the operation number.;
                           NOR=Angir operasjonsnummeret.];
                SourceExpr="Operation No." }

    { 22  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the previous operation number.;
                           NOR=Angir det forrige operasjonsnummeret.];
                SourceExpr="Previous Operation No.";
                Visible=FALSE }

    { 18  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the next operation number.;
                           NOR=Angir det neste operasjonsnummeret.];
                SourceExpr="Next Operation No.";
                Visible=FALSE }

    { 4   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the type of operation.;
                           NOR=Angir operasjonstypen.];
                SourceExpr=Type }

    { 6   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a work center number or a machine number, depending on the entry in the Type field.;
                           NOR=Angir nummeret for arbeidssenter eller produksjonsressurs, avhengig av hva som er angitt i feltet Type.];
                SourceExpr="No." }

    { 8   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the description of the operation.;
                           NOR=Angir beskrivelsen av den †pne operasjonen.];
                SourceExpr=Description }

    { 48  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a flushing method for this production order routing line.;
                           NOR=Angir en trekkmetode for produksjonsordrerutelinjen.];
                SourceExpr="Flushing Method";
                Visible=FALSE }

    { 42  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the starting date and the starting time, which are combined in a format called "starting date-time".;
                           NOR=Angir startdatoen og starttidspunktet som er kombinert i et format som kalles "Startdato-tidsp.".];
                SourceExpr="Starting Date-Time" }

    { 10  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the starting time of the routing line (operation).;
                           NOR=Angir starttidspunktet for rutelinjen (operasjonen).];
                SourceExpr="Starting Time";
                Visible=FALSE;
                OnValidate=BEGIN
                             StartingTimeOnAfterValidate;
                           END;
                            }

    { 12  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the starting date of the routing line (operation).;
                           NOR=Angir startdato for rutelinjen (operasjonen).];
                SourceExpr="Starting Date";
                Visible=FALSE;
                OnValidate=BEGIN
                             StartingDateOnAfterValidate;
                           END;
                            }

    { 50  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the ending date and the ending time, which are combined in a format called "ending date-time".;
                           NOR=Angir sluttdatoen og sluttidspunktet som er kombinert i et format som kalles "Sluttdato-tidsp.".];
                SourceExpr="Ending Date-Time" }

    { 14  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the ending time of the routing line (operation).;
                           NOR=Angir sluttidspunktet for rutelinjen (operasjonen).];
                SourceExpr="Ending Time";
                Visible=FALSE;
                OnValidate=BEGIN
                             EndingTimeOnAfterValidate;
                           END;
                            }

    { 16  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the ending date of the routing line (operation).;
                           NOR=Angir sluttdato for rutelinjen (operasjonen).];
                SourceExpr="Ending Date";
                Visible=FALSE;
                OnValidate=BEGIN
                             EndingDateOnAfterValidate;
                           END;
                            }

    { 24  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the setup time of the operation.;
                           NOR=Angir oppstillingstiden for operasjonen.];
                SourceExpr="Setup Time" }

    { 31  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the run time of the operation.;
                           NOR=Angir operasjonstiden for operasjonen.];
                SourceExpr="Run Time" }

    { 33  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the wait time after processing.;
                           NOR=Angir ventetiden etter behandlingen.];
                SourceExpr="Wait Time" }

    { 35  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the move time.;
                           NOR=Angir transporttiden.];
                SourceExpr="Move Time" }

    { 40  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the fixed scrap quantity.;
                           NOR=Angir det faste vrakantallet.];
                SourceExpr="Fixed Scrap Quantity";
                Visible=FALSE }

    { 70  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a routing link code.;
                           NOR=Angir en rutekoblingskode.];
                SourceExpr="Routing Link Code";
                Visible=FALSE }

    { 43  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the scrap factor in percent.;
                           NOR=Angir vrakfaktoren i prosent.];
                SourceExpr="Scrap Factor %";
                Visible=FALSE }

    { 54  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the send-ahead quantity of the operation.;
                           NOR=Angir overlappantall for operasjonen.];
                SourceExpr="Send-Ahead Quantity";
                Visible=FALSE }

    { 52  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the con capacity of the operation.;
                           NOR=Angir forbrukskapasitet for operasjonen.];
                SourceExpr="Concurrent Capacities";
                Visible=FALSE }

    { 60  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the Unit Cost per.;
                           NOR=Angir Enhetskost per.];
                SourceExpr="Unit Cost per";
                Visible=FALSE }

    { 62  ;2   ;Field     ;
                ToolTipML=[ENU=Automatically calculates a value based on the capacity need, when a production order is refreshed or replanned.;
                           NOR=Beregner automatisk verdien basert p† kapasitetsbehovet ved oppdatering eller ny planlegging av en produksjonsordre.];
                SourceExpr="Expected Operation Cost Amt.";
                Visible=FALSE }

    { 64  ;2   ;Field     ;
                ToolTipML=[ENU=Automatically calculates a value based on the capacity need, when a production order is refreshed or replanned.;
                           NOR=Beregner automatisk verdien basert p† kapasitetsbehovet ved oppdatering eller ny planlegging av en produksjonsordre.];
                SourceExpr="Expected Capacity Ovhd. Cost";
                Visible=FALSE }

    { 66  ;2   ;Field     ;
                Name=Expected Capacity Need;
                CaptionML=[ENU=Expected Capacity Need;
                           NOR=Forventet kapasitetsbehov];
                DecimalPlaces=0:5;
                SourceExpr="Expected Capacity Need" / ExpCapacityNeed;
                Visible=FALSE }

    { 45  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the status of the routing line, such as Planned, In Progress, or Finished.;
                           NOR=Angir status for rutelinjen, for eksempel Planlagt, I arbeid eller Ferdig.];
                SourceExpr="Routing Status";
                Visible=FALSE }

    { 78  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the location where the machine or work center on the production order routing line operates.;
                           NOR=Angir lokasjonen der produksjonsressursen eller arbeidssenteret p† produksjonsordrerutelinjen opererer.];
                SourceExpr="Location Code";
                Visible=FALSE }

    { 72  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the corresponding bin at the machine or work center, if the location code matches the setup of that machine or work center.;
                           NOR=Angir den tilsvarende hyllen p† produksjonsressursen eller arbeidssenteret hvis lokasjonskoden samsvarer med oppsettet for produksjonsressursen eller arbeidssenteret.];
                SourceExpr="Open Shop Floor Bin Code";
                Visible=FALSE }

    { 74  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the bin that holds components with a flushing method, that involves a warehouse activity to bring the items to the bin.;
                           NOR=Angir hyllen som har komponenter med en trekkmetode som omfatter en lageraktivitet for † plassere varene p† hyllen.];
                SourceExpr="To-Production Bin Code";
                Visible=FALSE }

    { 76  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the corresponding bin at the machine or work center if the location code matches the setup of that machine or work center.;
                           NOR=Angir den tilsvarende hyllen p† produksjonsressursen eller arbeidssenteret hvis lokasjonskoden samsvarer med oppsettet for produksjonsressursen eller arbeidssenteret.];
                SourceExpr="From-Production Bin Code";
                Visible=FALSE }

    { 1101103000;2;Field  ;
                SourceExpr="Scrap Quantity" }

    { 1101103001;2;Field  ;
                SourceExpr="Minimum Starting Date" }

    { 1101103002;2;Field  ;
                SourceExpr="Minimum Starting Time" }

    { 1101103003;2;Field  ;
                SourceExpr="Output Quantity" }

    { 1101103004;2;Field  ;
                SourceExpr="Queue time (minutes)" }

    { 1101103005;2;Field  ;
                SourceExpr="Dokument Link" }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      ProdOrderNoVisible@19039876 : Boolean INDATASET;

    LOCAL PROCEDURE ExpCapacityNeed@2() : Decimal;
    VAR
      WorkCenter@1001 : Record 99000754;
      CalendarMgt@1000 : Codeunit 99000755;
    BEGIN
      IF "Work Center No." = '' THEN
        EXIT(1);
      WorkCenter.GET("Work Center No.");
      EXIT(CalendarMgt.TimeFactor(WorkCenter."Unit of Measure Code"));
    END;

    LOCAL PROCEDURE StartingTimeOnAfterValidate@19008557();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE StartingDateOnAfterValidate@19020273();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE EndingTimeOnAfterValidate@19075483();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE EndingDateOnAfterValidate@19076447();
    BEGIN
      CurrPage.UPDATE;
    END;

    PROCEDURE Initialize@1(NewCaption@1000 : Text);
    BEGIN
      CurrPage.CAPTION(NewCaption);
    END;

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 16.12.09 HHE Fremvist "Tilknyttet dokument" (OPC)
    }
    END.
  }
}

OBJECT Page 99000823 Output Journal
{
  OBJECT-PROPERTIES
  {
    Date=26.10.17;
    Time=16:03:59;
    Modified=Yes;
    Version List=NAVW110.00,OPC6.01;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Output Journal;
               NOR=Ferdigmeldingskladd];
    SaveValues=Yes;
    SourceTable=Table83;
    DelayedInsert=Yes;
    DataCaptionFields=Journal Batch Name;
    PageType=Worksheet;
    AutoSplitKey=Yes;
    OnOpenPage=VAR
                 JnlSelected@1000 : Boolean;
               BEGIN
                 IF IsOpenedFromBatch THEN BEGIN
                   CurrentJnlBatchName := "Journal Batch Name";
                   ItemJnlMgt.OpenJnl(CurrentJnlBatchName,Rec);
                   EXIT;
                 END;
                 ItemJnlMgt.TemplateSelection(PAGE::"Output Journal",5,FALSE,Rec,JnlSelected);
                 IF NOT JnlSelected THEN
                   ERROR('');
                 ItemJnlMgt.OpenJnl(CurrentJnlBatchName,Rec);
               END;

    OnAfterGetRecord=BEGIN
                       ShowShortcutDimCode(ShortcutDimCode);
                     END;

    OnNewRecord=BEGIN
                  SetUpNewLine(xRec);
                  VALIDATE("Entry Type","Entry Type"::Output);
                  CLEAR(ShortcutDimCode);
                END;

    OnInsertRecord=BEGIN
                     OPCCheckJournalName(CurrentJnlBatchName);//02. 26.10.17 JAL
                   END;

    OnDeleteRecord=VAR
                     ReserveItemJnlLine@1000 : Codeunit 99000835;
                   BEGIN
                     COMMIT;
                     IF NOT ReserveItemJnlLine.DeleteLineConfirm(Rec) THEN
                       EXIT(FALSE);
                     ReserveItemJnlLine.DeleteLine(Rec);
                   END;

    OnAfterGetCurrRecord=BEGIN
                           ItemJnlMgt.GetOutput(Rec,ProdOrderDescription,OperationName);
                         END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 35      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Line;
                                 NOR=&Linje];
                      Image=Line }
      { 44      ;2   ;Action    ;
                      AccessByPermission=TableData 348=R;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 NOR=Dimensjoner];
                      ToolTipML=[ENU=View or edit dimensions, such as area, project, or department, that you can assign to sales and purchase documents to distribute costs and analyze transaction history.;
                                 NOR=Vis eller rediger dimensjoner, for eksempel omr†de, prosjekt eller avdeling, som du kan tilordne til salgs- og kj›psdokumenter for † distribuere kostnader og analysere transaksjonshistorikk.];
                      Promoted=Yes;
                      Image=Dimensions;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 ShowDimensions;
                                 CurrPage.SAVERECORD;
                               END;
                                }
      { 45      ;2   ;Action    ;
                      Name=Item Tracking Lines;
                      ShortCutKey=Shift+Ctrl+I;
                      CaptionML=[ENU=Item &Tracking Lines;
                                 NOR=Vare&sporingslinjer];
                      Image=ItemTrackingLines;
                      OnAction=BEGIN
                                 OpenItemTrackingLines(FALSE);
                               END;
                                }
      { 46      ;2   ;Action    ;
                      CaptionML=[ENU=Bin Contents;
                                 NOR=Hylleinnhold];
                      RunObject=Page 7305;
                      RunPageView=SORTING(Location Code,Bin Code,Item No.,Variant Code);
                      RunPageLink=Location Code=FIELD(Location Code),
                                  Item No.=FIELD(Item No.),
                                  Variant Code=FIELD(Variant Code);
                      Image=BinContent }
      { 18      ;1   ;ActionGroup;
                      CaptionML=[ENU=Pro&d. Order;
                                 NOR=Pro&d.ordre];
                      Image=Order }
      { 19      ;2   ;Action    ;
                      ShortCutKey=Shift+F7;
                      CaptionML=[ENU=Card;
                                 NOR=Kort];
                      RunObject=Page 99000831;
                      RunPageLink=No.=FIELD(Order No.);
                      Image=EditLines }
      { 20      ;2   ;ActionGroup;
                      CaptionML=[ENU=Ledger E&ntries;
                                 NOR=Post&er];
                      Image=Entries }
      { 21      ;3   ;Action    ;
                      ShortCutKey=Ctrl+F7;
                      CaptionML=[ENU=Item Ledger E&ntries;
                                 NOR=&Vareposter];
                      RunObject=Page 38;
                      RunPageView=SORTING(Order Type,Order No.);
                      RunPageLink=Order Type=CONST(Production),
                                  Order No.=FIELD(Order No.);
                      Image=ItemLedger }
      { 22      ;3   ;Action    ;
                      CaptionML=[ENU=Capacity Ledger Entries;
                                 NOR=Kapasitetsposter];
                      RunObject=Page 5832;
                      RunPageView=SORTING(Order Type,Order No.);
                      RunPageLink=Order Type=CONST(Production),
                                  Order No.=FIELD(Order No.);
                      Promoted=No;
                      Image=CapacityLedger;
                      PromotedCategory=Process }
      { 25      ;3   ;Action    ;
                      CaptionML=[ENU=Value Entries;
                                 NOR=Verdiposter];
                      RunObject=Page 5802;
                      RunPageView=SORTING(Order Type,Order No.);
                      RunPageLink=Order Type=CONST(Production),
                                  Order No.=FIELD(Order No.);
                      Image=ValueLedger }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 36      ;1   ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 NOR=F&unksjoner];
                      Image=Action }
      { 39      ;2   ;Action    ;
                      CaptionML=[ENU=Explode &Routing;
                                 NOR=Utfold &rute];
                      RunObject=Codeunit 5406;
                      Promoted=Yes;
                      Image=ExplodeRouting;
                      PromotedCategory=Process }
      { 1101103002;2 ;Action    ;
                      Name=Import Times from Kronos;
                      CaptionML=NOR=Les inn tider fra Kronos;
                      Promoted=Yes;
                      Image=Import;
                      PromotedCategory=Process }
      { 29      ;1   ;ActionGroup;
                      CaptionML=[ENU=P&osting;
                                 NOR=B&okf›ring];
                      Image=Post }
      { 41      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Test Report;
                                 NOR=Kontrollrapport];
                      ToolTipML=[ENU=View a test report so that you can find and correct any errors before you perform the actual posting of the journal or document.;
                                 NOR=Vis en kontrollrapport slik at du kan finne og rette eventuelle feil f›r du bokf›rer kladden eller dokumentet.];
                      Image=TestReport;
                      OnAction=BEGIN
                                 ReportPrint.PrintItemJnlLine(Rec);
                               END;
                                }
      { 56      ;2   ;Action    ;
                      Name=Post;
                      ShortCutKey=F9;
                      CaptionML=[ENU=P&ost;
                                 NOR=B&okf›r];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PostOrder;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 TrySetApplyToEntries;
                                 PostingItemJnlFromProduction(FALSE);
                                 CurrentJnlBatchName := GETRANGEMAX("Journal Batch Name");
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 57      ;2   ;Action    ;
                      ShortCutKey=Shift+F9;
                      CaptionML=[ENU=Post and &Print;
                                 NOR=Bokf›r og &skriv ut];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PostPrint;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 TrySetApplyToEntries;
                                 PostingItemJnlFromProduction(TRUE);
                                 CurrentJnlBatchName := GETRANGEMAX("Journal Batch Name");
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 31      ;1   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=&Print;
                                 NOR=&Skriv ut];
                      Promoted=Yes;
                      Image=Print;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ItemJnlLine@1001 : Record 83;
                               BEGIN
                                 ItemJnlLine.COPY(Rec);
                                 ItemJnlLine.SETRANGE("Journal Template Name","Journal Template Name");
                                 ItemJnlLine.SETRANGE("Journal Batch Name","Journal Batch Name");
                                 REPORT.RUNMODAL(REPORT::"Inventory Movement",TRUE,TRUE,ItemJnlLine);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 78  ;1   ;Field     ;
                Lookup=Yes;
                CaptionML=[ENU=Batch Name;
                           NOR=Bunkenavn];
                ToolTipML=[ENU=Specifies the name of the journal batch of the output journal.;
                           NOR=Angir navnet p† kladden for ferdigmeldingskladden.];
                SourceExpr=CurrentJnlBatchName;
                OnValidate=BEGIN
                             ItemJnlMgt.CheckName(CurrentJnlBatchName,Rec);
                             CurrentJnlBatchNameOnAfterVali;
                             OPCCheckJournalName(CurrentJnlBatchName);//02. 26.10.17 JAL
                           END;

                OnLookup=BEGIN
                           CurrPage.SAVERECORD;
                           ItemJnlMgt.LookupName(CurrentJnlBatchName,Rec);
                           CurrPage.UPDATE(FALSE);
                           ItemJnlMgt.CheckName(CurrentJnlBatchName,Rec);
                         END;
                          }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 66  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the posting date for the entry.;
                           NOR=Angir postens bokf›ringsdato.];
                SourceExpr="Posting Date" }

    { 1101103000;2;Field  ;
                SourceExpr="Innlesnings status" }

    { 60  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the order that created the entry.;
                           NOR=Angir nummeret for ordren som opprettet posten.];
                SourceExpr="Order No.";
                OnValidate=BEGIN
                             ItemJnlMgt.GetOutput(Rec,ProdOrderDescription,OperationName);
                           END;
                            }

    { 2   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a document number for the journal line.;
                           NOR=Angir et dokumentnummer for kladdelinjen.];
                SourceExpr="Document No." }

    { 14  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the item on the journal line.;
                           NOR=Angir nummeret p† varen p† kladdelinjen.];
                SourceExpr="Item No.";
                OnValidate=BEGIN
                             ShowShortcutDimCode(ShortcutDimCode);
                           END;

                OnLookup=BEGIN
                           LookupItemNo;
                           ShowShortcutDimCode(ShortcutDimCode);
                         END;
                          }

    { 64  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the production operation on the item journal line when the journal functions as an output journal.;
                           NOR=Angir nummeret for produksjonsoperasjonen p† varekladdelinjen n†r kladden fungerer som en ferdigmeldingskladd.];
                SourceExpr="Operation No.";
                OnValidate=BEGIN
                             ItemJnlMgt.GetOutput(Rec,ProdOrderDescription,OperationName);
                           END;
                            }

    { 4   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the line number of the order that created the entry.;
                           NOR=Angir linjenummeret til ordren som opprettet posten.];
                SourceExpr="Order Line No." }

    { 80  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the journal type, which is either Work Center or Machine Center.;
                           NOR=Angir kladdetypen, som er enten Arbeidssenter eller Produksjonsressurs.];
                OptionCaptionML=[ENU=Work Center,Machine Center;
                                 NOR=Arbeidssenter,Maskinsenter];
                SourceExpr=Type }

    { 82  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of a work center or a machine center, depending on the entry in the Type field.;
                           NOR=Angir nummeret for produksjonsressursen eller arbeidssenteret, avhengig av hva som er angitt i feltet Type.];
                SourceExpr="No." }

    { 5   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a variant code for the item.;
                           NOR=Angir en variantkode for varen.];
                SourceExpr="Variant Code";
                Visible=FALSE }

    { 84  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a description of the item on the journal line.;
                           NOR=Angir en beskrivelse av varen p† kladdelinjen.];
                SourceExpr=Description }

    { 114 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the work shift code for this Journal line.;
                           NOR=Angir arbeidsskiftkoden for denne kladdelinjen.];
                SourceExpr="Work Shift Code";
                Visible=FALSE }

    { 118 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the dimension value code that the item journal line is linked to.;
                           NOR=Angir dimensjonsverdikoden som varekladdelinjen er knyttet til.];
                SourceExpr="Shortcut Dimension 1 Code";
                Visible=FALSE }

    { 10  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code of the general business posting group that will be used when you post the entry on the item journal line.;
                           NOR=Angir firmabokf›ringsgruppen som brukes n†r du bokf›rer posten p† varekladdelinjen.];
                SourceExpr="Gen. Bus. Posting Group";
                Visible=FALSE }

    { 12  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code of the general product posting group that will be used for this item when you post the entry on the item journal line.;
                           NOR=Angir koden for varebokf›ringsgruppen som skal brukes for varen n†r du bokf›rer posten p† varekladdelinjen.];
                SourceExpr="Gen. Prod. Posting Group";
                Visible=FALSE }

    { 120 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the dimension value code that the item journal line is linked to.;
                           NOR=Angir dimensjonsverdikoden som varekladdelinjen er knyttet til.];
                SourceExpr="Shortcut Dimension 2 Code";
                Visible=FALSE }

    { 300 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[3];
                CaptionClass='1,2,3';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(3),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(3,ShortcutDimCode[3]);
                           END;
                            }

    { 302 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[4];
                CaptionClass='1,2,4';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(4),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(4,ShortcutDimCode[4]);
                           END;
                            }

    { 304 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[5];
                CaptionClass='1,2,5';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(5),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(5,ShortcutDimCode[5]);
                           END;
                            }

    { 306 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[6];
                CaptionClass='1,2,6';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(6),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(6,ShortcutDimCode[6]);
                           END;
                            }

    { 308 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[7];
                CaptionClass='1,2,7';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(7),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(7,ShortcutDimCode[7]);
                           END;
                            }

    { 310 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[8];
                CaptionClass='1,2,8';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(8),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(8,ShortcutDimCode[8]);
                           END;
                            }

    { 94  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the starting time of the operation on the item journal line.;
                           NOR=Angir starttidspunktet for operasjonen p† varekladdelinjen.];
                SourceExpr="Starting Time";
                Visible=FALSE }

    { 96  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the ending time of the operation on the item journal line.;
                           NOR=Angir sluttidspunktet for operasjonen p† varekladdelinjen.];
                SourceExpr="Ending Time";
                Visible=FALSE }

    { 98  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the concurrent capacity.;
                           NOR=Angir den samtidige kapasiteten.];
                SourceExpr="Concurrent Capacity";
                Visible=FALSE }

    { 8   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the time required to set up the machines for this journal line.;
                           NOR=Angir hvor lang tid det tar † konfigurere maskinene for denne kladdelinjen.];
                SourceExpr="Setup Time";
                Visible=FALSE }

    { 86  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the run time of the operations represented by this journal line.;
                           NOR=Angir kj›retiden for operasjonene som representeres av denne kladdelinjen.];
                SourceExpr="Run Time" }

    { 3   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the unit of measure code for the capacity usage.;
                           NOR=Angir enhetskoden for kapasitetsbruken.];
                SourceExpr="Cap. Unit of Measure Code" }

    { 88  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the unit cost of the item on the line.;
                           NOR=Angir enhetskosten for varen p† linjen.];
                SourceExpr="Unit Cost";
                Visible=FALSE }

    { 100 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for the inventory location where the item on the journal line will be registered.;
                           NOR=Angir koden for lagerlokasjonen der varen p† kladdelinjen skal registreres.];
                SourceExpr="Location Code";
                Visible=FALSE }

    { 28  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a bin code for the item.;
                           NOR=Angir en hyllekode for varen.];
                SourceExpr="Bin Code";
                Visible=FALSE }

    { 112 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the scrap code.;
                           NOR=Angir vrakkoden.];
                SourceExpr="Scrap Code";
                Visible=FALSE }

    { 126 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the quantity of the produced item that can be posted as output on the journal line.;
                           NOR=Angir mengden av den produserte varen som kan bokf›res som avgang p† kladdelinjen.];
                SourceExpr="Output Quantity" }

    { 1101103001;2;Field  ;
                SourceExpr="Employee no." }

    { 128 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of units produced incorrectly, and therefore cannot be used.;
                           NOR=Angir antall enheter som ble feilprodusert, og som dermed ikke kan brukes.];
                SourceExpr="Scrap Quantity" }

    { 26  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code if you have filled in the Sales Unit of Measure field on the item card.;
                           NOR=Angir koden hvis du har fylt ut feltet Salgsenhet p† varekortet.];
                SourceExpr="Unit of Measure Code" }

    { 122 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies that the operation represented by the output journal line is finished.;
                           NOR=Angir at operasjonen som er representert av ferdigmeldingskladdelinjen, er fullf›rt.];
                SourceExpr=Finished }

    { 33  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies if the quantity in the item journal line should be applied to an already-posted document.;
                           NOR=Angir om antallet p† varekladdelinjen skal utlignes mot et bilag som allerede er bokf›rt.];
                SourceExpr="Applies-to Entry" }

    { 134 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date on the document that provides the basis for the entry on the item journal line.;
                           NOR=Angir datoen p† bilaget som danner grunnlaget for posten p† varekladdelinjen.];
                SourceExpr="Document Date";
                Visible=FALSE }

    { 136 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a document number referring to the customer or vendor numbering system with whom you are trading items on this journal line.;
                           NOR=Angir et dokumentnummer som refererer til nummereringssystemet for en kunde eller en leverand›r du handler varer med p† denne kladdelinjen.];
                SourceExpr="External Document No.";
                Visible=FALSE }

    { 73  ;1   ;Group      }

    { 1902114901;2;Group  ;
                GroupType=FixedLayout }

    { 1903098501;3;Group  ;
                CaptionML=[ENU=Prod. Order Name;
                           NOR=Prod.ordrenavn] }

    { 74  ;4   ;Field     ;
                SourceExpr=ProdOrderDescription;
                Editable=FALSE;
                ShowCaption=No }

    { 1901991301;3;Group  ;
                CaptionML=[ENU=Operation;
                           NOR=Operasjon] }

    { 76  ;4   ;Field     ;
                CaptionML=[ENU=Operation;
                           NOR=Operasjon];
                ToolTipML=[ENU=Specifies the abbreviated task description.;
                           NOR=Angir den forkortede oppgavebeskrivelsen.];
                SourceExpr=OperationName;
                Editable=FALSE }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      ItemJnlMgt@1000 : Codeunit 240;
      ReportPrint@1001 : Codeunit 228;
      ProdOrderDescription@1002 : Text[50];
      OperationName@1003 : Text[50];
      CurrentJnlBatchName@1004 : Code[10];
      ShortcutDimCode@1005 : ARRAY [8] OF Code[20];

    LOCAL PROCEDURE CurrentJnlBatchNameOnAfterVali@19002411();
    BEGIN
      CurrPage.SAVERECORD;
      ItemJnlMgt.SetName(CurrentJnlBatchName,Rec);
      CurrPage.UPDATE(FALSE);
    END;

    LOCAL PROCEDURE TrySetApplyToEntries@101();
    VAR
      ItemLedgerEntry@1005 : Record 32;
      ItemJournalLine2@1001 : Record 83;
      ReservationEntry@1002 : Record 337;
    BEGIN
      ItemJournalLine2.COPY(Rec);
      IF ItemJournalLine2.FINDSET THEN
        REPEAT
          IF FindReservationsReverseOutput(ReservationEntry,ItemJournalLine2) THEN
            REPEAT
              IF FindILEFromReservation(ItemLedgerEntry,ItemJournalLine2,ReservationEntry,"Order No.") THEN BEGIN
                ReservationEntry.VALIDATE("Appl.-to Item Entry",ItemLedgerEntry."Entry No.");
                ReservationEntry.MODIFY(TRUE);
              END;
            UNTIL ReservationEntry.NEXT = 0;

        UNTIL ItemJournalLine2.NEXT = 0;
    END;

    LOCAL PROCEDURE FindReservationsReverseOutput@19(VAR ReservationEntry@1001 : Record 337;ItemJnlLine@1000 : Record 83) : Boolean;
    BEGIN
      IF ItemJnlLine.Quantity >= 0 THEN
        EXIT(FALSE);

      ReservationEntry.SETCURRENTKEY(
        "Source ID","Source Ref. No.","Source Type","Source Subtype",
        "Source Batch Name","Source Prod. Order Line");
      ReservationEntry.SETRANGE("Source ID",ItemJnlLine."Journal Template Name");
      ReservationEntry.SETRANGE("Source Ref. No.",ItemJnlLine."Line No.");
      ReservationEntry.SETRANGE("Source Type",DATABASE::"Item Journal Line");
      ReservationEntry.SETRANGE("Source Subtype",ItemJnlLine."Entry Type");
      ReservationEntry.SETRANGE("Source Batch Name",ItemJnlLine."Journal Batch Name");

      ReservationEntry.SETFILTER("Serial No.",'<>%1','');
      ReservationEntry.SETRANGE("Qty. to Handle (Base)",-1);
      ReservationEntry.SETRANGE("Appl.-to Item Entry",0);

      EXIT(ReservationEntry.FINDSET);
    END;

    LOCAL PROCEDURE FindILEFromReservation@20(VAR ItemLedgerEntry@1000 : Record 32;ItemJnlLine@1001 : Record 83;ReservationEntry@1002 : Record 337;ProductionOrderNo@1003 : Code[20]) : Boolean;
    BEGIN
      ItemLedgerEntry.SETCURRENTKEY("Item No.",Open,"Variant Code",Positive,
        "Location Code","Posting Date","Expiration Date","Lot No.","Serial No.");

      ItemLedgerEntry.SETRANGE("Item No.",ItemJnlLine."Item No.");
      ItemLedgerEntry.SETRANGE(Open,TRUE);
      ItemLedgerEntry.SETRANGE("Variant Code",ItemJnlLine."Variant Code");
      ItemLedgerEntry.SETRANGE(Positive,TRUE);
      ItemLedgerEntry.SETRANGE("Location Code",ItemJnlLine."Location Code");
      ItemLedgerEntry.SETRANGE("Serial No.",ReservationEntry."Lot No.");
      ItemLedgerEntry.SETRANGE("Serial No.",ReservationEntry."Serial No.");
      ItemLedgerEntry.SETRANGE("Document No.",ProductionOrderNo);

      EXIT(ItemLedgerEntry.FINDSET);
    END;

    LOCAL PROCEDURE __INC__@1101103000();
    BEGIN
    END;

    [Integration(TRUE,TRUE)]
    LOCAL PROCEDURE OPCCheckJournalName@1101103001(VAR CurrentJnlBatchNameP@1101103000 : Code[10]);
    BEGIN
    END;

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 07.10.10 HHE OPC: sperrer tilgang til Bunkenavn = Bunkenavn i OPC-oppsett. Ärsak. OPC stopper dersom
                             det finnes manuelt utfylte kladdelinjer som ikke er gyldige og komplet
      02. 26.10.17 JAL Added event OPCCheckJournalName
    }
    END.
  }
}

