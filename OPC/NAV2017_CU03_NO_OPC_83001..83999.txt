OBJECT Table 83001 OPC Setup
{
  OBJECT-PROPERTIES
  {
    Date=20.04.17;
    Time=16.20.12;
    Modified=Yes;
    Version List=OPC1.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=OPC Setup;
               NOR=OPC Oppsett];
  }
  FIELDS
  {
    { 1   ;   ;Primary Key         ;Code10        ;CaptionML=[ENU=Primary Key;
                                                              NOR=Prim‘r n›kkel] }
    { 10  ;   ;Output Template Name Qty;Code10    ;TableRelation="Item Journal Template".Name;
                                                   CaptionML=[ENU=Output Template Name Qty;
                                                              NOR=Ferdigmeld.kladd mal - antall] }
    { 20  ;   ;Output Jrn Batch Name Qty;Code10   ;TableRelation="Item Journal Batch".Name WHERE (Journal Template Name=FIELD(Output Template Name Qty));
                                                   CaptionML=[ENU=Output Jrn Batch Name Qty;
                                                              NOR=Ferdigmeld.kladdnavn - antall] }
    { 30  ;   ;Output Batch Name Time;Code10      ;TableRelation="Item Journal Template".Name;
                                                   CaptionML=[ENU=Output Batch Name Time;
                                                              NOR=Ferdigmeld.kladd mal - tid] }
    { 40  ;   ;Output Jrn Name Time;Code10        ;TableRelation="Item Journal Batch".Name WHERE (Journal Template Name=FIELD(Output Batch Name Time));
                                                   CaptionML=[ENU=Output Jrn Name Time;
                                                              NOR=Ferdigmeld.kladdnavn - tid] }
    { 100 ;   ;Document No. Ind.Time;Code10       ;CaptionML=[ENU=Document No. Ind.Time;
                                                              NOR=Bilagsnr. Ind.Tid] }
    { 200 ;   ;Item Reclass. Journal (templ.);Code10;
                                                   TableRelation="Item Journal Template".Name;
                                                   CaptionML=[ENU=Item Reclass. Journal;
                                                              NOR=Vareoverf›ringskladd mal (flytting)] }
    { 201 ;   ;Item Reclass. Journal (Name);Code10;TableRelation="Item Journal Batch".Name WHERE (Journal Template Name=FIELD("Item Reclass. Journal (templ.)"));
                                                   CaptionML=NOR=Vareoverf›ringskladdnavn }
    { 202 ;   ;OPC-Move Location Code;Code10      ;TableRelation=Location.Code;
                                                   CaptionML=NOR=Lokasjonskode - OPC-flytt fra }
    { 300 ;   ;Warning Picture     ;BLOB          ;CaptionML=[ENU=Warning Picture;
                                                              NOR=Advarsler bilde];
                                                   SubType=Bitmap }
    { 400 ;   ;Item Journal Template Name;Code10  ;TableRelation="Item Journal Template";
                                                   CaptionML=[ENU=Item Journal Template Name;
                                                              NOR=Varekladdemalnavn] }
    { 410 ;   ;Item Journal Batch Name;Code10     ;TableRelation="Item Journal Batch".Name WHERE (Journal Template Name=FIELD(Item Journal Template Name));
                                                   CaptionML=[ENU=Item Journal Batch Name;
                                                              NOR=Varekladdenavn] }
    { 500 ;   ;Show Error Log Message;Boolean     ;CaptionML=[ENU=Show Error Log Message;
                                                              NOR=Vis feilmelding fra feillogg] }
  }
  KEYS
  {
    {    ;Primary Key                             ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    {
      ----------------------------------------------
      SI-DATA AS

      OPC
      ----------------------------------------------
      No  Date      ID      Description
      ----------------------------------------------
      001 06.12.05  ASL     Tabell oppgrader 4.0SP1
      002 29.03.06  ASL     Lagt til felt Document No. Ind.Time, brukes til tidsbokf›ring
                            uten tilknyttning til Prod.Ordre.
      003 17.08.10  HHE     Nytt felt:"Item Reclass. Journal (templ.)" (brukes i OPC - flytt komponent)
                            Nytt felt:"Item Reclass. Journal (Name)"   (brukes i OPC - flytt komponent)
      004 19.08.10  HHE     Nytt felt "OPC-Move Location Code". Brukes i OPC-flytt som "Fra lokasjon"
    }
    END.
  }
}

OBJECT Table 83002 OPC - Information Message
{
  OBJECT-PROPERTIES
  {
    Date=20.04.17;
    Time=16.20.12;
    Modified=Yes;
    Version List=OPC2.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=OPC - Information Message;
               NOR=OPC - Oppslagstavle];
  }
  FIELDS
  {
    { 1   ;   ;Entry No.           ;Integer       ;CaptionML=[ENU=Entry No.;
                                                              NOR=L›penr.] }
    { 10  ;   ;Description         ;Text250       ;Width=250;
                                                   CaptionML=[ENU=Description;
                                                              NOR=Beskrivelse] }
    { 20  ;   ;Last Modified       ;DateTime      ;CaptionML=[ENU=Last Modified;
                                                              NOR=Sist oppdatert] }
  }
  KEYS
  {
    {    ;Entry No.                               ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    PROCEDURE GetNextEntryNo@1101103001() : Integer;
    VAR
      OPCInformationMessageL@1101103000 : Record 83002;
    BEGIN
      IF OPCInformationMessageL.FINDLAST THEN BEGIN
        IF OPCInformationMessageL."Entry No." = 0 THEN
          EXIT(1);
        EXIT((OPCInformationMessageL."Entry No." + 1));
      END
      ELSE
        EXIT(1);
    END;

    BEGIN
    {
      +---------------------------------------+
      | SI-Data                               |
      +---------------------------------------+
      Nr. Dato     Id    Beskrivelse
      01. mar06    HHE   Opprettet tabell (tekstlinjer 1-10)
      02. 15.12.06 HHE   Opprettet Tekstlinje 11-15 (›nske fra Odd)
    }
    END.
  }
}

OBJECT Table 83003 Work Time
{
  OBJECT-PROPERTIES
  {
    Date=20.04.17;
    Time=16.20.12;
    Modified=Yes;
    Version List=OPC (RSI);
  }
  PROPERTIES
  {
    CaptionML=[ENU=Work Time;
               NOR=Arbeidstid];
    LookupPageID=Page71008;
    DrillDownPageID=Page71008;
  }
  FIELDS
  {
    { 1   ;   ;Code                ;Code10        ;CaptionML=NOR=Kode }
    { 2   ;   ;Day Type            ;Option        ;CaptionML=NOR=Dagtype;
                                                   OptionCaptionML=NOR=Normal dag,Helligdag,L›rdag;
                                                   OptionString=Normal Day,Holiday,Saturday }
    { 3   ;   ;Description         ;Text30        ;CaptionML=NOR=Beskrivelse }
    { 7   ;   ;Time Type           ;Option        ;CaptionML=NOR=Tidstype;
                                                   OptionCaptionML=NOR=Dagtid,Overtid 50%,Overtid 100%;
                                                   OptionString=Daytime,Overtime 50%,Overtime 100% }
    { 8   ;   ;From Time           ;Time          ;OnValidate=BEGIN
                                                                CalulateDuration;
                                                              END;

                                                   CaptionML=NOR=Fra klokken }
    { 9   ;   ;To Time             ;Time          ;OnValidate=BEGIN
                                                                CalulateDuration;
                                                              END;

                                                   CaptionML=NOR=Til klokken }
    { 10  ;   ;Duration            ;Decimal       ;CaptionML=NOR=Timer;
                                                   Editable=No }
  }
  KEYS
  {
    {    ;Code,Day Type                           ;Clustered=Yes }
    {    ;Time Type                                }
    {    ;From Time,To Time,Day Type,Time Type     }
    {    ;Day Type,Time Type                       }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    PROCEDURE CalulateDuration@1117700000();
    BEGIN
      IF (("From Time" <> 0T) AND ("To Time" <> 0T)) THEN
        Duration := (("To Time" - "From Time") / 3600000);
    END;

    BEGIN
    END.
  }
}

OBJECT Table 83004 Work Type Code
{
  OBJECT-PROPERTIES
  {
    Date=20.04.17;
    Time=16.20.12;
    Modified=Yes;
    Version List=OPC (RSI);
  }
  PROPERTIES
  {
    CaptionML=[ENU=Work Type Code;
               NOR=Arbeidstypekode];
    LookupPageID=Page83012;
    DrillDownPageID=Page83012;
  }
  FIELDS
  {
    { 1   ;   ;Code                ;Code10        ;CaptionML=[ENU=Code;
                                                              NOR=Kode] }
    { 2   ;   ;Description         ;Text30        ;CaptionML=[ENU=Description;
                                                              NOR=Beskrivelse] }
    { 6   ;   ;Payment Type        ;Code10        ;CaptionML=[ENU=Payment Type;
                                                              NOR=L›nnsart] }
    { 7   ;   ;Time Type           ;Option        ;CaptionML=NOR=Tidstype;
                                                   OptionCaptionML=NOR=Dagtid,Overtid 50%,Overtid 100%;
                                                   OptionString=Daytime,Overtime 50%,Overtime 100% }
    { 10  ;   ;Absence             ;Boolean       ;CaptionML=[ENU=Absence;
                                                              NOR=Frav‘r] }
    { 15  ;   ;Time Registered     ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Time Register".Quantity WHERE (Work Type Code=FIELD(Code),
                                                                                                   Machine Center=FIELD(Machine Center Filter),
                                                                                                   Start Date=FIELD(Date Filter)));
                                                   CaptionML=[ENU=Time Registered;
                                                              NOR=Tid registrert] }
    { 16  ;   ;Machine Center Filter;Code20       ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Machine Center Filter;
                                                              NOR=Produksjonsressursfilter] }
    { 17  ;   ;Date Filter         ;Date          ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Date Filter;
                                                              NOR=Datofilter] }
  }
  KEYS
  {
    {    ;Code                                    ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Table 83005 Holyday
{
  OBJECT-PROPERTIES
  {
    Date=20.04.17;
    Time=16.20.12;
    Modified=Yes;
    Version List=OPC (RSI);
  }
  PROPERTIES
  {
    CaptionML=[ENU=Holyday;
               NOR=Helligdag];
  }
  FIELDS
  {
    { 1   ;   ;Date                ;Date          ;CaptionML=[ENU=Date;
                                                              NOR=Dato] }
    { 2   ;   ;Description         ;Text30        ;CaptionML=[ENU=Description;
                                                              NOR=Beskrivelse] }
    { 3   ;   ;Type                ;Option        ;CaptionML=[ENU=Type;
                                                              NOR=Type];
                                                   OptionCaptionML=[ENU=Fixed,Floating;
                                                                    NOR=Fast,Flytende];
                                                   OptionString=Fixed,Floating }
  }
  KEYS
  {
    {    ;Date                                    ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Table 83006 Payment Temp. Register
{
  OBJECT-PROPERTIES
  {
    Date=20.04.17;
    Time=16.20.12;
    Modified=Yes;
    Version List=OPC (RSI);
  }
  PROPERTIES
  {
    CaptionML=[ENU=Payment Temp. Register;
               NOR=L›nns temp. register];
  }
  FIELDS
  {
    { 1   ;   ;Machine Center No.  ;Code20        ;CaptionML=[ENU=Machine Center No.;
                                                              NOR=Produksjonsressursnr.] }
    { 2   ;   ;Employee No.        ;Code20        ;CaptionML=[ENU=Employee No. (H&L);
                                                              NOR=Ansattnr. (H&L)] }
    { 3   ;   ;Employee Name       ;Text30        ;CaptionML=[ENU=Employee Name;
                                                              NOR=Ansattnavn] }
    { 5   ;   ;Work Type Code      ;Code10        ;TableRelation="Work Type Code";
                                                   CaptionML=[ENU=Work Type Code;
                                                              NOR=Arbeidstypekode] }
    { 7   ;   ;Payment Type        ;Code20        ;CaptionML=[ENU=Payment Type (H&L);
                                                              NOR=L›nnsart (H&L)] }
    { 9   ;   ;Quantity            ;Decimal       ;CaptionML=[ENU=Quantity;
                                                              NOR=Antall] }
  }
  KEYS
  {
    {    ;Machine Center No.,Work Type Code       ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Table 83007 Time Register
{
  OBJECT-PROPERTIES
  {
    Date=20.04.17;
    Time=16.20.12;
    Modified=Yes;
    Version List=OPC (RSI);
  }
  PROPERTIES
  {
    OnInsert=BEGIN
               IF "Work Type Code" = '' THEN BEGIN
                 WorkTypeCode.RESET;
                 WorkTypeCode.SETRANGE("Time Type", WorkTypeCode."Time Type"::Daytime);
                 IF WorkTypeCode.FIND('-') THEN
                    VALIDATE("Work Type Code", WorkTypeCode.Code);
               END;
             END;

    OnModify=BEGIN
               //02. ->
               IF "Date exported to Tempus" <> 0D THEN
                 ERROR('Denne posten er allerede eksportert til Tempus, og kan ikke lenger rettes her. Rett i Tempus');
               //02.<-
             END;

    OnDelete=BEGIN
               //02. ->
               IF "Date exported to Tempus" <> 0D THEN
                 ERROR('Denne posten er allerede eksportert til Tempus, og kan ikke lenger rettes her. Rett i Tempus');
               //02.<-
             END;

    OnRename=BEGIN
               //02. ->
               IF "Date exported to Tempus" <> 0D THEN
                 ERROR('Denne posten er allerede eksportert til Tempus, og kan ikke lenger rettes her. Rett i Tempus');
               //02.<-
             END;

    LookupPageID=Page83018;
    DrillDownPageID=Page83018;
  }
  FIELDS
  {
    { 1   ;   ;Machine Center      ;Code20        ;TableRelation="Machine Center";
                                                   CaptionML=[ENU=Machine Center;
                                                              NOR=Produksjonsressurs];
                                                   NotBlank=Yes }
    { 2   ;   ;Start Date          ;Date          ;OnValidate=BEGIN
                                                                CalcQty;
                                                              END;

                                                   CaptionML=[ENU=Start Date;
                                                              NOR=Startdato] }
    { 3   ;   ;Start Time          ;Time          ;OnValidate=BEGIN
                                                                CalcQty;
                                                              END;

                                                   CaptionML=[ENU=Start Time;
                                                              NOR=Starttid] }
    { 5   ;   ;End Date            ;Date          ;OnValidate=BEGIN
                                                                CalcQty;
                                                              END;

                                                   CaptionML=[ENU=End Date;
                                                              NOR=Sluttdato] }
    { 6   ;   ;End Time            ;Time          ;OnValidate=BEGIN
                                                                CalcQty;
                                                              END;

                                                   CaptionML=[ENU=End Time;
                                                              NOR=Sluttid] }
    { 7   ;   ;Quantity            ;Decimal       ;CaptionML=[ENU=Quantity;
                                                              NOR=Antall];
                                                   BlankZero=Yes;
                                                   Editable=No }
    { 9   ;   ;Work Type Code      ;Code10        ;TableRelation="Work Type Code";
                                                   OnValidate=BEGIN
                                                                WorkTypeCode.GET("Work Type Code");
                                                                "Time Type" := WorkTypeCode."Time Type";
                                                              END;

                                                   CaptionML=[ENU=Work Type Code;
                                                              NOR=Arbeidstypekode] }
    { 11  ;   ;Time Type           ;Option        ;CaptionML=NOR=Tidstype;
                                                   OptionCaptionML=NOR=Dagtid,Overtid 50%,Overtid 100%;
                                                   OptionString=Daytime,Overtime 50%,Overtime 100%;
                                                   Editable=No }
    { 12  ;   ;Machine Center Name ;Text30        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Machine Center".Name WHERE (No.=FIELD(Machine Center)));
                                                   CaptionML=[ENU=Machine Center Name;
                                                              NOR=Produksjonsressursnavn];
                                                   Editable=No }
    { 13  ;   ;Absence             ;Boolean       ;CaptionML=[ENU=Absence;
                                                              NOR=Frav‘r] }
    { 14  ;   ;Date exported to Tempus;Date        }
    { 15  ;   ;Actual Start Time   ;Time          ;CaptionML=NOR=Faktisk starttid }
    { 20  ;   ;Starting day        ;Text10        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Date."Period Name" WHERE (Period Type=CONST(Date),
                                                                                                Period Start=FIELD(Start Date)));
                                                   CaptionML=NOR=Ukedag (start);
                                                   Editable=No }
    { 30  ;   ;Description         ;Text50        ;CaptionML=NOR=Beskrivelse }
    { 31  ;   ;Deduction Type      ;Option        ;CaptionML=[ENU=Deduction Type;
                                                              NOR=Type fratrekk];
                                                   OptionCaptionML=[ENU=,Lunch,Dinner,Other;
                                                                    NOR=" ,Lunch,Middag,Annet"];
                                                   OptionString=[ ,Lunch,Dinner,Other];
                                                   Description=03. BVM }
  }
  KEYS
  {
    {    ;Machine Center,Start Date,Start Time    ;Clustered=Yes }
    {    ;Machine Center,Work Type Code,Start Date;SumIndexFields=Quantity }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      WorkTypeCode@1101104000 : Record 83004;

    PROCEDURE CalcQty@1101104000();
    BEGIN
      IF (("Start Date" <> 0D) AND ("Start Time" <> 0T)
        AND ("End Date" <> 0D) AND ("End Time" <> 0T)) THEN BEGIN

        Quantity := ( (("End Date" - "Start Date") * 24) +
          (("End Time" - "Start Time") / 3600000))
      END ELSE
        Quantity := 0;
    END;

    BEGIN
    {
      01. 15.06.06 HHE Lagt inn feltet "Date exported to Tempus"
      02. 15.06.06 HHE Kode som hindrer endring dersom "Date exported to Tempus" <> ''
    }
    END.
  }
}

OBJECT Table 83008 Change Status Comment Line
{
  OBJECT-PROPERTIES
  {
    Date=20.04.17;
    Time=16.20.12;
    Modified=Yes;
    Version List=OPC5.01;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Routing Comment Line;
               NOR=Rutemerknadslinje];
  }
  FIELDS
  {
    { 1   ;   ;Routing No.         ;Code20        ;TableRelation="Routing Header";
                                                   CaptionML=[ENU=Routing No.;
                                                              NOR=Rutenr.];
                                                   NotBlank=Yes }
    { 2   ;   ;Operation No.       ;Code10        ;CaptionML=[ENU=Operation No.;
                                                              NOR=Operasjonsnr.];
                                                   NotBlank=Yes }
    { 3   ;   ;Prod. Order No.     ;Code20        ;CaptionML=[ENU=Line No.;
                                                              NOR=Linjenr.] }
    { 4   ;   ;Routing reference No.;Integer      ;TableRelation="Routing Version"."Version Code" WHERE (Routing No.=FIELD(Routing No.));
                                                   CaptionML=[ENU=Version Code;
                                                              NOR=Versjonskode] }
    { 5   ;   ;Line No.            ;Integer        }
    { 10  ;   ;Date                ;Date          ;CaptionML=[ENU=Date;
                                                              NOR=Dato] }
    { 12  ;   ;Comment             ;Text80        ;CaptionML=[ENU=Comment;
                                                              NOR=Merknad] }
    { 13  ;   ;Entry No.           ;Integer       ;CaptionML=NOR=l›penummer }
  }
  KEYS
  {
    {    ;Routing No.,Routing reference No.,Operation No.,Prod. Order No.,Line No.;
                                                   Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    PROCEDURE SetUpNewLine@1();
    VAR
      RtngComment@1000 : Record 83008;
    BEGIN
      RtngComment.SETRANGE("Routing No.","Routing No.");
      RtngComment.SETRANGE("Routing reference No.","Routing reference No.");
      RtngComment.SETRANGE("Operation No.","Operation No.");
      RtngComment.SETRANGE(Date,WORKDATE);
      IF NOT RtngComment.FIND('-') THEN
        Date := WORKDATE;
    END;

    PROCEDURE Caption@2() : Text[100];
    VAR
      RtngHeader@1000 : Record 99000763;
    BEGIN
      IF GETFILTERS = '' THEN
        EXIT('');

      IF "Routing No." = '' THEN
        EXIT('');

      RtngHeader.GET("Routing No.");

      EXIT(
        STRSUBSTNO('%1 %2 %3',
          "Routing No.",RtngHeader.Description,"Operation No."));
    END;

    BEGIN
    END.
  }
}

OBJECT Table 83009 Time Registration
{
  OBJECT-PROPERTIES
  {
    Date=20.04.17;
    Time=16.20.12;
    Modified=Yes;
    Version List=OPC1.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Time Registration;
               NOR=M›nstringstider];
  }
  FIELDS
  {
    { 10  ;   ;Machine Center No.  ;Code20        ;TableRelation="Machine Center".No.;
                                                   CaptionML=[ENU=Machine Center No.;
                                                              NOR=Produksjonsressurs Nr.];
                                                   Description=hhe 24okt05: endret fra 10 }
    { 15  ;   ;Navn                ;Text30        ;TableRelation="Machine Center".Name;
                                                   CaptionML=[ENU=Name;
                                                              NOR=Navn] }
    { 20  ;   ;Starting Date       ;Date          ;OnValidate=BEGIN
                                                                BeregnTid();
                                                              END;

                                                   CaptionML=[ENU=Starting Date;
                                                              NOR=Startdato] }
    { 30  ;   ;Starting Time       ;Time          ;OnValidate=BEGIN
                                                                BeregnTid();
                                                              END;

                                                   CaptionML=[ENU=Starting Time;
                                                              NOR=Start tidspunkt] }
    { 40  ;   ;Ending Date         ;Date          ;OnValidate=BEGIN
                                                                BeregnTid();
                                                              END;

                                                   CaptionML=[ENU=Ending Date;
                                                              NOR=Sluttdato] }
    { 50  ;   ;Ending Time         ;Time          ;OnValidate=BEGIN
                                                                BeregnTid();
                                                              END;

                                                   CaptionML=[ENU=Ending Time;
                                                              NOR=Slutt tidspunkt] }
    { 55  ;   ;Total Time (Minutes);Integer       ;CaptionML=[ENU=Total Time (Minutes);
                                                              NOR=Totaltid (minutter)] }
    { 60  ;   ;Workstatus          ;Option        ;CaptionML=[ENU=Workstatus;
                                                              NOR=Arbeidsstatus];
                                                   OptionCaptionML=[ENU=Not Registrated,Registrated,Direct Production,Indirect Time,Completed;
                                                                    NOR=Ikke fremm›t,Tilstede,Direkte Produksjon,Indirekte produksjon,Avsluttet];
                                                   OptionString=Not Registrated,Registrated,Direct Production,Indirect Time,Completed }
    { 70  ;   ;Machine Center Filter;Code20       ;FieldClass=FlowFilter;
                                                   TableRelation="Machine Center".No.;
                                                   CaptionML=[ENU=Machine Center Filter;
                                                              NOR=Produksjonsressurs filter];
                                                   Description=hhe 24okt05: endret fra 10 }
    { 80  ;   ;Exported to File    ;Boolean       ;CaptionML=[ENU=Exported to File;
                                                              NOR=Eksportert til fil] }
  }
  KEYS
  {
    {    ;Machine Center No.,Starting Date,Starting Time;
                                                   Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    PROCEDURE BeregnTid@1();
    VAR
      AntallDager@1000000000 : Integer;
      AntallTimer@1000000001 : Integer;
    BEGIN
      IF ("Ending Time" <> 0T) AND ("Starting Time" <> 0T)
        AND ("Ending Date" <> 0D) AND ("Starting Date" <> 0D) THEN BEGIN
          AntallTimer := "Ending Time" - "Starting Time";
          AntallDager := "Ending Date" - "Starting Date";
          "Total Time (Minutes)" := (AntallDager*1440) + (AntallTimer/60000);
          MODIFY;
      END;
    END;

    BEGIN
    {
      ----------------------------------------------
      SI-DATA AS

      OPC
      ----------------------------------------------
      No  Date      ID      Description
      ----------------------------------------------
      001 06.12.05  ASL     Tabell oppgrader 4.0SP1
    }
    END.
  }
}

OBJECT Table 83010 Run Times
{
  OBJECT-PROPERTIES
  {
    Date=20.04.17;
    Time=16.20.12;
    Modified=Yes;
    Version List=OPC1.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Run Times;
               NOR=Operasjonstider];
  }
  FIELDS
  {
    { 1   ;   ;Entry No.           ;Integer       ;CaptionML=[ENU=Entry No.;
                                                              NOR=L›penummer] }
    { 10  ;   ;Prod. Order No.     ;Code20        ;TableRelation="Production Order".No.;
                                                   CaptionML=[ENU=Prod. Order No.;
                                                              NOR=Prod.ordrenr.];
                                                   NotBlank=No;
                                                   Editable=No }
    { 20  ;   ;Routing No.         ;Code20        ;CaptionML=[ENU=Routing No.;
                                                              NOR=Rute nr.] }
    { 30  ;   ;Operation No.       ;Code10        ;CaptionML=[ENU=Operation No.;
                                                              NOR=Operasjonsnr.];
                                                   NotBlank=No }
    { 40  ;   ;Machine Center      ;Code20        ;TableRelation="Machine Center";
                                                   OnValidate=VAR
                                                                ProdRessurs@1000000000 : Record 99000758;
                                                              BEGIN
                                                                IF ProdRessurs.GET("Machine Center") THEN
                                                                  Description := ProdRessurs.Name;
                                                              END;

                                                   CaptionML=[ENU=Machine Center;
                                                              NOR=Produksjonsressurs] }
    { 45  ;   ;Description         ;Text30        ;CaptionML=[ENU=Description;
                                                              NOR=Beskrivelse] }
    { 50  ;   ;Starting Date       ;Date          ;CaptionML=[ENU=Starting Date;
                                                              NOR=Start dato] }
    { 60  ;   ;Starting Time       ;Time          ;CaptionML=[ENU=Starting Time;
                                                              NOR=Start tidspunkt] }
    { 70  ;   ;Ending Date         ;Date          ;CaptionML=[ENU=Ending Date;
                                                              NOR=Slutt dato] }
    { 80  ;   ;Ending Time         ;Time          ;CaptionML=[ENU=Ending Time;
                                                              NOR=Slutt tidspunkt] }
    { 100 ;   ;Finish Now          ;Boolean       ;OnValidate=BEGIN
                                                                TESTFIELD("Machine Center");
                                                                TESTFIELD("Starting Date");
                                                                TESTFIELD("Starting Time");
                                                              END;

                                                   CaptionML=[ENU=Finish Now;
                                                              NOR=Avslutt n†] }
    { 110 ;   ;Post                ;Boolean       ;CaptionML=[ENU=Post;
                                                              NOR=Bokf›r] }
    { 200 ;   ;Work done at M.C.   ;Code10        ;TableRelation="Machine Center".No. }
    { 300 ;   ;Stop Code           ;Code20        ;TableRelation=Stop.Code;
                                                   CaptionML=NOR=Indirekte tid (kode);
                                                   Description=//OPC - ny 22.jan10 }
  }
  KEYS
  {
    {    ;Entry No.,Prod. Order No.,Routing No.,Operation No.,Machine Center;
                                                   Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    {
      ----------------------------------------------
      SI-DATA AS

      OPC
      ----------------------------------------------
      No  Date      ID      Description
      ----------------------------------------------
      001 06.12.05  ASL     Tabell oppgrader 4.0SP1
      002 14.12.05  HHE     Legger inn "Work done at"
      003 29.03.06  ASL     Endret slik at det tillates blanke verdier for "Prod. Order No.",
                            "Routing No.","Operation No.", for bokf›ring av ikke produktiv tid
      005 22.01.10  HHE     Nytt felt = "Stop Code" (viser hvilken ind.tid.kode man er innstemplet p†)
    }
    END.
  }
}

OBJECT Table 83011 Non producing time
{
  OBJECT-PROPERTIES
  {
    Date=20.04.17;
    Time=16.20.12;
    Modified=Yes;
    Version List=indir.tid OPC;
  }
  PROPERTIES
  {
    OnInsert=VAR
               Stop@1000000000 : Record 99000761;
             BEGIN
               CLEAR(Stop);
               IF NOT Stop.GET(Kode) THEN BEGIN
                 Stop.INIT;
                 Stop.Code := Kode;
                 Stop."OPC-Non producing time" := TRUE;
                 Stop.INSERT;
               END;
             END;

    CaptionML=[ENU=Non producing time;
               NOR=Ikke produktiv tid];
    LookupPageID=Page83027;
  }
  FIELDS
  {
    { 1   ;   ;Kode                ;Code15         }
    { 2   ;   ;Beskrivelse         ;Text30         }
  }
  KEYS
  {
    {    ;Kode                                    ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    {
      ----------------------------------------------
      SI-DATA AS

      OPC
      ----------------------------------------------
      No  Date      ID      Description
      ----------------------------------------------
      001 29.03.06  ASL     Oppretter ogs† kodene som stopp†rsaker for †
                            bruke standard stokkkoder i tidsbokf›ring
    }
    END.
  }
}

OBJECT Table 83012 Run Times Deduction
{
  OBJECT-PROPERTIES
  {
    Date=20.04.17;
    Time=16.20.12;
    Modified=Yes;
    Version List=OPC1.0;
  }
  PROPERTIES
  {
    LookupPageID=Page83022;
  }
  FIELDS
  {
    { 1   ;   ;Code                ;Code10        ;CaptionML=[ENU=Code;
                                                              NOR=Kode] }
    { 2   ;   ;Description         ;Text30        ;CaptionML=[ENU=Description;
                                                              NOR=Beskrivelse] }
    { 3   ;   ;From Time           ;Time          ;CaptionML=[ENU=From Time;
                                                              NOR=Fra klokken] }
    { 4   ;   ;To Time             ;Time          ;CaptionML=[ENU=To Time;
                                                              NOR=Til klokken] }
    { 9   ;   ;Deduct Prod.Order   ;Boolean       ;CaptionML=[ENU=Deduct Prod.Order;
                                                              NOR=Trekkfra p† prod.ordre] }
  }
  KEYS
  {
    {    ;Code                                    ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Table 83013 OPC Cue
{
  OBJECT-PROPERTIES
  {
    Date=20.04.17;
    Time=16.20.12;
    Modified=Yes;
    Version List=OPC;
  }
  PROPERTIES
  {
    CaptionML=[ENU=OPC Cue;
               NOR=OPC bunke-ikon];
  }
  FIELDS
  {
    { 1   ;   ;Primary Key         ;Code10        ;CaptionML=[ENU=Primary Key;
                                                              NOR=Prim‘rn›kkel] }
    { 10  ;   ;Production Order- Released;Integer ;FieldClass=FlowField;
                                                   CalcFormula=Count("Production Order" WHERE (Status=CONST(Released)));
                                                   CaptionML=[ENU=Production Order - Released;
                                                              NOR=Produksjonordre - Frigitt];
                                                   Editable=No }
    { 20  ;   ;Resource Status     ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Run Times" WHERE (Ending Date=FILTER(''),
                                                                                        Starting Date=FILTER(>01.01.00),
                                                                                        Machine Center=FILTER(<>'')));
                                                   CaptionML=[ENU=Resource Status;
                                                              NOR=Ressursstatus];
                                                   Editable=No }
    { 30  ;   ;Firm planned tasks  ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Prod. Order Routing Line" WHERE (Type=CONST(Machine Center),
                                                                                                       Routing Status=FILTER(<>Finished),
                                                                                                       Status=CONST(Firm Planned)));
                                                   CaptionML=[ENU=Firm planned tasks;
                                                              NOR=Fast planlagte oppgaver];
                                                   Editable=No }
    { 220 ;   ;Date Filter         ;Date          ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Date Filter;
                                                              NOR=Datofilter];
                                                   Editable=No }
    { 240 ;   ;Responsibility Center Filter;Code10;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Responsibility Center Filter;
                                                              NOR=Filter for ansvarssenter];
                                                   Editable=No }
  }
  KEYS
  {
    {    ;Primary Key                             ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Codeunit 83001 Clocking Mgt
{
  OBJECT-PROPERTIES
  {
    Date=20.04.17;
    Time=16.20.12;
    Modified=Yes;
    Version List=OPC2.0;
  }
  PROPERTIES
  {
    TableNo=99000758;
    OnRun=BEGIN
            RegisterTime("No.", WORKDATE, TIME);
          END;

  }
  CODE
  {
    VAR
      OPC_StartDateTime@1101104000 : DateTime;
      OPC_EndDateTime@1101104001 : DateTime;
      C_ErrorInQty@1101103000 : TextConst 'ENU=Scrap can only be posted together with output quantity.;NOR=Vrak kan kun bokf›res sammen med ferdigantall.';

    PROCEDURE RegisterTime@1000000000(MachineCenter@1000000002 : Code[20];RegisterDate@1000000000 : Date;RegisterTime@1000000001 : Time);
    VAR
      TimeRegister@1000000003 : Record 83007;
    BEGIN
      TimeRegister.RESET;
      TimeRegister.SETRANGE("Machine Center", MachineCenter);
      TimeRegister.SETRANGE("End Time", 0T);
      IF TimeRegister.FINDFIRST THEN BEGIN
        REPEAT
          IF TimeRegister."Start Date" < WORKDATE THEN BEGIN
            //nytt 16.06.06->
            TimeRegister.VALIDATE("End Date",WORKDATE-1);
            TimeRegister."End Time" := 235959T;
            OPC_StartDateTime := CREATEDATETIME(TimeRegister."Start Date", TimeRegister."Start Time");
            OPC_EndDateTime := CREATEDATETIME(TimeRegister."End Date", TimeRegister."End Time");
            TimeRegister.Quantity :=( (OPC_EndDateTime - OPC_StartDateTime) / 3600000);
            TimeRegister.MODIFY;
            TimeRegister.INIT;
            TimeRegister.VALIDATE("Machine Center",MachineCenter);
            TimeRegister.VALIDATE("Start Date",WORKDATE);
            TimeRegister.VALIDATE("Start Time",000000T);
            TimeRegister.VALIDATE("End Date", WORKDATE);
            TimeRegister.VALIDATE("End Time", TIME);
            TimeRegister.INSERT;
            END ELSE
            ClockOut(TimeRegister, RegisterDate, RegisterTime);
            //nytt 16.06.06<-

        UNTIL TimeRegister.NEXT = 0;
      END ELSE
        ClockIn(MachineCenter, RegisterDate, RegisterTime);
    END;

    PROCEDURE ClockIn@1000000001(MachineCenter@1000000002 : Code[20];RegisterDate@1000000001 : Date;RegisterTime@1000000000 : Time);
    VAR
      TimeRegister@1000000003 : Record 83007;
    BEGIN
      WITH TimeRegister DO BEGIN
        INIT;
        "Machine Center" := MachineCenter;
        "Start Date" := RegisterDate;
        "Start Time" := RegisterTime;
        "End Date" := 0D;
        "End Time" := 0T;
        INSERT;
      END;
    END;

    PROCEDURE ClockOut@1000000002(VAR TimeRegister@1000000002 : Record 83007;RegisterDate@1000000001 : Date;RegisterTime@1000000000 : Time);
    VAR
      Overtime@1000000003 : Codeunit 83002;
      PostOutput@1000000004 : Codeunit 83004;
    BEGIN
      WITH TimeRegister DO BEGIN
        "End Date" := RegisterDate;
        "End Time" := RegisterTime;
        CalcQty;
        MODIFY;
        // Find Overtime
        Overtime.ClockOvertime(TimeRegister);
        // Find unfinished run times
        PostOutput.RUN(TimeRegister);
      END;
    END;

    PROCEDURE GetDefaultTimeOut@1000000003() : Time;
    BEGIN
      EXIT(160000T);
    END;

    PROCEDURE Absence@1000000004(VAR CalendarAbsenceEntry@1000000000 : Record 99000760;Remove@1000000003 : Boolean);
    VAR
      TimeRegister@1000000001 : Record 83007;
      TimeRegister2@1000000002 : Record 83007;
    BEGIN
      TimeRegister2.RESET;
      TimeRegister2.SETRANGE("Machine Center", CalendarAbsenceEntry."No.");
      TimeRegister2.SETRANGE("Start Date", CalendarAbsenceEntry.Date);
      TimeRegister2.SETRANGE("Start Time", CalendarAbsenceEntry."Starting Time");
      IF TimeRegister2.FIND('-') THEN BEGIN
        TimeRegister := TimeRegister2;
        IF NOT Remove THEN BEGIN
          TimeRegister."Machine Center" := CalendarAbsenceEntry."No.";
          TimeRegister."Start Date" := CalendarAbsenceEntry.Date;
          TimeRegister."Start Time" := CalendarAbsenceEntry."Starting Time";
          TimeRegister."End Date" := CalendarAbsenceEntry.Date;
          TimeRegister."End Time" := CalendarAbsenceEntry."Ending Time";
          TimeRegister."Work Type Code" := CalendarAbsenceEntry."Work Type Code";
          TimeRegister.Absence := TRUE;
          TimeRegister.CalcQty;
          TimeRegister.MODIFY;
        END ELSE
          TimeRegister.DELETE;
      END ELSE BEGIN
        TimeRegister.INIT;
        TimeRegister."Machine Center" := CalendarAbsenceEntry."No.";
        TimeRegister."Start Date" := CalendarAbsenceEntry.Date;
        TimeRegister."Start Time" := CalendarAbsenceEntry."Starting Time";
        TimeRegister."End Date" := CalendarAbsenceEntry.Date;
        TimeRegister."End Time" := CalendarAbsenceEntry."Ending Time";
        TimeRegister."Work Type Code" := CalendarAbsenceEntry."Work Type Code";
        TimeRegister.Absence := TRUE;
        TimeRegister.CalcQty;
        TimeRegister.INSERT;
      END;
    END;

    PROCEDURE RegisterTimeInJournal@1101103000(VAR RunTimesP@1101103000 : Record 83010;VAR OutPutQtyP@1101103013 : Decimal;VAR ScrapQtyP@1101103012 : Decimal;VAR ScrapCodeP@1101103011 : Code[20];VAR ScrapQty2P@1101103010 : Decimal;VAR ScrapCode2P@1101103009 : Code[20];VAR ScrapQty3P@1101103018 : Decimal;VAR ScrapCode3P@1101103017 : Code[20];VAR ScrapCommentP@1101103016 : Text[50];VAR ScrapComment2P@1101103015 : Text[50];VAR ScrapComment3P@1101103014 : Text[50]);
    VAR
      recOperasjonstider@1101103007 : Record 83010;
      OPCOppsett@1101103006 : Record 83001;
      ProdOrdreLinje@1101103005 : Record 5406;
      Vare@1101103004 : Record 27;
      FerdigMeldKladdLinje@1101103003 : Record 83;
      StemplTid@1101103002 : Record 83009;
      ProdO_ruteLinje@1101103001 : Record 5409;
      FirstRecOpLineL@1101103008 : Boolean;
    BEGIN
      //hhe 16.06.06->  Sletter blanke linjer f›r bokf›ring for † unng† feilmelding
      recOperasjonstider.RESET;
      recOperasjonstider.SETRANGE("Machine Center", '');
      IF recOperasjonstider.FINDFIRST THEN
        recOperasjonstider.DELETEALL;
      //hhe 16.06.06<-
      // Setter inn startdato og starttid
      recOperasjonstider.RESET;
      recOperasjonstider.SETRANGE(recOperasjonstider."Prod. Order No.",  RunTimesP."Prod. Order No.");
      recOperasjonstider.SETRANGE(recOperasjonstider."Routing No.",  RunTimesP."Routing No.");
      recOperasjonstider.SETRANGE(recOperasjonstider."Operation No.",  RunTimesP."Operation No.");
      recOperasjonstider.SETRANGE(Post, FALSE); //02. 28.07.16 JAL
      IF recOperasjonstider.FINDFIRST THEN
      REPEAT
        recOperasjonstider.TESTFIELD(recOperasjonstider."Machine Center");
        IF (recOperasjonstider."Starting Date" = 0D) THEN
          recOperasjonstider."Starting Date" := TODAY;
        IF (recOperasjonstider."Starting Time" = 0T) THEN BEGIN
          recOperasjonstider."Starting Time" := TIME;
          ProdO_ruteLinje.SETRANGE(Status, ProdO_ruteLinje.Status::Released);
          ProdO_ruteLinje.SETRANGE("Prod. Order No.", RunTimesP."Prod. Order No.");
          ProdO_ruteLinje.SETRANGE("Routing No.", RunTimesP."Routing No.");
          ProdO_ruteLinje.SETRANGE("Operation No.", RunTimesP."Operation No.");
          ProdO_ruteLinje.SETRANGE(Type, ProdO_ruteLinje.Type::"Machine Center");
          IF ProdO_ruteLinje.FINDFIRST THEN
            recOperasjonstider."Work done at M.C." := ProdO_ruteLinje."No.";
          END;
        recOperasjonstider.MODIFY;
      UNTIL recOperasjonstider.NEXT = 0;

      StemplTid.SETRANGE(StemplTid."Machine Center No.", RunTimesP."Machine Center");
      IF StemplTid.FINDFIRST THEN
      REPEAT
        StemplTid.TESTFIELD(StemplTid."Machine Center No.");
        StemplTid.VALIDATE(StemplTid.Workstatus, StemplTid.Workstatus::"Direct Production");
        StemplTid.MODIFY;
      UNTIL StemplTid.NEXT = 0;

      // Setter inn sluttdato og sluttid
      recOperasjonstider.RESET;
      recOperasjonstider.SETRANGE(recOperasjonstider."Prod. Order No.", RunTimesP."Prod. Order No.");
      recOperasjonstider.SETRANGE(recOperasjonstider."Routing No.", RunTimesP."Routing No.");
      recOperasjonstider.SETRANGE(recOperasjonstider."Operation No.", RunTimesP."Operation No.");
      recOperasjonstider.SETRANGE(recOperasjonstider."Finish Now", TRUE);
      recOperasjonstider.SETRANGE(recOperasjonstider.Post, FALSE);
      IF recOperasjonstider.FINDFIRST THEN
      REPEAT
        IF (recOperasjonstider."Starting Date" <> 0D) AND (recOperasjonstider."Ending Date" = 0D) THEN
          recOperasjonstider."Ending Date" := TODAY;
        IF (recOperasjonstider."Starting Time" <> 0T) AND (recOperasjonstider."Ending Time" = 0T)THEN
          recOperasjonstider."Ending Time" := TIME;
        recOperasjonstider.MODIFY;
        SearchDeductions(recOperasjonstider);
      UNTIL recOperasjonstider.NEXT = 0;

      StemplTid.SETRANGE(StemplTid."Machine Center No.", RunTimesP."Machine Center");
      IF StemplTid.FINDFIRST THEN
      REPEAT
        StemplTid.TESTFIELD(StemplTid."Machine Center No.");
        StemplTid.VALIDATE(StemplTid.Workstatus, StemplTid.Workstatus::Registrated);
        StemplTid.MODIFY;
      UNTIL StemplTid.NEXT = 0;

      // Post "Run Times" (Bokf›rer tidlinjer)
      FirstRecOpLineL := TRUE;

      recOperasjonstider.RESET;
      recOperasjonstider.SETRANGE(recOperasjonstider."Prod. Order No.", RunTimesP."Prod. Order No.");
      recOperasjonstider.SETRANGE(recOperasjonstider."Routing No.", RunTimesP."Routing No.");
      recOperasjonstider.SETRANGE(recOperasjonstider."Operation No.", RunTimesP."Operation No.");
      recOperasjonstider.SETRANGE(recOperasjonstider."Finish Now", TRUE);
      recOperasjonstider.SETRANGE(recOperasjonstider.Post, FALSE);
      recOperasjonstider.SETFILTER(recOperasjonstider."Starting Date", '<>%1', 0D);
      recOperasjonstider.SETFILTER(recOperasjonstider."Starting Time", '<>%1', 0T);
      recOperasjonstider.SETFILTER(recOperasjonstider."Ending Date", '<>%1', 0D);
      recOperasjonstider.SETFILTER(recOperasjonstider."Ending Time", '<>%1', 0T);
      IF recOperasjonstider.FINDFIRST THEN BEGIN
        OPCOppsett.GET();
        OPCOppsett.TESTFIELD("Output Batch Name Time");
        OPCOppsett.TESTFIELD("Output Jrn Name Time");
        FerdigMeldKladdLinje.SETRANGE(FerdigMeldKladdLinje."Journal Template Name", OPCOppsett."Output Batch Name Time");
        FerdigMeldKladdLinje.SETRANGE(FerdigMeldKladdLinje."Journal Batch Name", OPCOppsett."Output Jrn Name Time");
        IF FerdigMeldKladdLinje.FIND('-') THEN
          FerdigMeldKladdLinje.DELETEALL;

        ProdOrdreLinje.SETRANGE(ProdOrdreLinje.Status, ProdOrdreLinje.Status::Released);
        ProdOrdreLinje.SETRANGE(ProdOrdreLinje."Prod. Order No.", RunTimesP."Prod. Order No.");
        ProdOrdreLinje.SETRANGE(ProdOrdreLinje."Routing No.", RunTimesP."Routing No.");
        IF ProdOrdreLinje.FINDFIRST THEN BEGIN
          IF Vare.GET(ProdOrdreLinje."Item No.") THEN BEGIN
            ProdOrdreLinje.TESTFIELD(ProdOrdreLinje."Routing No.");
          END ELSE
            ERROR('Fant ikke vare %1!', ProdOrdreLinje."Item No.");
        END;
        REPEAT
          FerdigMeldKladdLinje.INIT;
          FerdigMeldKladdLinje.VALIDATE(FerdigMeldKladdLinje."Journal Template Name", OPCOppsett."Output Batch Name Time");
          FerdigMeldKladdLinje.VALIDATE(FerdigMeldKladdLinje."Journal Batch Name", OPCOppsett."Output Jrn Name Time");
          FerdigMeldKladdLinje."Line No." := FerdigMeldKladdLinje."Line No." + 10000;
          FerdigMeldKladdLinje.VALIDATE(FerdigMeldKladdLinje."Entry Type", FerdigMeldKladdLinje."Entry Type"::Output);
          FerdigMeldKladdLinje.INSERT(TRUE);

          IF ProdOrdreLinje."Prod. Order No." <> '' THEN BEGIN
            FerdigMeldKladdLinje.VALIDATE("Order Type", FerdigMeldKladdLinje."Order Type"::Production);
            FerdigMeldKladdLinje.VALIDATE(FerdigMeldKladdLinje."Order No.", RunTimesP."Prod. Order No.");
            FerdigMeldKladdLinje.VALIDATE(FerdigMeldKladdLinje."Item No.", Vare."No.");
            FerdigMeldKladdLinje.VALIDATE("Operation No.", RunTimesP."Operation No.");

            IF FirstRecOpLineL THEN BEGIN
            FerdigMeldKladdLinje.VALIDATE(FerdigMeldKladdLinje."Output Quantity", OutPutQtyP);
            FerdigMeldKladdLinje.VALIDATE(FerdigMeldKladdLinje."Scrap Quantity", ScrapQtyP);
            FerdigMeldKladdLinje.VALIDATE(FerdigMeldKladdLinje."Scrap Code", ScrapCodeP);
            END;

            FerdigMeldKladdLinje."Posting Date" := recOperasjonstider."Ending Date";
            FerdigMeldKladdLinje."Document Date" := TODAY;
            FerdigMeldKladdLinje.VALIDATE(FerdigMeldKladdLinje.Type, FerdigMeldKladdLinje.Type::"Machine Center");
            FerdigMeldKladdLinje.VALIDATE(FerdigMeldKladdLinje."No.", recOperasjonstider."Machine Center");
            FerdigMeldKladdLinje.VALIDATE("Order Type", FerdigMeldKladdLinje."Order Type"::Production);
            FerdigMeldKladdLinje."Order Line No." :=  ProdOrdreLinje."Line No.";
            FerdigMeldKladdLinje."Starting Time" := recOperasjonstider."Starting Time";
            FerdigMeldKladdLinje."Ending Time" := recOperasjonstider."Ending Time";
            FerdigMeldKladdLinje.VALIDATE(FerdigMeldKladdLinje."Run Time",GetHours(recOperasjonstider."Starting Date",
              recOperasjonstider."Starting Time", recOperasjonstider."Ending Date", recOperasjonstider."Ending Time"));
            //hhe 23.10.07->
            FerdigMeldKladdLinje.VALIDATE("Scrap Comment", ScrapCommentP);
            //hhe 23.10.07<-
            //hhe 20.04.06->
            //sl†r her over flagget slik at ferdig-/vrak-antall ikke bokf›res p† alle p.ress. som avsluttes
            FirstRecOpLineL := FALSE;
            //hhe 20.04.06<-
            FerdigMeldKladdLinje.MODIFY(TRUE);
          END ELSE BEGIN
            FerdigMeldKladdLinje."Document No." := OPCOppsett."Document No. Ind.Time";
            FerdigMeldKladdLinje."Posting Date" := recOperasjonstider."Ending Date";
            FerdigMeldKladdLinje."Document Date" := TODAY;
            FerdigMeldKladdLinje.VALIDATE(FerdigMeldKladdLinje.Type,
              FerdigMeldKladdLinje.Type::"Machine Center");
            FerdigMeldKladdLinje.VALIDATE(FerdigMeldKladdLinje."No.", recOperasjonstider."Machine Center");
            FerdigMeldKladdLinje."Starting Time" := recOperasjonstider."Starting Time";
            FerdigMeldKladdLinje."Ending Time" := recOperasjonstider."Ending Time";
            FerdigMeldKladdLinje.VALIDATE(FerdigMeldKladdLinje."Stop Time", GetHours(recOperasjonstider."Starting Date",
              recOperasjonstider."Starting Time", recOperasjonstider."Ending Date", recOperasjonstider."Ending Time"));
            //22.01.10->
            //FerdigMeldKladdLinje."Stop Code" := NoneProducingTimeCode;
            FerdigMeldKladdLinje."Stop Code" := recOperasjonstider."Stop Code";
            //22.01.10<-
            FerdigMeldKladdLinje.MODIFY(TRUE);
          END;
        // 002 START
          recOperasjonstider.Post := TRUE;
          recOperasjonstider.MODIFY;
        UNTIL recOperasjonstider.NEXT = 0;
        //hhe 12.10.07->bokf. vrakkode2
        IF ScrapQty2P <> 0 THEN BEGIN
          FerdigMeldKladdLinje.INIT;
          FerdigMeldKladdLinje.VALIDATE(FerdigMeldKladdLinje."Journal Template Name", OPCOppsett."Output Batch Name Time");
          FerdigMeldKladdLinje.VALIDATE(FerdigMeldKladdLinje."Journal Batch Name", OPCOppsett."Output Jrn Name Time");
          FerdigMeldKladdLinje."Line No." := FerdigMeldKladdLinje."Line No." + 10000;
          FerdigMeldKladdLinje.VALIDATE(FerdigMeldKladdLinje."Entry Type", FerdigMeldKladdLinje."Entry Type"::Output);
          FerdigMeldKladdLinje.INSERT(TRUE);

          IF ProdOrdreLinje."Prod. Order No." <> '' THEN BEGIN
            FerdigMeldKladdLinje.VALIDATE("Order Type", FerdigMeldKladdLinje."Order Type"::Production);
            FerdigMeldKladdLinje.VALIDATE("Order No.", RunTimesP."Prod. Order No.");
            FerdigMeldKladdLinje.VALIDATE("Item No.", Vare."No.");
            FerdigMeldKladdLinje."Operation No." := RunTimesP."Operation No.";
            FerdigMeldKladdLinje.VALIDATE("Operation No.", RunTimesP."Operation No.");
            FerdigMeldKladdLinje.VALIDATE("Scrap Quantity", ScrapQty2P);
            FerdigMeldKladdLinje.VALIDATE("Scrap Code", ScrapCode2P);
          END;
          FerdigMeldKladdLinje."Document Date" := TODAY;
          FerdigMeldKladdLinje."Posting Date" := TODAY;
          FerdigMeldKladdLinje.VALIDATE(Type, FerdigMeldKladdLinje.Type::"Machine Center");
          FerdigMeldKladdLinje.VALIDATE("No.", recOperasjonstider."Machine Center");
          FerdigMeldKladdLinje.VALIDATE("Order Type", FerdigMeldKladdLinje."Order Type"::Production);
          FerdigMeldKladdLinje."Order Line No." :=  ProdOrdreLinje."Line No.";
          FerdigMeldKladdLinje.VALIDATE("Scrap Comment", ScrapComment2P);
          FerdigMeldKladdLinje.MODIFY;
        END;
        //hhe 12.10.07<-bokf. vrakkode2
        //hhe 15.10.07<- bokf. vrakkode 3 (hvis det er angitt)
        IF ScrapQty3P <> 0 THEN BEGIN
          FerdigMeldKladdLinje.INIT;
          FerdigMeldKladdLinje.VALIDATE(FerdigMeldKladdLinje."Journal Template Name", OPCOppsett."Output Batch Name Time");
          FerdigMeldKladdLinje.VALIDATE(FerdigMeldKladdLinje."Journal Batch Name", OPCOppsett."Output Jrn Name Time");
          FerdigMeldKladdLinje."Line No." := FerdigMeldKladdLinje."Line No." + 10000;
          FerdigMeldKladdLinje.VALIDATE(FerdigMeldKladdLinje."Entry Type", FerdigMeldKladdLinje."Entry Type"::Output);
          FerdigMeldKladdLinje.INSERT(TRUE);
          IF ProdOrdreLinje."Prod. Order No." <> '' THEN BEGIN
            FerdigMeldKladdLinje.VALIDATE("Order Type", FerdigMeldKladdLinje."Order Type"::Production);
            FerdigMeldKladdLinje.VALIDATE("Order No.", RunTimesP."Prod. Order No.");
            FerdigMeldKladdLinje.VALIDATE("Item No.", Vare."No.");
            FerdigMeldKladdLinje."Operation No." := RunTimesP."Operation No.";
            FerdigMeldKladdLinje.VALIDATE("Operation No.", RunTimesP."Operation No.");
            FerdigMeldKladdLinje.VALIDATE("Scrap Quantity", ScrapQty3P);
            FerdigMeldKladdLinje.VALIDATE("Scrap Code", ScrapCode3P);
          END;
          FerdigMeldKladdLinje."Document Date" := TODAY;
          FerdigMeldKladdLinje."Posting Date" := TODAY;
          FerdigMeldKladdLinje.VALIDATE(FerdigMeldKladdLinje.Type, FerdigMeldKladdLinje.Type::"Machine Center");
          FerdigMeldKladdLinje.VALIDATE(FerdigMeldKladdLinje."No.", recOperasjonstider."Machine Center");
          FerdigMeldKladdLinje.VALIDATE("Order Type", FerdigMeldKladdLinje."Order Type"::Production);
          FerdigMeldKladdLinje."Order Line No." :=  ProdOrdreLinje."Line No.";
          FerdigMeldKladdLinje.VALIDATE("Scrap Comment", ScrapComment3P);
          FerdigMeldKladdLinje.MODIFY;
        END;
        //hhe 15.10.07<- bokf. vrakkode 3 (hvis det er angitt)

        FerdigMeldKladdLinje.RESET;
        FerdigMeldKladdLinje.SETRANGE("Journal Template Name",OPCOppsett."Output Batch Name Time");
        FerdigMeldKladdLinje.SETRANGE("Journal Batch Name",OPCOppsett."Output Jrn Name Time");
        IF FerdigMeldKladdLinje.FINDFIRST THEN BEGIN
          CODEUNIT.RUN(CODEUNIT::"Item Jnl.-Post", FerdigMeldKladdLinje);
        END;
      END;
      //hhe 20.04.06->
      OutPutQtyP := 0;
      ScrapQtyP := 0;
      ScrapCodeP := '';
      //hhe 20.04.06<-
      //hhe 12.10.07->
      ScrapQty2P := 0;
      ScrapCode2P := '';
      //hhe 12.10.07
      //hhe 24.10.07->
      ScrapCommentP := '';
      ScrapComment2P := '';
      ScrapComment3P := '';
      ScrapQty3P := 0;
      ScrapCode3P := '';
      //hhe 24.10.07<-
    END;

    LOCAL PROCEDURE SearchDeductions@1101103001(VAR RunTimes@1000000000 : Record 83010);
    VAR
      RunTimeDeduction@1000000003 : Record 83012;
      RunTimes2@1000000002 : Record 83010;
    BEGIN
      RunTimeDeduction.RESET;
      IF RunTimeDeduction.FIND('-') THEN
        REPEAT
          RunTimes2.RESET;
          RunTimes2.SETRANGE("Prod. Order No.",  RunTimes."Prod. Order No.");
          RunTimes2.SETRANGE("Routing No.",  RunTimes."Routing No.");
          RunTimes2.SETRANGE("Operation No.",  RunTimes."Operation No.");
          //hhe 12.10.06->
          RunTimes2.SETRANGE("Machine Center",  RunTimes."Machine Center");
          //hhe 12.10.06<-
          RunTimes2.SETRANGE("Finish Now",  TRUE);
          RunTimes2.SETRANGE(Post,  FALSE);
          RunTimes2.SETRANGE("Starting Date", RunTimes."Starting Date");
          RunTimes2.SETFILTER("Starting Time", '<=%1', RunTimeDeduction."From Time");
          //hhe 28.09.06->  //dersom man avslutter jobben over midnatt
          IF RunTimes."Ending Date" > RunTimes."Starting Date" THEN
            RunTimes2.SETRANGE("Ending Date", RunTimes."Starting Date")
          ELSE
          //hhe 28.09.06<-
          RunTimes2.SETRANGE("Ending Date", RunTimes."Ending Date");
          RunTimes2.SETFILTER("Ending Time", '>=%1', RunTimeDeduction."To Time");
          IF RunTimes2.FINDFIRST THEN
            IF NOT ExistingDeductionLine(RunTimes, RunTimeDeduction) THEN
              InsertDeductionLine(RunTimes, RunTimeDeduction);

        UNTIL RunTimeDeduction.NEXT = 0;
    END;

    LOCAL PROCEDURE GetHours@1101104001(StartDate@1101104003 : Date;StartTime@1101104002 : Time;EndDate@1101104001 : Date;EndTime@1101104000 : Time) : Decimal;
    VAR
      StartDateTime@1101104004 : DateTime;
      EndDateTime@1101104005 : DateTime;
    BEGIN
      StartDateTime := CREATEDATETIME(StartDate, StartTime);
      EndDateTime := CREATEDATETIME(EndDate, EndTime);
      EXIT( ((EndDateTime - StartDateTime) / 3600000) );
    END;

    LOCAL PROCEDURE ExistingDeductionLine@1101103002(VAR RunTimes@1000000001 : Record 83010;VAR RunTimeDeduction@1000000000 : Record 83012) : Boolean;
    VAR
      RunTimes2@1000000002 : Record 83010;
    BEGIN
      RunTimes2.RESET;
      RunTimes2.SETRANGE("Prod. Order No.",  RunTimes."Prod. Order No.");
      RunTimes2.SETRANGE("Routing No.",  RunTimes."Routing No.");
      RunTimes2.SETRANGE("Operation No.",  RunTimes."Operation No.");
      //hhe 12.10.06->
      RunTimes2.SETRANGE("Machine Center",  RunTimes."Machine Center");
      //hhe 12.10.06<-
      RunTimes2.SETRANGE("Finish Now", RunTimes."Finish Now");
      RunTimes2.SETRANGE(Post,  RunTimes.Post);
      RunTimes2.SETRANGE("Starting Date", RunTimes."Starting Date");
      RunTimes2.SETRANGE("Starting Time", RunTimeDeduction."To Time");
      RunTimes2.SETRANGE("Ending Date", RunTimes."Ending Date");
      RunTimes2.SETRANGE("Ending Time", RunTimeDeduction."From Time");
      EXIT(RunTimes2.FIND('-'));
    END;

    LOCAL PROCEDURE InsertDeductionLine@1101103003(VAR RunTimes@1000000000 : Record 83010;VAR RunTimeDeduction@1000000004 : Record 83012);
    VAR
      RunTimes2@1000000001 : Record 83010;
      NewEntryNo@1000000002 : Integer;
    BEGIN
      RunTimes2.RESET;
      IF RunTimes2.FIND('+') THEN
        NewEntryNo := RunTimes2."Entry No." + 1
      ELSE
        NewEntryNo := 1;

      RunTimes2.INIT;
      RunTimes2."Entry No." := NewEntryNo;
      RunTimes2."Prod. Order No." := RunTimes."Prod. Order No.";
      RunTimes2."Routing No." := RunTimes."Routing No.";
      RunTimes2."Operation No." := RunTimes."Operation No.";
      RunTimes2."Machine Center" := RunTimes."Machine Center";
      RunTimes2.Description := RunTimes.Description;
      RunTimes2."Starting Date" := RunTimes."Starting Date";
      RunTimes2."Starting Time" := RunTimeDeduction."To Time";
      RunTimes2."Ending Date" := RunTimes."Starting Date";
      RunTimes2."Ending Time" := RunTimeDeduction."From Time";
      RunTimes2."Finish Now" := TRUE;
      RunTimes2.Post := FALSE;
      RunTimes2."Work done at M.C." := RunTimes."Work done at M.C.";
      RunTimes2.INSERT;
    END;

    PROCEDURE DeleteBlankRunTimes@1101103004(VAR RunTimesP@1101103000 : Record 83010);
    VAR
      RunTimesL@1000000000 : Record 83010;
    BEGIN
      ////010 BVM-->
      RunTimesL.RESET;
      RunTimesL.SETRANGE("Prod. Order No.", RunTimesP."Prod. Order No.");
      RunTimesL.SETRANGE("Routing No.", RunTimesP."Routing No.");
      RunTimesL.SETRANGE("Starting Date", 0D);
      RunTimesL.SETRANGE("Starting Time", 0T);
      RunTimesL.SETRANGE("Ending Date", 0D);
      RunTimesL.SETRANGE("Ending Time", 0T);
      IF RunTimesL.FINDFIRST THEN BEGIN
       RunTimesL.DELETEALL;
      END;
      //010 BVM--<
    END;

    PROCEDURE PostOutputItem@1101103005(ProdOrderRoutingLineP@1101103000 : Record 5409);
    VAR
      ItemL@1101103002 : Record 27;
      OPCSetupL@1101103001 : Record 83001;
      ProdOrderLineL@1101103004 : Record 5406;
      ItemJournalLineL@1101103015 : Record 83;
      OutputRegistrationL@1101103003 : Page 83010;
      FerdigmeldAntallL@1101103005 : Decimal;
      VrakAnt2@1101103014 : Decimal;
      VrakBeskr2@1101103013 : Text[50];
      VrakKode2@1101103012 : Code[20];
      VrakKode@1101103011 : Code[20];
      VrakBeskr@1101103010 : Text[50];
      VrakAnt3@1101103009 : Decimal;
      VrakBeskr3@1101103008 : Text[50];
      VrakKode3@1101103007 : Code[20];
      VrakAntallL@1101103006 : Decimal;
      PageActionL@1101103016 : Action;
      HasPostItem@1101103017 : Boolean;
    BEGIN
      HasPostItem := FALSE;
      OPCSetupL.GET();
      ProdOrderLineL.SETRANGE(Status, ProdOrderLineL.Status::Released);
      ProdOrderLineL.SETRANGE("Prod. Order No.", ProdOrderRoutingLineP."Prod. Order No.");
      ProdOrderLineL.SETRANGE("Routing No.", ProdOrderRoutingLineP."Routing No.");
      IF ProdOrderLineL.FINDFIRST THEN BEGIN
        IF ItemL.GET(ProdOrderLineL."Item No.") THEN BEGIN
          ProdOrderLineL.TESTFIELD("Routing No.");
          OPCSetupL.TESTFIELD("Output Template Name Qty");
          OPCSetupL.TESTFIELD("Output Jrn Batch Name Qty");

          OutputRegistrationL.SettTekst(ProdOrderRoutingLineP."Prod. Order No.", ItemL."No.", ItemL.Description, ProdOrderRoutingLineP.Description);
          PageActionL := OutputRegistrationL.RUNMODAL();
          IF (PageActionL = ACTION::Yes) OR (PageActionL = ACTION::LookupOK) THEN
            FerdigmeldAntallL := OutputRegistrationL.FinnAntall
          ELSE
            EXIT;

          VrakAntallL := OutputRegistrationL.VrakAnt;
          VrakKode := OutputRegistrationL.VrakID;
          VrakBeskr := OutputRegistrationL.VrakBeskrivelse;
          VrakAnt2 := OutputRegistrationL.VrakAntall2;
          VrakKode2 := OutputRegistrationL.VrakID2;
          VrakBeskr2 := OutputRegistrationL.VrakBeskrivelse2;
          VrakAnt3 := OutputRegistrationL.VrakAntall3;
          VrakKode3 := OutputRegistrationL.VrakID3;
          VrakBeskr3 := OutputRegistrationL.VrakBeskrivelse3;

          IF (FerdigmeldAntallL = 0) AND ((VrakAntallL + VrakAnt2 + VrakAnt3) > 0) THEN
            ERROR(C_ErrorInQty);

          IF (FerdigmeldAntallL > 0) OR (VrakAntallL > 0) THEN BEGIN
            ItemJournalLineL.SETRANGE("Journal Template Name", OPCSetupL."Output Template Name Qty");
            ItemJournalLineL.SETRANGE("Journal Batch Name", OPCSetupL."Output Jrn Batch Name Qty");
            IF ItemJournalLineL.FINDFIRST THEN
              ItemJournalLineL.DELETEALL;

            ItemJournalLineL.INIT;
            ItemJournalLineL.VALIDATE("Journal Template Name", OPCSetupL."Output Template Name Qty");
            ItemJournalLineL.VALIDATE("Journal Batch Name", OPCSetupL."Output Jrn Batch Name Qty");
            ItemJournalLineL."Line No." := 10000;
            ItemJournalLineL.VALIDATE("Entry Type", ItemJournalLineL."Entry Type"::Output);
            ItemJournalLineL.INSERT(TRUE);

            ItemJournalLineL.VALIDATE("Order Type", ItemJournalLineL."Order Type"::Production);
            ItemJournalLineL.VALIDATE("Order No.", ProdOrderRoutingLineP."Prod. Order No.");
            ItemJournalLineL."Operation No." := ProdOrderRoutingLineP."Operation No.";
            ItemJournalLineL.VALIDATE("Item No.", ItemL."No.");
            ItemJournalLineL."Posting Date" := TODAY;
            ItemJournalLineL."Document Date" := TODAY;
            ItemJournalLineL.VALIDATE(Type, ItemJournalLineL.Type::"Machine Center");
            ItemJournalLineL.VALIDATE("No.", ProdOrderRoutingLineP."No.");
            ItemJournalLineL.VALIDATE("Output Quantity", FerdigmeldAntallL);
            ItemJournalLineL."Order Type" := ItemJournalLineL."Order Type"::Production;
            ItemJournalLineL."Order Line No." := ProdOrderLineL."Line No.";
            ItemJournalLineL."Location Code" :=  ProdOrderLineL."Location Code";
            ItemJournalLineL.VALIDATE("Entry Type", ItemJournalLineL."Entry Type"::Output);
            ItemJournalLineL."Document No." := 'T00001';
            ItemJournalLineL.VALIDATE("Scrap Quantity", VrakAntallL);
            ItemJournalLineL.VALIDATE("Scrap Code", VrakKode);
            ItemJournalLineL.VALIDATE("Scrap Comment", VrakBeskr);
            ItemJournalLineL.MODIFY(TRUE);
            HasPostItem := TRUE;
          END;

          //008 HEI-> Bokf›rer hvis antall "Vrak 2" er registrert
          IF VrakAnt2 <> 0 THEN BEGIN
            ItemJournalLineL.INIT;
            ItemJournalLineL.VALIDATE("Journal Template Name", OPCSetupL."Output Batch Name Time");
            ItemJournalLineL.VALIDATE("Journal Batch Name", OPCSetupL."Output Jrn Name Time");
            ItemJournalLineL."Line No." := ItemJournalLineL."Line No." + 10000;
            ItemJournalLineL.VALIDATE(ItemJournalLineL."Entry Type",
            ItemJournalLineL."Entry Type"::Output);
            ItemJournalLineL.INSERT(TRUE);

            ItemJournalLineL."Order Type" := ItemJournalLineL."Order Type"::Production;
            ItemJournalLineL.VALIDATE("Order No.", ProdOrderRoutingLineP."Prod. Order No.");
            ItemJournalLineL."Operation No." := ProdOrderRoutingLineP."Operation No.";
            ItemJournalLineL.VALIDATE("Item No.", ItemL."No.");
            ItemJournalLineL."Posting Date" := TODAY;
            ItemJournalLineL."Document Date" := TODAY;
            ItemJournalLineL.VALIDATE(ItemJournalLineL.Type,
            ItemJournalLineL.Type::"Machine Center");
            ItemJournalLineL.VALIDATE("No.", ProdOrderRoutingLineP."No.");
            ItemJournalLineL.VALIDATE("Output Quantity", 0);
            ItemJournalLineL."Order Line No." :=  ProdOrderLineL."Line No.";
            ItemJournalLineL."Location Code" :=  ProdOrderLineL."Location Code";
            ItemJournalLineL.VALIDATE("Entry Type", ItemJournalLineL."Entry Type"::Output);
            ItemJournalLineL."Document No." := 'T00001';
            ItemJournalLineL.VALIDATE("Scrap Quantity", VrakAnt2);
            ItemJournalLineL.VALIDATE("Scrap Code",VrakKode2);
            ItemJournalLineL.VALIDATE("Scrap Comment",VrakBeskr2);

            ItemJournalLineL.MODIFY;
            HasPostItem := TRUE;
          END;

          IF VrakAnt3 <> 0 THEN BEGIN  //Bokf›rer hvis antall "Vrak 3" er registrert
            ItemJournalLineL.INIT;
            ItemJournalLineL.VALIDATE("Journal Template Name", OPCSetupL."Output Batch Name Time");
            ItemJournalLineL.VALIDATE("Journal Batch Name", OPCSetupL."Output Jrn Name Time");
            ItemJournalLineL."Line No." := ItemJournalLineL."Line No." + 10000;
            ItemJournalLineL.VALIDATE("Entry Type", ItemJournalLineL."Entry Type"::Output);
            ItemJournalLineL.INSERT(TRUE);

            ItemJournalLineL."Order Type" := ItemJournalLineL."Order Type"::Production;
            ItemJournalLineL.VALIDATE("Order No.", ProdOrderRoutingLineP."Prod. Order No.");
            ItemJournalLineL."Operation No." := ProdOrderRoutingLineP."Operation No.";
            ItemJournalLineL.VALIDATE("Item No.", ItemL."No.");
            ItemJournalLineL."Posting Date" := TODAY;
            ItemJournalLineL."Document Date" := TODAY;
            ItemJournalLineL.VALIDATE(Type, ItemJournalLineL.Type::"Machine Center");
            ItemJournalLineL.VALIDATE("No.", ProdOrderRoutingLineP."No.");
            ItemJournalLineL.VALIDATE("Output Quantity", 0);
            ItemJournalLineL."Order Line No." :=  ProdOrderLineL."Line No.";
            ItemJournalLineL."Location Code" :=  ProdOrderLineL."Location Code";
            ItemJournalLineL.VALIDATE("Entry Type", ItemJournalLineL."Entry Type"::Output);
            ItemJournalLineL."Document No." := 'T00001';
            ItemJournalLineL.VALIDATE("Scrap Quantity", VrakAnt3);
            ItemJournalLineL.VALIDATE("Scrap Code",VrakKode3);
            ItemJournalLineL.VALIDATE("Scrap Comment",VrakBeskr3);

            ItemJournalLineL.MODIFY;
            HasPostItem := TRUE;
          END;
          //008 HEI<-
          IF HasPostItem THEN
            CODEUNIT.RUN(CODEUNIT::"Item Jnl.-Post", ItemJournalLineL);
        END;
      END;
    END;

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 16.06.06 hhe Kode som l›ser problemet med at en person er p†logget den ene dagen, men logger ut p† neste
      02. 28.07.16 JAL Raskere innstempling p† indirekte tid.
    }
    END.
  }
}

OBJECT Codeunit 83002 Clocking Overtime
{
  OBJECT-PROPERTIES
  {
    Date=20.04.17;
    Time=16.20.12;
    Modified=Yes;
    Version List=OPC (RSI);
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    PROCEDURE ClockOvertime@1117700003(VAR TimeRegister@1117700001 : Record 83007);
    VAR
      DayType@1117700000 : 'Normal Day,Holiday,Saturday';
    BEGIN
      WITH TimeRegister DO BEGIN
        CASE TRUE OF
          IsNormalDay("Start Date"):
            DayAndOvertimeClocking(TimeRegister, DayType::"Normal Day");

          IsHoliday("Start Date"):
            DayAndOvertimeClocking(TimeRegister, DayType::Holiday);

          IsSaturday("Start Date"):
            DayAndOvertimeClocking(TimeRegister, DayType::Saturday);
        END;
      END;
    END;

    PROCEDURE DayAndOvertimeClocking@1117700000(VAR TimeRegister@1101104000 : Record 83007;DayType@1117700013 : 'Normal Day,Holiday,Saturday');
    VAR
      TimeRegister2@1101104001 : Record 83007;
      TimeRegister3@1101104002 : Record 83007;
      WorkTime@1117700003 : Record 83003;
      FilterFromTime@1117700005 : Text[50];
      RestClockTime@1117700000 : Decimal;
      WorkQty@1117700007 : Decimal;
      FirstFromTime@1117700006 : Time;
      LastTimeUntil@1117700008 : Time;
      ClockedFirstTime@1117700014 : Time;
      DayTypeChanged@1117700015 : Boolean;
      Holiday@1117700010 : Boolean;
      Saturday@1117700011 : Boolean;
      NormalDay@1117700012 : Boolean;
    BEGIN
      RestClockTime := 0;
      ClockedFirstTime := 0T;
      DayTypeChanged := FALSE;

      Holiday := DayType = DayType::Holiday;
      Saturday := DayType = DayType::Saturday;
      NormalDay := DayType = DayType::"Normal Day";

      WorkTime.RESET;
      WorkTime.SETCURRENTKEY("From Time","To Time","Day Type","Time Type");
      WorkTime.SETRANGE("Day Type", DayType);
      IF WorkTime.FIND('-') THEN REPEAT

        WorkTime.TESTFIELD("From Time");
        WorkTime.TESTFIELD("To Time");

        WorkQty := 0;
        FirstFromTime := 0T;
        LastTimeUntil := 0T;

        IF ClockedFirstTime = 0T THEN BEGIN
          ClockedFirstTime := FindFirstClockingToday(TimeRegister);

          IF ClockedFirstTime = 0T THEN
            EXIT;

          FilterFromTime := STRSUBSTNO('>=%1&<%2',
            CONVERTSTR(FORMAT(ClockedFirstTime - 36000), ':', '.'),
              CONVERTSTR(FORMAT(WorkTime."To Time"), ':', '.'));
        END ELSE
          FilterFromTime := STRSUBSTNO('>=%1&<%2',
            CONVERTSTR(FORMAT(WorkTime."From Time"), ':', '.'),
              CONVERTSTR(FORMAT(WorkTime."To Time"), ':', '.'));

        TimeRegister2.RESET;
        TimeRegister2.SETRANGE("Machine Center", TimeRegister."Machine Center");
        TimeRegister2.SETRANGE("Start Date", TimeRegister."Start Date");
        TimeRegister2.SETFILTER("Start Time", FilterFromTime);
        IF TimeRegister2.FIND('-') THEN REPEAT
          // Tar vare p† den f›rste innstemplingen som finnes f›rst
          // for † regne ut totaltiden.
          IF FirstFromTime = 0T THEN
            FirstFromTime := TimeRegister2."Start Time";

          // F›rste stempling blir rettet p†
          WorkQty += TimeRegister2.Quantity;

          IF WorkQty > WorkTime.Duration THEN BEGIN
            RestClockTime := WorkQty - WorkTime.Duration;

            // Tar vare p† "Time Until" for † bruke den
            // i neste splittet post.
            IF LastTimeUntil = 0T THEN
              LastTimeUntil := TimeRegister2."End Time";

            IF ClockedFirstTime < WorkTime."From Time" THEN
              TimeRegister2.VALIDATE("End Time",
                WorkTime."To Time")
            ELSE
              TimeRegister2.VALIDATE("End Time",
                (FirstFromTime + (WorkTime.Duration * 3600000)));

          END ELSE
            RestClockTime := 0;

          TimeRegister2.VALIDATE("Work Type Code",
            GetWorkTypeCode(TimeRegister2."Work Type Code", WorkTime."Time Type"));
          TimeRegister2.MODIFY;

          // Sette inn ny stempling hvis RestClockTime har en restverdi
          // Slutttiden til den forrige stemplingen blir n† starttiden tile den neste

          IF RestClockTime > 0 THEN BEGIN
            InsertTimeRegisterEntry(TimeRegister3, TimeRegister,
              TimeRegister2."End Time", LastTimeUntil);

            // Sjekker hva DayType er blitt forandret.
            CASE TRUE OF
              Holiday <> IsHoliday(TimeRegister3."Start Date"):
                DayTypeChanged := TRUE;

              Saturday <> IsSaturday(TimeRegister3."Start Date"):
                DayTypeChanged := TRUE;

              NormalDay <> IsNormalDay(TimeRegister3."Start Date"):
                DayTypeChanged := TRUE;

              ELSE
                DayTypeChanged := FALSE;
            END;

          END;

        UNTIL ((TimeRegister2.NEXT = 0) OR DayTypeChanged);

      UNTIL ((WorkTime.NEXT = 0) OR DayTypeChanged);


      IF DayTypeChanged THEN
        ClockOvertime(TimeRegister3)
      ELSE
        EXIT;
    END;

    PROCEDURE IsNormalDay@1117700002(ClockingDate@1117700000 : Date) : Boolean;
    BEGIN
      EXIT(NOT (IsHoliday(ClockingDate) OR IsSaturday(ClockingDate)));
    END;

    PROCEDURE IsHoliday@1117700006(ClockingDate@1117700000 : Date) : Boolean;
    VAR
      DateTable@1117700001 : Record 2000000007;
      Holidays@1117700002 : Record 83005;
      Found@1117700003 : Boolean;
    BEGIN
      Found := Holidays.GET(ClockingDate);

      IF NOT Found THEN BEGIN
        DateTable.RESET;
        DateTable.SETRANGE("Period Type", DateTable."Period Type"::Date);
        DateTable.SETRANGE("Period No.", 7);  // Sunday
        DateTable.SETRANGE("Period Start", ClockingDate);
        Found := DateTable.FIND('-');
      END;

      EXIT(Found);
    END;

    PROCEDURE IsSaturday@1117700008(ClockingDate@1117700000 : Date) : Boolean;
    VAR
      DateTable@1117700001 : Record 2000000007;
    BEGIN
      DateTable.RESET;
      DateTable.SETRANGE("Period Type", DateTable."Period Type"::Date);
      DateTable.SETRANGE("Period No.", 6); // Saturday
      DateTable.SETRANGE("Period Start", ClockingDate);
      EXIT(DateTable.FIND('-'));
    END;

    PROCEDURE FindFirstClockingToday@1117700005(VAR TimeRegister@1117700000 : Record 83007) : Time;
    VAR
      TimeRegister2@1101104000 : Record 83007;
    BEGIN
      WITH TimeRegister DO BEGIN
        TimeRegister2.RESET;
        TimeRegister2.SETRANGE("Machine Center", "Machine Center");
        TimeRegister2.SETRANGE("Start Date", "Start Date");
        IF TimeRegister2.FIND('-') THEN
          EXIT(TimeRegister2."Start Time")
        ELSE
          EXIT(0T);
      END;
    END;

    PROCEDURE InsertTimeRegisterEntry@1101104000(VAR TimeRegisterNew@1117700003 : Record 83007;TimeRegister@1117700000 : Record 83007;TimeFrom@1117700002 : Time;TimeUntil@1117700006 : Time);
    BEGIN
      // Ordre
      IF TimeFrom = TimeUntil THEN
        EXIT;

      WITH TimeRegister DO BEGIN
        TimeRegisterNew.RESET;
        TimeRegisterNew.INIT;
        TimeRegisterNew."Machine Center" := "Machine Center";
        TimeRegisterNew."Start Date" := "Start Date";
        TimeRegisterNew."Start Time" := TimeFrom;
        TimeRegisterNew."End Date" := "Start Date";
        TimeRegisterNew."End Time" := TimeUntil;
        TimeRegisterNew."Time Type" := "Time Type";
        TimeRegisterNew.CalcQty;
        TimeRegisterNew.INSERT;
      END;
    END;

    PROCEDURE GetWorkTypeCode@1117700001(WorkType@1117700000 : Code[10];TimeType@1117700001 : 'Normal,Overtime 50%,Overtime 100%') : Code[10];
    VAR
      WorkTypeCode@1000000000 : Record 83004;
    BEGIN
      WorkTypeCode.RESET;
      WorkTypeCode.SETRANGE("Time Type", TimeType);
      WorkTypeCode.SETRANGE(Absence, FALSE);
      WorkTypeCode.FIND('-');
      EXIT(WorkTypeCode.Code);
    END;

    BEGIN
    END.
  }
}

OBJECT Codeunit 83003 Clocking Calculation
{
  OBJECT-PROPERTIES
  {
    Date=20.04.17;
    Time=16.20.12;
    Modified=Yes;
    Version List=OPC (RSI);
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    PROCEDURE FillTable@1000000001(FromDate@1000000002 : Date;ToDate@1000000003 : Date);
    VAR
      PaymentTable@1000000000 : Record 83006;
      MachineCenter@1000000001 : Record 99000758;
      WorkTypeCode@1000000004 : Record 83004;
      Window@1000000006 : Dialog;
      Qty@1000000005 : Decimal;
    BEGIN

      PaymentTable.DELETEALL;

      Window.OPEN('Beregner for #1##########');

      MachineCenter.RESET;
      MachineCenter.SETRANGE(Clocking, TRUE);
      MachineCenter.SETRANGE("Date Filter", FromDate, ToDate);
      IF MachineCenter.FIND('-') THEN
        REPEAT

          MachineCenter.TESTFIELD("Employee No.");

          Window.UPDATE(1, MachineCenter."No.");

          WorkTypeCode.RESET;
          WorkTypeCode.SETFILTER("Payment Type", '<>%1', '');
          IF WorkTypeCode.FIND('-') THEN
            REPEAT
              Qty := GetSum( WorkTypeCode, MachineCenter);

              IF Qty <> 0 THEN BEGIN

                PaymentTable.INIT;
                PaymentTable."Machine Center No." := MachineCenter."No.";
                PaymentTable."Work Type Code" := WorkTypeCode.Code;
                PaymentTable."Employee No." := MachineCenter."Employee No.";
                PaymentTable."Employee Name" := MachineCenter.Name;
                PaymentTable."Payment Type" := WorkTypeCode."Payment Type";
                PaymentTable.Quantity := Qty;
                PaymentTable.INSERT;

              END;

            UNTIL WorkTypeCode.NEXT = 0;
        UNTIL MachineCenter.NEXT = 0;

      Window.CLOSE;
    END;

    PROCEDURE GetSum@1000000000(VAR WorkTypeCode@1000000000 : Record 83004;VAR MachineCenter@1000000001 : Record 99000758) : Decimal;
    BEGIN
      WITH WorkTypeCode DO BEGIN
        SETRANGE("Machine Center Filter", MachineCenter."No.");
        SETFILTER("Date Filter", MachineCenter.GETFILTER("Date Filter"));
        CALCFIELDS("Time Registered");

        EXIT("Time Registered");
      END;
    END;

    BEGIN
    END.
  }
}

OBJECT Codeunit 83004 Post Output
{
  OBJECT-PROPERTIES
  {
    Date=20.04.17;
    Time=16.20.12;
    Modified=Yes;
    Version List=OPC (RSI);
  }
  PROPERTIES
  {
    TableNo=83007;
    OnRun=BEGIN
            TESTFIELD("End Date");
            TESTFIELD("End Time");
            PostOutput("Machine Center", "End Date", "End Time");
          END;

  }
  CODE
  {
    VAR
      MachineCenter@1000000000 : Record 99000758;

    LOCAL PROCEDURE PostOutput@1000000000(MachineCenter@1000000002 : Code[20];EndDate@1000000004 : Date;EndTime@1000000005 : Time);
    VAR
      RunTimes@1000000001 : Record 83010;
      ProdOrderLine@1000000003 : Record 5406;
      ProdOrderRoutingLine@1000000010 : Record 5409;
      ItemJnlLine@1000000000 : Record 83;
      ItemJnlPostLine@1000000006 : Codeunit 22;
      DimMgt@1000000009 : Codeunit 408;
    BEGIN
      RunTimes.RESET;
      RunTimes.SETRANGE("Machine Center", MachineCenter);
      RunTimes.SETFILTER("Starting Date", '<>%1', 0D);
      RunTimes.SETFILTER("Starting Time", '<>%1', 0T);
      RunTimes.SETRANGE("Ending Time", 0T);
      RunTimes.SETRANGE(Post,  FALSE);
      IF RunTimes.FINDFIRST THEN
      REPEAT
        ProdOrderLine.SETRANGE(Status, ProdOrderLine.Status::Released);
        ProdOrderLine.SETRANGE("Prod. Order No.", RunTimes."Prod. Order No.");
        ProdOrderLine.SETRANGE("Routing No.", RunTimes."Routing No.");
        IF ProdOrderLine.FIND('-') THEN
          REPEAT
            ItemJnlLine.INIT;
            ItemJnlLine.CopyDim(ProdOrderLine."Dimension Set ID"); //JAL
            ItemJnlLine."Posting Date" := EndDate;
            ItemJnlLine."Document Date" := EndDate;
            ItemJnlLine."Entry Type" := ItemJnlLine."Entry Type"::Output;
            ItemJnlLine."Operation No." := RunTimes."Operation No.";
            ItemJnlLine.Type := ItemJnlLine.Type::"Machine Center";
            ItemJnlLine.VALIDATE("No.", MachineCenter);
            ItemJnlLine.VALIDATE("Order Type", ItemJnlLine."Order Type"::Production);
            ItemJnlLine.VALIDATE("Order No.", RunTimes."Prod. Order No.");
            ItemJnlLine.VALIDATE("Order Line No.", ProdOrderLine."Line No.");
            ItemJnlLine.VALIDATE("Item No.", ProdOrderLine."Item No.");
            ItemJnlLine."Starting Time" := RunTimes."Starting Time";
            ItemJnlLine."Ending Time" := EndTime;
            ItemJnlLine.VALIDATE("Run Time", ROUND(CalculateTime(RunTimes."Starting Date",
              RunTimes."Starting Time", EndDate, EndTime),0.01,'='));

            ItemJnlPostLine.RunWithCheck(ItemJnlLine);

            ProdOrderRoutingLine.RESET;
            ProdOrderRoutingLine.SETRANGE(Status, ProdOrderRoutingLine.Status::Released);
            ProdOrderRoutingLine.SETRANGE("Prod. Order No.", RunTimes."Prod. Order No.");
            ProdOrderRoutingLine.SETRANGE("Routing No.", RunTimes."Routing No.");
            ProdOrderRoutingLine.SETRANGE("Operation No.", RunTimes."Operation No.");
            ProdOrderRoutingLine.SETRANGE(Type, ProdOrderRoutingLine.Type::"Machine Center");
            IF ProdOrderRoutingLine.FIND('-') THEN
              RunTimes."Work done at M.C." := ProdOrderRoutingLine."No.";

            RunTimes."Ending Date" := EndDate;
            RunTimes."Ending Time" := EndTime;
            RunTimes."Finish Now" := TRUE;
            RunTimes.Post := TRUE;
            RunTimes.MODIFY;

          UNTIL ProdOrderLine.NEXT = 0;

      UNTIL RunTimes.NEXT = 0;
    END;

    LOCAL PROCEDURE CalculateTime@1000000001(StartDate@1000000003 : Date;StartTime@1000000002 : Time;EndDate@1000000001 : Date;EndTime@1000000000 : Time) : Decimal;
    BEGIN
      IF (EndTime <> 0T) AND (StartTime <> 0T)
        AND (EndDate <> 0D) AND (StartDate <> 0D) THEN
          EXIT(((EndDate - StartDate) * 1440) + ((EndTime - StartTime) / 60000))
      ELSE
        EXIT(0);
    END;

    BEGIN
    END.
  }
}

OBJECT Page 83001 OPC - Information board
{
  OBJECT-PROPERTIES
  {
    Date=20.04.17;
    Time=16.20.12;
    Modified=Yes;
    Version List=OPC2.0;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=OPC - Information board;
               NOR=OPC - informasjonssentral];
    SourceTable=Table99000758;
    SourceTableView=SORTING(No.)
                    ORDER(Ascending)
                    WHERE(Show in OPC=FILTER(Yes));
    PageType=List;
    TimerUpdate=2000;
    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000000;1 ;Action    ;
                      Name=Time Register Card;
                      CaptionML=[ENU=Registration Card;
                                 NOR=M›nstringskort];
                      RunObject=Page 83015;
                      RunPageOnRec=No;
                      Promoted=Yes;
                      Visible=false;
                      PromotedIsBig=Yes;
                      Image=Timesheet;
                      PromotedCategory=Process }
      { 1000000003;1 ;Action    ;
                      Name=Planlagte oppgaver;
                      CaptionML=[ENU=Planned tasks;
                                 NOR=Planlagte oppgaver];
                      RunObject=Page 83023;
                      RunPageOnRec=No;
                      RunPageLink=No.=FIELD(No.),
                                  Status=CONST(Firm Planned);
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PlanningWorksheet;
                      PromotedCategory=Process }
      { 11      ;1   ;Action    ;
                      Name=Internal activities;
                      CaptionML=[ENU=Internal activities;
                                 NOR=Ikke prod. tid];
                      RunPageOnRec=No;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=AbsenceCategory;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 NonProdTime@1101103000 : Page 83028;
                               BEGIN
                                 CLEAR(NonProdTime);
                                 NonProdTime.InitForm("No.");
                                 NonProdTime.RUN;
                               END;
                                }
      { 1000000001;1 ;Action    ;
                      Name=Tasks;
                      CaptionML=[ENU=Tasks;
                                 NOR=Oppgaver];
                      RunObject=Page 83002;
                      RunPageOnRec=No;
                      RunPageLink=No.=FIELD(No.),
                                  Status=CONST(Released);
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=TaskList;
                      PromotedCategory=Process }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1101103000;1;Group  ;
                GroupType=Group }

    { 1101103001;2;Field  ;
                Name=PingPong;
                Visible=false;
                Enabled=false;
                Editable=false;
                ControlAddIn=[Microsoft.Dynamics.Nav.Client.PingPong;PublicKeyToken=31bf3856ad364e35] }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                SourceExpr="No." }

    { 4   ;2   ;Field     ;
                SourceExpr=Name }

    { 1000000002;1;Part   ;
                Name=OPC - melding p† info.sentral;
                SubPageView=SORTING(Entry No.)
                            ORDER(Ascending);
                PagePartID=Page83003;
                ProviderID=2;
                Editable=false }

  }
  CODE
  {
    VAR
      OPCOppsett@1000000000 : Record 83001;
      FerdigMeldKladdLinje@1000000001 : Record 83;
      OPCInformationMessageG@1101103000 : Record 83002;

    EVENT PingPong@-1101103001::AddInReady@2();
    BEGIN
      CurrPage.PingPong.Ping(1000);
    END;

    EVENT PingPong@-1101103001::Pong@3();
    BEGIN
      CurrPage."OPC - melding p† info.sentral".PAGE.UpdatePage();
      CurrPage.UPDATE(FALSE);
      CurrPage.PingPong.Ping(1000);
    END;

    BEGIN
    {
      +-------------------------------------+
      | SI-Data                             |
      +-------------------------------------+
      Nr. Dato     Id  Beskrivelse
      01. 14.12.05 HHE Endret oppslag p† knapp="indirekte tid"
      02  29.03.06 ASL Endret p† oppslag Ikke produktiv tid
      03. 03.04.06 HHE sub-frm: melding p† Info.sentral - endret "glue" til right/bottom. Samme med Ress.liste (vert= Both)
      04. 15.12.06 HHE Utvidet antall tekstlinjer p† Oppslagstavle (8->15 linjer)
      05. 17.06.09 HHE Ny knapp:"Planlagte oppgaver"  (›nsket av PTL)
      06. 14.11.16 JAL Added PingPong control to refresh message every 30 seconds.
    }
    END.
  }
}

OBJECT Page 83002 OPC - Tasklist
{
  OBJECT-PROPERTIES
  {
    Date=20.04.17;
    Time=16.20.12;
    Modified=Yes;
    Version List=OPC1.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=OPC - Tasklist;
               NOR=OPC - Oppgaveliste];
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=No;
    SourceTable=Table5409;
    SourceTableView=SORTING(Type,No.,Starting Date)
                    ORDER(Ascending)
                    WHERE(Type=FILTER(Machine Center),
                          Routing Status=FILTER(<>Finished));
    DataCaptionFields=No.;
    PageType=List;
    RefreshOnActivate=Yes;
    OnAfterGetRecord=BEGIN
                       CLEAR(WarningIndex);
                       CLEAR(OrgQty);
                       ProdOrderLineG.SETRANGE(Status, ProdOrderLineG.Status::Released);
                       ProdOrderLineG.SETRANGE("Prod. Order No.", "Prod. Order No.");
                       ProdOrderLineG.SETRANGE("Routing No.", "Routing No.");

                       IF ProdOrderLineG.FINDFIRST THEN BEGIN
                         OrgQty := ProdOrderLineG.Quantity;
                         IF ItemG.GET(ProdOrderLineG."Item No.") THEN BEGIN
                           VareNr := ItemG."No.";
                           VareBesk := ItemG.Description;
                           ProdOrderComponentG.RESET;
                           ProdOrderComponentG.SETRANGE(Status,Status::Released);
                           ProdOrderComponentG.SETRANGE("Prod. Order No.", "Prod. Order No.");
                           ProdOrderComponentG.SETRANGE("Routing Link Code","Routing Link Code");

                           IF ProdOrderComponentG.FINDFIRST THEN
                             REPEAT
                               CLEAR(ItemInventory);
                               CLEAR(Item);
                               IF Item.GET(ProdOrderComponentG."Item No.") THEN BEGIN
                                 Item.SETRANGE("Location Filter", ProdOrderComponentG."Location Code");
                                 Item.CALCFIELDS(Inventory);
                                 ItemInventory := Item.Inventory;
                                 IF (ItemInventory - ProdOrderComponentG."Remaining Quantity") < 0 THEN
                                   WarningIndex := 1;
                               END;
                             UNTIL ProdOrderComponentG.NEXT = 0;
                         END;
                       END;
                       RemQty := OrgQty - "Finished Qty";
                       IF WarningIndex = 1 THEN BEGIN
                         OPCSetupG.GET;
                         OPCSetupG.CALCFIELDS("Warning Picture");
                       END
                       ELSE
                         OPCSetupG.INIT;
                       IF "Expected Capacity Need" <> 0 THEN
                         ExpectedCapacityNeedG := ("Expected Capacity Need"/1000/60/60)
                       ELSE
                         ExpectedCapacityNeedG := 0;
                     END;

    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000017;1 ;Action    ;
                      Name=Move Components;
                      CaptionML=[ENU=Move Components;
                                 NOR=Flytt komponenter];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=TransferToLines;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 OPCSetup@1000000003 : Record 83001;
                                 ProdRessurs@1000000004 : Record 99000758;
                               BEGIN
                                 //012->
                                 ProdRessurs.GET("No.");
                                 IF NOT ProdRessurs."Allow OPC Move" THEN
                                   ERROR('Denne produksjonsressursen kan ikke benytte denne funksjonen');
                                 //012<-
                                 //011->
                                 OPCSetup.GET;
                                 ProdOrderCompG.SETRANGE(Status, Status);
                                 ProdOrderCompG.SETRANGE("Prod. Order No.", "Prod. Order No.");
                                 ProdOrderCompG.SETRANGE("Location Code", OPCSetup."OPC-Move Location Code");
                                 IF ProdOrderCompG.FINDFIRST THEN
                                   ERROR('Du kan ikke bruke denne funksjonen n†r komponentene har Lokasjonskode %1',OPCSetup."OPC-Move Location Code");
                                 //011<-
                                 //bygger opp filter for hva som skal synes i "OPC-Move components"
                                 CLEAR(ProdOrderCompG);
                                 ProdOrderCompG.SETRANGE(Status, Status);
                                 ProdOrderCompG.SETRANGE("Prod. Order No.", "Prod. Order No.");
                                 PAGE.RUNMODAL(PAGE::"OPC - Move components", ProdOrderCompG);
                                 CLEAR(ProdOrderCompG); //hhe: for † l›se opp i filter som skapte feilmelding p† "Stykkliste"-knapp
                               END;
                                }
      { 1000000008;1 ;Action    ;
                      Name=Prod. Order Rtng. Comment;
                      CaptionML=[ENU=Comments;
                                 NOR=Merknader];
                      RunObject=Page 99000840;
                      RunPageLink=Status=FIELD(Status),
                                  Prod. Order No.=FIELD(Prod. Order No.),
                                  Routing Reference No.=FIELD(Routing Reference No.),
                                  Routing No.=FIELD(Routing No.),
                                  Operation No.=FIELD(Operation No.);
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Comment;
                      PromotedCategory=Process }
      { 1000000004;1 ;Action    ;
                      Name=Relationship;
                      CaptionML=NOR=&Tilknyttet dokument;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Relationship;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 HYPERLINK("Dokument Link");
                               END;
                                }
      { 1000000005;1 ;Action    ;
                      Name=Stykkliste;
                      CaptionML=[ENU=BOM List;
                                 NOR=Stykkliste];
                      RunObject=Page 83004;
                      RunPageView=WHERE(Status=FILTER(Released),
                                        Prod. Order Line No.=CONST(10000));
                      RunPageLink=Prod. Order No.=FIELD(Prod. Order No.);
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=BOM;
                      PromotedCategory=Process;
                      RunPageMode=View }
      { 1000000006;1 ;Action    ;
                      Name=Start/Stop Time;
                      CaptionML=[ENU=Start/Stop Time;
                                 NOR=Start/stopp tid];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Start;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 OPCOppsett@1000000006 : Record 83001;
                                 RunTimesL@1000000005 : Record 83010;
                                 RunTimesNewL@1101103001 : Record 83010;
                                 "--Kommentertbort--"@1000000004 : Integer;
                                 ProdOrdreLinje@1000000003 : Record 5406;
                                 Vare@1000000002 : Record 27;
                                 FerdigmeldAntall@1000000001 : Decimal;
                                 FerdigMeldKladdLinje@1000000000 : Record 83;
                                 Mach_on_Op@1101103000 : Page 83008;
                                 EntryNoL@1101103002 : Integer;
                               BEGIN
                                 //sjekker om maskinen allerede er innlogget p† operasjonen->
                                 IF RunTimesNewL.FINDLAST THEN
                                   EntryNoL :=  RunTimesNewL."Entry No." + 1
                                 ELSE
                                   EntryNoL := 1;

                                 RunTimesNewL.RESET;
                                 RunTimesNewL.SETRANGE("Prod. Order No.", Rec."Prod. Order No.");
                                 RunTimesNewL.SETRANGE("Operation No.", Rec."Operation No.");
                                 RunTimesNewL.SETRANGE("Machine Center", "No.");
                                 RunTimesNewL.SETRANGE("Ending Date", 0D);
                                 IF NOT RunTimesNewL.FINDFIRST THEN BEGIN
                                   //Set value for Machine Center it does not exists.
                                   RunTimesNewL.INIT;
                                   RunTimesNewL."Entry No." := EntryNoL;
                                   RunTimesNewL.VALIDATE("Prod. Order No.", Rec."Prod. Order No.");
                                   RunTimesNewL.VALIDATE("Routing No.", Rec."Routing No.");
                                   RunTimesNewL.VALIDATE("Operation No.", Rec."Operation No.");
                                   RunTimesNewL.VALIDATE("Machine Center", Rec."No.");
                                   RunTimesNewL.INSERT(TRUE);
                                   COMMIT;
                                 END;

                                 RunTimesL.SETRANGE("Prod. Order No.",  "Prod. Order No.");
                                 RunTimesL.SETRANGE("Routing No.",  "Routing No.");
                                 RunTimesL.SETRANGE("Operation No.",  "Operation No.");
                                 RunTimesL.SETFILTER("Ending Date", '=%1', 0D);
                                 RunTimesL.SETFILTER("Ending Time", '=%1', 0T);

                                 CLEAR(Mach_on_Op);
                                 Mach_on_Op.InitForm("No.", '');
                                 Mach_on_Op.SETTABLEVIEW(RunTimesL);
                                 Mach_on_Op.RUNMODAL;
                               END;
                                }
      { 1000000007;1 ;Action    ;
                      Name=PostOutputItem;
                      CaptionML=[ENU=Post Output;
                                 NOR=Ferdigmeld];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=ReleaseShipment;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 ClockingMgtG.PostOutputItem(Rec);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                Editable=FALSE;
                GroupType=Repeater }

    { 10  ;2   ;Field     ;
                SourceExpr="Starting Date" }

    { 16  ;2   ;Field     ;
                SourceExpr="Prod. Order No." }

    { 2   ;2   ;Field     ;
                CaptionML=[ENU=Operation No.;
                           NOR=Op.nr.];
                SourceExpr="Operation No." }

    { 1000000000;2;Field  ;
                CaptionML=NOR=Varenr.;
                SourceExpr=VareNr }

    { 1000000002;2;Field  ;
                CaptionML=NOR=Varebeskr.;
                SourceExpr=VareBesk }

    { 6   ;2   ;Field     ;
                CaptionML=[ENU=Description;
                           NOR=Operasj.beskr.];
                SourceExpr=Description }

    { 1101103001;2;Field  ;
                Name=Warning;
                CaptionML=[ENU=Warning;
                           NOR=Varsel];
                SourceExpr=OPCSetupG."Warning Picture";
                Editable=false }

    { 1000000013;2;Field  ;
                CaptionML=[ENU=Ordred qty.;
                           NOR=Ordreantall];
                DecimalPlaces=0:0;
                SourceExpr=OrgQty }

    { 18  ;2   ;Field     ;
                CaptionML=[ENU=Planned qty;
                           NOR=Planlagt];
                SourceExpr="Input Quantity";
                Visible=FALSE }

    { 22  ;2   ;Field     ;
                CaptionML=[ENU=Finished Quantity;
                           NOR=Ferdig];
                DecimalPlaces=0:2;
                SourceExpr="Finished Qty" }

    { 1000000015;2;Field  ;
                CaptionML=[ENU=Remaining Qty;
                           NOR=Restantall];
                DecimalPlaces=0:0;
                SourceExpr=RemQty;
                Style=Standard;
                StyleExpr=TRUE }

    { 1101103003;2;Field  ;
                CaptionML=[ENU=Expected Capacity Need;
                           NOR=Forventet kapasitetsbehov];
                SourceExpr=ExpectedCapacityNeedG }

    { 1101103002;2;Field  ;
                SourceExpr="Expected Capacity Need";
                Visible=false }

    { 26  ;2   ;Field     ;
                DecimalPlaces=0:2;
                SourceExpr="Actual Run Time" }

    { 24  ;2   ;Field     ;
                SourceExpr="Dokument Link" }

  }
  CODE
  {
    VAR
      ProdOrderLineG@1000000000 : Record 5406;
      ItemG@1000000001 : Record 27;
      ProdOrderComponentG@1101103002 : Record 5407;
      ProdOrderCompG@1101103001 : Record 5407;
      OPCSetupG@1101103003 : Record 83001;
      ClockingMgtG@1101103000 : Codeunit 83001;
      VareBesk@1000000002 : Text[50];
      VareNr@1000000003 : Text[50];
      WarningIndex@1000000015 : Integer;
      ItemInventory@1000000017 : Decimal;
      Item@1000000018 : Record 27;
      OrgQty@1000000020 : Decimal;
      RemQty@1000000021 : Decimal;
      ExpectedCapacityNeedG@1101103004 : Decimal;

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01 15.12.05  ASL Tar med vrakantall + vrakkode fra ferdigmelding
      02 15.12.05  HHE Fjernet kolonnen "Arb.senter", Forkortet til "Op.nr."
                            Frm:Insert/delete/modify = No
                            Satt kolonnen "Startdato" fremst
                            Knapp= Stykkliste->sl†r opp i ny BESKYTTET frm (ikke som f›r = std. stk.l. p† p.o.)
                            Ny knapp = Merknader (tekst fra stamrute->p.o.rute->OPC)
      03 01.03.06  HHE Overf›rer Lokasjonskoden fra Prod.o.linjen til f.meld.kladden
      04 05.05.06  HHE Byttet ut kode p† "Tilknyttet dokument"
      05 19.05.06  HHE Kode for auto.innlegg av maskin
      06 30.01.07  HHE Routing StatusFILTER<>Finished
      07 28.06.07  HHE Knapp=Stykkliste ->Properties=RunFormView:WHERE(Status=FILTER(Released),Prod. Order Line No.=CONST(10000))
      08 30.04.08  HEI Vrakkode 2 og 3. Henter fra FromFerdigMeld, og bokf›rer hvis de har verdi
      09 06.02.09  BVM Fremvist operasjonstid og nytt felt for Antall, endret ledetekst p† planlagtantall til restantall
      10 17.08.10  HHE Ny knapp: Flytt komponenter
      11 19.08.10  HHE Sjekker om Lokasjonskode p† komponenter er ULIK OPC-flytt-lokasjon i OPC Setup
      12 19.08.10  HHE Sjekker om det er tillatt † flytte komponenter via denne Prod.ressurs
    }
    END.
  }
}

OBJECT Page 83003 OPC - melding p† info.sentral
{
  OBJECT-PROPERTIES
  {
    Date=20.04.17;
    Time=16.20.12;
    Modified=Yes;
    Version List=OPC2.0;
  }
  PROPERTIES
  {
    SourceTable=Table83002;
    PageType=CardPart;
    TimerUpdate=60000;
    RefreshOnActivate=Yes;
    OnClosePage=BEGIN
                  IF CurrPage.EDITABLE THEN
                    Rec.MODIFYALL("Last Modified", CURRENTDATETIME);
                END;

    OnInsertRecord=BEGIN
                     Rec."Entry No." := Rec.GetNextEntryNo() ;
                   END;

  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1101103001;1;Group  ;
                GroupType=Group }

    { 1101103002;2;Field  ;
                Name=PingPong;
                ControlAddIn=[Microsoft.Dynamics.Nav.Client.PingPong;PublicKeyToken=31bf3856ad364e35] }

    { 1101103000;1;Group  ;
                GroupType=Repeater }

    { 1000000003;2;Field  ;
                SourceExpr=Description }

  }
  CODE
  {

    PROCEDURE UpdatePage@1101103000();
    VAR
      OPCInformationMessageL@1101103000 : Record 83002;
    BEGIN
      IF OPCInformationMessageL.FINDLAST THEN
        IF Rec."Last Modified" <> OPCInformationMessageL."Last Modified" THEN
          CurrPage.ACTIVATE(TRUE);
    END;

    EVENT PingPong@-1101103002::AddInReady@2();
    BEGIN
      CurrPage.PingPong.Ping(10000);
    END;

    EVENT PingPong@-1101103002::Pong@3();
    BEGIN
      IF NOT CurrPage.EDITABLE THEN
        UpdatePage();

      CurrPage.PingPong.Ping(10000);
    END;

    BEGIN
    {
      +--------------------------------------------------+
      | SI-Data                                          |
      +--------------------------------------------------+
      Nr. Dato      Id   Beskrivelse
      01. 23.03.06  HHE  Endret timer fra 5 sek. til 60 sek
      02. 15.12.06  HHE  Lagt til tekstlinje 11-15
    }
    END.
  }
}

OBJECT Page 83004 OPC - Prod.Order Comp. Line Li
{
  OBJECT-PROPERTIES
  {
    Date=16.12.16;
    Time=15.30.54;
    Modified=Yes;
    Version List=OPC4.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Prod. Order Comp. Line List;
               NOR=P.o-komponentlinje - oversikt];
    SourceTable=Table5407;
    PageType=List;
    OnAfterGetRecord=BEGIN
                       ShowShortcutDimCode(ShortcutDimCode);
                       //hhe 18.05.06->
                       ItemInventoryG := 0;
                       GetItemInventory();
                       //hhe 18.05.06<-
                     END;

    OnNewRecord=BEGIN
                  CLEAR(ShortcutDimCode);
                  ItemInventoryG := 0;
                END;

    OnInsertRecord=BEGIN
                     //hhe 28.06.07->
                     OnBeforeInsertRecord();
                     "Line No." := LineNoG;
                     //hhe 28.06.07<-
                   END;

    OnAfterGetCurrRecord=BEGIN
                           GetItemInventory();
                         END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 12      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Line;
                                 NOR=&Linje];
                      Visible=FALSE }
      { 6500    ;2   ;Action    ;
                      CaptionML=[ENU=Item &Tracking Lines;
                                 NOR=Vare&sporingslinjer];
                      Image=ItemTrackingLines;
                      OnAction=BEGIN
                                 OpenItemTrackingLines;
                               END;
                                }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000000;1 ;Action    ;
                      CaptionML=NOR=Skriv ut;
                      Promoted=Yes;
                      Image=Report;
                      PromotedCategory=Report;
                      OnAction=BEGIN
                                 PO_nr := Rec."Prod. Order No.";
                                 ProdOrdre.SETRANGE(Status,Status::Released);
                                 ProdOrdre.SETRANGE("No.",PO_nr);
                                 REPORT.RUN(REPORT::"Prod. Order - Mat. Requisition",TRUE,FALSE,ProdOrdre);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 8   ;2   ;Field     ;
                SourceExpr="Item No." }

    { 53  ;2   ;Field     ;
                SourceExpr="Variant Code";
                Visible=FALSE }

    { 51  ;2   ;Field     ;
                SourceExpr=Description }

    { 1000000001;2;Field  ;
                CaptionML=[ENU=Inventory;
                           NOR=Beholdning];
                DecimalPlaces=0:2;
                SourceExpr=ItemInventoryG;
                Editable=FALSE;
                Style=Standard;
                StyleExpr=TRUE }

    { 14  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 1 Code";
                Visible=FALSE }

    { 16  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 2 Code";
                Visible=FALSE }

    { 300 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[3];
                CaptionClass='1,2,3';
                Visible=FALSE;
                OnLookup=BEGIN
                           LookupShortcutDimCode(3,ShortcutDimCode[3]);
                         END;
                          }

    { 302 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[4];
                CaptionClass='1,2,4';
                Visible=FALSE;
                OnLookup=BEGIN
                           LookupShortcutDimCode(4,ShortcutDimCode[4]);
                         END;
                          }

    { 304 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[5];
                CaptionClass='1,2,5';
                Visible=FALSE;
                OnLookup=BEGIN
                           LookupShortcutDimCode(5,ShortcutDimCode[5]);
                         END;
                          }

    { 306 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[6];
                CaptionClass='1,2,6';
                Visible=FALSE;
                OnLookup=BEGIN
                           LookupShortcutDimCode(6,ShortcutDimCode[6]);
                         END;
                          }

    { 308 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[7];
                CaptionClass='1,2,7';
                Visible=FALSE;
                OnLookup=BEGIN
                           LookupShortcutDimCode(7,ShortcutDimCode[7]);
                         END;
                          }

    { 310 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[8];
                CaptionClass='1,2,8';
                Visible=FALSE;
                OnLookup=BEGIN
                           LookupShortcutDimCode(8,ShortcutDimCode[8]);
                         END;
                          }

    { 10  ;2   ;Field     ;
                SourceExpr="Location Code";
                Visible=TRUE }

    { 55  ;2   ;Field     ;
                SourceExpr="Quantity per" }

    { 57  ;2   ;Field     ;
                SourceExpr="Expected Quantity" }

    { 59  ;2   ;Field     ;
                SourceExpr="Remaining Quantity" }

    { 1000000008;2;Field  ;
                SourceExpr="Routing Link Code" }

    { 1000000003;2;Field  ;
                SourceExpr="Flushing Method" }

    { 46  ;2   ;Field     ;
                SourceExpr="Due Date" }

    { 61  ;2   ;Field     ;
                SourceExpr="Unit Cost";
                Visible=FALSE }

    { 44  ;2   ;Field     ;
                SourceExpr="Cost Amount";
                Visible=FALSE }

    { 20  ;2   ;Field     ;
                SourceExpr=Position;
                Visible=FALSE }

    { 22  ;2   ;Field     ;
                SourceExpr="Position 2";
                Visible=FALSE }

    { 24  ;2   ;Field     ;
                SourceExpr="Position 3";
                Visible=FALSE }

    { 63  ;2   ;Field     ;
                SourceExpr="Lead-Time Offset";
                Visible=FALSE }

  }
  CODE
  {
    VAR
      ShortcutDimCode@1000 : ARRAY [8] OF Code[20];
      "--si-data--"@1000000002 : Boolean;
      ManuPrintReport@1000000000 : Codeunit 99000817;
      ProdOrdreKomponent@1000000001 : Record 5407;
      ProdOrdre@1000000003 : Record 5405;
      PO_nr@1000000004 : Code[10];
      ItemInventoryG@1000000005 : Decimal;
      ItemG@1000000006 : Record 27;
      LineNoG@1101104000 : Integer;

    LOCAL PROCEDURE OnBeforeInsertRecord@19001631();
    VAR
      P_ordre@1101104000 : Record 5405;
    BEGIN
      //hhe 28.06.07->
      ProdOrdreKomponent.RESET;
      ProdOrdreKomponent.SETRANGE(Status,Status::Released);
      ProdOrdreKomponent.SETRANGE("Prod. Order No.","Prod. Order No.");
      ProdOrdreKomponent.SETRANGE("Prod. Order Line No.",10000);
      IF ProdOrdreKomponent.FIND('+') THEN
         LineNoG := ProdOrdreKomponent."Line No." + 10000
      ELSE
         "Line No." := 10000;
      IF P_ordre.GET(Status::Released,"Prod. Order No.") THEN  //17.06.09: lagt inn IF
        "Location Code" := P_ordre."Location Code";
      //hhe 28.06.07<-
    END;

    LOCAL PROCEDURE GetItemInventory@1101103001();
    BEGIN
      IF ItemG.GET("Item No.") THEN BEGIN
        ItemG.SETRANGE("Location Filter", "Location Code");
        ItemG.CALCFIELDS(Inventory);
        ItemInventoryG := ItemG.Inventory;
      END;
    END;

    BEGIN
    {
      14.12.05 hhe Fjernet: "p.o.nr", "status" ++
      30.03.06 hhe Lagt inn knapp for utskrift av "Materialrekv."
      18.05.06 hhe Fremviser Beholdning for den enkelte komponent
      26.06.07 hhe Setter FRM: Editable=False ved †pning
                   Ny knapp=Funksjoner -> Rediger / Skrivebeskytt
                   Properties: har gitt lov til † endre/sette inn/slette
      28.06.07 hhe Mulig † legge til en komponentlinje
      17.06.09 hhe Lagt inn et IF vedr. s›k etter prod.ordre
      17.11.16 JAL Added Init of ItemInventoryG variable
                   Moved calculation of ItemInventory to function
    }
    END.
  }
}

OBJECT Page 83005 OPC Role Center
{
  OBJECT-PROPERTIES
  {
    Date=16.11.16;
    Time=13.06.08;
    Modified=Yes;
    Version List=OPC;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Role Center;
               NOR=Rollesenter];
    PageType=RoleCenter;
    ActionList=ACTIONS
    {
      { 1900000006;0 ;ActionContainer;
                      ActionContainerType=Reports }
      { 107     ;1   ;Action    ;
                      CaptionML=[ENU=Ro&uting Sheet;
                                 NOR=&Ruteark];
                      RunObject=Report 99000787;
                      Image=Report }
      { 109     ;1   ;Separator  }
      { 108     ;1   ;Action    ;
                      CaptionML=[ENU=Inventory - &Availability Plan;
                                 NOR=L&ager - disponeringsoversikt];
                      RunObject=Report 707;
                      Image=ItemAvailability }
      { 110     ;1   ;Action    ;
                      CaptionML=[ENU=&Planning Availability;
                                 NOR=&Disponeringsplanlegging];
                      RunObject=Report 99001048;
                      Image=Report }
      { 13      ;1   ;Action    ;
                      CaptionML=[ENU=&Capacity Task List;
                                 NOR=&Oversikt over kapasitetsoppgaver];
                      RunObject=Report 99000780;
                      Image=Report }
      { 18      ;1   ;Action    ;
                      CaptionML=[ENU=Subcontractor - &Dispatch List;
                                 NOR=&Servicefordeling - underleverand›r];
                      RunObject=Report 99000789;
                      Image=Report }
      { 111     ;1   ;Separator  }
      { 112     ;1   ;Action    ;
                      CaptionML=[ENU=Production Order - &Shortage List;
                                 NOR=&Produksjonsordre - mankoliste];
                      RunObject=Report 99000788;
                      Image=Report }
      { 49      ;1   ;Action    ;
                      CaptionML=[ENU=D&etailed Calculation;
                                 NOR=D&etaljert beregning];
                      RunObject=Report 99000756;
                      Image=Report }
      { 113     ;1   ;Separator  }
      { 114     ;1   ;Action    ;
                      CaptionML=[ENU=P&roduction Order - Calculation;
                                 NOR=Prod&uksjonsordre - beregning];
                      RunObject=Report 99000767;
                      Image=Report }
      { 115     ;1   ;Action    ;
                      CaptionML=[ENU=Sta&tus;
                                 NOR=S&tatus];
                      RunObject=Report 706;
                      Image=Report }
      { 116     ;1   ;Action    ;
                      CaptionML=[ENU=Inventory &Valuation WIP;
                                 NOR=&Lagerverdisetting - VIA];
                      RunObject=Report 5802;
                      Image=Report }
      { 1900000011;0 ;ActionContainer;
                      ActionContainerType=HomeItems }
      { 5       ;1   ;Action    ;
                      CaptionML=[ENU=Simulated Production Orders;
                                 NOR=Simulerte produksjonsordrer];
                      RunObject=Page 9323 }
      { 7       ;1   ;Action    ;
                      CaptionML=[ENU=Planned Production Orders;
                                 NOR=Planlagte produksjonsordrer];
                      RunObject=Page 9324 }
      { 9       ;1   ;Action    ;
                      CaptionML=[ENU=Firm Planned Production Orders;
                                 NOR=Fast planlagte produksjonsordrer];
                      RunObject=Page 9325 }
      { 12      ;1   ;Action    ;
                      CaptionML=[ENU=Released Production Orders;
                                 NOR=Frigitte produksjonsordrer];
                      RunObject=Page 9326 }
      { 10      ;1   ;Action    ;
                      CaptionML=[ENU=Finished Production Orders;
                                 NOR=Ferdige produksjonsordrer];
                      RunObject=Page 9327 }
      { 101     ;1   ;Action    ;
                      CaptionML=[ENU=Production Forecast;
                                 NOR=Produksjonsprognose];
                      RunObject=Page 99000921 }
      { 102     ;1   ;Action    ;
                      CaptionML=[ENU=Blanket Sales Orders;
                                 NOR=Rammeordrer];
                      RunObject=Page 9303 }
      { 14      ;1   ;Action    ;
                      CaptionML=[ENU=Sales Orders;
                                 NOR=Ordrer];
                      RunObject=Page 9305;
                      Visible=TRUE;
                      Image=Order }
      { 103     ;1   ;Action    ;
                      CaptionML=[ENU=Blanket Purchase Orders;
                                 NOR=Rammebestillinger];
                      RunObject=Page 9310 }
      { 6       ;1   ;Action    ;
                      CaptionML=[ENU=Purchase Orders;
                                 NOR=Bestillinger];
                      RunObject=Page 9307 }
      { 106     ;1   ;Action    ;
                      CaptionML=[ENU=Transfer Orders;
                                 NOR=Overf›ringsordrer];
                      RunObject=Page 5742;
                      Image=Document }
      { 3       ;1   ;Action    ;
                      CaptionML=[ENU=Vendors;
                                 NOR=Leverand›rer];
                      RunObject=Page 27;
                      Image=Vendor }
      { 17      ;1   ;Action    ;
                      Name=Items;
                      CaptionML=[ENU=Items;
                                 NOR=Varer];
                      RunObject=Page 31;
                      Image=Item }
      { 11      ;1   ;Action    ;
                      Name=ItemsProduced;
                      CaptionML=[ENU=Produced;
                                 NOR=Produsert];
                      RunObject=Page 31;
                      RunPageView=WHERE(Replenishment System=CONST(Prod. Order)) }
      { 94      ;1   ;Action    ;
                      Name=ItemsRawMaterials;
                      CaptionML=[ENU=Raw Materials;
                                 NOR=R†varer];
                      RunObject=Page 31;
                      RunPageView=WHERE(Low-Level Code=FILTER(>0),
                                        Replenishment System=CONST(Purchase),
                                        Production BOM No.=FILTER(='')) }
      { 95      ;1   ;Action    ;
                      CaptionML=[ENU=Stockkeeping Units;
                                 NOR=Lagerf›ringsenheter];
                      RunObject=Page 5701;
                      Image=SKU }
      { 16      ;1   ;Action    ;
                      Name=ProductionBOMs;
                      CaptionML=[ENU=Production BOMs;
                                 NOR=Produksjonsstykklister];
                      RunObject=Page 99000787 }
      { 63      ;1   ;Action    ;
                      Name=ProductionBOMsCertified;
                      CaptionML=[ENU=Certified;
                                 NOR=Sertifisert];
                      RunObject=Page 99000787;
                      RunPageView=WHERE(Status=CONST(Certified)) }
      { 83      ;1   ;Action    ;
                      CaptionML=[ENU=Routings;
                                 NOR=Ruter];
                      RunObject=Page 99000764 }
      { 1900000012;0 ;ActionContainer;
                      ActionContainerType=ActivityButtons }
      { 19      ;1   ;ActionGroup;
                      CaptionML=[ENU=Journals;
                                 NOR=Kladder];
                      Image=Journals }
      { 22      ;2   ;Action    ;
                      Name=ItemJournals;
                      CaptionML=[ENU=Item Journals;
                                 NOR=Varekladder];
                      RunObject=Page 262;
                      RunPageView=WHERE(Template Type=CONST(Item),
                                        Recurring=CONST(No)) }
      { 23      ;2   ;Action    ;
                      Name=ItemReclassificationJournals;
                      CaptionML=[ENU=Item Reclassification Journals;
                                 NOR=Varereklassifiseringskladder];
                      RunObject=Page 262;
                      RunPageView=WHERE(Template Type=CONST(Transfer),
                                        Recurring=CONST(No)) }
      { 24      ;2   ;Action    ;
                      Name=RevaluationJournals;
                      CaptionML=[ENU=Revaluation Journals;
                                 NOR=Revalueringskladder];
                      RunObject=Page 262;
                      RunPageView=WHERE(Template Type=CONST(Revaluation),
                                        Recurring=CONST(No)) }
      { 20      ;1   ;ActionGroup;
                      CaptionML=[ENU=Worksheets;
                                 NOR=Forslag];
                      Image=Worksheets }
      { 33      ;2   ;Action    ;
                      Name=PlanningWorksheets;
                      CaptionML=[ENU=Planning Worksheets;
                                 NOR=Planleggingsforslag];
                      RunObject=Page 295;
                      RunPageView=WHERE(Template Type=CONST(Planning),
                                        Recurring=CONST(No)) }
      { 32      ;2   ;Action    ;
                      Name=RequisitionWorksheets;
                      CaptionML=[ENU=Requisition Worksheets;
                                 NOR=Bestillingsforslag];
                      RunObject=Page 295;
                      RunPageView=WHERE(Template Type=CONST(Req.),
                                        Recurring=CONST(No)) }
      { 34      ;2   ;Action    ;
                      Name=SubcontractingWorksheets;
                      CaptionML=[ENU=Subcontracting Worksheets;
                                 NOR=Underleveranseforslag];
                      RunObject=Page 295;
                      RunPageView=WHERE(Template Type=CONST(For. Labor),
                                        Recurring=CONST(No)) }
      { 35      ;2   ;Action    ;
                      CaptionML=[ENU=Standard Cost Worksheet;
                                 NOR=Standardkost - forslag];
                      RunObject=Page 5840 }
      { 2       ;1   ;ActionGroup;
                      CaptionML=[ENU=Product Design;
                                 NOR=Produktdesign];
                      Image=ProductDesign }
      { 15      ;2   ;Action    ;
                      Name=ProductionBOM;
                      CaptionML=[ENU=Production BOM;
                                 NOR=Produksjonsstykkliste];
                      RunObject=Page 99000787;
                      Image=BOM }
      { 25      ;2   ;Action    ;
                      Name=ProductionBOMCertified;
                      CaptionML=[ENU=Certified;
                                 NOR=Sertifisert];
                      RunObject=Page 99000787;
                      RunPageView=WHERE(Status=CONST(Certified)) }
      { 26      ;2   ;Action    ;
                      CaptionML=[ENU=Routings;
                                 NOR=Ruter];
                      RunObject=Page 99000764 }
      { 27      ;2   ;Action    ;
                      CaptionML=[ENU=Routing Links;
                                 NOR=Rutekoblinger];
                      RunObject=Page 99000798 }
      { 28      ;2   ;Action    ;
                      CaptionML=[ENU=Standard Tasks;
                                 NOR=Standardoppgaver];
                      RunObject=Page 99000799 }
      { 29      ;2   ;Action    ;
                      CaptionML=[ENU=Families;
                                 NOR=Familier];
                      RunObject=Page 99000791 }
      { 30      ;2   ;Action    ;
                      Name=ProdDesign_Items;
                      CaptionML=[ENU=Items;
                                 NOR=Varer];
                      RunObject=Page 31;
                      Image=Item }
      { 31      ;2   ;Action    ;
                      Name=ProdDesign_ItemsProduced;
                      CaptionML=[ENU=Produced;
                                 NOR=Produsert];
                      RunObject=Page 31;
                      RunPageView=WHERE(Replenishment System=CONST(Prod. Order)) }
      { 36      ;2   ;Action    ;
                      Name=ProdDesign_ItemsRawMaterials;
                      CaptionML=[ENU=Raw Materials;
                                 NOR=R†varer];
                      RunObject=Page 31;
                      RunPageView=WHERE(Low-Level Code=FILTER(>0),
                                        Replenishment System=CONST(Purchase)) }
      { 37      ;2   ;Action    ;
                      CaptionML=[ENU=Stockkeeping Units;
                                 NOR=Lagerf›ringsenheter];
                      RunObject=Page 5701;
                      Image=SKU }
      { 38      ;1   ;ActionGroup;
                      CaptionML=[ENU=Capacities;
                                 NOR=Kapasiteter];
                      Image=Capacities }
      { 39      ;2   ;Action    ;
                      Name=WorkCenters;
                      CaptionML=[ENU=Work Centers;
                                 NOR=Arbeidssentre];
                      RunObject=Page 99000755 }
      { 40      ;2   ;Action    ;
                      Name=WorkCentersInternal;
                      CaptionML=[ENU=Internal;
                                 NOR=Internt];
                      RunObject=Page 99000755;
                      RunPageView=WHERE(Subcontractor No.=FILTER(=''));
                      Image=Comment }
      { 41      ;2   ;Action    ;
                      Name=WorkCentersSubcontracted;
                      CaptionML=[ENU=Subcontracted;
                                 NOR=Underleveranse];
                      RunObject=Page 99000755;
                      RunPageView=WHERE(Subcontractor No.=FILTER(<>'')) }
      { 42      ;2   ;Action    ;
                      CaptionML=[ENU=Machine Centers;
                                 NOR=Produksjonsressurser];
                      RunObject=Page 99000761 }
      { 43      ;2   ;Action    ;
                      CaptionML=[ENU=Registered Absence;
                                 NOR=Registrert frav‘r];
                      RunObject=Page 99000920 }
      { 44      ;2   ;Action    ;
                      CaptionML=[ENU=Vendors;
                                 NOR=Leverand›rer];
                      RunObject=Page 27;
                      Image=Vendor }
      { 1       ;0   ;ActionContainer;
                      ActionContainerType=NewDocumentItems }
      { 53      ;1   ;Action    ;
                      CaptionML=[ENU=&Item;
                                 NOR=V&are];
                      RunObject=Page 30;
                      Promoted=No;
                      Image=Item;
                      PromotedCategory=Process;
                      RunPageMode=Create }
      { 52      ;1   ;Action    ;
                      CaptionML=[ENU=Production &Order;
                                 NOR=&Produksjonsordre];
                      RunObject=Page 99000813;
                      Promoted=No;
                      Image=Order;
                      PromotedCategory=Process;
                      RunPageMode=Create }
      { 51      ;1   ;Action    ;
                      CaptionML=[ENU=Production &BOM;
                                 NOR=Produksjonsst&ykkliste];
                      RunObject=Page 99000786;
                      Promoted=No;
                      Image=BOM;
                      PromotedCategory=Process;
                      RunPageMode=Create }
      { 50      ;1   ;Action    ;
                      CaptionML=[ENU=&Routing;
                                 NOR=&Ruteoversikt];
                      RunObject=Page 99000766;
                      Promoted=No;
                      Image=Route;
                      PromotedCategory=Process;
                      RunPageMode=Create }
      { 21      ;1   ;Action    ;
                      CaptionML=[ENU=&Purchase Order;
                                 NOR=&Bestilling];
                      RunObject=Page 50;
                      Promoted=No;
                      Image=Document;
                      PromotedCategory=Process;
                      RunPageMode=Create }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1101103000;1 ;Action    ;
                      Name=OPC - Information board;
                      RunObject=Page 83001;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Production;
                      PromotedCategory=Process }
      { 1101103001;1 ;Action    ;
                      Name=Requirement Overview - Week Plan;
                      CaptionML=[ENU=Requirement Overview - Week Plan;
                                 NOR=Behovsoversikt - Ukeplan];
                      RunObject=Page 50029;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Recalculate;
                      PromotedCategory=Process }
      { 1101103002;1 ;Action    ;
                      Name=Requirement Overview;
                      CaptionML=[ENU=Requirement Overview;
                                 NOR=Behovsoversikt];
                      RunObject=Page 50010;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Recalculate;
                      PromotedCategory=Process }
      { 67      ;1   ;Separator ;
                      CaptionML=[ENU=Tasks;
                                 NOR=Oppgaver];
                      IsHeader=Yes }
      { 46      ;1   ;Action    ;
                      CaptionML=[ENU=Item &Journal;
                                 NOR=&Varekladd];
                      RunObject=Page 40;
                      Image=Journals }
      { 47      ;1   ;Action    ;
                      CaptionML=[ENU=Re&quisition Worksheet;
                                 NOR=Best&illingsforslag];
                      RunObject=Page 291;
                      Image=Worksheet }
      { 48      ;1   ;Action    ;
                      CaptionML=[ENU=Planning Works&heet;
                                 NOR=P&lanleggingsforslag];
                      RunObject=Page 99000852;
                      Image=PlanningWorksheet }
      { 4       ;1   ;Action    ;
                      CaptionML=[ENU=Item Availability by Timeline;
                                 NOR=Disponibelt per tidslinje];
                      RunObject=Page 5540;
                      Image=Timeline }
      { 8       ;1   ;Action    ;
                      CaptionML=[ENU=Subcontracting &Worksheet;
                                 NOR=Un&derleveranseforslag];
                      RunObject=Page 99000886;
                      Image=SubcontractingWorksheet }
      { 45      ;1   ;Separator  }
      { 122     ;1   ;Action    ;
                      CaptionML=[ENU=Change Pro&duction Order Status;
                                 NOR=&Endre produksjonsordrestatus];
                      RunObject=Page 99000914;
                      Image=ChangeStatus }
      { 123     ;1   ;Action    ;
                      CaptionML=[ENU=Order Pla&nning;
                                 NOR=&Ordreplanlegging];
                      RunObject=Page 5522;
                      Image=Planning }
      { 84      ;1   ;Separator ;
                      CaptionML=[ENU=Administration;
                                 NOR=Administrasjon];
                      IsHeader=Yes }
      { 124     ;1   ;Action    ;
                      CaptionML=[ENU=Order Promising S&etup;
                                 NOR=Oppse&tt for ordrebekreftelse];
                      RunObject=Page 99000958;
                      Image=OrderPromisingSetup }
      { 125     ;1   ;Action    ;
                      CaptionML=[ENU=&Manufacturing Setup;
                                 NOR=P&roduksjonsoppsett];
                      RunObject=Page 99000768;
                      Image=ProductionSetup }
      { 89      ;1   ;Separator ;
                      CaptionML=[ENU=History;
                                 NOR=Historikk];
                      IsHeader=Yes }
      { 126     ;1   ;Action    ;
                      CaptionML=[ENU=Item &Tracing;
                                 NOR=Vare&sporing];
                      RunObject=Page 6520;
                      Image=ItemTracing }
      { 90      ;1   ;Action    ;
                      CaptionML=[ENU=Navi&gate;
                                 NOR=&Naviger];
                      RunObject=Page 344;
                      Image=Navigate }
    }
  }
  CONTROLS
  {
    { 1900000008;0;Container;
                ContainerType=RoleCenterArea }

    { 1900724808;1;Group   }

    { 1905113808;2;Part   ;
                PagePartID=Page83006;
                PartType=Page }

    { 1000000001;2;Part   ;
                Name=OPC - melding p† info.sentral;
                PagePartID=Page83003;
                UpdatePropagation=Both }

    { 1900724708;1;Group  ;
                Visible=false }

    { 54  ;2   ;Part      ;
                PagePartID=Page675;
                Visible=false;
                PartType=Page }

    { 1905989608;2;Part   ;
                PagePartID=Page9152;
                PartType=Page }

    { 55  ;2   ;Part      ;
                PagePartID=Page681;
                PartType=Page }

    { 1903012608;2;Part   ;
                PagePartID=Page9175;
                PartType=Page }

    { 1901377608;2;Part   ;
                PartType=System;
                SystemPartID=MyNotes }

  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Page 83006 OPC Activities
{
  OBJECT-PROPERTIES
  {
    Date=20.04.17;
    Time=16.20.12;
    Modified=Yes;
    Version List=OPC;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Activities;
               NOR=Aktiviteter];
    SourceTable=Table83013;
    PageType=CardPart;
    OnOpenPage=BEGIN
                 RESET;
                 IF NOT GET THEN BEGIN
                   INIT;
                   INSERT;
                 END;

                 //SETRANGE("User ID Filter", USERID);
               END;

  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 2   ;1   ;Group     ;
                CaptionML=[ENU=OPC;
                           NOR=OPC];
                GroupType=CueGroup;
                ActionList=ACTIONS
                {
                  { 21      ;0   ;Action    ;
                                  CaptionML=[ENU=Change Production Order Status;
                                             NOR=Endre produksjonsordrestatus];
                                  RunObject=Page 99000914;
                                  Image=ChangeStatus }
                  { 12      ;0   ;Action    ;
                                  CaptionML=[ENU=New Production Order;
                                             NOR=Ny produksjonsordre];
                                  RunObject=Page 99000813;
                                  RunPageMode=Create }
                  { 28      ;0   ;Action    ;
                                  CaptionML=[ENU=Navigate;
                                             NOR=Naviger];
                                  RunObject=Page 344;
                                  Image=Navigate }
                  { 1101103001;  ;Action    ;
                                  Name=OPC - Information board;
                                  CaptionML=[ENU=OPC - Information board;
                                             NOR=OPC - informasjonssentral];
                                  RunObject=Page 83001;
                                  Promoted=Yes;
                                  PromotedIsBig=Yes;
                                  Image=Production;
                                  PromotedCategory=Process }
                }
                 }

    { 1   ;2   ;Field     ;
                SourceExpr="Resource Status";
                DrillDownPageID=OPC - ressursstatus }

    { 5   ;2   ;Field     ;
                SourceExpr="Production Order- Released";
                DrillDownPageID=Released Production Orders }

    { 1101103000;2;Field  ;
                SourceExpr="Firm planned tasks";
                DrillDownPageID=OPC - Firm planned tasks }

  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Page 83008 Machine Center on Operation
{
  OBJECT-PROPERTIES
  {
    Date=20.04.17;
    Time=16.20.12;
    Modified=Yes;
    Version List=OPC2.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Machine Center on Operation;
               NOR=Prod.ress. p† operasjonen];
    SourceTable=Table83010;
    DataCaptionFields=Description;
    PageType=Card;
    OnAfterGetRecord=BEGIN
                       //rsi/hhe 20.04.06->
                       GetItemInfo();
                       //rsi/hhe 20.04.06<-
                     END;

    OnInsertRecord=VAR
                     recOperasjonstider@1000000001 : Record 83010;
                   BEGIN
                     IF recOperasjonstider.FINDLAST THEN
                       "Entry No." := recOperasjonstider."Entry No." + 1
                     ELSE
                       "Entry No." := 1;
                     IF MachineCenterNoG <> '' THEN    // 002 ASL 29.03.06
                       "Work done at M.C." := MachineCenterNoG; // 002 ASL 29.03.06

                     //hhe 19.05.06->
                     //dersom det legges inn en ressurs p† en oppgave som ikke er Indir.prod.
                     // IF (NoneProducingTimeCodeG = '') THEN BEGIN
                     //  //sjekker om maskinen allerede er innlogget p† operasjonen->
                     //  RunTimesG.RESET;
                     //  RunTimesG.SETRANGE("Prod. Order No.", Rec."Prod. Order No.");
                     //  RunTimesG.SETRANGE("Operation No.", Rec."Operation No.");
                     //  RunTimesG.SETRANGE("Machine Center", MachineCenterNoG);
                     //  RunTimesG.SETRANGE("Ending Date", 0D);
                     //  IF NOT RunTimesG.FINDFIRST THEN BEGIN
                     //    //Set value for Machine Center it does not exists.
                     //    RunTimesG.INIT;
                     //    RunTimesG."Entry No." := Rec."Entry No.";
                     //    RunTimesG.VALIDATE("Prod. Order No.", Rec."Prod. Order No.");
                     //    RunTimesG.VALIDATE("Routing No.", Rec."Routing No.");
                     //    RunTimesG.VALIDATE("Operation No.", Rec."Operation No.");
                     //    RunTimesG.VALIDATE("Machine Center", MachineCenterNoG);
                     //    RunTimesG.INSERT(TRUE);
                     //    Rec."Entry No." := Rec."Entry No." + 1;
                     //    CurrPage.UPDATE(FALSE);
                     //  END;
                     // END;
                     //hhe 19.05.06<-
                   END;

    OnQueryClosePage=BEGIN
                       //010 BVM-->
                       ClockingMgtG.DeleteBlankRunTimes(Rec);
                       //010 BVM--<
                     END;

    OnAfterGetCurrRecord=BEGIN
                           OutPutQtyG := OutPutQtyG;
                           ScrapQtyG := ScrapQtyG;
                           ScrapQty2G := ScrapQty2G;
                           ScrapQty3G := ScrapQty3G;
                           ScrapCodeG := ScrapCodeG;
                           ScrapCode2G := ScrapCode2G;
                           ScrapCode3G := ScrapCode3G;
                           ScrapCommentG := ScrapCommentG;
                           ScrapComment2G := ScrapComment2G;
                           ScrapComment3G := ScrapComment3G;
                           OpDescriptionG := OpDescriptionG;
                           MachineNameG := MachineCenterG.Name;
                           ProdOrderNoG := ProdOrderNoG;
                           ItemNoG := ItemNoG;
                           ItemDescriptionG := ItemDescriptionG;
                         END;

    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000001;1 ;Action    ;
                      Name=RegisterTimeInJournal;
                      CaptionML=[ENU=Register;
                                 NOR=Registrer];
                      Promoted=Yes;
                      Image=Register;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 recOperasjonstider@1000000004 : Record 83010;
                                 OPCOppsett@1000000003 : Record 83001;
                                 ProdOrdreLinje@1000000002 : Record 5406;
                                 Vare@1000000001 : Record 27;
                                 FerdigMeldKladdLinje@1000000000 : Record 83;
                                 StemplTid@1000000006 : Record 83009;
                                 ProdO_ruteLinje@1000000007 : Record 5409;
                               BEGIN
                                 ClockingMgtG.RegisterTimeInJournal(Rec, OutPutQtyG, ScrapQtyG, ScrapCodeG,
                                                                    ScrapQty2G, ScrapCode2G, ScrapQty3G, ScrapCode3G,
                                                                    ScrapCommentG, ScrapComment2G, ScrapComment3G);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1101103000;1;Group  ;
                GroupType=Group }

    { 1101104016;2;Field  ;
                CaptionML=[ENU=Machine Center;
                           NOR=Produksjonsressurs];
                SourceExpr=MachineNameG;
                Enabled=FALSE;
                Editable=FALSE }

    { 1101104001;2;Field  ;
                CaptionML=[ENU=Prod. Order No.;
                           NOR=Prod.ordrenr.];
                SourceExpr=ProdOrderNoG;
                Enabled=FALSE;
                Editable=FALSE }

    { 1101104003;2;Field  ;
                CaptionML=[ENU=Item No.;
                           NOR=Varenr.];
                SourceExpr=ItemNoG;
                Enabled=FALSE;
                Editable=FALSE }

    { 1101104005;2;Field  ;
                CaptionML=[ENU=Description;
                           NOR=Varebeskrivelse];
                SourceExpr=ItemDescriptionG;
                Enabled=FALSE;
                Editable=FALSE }

    { 1101104013;2;Field  ;
                CaptionML=[ENU=Operation Description;
                           NOR=Operasjonsbeskrivelse];
                SourceExpr=OpDescriptionG;
                Enabled=FALSE;
                Editable=FALSE;
                Style=Standard;
                StyleExpr=TRUE }

    { 1101104007;2;Field  ;
                Name=FerdigMeld;
                CaptionML=[ENU=Output Quantity;
                           NOR=Ferdigmeld antall];
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=OutPutQtyG;
                Style=Standard;
                StyleExpr=TRUE;
                OnValidate=BEGIN
                             CheckQuantity();
                           END;
                            }

    { 1101104008;2;Field  ;
                Name=VrakAntall;
                CaptionML=[ENU=Scrap Quantity;
                           NOR=Vraket antall];
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=ScrapQtyG;
                OnValidate=BEGIN
                             CheckQuantity();
                           END;
                            }

    { 1101104009;2;Field  ;
                Name=Vrakkode;
                CaptionML=[ENU=Scrap Code;
                           NOR=Vrakkode];
                SourceExpr=ScrapCodeG;
                OnLookup=VAR
                           Scrap@1000000000 : Record 99000762;
                           ScrapCodes@1101103001 : Page 99000780;
                         BEGIN
                           Scrap.RESET;
                           CLEAR(Scrap);
                           ScrapCodes.SETTABLEVIEW(Scrap);
                           ScrapCodes.LOOKUPMODE(TRUE);
                           IF ScrapCodes.RUNMODAL = ACTION::LookupOK THEN BEGIN
                             ScrapCodes.GETRECORD(Scrap);
                             ScrapCodeG := Scrap.Code;
                           END;
                         END;
                          }

    { 1000000012;2;Field  ;
                Name=ScrapComment;
                CaptionML=[ENU=Scrap Code;
                           NOR=Kommentar til Vrakkode];
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=ScrapCommentG }

    { 1000000000;2;Field  ;
                Name=VrakAntall 2;
                CaptionML=[ENU=Scrap Quantity;
                           NOR=Vraket ant. (type 2)];
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=ScrapQty2G;
                Visible=false;
                OnValidate=BEGIN
                             CheckQuantity();
                           END;
                            }

    { 1000000004;2;Field  ;
                Name=Vrakkode2;
                CaptionML=[ENU=Scrap Code;
                           NOR=Vrakkode(type2)];
                SourceExpr=ScrapCode2G;
                Visible=false;
                OnLookup=VAR
                           Scrap@1000000000 : Record 99000762;
                           ScrapCodes@1101103001 : Page 99000780;
                         BEGIN
                           //hhe 12.10.07->
                           Scrap.RESET;
                           CLEAR(Scrap);
                           ScrapCodes.SETTABLEVIEW(Scrap);
                           ScrapCodes.LOOKUPMODE(TRUE);
                           IF ScrapCodes.RUNMODAL = ACTION::LookupOK THEN BEGIN
                             ScrapCodes.GETRECORD(Scrap);
                             ScrapCode2G := Scrap.Code;
                           END;
                           //hhe 12.10.07<-
                         END;
                          }

    { 1000000013;2;Field  ;
                Name=ScrapComment2;
                CaptionML=[ENU=Scrap Code;
                           NOR=Kommentar til Vrakkode(type2)];
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=ScrapComment2G;
                Visible=false }

    { 1000000007;2;Field  ;
                Name=VrakAntall 3;
                CaptionML=[ENU=Scrap Quantity;
                           NOR=Vraket ant. (type 3)];
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=ScrapQty3G;
                Visible=false;
                OnValidate=BEGIN
                             CheckQuantity();
                           END;
                            }

    { 1000000006;2;Field  ;
                Name=Vrakkode3;
                CaptionML=[ENU=Scrap Code;
                           NOR=Vrakkode(type3)];
                SourceExpr=ScrapCode3G;
                Visible=false;
                OnLookup=VAR
                           Scrap@1000000000 : Record 99000762;
                           ScrapCodes@1101103001 : Page 99000780;
                         BEGIN
                           //hhe 12.10.07->
                           Scrap.RESET;
                           CLEAR(Scrap);
                           ScrapCodes.SETTABLEVIEW(Scrap);
                           ScrapCodes.LOOKUPMODE(TRUE);
                           IF ScrapCodes.RUNMODAL = ACTION::LookupOK THEN BEGIN
                             ScrapCodes.GETRECORD(Scrap);
                             ScrapCode3G := Scrap.Code;
                           END;
                           //hhe 12.10.07<-
                         END;
                          }

    { 1000000014;2;Field  ;
                Name=ScrapComment3;
                CaptionML=[ENU=Scrap Code;
                           NOR=Kommentar til Vrakkode(type3)];
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=ScrapComment3G;
                Visible=false }

    { 1   ;1   ;Group     ;
                Editable=TRUE;
                GroupType=Repeater }

    { 10  ;2   ;Field     ;
                SourceExpr="Machine Center";
                OnValidate=BEGIN
                             MachineCenterOnAfterValidate;
                           END;
                            }

    { 12  ;2   ;Field     ;
                SourceExpr=Description;
                Editable=FALSE }

    { 1000000015;2;Field  ;
                SourceExpr="Stop Code" }

    { 14  ;2   ;Field     ;
                SourceExpr="Starting Date" }

    { 16  ;2   ;Field     ;
                SourceExpr="Starting Time" }

    { 18  ;2   ;Field     ;
                SourceExpr="Ending Date";
                Editable=FALSE }

    { 20  ;2   ;Field     ;
                SourceExpr="Ending Time";
                Editable=FALSE }

    { 22  ;2   ;Field     ;
                SourceExpr="Finish Now" }

  }
  CODE
  {
    VAR
      ClockingMgtG@1101103000 : Codeunit 83001;
      MachineCenterG@1101103002 : Record 99000758;
      RunTimesG@1101103001 : Record 83010;
      MachineCenterNoG@1000000000 : Code[20];
      ProdOrderNoG@1101103004 : Code[20];
      NoneProducingTimeCodeG@1000000001 : Code[20];
      TXT001@1000000002 : TextConst 'NOR=Startdato avviker fra dagens. Vil du bruke dagens dato?';
      ItemNoG@1101104000 : Code[20];
      ItemDescriptionG@1101104001 : Text[30];
      OutPutQtyG@1101104002 : Decimal;
      OutputQuantityG@1101103003 : Decimal;
      ScrapQtyG@1101104003 : Decimal;
      ScrapCodeG@1101104004 : Code[20];
      OpDescriptionG@1101104005 : Text[50];
      MachineNameG@1101104006 : Text[30];
      FirstRecOpLineG@1101104008 : Boolean;
      ScrapQty2G@1000000004 : Decimal;
      ScrapCode2G@1000000005 : Code[20];
      ScrapQty3G@1000000006 : Decimal;
      ScrapCode3G@1000000007 : Code[20];
      ScrapCommentG@1000000008 : Text[50];
      ScrapComment2G@1000000009 : Text[50];
      ScrapComment3G@1000000010 : Text[50];
      C_ErrorInQty@1101103005 : TextConst 'ENU=Scrap can only be posted together with output quantity.;NOR=Vrak kan kun bokf›res sammen med ferdigantall.';

    PROCEDURE InitForm@1000000001(MachineNo@1000000000 : Code[20];NoneProdTimeCode@1000000001 : Code[20]);
    BEGIN
      MachineCenterNoG := MachineNo;
      NoneProducingTimeCodeG := NoneProdTimeCode;
      //19.05->
      IF NoneProducingTimeCodeG = '' THEN
        MachineNameG :=  MachineNo;
      //19.05.<-
    END;

    PROCEDURE GetItemInfo@1101104000();
    VAR
      ProdOrdreLine@1101104000 : Record 5406;
      Item@1101104001 : Record 27;
      ProdORouteLine@1101104002 : Record 5409;
    BEGIN
      ProdOrdreLine.RESET;
      ProdOrdreLine.SETRANGE(Status, ProdOrdreLine.Status::Released);
      ProdOrdreLine.SETRANGE("Prod. Order No.", "Prod. Order No.");
      ProdOrdreLine.SETRANGE("Routing No.", "Routing No.");
      IF ProdOrdreLine.FIND('-') THEN BEGIN
        IF Item.GET(ProdOrdreLine."Item No.") THEN BEGIN
          ProdOrdreLine.TESTFIELD("Routing No.");

          ItemNoG := Item."No.";
          ItemDescriptionG := Item.Description;
        END;
      END;

      //hhe 20.04.06->
      ProdORouteLine.RESET;
      ProdORouteLine.SETRANGE(Status, ProdORouteLine.Status::Released);
      ProdORouteLine.SETRANGE("Prod. Order No.", "Prod. Order No.");
      ProdORouteLine.SETRANGE("Routing No.", "Routing No.");
      ProdORouteLine.SETRANGE("Operation No.", "Operation No.");
      IF ProdORouteLine.FIND('-') THEN BEGIN
        OpDescriptionG := ProdORouteLine.Description;
        MachineCenterG.GET(ProdORouteLine."No.");
        MachineNameG := MachineCenterG.Name;
        ProdOrderNoG := "Prod. Order No.";
        END
      ELSE
        OpDescriptionG := '';
      //hhe 20.04.06<-
    END;

    LOCAL PROCEDURE MachineCenterOnAfterValidate@19005651();
    BEGIN
      //012 hhe 26.11.09->
      IF NoneProducingTimeCodeG <>'' THEN
        "Stop Code" := NoneProducingTimeCodeG;
      //012 hhe 26.11.09<-
    END;

    LOCAL PROCEDURE CheckQuantity@1101103000();
    BEGIN
      //Because of limitation of posting scrap in standard NAV
      IF (OutPutQtyG = 0) AND ((ScrapQtyG + ScrapQty2G + ScrapQty3G) <> 0) THEN
          ERROR(C_ErrorInQty);
    END;

    BEGIN
    {
      ----------------------------------------------
      SI-DATA AS

      OPC
      ----------------------------------------------
      No  Date      ID      Description
      ----------------------------------------------
      001 14.12.05  hhe     Fjernet kolonne "Bokf›r"
      002 29.03.06  ASL     Bokf›ring av ikke produktiv tid.
      003 29.03.06  ASL     Satt inn ny Funksjon:InitForm som tar med maskin +
                            kode for ikke produktiv tid.
      004 03.04.06  hhe     Regner Operasjonstid over til timer
      005 20.04.06  hhe     Bokf›rer ferdig- og vrakantall, samt vrakkode n†r operasjonstider bokf›res
      006 18.05.06  hhe     Lagt inn "BlankZero" p† feltene "Ferdig. antall" og "Vrakantall"
      007 28.09.06  hhe     Kode som bokf›rer fradragslinjer dersom pauser/lunch
      008 28.09.07  hhe     Utvidet feltlengde p† global variabel="ScrapCode" fra 10 -> 20 tegn
      009 24.10.07  hhe     Overf›rer kommentaren til vraket ->kapasitetspost (via ItemJrnLine)
      010 09.06.09  BVM     Ekstra sjekk for † rydde opp i evt. blankelinjer som oppst†r (b†de start og sluttdato/tid er blanke)
      011 22.01.10  HHE     Fremvist kolonne "Indirekte tid (kode)"
      012 22.01.10  HHE     Kode som setter riktig kode for Indirekte tid.
    }
    END.
  }
}

OBJECT Page 83009 Registration Card
{
  OBJECT-PROPERTIES
  {
    Date=20.04.17;
    Time=16.20.12;
    Modified=Yes;
    Version List=OPC1.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Registration Card;
               NOR=Stemplingskort];
    SourceTable=Table83009;
    DataCaptionFields=Field1;
    PageType=Card;
    OnAfterGetRecord=BEGIN
                       CLEAR(ProdRess);
                       IF ProdRess.GET(GETFILTER("Machine Center Filter")) THEN
                         NavnProdRess := ProdRess.Name;

                       SETRANGE("Machine Center No.", GETFILTER("Machine Center Filter"));
                       IF NOT FIND('+') THEN
                         INIT;
                     END;

    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 15      ;1   ;Action    ;
                      Name=Registrer;
                      CaptionML=NOR=&Registrer tid;
                      Promoted=Yes;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 SETRANGE("Machine Center No.", GETFILTER("Machine Center Filter"));
                                 //SETRANGE("Ending Time",0T);
                                 IF NOT FIND('+') THEN BEGIN
                                   IF ProdRess.GET(GETFILTER("Machine Center Filter")) THEN BEGIN
                                     INIT;
                                     "Machine Center No." := ProdRess."No.";
                                     Navn := ProdRess.Name;
                                     "Starting Date" := TODAY;
                                     "Starting Time" := TIME;
                                     Workstatus := Workstatus::Registrated;
                                     INSERT;
                                   END
                                   ELSE
                                     ERROR('Fant ikke prod.ressursnr. %1', GETFILTER("Machine Center Filter"));
                                 END ELSE BEGIN
                                   IF ("Starting Date" <> 0D) AND ("Starting Time" <> 0T)
                                     AND ("Ending Date" <> 0D) AND ("Ending Time" <> 0T) THEN BEGIN
                                     IF ProdRess.GET(GETFILTER("Machine Center Filter")) THEN BEGIN
                                       INIT;
                                       "Machine Center No." := ProdRess."No.";
                                       Navn := NavnProdRess;
                                       "Starting Date" := TODAY;
                                       "Starting Time" := TIME;
                                       Workstatus := Workstatus::Registrated;
                                       INSERT;
                                     END
                                     ELSE
                                       MESSAGE('Fant ikke prod.ressursnr. %1', GETFILTER("Machine Center Filter"));
                                   END ELSE IF ("Starting Date" <> 0D) AND ("Starting Time" <> 0T)
                                     AND ("Ending Date" = 0D) AND ("Ending Time" = 0T) THEN BEGIN
                                     "Ending Date" := TODAY;
                                     "Ending Time" := TIME;
                                     Workstatus := Workstatus::Completed;
                                     MODIFY;
                                   END;
                                 END;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group      }

    { 17  ;2   ;Field     ;
                SourceExpr="Machine Center Filter";
                OnValidate=BEGIN
                             MachineCenterFilterOnAfterVali;
                           END;
                            }

    { 4   ;2   ;Field     ;
                CaptionML=NOR=Navn;
                SourceExpr=NavnProdRess;
                Editable=FALSE }

    { 6   ;2   ;Field     ;
                SourceExpr="Starting Date";
                Editable=FALSE }

    { 8   ;2   ;Field     ;
                SourceExpr="Starting Time";
                Editable=FALSE }

    { 10  ;2   ;Field     ;
                SourceExpr="Ending Date";
                Editable=FALSE }

    { 13  ;2   ;Field     ;
                SourceExpr="Ending Time";
                Editable=FALSE }

  }
  CODE
  {
    VAR
      ProdRess@1000000000 : Record 99000758;
      NavnProdRess@1000000001 : Text[30];

    LOCAL PROCEDURE MachineCenterFilterOnAfterVali@19004387();
    BEGIN
      SETRANGE("Machine Center No.", GETFILTER("Machine Center Filter"));

      CLEAR(ProdRess);
      IF ProdRess.GET(GETFILTER("Machine Center Filter")) THEN
        NavnProdRess := ProdRess.Name;
    END;

    BEGIN
    END.
  }
}

OBJECT Page 83010 Output Registration
{
  OBJECT-PROPERTIES
  {
    Date=15.11.16;
    Time=14.18.24;
    Modified=Yes;
    Version List=OPC2.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Output Registration;
               NOR=Ferdigmeld antall];
    PageType=Card;
    OnInit=BEGIN
             CurrPage.LOOKUPMODE := TRUE;
           END;

  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=NOR=Ferdigmeld antall }

    { 4   ;2   ;Field     ;
                CaptionML=NOR=Prodordrenr.;
                SourceExpr=ProdOrdreNr;
                Editable=FALSE }

    { 5   ;2   ;Field     ;
                CaptionML=NOR=Varenr.;
                SourceExpr=VareNr;
                Editable=FALSE }

    { 2   ;2   ;Field     ;
                CaptionML=NOR=Beskrivelse;
                SourceExpr=VareBesk;
                Editable=FALSE }

    { 1101104001;2;Field  ;
                CaptionML=NOR=Operasjonsbeskrivelse;
                SourceExpr=Operasjonsbeskr;
                Editable=FALSE;
                Style=Standard;
                StyleExpr=TRUE }

    { 6   ;2   ;Field     ;
                Name=FerdigMeld;
                CaptionML=NOR=Ferdigmeld antall;
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=FerdigmeldAntall;
                Style=Standard;
                StyleExpr=TRUE;
                OnValidate=BEGIN
                             CheckQuantity();
                           END;
                            }

    { 11  ;2   ;Field     ;
                Name=VrakAntall;
                CaptionML=NOR=Vraket antall;
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=VrakAntall;
                OnValidate=BEGIN
                             CheckQuantity();
                           END;
                            }

    { 13  ;2   ;Field     ;
                Name=Vrakkode;
                CaptionML=NOR=Vrakkode;
                SourceExpr=VrakKode;
                OnLookup=VAR
                           ScrapCode@1000000000 : Record 99000762;
                           ScrapCodes@1101103001 : Page 99000780;
                         BEGIN
                           ScrapCode.RESET;
                           CLEAR(ScrapCodes);
                           ScrapCodes.SETTABLEVIEW(ScrapCode);
                           ScrapCodes.LOOKUPMODE(TRUE);
                           IF ScrapCodes.RUNMODAL = ACTION::LookupOK THEN BEGIN
                             ScrapCodes.GETRECORD(ScrapCode);
                             VrakKode := ScrapCode.Code;
                           END;
                         END;
                          }

    { 1000000001;2;Field  ;
                CaptionML=[ENU=Scrap Code;
                           NOR=Kommentar til Vrakkode];
                SourceExpr=VrakBeskr }

    { 1000000002;2;Field  ;
                Name=VrakAntall 2;
                CaptionML=[ENU=Scrap Quantity;
                           NOR=Vraket ant. (type 2)];
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=VrakAnt2;
                Visible=false;
                OnValidate=BEGIN
                             CheckQuantity();
                           END;
                            }

    { 1000000005;2;Field  ;
                Name=Vrakkode2;
                CaptionML=[ENU=Scrap Code;
                           NOR=Vrakkode(type2)];
                SourceExpr=VrakKode2;
                Visible=false;
                OnLookup=VAR
                           ScrapCode@1000000001 : Record 99000762;
                           ScrapCodes@1101103001 : Page 99000780;
                         BEGIN
                           ScrapCode.RESET;
                           CLEAR(ScrapCodes);
                           ScrapCodes.SETTABLEVIEW(ScrapCode);
                           ScrapCodes.LOOKUPMODE(TRUE);
                           IF ScrapCodes.RUNMODAL = ACTION::LookupOK THEN BEGIN
                             ScrapCodes.GETRECORD(ScrapCode);
                             VrakKode2 := ScrapCode.Code;
                           END;
                         END;
                          }

    { 1000000007;2;Field  ;
                CaptionML=[ENU=Scrap Code;
                           NOR=Kommentar til Vrakkode(type2)];
                SourceExpr=VrakBeskr2;
                Visible=false }

    { 1000000011;2;Field  ;
                CaptionML=[ENU=Scrap Quantity;
                           NOR=Vraket ant. (type 3)];
                DecimalPlaces=0:0;
                BlankZero=Yes;
                SourceExpr=VrakAnt3;
                Visible=false;
                OnValidate=BEGIN
                             CheckQuantity();
                           END;
                            }

    { 1000000012;2;Field  ;
                Name=vrakkode3;
                CaptionML=[ENU=Scrap Code;
                           NOR=Vrakkode(type3)];
                SourceExpr=VrakKode3;
                Visible=false;
                OnLookup=VAR
                           ScrapCode@1000000001 : Record 99000762;
                           ScrapCodes@1101103001 : Page 99000780;
                         BEGIN
                           ScrapCode.RESET;
                           CLEAR(ScrapCodes);
                           ScrapCodes.SETTABLEVIEW(ScrapCode);
                           ScrapCodes.LOOKUPMODE(TRUE);
                           IF ScrapCodes.RUNMODAL = ACTION::LookupOK THEN BEGIN
                             ScrapCodes.GETRECORD(ScrapCode);
                             VrakKode3 := ScrapCode.Code;
                           END;
                         END;
                          }

    { 1000000013;2;Field  ;
                CaptionML=[ENU=Scrap Code;
                           NOR=Kommentar til Vrakkode(type3)];
                SourceExpr=VrakBeskr3;
                Visible=false }

  }
  CODE
  {
    VAR
      FerdigmeldAntall@1000000000 : Decimal;
      ProdOrdreNr@1000000001 : Code[10];
      VareNr@1000000002 : Code[20];
      VareBesk@1000000003 : Text[30];
      VrakAntall@1000000004 : Decimal;
      VrakKode@1000000005 : Code[20];
      Operasjonsbeskr@1101104000 : Text[50];
      VrakAnt2@1000000006 : Decimal;
      VrakKode2@1000000007 : Code[20];
      VrakBeskr2@1000000008 : Text[50];
      VrakBeskr@1000000009 : Text[50];
      VrakAnt3@1000000010 : Decimal;
      VrakKode3@1000000011 : Code[20];
      VrakBeskr3@1000000012 : Text[50];
      C_ErrorInQty@1101103000 : TextConst 'ENU=Scrap can only be posted together with output quantity.;NOR=Vrak kan kun bokf›res sammen med ferdigantall.';

    PROCEDURE SettTekst@1(ProdOrdreNummer@1000000000 : Code[10];VareNummer@1000000001 : Code[20];VareBeskrivelse@1000000002 : Text[30];Description@1101104000 : Text[50]);
    BEGIN
      ProdOrdreNr := ProdOrdreNummer;
      VareNr := VareNummer;
      VareBesk := VareBeskrivelse;
      //01. hhe 03.04.06->
      Operasjonsbeskr := Description;
      //01. hhe 03.04.06<-
    END;

    PROCEDURE FinnAntall@2() : Decimal;
    BEGIN
      EXIT(FerdigmeldAntall);
    END;

    PROCEDURE VrakAnt@3() : Decimal;
    BEGIN
      EXIT(VrakAntall);
    END;

    PROCEDURE VrakID@4() : Code[20];
    BEGIN
      EXIT(VrakKode);
    END;

    PROCEDURE VrakBeskrivelse@1000000001() : Text[50];
    BEGIN
      //02 HEI->
      EXIT(VrakBeskr);
      //02 HEI<-
    END;

    PROCEDURE VrakAntall2@1000000005() : Decimal;
    BEGIN
      //02 HEI->
      EXIT(VrakAnt2);
      //02 HEI<-
    END;

    PROCEDURE VrakID2@1000000008() : Code[20];
    BEGIN
      //02 HEI->
      EXIT(VrakKode2);
      //02 HEI<-
    END;

    PROCEDURE VrakBeskrivelse2@1000000004() : Text[50];
    BEGIN
      //02 HEI->
      EXIT(VrakBeskr2);
      //02 HEI<-
    END;

    PROCEDURE VrakAntall3@1000000000() : Decimal;
    BEGIN
      //02 HEI->
      EXIT(VrakAnt3);
      //02 HEI<-
    END;

    PROCEDURE VrakID3@1000000002() : Code[20];
    BEGIN
      //02 HEI->
      EXIT(VrakKode3);
      //02 HEI<-
    END;

    PROCEDURE VrakBeskrivelse3@1000000003() : Text[50];
    BEGIN
      //02 HEI->
      EXIT(VrakBeskr3);
      //02 HEI<-
    END;

    LOCAL PROCEDURE CheckQuantity@1101103001();
    BEGIN
      //Because of limitation of posting scrap in standard NAV
      IF (FerdigmeldAntall = 0) AND ((VrakAnt + VrakAnt2 + VrakAntall3) <> 0) THEN
          ERROR(C_ErrorInQty);
    END;

    BEGIN
    {
      +---------------------------------------------+
      | SI-Data                                     |
      +---------------------------------------------+
      Nr.  Dato      Id     Beskrivelse
      01.  28.09.07  HHE    Utvidet feltlengde p† Global var.=Vrakkode fra 10->20 tegn
      02.  02.05.08  HEI    Vrakkode 2 og 3. Henter fra FromFerdigMeld, og bokf›rer hvis de har verdi
    }
    END.
  }
}

OBJECT Page 83011 OPC Setup
{
  OBJECT-PROPERTIES
  {
    Date=20.04.17;
    Time=16.20.12;
    Modified=Yes;
    Version List=OPC1.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=OPC Setup;
               NOR=OPC Oppsett];
    SourceTable=Table83001;
    PageType=Card;
    ActionList=ACTIONS
    {
      { 1101103003;  ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1101103004;1 ;ActionGroup }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=ENU=General }

    { 2   ;2   ;Field     ;
                SourceExpr="Output Template Name Qty" }

    { 5   ;2   ;Field     ;
                SourceExpr="Output Jrn Batch Name Qty" }

    { 7   ;2   ;Field     ;
                SourceExpr="Output Batch Name Time" }

    { 9   ;2   ;Field     ;
                SourceExpr="Output Jrn Name Time" }

    { 1000000000;2;Field  ;
                SourceExpr="Document No. Ind.Time" }

    { 1000000002;2;Field  ;
                SourceExpr="Item Reclass. Journal (templ.)" }

    { 1000000004;2;Field  ;
                SourceExpr="Item Reclass. Journal (Name)" }

    { 1000000006;2;Field  ;
                SourceExpr="OPC-Move Location Code" }

    { 1101103000;2;Field  ;
                SourceExpr="Warning Picture" }

    { 1101103008;1;Group  ;
                Name=Error Log Group;
                CaptionML=[ENU=Error Log;
                           NOR=Feillog];
                GroupType=Group }

    { 1101103001;2;Field  ;
                SourceExpr="Item Journal Template Name" }

    { 1101103002;2;Field  ;
                SourceExpr="Item Journal Batch Name" }

    { 1101103007;2;Field  ;
                SourceExpr="Show Error Log Message" }

  }
  CODE
  {

    BEGIN
    {
      ----------------------------------------------
      SI-DATA AS

      OPC
      ----------------------------------------------
      No  Date      ID      Description
      ----------------------------------------------
      001 29.03.06  ASL     Hentet frem felt:"Document No. Ind.Time"
      002 17.08.10  HHE     Nytt felt:"Item Reclass. Journal (templ.)" (brukes i OPC - flytt komponent)
                            Nytt felt:"Item Reclass. Journal (Name)"   (brukes i OPC - flytt komponent)
      003 19.08.10  HHE     Nytt felt: "OPC-flytt fra"
    }
    END.
  }
}

OBJECT Page 83012 Work Type Codes
{
  OBJECT-PROPERTIES
  {
    Date=20.04.17;
    Time=16.20.12;
    Modified=Yes;
    Version List=OPC (RSI);
  }
  PROPERTIES
  {
    CaptionML=[ENU=Work Type Codes;
               NOR=Arbeidstypekoder];
    SourceTable=Table83004;
    PageType=List;
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1117700000;1;Group  ;
                GroupType=Repeater }

    { 1117700001;2;Field  ;
                SourceExpr=Code }

    { 1117700003;2;Field  ;
                SourceExpr=Description }

    { 1101104002;2;Field  ;
                SourceExpr="Time Type" }

    { 1101104000;2;Field  ;
                SourceExpr="Payment Type" }

    { 1000000000;2;Field  ;
                SourceExpr=Absence }

  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Page 83013 Time Register
{
  OBJECT-PROPERTIES
  {
    Date=20.04.17;
    Time=16.20.12;
    Modified=Yes;
    Version List=OPC (RSI);
  }
  PROPERTIES
  {
    CaptionML=NOR=Registrert m›nstret tid;
    SourceTable=Table83007;
    PageType=List;
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1101104000;1;Group  ;
                GroupType=Repeater }

    { 1000000000;2;Field  ;
                SourceExpr="Machine Center" }

    { 1101104017;2;Field  ;
                SourceExpr="Machine Center Name" }

    { 1101104003;2;Field  ;
                SourceExpr="Start Date" }

    { 1101104005;2;Field  ;
                SourceExpr="Start Time" }

    { 1101104007;2;Field  ;
                SourceExpr="End Date" }

    { 1101104009;2;Field  ;
                SourceExpr="End Time" }

    { 1101104011;2;Field  ;
                SourceExpr=Quantity }

    { 1101104013;2;Field  ;
                SourceExpr="Work Type Code" }

    { 1101104015;2;Field  ;
                SourceExpr="Time Type" }

    { 1000000002;2;Field  ;
                SourceExpr=Absence }

  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Page 83014 Holyday
{
  OBJECT-PROPERTIES
  {
    Date=20.04.17;
    Time=16.20.12;
    Modified=Yes;
    Version List=OPC (RSI);
  }
  PROPERTIES
  {
    CaptionML=NOR=Helligdager;
    SourceTable=Table83005;
    PageType=List;
    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000010;1 ;Action    ;
                      CaptionML=[ENU=Copy Fixed;
                                 NOR=Kopier &faste];
                      Promoted=Yes;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CopyFixed();
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000000;1;Group  ;
                GroupType=Repeater }

    { 1000000001;2;Field  ;
                SourceExpr=Date }

    { 1000000003;2;Field  ;
                SourceExpr=Description }

    { 1000000005;2;Field  ;
                SourceExpr=Type }

  }
  CODE
  {

    PROCEDURE CopyFixed@1000000000();
    VAR
      Holidays@1000000000 : Record 83005;
      Holidays2@1000000001 : Record 83005;
      Input@1000000002 : Dialog;
      NewYear@1000000003 : Integer;
    BEGIN
      Input.OPEN('Nytt †r † kopiere faste\' +
        'hellidager til [4 siffer] #1########');
      Input.INPUT(1, NewYear);

      Holidays.RESET;
      Holidays.SETFILTER(Date, '%1..%2', DMY2DATE(1,
        1, DATE2DMY(TODAY, 3)), DMY2DATE(31,
        12, DATE2DMY(TODAY, 3)));
      Holidays.SETRANGE(Type, Holidays.Type::Fixed);
      IF Holidays.FIND('-') THEN
        REPEAT

          Holidays2.INIT;
          Holidays2.Date := DMY2DATE( DATE2DMY(Holidays.Date, 1),
            DATE2DMY(Holidays.Date, 2), NewYear);
          Holidays2.Description := Holidays.Description;
          Holidays2.Type := Holidays.Type;
          Holidays2.INSERT;

        UNTIL Holidays.NEXT = 0;
    END;

    BEGIN
    END.
  }
}

OBJECT Page 83015 Time Register Card
{
  OBJECT-PROPERTIES
  {
    Date=20.04.17;
    Time=15.46.31;
    Modified=Yes;
    Version List=OPC (RSI);
  }
  PROPERTIES
  {
    CaptionML=NOR=M›nstringskort;
    SourceTable=Table99000758;
    SourceTableView=SORTING(No.)
                    ORDER(Ascending)
                    WHERE(Clocking=CONST(Yes));
    PageType=Card;
    OnOpenPage=BEGIN
                 SETRANGE("Date Filter", WORKDATE);
               END;

    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000009;1 ;Action    ;
                      Name=Register Time;
                      CaptionML=[ENU=&Register Time;
                                 NOR=&Registrer tid];
                      Promoted=Yes;
                      Image=Register;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 ClockingMgt.RUN(Rec);
                               END;
                                }
      { 1101103000;1 ;Action    ;
                      Name=Absence;
                      CaptionML=[ENU=A&bsence;
                                 NOR=Fr&av‘r];
                      Promoted=Yes;
                      Image=WorkCenterAbsence;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 CalendarAbsenceEntry@1000000000 : Record 99000760;
                               BEGIN
                                  CalendarAbsenceEntry.RESET;
                                  CalendarAbsenceEntry.SETRANGE("Capacity Type", CalendarAbsenceEntry."Capacity Type"::"Machine Center");
                                  CalendarAbsenceEntry.SETRANGE("No.", "No.");
                                  CalendarAbsenceEntry.SETFILTER(Date, GETFILTER("Date Filter"));
                                  PAGE.RUNMODAL(PAGE::"Capacity Absence", CalendarAbsenceEntry);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000000;1;Group  ;
                CaptionML=NOR=Generelt }

    { 1000000005;2;Field  ;
                SourceExpr="No.";
                Editable=FALSE }

    { 1000000003;2;Field  ;
                SourceExpr=Name;
                Editable=FALSE }

    { 1000000007;2;Field  ;
                SourceExpr="Date Filter" }

    { 1000000002;1;Part   ;
                Name=Time Register Subform;
                SubPageLink=Machine Center=FIELD(No.),
                            Start Date=FIELD(Date Filter);
                PagePartID=Page83016 }

  }
  CODE
  {
    VAR
      ClockingMgt@1000000000 : Codeunit 83001;

    BEGIN
    END.
  }
}

OBJECT Page 83016 Time Register Subform
{
  OBJECT-PROPERTIES
  {
    Date=20.04.17;
    Time=16.20.12;
    Modified=Yes;
    Version List=OPC (RSI);
  }
  PROPERTIES
  {
    Editable=No;
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=No;
    SourceTable=Table83007;
    PageType=ListPart;
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000000;1;Group  ;
                GroupType=Repeater }

    { 1000000001;2;Field  ;
                SourceExpr="Start Date" }

    { 1000000003;2;Field  ;
                SourceExpr="Start Time" }

    { 1000000005;2;Field  ;
                SourceExpr="End Date" }

    { 1000000007;2;Field  ;
                SourceExpr="End Time" }

    { 1000000009;2;Field  ;
                SourceExpr=Quantity }

    { 1000000011;2;Field  ;
                SourceExpr="Work Type Code" }

    { 1000000013;2;Field  ;
                SourceExpr=Absence }

  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Page 83017 Time Register List
{
  OBJECT-PROPERTIES
  {
    Date=20.04.17;
    Time=15.46.42;
    Modified=Yes;
    Version List=OPC (RSI);
  }
  PROPERTIES
  {
    CaptionML=[ENU=Time Register List;
               NOR=M›nstringsliste];
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=No;
    SourceTable=Table99000758;
    SourceTableView=WHERE(Clocking=CONST(Yes));
    PageType=List;
    CardPageID=Time Register Card;
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000000;1;Group  ;
                Editable=FALSE;
                GroupType=Repeater }

    { 1000000001;2;Field  ;
                SourceExpr="No." }

    { 1000000003;2;Field  ;
                SourceExpr=Name }

  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Page 83018 Time Registered
{
  OBJECT-PROPERTIES
  {
    Date=20.04.17;
    Time=16.20.12;
    Modified=Yes;
    Version List=OPC (RSI);
  }
  PROPERTIES
  {
    CaptionML=NOR=Registrert m›nstringstid;
    SourceTable=Table83007;
    PageType=List;
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000000;1;Group  ;
                GroupType=Repeater }

    { 1000000001;2;Field  ;
                SourceExpr="Machine Center" }

    { 1000000003;2;Field  ;
                SourceExpr="Start Date" }

    { 1000000005;2;Field  ;
                SourceExpr="Start Time" }

    { 1000000007;2;Field  ;
                SourceExpr="End Date" }

    { 1000000009;2;Field  ;
                SourceExpr="End Time" }

    { 1000000011;2;Field  ;
                SourceExpr=Quantity }

    { 1000000013;2;Field  ;
                SourceExpr="Work Type Code" }

    { 1000000015;2;Field  ;
                SourceExpr="Time Type" }

    { 1000000017;2;Field  ;
                SourceExpr="Machine Center Name" }

  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Page 83019 Work time
{
  OBJECT-PROPERTIES
  {
    Date=20.04.17;
    Time=16.20.12;
    Modified=Yes;
    Version List=OPC (RSI);
  }
  PROPERTIES
  {
    CaptionML=NOR=Arbeidstid;
    SourceTable=Table83003;
    PageType=List;
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000000;1;Group  ;
                GroupType=Repeater }

    { 1000000001;2;Field  ;
                SourceExpr=Code }

    { 1000000003;2;Field  ;
                SourceExpr="Day Type" }

    { 1000000005;2;Field  ;
                SourceExpr=Description }

    { 1000000007;2;Field  ;
                SourceExpr="Time Type" }

    { 1000000009;2;Field  ;
                SourceExpr="From Time" }

    { 1000000011;2;Field  ;
                SourceExpr="To Time" }

    { 1000000013;2;Field  ;
                SourceExpr=Duration }

  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Page 83020 OPC - ressursstatus
{
  OBJECT-PROPERTIES
  {
    Date=20.04.17;
    Time=16.20.12;
    Modified=Yes;
    Version List=OPC3.10;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Direct Prod. Work;
               NOR=OPC - ressursstatus];
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=No;
    SourceTable=Table83010;
    SourceTableView=SORTING(Entry No.,Prod. Order No.,Routing No.,Operation No.,Machine Center)
                    ORDER(Ascending)
                    WHERE(Ending Date=FILTER(''),
                          Machine Center=FILTER(<>''),
                          Starting Date=FILTER(>01.01.00));
    PageType=List;
    TimerUpdate=5000;
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000000;1;Field  ;
                CaptionClass=Text19071011;
                Style=Strong;
                StyleExpr=TRUE }

    { 1   ;1   ;Group     ;
                Editable=FALSE;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                SourceExpr="Machine Center" }

    { 4   ;2   ;Field     ;
                SourceExpr=Description }

    { 1000000002;2;Field  ;
                SourceExpr="Stop Code" }

    { 1000000001;2;Field  ;
                SourceExpr="Prod. Order No.";
                OnLookup=VAR
                           ProdOrder@1101110000 : Record 5405;
                         BEGIN
                           //02.->
                           ProdOrder.SETRANGE(Status,ProdOrder.Status::Released);
                           ProdOrder.SETRANGE("No.","Prod. Order No.");
                           PAGE.RUNMODAL(PAGE::"Production Order List",ProdOrder);
                           //02.<-
                         END;
                          }

    { 8   ;2   ;Field     ;
                SourceExpr="Operation No." }

    { 10  ;2   ;Field     ;
                CaptionML=[ENU=Starting Date;
                           NOR=Startdato];
                SourceExpr="Starting Date" }

    { 12  ;2   ;Field     ;
                CaptionML=[ENU=Starting Time;
                           NOR=Starttid];
                SourceExpr="Starting Time" }

    { 1000000004;2;Field  ;
                CaptionML=NOR=P†logget ved prod.ress;
                SourceExpr="Work done at M.C." }

  }
  CODE
  {
    VAR
      Text19071011@19015358 : TextConst 'NOR=P†logget operasjon';

    BEGIN
    {
      +-------------------------------------------+
      | SI-Data                                   |
      +-------------------------------------------+
      Nr. Dato     Id  Beskrivelse
      01. 14.12.05 HHE Insert/delete/modify = no
                       Fremvist P.o.nr
      02. 24.08.09 HHE Felt "Prod.o.nr." - ved oppslag kommer man direkte inn p† frigitt p.o. (jfr. PTL)
      03. 22.01.10 HHE Fremvist kolonne for "Indirekte tid (kode)"
    }
    END.
  }
}

OBJECT Page 83021 Registrated
{
  OBJECT-PROPERTIES
  {
    Date=20.04.17;
    Time=16.20.12;
    Modified=Yes;
    Version List=OPC1.0;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Registrated;
               NOR=M›nstret];
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=No;
    SourceTable=Table83007;
    SourceTableView=SORTING(Machine Center,Start Date,Start Time)
                    ORDER(Ascending)
                    WHERE(End Date=CONST());
    PageType=List;
    TimerUpdate=5000;
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 1000000001;2;Field  ;
                SourceExpr="Machine Center" }

    { 1000000003;2;Field  ;
                SourceExpr="Machine Center Name" }

    { 1000000005;2;Field  ;
                SourceExpr="Start Date" }

    { 1000000007;2;Field  ;
                SourceExpr="Start Time" }

    { 1000000000;1;Field  ;
                CaptionClass=Text19070213;
                Style=Standard;
                StyleExpr=TRUE }

  }
  CODE
  {
    VAR
      Text19070213@19027263 : TextConst 'NOR=M›nstret';

    BEGIN
    {
      +---------------------------------+
      | SI-Data                         |
      +---------------------------------+
      Nr. Dato     Id  Beskrivelse
      01. 14.12.05 HHE Delete/Insert/Modify = No
    }
    END.
  }
}

OBJECT Page 83022 OPC - Run Times Deduction
{
  OBJECT-PROPERTIES
  {
    Date=20.04.17;
    Time=16.20.12;
    Modified=Yes;
    Version List=OPC1.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=OPC - Run Times Deduction;
               NOR=OPC - Fratrekk i operasjonstid];
    SourceTable=Table83012;
    PageType=List;
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000000;1;Group  ;
                GroupType=Repeater }

    { 1000000001;2;Field  ;
                SourceExpr=Code }

    { 1000000003;2;Field  ;
                SourceExpr=Description }

    { 1000000005;2;Field  ;
                SourceExpr="From Time" }

    { 1000000007;2;Field  ;
                SourceExpr="To Time" }

    { 1000000009;2;Field  ;
                SourceExpr="Deduct Prod.Order" }

  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Page 83023 OPC - Firm planned tasks
{
  OBJECT-PROPERTIES
  {
    Date=20.04.17;
    Time=16.20.12;
    Modified=Yes;
    Version List=OPC1.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=OPC- Firm planned tasks;
               NOR=OPC - Fast planlagte oppgaver];
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=No;
    SourceTable=Table5409;
    SourceTableView=SORTING(Type,No.,Starting Date)
                    ORDER(Ascending)
                    WHERE(Type=FILTER(Machine Center),
                          Routing Status=FILTER(<>Finished));
    DataCaptionFields=No.;
    PageType=List;
    RefreshOnActivate=Yes;
    OnAfterGetRecord=BEGIN
                       CLEAR(WarningIndex);
                       CLEAR(OrgQty);
                       ProdOrdrelinje.SETRANGE(ProdOrdrelinje.Status, ProdOrdrelinje.Status::"Firm Planned"); //hhe 17.06.09: Endret fra Released
                       ProdOrdrelinje.SETRANGE(ProdOrdrelinje."Prod. Order No.", "Prod. Order No.");
                       ProdOrdrelinje.SETRANGE(ProdOrdrelinje."Routing No.", "Routing No.");

                       IF ProdOrdrelinje.FINDFIRST THEN BEGIN
                         //BVM--->
                         OrgQty := ProdOrdrelinje.Quantity;
                         //BVM---<
                         IF Vare.GET(ProdOrdrelinje."Item No.") THEN BEGIN
                           VareNr := Vare."No.";
                           VareBesk := Vare.Description;
                           //SID.OJO ----------->
                           ProdOrdreKomponent.RESET;
                           //02 +
                           //ProdOrdreKomponent.SETRANGE(Status,Status::Released);
                           ProdOrdreKomponent.SETRANGE(Status, Status::"Firm Planned");
                           // 02-
                           ProdOrdreKomponent.SETRANGE("Prod. Order No.", "Prod. Order No.");
                           //hhe
                           ProdOrdreKomponent.SETRANGE("Routing Link Code", "Routing Link Code");
                           //hhe
                           IF ProdOrdreKomponent.FINDFIRST THEN
                             REPEAT
                               CLEAR(ItemInventory);
                               CLEAR(Item);
                               IF Item.GET(ProdOrdreKomponent."Item No.") THEN BEGIN
                                 Item.SETRANGE("Location Filter", ProdOrdreKomponent."Location Code");
                                 Item.CALCFIELDS(Inventory);
                                 ItemInventory := Item.Inventory;
                                 IF (ItemInventory - ProdOrdreKomponent."Remaining Quantity") < 0 THEN
                                   WarningIndex := 1;
                               END;
                             UNTIL ProdOrdreKomponent.NEXT = 0;
                       //<---------- SID.OJO
                         END;
                       END;
                       //BVM -->
                        RemQty := OrgQty - "Finished Qty";
                       //BVM --<
                       IF WarningIndex = 1 THEN BEGIN
                         OPCSetupG.GET;
                         OPCSetupG.CALCFIELDS("Warning Picture");
                       END
                       ELSE
                         OPCSetupG.INIT;
                     END;

    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000008;1 ;Action    ;
                      CaptionML=[ENU=Comments;
                                 NOR=Merknader];
                      RunObject=Page 99000840;
                      RunPageLink=Status=FIELD(Status),
                                  Prod. Order No.=FIELD(Prod. Order No.),
                                  Routing Reference No.=FIELD(Routing Reference No.),
                                  Routing No.=FIELD(Routing No.),
                                  Operation No.=FIELD(Operation No.);
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Comment;
                      PromotedCategory=Process }
      { 1000000004;1 ;Action    ;
                      Name=Related document;
                      CaptionML=[ENU=Related document;
                                 NOR=Tilknyttet dokument];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Relationship;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 //004.->
                                 //TESTFIELD("Dokument Link");
                                 HYPERLINK("Dokument Link");
                                 //SHELL(ENVIRON('windir')+'\'+'Explorer.exe', "Dokument Link");

                                 //004.<-
                               END;
                                }
      { 1000000005;1 ;Action    ;
                      Name=Stykkliste;
                      CaptionML=[ENU=BOM List;
                                 NOR=Stykkliste];
                      RunObject=Page 83004;
                      RunPageView=WHERE(Status=FILTER(Firm Planned),
                                        Prod. Order Line No.=CONST(10000));
                      RunPageLink=Prod. Order No.=FIELD(Prod. Order No.);
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=BOM;
                      PromotedCategory=Process }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                Editable=FALSE;
                GroupType=Repeater }

    { 10  ;2   ;Field     ;
                SourceExpr="Starting Date" }

    { 16  ;2   ;Field     ;
                SourceExpr="Prod. Order No." }

    { 2   ;2   ;Field     ;
                CaptionML=[ENU=Operation No.;
                           NOR=Op.nr.];
                SourceExpr="Operation No." }

    { 1000000000;2;Field  ;
                CaptionML=NOR=Varenr.;
                SourceExpr=VareNr }

    { 1000000002;2;Field  ;
                CaptionML=NOR=Varebeskr.;
                SourceExpr=VareBesk }

    { 6   ;2   ;Field     ;
                CaptionML=[ENU=Description;
                           NOR=Operasj.beskr.];
                SourceExpr=Description }

    { 1101103000;2;Field  ;
                Name=Warning;
                CaptionML=[ENU=Warning;
                           NOR=Varsel];
                SourceExpr=OPCSetupG."Warning Picture";
                Editable=false }

    { 1000000013;2;Field  ;
                CaptionML=[ENU=Ordred qty.;
                           NOR=Ordreantall];
                DecimalPlaces=0:0;
                SourceExpr=OrgQty }

    { 18  ;2   ;Field     ;
                CaptionML=[ENU=Planned qty;
                           NOR=Planlagt];
                SourceExpr="Input Quantity";
                Visible=FALSE }

    { 22  ;2   ;Field     ;
                CaptionML=[ENU=Finished Quantity;
                           NOR=Ferdig];
                DecimalPlaces=0:2;
                SourceExpr="Finished Qty" }

    { 1000000015;2;Field  ;
                CaptionML=[ENU=Remaining Qty;
                           NOR=Restantall];
                DecimalPlaces=0:0;
                SourceExpr=RemQty;
                Style=Standard;
                StyleExpr=TRUE }

    { 1000000011;2;Field  ;
                CaptionML=NOR=Plan ress tid;
                SourceExpr="Expected Capacity Need" }

    { 26  ;2   ;Field     ;
                DecimalPlaces=0:2;
                SourceExpr="Actual Run Time" }

    { 24  ;2   ;Field     ;
                SourceExpr="Dokument Link" }

  }
  CODE
  {
    VAR
      ProdOrdrelinje@1000000000 : Record 5406;
      Vare@1000000001 : Record 27;
      OPCOppsett@1000000004 : Record 83001;
      VareBesk@1000000002 : Text[50];
      VareNr@1000000003 : Text[50];
      FerdigmeldAntall@1000000005 : Decimal;
      FerdigMeldKladdLinje@1000000006 : Record 83;
      tilDok@1000000012 : Record 5409;
      ScrapCode@1000000009 : Code[20];
      "-Si-data-"@1000000010 : Text[30];
      VrakAnt2@1000000019 : Decimal;
      VrakBeskr2@1000000022 : Text[50];
      VrakKode2@1000000023 : Code[20];
      VrakKode@1000000024 : Code[20];
      VrakBeskr@1000000025 : Text[50];
      VrakAnt3@1000000014 : Decimal;
      VrakBeskr3@1000000013 : Text[50];
      VrakKode3@1000000011 : Code[20];
      WarningIndex@1000000015 : Integer;
      ProdOrdreKomponent@1000000016 : Record 5407;
      OPCSetupG@1101103000 : Record 83001;
      ItemInventory@1000000017 : Decimal;
      Item@1000000018 : Record 27;
      OrgQty@1000000020 : Decimal;
      RemQty@1000000021 : Decimal;

    BEGIN
    {
      ----------------------------------------------
      SI-DATA AS

      OPC
      ----------------------------------------------
      No  Date      ID      Description
      ----------------------------------------------
      01. 17.06.09  HHE    Opprettet etter ›nske fra PTL.
                           Basert p† FRM 83001. Fjernet knapper for Tidreg. + Ferdigmelding
                           Filter p† Fast planlagte operasjoner

      02. 13.08.2015 MNO   Fix Change setrange from "Released" -> "Firm Planned"
    }
    END.
  }
}

OBJECT Page 83024 OPC - Released Production Orde
{
  OBJECT-PROPERTIES
  {
    Date=24.08.16;
    Time=18.55.51;
    Modified=Yes;
    Version List=NAVW19.00.00.44365,OPC;
  }
  PROPERTIES
  {
    CaptionML=[ENU=OPC- Released Production Order;
               NOR=OPC - Frigitt produksjonsordre];
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=No;
    SourceTable=Table5405;
    SourceTableView=WHERE(Status=CONST(Released));
    PageType=Document;
    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 49      ;1   ;ActionGroup;
                      CaptionML=[ENU=O&rder;
                                 NOR=&Ordre];
                      Image=Order }
      { 55      ;2   ;ActionGroup;
                      CaptionML=[ENU=E&ntries;
                                 NOR=P&oster];
                      Image=Entries }
      { 66      ;3   ;Action    ;
                      ShortCutKey=Ctrl+F7;
                      CaptionML=[ENU=Item Ledger E&ntries;
                                 NOR=&Vareposter];
                      RunObject=Page 38;
                      RunPageView=SORTING(Order Type,Order No.);
                      RunPageLink=Order Type=CONST(Production),
                                  Order No.=FIELD(No.);
                      Image=ItemLedger }
      { 69      ;3   ;Action    ;
                      CaptionML=[ENU=Capacity Ledger Entries;
                                 NOR=Kapasitetsposter];
                      RunObject=Page 5832;
                      RunPageView=SORTING(Order Type,Order No.);
                      RunPageLink=Order Type=CONST(Production),
                                  Order No.=FIELD(No.);
                      Image=CapacityLedger }
      { 70      ;3   ;Action    ;
                      CaptionML=[ENU=Value Entries;
                                 NOR=Verdiposter];
                      RunObject=Page 5802;
                      RunPageView=SORTING(Order Type,Order No.);
                      RunPageLink=Order Type=CONST(Production),
                                  Order No.=FIELD(No.);
                      Image=ValueLedger }
      { 7300    ;3   ;Action    ;
                      CaptionML=[ENU=&Warehouse Entries;
                                 NOR=&Lagerposter];
                      RunObject=Page 7318;
                      RunPageView=SORTING(Source Type,Source Subtype,Source No.);
                      RunPageLink=Source Type=FILTER(83|5406|5407),
                                  Source Subtype=FILTER(3|4|5),
                                  Source No.=FIELD(No.);
                      Image=BinLedger }
      { 76      ;2   ;Action    ;
                      AccessByPermission=TableData 348=R;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 NOR=Dimensjoner];
                      Image=Dimensions;
                      OnAction=BEGIN
                                 ShowDocDim;
                               END;
                                }
      { 75      ;2   ;Separator  }
      { 90      ;2   ;Action    ;
                      Name=Planning;
                      CaptionML=[ENU=Plannin&g;
                                 NOR=Pla&nlegging];
                      Image=Planning;
                      OnAction=VAR
                                 OrderPlanning@1000 : Page 5522;
                               BEGIN
                                 OrderPlanning.SetProdOrder(Rec);
                                 OrderPlanning.RUNMODAL;
                               END;
                                }
      { 77      ;2   ;Separator  }
      { 78      ;2   ;Action    ;
                      ShortCutKey=F7;
                      CaptionML=[ENU=Statistics;
                                 NOR=Statistikk];
                      RunObject=Page 99000816;
                      RunPageLink=Status=FIELD(Status),
                                  No.=FIELD(No.),
                                  Date Filter=FIELD(Date Filter);
                      Promoted=Yes;
                      Image=Statistics;
                      PromotedCategory=Process }
      { 79      ;2   ;Separator  }
      { 71      ;2   ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 NOR=&Merknader];
                      RunObject=Page 99000838;
                      RunPageLink=Status=FIELD(Status),
                                  Prod. Order No.=FIELD(No.);
                      Image=ViewComments }
      { 7301    ;2   ;Action    ;
                      CaptionML=[ENU=Put-away/Pick Lines/Movement Lines;
                                 NOR=Plassering/plukklinjer/flyttingslinjer];
                      RunObject=Page 5785;
                      RunPageView=SORTING(Source Type,Source Subtype,Source No.,Source Line No.,Source Subline No.,Unit of Measure Code,Action Type,Breakbulk No.,Original Breakbulk);
                      RunPageLink=Source Type=FILTER(5406|5407),
                                  Source Subtype=CONST(3),
                                  Source No.=FIELD(No.);
                      Image=PutawayLines }
      { 7302    ;2   ;Action    ;
                      CaptionML=[ENU=Registered P&ick Lines;
                                 NOR=Registrerte plukkl&injer];
                      RunObject=Page 7364;
                      RunPageView=SORTING(Source Type,Source Subtype,Source No.,Source Line No.,Source Subline No.);
                      RunPageLink=Source Type=CONST(5407),
                                  Source Subtype=CONST(3),
                                  Source No.=FIELD(No.);
                      Image=RegisteredDocs }
      { 7303    ;2   ;Action    ;
                      CaptionML=[ENU=Registered Invt. Movement Lines;
                                 NOR=Registrerte lagerflyttingslinjer];
                      RunObject=Page 7387;
                      RunPageView=SORTING(Source Type,Source Subtype,Source No.,Source Line No.,Source Subline No.);
                      RunPageLink=Source Type=CONST(5407),
                                  Source Subtype=CONST(3),
                                  Source No.=FIELD(No.);
                      Image=RegisteredDocs }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 22      ;1   ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 NOR=F&unksjoner];
                      Image=Action }
      { 24      ;2   ;Action    ;
                      Name=RefreshProductionOrder;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Re&fresh Production Order;
                                 NOR=Opp&dater produksjonsordre];
                      Promoted=Yes;
                      Image=Refresh;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ProdOrder@1001 : Record 5405;
                               BEGIN
                                 ProdOrder.SETRANGE(Status,Status);
                                 ProdOrder.SETRANGE("No.","No.");
                                 REPORT.RUNMODAL(REPORT::"Refresh Production Order",TRUE,TRUE,ProdOrder);
                               END;
                                }
      { 25      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Re&plan;
                                 NOR=&Planlegg p† nytt];
                      Promoted=Yes;
                      Image=Replan;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ProdOrder@1001 : Record 5405;
                               BEGIN
                                 ProdOrder.SETRANGE(Status,Status);
                                 ProdOrder.SETRANGE("No.","No.");
                                 REPORT.RUNMODAL(REPORT::"Replan Production Order",TRUE,TRUE,ProdOrder);
                               END;
                                }
      { 36      ;2   ;Separator  }
      { 53      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Change &Status;
                                 NOR=&Endre status];
                      Promoted=Yes;
                      Image=ChangeStatus;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ProdOrderStatusMgt@1000 : Codeunit 5407;
                               BEGIN
                                 CurrPage.UPDATE;
                                 ProdOrderStatusMgt.RUN(Rec);
                               END;
                                }
      { 57      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=&Update Unit Cost;
                                 NOR=Oppdater en&hetskost];
                      Promoted=Yes;
                      Image=UpdateUnitCost;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ProdOrder@1001 : Record 5405;
                               BEGIN
                                 ProdOrder.SETRANGE(Status,Status);
                                 ProdOrder.SETRANGE("No.","No.");

                                 REPORT.RUNMODAL(REPORT::"Update Unit Cost",TRUE,TRUE,ProdOrder);
                               END;
                                }
      { 58      ;2   ;Separator  }
      { 72      ;2   ;Action    ;
                      CaptionML=[ENU=&Reserve;
                                 NOR=Re&server];
                      Image=Reserve;
                      OnAction=BEGIN
                                 CurrPage.ProdOrderLines.PAGE.PageShowReservation;
                               END;
                                }
      { 73      ;2   ;Action    ;
                      Name=OrderTracking;
                      CaptionML=[ENU=Order &Tracking;
                                 NOR=Ordre&sporing];
                      Image=OrderTracking;
                      OnAction=BEGIN
                                 CurrPage.ProdOrderLines.PAGE.ShowTracking;
                               END;
                                }
      { 23      ;2   ;Separator ;
                      CaptionML=[ENU="";
                                 NOR=""] }
      { 87      ;2   ;Separator  }
      { 74      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=C&opy Prod. Order Document;
                                 NOR=&Kopier prod.ordredokument];
                      Image=CopyDocument;
                      OnAction=BEGIN
                                 CopyProdOrderDoc.SetProdOrder(Rec);
                                 CopyProdOrderDoc.RUNMODAL;
                                 CLEAR(CopyProdOrderDoc);
                               END;
                                }
      { 5       ;1   ;ActionGroup;
                      CaptionML=[ENU=Warehouse;
                                 NOR=Lager];
                      Image=Worksheets }
      { 48      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Create Inventor&y Put-away/Pick/Movement;
                                 NOR=Opprett lagerplas&sering/-plukk/-flytting];
                      Image=CreatePutAway;
                      OnAction=BEGIN
                                 CreateInvtPutAwayPick;
                               END;
                                }
      { 80      ;2   ;Action    ;
                      CaptionML=[ENU=Create I&nbound Whse. Request;
                                 NOR=Opprett i&nng. lagerforesp›rsel];
                      Image=NewToDo;
                      OnAction=VAR
                                 WhseOutputProdRelease@1000 : Codeunit 7325;
                               BEGIN
                                 IF WhseOutputProdRelease.CheckWhseRqst(Rec) THEN
                                   MESSAGE(Text002)
                                 ELSE BEGIN
                                   CLEAR(WhseOutputProdRelease);
                                   IF WhseOutputProdRelease.Release(Rec) THEN
                                     MESSAGE(Text000)
                                   ELSE
                                     MESSAGE(Text001);
                                 END;
                               END;
                                }
      { 62      ;2   ;Action    ;
                      AccessByPermission=TableData 7302=R;
                      CaptionML=[ENU=Create Whse. Pick;
                                 NOR=Opprett plukk];
                      Image=CreateWarehousePick;
                      OnAction=BEGIN
                                 SetHideValidationDialog(FALSE);
                                 CreatePick(USERID,0,FALSE,FALSE,FALSE);
                               END;
                                }
      { 20      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Print;
                                 NOR=&Skriv ut];
                      Image=Print }
      { 21      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Job Card;
                                 NOR=Prosjektkort];
                      Promoted=Yes;
                      Image=Report;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 ManuPrintReport.PrintProductionOrder(Rec,0);
                               END;
                                }
      { 37      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Mat. &Requisition;
                                 NOR=Mate&rialbehov];
                      Promoted=Yes;
                      Image=Report;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 ManuPrintReport.PrintProductionOrder(Rec,1);
                               END;
                                }
      { 46      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Shortage List;
                                 NOR=Mankoliste];
                      Promoted=Yes;
                      Image=Report;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 ManuPrintReport.PrintProductionOrder(Rec,2);
                               END;
                                }
      { 1900000006;0 ;ActionContainer;
                      ActionContainerType=Reports }
      { 1906187306;1 ;Action    ;
                      CaptionML=[ENU=Subcontractor - Dispatch List;
                                 NOR=Servicefordeling - underleverand›r];
                      RunObject=Report 99000789;
                      Promoted=No;
                      Image=Report;
                      PromotedCategory=Report }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=[ENU=General;
                           NOR=Generelt] }

    { 16  ;2   ;Field     ;
                Lookup=No;
                SourceExpr="No.";
                Importance=Promoted;
                OnAssistEdit=BEGIN
                               IF AssistEdit(xRec) THEN
                                 CurrPage.UPDATE;
                             END;
                              }

    { 4   ;2   ;Field     ;
                SourceExpr=Description;
                Importance=Promoted;
                QuickEntry=FALSE }

    { 3   ;2   ;Field     ;
                SourceExpr="Description 2";
                QuickEntry=FALSE }

    { 11  ;2   ;Field     ;
                SourceExpr="Source Type";
                OnValidate=BEGIN
                             IF xRec."Source Type" <> "Source Type" THEN
                               "Source No." := '';
                           END;
                            }

    { 6   ;2   ;Field     ;
                SourceExpr="Source No." }

    { 18  ;2   ;Field     ;
                SourceExpr="Search Description";
                QuickEntry=FALSE }

    { 19  ;2   ;Field     ;
                SourceExpr=Quantity;
                Importance=Promoted }

    { 44  ;2   ;Field     ;
                SourceExpr="Due Date" }

    { 68  ;2   ;Field     ;
                SourceExpr="Assigned User ID";
                QuickEntry=FALSE }

    { 27  ;2   ;Field     ;
                SourceExpr=Blocked;
                QuickEntry=FALSE }

    { 45  ;2   ;Field     ;
                SourceExpr="Last Date Modified";
                QuickEntry=FALSE }

    { 26  ;1   ;Part      ;
                Name=ProdOrderLines;
                SubPageLink=Prod. Order No.=FIELD(No.);
                PagePartID=Page83025 }

    { 1907170701;1;Group  ;
                CaptionML=[ENU=Schedule;
                           NOR=Estimat] }

    { 28  ;2   ;Field     ;
                SourceExpr="Starting Time";
                Importance=Promoted }

    { 30  ;2   ;Field     ;
                SourceExpr="Starting Date";
                Importance=Promoted }

    { 32  ;2   ;Field     ;
                SourceExpr="Ending Time";
                Importance=Promoted }

    { 34  ;2   ;Field     ;
                SourceExpr="Ending Date";
                Importance=Promoted }

    { 1904784501;1;Group  ;
                CaptionML=[ENU=Posting;
                           NOR=Bokf›ring] }

    { 81  ;2   ;Field     ;
                SourceExpr="Inventory Posting Group";
                Importance=Promoted }

    { 83  ;2   ;Field     ;
                SourceExpr="Gen. Prod. Posting Group" }

    { 85  ;2   ;Field     ;
                SourceExpr="Gen. Bus. Posting Group" }

    { 38  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 1 Code";
                OnValidate=BEGIN
                             ShortcutDimension1CodeOnAfterV;
                           END;
                            }

    { 40  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 2 Code";
                OnValidate=BEGIN
                             ShortcutDimension2CodeOnAfterV;
                           END;
                            }

    { 42  ;2   ;Field     ;
                SourceExpr="Location Code";
                Importance=Promoted }

    { 88  ;2   ;Field     ;
                SourceExpr="Bin Code";
                Importance=Promoted }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=TRUE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      CopyProdOrderDoc@1000 : Report 99003802;
      ManuPrintReport@1001 : Codeunit 99000817;
      Text000@1002 : TextConst 'ENU=Inbound Whse. Requests are created.;NOR=Det er opprettet inng†ende lagerforesp›rsler.';
      Text001@1003 : TextConst 'ENU=No Inbound Whse. Request is created.;NOR=Det er ikke opprettet noen inng†ende lagerforesp›rsel.';
      Text002@1004 : TextConst 'ENU=Inbound Whse. Requests have already been created.;NOR=Inng†ende lagerforesp›rsler er allerede opprettet.';

    LOCAL PROCEDURE ShortcutDimension1CodeOnAfterV@19029405();
    BEGIN
      CurrPage.ProdOrderLines.PAGE.UpdateForm(TRUE);
    END;

    LOCAL PROCEDURE ShortcutDimension2CodeOnAfterV@19008725();
    BEGIN
      CurrPage.ProdOrderLines.PAGE.UpdateForm(TRUE);
    END;

    BEGIN
    {
      +---------------------------------------------+
      | SI-Data                                     |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 09.06.16 JAL The page is based on PAG 99000831 "Released Production Order"
    }
    END.
  }
}

OBJECT Page 83025 OPC Released Prod. Order Lines
{
  OBJECT-PROPERTIES
  {
    Date=24.08.16;
    Time=18.55.51;
    Modified=Yes;
    Version List=NAVW19.00.00.44365,OPC;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Lines;
               NOR=Linjer];
    MultipleNewLines=Yes;
    LinksAllowed=No;
    SourceTable=Table5406;
    DelayedInsert=Yes;
    SourceTableView=WHERE(Status=CONST(Released));
    PageType=ListPart;
    AutoSplitKey=Yes;
    OnAfterGetRecord=BEGIN
                       DescriptionIndent := 0;
                       ShowShortcutDimCode(ShortcutDimCode);
                       DescriptionOnFormat;
                     END;

    OnNewRecord=BEGIN
                  CLEAR(ShortcutDimCode);
                END;

    OnDeleteRecord=VAR
                     ReserveProdOrderLine@1000 : Codeunit 99000837;
                   BEGIN
                     COMMIT;
                     IF NOT ReserveProdOrderLine.DeleteLineConfirm(Rec) THEN
                       EXIT(FALSE);
                   END;

    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1906587504;1 ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 NOR=F&unksjoner];
                      Image=Action }
      { 1902759304;2 ;Action    ;
                      Name=Reserve;
                      CaptionML=[ENU=&Reserve;
                                 NOR=Re&server];
                      Image=Reserve;
                      OnAction=BEGIN
                                 PageShowReservation;
                               END;
                                }
      { 1900205704;2 ;Action    ;
                      Name=OrderTracking;
                      CaptionML=[ENU=Order &Tracking;
                                 NOR=&Sporing];
                      Image=OrderTracking;
                      OnAction=BEGIN
                                 ShowTracking;
                               END;
                                }
      { 1907935204;1 ;ActionGroup;
                      CaptionML=[ENU=&Line;
                                 NOR=&Linje];
                      Image=Line }
      { 1901313104;2 ;ActionGroup;
                      CaptionML=[ENU=Item Availability by;
                                 NOR=Disponibelt per];
                      Visible=FALSE;
                      Image=ItemAvailability }
      { 5       ;3   ;Action    ;
                      Name=ItemAvailabilityByEvent;
                      CaptionML=[ENU=Event;
                                 NOR=Hendelse];
                      Image=Event;
                      OnAction=BEGIN
                                 ItemAvailability(ItemAvailFormsMgt.ByEvent);
                               END;
                                }
      { 1901741904;3 ;Action    ;
                      Name=ItemAvailabilityByPeriod;
                      CaptionML=[ENU=Period;
                                 NOR=Periode];
                      Image=Period;
                      OnAction=BEGIN
                                 ItemAvailability(ItemAvailFormsMgt.ByPeriod);
                               END;
                                }
      { 1903866604;3 ;Action    ;
                      Name=ItemAvailabilityByVariant;
                      CaptionML=[ENU=Variant;
                                 NOR=Variant];
                      Image=ItemVariant;
                      OnAction=BEGIN
                                 ItemAvailability(ItemAvailFormsMgt.ByVariant);
                               END;
                                }
      { 1901313004;3 ;Action    ;
                      Name=ItemAvailabilityByLocation;
                      AccessByPermission=TableData 14=R;
                      CaptionML=[ENU=Location;
                                 NOR=Lokasjon];
                      Image=Warehouse;
                      OnAction=BEGIN
                                 ItemAvailability(ItemAvailFormsMgt.ByLocation);
                               END;
                                }
      { 3       ;3   ;Action    ;
                      Name=ItemAvailabilityByBOMLevel;
                      CaptionML=[ENU=BOM Level;
                                 NOR=Stykklisteniv†];
                      Image=BOMLevel;
                      OnAction=BEGIN
                                 ItemAvailability(ItemAvailFormsMgt.ByBOM);
                               END;
                                }
      { 1900205804;2 ;Action    ;
                      Name=ReservationEntries;
                      AccessByPermission=TableData 27=R;
                      CaptionML=[ENU=Reservation Entries;
                                 NOR=Reservasjonsposter];
                      Visible=FALSE;
                      Image=ReservationLedger;
                      OnAction=BEGIN
                                 ShowReservation;
                               END;
                                }
      { 1901288104;2 ;Action    ;
                      Name=Dimensions;
                      AccessByPermission=TableData 348=R;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 NOR=Dimensjoner];
                      Visible=FALSE;
                      Image=Dimensions;
                      OnAction=BEGIN
                                 ShowDimensions;
                               END;
                                }
      { 1903098604;2 ;Action    ;
                      Name=Routing;
                      CaptionML=[ENU=Ro&uting;
                                 NOR=R&ute];
                      Image=Route;
                      OnAction=BEGIN
                                 ShowRouting;
                               END;
                                }
      { 1901991404;2 ;Action    ;
                      Name=Components;
                      CaptionML=[ENU=Components;
                                 NOR=Komponenter];
                      Image=Components;
                      OnAction=BEGIN
                                 ShowComponents;
                               END;
                                }
      { 1905987604;2 ;Action    ;
                      Name=ItemTrackingLines;
                      ShortCutKey=Shift+Ctrl+I;
                      CaptionML=[ENU=Item &Tracking Lines;
                                 NOR=Vare&sporingslinjer];
                      Visible=FALSE;
                      Image=ItemTrackingLines;
                      OnAction=BEGIN
                                 OpenItemTrackingLines;
                               END;
                                }
      { 1902760704;2 ;Action    ;
                      Name=ProductionJournal;
                      CaptionML=[ENU=&Production Journal;
                                 NOR=&Produksjonskladd];
                      Image=Journal;
                      OnAction=BEGIN
                                 ShowProductionJournal;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                IndentationColumnName=DescriptionIndent;
                IndentationControls=Description;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                SourceExpr="Item No." }

    { 4   ;2   ;Field     ;
                SourceExpr="Variant Code";
                Visible=FALSE }

    { 8   ;2   ;Field     ;
                SourceExpr="Due Date" }

    { 50  ;2   ;Field     ;
                SourceExpr="Planning Flexibility";
                Visible=FALSE }

    { 6   ;2   ;Field     ;
                SourceExpr=Description }

    { 10  ;2   ;Field     ;
                SourceExpr="Description 2";
                Visible=FALSE }

    { 46  ;2   ;Field     ;
                SourceExpr="Production BOM No.";
                Visible=FALSE }

    { 44  ;2   ;Field     ;
                SourceExpr="Routing No.";
                Visible=FALSE }

    { 42  ;2   ;Field     ;
                SourceExpr="Routing Version Code";
                Visible=FALSE }

    { 38  ;2   ;Field     ;
                SourceExpr="Production BOM Version Code";
                Visible=FALSE }

    { 24  ;2   ;Field     ;
                SourceExpr="Location Code";
                Visible=FALSE }

    { 26  ;2   ;Field     ;
                SourceExpr="Bin Code";
                Visible=FALSE }

    { 54  ;2   ;Field     ;
                SourceExpr="Starting Date-Time" }

    { 16  ;2   ;Field     ;
                SourceExpr="Starting Time";
                Visible=FALSE }

    { 14  ;2   ;Field     ;
                SourceExpr="Starting Date";
                Visible=FALSE }

    { 56  ;2   ;Field     ;
                SourceExpr="Ending Date-Time" }

    { 20  ;2   ;Field     ;
                SourceExpr="Ending Time";
                Visible=FALSE }

    { 18  ;2   ;Field     ;
                SourceExpr="Ending Date";
                Visible=FALSE }

    { 40  ;2   ;Field     ;
                SourceExpr="Scrap %";
                Visible=FALSE }

    { 28  ;2   ;Field     ;
                SourceExpr=Quantity }

    { 52  ;2   ;Field     ;
                SourceExpr="Reserved Quantity";
                Visible=FALSE }

    { 48  ;2   ;Field     ;
                SourceExpr="Unit of Measure Code" }

    { 30  ;2   ;Field     ;
                SourceExpr="Finished Quantity" }

    { 32  ;2   ;Field     ;
                SourceExpr="Remaining Quantity" }

    { 34  ;2   ;Field     ;
                SourceExpr="Unit Cost" }

    { 36  ;2   ;Field     ;
                SourceExpr="Cost Amount" }

    { 12  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 1 Code";
                Visible=FALSE }

    { 22  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 2 Code";
                Visible=FALSE }

    { 300 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[3];
                CaptionClass='1,2,3';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(3),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(3,ShortcutDimCode[3]);
                           END;
                            }

    { 302 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[4];
                CaptionClass='1,2,4';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(4),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(4,ShortcutDimCode[4]);
                           END;
                            }

    { 304 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[5];
                CaptionClass='1,2,5';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(5),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(5,ShortcutDimCode[5]);
                           END;
                            }

    { 306 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[6];
                CaptionClass='1,2,6';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(6),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(6,ShortcutDimCode[6]);
                           END;
                            }

    { 308 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[7];
                CaptionClass='1,2,7';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(7),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(7,ShortcutDimCode[7]);
                           END;
                            }

    { 310 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[8];
                CaptionClass='1,2,8';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(8),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(8,ShortcutDimCode[8]);
                           END;
                            }

  }
  CODE
  {
    VAR
      ItemAvailFormsMgt@1000 : Codeunit 353;
      ShortcutDimCode@1001 : ARRAY [8] OF Code[20];
      DescriptionIndent@19057867 : Integer INDATASET;

    LOCAL PROCEDURE ShowComponents@1();
    VAR
      ProdOrderComp@1000 : Record 5407;
    BEGIN
      ProdOrderComp.SETRANGE(Status,Status);
      ProdOrderComp.SETRANGE("Prod. Order No.","Prod. Order No.");
      ProdOrderComp.SETRANGE("Prod. Order Line No.","Line No.");

      PAGE.RUN(PAGE::"Prod. Order Components",ProdOrderComp);
    END;

    PROCEDURE ShowTracking@4();
    VAR
      TrackingForm@1000 : Page 99000822;
    BEGIN
      TrackingForm.SetProdOrderLine(Rec);
      TrackingForm.RUNMODAL;
    END;

    LOCAL PROCEDURE ItemAvailability@8(AvailabilityType@1000 : Option);
    BEGIN
      ItemAvailFormsMgt.ShowItemAvailFromProdOrderLine(Rec,AvailabilityType);
    END;

    LOCAL PROCEDURE ShowReservationEntries@9();
    BEGIN
      ShowReservationEntries(TRUE);
    END;

    LOCAL PROCEDURE ShowProductionJournal@7();
    VAR
      ProdOrder@1000 : Record 5405;
      ProductionJrnlMgt@1001 : Codeunit 5510;
    BEGIN
      CurrPage.SAVERECORD;

      ProdOrder.GET(Status,"Prod. Order No.");

      CLEAR(ProductionJrnlMgt);
      ProductionJrnlMgt.Handling(ProdOrder,"Line No.");
    END;

    PROCEDURE UpdateForm@6(SetSaveRecord@1000 : Boolean);
    BEGIN
      CurrPage.UPDATE(SetSaveRecord);
    END;

    LOCAL PROCEDURE DescriptionOnFormat@19023855();
    BEGIN
      DescriptionIndent := "Planning Level Code";
    END;

    PROCEDURE PageShowReservation@16();
    BEGIN
      CurrPage.SAVERECORD;
      ShowReservation;
    END;

    BEGIN
    {
      +---------------------------------------------+
      | SI-Data                                     |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 09.06.16 JAL The page is based on PAG 99000832 "Released Prod. Order Lines"
    }
    END.
  }
}

OBJECT Page 83026 Change Status On Released PO
{
  OBJECT-PROPERTIES
  {
    Date=20.04.17;
    Time=16.20.12;
    Modified=Yes;
    Version List=OPC;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Change Status On Released PO;
               NOR=Endre status p† frigitt produksjonsordre];
    SourceTable=Table5409;
    PageType=Card;
    OnInit=BEGIN
             com2Visible := TRUE;
             com1Visible := TRUE;
             OPCSetupG.GET;
           END;

    OnAfterGetRecord=BEGIN
                       OPCcom.SETRANGE(OPCcom."Prod. Order No.", "Prod. Order No.");
                       IF OPCcom.FIND('-') THEN
                           com := TRUE;

                       IF com = TRUE THEN
                         Tekst := 'Tekst';
                         com1Visible := TRUE;
                         com2Visible := TRUE;
                         IF com = FALSE THEN
                            com1Visible := FALSE;
                            com2Visible := TRUE;
                       TekstOnFormat;
                     END;

    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000044;1 ;Action    ;
                      CaptionML=[ENU=Comment;
                                 NOR=Merknad];
                      ToolTipML=[ENU=Comment;
                                 NOR=Merknad];
                      RunObject=Page 99000840;
                      RunPageLink=Prod. Order No.=FIELD(Prod. Order No.),
                                  Status=FIELD(Status),
                                  Routing No.=FIELD(Routing No.),
                                  Operation No.=FIELD(Operation No.),
                                  Routing Reference No.=FIELD(Routing Reference No.);
                      Promoted=Yes;
                      PromotedCategory=Process }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000034;1;Group  ;
                Name=Production Order;
                CaptionML=[ENU=Production Order;
                           NOR=Produksjonsordre] }

    { 1000000038;2;Field  ;
                SourceExpr=Status;
                Editable=FALSE }

    { 1000000039;2;Field  ;
                SourceExpr="Prod. Order No.";
                Editable=FALSE }

    { 1000000042;2;Field  ;
                CaptionML=[ENU=Finish Production Order;
                           NOR=Sett status til ferdig];
                SourceExpr=ChangeStatus }

    { 1000000043;2;Field  ;
                CaptionML=[ENU=Postingdate;
                           NOR=Bokf›ringsdato];
                SourceExpr=PostingDate }

    { 1000000035;2;Field  ;
                CaptionML=[ENU=Print Out;
                           NOR=Utskrift];
                SourceExpr=Utskrift }

    { 1000000032;2;Field  ;
                Name=com2;
                CaptionML=[ENU=Comments OPC;
                           NOR=Merknad fra OPC];
                SourceExpr=Tekst;
                Visible=com2Visible }

    { 1000000000;1;Group  ;
                Editable=FALSE;
                GroupType=Repeater }

    { 1000000001;2;Field  ;
                SourceExpr="Operation No." }

    { 1000000003;2;Field  ;
                SourceExpr=Type }

    { 1000000005;2;Field  ;
                SourceExpr="No." }

    { 1000000007;2;Field  ;
                SourceExpr=Description }

    { 1000000009;2;Field  ;
                SourceExpr="Expected Operation Cost Amt." }

    { 1000000011;2;Field  ;
                SourceExpr="Expected Capacity Ovhd. Cost" }

    { 1000000013;2;Field  ;
                SourceExpr="Actual Direct Cost" }

    { 1000000015;2;Field  ;
                SourceExpr="Actual Indirect Cost" }

    { 1000000020;1;Group  ;
                Name=Production Order Sum;
                CaptionML=[ENU=PO Summary;
                           NOR=PO Sammendrag] }

    { 1000000023;2;Field  ;
                CaptionML=[ENU=Actual Cost;
                           NOR=Faktisk Kost];
                SourceExpr=ActualCost;
                Editable=FALSE }

    { 1000000021;2;Field  ;
                CaptionML=[ENU=Expected Cost;
                           NOR=Forventet Kost];
                SourceExpr=ExpectedCost;
                Editable=FALSE }

    { 1000000027;2;Field  ;
                CaptionML=[ENU=Deviation;
                           NOR=Avvik];
                SourceExpr=DeviationCost;
                Editable=FALSE }

    { 1000000025;2;Field  ;
                CaptionML=[ENU=Correction Cost;
                           NOR=Korreksjonskost];
                SourceExpr=CorrectionCost;
                Editable=FALSE;
                OnValidate=BEGIN
                             IF DeviationCost > 0 THEN BEGIN
                               IF CorrectionCost > 0 THEN
                                 MESSAGE(Text003);
                             END ELSE BEGIN
                               IF CorrectionCost < 0 THEN
                                 MESSAGE(Text003);
                             END;

                             IF NOT CONFIRM(Text001, TRUE, ActualCost + CorrectionCost) THEN
                               ERROR(Text002);
                           END;
                            }

    { 1000000017;2;Field  ;
                CaptionML=NOR=Merknad;
                SourceExpr=Comment;
                OnValidate=BEGIN
                             ChgstatusCommentline.SETRANGE(ChgstatusCommentline."Prod. Order No.","Prod. Order No.");
                             ChgstatusCommentline.SETRANGE(ChgstatusCommentline."Routing reference No.","Routing Reference No.");
                             ChgstatusCommentline.SETRANGE(ChgstatusCommentline."Routing No.","Routing No.");
                             ChgstatusCommentline.SETRANGE(ChgstatusCommentline."Operation No.","Operation No.");
                             //ChgstatusCommentline.SETRANGE(ChgstatusCommentline."Entry No.",0);

                             IF ChgstatusCommentline.FIND('+') THEN BEGIN
                               IF ChgstatusCommentline."Entry No." = 0 THEN BEGIN
                                 ChgstatusCommentline.Comment := Comment;
                                 ChgstatusCommentline.MODIFY;
                               END ELSE BEGIN
                                 LineNo := 10000;
                                 ChgstatusCommentline."Prod. Order No." := "Prod. Order No.";
                                 ChgstatusCommentline."Routing reference No." := "Routing Reference No.";
                                 ChgstatusCommentline."Routing No." := "Routing No.";
                                 ChgstatusCommentline."Operation No." := "Operation No.";
                                 ChgstatusCommentline.Comment := Comment;
                                 ChgstatusCommentline.Date := WORKDATE;
                                 ChgstatusCommentline."Line No." := ChgstatusCommentline."Line No." + LineNo;
                                 ChgstatusCommentline."Entry No." := 0;
                                 ChgstatusCommentline.INSERT;
                                 END;
                             END ELSE BEGIN
                               LineNo := 10000;
                               ChgstatusCommentline."Prod. Order No." := "Prod. Order No.";
                               ChgstatusCommentline."Routing reference No." := "Routing Reference No.";
                               ChgstatusCommentline."Routing No." := "Routing No.";
                               ChgstatusCommentline."Operation No." := "Operation No.";
                               ChgstatusCommentline.Comment := Comment;
                               ChgstatusCommentline.Date := WORKDATE;
                               ChgstatusCommentline."Line No." := ChgstatusCommentline."Line No." + LineNo;
                               ChgstatusCommentline."Entry No." := 0;
                               ChgstatusCommentline.INSERT;
                             END;
                           END;
                            }

    { 1000000049;2;Field  ;
                CaptionML=[ENU=Correction Cost;
                           NOR=Korreksjon(timer)];
                SourceExpr=CorrectionHours;
                OnValidate=BEGIN
                             CorrectionCost := CorrectionHours * CorrectionUnitCost;

                             IF DeviationCost > 0 THEN BEGIN
                               IF CorrectionCost > 0 THEN
                                 MESSAGE(Text003);
                             END ELSE BEGIN
                               IF CorrectionCost < 0 THEN
                                 MESSAGE(Text003);
                             END;

                             IF NOT CONFIRM(Text001, TRUE, ActualCost + CorrectionCost) THEN
                               ERROR(Text002);
                           END;
                            }

    { 1000000048;2;Field  ;
                CaptionML=[ENU=Correction Cost;
                           NOR=Korreksjon(timepris)];
                SourceExpr=CorrectionUnitCost;
                OnValidate=BEGIN
                             CorrectionCost := CorrectionHours * CorrectionUnitCost;

                             IF DeviationCost > 0 THEN BEGIN
                               IF CorrectionCost > 0 THEN
                                 MESSAGE(Text003);
                             END ELSE BEGIN
                               IF CorrectionCost < 0 THEN
                                 MESSAGE(Text003);
                             END;

                             IF NOT CONFIRM(Text001, TRUE, ActualCost + CorrectionCost) THEN
                               ERROR(Text002);
                           END;
                            }

  }
  CODE
  {
    VAR
      ChangeStatus@1000000000 : Boolean;
      PostingDate@1000000001 : Date;
      ActualCost@1000000002 : Decimal;
      ExpectedCost@1000000003 : Decimal;
      CorrectionCost@1000000004 : Decimal;
      DeviationCost@1000000005 : Decimal;
      Text001@1000000006 : TextConst 'NOR=Ny faktisk operasjonskost vil bli %1.';
      Text002@1000000007 : TextConst 'NOR=Handlingen ble avbrutt.';
      Comment@1000000008 : Text[80];
      ChgstatusCommentline@1000000009 : Record 83008;
      LineNo@1000000010 : Integer;
      "--SI-Data--"@1000000011 : Text[30];
      OPCcom@1000000012 : Record 5415;
      com@1000000013 : Boolean;
      Tekst@1000000014 : Text[30];
      Utskrift@1000000015 : Boolean;
      r_ProdOrder@1000000016 : Record 5405;
      OPCSetupG@1101103003 : Record 83001;
      PageManagementG@1101103001 : Codeunit 700;
      CorrectionHours@1000000017 : Decimal;
      CorrectionUnitCost@1000000018 : Decimal;
      com1Visible@19041620 : Boolean INDATASET;
      com2Visible@19077332 : Boolean INDATASET;
      com2Emphasize@19002164 : Boolean INDATASET;
      Text003@1101103002 : TextConst 'ENU=The difference will increase;NOR=Du vil n† forsterke avviket';

    PROCEDURE INITForm@1000000000(ProdOrder@1000000000 : Record 5405);
    VAR
      ProdOrderRoutLine@1000000001 : Record 5409;
    BEGIN
      ChangeStatus := TRUE;
      PostingDate := WORKDATE;
      ActualCost := 0;
      ExpectedCost := 0;
      CorrectionCost := 0;
      DeviationCost := 0;
      CorrectionUnitCost := 0;
      CorrectionHours := 0;

      ProdOrderRoutLine.RESET;
      ProdOrderRoutLine.SETRANGE(Status,ProdOrder.Status);
      ProdOrderRoutLine.SETRANGE("Prod. Order No.",ProdOrder."No.");
      IF ProdOrderRoutLine.FIND('-') THEN
      REPEAT
        ExpectedCost := ExpectedCost +ProdOrderRoutLine."Expected Operation Cost Amt." + ProdOrderRoutLine.
      "Expected Capacity Ovhd. Cost";
        ActualCost := ActualCost + ProdOrderRoutLine."Actual Direct Cost" + ProdOrderRoutLine."Actual Indirect Cost";
      UNTIL ProdOrderRoutLine.NEXT=0;
      DeviationCost := ActualCost - ExpectedCost;
    END;

    PROCEDURE PrintReport@1000000002();
    BEGIN
      IF Utskrift = TRUE THEN BEGIN
        r_ProdOrder.SETRANGE(Status,Status);
        r_ProdOrder.SETFILTER("No.","Prod. Order No.");
        REPORT.RUNMODAL(99000791,TRUE,TRUE,r_ProdOrder);
      END;
    END;

    PROCEDURE ReturnPostingInfo@4(VAR Status@1000 : 'Simulated,Planned,Firm Planned,Released,Finished';VAR PostingDate2@1001 : Date;VAR UpdUnitCost@1002 : Boolean;VAR Correction@1000000000 : Decimal;VAR ChangeStatus2@1000000001 : Boolean;VAR CorrectionHours_funk@1000000002 : Decimal;VAR CorrectionUnitCost_funk@1000000003 : Decimal);
    BEGIN
      PrintReport;
      Status := Status::Finished;
      PostingDate2 := PostingDate;
      UpdUnitCost := FALSE;
      Correction := CorrectionCost;
      ChangeStatus2 := ChangeStatus;
      CorrectionUnitCost_funk := CorrectionUnitCost;
      CorrectionHours_funk := CorrectionHours;
    END;

    LOCAL PROCEDURE TekstOnFormat@19049259();
    BEGIN
      com2Emphasize := TRUE;
    END;

    BEGIN
    {
      +---------------------------------------------+
      | SI-Data                                     |
      +---------------------------------------------+
      Nr.     Dato       Id    Beskrivelse
      01.     01.04.08   HEI   Lagt til "Merknad" fra OPC til † vises i Endre P.O status
      02.     06.03.09   BVM   Lagt til Utskrift for utskrift av prod. ordre statestikk
      02.     27.04.10   BVM   Tatt bort 02. etter ›nsker fra Elas/PTL
      03.     08.09.09   HHE   Mulighet for † legge inn korreksjonen i antall timer eller antall kroner
    }
    END.
  }
}

OBJECT Page 83027 Non producing codes -adm
{
  OBJECT-PROPERTIES
  {
    Date=20.04.17;
    Time=16.20.12;
    Modified=Yes;
    Version List=indir.tid OPC;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Non producing time;
               NOR="OPC - koder for Ikke produktiv tid "];
    SourceTable=Table83011;
    PageType=List;
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1101104000;1;Group  ;
                GroupType=Repeater }

    { 1101104001;2;Field  ;
                SourceExpr=Kode }

    { 1101104003;2;Field  ;
                SourceExpr=Beskrivelse }

  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Page 83028 Non producing codes - OPC
{
  OBJECT-PROPERTIES
  {
    Date=20.04.17;
    Time=16.20.12;
    Modified=Yes;
    Version List=indir.tid OPC;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Non producing time - OPC;
               NOR=Ikke produktiv tid - OPC];
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=No;
    SourceTable=Table83011;
    PageType=List;
    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1101104008;1 ;Action    ;
                      Name=Start og Stop Time;
                      CaptionML=[ENU=Start/Stop Time;
                                 NOR=Start/stopp tid];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Start;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 OPCOppsett@1000000006 : Record 83001;
                                 OperasjonsTider@1000000005 : Record 83010;
                                 MachineCenteronOperation@1101103000 : Page 83008;
                               BEGIN
                                 // 001 START
                                 OperasjonsTider.SETRANGE(OperasjonsTider."Prod. Order No.", '');
                                 OperasjonsTider.SETRANGE(OperasjonsTider."Routing No.",  '');
                                 OperasjonsTider.SETRANGE(OperasjonsTider."Operation No.",  '');
                                 OperasjonsTider.SETFILTER(OperasjonsTider."Ending Date", '=%1', 0D);
                                 OperasjonsTider.SETFILTER(OperasjonsTider."Ending Time", '=%1', 0T);
                                 //hhe 03.04.06 OperasjonsTider.SETRANGE("Work done at M.C.","Machine Center");
                                 CLEAR(MachineCenteronOperation);
                                 MachineCenteronOperation.InitForm("Machine Center",Kode);
                                 MachineCenteronOperation.SETTABLEVIEW(OperasjonsTider);
                                 MachineCenteronOperation.RUN;
                                 // 001 STOP
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1101104000;1;Group  ;
                GroupType=Repeater }

    { 1101104001;2;Field  ;
                SourceExpr=Kode }

    { 1101104003;2;Field  ;
                SourceExpr=Beskrivelse }

  }
  CODE
  {
    VAR
      "Machine Center"@1000000000 : Code[20];

    PROCEDURE InitForm@1000000000(MachineNo@1000000000 : Code[20]);
    BEGIN
      "Machine Center" := MachineNo;
    END;

    BEGIN
    {
      ----------------------------------------------
      SI-DATA AS

      OPC
      ----------------------------------------------
      No  Date      ID      Description
      ----------------------------------------------
      001 29.03.06  ASL Endret p† kode Start / stopp tid
      002 03.04.06  HHE Fjernet filter "Work done at M.C"
    }
    END.
  }
}

OBJECT Page 83029 Merknader - endre p.o. status
{
  OBJECT-PROPERTIES
  {
    Date=20.04.17;
    Time=16.20.12;
    Modified=Yes;
    Version List=OPC;
  }
  PROPERTIES
  {
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=Yes;
    SourceTable=Table83008;
    PageType=List;
    AutoSplitKey=Yes;
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000000;1;Group  ;
                GroupType=Repeater }

    { 1000000001;2;Field  ;
                SourceExpr=Date }

    { 1000000003;2;Field  ;
                SourceExpr=Comment }

  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Page 83030 OPC - Move components
{
  OBJECT-PROPERTIES
  {
    Date=20.04.17;
    Time=16.20.12;
    Modified=Yes;
    Version List=OPC;
  }
  PROPERTIES
  {
    CaptionML=[ENU=OPC - Move components;
               NOR=OPC - flytt komponenter];
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=Yes;
    SourceTable=Table5407;
    PageType=List;
    OnInit=BEGIN
             //hhe 19.08.10->
             OPCOppsett.GET;
             //hhe 19.08.10<-
           END;

    OnAfterGetRecord=BEGIN
                       //hhe 18.08.10->
                       "Shipped qty - remaining" := "Remaining Quantity" - Shipped;
                       Beholdning := 0;
                       IF rec_Item.GET("Item No.") THEN BEGIN
                         rec_Item.SETRANGE("Location Filter",OPCOppsett."OPC-Move Location Code");
                         rec_Item.CALCFIELDS(Inventory);
                         Beholdning := rec_Item.Inventory;
                       END;
                       //hhe 18.08.10<-
                     END;

    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000026;1 ;Action    ;
                      CaptionML=NOR=Bokf›r flytting;
                      Promoted=Yes;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ProdOrderComp@1000000001 : Record 5407;
                                 ProdOrderComp2@1000000002 : Record 5407;
                               BEGIN
                                 //17.08.10->
                                 IF NewLocationCode = '' THEN
                                   ERROR('Du m† angi "Flytt til lokasjonskode"');

                                 IF NewLocationCode = OPCOppsett."OPC-Move Location Code" THEN
                                   ERROR('Du kan ikke angi %1 som "Flytt til lokasjonskode"',OPCOppsett."OPC-Move Location Code");

                                 ProdOrderComp.COPY(Rec);
                                 ProdOrderComp.SETFILTER("Ship now",'>0');
                                 IF ProdOrderComp.FIND('-') THEN BEGIN
                                   //overf›rer Prod.o.komponentlinjene inn i Overf›ringskladd
                                   OverfKladdLinje.SETRANGE(OverfKladdLinje."Journal Template Name", OPCOppsett."Item Reclass. Journal (templ.)");
                                   OverfKladdLinje.SETRANGE(OverfKladdLinje."Journal Batch Name", OPCOppsett."Item Reclass. Journal (Name)");
                                   IF OverfKladdLinje.FIND('-') THEN
                                    OverfKladdLinje.DELETEALL;
                                   OverfKladdLinje."Line No." := 0;
                                   REPEAT
                                     OverfKladdLinje.INIT;
                                     OverfKladdLinje.VALIDATE("Journal Template Name", OPCOppsett."Item Reclass. Journal (templ.)");
                                     OverfKladdLinje.VALIDATE("Journal Batch Name", OPCOppsett."Item Reclass. Journal (Name)");
                                     OverfKladdLinje."Line No." := OverfKladdLinje."Line No." +10000;
                                     OverfKladdLinje.INSERT(TRUE);

                                     OverfKladdLinje."Entry Type" := OverfKladdLinje."Entry Type"::Transfer;
                                     OverfKladdLinje."Posting Date" := TODAY;
                                     OverfKladdLinje."Document Date" := TODAY;
                                     OverfKladdLinje."Document No." := 'OPC-flytt';
                                     OverfKladdLinje.VALIDATE("Item No.", ProdOrderComp."Item No.");
                                     OverfKladdLinje.VALIDATE("Location Code",OPCOppsett."OPC-Move Location Code");
                                     OverfKladdLinje.VALIDATE(Quantity,ProdOrderComp."Ship now");
                                     OverfKladdLinje.VALIDATE("New Location Code",NewLocationCode);
                                     OverfKladdLinje.VALIDATE("Order Type", OverfKladdLinje."Order Type"::Production);
                                     OverfKladdLinje.VALIDATE("Order No.", "Prod. Order No.");
                                     OverfKladdLinje.MODIFY(TRUE);
                                     ProdOrderComp2.COPY(ProdOrderComp);
                                     ProdOrderComp2."Ship now" := 0;
                                     ProdOrderComp2.MODIFY;

                                   UNTIL ProdOrderComp.NEXT = 0;
                                 END;

                                 //bokf›rer overf›ringskladden
                                 CODEUNIT.RUN(CODEUNIT::"Item Jnl.-Post",OverfKladdLinje);

                                 //hvis vellykket bokf›ring, s† ...
                                 //ProdOrderComp2.COPY(Rec);
                                 {
                                 IF ProdOrderComp.FIND('-') THEN BEGIN
                                   ProdOrderComp2."Ship now" := 0;
                                   ProdOrderComp2.MODIFY;
                                 END;
                                 }
                                 //18.08.10<-
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000000;1;Group  ;
                Editable=TRUE;
                GroupType=Repeater }

    { 1000000005;2;Field  ;
                SourceExpr="Item No.";
                Editable=FALSE }

    { 1000000007;2;Field  ;
                SourceExpr=Description;
                Editable=FALSE }

    { 1000000031;2;Field  ;
                CaptionML=NOR=Beholdn. - Hoved;
                DecimalPlaces=0:2;
                SourceExpr=Beholdning;
                Editable=FALSE }

    { 1000000009;2;Field  ;
                SourceExpr="Unit of Measure Code";
                Editable=FALSE }

    { 1000000027;2;Field  ;
                DecimalPlaces=0:2;
                SourceExpr=Shipped;
                Editable=FALSE }

    { 1000000011;2;Field  ;
                CaptionML=NOR=Gjenst†r † flytte;
                DecimalPlaces=0:2;
                SourceExpr="Remaining Quantity" - Shipped;
                Editable=FALSE }

    { 1000000029;2;Field  ;
                DecimalPlaces=0:2;
                SourceExpr="Ship now" }

    { 1000000002;1;Field  ;
                SourceExpr=OPCOppsett."OPC-Move Location Code";
                TableRelation=Location.Code;
                Editable=FALSE }

    { 1000000024;1;Field  ;
                SourceExpr=NewLocationCode;
                TableRelation=Location.Code }

    { 1000000025;1;Field  ;
                CaptionClass=Text19028583 }

    { 1000000001;1;Field  ;
                CaptionClass=Text19076695 }

    { 1000000021;1;Field  ;
                CaptionClass=Text19042457 }

    { 1000000020;1;Field  ;
                CaptionClass=Text19028137 }

    { 1000000003;1;Field  ;
                CaptionClass=Text19027444 }

    { 1000000019;1;Field  ;
                CaptionClass=Text19015144 }

    { 1000000018;1;Field  ;
                CaptionClass=Text19006185 }

  }
  CODE
  {
    VAR
      NewLocationCode@1000000000 : Code[10];
      OverfKladdLinje@1000000001 : Record 83;
      OPCOppsett@1000000002 : Record 83001;
      Beholdning@1000000003 : Decimal;
      rec_Item@1000000004 : Record 27;
      Text19006185@19047498 : TextConst 'NOR=Dette bildet brukes for † flytte komponenter fra en lokasjon til en ny';
      Text19015144@19061235 : TextConst 'NOR="For † flytte beholdningen fra angitt lokasjon til en ny, s† skal du gj›re f›lgende: "';
      Text19027444@19029557 : TextConst 'NOR=1) For de varelinjer du vil flytte: angi enn verdi i feltet "Flytt n† (antall)"';
      Text19028137@19008317 : TextConst 'NOR=2) Angi en verdi i feltet "Flytt til lokasjonskode"';
      Text19042457@19034517 : TextConst 'NOR=3) Trykk p† knappen "Bokf›r flytting"';
      Text19076695@19025829 : TextConst 'NOR=Flytt fra lokasjonskode:';
      Text19028583@19034388 : TextConst 'NOR=Flytt til lokasjonskode:';

    BEGIN
    END.
  }
}

OBJECT Page 83031 Run Times med blanke linjer
{
  OBJECT-PROPERTIES
  {
    Date=20.04.17;
    Time=16.20.12;
    Modified=Yes;
    Version List=BVM temp;
  }
  PROPERTIES
  {
    SourceTable=Table83010;
    SourceTableView=SORTING(Entry No.,Prod. Order No.,Routing No.,Operation No.,Machine Center)
                    WHERE(Starting Date=FILTER(''),
                          Starting Time=FILTER(''));
    PageType=List;
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000000;1;Group  ;
                GroupType=Repeater }

    { 1000000001;2;Field  ;
                SourceExpr="Entry No." }

    { 1000000003;2;Field  ;
                SourceExpr="Prod. Order No." }

    { 1000000005;2;Field  ;
                SourceExpr="Routing No." }

    { 1000000007;2;Field  ;
                SourceExpr="Operation No." }

    { 1000000009;2;Field  ;
                SourceExpr="Machine Center" }

    { 1000000011;2;Field  ;
                SourceExpr=Description }

    { 1000000013;2;Field  ;
                SourceExpr="Starting Date" }

    { 1000000015;2;Field  ;
                SourceExpr="Starting Time" }

    { 1000000017;2;Field  ;
                SourceExpr="Ending Date" }

    { 1000000019;2;Field  ;
                SourceExpr="Ending Time" }

    { 1000000021;2;Field  ;
                SourceExpr="Finish Now" }

    { 1000000023;2;Field  ;
                SourceExpr=Post }

    { 1000000025;2;Field  ;
                SourceExpr="Work done at M.C." }

  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Page 83032 Order Processor Role C.  Magne
{
  OBJECT-PROPERTIES
  {
    Date=21.04.17;
    Time=10.38.37;
    Modified=Yes;
    Version List=NAVW110.00;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Role Center;
               NOR=Rollesenter];
    PageType=RoleCenter;
    ActionList=ACTIONS
    {
      { 1900000011;0 ;ActionContainer;
                      ToolTipML=[ENU=Manage sales processes. See KPIs and your favorite items and customers.;
                                 NOR=Behandle salgsprosesser. Se KPIer og dine favorittvarer og -kunder.];
                      ActionContainerType=HomeItems }
      { 2       ;1   ;Action    ;
                      Name=SalesOrders;
                      CaptionML=[ENU=Sales Orders;
                                 NOR=Ordrer];
                      ToolTipML=[ENU=Open the list of sales orders where you can sell items and services.;
                                 NOR=pne listen over ordrer der du kan selge varer og tjenester.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 9305;
                      Image=Order }
      { 6       ;1   ;Action    ;
                      Name=SalesOrdersShptNotInv;
                      CaptionML=[ENU=Shipped Not Invoiced;
                                 NOR=Levert, ikke fakturert];
                      ToolTipML=[ENU=View sales that are shipped but not yet invoiced.;
                                 NOR=Vis salg som er levert, men ikke fakturert enn†.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 9305;
                      RunPageView=WHERE(Shipped Not Invoiced=CONST(Yes)) }
      { 7       ;1   ;Action    ;
                      Name=SalesOrdersComplShtNotInv;
                      CaptionML=[ENU=Completely Shipped Not Invoiced;
                                 NOR=Fullstendig levert, ikke fakturert];
                      ToolTipML=[ENU=View sales documents that are fully shipped but not fully invoiced.;
                                 NOR=Vis salgsdokumenter som er fullstendig levert, men ikke fullstendig fakturert.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 9305;
                      RunPageView=WHERE(Completely Shipped=CONST(Yes),
                                        Invoice=CONST(No)) }
      { 25      ;1   ;Action    ;
                      CaptionML=[ENU=Dynamics CRM Sales Orders;
                                 NOR=Dynamics CRM-ordre];
                      ToolTipML=[ENU=View sales orders in Dynamics CRM that are coupled with sales orders in Dynamics NAV.;
                                 NOR=Vis ordrer i Dynamics CRM som er sammenkoblet med ordrer i Dynamics NAV.];
                      ApplicationArea=#Suite;
                      RunObject=Page 5353;
                      RunPageView=WHERE(StateCode=FILTER(Submitted),
                                        LastBackofficeSubmit=FILTER('')) }
      { 11      ;1   ;Action    ;
                      CaptionML=[ENU=Sales Quotes;
                                 NOR=Tilbud];
                      ToolTipML=[ENU=Open the list of sales quotes where you offer items or services to customers.;
                                 NOR=pne liste over tilbud der du tilbyr varer eller tjenester til kunder.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 9300;
                      Image=Quote }
      { 49      ;1   ;Action    ;
                      CaptionML=[ENU=Blanket Sales Orders;
                                 NOR=Rammebestillinger];
                      RunObject=Page 9303 }
      { 50      ;1   ;Action    ;
                      CaptionML=[ENU=Sales Invoices;
                                 NOR=Salgsfakturaer];
                      ToolTipML=[ENU=Open the list of sales invoices where you can invoice items or services.;
                                 NOR=pne listen over salgsfakturaer der du kan fakturere varer eller tjenester.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 9301;
                      Image=Invoice }
      { 51      ;1   ;Action    ;
                      CaptionML=[ENU=Sales Return Orders;
                                 NOR=Ordrereturer];
                      RunObject=Page 9304;
                      Image=ReturnOrder }
      { 52      ;1   ;Action    ;
                      CaptionML=[ENU=Sales Credit Memos;
                                 NOR=Salgskreditnotaer];
                      ToolTipML=[ENU=Open the list of sales credit memos where you can revert posted sales invoices.;
                                 NOR=pne listen over salgskreditnotaer der du kan gjenopprette bokf›rte salgsfakturaer.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 9302 }
      { 23      ;1   ;Action    ;
                      CaptionML=[ENU=Items;
                                 NOR=Varer];
                      ToolTipML=[ENU=Open the list of items that you trade in.;
                                 NOR=pne listen over varer du handler i.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 31;
                      Image=Item }
      { 26      ;1   ;Action    ;
                      CaptionML=[ENU=Customers;
                                 NOR=Kunder];
                      ToolTipML=[ENU=Open the list of customers.;
                                 NOR=pne listen over kunder.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 22;
                      Image=Customer }
      { 3       ;1   ;Action    ;
                      CaptionML=[ENU=Item Journals;
                                 NOR=Varekladder];
                      ToolTipML=[ENU=Open a list of journals where you can adjust the physical quantity of items on inventory.;
                                 NOR=pne en liste over kladder der du kan justere det fysiske antallet for varer p† lager.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 262;
                      RunPageView=WHERE(Template Type=CONST(Item),
                                        Recurring=CONST(No)) }
      { 5       ;1   ;Action    ;
                      Name=SalesJournals;
                      CaptionML=[ENU=Sales Journals;
                                 NOR=Salgskladder];
                      ToolTipML=[ENU=Open the list of sales journals where you can batch post sales transactions to G/L, bank, customer, vendor and fixed assets accounts.;
                                 NOR=pne listen over salgskladder der du kan massebokf›re salgstransaksjoner til finans-, bank-, kunde-, leverand›r- og aktivakonti.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 251;
                      RunPageView=WHERE(Template Type=CONST(Sales),
                                        Recurring=CONST(No)) }
      { 10      ;1   ;Action    ;
                      Name=CashReceiptJournals;
                      CaptionML=[ENU=Cash Receipt Journals;
                                 NOR=Innbetalingskladder];
                      ToolTipML=[ENU=Register received payments by applying them to the related customer, vendor, or bank ledger entries.;
                                 NOR=Registrer mottatte betalinger ved † utligne dem mot relaterte kunde-, leverand›r- eller bankposter.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 251;
                      RunPageView=WHERE(Template Type=CONST(Cash Receipts),
                                        Recurring=CONST(No));
                      Image=Journals }
      { 1000000007;1 ;Action    ;
                      Name=Page Bestillinger;
                      CaptionML=[ENU=Purchase Orders;
                                 NOR=Bestillinger];
                      RunObject=Page 53 }
      { 1000000006;1 ;Action    ;
                      Name=Page Vendor;
                      CaptionML=[ENU=Vendors;
                                 NOR=Leverand›rer];
                      RunObject=Page 27 }
      { 1900000012;0 ;ActionContainer;
                      ActionContainerType=ActivityButtons }
      { 39      ;1   ;ActionGroup;
                      CaptionML=[ENU=Posted Documents;
                                 NOR=Bokf›rte bilag];
                      ToolTipML=[ENU=View history for sales, shipments, and inventory.;
                                 NOR=Vis salgshistorikk, leveringer og lager.];
                      Image=FiledPosted }
      { 40      ;2   ;Action    ;
                      CaptionML=[ENU=Posted Sales Shipments;
                                 NOR=Bokf›rte f›lgesedler];
                      ToolTipML=[ENU=View the posted sales shipments.;
                                 NOR=Vis de bokf›rte f›lgesedlene.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 142;
                      Image=PostedShipment }
      { 32      ;2   ;Action    ;
                      CaptionML=[ENU=Posted Sales Invoices;
                                 NOR=Bokf›rte salgsfakturaer];
                      ToolTipML=[ENU=View the posted sales invoices.;
                                 NOR=Vis de bokf›rte salgsfakturaene.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 143;
                      Image=PostedOrder }
      { 33      ;2   ;Action    ;
                      CaptionML=[ENU=Posted Return Receipts;
                                 NOR=Bokf›rte retursedler];
                      RunObject=Page 6662;
                      Image=PostedReturnReceipt }
      { 34      ;2   ;Action    ;
                      CaptionML=[ENU=Posted Sales Credit Memos;
                                 NOR=Bokf›rte salgskreditnotaer];
                      ToolTipML=[ENU=View the posted sales credit memos.;
                                 NOR=Vis de bokf›rte salgskreditnotaene.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 144;
                      Image=PostedOrder }
      { 53      ;2   ;Action    ;
                      CaptionML=[ENU=Posted Purchase Receipts;
                                 NOR=Bokf›rte mottak];
                      RunObject=Page 145 }
      { 54      ;2   ;Action    ;
                      CaptionML=[ENU=Posted Purchase Invoices;
                                 NOR=Bokf›rte kj›psfakturaer];
                      ToolTipML=[ENU=View the posted purchase invoices.;
                                 NOR=Vis de bokf›rte kj›psfakturaene.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 146 }
      { 1000000003;2 ;Action    ;
                      CaptionML=[ENU=Posted Purchase Credit Memos;
                                 NOR=Bokf›rte kj›pskreditnotaer];
                      RunObject=Page 147 }
      { 57      ;1   ;ActionGroup;
                      CaptionML=[ENU=Self-Service;
                                 NOR=Selvbetjening];
                      ToolTipML=[ENU=Manage your time sheets and assignments.;
                                 NOR=Behandle timeregistreringer og tilordninger.];
                      Image=HumanResources }
      { 24      ;2   ;Action    ;
                      CaptionML=[ENU=Time Sheets;
                                 NOR=Timeregistreringer];
                      ToolTipML=[ENU=View all time sheets.;
                                 NOR=Viser alle timeregistreringer.];
                      ApplicationArea=#Suite;
                      RunObject=Page 951;
                      Gesture=None }
      { 16      ;0   ;ActionContainer;
                      ActionContainerType=NewDocumentItems }
      { 18      ;1   ;Action    ;
                      CaptionML=[ENU=Sales &Quote;
                                 NOR=&Tilbud];
                      ToolTipML=[ENU=Offer items or services to a customer.;
                                 NOR=Tilby varer eller tjenester til en kunde.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 41;
                      Promoted=No;
                      Image=NewSalesQuote;
                      PromotedCategory=Process;
                      RunPageMode=Create }
      { 15      ;1   ;Action    ;
                      CaptionML=[ENU=Sales &Invoice;
                                 NOR=&Salgsfaktura];
                      ToolTipML=[ENU=Create a new invoice for items or services. Invoice quantities cannot be posted partially.;
                                 NOR=Opprett en ny faktura for varer eller tjenester. Fakturaantall kan ikke bokf›res delvis.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 43;
                      Promoted=No;
                      Image=NewSalesInvoice;
                      PromotedCategory=Process;
                      RunPageMode=Create }
      { 12      ;1   ;Action    ;
                      CaptionML=[ENU=Sales &Order;
                                 NOR=&Ordre];
                      ToolTipML=[ENU=Create a new sales order for items or services that require partial posting.;
                                 NOR=Opprett en ny ordre for varer eller tjenester som krever delvis bokf›ring.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 42;
                      Promoted=No;
                      Image=Document;
                      PromotedCategory=Process;
                      RunPageMode=Create }
      { 9       ;1   ;Action    ;
                      CaptionML=[ENU=Sales &Return Order;
                                 NOR=O&rdreretur];
                      RunObject=Page 6630;
                      Promoted=No;
                      Image=ReturnOrder;
                      PromotedCategory=Process;
                      RunPageMode=Create }
      { 8       ;1   ;Action    ;
                      CaptionML=[ENU=Sales &Credit Memo;
                                 NOR=Salgs&kreditnota];
                      ToolTipML=[ENU=Create a new sales credit memo to revert a posted sales invoice.;
                                 NOR=Opprett en ny salgskreditnota for † tilbakef›re en bokf›rt salgsfaktura.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 44;
                      Promoted=No;
                      Image=CreditMemo;
                      PromotedCategory=Process;
                      RunPageMode=Create }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 35      ;1   ;ActionGroup;
                      CaptionML=[ENU=Tasks;
                                 NOR=Oppgaver] }
      { 36      ;2   ;Action    ;
                      CaptionML=[ENU=Sales &Journal;
                                 NOR=Sal&gskladd];
                      ToolTipML=[ENU=Open a sales journal where you can batch post sales transactions to G/L, bank, customer, vendor and fixed assets accounts.;
                                 NOR=pne en salgskladd der du kan massebokf›re salgstransaksjoner til finans-, bank-, kunde-, leverand›r- og aktivakonti.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 253;
                      Image=Journals }
      { 38      ;2   ;Action    ;
                      CaptionML=[ENU=Sales Price &Worksheet;
                                 NOR=Salgspr&isforslag];
                      RunObject=Page 7023;
                      Image=PriceWorksheet }
      { 1000000001;2 ;Action    ;
                      Name=Page Req. Worksheet;
                      CaptionML=[ENU=Req. worksheet MT;
                                 NOR=Bestillingsforslag_MT];
                      RunObject=Page 291;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Worksheet;
                      PromotedCategory=Process }
      { 1000000000;2 ;Action    ;
                      Name=Page Phys. Inventory Wrksheet;
                      CaptionML=[ENU=Phys. Inventory Wksht_MT;
                                 NOR=Vareopptellingskladd_MT];
                      RunObject=Page 392;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PhysicalInventory;
                      PromotedCategory=Process }
      { 1000000002;2 ;Action    ;
                      Name=Page Req. Overview;
                      CaptionML=[ENU=Requisition Overview - Week;
                                 NOR=Behovsoversikt - ukeplan];
                      RunObject=Page 50010;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PlanningWorksheet;
                      PromotedCategory=Process }
      { 42      ;1   ;ActionGroup;
                      CaptionML=[ENU=Sales;
                                 NOR=Salg] }
      { 43      ;2   ;Action    ;
                      CaptionML=[ENU=&Prices;
                                 NOR=&Priser];
                      ToolTipML=[ENU=Set up different prices for items that you sell to the customer. An item price is automatically granted on invoice lines when the specified criteria are met, such as customer, quantity, or ending date.;
                                 NOR=Definer forskjellige priser for varer som du selger til kunden. En varepris gis automatisk p† fakturalinjer n†r de angitte kriteriene er oppfylt, for eksempel kunde, antall eller sluttdato.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 7002;
                      Image=SalesPrices }
      { 44      ;2   ;Action    ;
                      CaptionML=[ENU=&Line Discounts;
                                 NOR=&Linjerabatter];
                      ToolTipML=[ENU=Set up different discounts for items that you sell to the customer. An item discount is automatically granted on invoice lines when the specified criteria are met, such as customer, quantity, or ending date.;
                                 NOR=Definer forskjellige rabatter for varer som du selger til kunden. En varerabatt gis automatisk p† fakturalinjer n†r de angitte kriteriene er oppfylt, for eksempel kunde, antall eller sluttdato.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 7004;
                      Image=SalesLineDisc }
      { 27      ;1   ;ActionGroup;
                      CaptionML=[ENU=Reports;
                                 NOR=Rapporter] }
      { 55      ;2   ;ActionGroup;
                      CaptionML=[ENU=Customer;
                                 NOR=Kunde];
                      Image=Customer }
      { 48      ;3   ;Action    ;
                      CaptionML=[ENU=Customer - &Order Summary;
                                 NOR=&Kunde - ordrebeholdning];
                      ToolTipML=[ENU=View the quantity not yet shipped for each customer in three periods of 30 days each, starting from a selected date. There are also columns with orders to be shipped before and after the three periods and a column with the total order detail for each customer. The report can be used to analyze a company's expected sales volume.;
                                 NOR=Vis antallet som enn† ikke er levert for hver kunde i tre perioder p† 30 dager hver, fra og med en valgt dato. Det vises dessuten kolonner med ordrer som skal leveres f›r og etter de 3 periodene og en kolonne med ordrebeholdningen pr. kunde i alt. Rapporten kan for eksempel brukes til analyse av selskapets forventede omsetning.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Report 107;
                      Image=Report }
      { 41      ;3   ;Action    ;
                      CaptionML=[ENU=Customer - &Top 10 List;
                                 NOR=K&unde - ti p† topp-liste];
                      ToolTipML=[ENU=View which customers purchase the most or owe the most in a selected period. Only customers that have either purchases during the period or a balance at the end of the period will be included.;
                                 NOR=Vis hvilke kunder som kj›per eller skylder mest, i en valgt periode. Bare kundene som har kj›p i perioden eller saldo ved slutten av perioden, vises i rapporten.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Report 111;
                      Image=Report }
      { 37      ;3   ;Action    ;
                      CaptionML=[ENU=Customer/&Item Sales;
                                 NOR=Ku&nde/vare-statistikk];
                      ToolTipML=[ENU=View a list of item sales for each customer during a selected time period. The report contains information on quantity, sales amount, profit, and possible discounts. It can be used, for example, to analyze a company's customer groups.;
                                 NOR=Vis en oversikt over varesalg for hver kunde i en bestemt tidsperiode. Rapporten inneholder informasjon om antall, salgsbel›p, fortjeneste og eventuelle rabatter. Den kan for eksempel brukes til † analysere et selskaps kundegrupper.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Report 113;
                      Image=Report }
      { 31      ;2   ;ActionGroup;
                      CaptionML=[ENU=Sales;
                                 NOR=Salg];
                      Image=Sales }
      { 30      ;3   ;Action    ;
                      CaptionML=[ENU=Salesperson - Sales &Statistics;
                                 NOR=S&elger - salgsstatistikk];
                      ToolTipML=[ENU=View amounts for sales, profit, invoice discount, and payment discount, as well as profit percentage, for each salesperson for a selected period. The report also shows the adjusted profit and adjusted profit percentage, which reflect any changes to the original costs of the items in the sales.;
                                 NOR=Vis bel›p for salg, fortjeneste, fakturarabatt og betalingsrabatt, i tillegg til bruttofortjenesteprosent, for hver selger for en bestemt periode. Rapporten viser ogs† justert fortjeneste og justert fortjenesteprosent, som reflekterer eventuelle endringer i opprinnelig kostnad for varene i salget.];
                      ApplicationArea=#Suite;
                      RunObject=Report 114;
                      Image=Report }
      { 29      ;3   ;Action    ;
                      CaptionML=[ENU=Price &List;
                                 NOR=Pris&liste];
                      ToolTipML=[ENU=View a list of your items and their prices, for example, to send to customers. You can create the list for specific customers, campaigns, currencies, or other criteria.;
                                 NOR=Vis en liste over varene og prisene, for eksempel for † sende til kunder. Du kan opprette listen for bestemte kunder, kampanjer, valutaer eller andre kriterier.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Report 715;
                      Image=Report }
      { 28      ;3   ;Action    ;
                      CaptionML=[ENU=Inventory - Sales &Back Orders;
                                 NOR=&Vare - restordrer til kunder];
                      ToolTipML=[ENU=View a list with the order lines whose shipment date has been exceeded. The following information is shown for the individual orders for each item: number, customer name, customer's telephone number, shipment date, order quantity and quantity on back order. The report also shows whether there are other items for the customer on back order.;
                                 NOR=Vis en oversikt over ordrelinjer der leveringsdatoen er oversteget. F›lgende informasjon vises for hver vare: nummer, kundenavn, kundens telefonnummer, leveringsdato, ordreantall og antall i restordre. Rapporten viser ogs† om kunden har andre varer i restordre.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Report 718;
                      Image=Report }
      { 45      ;1   ;ActionGroup;
                      CaptionML=[ENU=History;
                                 NOR=Historikk] }
      { 46      ;2   ;Action    ;
                      CaptionML=[ENU=Navi&gate;
                                 NOR=&Naviger];
                      ToolTipML=[ENU=Find all entries and documents that exist for the document number and posting date on the selected entry or document.;
                                 NOR=Finn alle oppf›ringer og dokumenter som finnes for dokumentnummeret og bokf›ringsdatoen i den valgte oppf›ringen eller dokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 344;
                      Image=Navigate }
    }
  }
  CONTROLS
  {
    { 1900000008;0;Container;
                ContainerType=RoleCenterArea }

    { 1900724808;1;Group   }

    { 1901851508;2;Part   ;
                AccessByPermission=TableData 110=R;
                ApplicationArea=#Basic,#Suite;
                PagePartID=Page9060;
                PartType=Page }

    { 14  ;2   ;Part      ;
                ApplicationArea=#Suite;
                PagePartID=Page9042;
                PartType=Page }

    { 1907692008;2;Part   ;
                ApplicationArea=#Basic,#Suite;
                PagePartID=Page9150;
                PartType=Page }

    { 13  ;2   ;Part      ;
                ApplicationArea=#Basic,#Suite;
                PagePartID=Page6303;
                PartType=Page }

    { 1900724708;1;Group   }

    { 1   ;2   ;Part      ;
                AccessByPermission=TableData 110=R;
                ApplicationArea=#Basic,#Suite;
                PagePartID=Page760;
                PartType=Page }

    { 4   ;2   ;Part      ;
                PagePartID=Page675;
                Visible=false;
                PartType=Page }

    { 1905989608;2;Part   ;
                AccessByPermission=TableData 9152=R;
                ApplicationArea=#Basic,#Suite;
                PagePartID=Page9152;
                PartType=Page }

    { 21  ;2   ;Part      ;
                AccessByPermission=TableData 477=R;
                ApplicationArea=#Suite;
                PagePartID=Page681;
                PartType=Page }

    { 1903012608;2;Part   ;
                PagePartID=Page9175;
                Visible=FALSE;
                PartType=Page }

    { 1901377608;2;Part   ;
                PartType=System;
                SystemPartID=MyNotes }

  }
  CODE
  {

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 31.01.17 JAL Added the Action "Posted Purchase Credit Memos"
    }
    END.
  }
}

OBJECT Page 83033 OPC Sales Order Subform
{
  OBJECT-PROPERTIES
  {
    Date=21.04.17;
    Time=10.38.37;
    Modified=Yes;
    Version List=NAVW110.00,NAVNO10.00,OPC;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Lines;
               NOR=Linjer];
    MultipleNewLines=Yes;
    LinksAllowed=No;
    SourceTable=Table37;
    DelayedInsert=Yes;
    SourceTableView=WHERE(Document Type=FILTER(Order));
    PageType=ListPart;
    AutoSplitKey=Yes;
    OnInit=BEGIN
             SalesSetup.GET;
             Currency.InitRoundingPrecision;
           END;

    OnOpenPage=VAR
                 Location@1000 : Record 14;
               BEGIN
                 IF Location.READPERMISSION THEN
                   LocationCodeVisible := NOT Location.ISEMPTY;
               END;

    OnAfterGetRecord=BEGIN
                       ShowShortcutDimCode(ShortcutDimCode);
                     END;

    OnNewRecord=BEGIN
                  IF ApplicationAreaSetup.IsFoundationEnabled THEN
                    Type := Type::Item
                  ELSE
                    InitType;
                  CLEAR(ShortcutDimCode);
                END;

    OnInsertRecord=BEGIN
                     IF ApplicationAreaSetup.IsFoundationEnabled THEN
                       Type := Type::Item;
                   END;

    OnDeleteRecord=VAR
                     ReserveSalesLine@1000 : Codeunit 99000832;
                   BEGIN
                     IF (Quantity <> 0) AND ItemExists("No.") THEN BEGIN
                       COMMIT;
                       IF NOT ReserveSalesLine.DeleteLineConfirm(Rec) THEN
                         EXIT(FALSE);
                       ReserveSalesLine.DeleteLine(Rec);
                     END;
                   END;

    OnAfterGetCurrRecord=BEGIN
                           //CalculateTotals; //01. 17.11.16 JAL
                           SetLocationCodeMandatory;
                           UpdateEditableOnRow;
                         END;

    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1907935204;1 ;ActionGroup;
                      CaptionML=[ENU=&Line;
                                 NOR=&Linje];
                      Image=Line }
      { 1906587504;2 ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 NOR=F&unksjoner];
                      Image=Action }
      { 1905623604;3 ;Action    ;
                      Name=GetPrice;
                      AccessByPermission=TableData 7002=R;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Get Price;
                                 NOR=Hent pris];
                      Image=Price;
                      OnAction=BEGIN
                                 ShowPrices;
                               END;
                                }
      { 1901770504;3 ;Action    ;
                      AccessByPermission=TableData 7004=R;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Get Li&ne Discount;
                                 NOR=Hent li&njerabatt];
                      Image=LineDiscount;
                      OnAction=BEGIN
                                 ShowLineDisc
                               END;
                                }
      { 1901741804;3 ;Action    ;
                      Name=ExplodeBOM_Functions;
                      AccessByPermission=TableData 90=R;
                      CaptionML=[ENU=E&xplode BOM;
                                 NOR=U&tfold stykkliste];
                      Image=ExplodeBOM;
                      OnAction=BEGIN
                                 ExplodeBOM;
                               END;
                                }
      { 1903099004;3 ;Action    ;
                      Name=Insert Ext. Texts;
                      AccessByPermission=TableData 279=R;
                      CaptionML=[ENU=Insert &Ext. Texts;
                                 NOR=Sett inn &utv. tekster];
                      ToolTipML=[ENU=Insert the extended item description that is set up for the item on the sales document line.;
                                 NOR=Sett inn den utvidede varebeskrivelsen som er definert for varen p† salgsdokumentlinjen.];
                      ApplicationArea=#Basic,#Suite;
                      Image=Text;
                      OnAction=BEGIN
                                 InsertExtendedText(TRUE);
                               END;
                                }
      { 1905427504;3 ;Action    ;
                      Name=Reserve;
                      Ellipsis=Yes;
                      CaptionML=[ENU=&Reserve;
                                 NOR=Re&server];
                      Image=Reserve;
                      OnAction=BEGIN
                                 FIND;
                                 ShowReservation;
                               END;
                                }
      { 1903502504;3 ;Action    ;
                      Name=OrderTracking;
                      CaptionML=[ENU=Order &Tracking;
                                 NOR=&Ordresporing];
                      Image=OrderTracking;
                      OnAction=BEGIN
                                 ShowTracking;
                               END;
                                }
      { 1905968604;3 ;Action    ;
                      AccessByPermission=TableData 5718=R;
                      CaptionML=[ENU=Nonstoc&k Items;
                                 NOR=&Katalogvarer];
                      ApplicationArea=#Basic,#Suite;
                      Image=NonStockItem;
                      OnAction=BEGIN
                                 ShowNonstockItems;
                               END;
                                }
      { 1900580804;2 ;ActionGroup;
                      CaptionML=[ENU=Item Availability by;
                                 NOR=Varetilgjengelighet per];
                      Image=ItemAvailability }
      { 5       ;3   ;Action    ;
                      Name=<Action3>;
                      CaptionML=[ENU=Event;
                                 NOR=Hendelse];
                      Image=Event;
                      OnAction=BEGIN
                                 ItemAvailFormsMgt.ShowItemAvailFromSalesLine(Rec,ItemAvailFormsMgt.ByEvent)
                               END;
                                }
      { 1904522204;3 ;Action    ;
                      CaptionML=[ENU=Period;
                                 NOR=Periode];
                      Image=Period;
                      OnAction=BEGIN
                                 ItemAvailFormsMgt.ShowItemAvailFromSalesLine(Rec,ItemAvailFormsMgt.ByPeriod)
                               END;
                                }
      { 1902056104;3 ;Action    ;
                      CaptionML=[ENU=Variant;
                                 NOR=Variant];
                      Image=ItemVariant;
                      OnAction=BEGIN
                                 ItemAvailFormsMgt.ShowItemAvailFromSalesLine(Rec,ItemAvailFormsMgt.ByVariant)
                               END;
                                }
      { 1900639404;3 ;Action    ;
                      AccessByPermission=TableData 14=R;
                      CaptionML=[ENU=Location;
                                 NOR=Lokasjon];
                      Image=Warehouse;
                      OnAction=BEGIN
                                 ItemAvailFormsMgt.ShowItemAvailFromSalesLine(Rec,ItemAvailFormsMgt.ByLocation)
                               END;
                                }
      { 15      ;3   ;Action    ;
                      CaptionML=[ENU=BOM Level;
                                 NOR=Stykklisteniv†];
                      Image=BOMLevel;
                      OnAction=BEGIN
                                 ItemAvailFormsMgt.ShowItemAvailFromSalesLine(Rec,ItemAvailFormsMgt.ByBOM)
                               END;
                                }
      { 33      ;2   ;ActionGroup;
                      CaptionML=[ENU=Related Information;
                                 NOR=Relatert informasjon] }
      { 1900186704;3 ;Action    ;
                      AccessByPermission=TableData 27=R;
                      CaptionML=[ENU=Reservation Entries;
                                 NOR=Reservasjonsposter];
                      Image=ReservationLedger;
                      OnAction=BEGIN
                                 ShowReservationEntries(TRUE);
                               END;
                                }
      { 1905987604;3 ;Action    ;
                      Name=ItemTrackingLines;
                      ShortCutKey=Shift+Ctrl+I;
                      CaptionML=[ENU=Item &Tracking Lines;
                                 NOR=Vare&sporingslinjer];
                      Image=ItemTrackingLines;
                      OnAction=BEGIN
                                 OpenItemTrackingLines;
                               END;
                                }
      { 1901633104;3 ;Action    ;
                      AccessByPermission=TableData 5715=R;
                      CaptionML=[ENU=Select Item Substitution;
                                 NOR=Velg vareerstatning];
                      ToolTipML=[ENU=Select another item that has been set up to be sold instead of the original item if it is unavailable.;
                                 NOR=Velg en annen vare som har blitt definert til † bli solgt i stedet for den opprinnelige varen, hvis den er utilgjengelig.];
                      ApplicationArea=#Suite;
                      Image=SelectItemSubstitution;
                      OnAction=BEGIN
                                 ShowItemSub;
                               END;
                                }
      { 1902085804;3 ;Action    ;
                      Name=Dimensions;
                      AccessByPermission=TableData 348=R;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 NOR=Dimensjoner];
                      Image=Dimensions;
                      OnAction=BEGIN
                                 ShowDimensions;
                               END;
                                }
      { 1903418704;3 ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 NOR=&Merknader];
                      Image=ViewComments;
                      OnAction=BEGIN
                                 ShowLineComments;
                               END;
                                }
      { 1907184504;3 ;Action    ;
                      AccessByPermission=TableData 5800=R;
                      CaptionML=[ENU=Item Charge &Assignment;
                                 NOR=V&aregebyrtilordning];
                      Image=ItemCosts;
                      OnAction=BEGIN
                                 ItemChargeAssgnt;
                               END;
                                }
      { 1905403704;3 ;Action    ;
                      Name=OrderPromising;
                      AccessByPermission=TableData 99000880=R;
                      CaptionML=[ENU=Order &Promising;
                                 NOR=Ordr&ebekreftelse];
                      Image=OrderPromising;
                      OnAction=BEGIN
                                 OrderPromisingLine;
                               END;
                                }
      { 7       ;3   ;ActionGroup;
                      CaptionML=[ENU=Assemble to Order;
                                 NOR=Monter til ordre];
                      ActionContainerType=NewDocumentItems;
                      Image=AssemblyBOM }
      { 9       ;4   ;Action    ;
                      Name=AssembleToOrderLines;
                      AccessByPermission=TableData 90=R;
                      CaptionML=[ENU=Assemble-to-Order Lines;
                                 NOR=Montere til ordre - linjer];
                      OnAction=BEGIN
                                 ShowAsmToOrderLines;
                               END;
                                }
      { 11      ;4   ;Action    ;
                      AccessByPermission=TableData 90=R;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Roll Up &Price;
                                 NOR=Oppruller &pris];
                      OnAction=BEGIN
                                 RollupAsmPrice;
                               END;
                                }
      { 13      ;4   ;Action    ;
                      AccessByPermission=TableData 90=R;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Roll Up &Cost;
                                 NOR=Oppruller &kost];
                      OnAction=BEGIN
                                 RollUpAsmCost;
                               END;
                                }
      { 31      ;3   ;Action    ;
                      Name=DeferralSchedule;
                      CaptionML=[ENU=Deferral Schedule;
                                 NOR=Tidsplan for periodisering];
                      ToolTipML=[ENU=View or edit the deferral schedule that governs how revenue made with this sales document is deferred to different accounting periods when the document is posted.;
                                 NOR=Vis eller rediger tidsplanen for periodisering som styrer hvordan inntekter fra dette salgsdokumentet periodiseres til ulike regnskapsperioder n†r dokumentet bokf›res.];
                      ApplicationArea=#Suite;
                      Enabled="Deferral Code" <> '';
                      Image=PaymentPeriod;
                      OnAction=BEGIN
                                 SalesHeader.GET("Document Type","Document No.");
                                 ShowDeferrals(SalesHeader."Posting Date",SalesHeader."Currency Code");
                               END;
                                }
      { 1905926804;1 ;ActionGroup;
                      CaptionML=[ENU=O&rder;
                                 NOR=&Ordre];
                      Image=Order }
      { 1903645604;2 ;ActionGroup;
                      CaptionML=[ENU=Dr&op Shipment;
                                 NOR=Dire&kte levering];
                      Image=Delivery }
      { 1907981104;3 ;Action    ;
                      AccessByPermission=TableData 120=R;
                      CaptionML=[ENU=Purchase &Order;
                                 NOR=&Bestilling];
                      ToolTipML=[ENU=View the purchase order that is linked to the sales order, for drop shipment.;
                                 NOR=Vis bestillingen som er knyttet til ordren, for direktelevering.];
                      ApplicationArea=#Suite;
                      Image=Document;
                      OnAction=BEGIN
                                 OpenPurchOrderForm;
                               END;
                                }
      { 1903587004;2 ;ActionGroup;
                      CaptionML=[ENU=Speci&al Order;
                                 NOR=Spesi&albestilling];
                      Image=SpecialOrder }
      { 1903192904;3 ;Action    ;
                      Name=OpenSpecialPurchaseOrder;
                      AccessByPermission=TableData 120=R;
                      CaptionML=[ENU=Purchase &Order;
                                 NOR=&Bestilling];
                      Image=Document;
                      OnAction=BEGIN
                                 OpenSpecialPurchOrderForm;
                               END;
                                }
      { 666     ;2   ;Action    ;
                      Name=BlanketOrder;
                      CaptionML=[ENU=Blanket Order;
                                 NOR=Rammebestilling];
                      ToolTipML=[ENU=View the blanket sales order.;
                                 NOR=Vis rammeordren.];
                      Image=BlanketOrder;
                      OnAction=VAR
                                 SalesHeader@1000 : Record 36;
                                 BlanketSalesOrder@1001 : Page 507;
                               BEGIN
                                 TESTFIELD("Blanket Order No.");
                                 SalesHeader.SETRANGE("No.","Blanket Order No.");
                                 IF NOT SalesHeader.ISEMPTY THEN BEGIN
                                   BlanketSalesOrder.SETTABLEVIEW(SalesHeader);
                                   BlanketSalesOrder.EDITABLE := FALSE;
                                   BlanketSalesOrder.RUN;
                                 END;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the type of entity that will be posted for this sales line, such as Item, Resource, or G/L Account.;
                           NOR=Angir enhetstypen som skal bokf›res for denne salgslinjen, for eksempel vare, ressurs eller finanskonto.];
                SourceExpr=Type;
                OnValidate=BEGIN
                             NoOnAfterValidate;
                             SetLocationCodeMandatory;

                             IF xRec."No." <> '' THEN
                               RedistributeTotalsOnAfterValidate;
                           END;
                            }

    { 4   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of a general ledger account, item, resource, additional cost, or fixed asset, depending on the contents of the Type field.;
                           NOR=Angir nummeret til en finanskonto, en vare, en ressurs, en tilleggskostnad eller aktiva, avhengig av innholdet i feltet Type.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="No.";
                OnValidate=BEGIN
                             NoOnAfterValidate;
                             UpdateEditableOnRow;
                             ShowShortcutDimCode(ShortcutDimCode);

                             QuantityOnAfterValidate;
                             IF xRec."No." <> '' THEN
                               RedistributeTotalsOnAfterValidate;
                           END;
                            }

    { 68  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the cross-referenced item number. If you enter a cross reference between yours and your vendor's or customer's item number, then this number will override the standard item number when you enter the cross-reference number on a sales or purchase document.;
                           NOR=Angir varens kryssreferansenummer. Hvis du oppgir en kryssreferanse mellom ditt og leverand›rens eller kundens varenummer, vil dette nummeret overstyre standardvarenummeret n†r du oppgir kryssreferansenummeret i et salgs- eller kj›psdokument.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Cross-Reference No.";
                Visible=FALSE;
                OnValidate=BEGIN
                             NoOnAfterValidate;
                           END;

                OnLookup=BEGIN
                           CrossReferenceNoLookUp;
                           NoOnAfterValidate;
                         END;
                          }

    { 1136;2   ;Field     ;
                ToolTipML=[ENU=Specifies the IC partner code of the partner to whom you want to distribute the revenue of the sales line.;
                           NOR=Angi KI-partnerkoden for partneren som du vil distribuere inntektene for salgslinjen til.];
                SourceExpr="IC Partner Code";
                Visible=FALSE }

    { 130 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the item or account in your IC partner's company that corresponds to the item or account on the line.;
                           NOR=Angir varen eller kontoen i KI-partnerselskapet som tilsvarer varen eller kontoen p† linjen.];
                SourceExpr="IC Partner Ref. Type";
                Visible=FALSE }

    { 132 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the item or account in your IC partner's company that corresponds to the item or account on the line.;
                           NOR=Angir varen eller kontoen i KI-partnerselskapet som tilsvarer varen eller kontoen p† linjen.];
                SourceExpr="IC Partner Reference";
                Visible=FALSE }

    { 30  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a variant code for the item.;
                           NOR=Angir en variantkode for varen.];
                SourceExpr="Variant Code";
                Visible=FALSE;
                OnValidate=BEGIN
                             VariantCodeOnAfterValidate;
                           END;
                            }

    { 104 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies that a substitute is available for the item on the sales line.;
                           NOR=Angir at en erstatning er tilgjengelig for varen p† salgslinjen.];
                ApplicationArea=#Suite;
                SourceExpr="Substitution Available";
                Visible=FALSE }

    { 74  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the purchasing code for the item.;
                           NOR=Angir kj›pskoden for varen.];
                SourceExpr="Purchasing Code";
                Visible=FALSE }

    { 70  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies that this item is a nonstock item.;
                           NOR=Angir at denne varen er en katalogvare.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Nonstock;
                Visible=FALSE }

    { 78  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for the VAT product posting group of the item, resource, or general ledger account on this line.;
                           NOR=Angir koden for mva.-varebokf›ringsgruppen som gjelder for varen, ressursen eller finanskontoen p† linjen.];
                SourceExpr="VAT Prod. Posting Group";
                Visible=FALSE;
                OnValidate=BEGIN
                             RedistributeTotalsOnAfterValidate;
                           END;
                            }

    { 6   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a description of the entry, which is based on the contents of the Type and No. fields.;
                           NOR=Angir en beskrivelse av posten, som er basert p† innholdet i feltene Type og Nr.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Description;
                OnValidate=BEGIN
                             UpdateEditableOnRow;

                             IF "No." = xRec."No." THEN
                               EXIT;

                             NoOnAfterValidate;
                             ShowShortcutDimCode(ShortcutDimCode);
                             IF xRec."No." <> '' THEN
                               RedistributeTotalsOnAfterValidate;
                           END;

                ShowMandatory=TRUE;
                QuickEntry=FALSE }

    { 26  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies if your vendor will ship the items on the line directly to your customer.;
                           NOR=Angir om varene p† linjen skal leveres direkte fra leverand›ren til kunden.];
                ApplicationArea=#Suite;
                SourceExpr="Drop Shipment";
                Visible=FALSE }

    { 106 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies that the item on the sales line is a special-order item.;
                           NOR=Angir at varen p† salgslinjen er en vare som m† spesialbestilles.];
                SourceExpr="Special Order";
                Visible=FALSE }

    { 110 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a code that explains why the item is returned.;
                           NOR=Angir en kode som forklarer hvorfor varen ble returnert.];
                SourceExpr="Return Reason Code";
                Visible=FALSE }

    { 42  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the inventory location from which the items sold should be picked and where the inventory decrease is registered.;
                           NOR=Angir lagerlokasjonen som de solgte varene skal plukkes fra, og hvor lagerreduksjonen registreres.];
                SourceExpr="Location Code";
                Visible=LocationCodeVisible;
                OnValidate=BEGIN
                             LocationCodeOnAfterValidate;
                           END;

                ShowMandatory=LocationCodeMandatory;
                QuickEntry=FALSE }

    { 114 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the bin from where items on the sales order line are taken from when they are shipped.;
                           NOR=Angir hvilken hylle varene p† salgsordrelinjen skal hentes fra n†r de leveres.];
                SourceExpr="Bin Code";
                Visible=FALSE }

    { 50  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies whether a reservation can be made for items on this line.;
                           NOR=Angir om en reservasjon kan gj›res for varene p† denne linjen.];
                SourceExpr=Reserve;
                Visible=FALSE;
                OnValidate=BEGIN
                             ReserveOnAfterValidate;
                           END;
                            }

    { 8   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies how many units are being sold.;
                           NOR=Angir hvor mange enheter som selges.];
                ApplicationArea=#Basic,#Suite;
                BlankZero=Yes;
                SourceExpr=Quantity;
                Enabled=RowIsNotText;
                Editable=RowIsNotText;
                OnValidate=BEGIN
                             QuantityOnAfterValidate;
                             RedistributeTotalsOnAfterValidate;
                           END;

                ShowMandatory="No." <> '' }

    { 3   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies how many units of the sales line quantity that you want to supply by assembly.;
                           NOR=Angir hvor mange enheter av salgslinjeantallet som du vil forsyne gjennom montering.];
                BlankZero=Yes;
                SourceExpr="Qty. to Assemble to Order";
                Visible=FALSE;
                OnValidate=BEGIN
                             QtyToAsmToOrderOnAfterValidate;
                           END;

                OnDrillDown=BEGIN
                              ShowAsmToOrderLines;
                            END;
                             }

    { 48  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies how many units of the item on the line have been reserved.;
                           NOR=Angir hvor mange enheter av varen som er reservert p† linjen.];
                BlankZero=Yes;
                SourceExpr="Reserved Quantity";
                QuickEntry=FALSE }

    { 44  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the unit of measure that is used to determine the value in the Unit Price field on the sales line.;
                           NOR=Angir enheten som brukes til † fastsl† verdien i feltet Salgspris p† salgslinjen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Unit of Measure Code";
                Enabled=UnitofMeasureCodeIsChangeable;
                Editable=UnitofMeasureCodeIsChangeable;
                OnValidate=BEGIN
                             UnitofMeasureCodeOnAfterValida;
                             RedistributeTotalsOnAfterValidate;
                           END;

                QuickEntry=FALSE }

    { 10  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the unit of measure for the item or resource on the sales line.;
                           NOR=Angir enheten for varen eller ressursen p† salgslinjen.];
                SourceExpr="Unit of Measure";
                Visible=FALSE }

    { 38  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the unit cost of the item on the line.;
                           NOR=Angir enhetskosten for varen p† linjen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Unit Cost (LCY)";
                Visible=FALSE }

    { 112 ;2   ;Field     ;
                Name=SalesPriceExist;
                CaptionML=[ENU=Sales Price Exists;
                           NOR=Salgspris finnes];
                ToolTipML=[ENU=Specifies that there is a specific price for this customer.;
                           NOR=Angir at det finnes en bestemt pris for denne kunden.];
                SourceExpr=PriceExists;
                Visible=FALSE;
                Editable=FALSE }

    { 12  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the price for one unit on the sales line.;
                           NOR=Angir salgsprisen for ‚n enhet p† salgslinjen.];
                ApplicationArea=#Basic,#Suite;
                BlankZero=Yes;
                SourceExpr="Unit Price";
                Enabled=RowIsNotText;
                Editable=RowIsNotText;
                OnValidate=BEGIN
                             RedistributeTotalsOnAfterValidate;
                           END;

                ShowMandatory="No." <> '' }

    { 76  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the net amount (before subtracting the invoice discount amount) that must be paid for the items on the line.;
                           NOR=Angir nettobel›pet (f›r fakturarabattbel›pet trekkes fra) som skal betales for varene p† linjen.];
                ApplicationArea=#Basic,#Suite;
                BlankZero=Yes;
                SourceExpr="Line Amount";
                Enabled=RowIsNotText;
                Editable=RowIsNotText;
                OnValidate=BEGIN
                             RedistributeTotalsOnAfterValidate;
                           END;
                            }

    { 116 ;2   ;Field     ;
                Name=SalesLineDiscExists;
                CaptionML=[ENU=Sales Line Disc. Exists;
                           NOR=Salgslinjerab. finnes];
                ToolTipML=[ENU=Specifies that there is a specific discount for this customer.;
                           NOR=Angir at det finnes en bestemt rabatt for denne kunden.];
                SourceExpr=LineDiscExists;
                Visible=FALSE;
                Editable=FALSE }

    { 16  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the line discount percentage that is valid for the item quantity on the line.;
                           NOR=Angir linjerabattprosenten som blir gitt for vareantallet p† linjen.];
                ApplicationArea=#Basic,#Suite;
                BlankZero=Yes;
                SourceExpr="Line Discount %";
                Enabled=RowIsNotText;
                Editable=RowIsNotText;
                OnValidate=BEGIN
                             RedistributeTotalsOnAfterValidate;
                           END;
                            }

    { 52  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the amount of the discount that will be given on the invoice line.;
                           NOR=Angir rabattbel›pet som gis p† fakturalinjen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Line Discount Amount";
                Visible=FALSE;
                OnValidate=BEGIN
                             RedistributeTotalsOnAfterValidate;
                           END;
                            }

    { 136 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the prepayment percentage if a prepayment should apply to the sales line.;
                           NOR=Angir forskuddsprosenten hvis et forskudd skal gjelde for salgslinjen.];
                SourceExpr="Prepayment %";
                Visible=FALSE;
                OnValidate=BEGIN
                             RedistributeTotalsOnAfterValidate;
                           END;
                            }

    { 138 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the prepayment amount of the line in the currency of the sales document if a prepayment percentage is specified for the sales line.;
                           NOR=Angir forskuddsbel›pet for linjen i valutaen som gjelder for salgsdokumentet hvis det er angitt en forskuddsprosent for salgslinjen.];
                SourceExpr="Prepmt. Line Amount";
                Visible=FALSE;
                OnValidate=BEGIN
                             RedistributeTotalsOnAfterValidate;
                           END;
                            }

    { 140 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the prepayment amount that has already been invoiced to the customer for this sales line.;
                           NOR=Angir forskuddsbel›pet som allerede er fakturert til kunden for denne salgslinjen.];
                SourceExpr="Prepmt. Amt. Inv.";
                Visible=FALSE;
                OnValidate=BEGIN
                             RedistributeTotalsOnAfterValidate;
                           END;
                            }

    { 54  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies whether the invoice line is included when the invoice discount is calculated.;
                           NOR=Angir om fakturalinjen er inkludert n†r fakturarabatten beregnes.];
                SourceExpr="Allow Invoice Disc.";
                Visible=FALSE }

    { 90  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the invoice discount amount for the line.;
                           NOR=Angir fakturarabattbel›pet for linjen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Inv. Discount Amount";
                Visible=FALSE }

    { 18  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies how many units of the item are to be shipped when the sales order is posted.;
                           NOR=Angir hvor mange enheter av varen som skal leveres n†r ordren bokf›res.];
                ApplicationArea=#Basic,#Suite;
                BlankZero=Yes;
                SourceExpr="Qty. to Ship";
                OnValidate=BEGIN
                             IF "Qty. to Asm. to Order (Base)" <> 0 THEN BEGIN
                               CurrPage.SAVERECORD;
                               CurrPage.UPDATE(FALSE);
                             END;
                           END;
                            }

    { 20  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of units of the ordered item that have been shipped.;
                           NOR=Angir hvor mange enheter av den bestilte varen som er levert.];
                ApplicationArea=#Basic,#Suite;
                BlankZero=Yes;
                SourceExpr="Quantity Shipped";
                QuickEntry=FALSE }

    { 22  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies how much of the line should be invoiced.;
                           NOR=Angir hvor mye av linjen som skal faktureres.];
                ApplicationArea=#Basic,#Suite;
                BlankZero=Yes;
                SourceExpr="Qty. to Invoice" }

    { 24  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies how many units of the item on the line have already been invoiced.;
                           NOR=Angir hvor mange enheter av varen som allerede er fakturert p† linjen.];
                ApplicationArea=#Basic,#Suite;
                BlankZero=Yes;
                SourceExpr="Quantity Invoiced" }

    { 142 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the prepayment amount that will be deducted from the next ordinary invoice for this line.;
                           NOR=Angir forskuddsbel›pet som blir trukket fra den neste ordin‘re fakturaen for denne linjen.];
                SourceExpr="Prepmt Amt to Deduct";
                Visible=FALSE }

    { 144 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the prepayment amount that has already been deducted from ordinary invoices posted for this sales order line.;
                           NOR=Angir forskuddsbel›pet som allerede er trukket fra ordin‘re fakturaer som er bokf›rt for denne ordrelinjen.];
                SourceExpr="Prepmt Amt Deducted";
                Visible=FALSE }

    { 46  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies that you can assign item charges to this line.;
                           NOR=Angir at du kan tilordne varegebyr til denne linjen.];
                SourceExpr="Allow Item Charge Assignment";
                Visible=FALSE }

    { 5800;2   ;Field     ;
                ToolTipML=[ENU=Specifies the quantity of the item charge that will be assigned to a specified item when you post this sales line. You fill this field through the Qty. to Assign field in the Item Charge Assignment (Sales) window that you open with the Item Charge Assignment action on the Lines FastTab.;
                           NOR=Angir antallet for varegebyret som blir tilordnet til en angitt vare n†r du bokf›rer denne salgslinjen. Du fyller ut dette feltet via feltet Ant. som skal tilordnes i vinduet Varegebyrtilordning (salg), som du †pner med handlingen Varegebyrtilordning i hurtigfanen Linjer.];
                BlankZero=Yes;
                SourceExpr="Qty. to Assign";
                OnDrillDown=BEGIN
                              CurrPage.SAVERECORD;
                              ShowItemChargeAssgnt;
                              UpdateForm(FALSE);
                            END;

                QuickEntry=FALSE }

    { 102 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the quantity of the item charge that was assigned to a specified item when you posted this sales line.;
                           NOR=Angir antallet av varegebyret som ble tilordnet til en bestemt vare da du bokf›rte salgslinjen.];
                BlankZero=Yes;
                SourceExpr="Qty. Assigned";
                OnDrillDown=BEGIN
                              CurrPage.SAVERECORD;
                              ShowItemChargeAssgnt;
                              CurrPage.UPDATE(FALSE);
                            END;

                QuickEntry=FALSE }

    { 82  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date that the customer has asked for the order to be delivered.;
                           NOR=Angir p† hvilken dato kunden har bedt om at ordren skal leveres.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Requested Delivery Date";
                Visible=FALSE;
                OnValidate=BEGIN
                             UpdateForm(TRUE);
                           END;
                            }

    { 84  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date that you have promised to deliver the order, as a result of the Order Promising function.;
                           NOR=Angir datoen da du har lovet † levere ordren som et resultat av funksjonen Ordrebekreftelse.];
                SourceExpr="Promised Delivery Date";
                Visible=FALSE;
                OnValidate=BEGIN
                             UpdateForm(TRUE);
                           END;
                            }

    { 86  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the planned date that the shipment will be delivered at the customer's address.;
                           NOR=Angir planlagt dato for n†r leveringen skal leveres til kundens adresse.];
                SourceExpr="Planned Delivery Date";
                OnValidate=BEGIN
                             UpdateForm(TRUE);
                           END;

                QuickEntry=FALSE }

    { 88  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date that the shipment should ship from the warehouse.;
                           NOR=Angir datoen for n†r leveringen skal sendes fra lageret.];
                SourceExpr="Planned Shipment Date";
                OnValidate=BEGIN
                             UpdateForm(TRUE);
                           END;
                            }

    { 100 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date that the items on the line are in inventory and available to be picked.;
                           NOR=Angir datoen for n†r varene p† linjen finnes p† lager og er tilgjengelig for plukking.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Shipment Date";
                OnValidate=BEGIN
                             ShipmentDateOnAfterValidate;
                           END;

                QuickEntry=FALSE }

    { 92  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code that represents the shipping agent.;
                           NOR=Angir koden som representerer transport›ren.];
                ApplicationArea=#Suite;
                SourceExpr="Shipping Agent Code";
                Visible=FALSE }

    { 94  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code that represents a shipping agent service.;
                           NOR=Angir koden som representerer en transport›rtjeneste.];
                ApplicationArea=#Suite;
                SourceExpr="Shipping Agent Service Code";
                Visible=FALSE }

    { 96  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies how long it takes from when the sales order line is shipped from the warehouse to when the order is delivered.;
                           NOR=Angir hvor lang tid det tar fra ordren leveres fra lageret til ordrelinjen er levert til kundens adresse.];
                SourceExpr="Shipping Time";
                Visible=FALSE }

    { 134 ;2   ;Field     ;
                ToolTipML=[ENU=Belongs to the Job application area.;
                           NOR=H›rer til modulen Prosjekt.];
                SourceExpr="Work Type Code";
                Visible=FALSE }

    { 17  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies how many units on the sales order line remain to be handled in warehouse documents.;
                           NOR=Angir hvor mange enheter p† ordrelinjen som fremdeles m† h†ndteres i lagerdokumenter.];
                SourceExpr="Whse. Outstanding Qty.";
                Visible=FALSE }

    { 58  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies how many units on the sales order line remain to be handled in warehouse documents.;
                           NOR=Angir hvor mange enheter p† ordrelinjen som fremdeles m† h†ndteres i lagerdokumenter.];
                SourceExpr="Whse. Outstanding Qty. (Base)";
                Visible=FALSE }

    { 19  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies how many assemble-to-order units on the sales order line need to be assembled and handled in warehouse documents.;
                           NOR=Angir hvor mange monter-til-ordre-enheter p† salgsordrelinjen som m† monteres og h†ndteres i lagerdokumenter.];
                SourceExpr="ATO Whse. Outstanding Qty.";
                Visible=FALSE }

    { 21  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies how many assemble-to-order units on the sales order line remain to be assembled and handled in warehouse documents.;
                           NOR=Angir hvor mange monter-til-ordre-enheter p† ordrelinjen som m† monteres og h†ndteres i lagerdokumenter.];
                SourceExpr="ATO Whse. Outstd. Qty. (Base)";
                Visible=FALSE }

    { 98  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the outbound warehouse handling time.;
                           NOR=Angir utg†ende lagerbehandlingstid.];
                SourceExpr="Outbound Whse. Handling Time";
                Visible=FALSE }

    { 62  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the document number of the blanket order from which this sales line originates.;
                           NOR=Angir dokumentnummeret til rammeordren som denne ordrelinjen stammer fra.];
                SourceExpr="Blanket Order No.";
                Visible=FALSE }

    { 66  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the line number of the blanket order line from which this sales line originates.;
                           NOR=Angir linjenummeret til rammebestillingslinjen som denne salgslinjen stammer fra.];
                SourceExpr="Blanket Order Line No.";
                Visible=FALSE }

    { 14  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date that will be used as the FA posting date on FA ledger entries.;
                           NOR=Angir datoen som skal brukes som aktivabokf›ringsdatoen i aktivaposter.];
                SourceExpr="FA Posting Date";
                Visible=FALSE }

    { 40  ;2   ;Field     ;
                ToolTipML=[ENU=You can use this field if you have selected Fixed Asset in the Type field for this line.;
                           NOR=Du kan bruke dette feltet hvis du har valgt Aktiva i feltet Type for denne linjen.];
                SourceExpr="Depr. until FA Posting Date";
                Visible=FALSE }

    { 36  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for the depreciation book to which the line will be posted if you have selected Fixed Asset in the Type field for this line.;
                           NOR=Angir koden for avskrivningstabl†et som linjen skal bokf›res i hvis du har valgt Aktiva i feltet Type for denne linjen.];
                SourceExpr="Depreciation Book Code";
                Visible=FALSE }

    { 80  ;2   ;Field     ;
                ToolTipML=[ENU=You can use this field if you have selected Fixed Asset in the Type field for this line.;
                           NOR=Du kan bruke dette feltet hvis du har valgt Aktiva i feltet Type for denne linjen.];
                SourceExpr="Use Duplication List";
                Visible=FALSE }

    { 56  ;2   ;Field     ;
                ToolTipML=[ENU=You can use this field if you have selected Fixed Asset in the Type field for this line.;
                           NOR=Du kan bruke dette feltet hvis du har valgt Aktiva i feltet Type for denne linjen.];
                SourceExpr="Duplicate in Depreciation Book";
                Visible=FALSE }

    { 108 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the item ledger entry that the sales credit memo line is applied from.;
                           NOR=Angir nummeret p† vareposten som salgskreditnotalinjen er utlignet fra.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Appl.-from Item Entry";
                Visible=FALSE }

    { 60  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the item ledger entry number the line should be applied to.;
                           NOR=Angir varepostnummeret som linjen skal utlignes mot.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Appl.-to Item Entry";
                Visible=FALSE }

    { 29  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the deferral template that governs how revenue earned with this sales document is deferred to the different accounting periods when the good or service was delivered.;
                           NOR=Angir periodiseringsmalen som styrer hvordan inntekter fra dette salgsdokumentet periodiseres til de ulike regnskapsperiodene n†r varen eller servicen ble levert.];
                ApplicationArea=#Suite;
                SourceExpr="Deferral Code";
                TableRelation="Deferral Template"."Deferral Code";
                Visible=FALSE;
                Enabled=(Type <> Type::"Fixed Asset") AND (Type <> Type::" ") }

    { 32  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for Shortcut Dimension 1.;
                           NOR=Angir koden for Snarveisdimensjon 1.];
                ApplicationArea=#Suite;
                SourceExpr="Shortcut Dimension 1 Code";
                Visible=FALSE }

    { 34  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for Shortcut Dimension 2.;
                           NOR=Angir koden for Snarveisdimensjon 2.];
                ApplicationArea=#Suite;
                SourceExpr="Shortcut Dimension 2 Code";
                Visible=FALSE }

    { 300 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[3];
                CaptionClass='1,2,3';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(3),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(3,ShortcutDimCode[3]);
                           END;
                            }

    { 302 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[4];
                CaptionClass='1,2,4';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(4),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(4,ShortcutDimCode[4]);
                           END;
                            }

    { 304 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[5];
                CaptionClass='1,2,5';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(5),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateSaveShortcutDimCode(5,ShortcutDimCode[5]);
                           END;
                            }

    { 306 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[6];
                CaptionClass='1,2,6';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(6),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateSaveShortcutDimCode(6,ShortcutDimCode[6]);
                           END;
                            }

    { 308 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[7];
                CaptionClass='1,2,7';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(7),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateSaveShortcutDimCode(7,ShortcutDimCode[7]);
                           END;
                            }

    { 1101103000;2;Field  ;
                SourceExpr="Gross Weight";
                Editable=FALSE }

    { 1101103001;2;Field  ;
                SourceExpr="Unit Volume";
                Editable=FALSE }

    { 310 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[8];
                CaptionClass='1,2,8';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(8),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateSaveShortcutDimCode(8,ShortcutDimCode[8]);
                           END;
                            }

    { 146 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the document number.;
                           NOR=Angir dokumentnummeret.];
                SourceExpr="Document No.";
                Visible=FALSE;
                Editable=FALSE }

    { 148 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the line number.;
                           NOR=Angir linjenummeret.];
                SourceExpr="Line No.";
                Visible=FALSE;
                Editable=FALSE }

    { 1080002;2;Field     ;
                ToolTipML=[ENU=Specifies the account code of the customer.;
                           NOR=Angir kontokoden for kunden.];
                SourceExpr="Account Code";
                Visible=FALSE }

    { 51  ;1   ;Group     ;
                GroupType=Group }

    { 45  ;2   ;Group     ;
                GroupType=Group }

    { 35  ;3   ;Field     ;
                CaptionML=[ENU=Subtotal Excl. VAT;
                           NOR=Delsum ekskl. mva];
                ToolTipML=[ENU=Specifies the sum of the value in the Line Amount Excl. VAT field on all lines in the document.;
                           NOR=Angir summen av verdien i feltet Linjebel›p ekskl. mva p† alle linjer i dokumentet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=TotalSalesLine."Line Amount";
                AutoFormatType=1;
                AutoFormatExpr=Currency.Code;
                CaptionClass=DocumentTotals.GetTotalLineAmountWithVATAndCurrencyCaption(Currency.Code,TotalSalesHeader."Prices Including VAT");
                Editable=FALSE }

    { 43  ;3   ;Field     ;
                Name=Invoice Discount Amount;
                CaptionML=[ENU=Invoice Discount Amount;
                           NOR=Fakturarabattbel›p];
                ToolTipML=[ENU=Specifies a discount amount that is deducted from the value in the Total Incl. VAT field. You can enter or change the amount manually.;
                           NOR=Angir et rabattbel›p som blir trukket fra verdien i feltet Totalt inkl. mva. Du kan oppgi eller endre bel›pet manuelt.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=InvoiceDiscountAmount;
                AutoFormatType=1;
                AutoFormatExpr=Currency.Code;
                CaptionClass=DocumentTotals.GetInvoiceDiscAmountWithVATAndCurrencyCaption(FIELDCAPTION("Inv. Discount Amount"),Currency.Code);
                Editable=InvDiscAmountEditable;
                OnValidate=BEGIN
                             ValidateInvoiceDiscountAmount;
                           END;
                            }

    { 41  ;3   ;Field     ;
                Name=Invoice Disc. Pct.;
                CaptionML=[ENU=Invoice Discount %;
                           NOR=Fakturarabatt %];
                ToolTipML=[ENU=Specifies a discount percentage that is granted if criteria that you have set up for the customer are met.;
                           NOR=Angir en rabattprosent som gis hvis kriteriene du har definert for kunden, oppfylles.];
                ApplicationArea=#Basic,#Suite;
                DecimalPlaces=0:2;
                SourceExpr=InvoiceDiscountPct;
                Editable=InvDiscAmountEditable;
                OnValidate=BEGIN
                             InvoiceDiscountAmount := ROUND(TotalSalesLine."Line Amount" * InvoiceDiscountPct / 100,Currency."Amount Rounding Precision");
                             ValidateInvoiceDiscountAmount;
                           END;
                            }

    { 28  ;2   ;Group     ;
                GroupType=Group }

    { 27  ;3   ;Field     ;
                Name=Total Amount Excl. VAT;
                DrillDown=No;
                CaptionML=[ENU=Total Amount Excl. VAT;
                           NOR=Totalbel›p ekskl. mva];
                ToolTipML=[ENU=Specifies the sum of the value in the Line Amount Excl. VAT field on all lines in the document minus any discount amount in the Invoice Discount Amount field.;
                           NOR=Angir summen av verdien i feltet Linjebel›p ekskl. MVA p† alle linjer i dokumentet, minus eventuelle rabattbel›p i feltet Fakturarabattbel›p.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=TotalSalesLine.Amount;
                AutoFormatType=1;
                AutoFormatExpr=Currency.Code;
                CaptionClass=DocumentTotals.GetTotalExclVATCaption(Currency.Code);
                Editable=FALSE }

    { 25  ;3   ;Field     ;
                Name=Total VAT Amount;
                CaptionML=[ENU=Total VAT;
                           NOR=Total mva];
                ToolTipML=[ENU=Specifies the sum of VAT amounts on all lines in the document.;
                           NOR=Angir summen av mva-bel›pene p† alle linjene i dokumentet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=VATAmount;
                AutoFormatType=1;
                AutoFormatExpr=Currency.Code;
                CaptionClass=DocumentTotals.GetTotalVATCaption(Currency.Code);
                Editable=FALSE }

    { 23  ;3   ;Field     ;
                Name=Total Amount Incl. VAT;
                CaptionML=[ENU=Total Amount Incl. VAT;
                           NOR=Totalbel›p inkl. mva];
                ToolTipML=[ENU=Specifies the sum of the value in the Line Amount Incl. VAT field on all lines in the document minus any discount amount in the Invoice Discount Amount field.;
                           NOR=Angir summen av verdien i feltet Linjebel›p inkl. MVA p† alle linjer i dokumentet, minus eventuelle rabattbel›p i feltet Fakturarabattbel›p.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=TotalSalesLine."Amount Including VAT";
                AutoFormatType=1;
                AutoFormatExpr=Currency.Code;
                CaptionClass=DocumentTotals.GetTotalInclVATCaption(Currency.Code);
                Editable=FALSE }

  }
  CODE
  {
    VAR
      Currency@1021 : Record 4;
      TotalSalesHeader@1016 : Record 36;
      TotalSalesLine@1009 : Record 37;
      SalesHeader@1000 : Record 36;
      ApplicationAreaSetup@1010 : Record 9178;
      SalesSetup@1015 : Record 311;
      SalesPriceCalcMgt@1006 : Codeunit 7000;
      TransferExtendedText@1002 : Codeunit 378;
      ItemAvailFormsMgt@1001 : Codeunit 353;
      SalesCalcDiscountByType@1008 : Codeunit 56;
      DocumentTotals@1007 : Codeunit 57;
      VATAmount@1005 : Decimal;
      ShortcutDimCode@1003 : ARRAY [8] OF Code[20];
      Text001@1004 : TextConst 'ENU=You cannot use the Explode BOM function because a prepayment of the sales order has been invoiced.;NOR=Du kan ikke bruke funksjonen Utfold stykkliste fordi det er fakturert et forskudd p† ordren.';
      LocationCodeMandatory@1017 : Boolean;
      InvDiscAmountEditable@1014 : Boolean;
      RowIsNotText@1019 : Boolean;
      UnitofMeasureCodeIsChangeable@1011 : Boolean;
      LocationCodeVisible@1020 : Boolean;
      InvoiceDiscountAmount@1022 : Decimal;
      InvoiceDiscountPct@1023 : Decimal;

    PROCEDURE ApproveCalcInvDisc@1();
    BEGIN
      CODEUNIT.RUN(CODEUNIT::"Sales-Disc. (Yes/No)",Rec);
    END;

    LOCAL PROCEDURE ValidateInvoiceDiscountAmount@30();
    VAR
      SalesHeader@1000 : Record 36;
    BEGIN
      SalesHeader.GET("Document Type","Document No.");
      SalesCalcDiscountByType.ApplyInvDiscBasedOnAmt(InvoiceDiscountAmount,SalesHeader);
      CurrPage.UPDATE(FALSE);
    END;

    PROCEDURE CalcInvDisc@6();
    BEGIN
      CODEUNIT.RUN(CODEUNIT::"Sales-Calc. Discount",Rec);
    END;

    PROCEDURE ExplodeBOM@3();
    BEGIN
      IF "Prepmt. Amt. Inv." <> 0 THEN
        ERROR(Text001);
      CODEUNIT.RUN(CODEUNIT::"Sales-Explode BOM",Rec);
    END;

    PROCEDURE OpenPurchOrderForm@4();
    VAR
      PurchHeader@1000 : Record 38;
      PurchOrder@1001 : Page 50;
    BEGIN
      TESTFIELD("Purchase Order No.");
      PurchHeader.SETRANGE("No.","Purchase Order No.");
      PurchOrder.SETTABLEVIEW(PurchHeader);
      PurchOrder.EDITABLE := FALSE;
      PurchOrder.RUN;
    END;

    PROCEDURE OpenSpecialPurchOrderForm@14();
    VAR
      PurchHeader@1001 : Record 38;
      PurchRcptHeader@1002 : Record 120;
      PurchOrder@1000 : Page 50;
    BEGIN
      TESTFIELD("Special Order Purchase No.");
      PurchHeader.SETRANGE("No.","Special Order Purchase No.");
      IF NOT PurchHeader.ISEMPTY THEN BEGIN
        PurchOrder.SETTABLEVIEW(PurchHeader);
        PurchOrder.EDITABLE := FALSE;
        PurchOrder.RUN;
      END ELSE BEGIN
        PurchRcptHeader.SETRANGE("Order No.","Special Order Purchase No.");
        IF PurchRcptHeader.COUNT = 1 THEN
          PAGE.RUN(PAGE::"Posted Purchase Receipt",PurchRcptHeader)
        ELSE
          PAGE.RUN(PAGE::"Posted Purchase Receipts",PurchRcptHeader);
      END;
    END;

    PROCEDURE InsertExtendedText@5(Unconditionally@1000 : Boolean);
    BEGIN
      IF TransferExtendedText.SalesCheckIfAnyExtText(Rec,Unconditionally) THEN BEGIN
        CurrPage.SAVERECORD;
        COMMIT;
        TransferExtendedText.InsertSalesExtText(Rec);
      END;
      IF TransferExtendedText.MakeUpdate THEN
        UpdateForm(TRUE);
    END;

    PROCEDURE ShowNonstockItems@11();
    BEGIN
      ShowNonstock;
    END;

    PROCEDURE ShowTracking@13();
    VAR
      TrackingForm@1000 : Page 99000822;
    BEGIN
      TrackingForm.SetSalesLine(Rec);
      TrackingForm.RUNMODAL;
    END;

    PROCEDURE ItemChargeAssgnt@5800();
    BEGIN
      ShowItemChargeAssgnt;
    END;

    PROCEDURE UpdateForm@12(SetSaveRecord@1000 : Boolean);
    BEGIN
      CurrPage.UPDATE(SetSaveRecord);
    END;

    PROCEDURE ShowPrices@15();
    BEGIN
      SalesHeader.GET("Document Type","Document No.");
      CLEAR(SalesPriceCalcMgt);
      SalesPriceCalcMgt.GetSalesLinePrice(SalesHeader,Rec);
    END;

    PROCEDURE ShowLineDisc@16();
    BEGIN
      SalesHeader.GET("Document Type","Document No.");
      CLEAR(SalesPriceCalcMgt);
      SalesPriceCalcMgt.GetSalesLineLineDisc(SalesHeader,Rec);
    END;

    PROCEDURE OrderPromisingLine@17();
    VAR
      OrderPromisingLine@1000 : TEMPORARY Record 99000880;
      OrderPromisingLines@1001 : Page 99000959;
    BEGIN
      OrderPromisingLine.SETRANGE("Source Type","Document Type");
      OrderPromisingLine.SETRANGE("Source ID","Document No.");
      OrderPromisingLine.SETRANGE("Source Line No.","Line No.");

      OrderPromisingLines.SetSourceType(OrderPromisingLine."Source Type"::Sales);
      OrderPromisingLines.SETTABLEVIEW(OrderPromisingLine);
      OrderPromisingLines.RUNMODAL;
    END;

    LOCAL PROCEDURE NoOnAfterValidate@19066594();
    BEGIN
      IF ApplicationAreaSetup.IsFoundationEnabled THEN
        TESTFIELD(Type,Type::Item);

      InsertExtendedText(FALSE);
      IF (Type = Type::"Charge (Item)") AND ("No." <> xRec."No.") AND
         (xRec."No." <> '')
      THEN
        CurrPage.SAVERECORD;

      SaveAndAutoAsmToOrder;

      IF Reserve = Reserve::Always THEN BEGIN
        CurrPage.SAVERECORD;
        IF ("Outstanding Qty. (Base)" <> 0) AND ("No." <> xRec."No.") THEN BEGIN
          AutoReserve;
          CurrPage.UPDATE(FALSE);
        END;
      END;
    END;

    LOCAL PROCEDURE VariantCodeOnAfterValidate@21();
    BEGIN
      SaveAndAutoAsmToOrder;
    END;

    LOCAL PROCEDURE LocationCodeOnAfterValidate@19034787();
    BEGIN
      SaveAndAutoAsmToOrder;

      IF (Reserve = Reserve::Always) AND
         ("Outstanding Qty. (Base)" <> 0) AND
         ("Location Code" <> xRec."Location Code")
      THEN BEGIN
        CurrPage.SAVERECORD;
        AutoReserve;
        CurrPage.UPDATE(FALSE);
      END;
    END;

    LOCAL PROCEDURE ReserveOnAfterValidate@19004502();
    BEGIN
      IF (Reserve = Reserve::Always) AND ("Outstanding Qty. (Base)" <> 0) THEN BEGIN
        CurrPage.SAVERECORD;
        AutoReserve;
        CurrPage.UPDATE(FALSE);
      END;
    END;

    LOCAL PROCEDURE QuantityOnAfterValidate@19032465();
    VAR
      UpdateIsDone@1001 : Boolean;
    BEGIN
      IF Type = Type::Item THEN
        CASE Reserve OF
          Reserve::Always:
            BEGIN
              CurrPage.SAVERECORD;
              AutoReserve;
              CurrPage.UPDATE(FALSE);
              UpdateIsDone := TRUE;
            END;
          Reserve::Optional:
            IF (Quantity < xRec.Quantity) AND (xRec.Quantity > 0) THEN BEGIN
              CurrPage.SAVERECORD;
              CurrPage.UPDATE(FALSE);
              UpdateIsDone := TRUE;
            END;
        END;

      IF (Type = Type::Item) AND
         (Quantity <> xRec.Quantity) AND
         NOT UpdateIsDone
      THEN
        CurrPage.UPDATE(TRUE);
    END;

    LOCAL PROCEDURE QtyToAsmToOrderOnAfterValidate@19();
    BEGIN
      CurrPage.SAVERECORD;
      IF Reserve = Reserve::Always THEN
        AutoReserve;
      CurrPage.UPDATE(TRUE);
    END;

    LOCAL PROCEDURE UnitofMeasureCodeOnAfterValida@19057939();
    BEGIN
      IF Reserve = Reserve::Always THEN BEGIN
        CurrPage.SAVERECORD;
        AutoReserve;
        CurrPage.UPDATE(FALSE);
      END;
    END;

    LOCAL PROCEDURE ShipmentDateOnAfterValidate@19068710();
    BEGIN
      IF (Reserve = Reserve::Always) AND
         ("Outstanding Qty. (Base)" <> 0) AND
         ("Shipment Date" <> xRec."Shipment Date")
      THEN BEGIN
        CurrPage.SAVERECORD;
        AutoReserve;
        CurrPage.UPDATE(FALSE);
      END ELSE
        CurrPage.UPDATE(TRUE);
    END;

    LOCAL PROCEDURE SaveAndAutoAsmToOrder@20();
    BEGIN
      IF (Type = Type::Item) AND IsAsmToOrderRequired THEN BEGIN
        CurrPage.SAVERECORD;
        AutoAsmToOrder;
        CurrPage.UPDATE(FALSE);
      END;
    END;

    LOCAL PROCEDURE SetLocationCodeMandatory@22();
    VAR
      InventorySetup@1000 : Record 313;
    BEGIN
      InventorySetup.GET;
      LocationCodeMandatory := InventorySetup."Location Mandatory" AND (Type = Type::Item);
    END;

    LOCAL PROCEDURE GetTotalSalesHeader@9();
    BEGIN
      IF NOT TotalSalesHeader.GET("Document Type","Document No.") THEN
        CLEAR(TotalSalesHeader);
      IF Currency.Code <> TotalSalesHeader."Currency Code" THEN
        IF NOT Currency.GET(TotalSalesHeader."Currency Code") THEN
          Currency.InitRoundingPrecision;
    END;

    LOCAL PROCEDURE CalculateTotals@8();
    BEGIN
      GetTotalSalesHeader;
      TotalSalesHeader.CALCFIELDS("Recalculate Invoice Disc.");

      IF SalesSetup."Calc. Inv. Discount" AND ("Document No." <> '') AND (TotalSalesHeader."Customer Posting Group" <> '') AND
         TotalSalesHeader."Recalculate Invoice Disc."
      THEN
        CalcInvDisc;

      DocumentTotals.CalculateSalesTotals(TotalSalesLine,VATAmount,Rec);
      InvoiceDiscountAmount := TotalSalesLine."Inv. Discount Amount";
      InvoiceDiscountPct := SalesCalcDiscountByType.GetCustInvoiceDiscountPct(Rec);
    END;

    LOCAL PROCEDURE RedistributeTotalsOnAfterValidate@2();
    BEGIN
      CurrPage.SAVERECORD;

      SalesHeader.GET("Document Type","Document No.");
      DocumentTotals.SalesRedistributeInvoiceDiscountAmounts(Rec,VATAmount,TotalSalesLine);
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE ValidateSaveShortcutDimCode@7(FieldNumber@1001 : Integer;VAR ShortcutDimCode@1000 : Code[20]);
    BEGIN
      ValidateShortcutDimCode(FieldNumber,ShortcutDimCode);
      CurrPage.SAVERECORD;
    END;

    LOCAL PROCEDURE UpdateEditableOnRow@18();
    VAR
      SalesLine@1000 : Record 37;
    BEGIN
      RowIsNotText := NOT (("No." = '') AND (Description <> ''));
      IF RowIsNotText THEN
        UnitofMeasureCodeIsChangeable := CanEditUnitOfMeasureCode
      ELSE
        UnitofMeasureCodeIsChangeable := FALSE;

      IF TotalSalesHeader."No." <> '' THEN BEGIN
        SalesLine.SETRANGE("Document No.",TotalSalesHeader."No.");
        SalesLine.SETRANGE("Document Type",TotalSalesHeader."Document Type");
        IF NOT SalesLine.ISEMPTY THEN
          InvDiscAmountEditable :=
            SalesCalcDiscountByType.InvoiceDiscIsAllowed(TotalSalesHeader."Invoice Disc. Code") AND CurrPage.EDITABLE;
      END;
    END;

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 17.11.16 JAL Commentet out code which modifies the header record.
    }
    END.
  }
}

OBJECT Page 83034 Shceduled Tasks
{
  OBJECT-PROPERTIES
  {
    Date=02.11.16;
    Time=16.26.09;
    Modified=Yes;
    Version List=OPC;
  }
  PROPERTIES
  {
    SourceTable=Table2000000175;
    PageType=List;
  }
  CONTROLS
  {
    { 1101103000;0;Container;
                ContainerType=ContentArea }

    { 1101103001;1;Group  ;
                Name=Group;
                GroupType=Repeater }

    { 1101103002;2;Field  ;
                SourceExpr=ID }

    { 1101103003;2;Field  ;
                SourceExpr="User ID" }

    { 1101103004;2;Field  ;
                SourceExpr="User Name" }

    { 1101103005;2;Field  ;
                SourceExpr="User Language ID" }

    { 1101103006;2;Field  ;
                SourceExpr="User Format ID" }

    { 1101103007;2;Field  ;
                SourceExpr="User Time Zone" }

    { 1101103008;2;Field  ;
                SourceExpr=Company }

    { 1101103009;2;Field  ;
                SourceExpr="Is Ready" }

    { 1101103010;2;Field  ;
                SourceExpr="Not Before" }

    { 1101103011;2;Field  ;
                SourceExpr="Run Codeunit" }

    { 1101103012;2;Field  ;
                SourceExpr="Failure Codeunit" }

    { 1101103013;2;Field  ;
                SourceExpr=FORMAT(Record) }

  }
  CODE
  {

    BEGIN
    END.
  }
}

