OBJECT Table 70000 Integration To Compello Setup
{
  OBJECT-PROPERTIES
  {
    Date=01.10.16;
    Time=11:00:00;
    Modified=Yes;
    Version List=CMP2.00;
  }
  PROPERTIES
  {
    CaptionML=ENU=Integration To Compello Setup;
  }
  FIELDS
  {
    { 1   ;   ;Primary Key         ;Text1         ;CaptionML=ENU=Primary Key }
    { 21  ;   ;Max. No. of Tries   ;Integer       ;InitValue=1;
                                                   CaptionML=[ENU=Max. No. of Tries;
                                                              NOR=Maks Antall fors›k] }
    { 31  ;   ;Max No. of Rec. per Transact.;Integer;
                                                   CaptionML=ENU=Max No. of Rec. per Transact. }
    { 51  ;   ;Integr. Table Nos.  ;Code10        ;TableRelation="No. Series".Code;
                                                   CaptionML=ENU=Integr. Table Nos. }
    { 61  ;   ;Web Service Address ;Text250       ;ExtendedDatatype=URL;
                                                   CaptionML=ENU=Web Service Address }
    { 62  ;   ;Customer ID         ;Text20        ;CaptionML=ENU=Customer ID }
    { 63  ;   ;User Name           ;Text50        ;CaptionML=ENU=User Name }
    { 64  ;   ;Password            ;Text50        ;ExtendedDatatype=Masked;
                                                   CaptionML=ENU=Password }
    { 65  ;   ;Client ID           ;Text10        ;CaptionML=ENU=Client ID }
    { 71  ;   ;URL for Export Log  ;Text250       ;CaptionML=ENU=URL for Export Log }
    { 200 ;   ;Authentication Code ;Option        ;InitValue=A;
                                                   CaptionML=[ENU=Authentication Code;
                                                              NOR=Gjodkenningskode];
                                                   OptionCaptionML=[ENU=A,N;
                                                                    NOR=A,N];
                                                   OptionString=A,N }
    { 210 ;   ;XLS File Path       ;Text250       ;CaptionML=[ENU=XLS File Path;
                                                              NOR=XLS Filsti] }
    { 220 ;   ;Image File Stylesheet;Text250      ;CaptionML=[ENU=Image File Stylesheet;
                                                              NOR=Stylesheet for bilde] }
    { 230 ;   ;XML Folder          ;Text250       ;OnValidate=BEGIN
                                                                CheckLocalFolderPath("XML Folder");
                                                              END;

                                                   CaptionML=[ENU=XML Folder;
                                                              NOR=XML Mappe] }
    { 240 ;   ;XML Folder Archive  ;Text250       ;OnValidate=BEGIN
                                                                CheckLocalFolderPath("XML Folder Archive");
                                                              END;

                                                   CaptionML=[ENU=XML Folder Archive;
                                                              NOR=XML Historikk Mappe] }
    { 250 ;   ;Doc. Type Purchase Order;Code10    ;InitValue=IO;
                                                   CaptionML=[ENU=Doc. Type Purchase Order;
                                                              NOR=Doc. Type Purchase Order] }
    { 255 ;   ;Scan. Doc. Type Purchase Order;Code10;
                                                   InitValue=IO;
                                                   CaptionML=[ENU=Scanner Doc. Type Purchase Order;
                                                              NOR=Skanner Doc. Type Purchase Order] }
    { 260 ;   ;Default PO Account  ;Code20        ;TableRelation="G/L Account".No. WHERE (Account Type=CONST(Posting),
                                                                                          Direct Posting=CONST(Yes),
                                                                                          Blocked=CONST(No));
                                                   CaptionML=[ENU=Default PO Account;
                                                              NOR=Default PO Account] }
    { 300 ;   ;Doc. Type Item Invoice;Code10      ;InitValue=IVF;
                                                   CaptionML=[ENU=Doc. Type Item Invoice;
                                                              NOR=Doc. Type Item Invoice] }
    { 310 ;   ;Doc. Type Item Credit;Code10       ;InitValue=IVK;
                                                   CaptionML=[ENU=Doc. Type Item Credit;
                                                              NOR=Doc. Type Item Credit] }
    { 320 ;   ;Doc. Type Journal Invoice;Code10   ;InitValue=IF;
                                                   CaptionML=[ENU=Doc. Type Journal Invoice;
                                                              NOR=Doc. Type Journal Invoice] }
    { 330 ;   ;Doc. Type Journal Credit;Code10    ;InitValue=IK;
                                                   CaptionML=[ENU=Doc. Type Journal Credit;
                                                              NOR=Doc. Type Journal Credit] }
    { 350 ;   ;Journal Template    ;Code20        ;TableRelation="Gen. Journal Template";
                                                   CaptionML=[ENU=Journal Template;
                                                              NOR=Journal Template] }
    { 360 ;   ;Journal Batch       ;Code20        ;TableRelation="Gen. Journal Batch".Name WHERE (Journal Template Name=FIELD(Journal Template));
                                                   CaptionML=[ENU=Journal Batch;
                                                              NOR=Journal Batch] }
    { 361 ;   ;Default Free VAT Code;Code10       ;InitValue=0;
                                                   TableRelation="VAT Code" WHERE (Gen. Posting Type=CONST(Purchase));
                                                   CaptionML=[ENU=Default Free VAT Code;
                                                              NOR=MVA kode avgiftsfritt kj›p] }
    { 362 ;   ;Rounding account    ;Code20        ;TableRelation="G/L Account".No. WHERE (Direct Posting=CONST(Yes),
                                                                                          Blocked=CONST(No),
                                                                                          Income/Balance=CONST(Income Statement),
                                                                                          Account Type=CONST(Posting));
                                                   CaptionML=[NOR=Avrundingskonto;
                                                              EUQ=Rounding Account] }
    { 370 ;   ;Admin Role ID       ;Code20        ;TableRelation="Permission Set"."Role ID";
                                                   CaptionML=[ENU=Admin Role ID;
                                                              NOR=Admin Rolle-ID] }
    { 400 ;   ;Keep Export Log     ;Integer       ;InitValue=3;
                                                   CaptionML=[ENU=Months to keep Export log entries;
                                                              NOR="M†neder f›r Eksport logg poster slettes "] }
  }
  KEYS
  {
    {    ;Primary Key                             ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    PROCEDURE CreateCue@1();
    VAR
      RoleCenterCue@1000 : Record 70010;
    BEGIN
      IF NOT RoleCenterCue.GET THEN BEGIN
        RoleCenterCue.INSERT;
      END;
    END;

    PROCEDURE CheckLocalFolderPath@1101103000(VAR FilePath@1101103000 : Text[250]);
    BEGIN
      IF (STRLEN(FilePath) < 1) THEN EXIT;

      IF (COPYSTR(FilePath, STRLEN(FilePath), 1) <> '\') THEN
      BEGIN
        FilePath += '\';
      END;
    END;

    BEGIN
    {
      +---------------------------------------------+
      | SI-Data                                     |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 24.04.15 JAL Added fields for XML file export.
                       Added fields for configuration of document import and export.
    }
    END.
  }
}

OBJECT Table 70001 Compello Change Log
{
  OBJECT-PROPERTIES
  {
    Date=01.10.16;
    Time=11:00:00;
    Modified=Yes;
    Version List=CMP1.01;
  }
  PROPERTIES
  {
    CaptionML=ENU=Compello Change Log;
  }
  FIELDS
  {
    { 1   ;   ;GUID                ;GUID          ;CaptionML=ENU=GUID }
    { 21  ;   ;Table ID            ;Integer       ;CaptionML=ENU=Table ID }
    { 31  ;   ;Record ID           ;RecordID      ;CaptionML=ENU=Record ID }
    { 41  ;   ;User Action         ;Option        ;CaptionML=ENU=User Action;
                                                   OptionCaptionML=ENU=Insert,Modify,Delete;
                                                   OptionString=Insert,Modify,Delete }
    { 44  ;   ;Date                ;DateTime      ;CaptionML=ENU=Date }
    { 51  ;   ;DataType            ;Integer       ;CaptionML=ENU=DataType }
    { 54  ;   ;Value               ;Text20        ;CaptionML=ENU=Value }
    { 61  ;   ;Description         ;Text50        ;CaptionML=ENU=Description }
    { 62  ;   ;Description 2       ;Text100       ;CaptionML=ENU=Description 2 }
    { 63  ;   ;Description 3       ;Text100       ;CaptionML=ENU=Description 3 }
    { 71  ;   ;Inactive            ;Boolean       ;CaptionML=ENU=Inactive }
    { 81  ;   ;Status              ;Option        ;CaptionML=ENU=Status;
                                                   OptionCaptionML=ENU=Created,In progress,Sent,Error;
                                                   OptionString=Created,In progress,Sent,Error }
    { 84  ;   ;Error Message       ;Text250       ;CaptionML=ENU=Error Message }
    { 87  ;   ;No. of Tries        ;Integer       ;CaptionML=ENU=No. of Tries }
    { 101 ;   ;Table Code          ;Code20        ;TableRelation="Compello Integr. Table".Code;
                                                   CaptionML=ENU=Table Code }
    { 121 ;   ;Filter Field 1      ;Text100        }
    { 123 ;   ;Filter Field 2      ;Text100        }
    { 125 ;   ;Filter Field 3      ;Text100        }
  }
  KEYS
  {
    {    ;GUID                                    ;Clustered=Yes }
    {    ;Table ID,Date                            }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    {
      CMP001 1.00 2014-07-23 Integration with Compello Document Management
                               Object created
      CMP001 1.01 2014-09-16 Integration with Compello Document Management
                               New Fields
                                 121 - "Filter Field 1"
                                 123 - "Filter Field 2"
                                 125 - "Filter Field 3"
    }
    END.
  }
}

OBJECT Table 70002 Compello Change Log Archive
{
  OBJECT-PROPERTIES
  {
    Date=01.10.16;
    Time=11:00:00;
    Modified=Yes;
    Version List=CMP1.01;
  }
  PROPERTIES
  {
    CaptionML=ENU=Compello Change Log Archive;
  }
  FIELDS
  {
    { 1   ;   ;GUID                ;GUID          ;CaptionML=ENU=GUID }
    { 21  ;   ;Table ID            ;Integer       ;CaptionML=ENU=Table ID }
    { 31  ;   ;Record ID           ;RecordID      ;CaptionML=ENU=Record ID }
    { 41  ;   ;User Action         ;Option        ;CaptionML=ENU=User Action;
                                                   OptionCaptionML=ENU=Insert,Modify,Delete,Rename;
                                                   OptionString=Insert,Modify,Delete,Rename }
    { 44  ;   ;Date                ;DateTime      ;CaptionML=ENU=Date }
    { 51  ;   ;DataType            ;Integer       ;CaptionML=ENU=DataType }
    { 54  ;   ;Value               ;Text20        ;CaptionML=ENU=Value }
    { 61  ;   ;Description         ;Text50        ;CaptionML=ENU=Description }
    { 62  ;   ;Description 2       ;Text100       ;CaptionML=ENU=Description 2 }
    { 63  ;   ;Description 3       ;Text100       ;CaptionML=ENU=Description 3 }
    { 71  ;   ;Inactive            ;Boolean       ;CaptionML=ENU=Inactive }
    { 81  ;   ;Status              ;Option        ;CaptionML=ENU=Status;
                                                   OptionCaptionML=ENU=Created,In progress,Sent,Error;
                                                   OptionString=Created,In progress,Sent,Error }
    { 84  ;   ;Error Message       ;Text250       ;CaptionML=ENU=Error Message }
    { 87  ;   ;No. of Tries        ;Integer       ;CaptionML=ENU=No. of Tries }
    { 91  ;   ;Transaction No.     ;GUID          ;CaptionML=ENU=Transaction No. }
    { 93  ;   ;Transaction DateTime;DateTime      ;CaptionML=ENU=Transaction DateTime }
    { 94  ;   ;Transaction Date    ;Date          ;CaptionML=ENU=Transaction Date }
    { 101 ;   ;Table Code          ;Code20        ;TableRelation="Compello Integr. Table".Code;
                                                   CaptionML=ENU=Table Code }
    { 121 ;   ;Filter Field 1      ;Text100        }
    { 123 ;   ;Filter Field 2      ;Text100        }
    { 125 ;   ;Filter Field 3      ;Text100        }
  }
  KEYS
  {
    {    ;GUID                                    ;Clustered=Yes }
    {    ;Date                                     }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    {
      CMP001 1.00 2014-07-23 Integration with Compello Document Management
                               Object created
      CMP001 1.01 2014-09-16 Integration with Compello Document Management
                               New Fields
                                 121 - "Filter Field 1"
                                 123 - "Filter Field 2"
                                 125 - "Filter Field 3"
    }
    END.
  }
}

OBJECT Table 70003 Compello Integr. Table
{
  OBJECT-PROPERTIES
  {
    Date=01.10.16;
    Time=11:00:00;
    Modified=Yes;
    Version List=CMP2.00;
  }
  PROPERTIES
  {
    OnInsert=BEGIN
               IF Code = '' THEN BEGIN
                 IntegrSetup.GET;
                 IntegrSetup.TESTFIELD("Integr. Table Nos.");
                 NoSeriesMgt.InitSeries(IntegrSetup."Integr. Table Nos.", xRec."No. Series", 0D, Code, "No. Series");
               END;
             END;

    OnDelete=VAR
               IntegrTableField@1000 : Record 70004;
               HdlLineRel@1001 : Record 70013;
               NotifSetup@1002 : Record 70007;
             BEGIN
               IntegrTableField.SETRANGE("Table Code", Code);
               IntegrTableField.DELETEALL;

               HdlLineRel.SETRANGE("Table Code", Code);
               HdlLineRel.DELETEALL;

               NotifSetup.SETRANGE("Table Code", Code);
               NotifSetup.DELETEALL;
             END;

    CaptionML=ENU=Compello Integr. Table;
  }
  FIELDS
  {
    { 1   ;   ;Code                ;Code20        ;OnValidate=BEGIN
                                                                IF Code <> xRec.Code THEN BEGIN
                                                                  IntegrSetup.GET;
                                                                  NoSeriesMgt.TestManual(IntegrSetup."Integr. Table Nos.");
                                                                  "No. Series" := '';
                                                                END;
                                                              END;

                                                   CaptionML=ENU=Code }
    { 21  ;   ;Table ID            ;Integer       ;TableRelation=Object.ID WHERE (Type=CONST(Table));
                                                   OnValidate=BEGIN
                                                                IF "Table ID" <> DATABASE::"Dimension Value" THEN BEGIN
                                                                  TESTFIELD("Dimension Code", '');
                                                                END;
                                                                CheckNoLinesCreated(FIELDCAPTION("Table ID"));
                                                              END;

                                                   CaptionML=ENU=Table ID }
    { 24  ;   ;Header Table ID     ;Integer       ;CaptionML=ENU=Header Table ID;
                                                   Editable=No }
    { 31  ;   ;Synchronize         ;Option        ;CaptionML=ENU=Synchronize;
                                                   OptionCaptionML=ENU=None,Manual,NAS,On-line;
                                                   OptionString=None,Manual,NAS,On-line }
    { 41  ;   ;Map To Table        ;Code20        ;TableRelation="Map-to Fields".Code WHERE (Field No.=CONST(0));
                                                   OnValidate=VAR
                                                                MapToFields@1000 : Record 70005;
                                                              BEGIN
                                                                CheckNoLinesCreated(FIELDCAPTION("Map To Table"));

                                                                IF "Map To Table" <> '' THEN BEGIN
                                                                  MapToFields.GET("Map To Table");
                                                                  MapToFields.TESTFIELD("Field No.", 0);
                                                                  "Data Type" := MapToFields."Data Type";
                                                                  "Table Type" := MapToFields."Table Type";
                                                                END ELSE BEGIN
                                                                  "Data Type" := 0;
                                                                  "Table Type" := "Table Type"::" ";
                                                                END;

                                                                IF "Table Type" <> "Table Type"::Line THEN BEGIN
                                                                  "Related to Header" := '';
                                                                END;
                                                              END;

                                                   CaptionML=ENU=Map To Table }
    { 46  ;   ;Table Type          ;Option        ;CaptionML=ENU=Table Type;
                                                   OptionCaptionML=ENU=" ,Header,Line";
                                                   OptionString=[ ,Header,Line];
                                                   Editable=No }
    { 51  ;   ;Action IO           ;Option        ;CaptionML=ENU=Action IO;
                                                   OptionCaptionML=ENU=Import,Export;
                                                   OptionString=Import,Export }
    { 61  ;   ;No. Series          ;Code10        ;CaptionML=ENU=No. Series }
    { 71  ;   ;Data Type           ;Integer       ;CaptionML=ENU=Data Type;
                                                   Editable=No }
    { 81  ;   ;Related to Header   ;Code20        ;TableRelation="Compello Integr. Table".Code WHERE (Table Type=CONST(Header));
                                                   OnValidate=VAR
                                                                IntegrTable@1000 : Record 70003;
                                                              BEGIN
                                                                IF "Related to Header" <> '' THEN BEGIN
                                                                  TESTFIELD("Table Type", "Table Type"::Line);
                                                                  IntegrTable.GET("Related to Header");
                                                                  IntegrTable.TESTFIELD("Header Table ID", 0);
                                                                  IntegrTable.TESTFIELD("Table Type", IntegrTable."Table Type"::Header);
                                                                  "Header Table ID" := IntegrTable."Table ID";
                                                                END ELSE BEGIN
                                                                  "Header Table ID" := 0;
                                                                END;
                                                              END;

                                                   CaptionML=ENU=Related to Header }
    { 83  ;   ;Dimension Code      ;Code20        ;TableRelation=Dimension.Code;
                                                   OnValidate=BEGIN
                                                                TESTFIELD("Table ID", DATABASE::"Dimension Value");
                                                              END;

                                                   CaptionML=ENU=Dimension Code }
    { 101 ;   ;Data Type Name      ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Map-to Fields".Name WHERE (Code=FIELD(Map To Table)));
                                                   CaptionML=ENU=Data Type Name;
                                                   Editable=No }
    { 102 ;   ;Table Name          ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Object.Name WHERE (Type=CONST(Table),
                                                                                         ID=FIELD(Table ID)));
                                                   CaptionML=ENU=Table Name;
                                                   Editable=No }
    { 111 ;   ;Credit Document     ;Boolean       ;CaptionML=ENU=Credit Document }
    { 121 ;   ;Filter Field 1      ;Integer        }
    { 122 ;   ;Filter Value 1      ;Text150        }
    { 123 ;   ;Filter Field 2      ;Integer        }
    { 124 ;   ;Filter Value 2      ;Text150        }
    { 125 ;   ;Filter Field 3      ;Integer        }
    { 126 ;   ;Filter Value 3      ;Text150        }
    { 400 ;   ;Dimension No.       ;Integer       ;CaptionML=[ENU=Dimension No.;
                                                              NOR=Dimensjonummer] }
  }
  KEYS
  {
    {    ;Code                                    ;Clustered=Yes }
    {    ;Table ID,Synchronize,Action IO           }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      IntegrSetup@1000 : Record 70000;
      NoSeriesMgt@1001 : Codeunit 396;
      Text001@1002 : TextConst 'ENU=There should be no lines when updating field %1';

    PROCEDURE CheckNoLinesCreated@3(FromFieldName@1001 : Text[250]);
    VAR
      IntegrTableField@1000 : Record 70004;
    BEGIN
      IntegrTableField.SETRANGE("Table Code", Code);
      IF IntegrTableField.ISEMPTY THEN BEGIN
        EXIT;
      END;

      ERROR(Text001, FromFieldName);
    END;

    PROCEDURE TableFieldLookUp@1(VAR Text@1001 : Text[20]) : Boolean;
    VAR
      FieldTable@1000 : Record 2000000041;
    BEGIN
      IF "Table ID" = 0 THEN BEGIN
        EXIT(FALSE);
      END;

      FieldTable.FILTERGROUP := 2;
      FieldTable.SETRANGE(TableNo, "Table ID");
      FieldTable.FILTERGROUP := 0;
      IF PAGE.RUNMODAL(PAGE::"Field List For Integration", FieldTable) = ACTION::LookupOK THEN BEGIN
        Text := FORMAT(FieldTable."No.");
        EXIT(TRUE);
      END;

      EXIT(FALSE);
    END;

    BEGIN
    {
      +---------------------------------------------+
      | SI-Data                                     |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 24.04.15 JAL Added the field "Dimension No."
    }
    END.
  }
}

OBJECT Table 70004 Compello Integr. Table Field
{
  OBJECT-PROPERTIES
  {
    Date=05.12.16;
    Time=18:34:13;
    Modified=Yes;
    Version List=CMP2.00.02;
  }
  PROPERTIES
  {
    OnInsert=BEGIN
               TESTFIELD("Table ID");
             END;

    CaptionML=ENU=Compello Integr. Table Field;
  }
  FIELDS
  {
    { 1   ;   ;Table Code          ;Code20        ;TableRelation="Compello Integr. Table".Code;
                                                   OnValidate=BEGIN
                                                                SetRelatedTable;
                                                              END;

                                                   CaptionML=ENU=Table Code;
                                                   NotBlank=Yes }
    { 2   ;   ;Line No.            ;Integer       ;CaptionML=ENU=Line No. }
    { 21  ;   ;Table ID            ;Integer       ;CaptionML=ENU=Table ID;
                                                   Editable=No }
    { 31  ;   ;Field ID            ;Integer       ;CaptionML=ENU=Field ID }
    { 35  ;   ;Dimension Code      ;Code20        ;TableRelation=Dimension.Code;
                                                   CaptionML=ENU=Dimension Code;
                                                   Description=//ket fra 10 til 20 i NAV2017 }
    { 41  ;   ;Map-to Field        ;Code20        ;TableRelation="Map-to Fields".Code WHERE (Data Type=FIELD(Map To Table Data Type),
                                                                                             Field No.=FILTER(>0));
                                                   OnValidate=VAR
                                                                MapToField@1000 : Record 70005;
                                                              BEGIN
                                                                MapToField.GET("Map-to Field");
                                                                "Map-to Field No." := MapToField."Field No.";
                                                                SetRelatedTable;
                                                              END;

                                                   CaptionML=ENU=Map-to Field }
    { 42  ;   ;Map To Table Data Type;Integer     ;OnValidate=VAR
                                                                MapToFields@1000 : Record 70005;
                                                              BEGIN
                                                              END;

                                                   CaptionML=ENU=Map To Table Data Type }
    { 44  ;   ;Map-to Field No.    ;Integer       ;CaptionML=ENU=Map-to Field No.;
                                                   Editable=No }
    { 61  ;   ;Sequence No.        ;Integer       ;CaptionML=ENU=Sequence No. }
    { 62  ;   ;Validate            ;Boolean       ;CaptionML=ENU=Validate }
    { 65  ;   ;Use Default Value   ;Text100       ;CaptionML=ENU=Use Default Value }
    { 101 ;   ;Field Name          ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Field.FieldName WHERE (TableNo=FIELD(Table ID),
                                                                                             No.=FIELD(Field ID)));
                                                   CaptionML=ENU=Field Name;
                                                   Editable=No }
    { 102 ;   ;Map-to Field Name   ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Map-to Fields".Name WHERE (Code=FIELD(Map-to Field)));
                                                   CaptionML=ENU=Map-to Field Name;
                                                   Editable=No }
    { 120 ;   ;Only If Not Blank   ;Boolean        }
    { 400 ;   ;Dimension No.       ;Integer       ;CaptionML=[ENU=Dimension No.;
                                                              NOR=Dimensjonummer] }
  }
  KEYS
  {
    {    ;Table Code,Line No.                     ;Clustered=Yes }
    {    ;Sequence No.                             }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    PROCEDURE TableFieldLookUp@1(VAR Text@1001 : Text[20]) : Boolean;
    VAR
      FieldTable@1000 : Record 2000000041;
    BEGIN
      IF "Table ID" = 0 THEN BEGIN
        EXIT(FALSE);
      END;

      FieldTable.FILTERGROUP := 2;
      FieldTable.SETRANGE(TableNo, "Table ID");
      FieldTable.FILTERGROUP := 0;
      IF PAGE.RUNMODAL(PAGE::"Field List For Integration", FieldTable) = ACTION::LookupOK THEN BEGIN
        Text := FORMAT(FieldTable."No.");
        EXIT(TRUE);
      END;

      EXIT(FALSE);
    END;

    PROCEDURE SetRelatedTable@2();
    VAR
      MapToField@1000 : Record 70005;
      IntegrTable@1001 : Record 70003;
    BEGIN
      IF IntegrTable.GET("Table Code") THEN BEGIN
        "Map To Table Data Type" := IntegrTable."Data Type";
        "Table ID" := IntegrTable."Table ID";

        IF MapToField.GET("Map-to Field") THEN BEGIN
          IF MapToField."Table Type" = MapToField."Table Type"::Header THEN BEGIN
            IntegrTable.TESTFIELD("Header Table ID");
            "Table ID" := IntegrTable."Header Table ID";
          END;
        END;
      END;
    END;

    BEGIN
    {
      +---------------------------------------------+
      | SI-Data                                     |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 24.04.15 JAL Added the field "Dimension No."
      02. 04.12.16 GST Dimension Code expanded from 10 to 20
    }
    END.
  }
}

OBJECT Table 70005 Map-to Fields
{
  OBJECT-PROPERTIES
  {
    Date=01.10.16;
    Time=11:00:00;
    Modified=Yes;
    Version List=CMP1.00;
  }
  PROPERTIES
  {
    CaptionML=ENU=Map-to Fields;
  }
  FIELDS
  {
    { 1   ;   ;Code                ;Code20        ;CaptionML=ENU=Code }
    { 21  ;   ;Name                ;Text50        ;CaptionML=ENU=Name }
    { 31  ;   ;Data Type           ;Integer       ;CaptionML=ENU=Data Type }
    { 34  ;   ;Field No.           ;Integer       ;CaptionML=ENU=Field No. }
    { 41  ;   ;Table Type          ;Option        ;CaptionML=ENU=Table Type;
                                                   OptionCaptionML=ENU=" ,Header,Line";
                                                   OptionString=[ ,Header,Line] }
  }
  KEYS
  {
    {    ;Code                                    ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    {
      CMP001 1.00 2014-07-23 Integration with Compello Document Management
                               Object created
    }
    END.
  }
}

OBJECT Table 70006 Compello Export Log
{
  OBJECT-PROPERTIES
  {
    Date=01.10.16;
    Time=11:00:00;
    Modified=Yes;
    Version List=CMP1.00;
  }
  PROPERTIES
  {
    CaptionML=ENU=Compello Export Log;
  }
  FIELDS
  {
    { 1   ;   ;GUID                ;GUID          ;CaptionML=ENU=GUID }
    { 21  ;   ;Export date         ;DateTime      ;CaptionML=ENU=Export date }
    { 31  ;   ;Result              ;Text250       ;CaptionML=ENU=Result }
  }
  KEYS
  {
    {    ;GUID                                    ;Clustered=Yes }
    {    ;Export date                              }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    {
      CMP001 1.00 2014-07-23 Integration with Compello Document Management
                               Object created
    }
    END.
  }
}

OBJECT Table 70007 Compello User Notification
{
  OBJECT-PROPERTIES
  {
    Date=01.10.16;
    Time=11:00:00;
    Modified=Yes;
    Version List=CMP1.00;
  }
  PROPERTIES
  {
    OnInsert=BEGIN
               GetNextEntryNo;
             END;

    CaptionML=[ENU=Compello User Notification;
               NOR=Compello Brukervarsler];
  }
  FIELDS
  {
    { 1   ;   ;Entry No.           ;Integer       ;CaptionML=[ENU=Entry No.;
                                                              NOR=L›penr.] }
    { 10  ;   ;Table Code          ;Code20        ;TableRelation="Compello Integr. Table".Code;
                                                   CaptionML=ENU=Table Code;
                                                   NotBlank=Yes }
    { 21  ;   ;User ID             ;Code50        ;TableRelation=User."User Name";
                                                   OnLookup=VAR
                                                              UserMgt@1101103000 : Codeunit 418;
                                                            BEGIN
                                                              UserMgt.LookupUserID("User ID");
                                                            END;

                                                   CaptionML=ENU=User ID }
  }
  KEYS
  {
    {    ;Entry No.                               ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    LOCAL PROCEDURE GetNextEntryNo@1101103000();
    VAR
      CompelloUserNotificationL@1101103000 : Record 70007;
    BEGIN
      IF CompelloUserNotificationL.FINDLAST THEN
        "Entry No." := CompelloUserNotificationL."Entry No." + 1
      ELSE
         "Entry No."  := 1;
    END;

    BEGIN
    {
      CMP001 1.00 2014-07-23 Integration with Compello Document Management
                               Object created
    }
    END.
  }
}

OBJECT Table 70008 Compello Import Header
{
  OBJECT-PROPERTIES
  {
    Date=01.10.16;
    Time=11:00:00;
    Modified=Yes;
    Version List=CMP2.00;
  }
  PROPERTIES
  {
    CaptionML=ENU=Compello Import Header;
  }
  FIELDS
  {
    { 1   ;   ;GUID                ;GUID          ;CaptionML=ENU=GUID }
    { 21  ;   ;Client ID           ;Text10        ;CaptionML=ENU=Client ID }
    { 24  ;   ;Supplier            ;Text50        ;CaptionML=ENU=Supplier }
    { 31  ;   ;Archive Ref         ;Text30        ;CaptionML=ENU=Archive Ref }
    { 34  ;   ;Scanned Date        ;Date          ;CaptionML=ENU=Scanned Date }
    { 35  ;   ;Scanned Time        ;Time          ;CaptionML=ENU=Scanned Time }
    { 41  ;   ;Voucher Type        ;Text30        ;CaptionML=ENU=Voucher Type }
    { 44  ;   ;Invoice No.         ;Text30        ;CaptionML=ENU=Invoice No. }
    { 47  ;   ;Order Ref           ;Text250       ;CaptionML=ENU=Order Ref }
    { 51  ;   ;Voucher Date        ;Date          ;CaptionML=ENU=Voucher Date }
    { 52  ;   ;Due Date            ;Date          ;CaptionML=ENU=Due Date }
    { 55  ;   ;Voucher Time        ;Time          ;CaptionML=ENU=Voucher Time }
    { 56  ;   ;Due Date Time       ;Time          ;CaptionML=ENU=Due Date Time }
    { 61  ;   ;KID                 ;Text50        ;CaptionML=ENU=KID }
    { 71  ;   ;Transaction No.     ;Text50        ;CaptionML=ENU=Transaction No. }
    { 81  ;   ;User Defined 1      ;Text100       ;CaptionML=ENU=User Defined 1 }
    { 82  ;   ;User Defined 2      ;Text100       ;CaptionML=ENU=User Defined 2 }
    { 83  ;   ;User Defined 3      ;Text100       ;CaptionML=ENU=User Defined 3 }
    { 84  ;   ;User Defined 4      ;Text100       ;CaptionML=ENU=User Defined 4 }
    { 85  ;   ;User Defined 5      ;Text100       ;CaptionML=ENU=User Defined 5 }
    { 86  ;   ;User Defined 6      ;Text100       ;CaptionML=ENU=User Defined 6 }
    { 87  ;   ;User Defined 7      ;Text100       ;CaptionML=ENU=User Defined 7 }
    { 88  ;   ;Image GUID          ;Text40        ;CaptionML=ENU=Image GUID }
    { 201 ;   ;Created Document Type;Option       ;CaptionML=ENU=Created Document Type;
                                                   OptionCaptionML=[ENU=" ,Invoice,Credit Memo";
                                                                    NOR=" ,Faktura,Kreditnota"];
                                                   OptionString=[ ,Invoice,Credit Memo] }
    { 202 ;   ;Created Document No.;Code20        ;CaptionML=ENU=Created Document No. }
    { 211 ;   ;Status              ;Option        ;CaptionML=ENU=Status;
                                                   OptionCaptionML=ENU=New,In Progress,Created,Error,Deleted;
                                                   OptionString=New,In Progress,Created,Error,Deleted }
    { 213 ;   ;Status Text         ;Text250       ;CaptionML=ENU=Status Text }
    { 221 ;   ;Import Date         ;DateTime      ;CaptionML=ENU=Import Date }
    { 300 ;   ;Vendor No.          ;Code20         }
  }
  KEYS
  {
    {    ;GUID                                    ;Clustered=Yes }
    {    ;Import Date                              }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    {
      +---------------------------------------------+
      | SI-Data                                     |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 24.04.15 JAL Added the field "Vendor No."
    }
    END.
  }
}

OBJECT Table 70009 Compello Import Line
{
  OBJECT-PROPERTIES
  {
    Date=01.10.16;
    Time=11:00:00;
    Modified=Yes;
    Version List=CMP1.00;
  }
  PROPERTIES
  {
    CaptionML=ENU=Compello Import Line;
  }
  FIELDS
  {
    { 1   ;   ;Header GUID         ;GUID          ;TableRelation="Compello Import Header".GUID;
                                                   CaptionML=ENU=Header GUID }
    { 2   ;   ;Line No.            ;Integer       ;CaptionML=ENU=Line No. }
    { 21  ;   ;User Defined 7      ;Date          ;CaptionML=ENU=User Defined 7;
                                                   Description=Posting date }
    { 22  ;   ;User Defined 7 Time ;Time          ;CaptionML=ENU=User Defined 7 Time }
    { 31  ;   ;Period Value        ;Text20        ;CaptionML=ENU=Period Value }
    { 34  ;   ;Period Description  ;Text50        ;CaptionML=ENU=Period Description }
    { 41  ;   ;Debet Type          ;Text10        ;CaptionML=ENU=Debet Type }
    { 42  ;   ;Debet Value         ;Text20        ;CaptionML=ENU=Debet Value }
    { 43  ;   ;Debet Description   ;Text50        ;CaptionML=ENU=Debet Description }
    { 47  ;   ;Debet Tax Code      ;Text20        ;CaptionML=ENU=Debet Tax Code }
    { 48  ;   ;Debet Tax Code Description;Text50  ;CaptionML=ENU=Debet Tax Code Description }
    { 51  ;   ;Credit Type         ;Text10        ;CaptionML=ENU=Credit Type }
    { 52  ;   ;Credit Value        ;Text20        ;CaptionML=ENU=Credit Value }
    { 53  ;   ;Credit Description  ;Text50        ;CaptionML=ENU=Credit Description }
    { 57  ;   ;Credit Tax Code     ;Text20        ;CaptionML=ENU=Credit Tax Code }
    { 58  ;   ;Credit Tax Code Description;Text50 ;CaptionML=ENU=Credit Tax Code Description }
    { 61  ;   ;Amount              ;Decimal       ;CaptionML=ENU=Amount }
    { 62  ;   ;UnitPrice           ;Decimal       ;CaptionML=ENU=UnitPrice }
    { 64  ;   ;Currency Amount     ;Decimal       ;CaptionML=ENU=Currency Amount }
    { 65  ;   ;Volume              ;Decimal       ;CaptionML=ENU=Volume }
    { 67  ;   ;VAT Amount          ;Decimal       ;CaptionML=ENU=VAT Amount }
    { 71  ;   ;Currency Value      ;Text20        ;CaptionML=ENU=Currency Value }
    { 74  ;   ;Currency Description;Text50        ;CaptionML=ENU=Currency Description }
    { 81  ;   ;Discount            ;Decimal       ;CaptionML=ENU=Discount }
    { 91  ;   ;Discount Date       ;Date          ;CaptionML=ENU=Discount Date }
    { 92  ;   ;Discount Date Time  ;Time          ;CaptionML=ENU=Discount Date Time }
    { 101 ;   ;Text                ;Text250       ;CaptionML=ENU=Text }
    { 111 ;   ;User Defined 1      ;Text10        ;CaptionML=ENU=User Defined 1 }
    { 112 ;   ;User Defined 2      ;Text40        ;CaptionML=ENU=User Defined 2 }
    { 113 ;   ;User Defined 3      ;Text40        ;CaptionML=ENU=User Defined 3 }
    { 114 ;   ;User Defined 4      ;Text50        ;CaptionML=ENU=User Defined 4 }
    { 115 ;   ;User Defined 5      ;Text50        ;CaptionML=ENU=User Defined 5 }
    { 116 ;   ;User Defined 6      ;Text50        ;CaptionML=ENU=User Defined 6 }
    { 118 ;   ;User Defined 8      ;Text100       ;CaptionML=ENU=User Defined 8 }
    { 119 ;   ;User Defined 9      ;Text100       ;CaptionML=ENU=User Defined 9 }
    { 120 ;   ;User Defined 10     ;Text100       ;CaptionML=ENU=User Defined 10 }
    { 121 ;   ;User Defined 11     ;Text100       ;CaptionML=ENU=User Defined 11 }
    { 122 ;   ;User Defined 12     ;Text100       ;CaptionML=ENU=User Defined 12 }
    { 123 ;   ;User Defined 13     ;Text100       ;CaptionML=ENU=User Defined 13 }
    { 124 ;   ;User Defined 14     ;Text100       ;CaptionML=ENU=User Defined 14 }
    { 125 ;   ;User Defined 15     ;Text100       ;CaptionML=ENU=User Defined 15 }
    { 141 ;   ;Dimension 1 Value   ;Text20        ;CaptionML=ENU=Dimension 1 Value }
    { 142 ;   ;Dimension 1 Description;Text50     ;CaptionML=ENU=Dimension 1 Description }
    { 146 ;   ;Dimension 2 Value   ;Text20        ;CaptionML=ENU=Dimension 2 Value }
    { 147 ;   ;Dimension 2 Description;Text50     ;CaptionML=ENU=Dimension 2 Description }
    { 151 ;   ;Dimension 3 Value   ;Text20        ;CaptionML=ENU=Dimension 3 Value }
    { 152 ;   ;Dimension 3 Description;Text50     ;CaptionML=ENU=Dimension 3 Description }
    { 156 ;   ;Dimension 4 Value   ;Text20        ;CaptionML=ENU=Dimension 4 Value }
    { 157 ;   ;Dimension 4 Description;Text50     ;CaptionML=ENU=Dimension 4 Description }
    { 161 ;   ;Dimension 5 Value   ;Text20        ;CaptionML=ENU=Dimension 5 Value }
    { 162 ;   ;Dimension 5 Description;Text50     ;CaptionML=ENU=Dimension 5 Description }
    { 166 ;   ;Dimension 6 Value   ;Text20        ;CaptionML=ENU=Dimension 6 Value }
    { 167 ;   ;Dimension 6 Description;Text50     ;CaptionML=ENU=Dimension 6 Description }
    { 171 ;   ;Dimension 7 Value   ;Text20        ;CaptionML=ENU=Dimension 7 Value }
    { 172 ;   ;Dimension 7 Description;Text50     ;CaptionML=ENU=Dimension 7 Description }
    { 176 ;   ;Dimension 8 Value   ;Text20        ;CaptionML=ENU=Dimension 8 Value }
    { 177 ;   ;Dimension 8 Description;Text50     ;CaptionML=ENU=Dimension 8 Description }
    { 181 ;   ;Dimension 9 Value   ;Text20        ;CaptionML=ENU=Dimension 9 Value }
    { 182 ;   ;Dimension 9 Description;Text50     ;CaptionML=ENU=Dimension 9 Description }
    { 186 ;   ;Dimension 10 Value  ;Text20        ;CaptionML=ENU=Dimension 10 Value }
    { 187 ;   ;Dimension 10 Description;Text50    ;CaptionML=ENU=Dimension 10 Description }
    { 191 ;   ;Dimension 11 Value  ;Text20        ;CaptionML=ENU=Dimension 11 Value }
    { 192 ;   ;Dimension 11 Description;Text50    ;CaptionML=ENU=Dimension 11 Description }
    { 196 ;   ;Dimension 12 Value  ;Text20        ;CaptionML=ENU=Dimension 12 Value }
    { 197 ;   ;Dimension 12 Description;Text50    ;CaptionML=ENU=Dimension 12 Description }
    { 201 ;   ;Dimension 13 Value  ;Text20        ;CaptionML=ENU=Dimension 13 Value }
    { 202 ;   ;Dimension 13 Description;Text50    ;CaptionML=ENU=Dimension 13 Description }
    { 206 ;   ;Dimension 14 Value  ;Text20        ;CaptionML=ENU=Dimension 14 Value }
    { 207 ;   ;Dimension 14 Description;Text50    ;CaptionML=ENU=Dimension 14 Description }
    { 211 ;   ;Dimension 15 Value  ;Text20        ;CaptionML=ENU=Dimension 15 Value }
    { 212 ;   ;Dimension 15 Description;Text50    ;CaptionML=ENU=Dimension 15 Description }
    { 301 ;   ;ProductValue        ;Text100       ;CaptionML=ENU=ProductValue }
    { 302 ;   ;ProductDesc         ;Text250       ;CaptionML=ENU=ProductDesc }
    { 303 ;   ;ProductDescriptionFree;Text250     ;CaptionML=ENU=ProductDescriptionFree }
    { 311 ;   ;Received            ;Boolean       ;CaptionML=ENU=Received }
    { 321 ;   ;ReceivedUnits       ;Decimal       ;CaptionML=ENU=ReceivedUnits }
    { 1000;   ;No VAT              ;Boolean       ;CaptionML=[ENU=No VAT;
                                                              NOR=Ingen moms] }
  }
  KEYS
  {
    {    ;Header GUID,Line No.                    ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    {
      CMP001 1.00 2014-07-23 Integration with Compello Document Management
                               Object created
    }
    END.
  }
}

OBJECT Table 70010 Compello RC Cue
{
  OBJECT-PROPERTIES
  {
    Date=01.10.16;
    Time=11:00:00;
    Modified=Yes;
    Version List=CMP1.00;
  }
  PROPERTIES
  {
    CaptionML=ENU=Compello RC Cue;
  }
  FIELDS
  {
    { 1   ;   ;Primary Key         ;Code1         ;CaptionML=ENU=Primary Key }
    { 21  ;   ;Date Filter Today   ;Date          ;FieldClass=FlowFilter;
                                                   CaptionML=ENU=Date Filter Today }
    { 101 ;   ;Not Synchronized Records;Integer   ;FieldClass=FlowField;
                                                   CalcFormula=Count("Compello Change Log");
                                                   CaptionML=ENU=Not Synchronized Records;
                                                   Editable=No }
    { 201 ;   ;Imported Documents  ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Compello Import Header");
                                                   CaptionML=ENU=Imported Documents;
                                                   Editable=No }
  }
  KEYS
  {
    {    ;Primary Key                             ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    {
      +---------------------------------------------+
      | SI-Data                                     |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 24.04.15 JAL Added flow field definiton to "Imported Documents"
    }
    END.
  }
}

OBJECT Table 70011 Compello Import Header Archive
{
  OBJECT-PROPERTIES
  {
    Date=01.10.16;
    Time=11:00:00;
    Modified=Yes;
    Version List=CMP2.00;
  }
  PROPERTIES
  {
    CaptionML=ENU=Compello Import Header Archive;
  }
  FIELDS
  {
    { 1   ;   ;GUID                ;GUID          ;CaptionML=ENU=GUID }
    { 21  ;   ;Client ID           ;Text10        ;CaptionML=ENU=Client ID }
    { 24  ;   ;Supplier            ;Text50        ;CaptionML=ENU=Supplier }
    { 31  ;   ;Archive Ref         ;Text30        ;CaptionML=ENU=Archive Ref }
    { 34  ;   ;Scanned Date        ;Date          ;CaptionML=ENU=Scanned Date }
    { 35  ;   ;Scanned Time        ;Time          ;CaptionML=ENU=Scanned Time }
    { 41  ;   ;Voucher Type        ;Text30        ;CaptionML=ENU=Voucher Type }
    { 44  ;   ;Invoice No.         ;Text30        ;CaptionML=ENU=Invoice No. }
    { 47  ;   ;Order Ref           ;Text250       ;CaptionML=ENU=Order Ref }
    { 51  ;   ;Voucher Date        ;Date          ;CaptionML=ENU=Voucher Date }
    { 52  ;   ;Due Date            ;Date          ;CaptionML=ENU=Due Date }
    { 55  ;   ;Voucher Time        ;Time          ;CaptionML=ENU=Voucher Time }
    { 56  ;   ;Due Date Time       ;Time          ;CaptionML=ENU=Due Date Time }
    { 61  ;   ;KID                 ;Text50        ;CaptionML=ENU=KID }
    { 71  ;   ;Transaction No.     ;Text50        ;CaptionML=ENU=Transaction No. }
    { 81  ;   ;User Defined 1      ;Text100       ;CaptionML=ENU=User Defined 1 }
    { 82  ;   ;User Defined 2      ;Text100       ;CaptionML=ENU=User Defined 2 }
    { 83  ;   ;User Defined 3      ;Text100       ;CaptionML=ENU=User Defined 3 }
    { 84  ;   ;User Defined 4      ;Text100       ;CaptionML=ENU=User Defined 4 }
    { 85  ;   ;User Defined 5      ;Text100       ;CaptionML=ENU=User Defined 5 }
    { 86  ;   ;User Defined 6      ;Text100       ;CaptionML=ENU=User Defined 6 }
    { 87  ;   ;User Defined 7      ;Text100       ;CaptionML=ENU=User Defined 7 }
    { 88  ;   ;Image GUID          ;Text40        ;CaptionML=ENU=Image GUID }
    { 201 ;   ;Created Document Type;Option       ;CaptionML=ENU=Created Document Type;
                                                   OptionCaptionML=[ENU=" ,Invoice,Credit Memo";
                                                                    NOR=" ,Faktura,Kreditnota"];
                                                   OptionString=[ ,Invoice,Credit Memo] }
    { 202 ;   ;Created Document No.;Code20        ;CaptionML=ENU=Created Document No. }
    { 211 ;   ;Status              ;Option        ;CaptionML=ENU=Status;
                                                   OptionCaptionML=ENU=New,In Progress,Created,Error,Deleted;
                                                   OptionString=New,In Progress,Created,Error,Deleted }
    { 221 ;   ;Import Date         ;DateTime      ;CaptionML=ENU=Import Date }
    { 222 ;   ;Last Action Date    ;DateTime      ;CaptionML=ENU=Last Action Date }
    { 300 ;   ;Vendor No.          ;Code20         }
  }
  KEYS
  {
    {    ;GUID                                    ;Clustered=Yes }
    {    ;Status,Last Action Date                  }
    {    ;Status,Import Date                       }
    {    ;Last Action Date                         }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    {
      +---------------------------------------------+
      | SI-Data                                     |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 24.04.15 JAL Added the field "Vendor No."
    }
    END.
  }
}

OBJECT Table 70012 Compello Import Line Archive
{
  OBJECT-PROPERTIES
  {
    Date=01.10.16;
    Time=11:00:00;
    Modified=Yes;
    Version List=CMP1.00;
  }
  PROPERTIES
  {
    CaptionML=ENU=Compello Import Line Archive;
  }
  FIELDS
  {
    { 1   ;   ;Header GUID         ;GUID          ;TableRelation="Compello Import Header Archive".GUID;
                                                   CaptionML=ENU=Header GUID }
    { 2   ;   ;Line No.            ;Integer       ;CaptionML=ENU=Line No. }
    { 21  ;   ;User Defined 7      ;Date          ;CaptionML=ENU=User Defined 7;
                                                   Description=Posting date }
    { 22  ;   ;User Defined 7 Time ;Time          ;CaptionML=ENU=User Defined 7 Time }
    { 31  ;   ;Period Value        ;Text20        ;CaptionML=ENU=Period Value }
    { 34  ;   ;Period Description  ;Text50        ;CaptionML=ENU=Period Description }
    { 41  ;   ;Debet Type          ;Text10        ;CaptionML=ENU=Debet Type }
    { 42  ;   ;Debet Value         ;Text20        ;CaptionML=ENU=Debet Value }
    { 43  ;   ;Debet Description   ;Text50        ;CaptionML=ENU=Debet Description }
    { 47  ;   ;Debet Tax Code      ;Text20        ;CaptionML=ENU=Debet Tax Code }
    { 48  ;   ;Debet Tax Code Description;Text50  ;CaptionML=ENU=Debet Tax Code Description }
    { 51  ;   ;Credit Type         ;Text10        ;CaptionML=ENU=Credit Type }
    { 52  ;   ;Credit Value        ;Text20        ;CaptionML=ENU=Credit Value }
    { 53  ;   ;Credit Description  ;Text50        ;CaptionML=ENU=Credit Description }
    { 57  ;   ;Credit Tax Code     ;Text20        ;CaptionML=ENU=Credit Tax Code }
    { 58  ;   ;Credit Tax Code Description;Text50 ;CaptionML=ENU=Credit Tax Code Description }
    { 61  ;   ;Amount              ;Decimal       ;CaptionML=ENU=Amount }
    { 62  ;   ;UnitPrice           ;Decimal       ;CaptionML=ENU=UnitPrice }
    { 64  ;   ;Currency Amount     ;Decimal       ;CaptionML=ENU=Currency Amount }
    { 65  ;   ;Volume              ;Decimal       ;CaptionML=ENU=Volume }
    { 67  ;   ;VAT Amount          ;Decimal       ;CaptionML=ENU=VAT Amount }
    { 71  ;   ;Currency Value      ;Text20        ;CaptionML=ENU=Currency Value }
    { 74  ;   ;Currency Description;Text50        ;CaptionML=ENU=Currency Description }
    { 81  ;   ;Discount            ;Decimal       ;CaptionML=ENU=Discount }
    { 91  ;   ;Discount Date       ;Date          ;CaptionML=ENU=Discount Date }
    { 92  ;   ;Discount Date Time  ;Time          ;CaptionML=ENU=Discount Date Time }
    { 101 ;   ;Text                ;Text250       ;CaptionML=ENU=Text }
    { 111 ;   ;User Defined 1      ;Text10        ;CaptionML=ENU=User Defined 1 }
    { 112 ;   ;User Defined 2      ;Text40        ;CaptionML=ENU=User Defined 2 }
    { 113 ;   ;User Defined 3      ;Text40        ;CaptionML=ENU=User Defined 3 }
    { 114 ;   ;User Defined 4      ;Text50        ;CaptionML=ENU=User Defined 4 }
    { 115 ;   ;User Defined 5      ;Text50        ;CaptionML=ENU=User Defined 5 }
    { 116 ;   ;User Defined 6      ;Text50        ;CaptionML=ENU=User Defined 6 }
    { 118 ;   ;User Defined 8      ;Text100       ;CaptionML=ENU=User Defined 8 }
    { 119 ;   ;User Defined 9      ;Text100       ;CaptionML=ENU=User Defined 9 }
    { 120 ;   ;User Defined 10     ;Text100       ;CaptionML=ENU=User Defined 10 }
    { 121 ;   ;User Defined 11     ;Text100       ;CaptionML=ENU=User Defined 11 }
    { 122 ;   ;User Defined 12     ;Text100       ;CaptionML=ENU=User Defined 12 }
    { 123 ;   ;User Defined 13     ;Text100       ;CaptionML=ENU=User Defined 13 }
    { 124 ;   ;User Defined 14     ;Text100       ;CaptionML=ENU=User Defined 14 }
    { 125 ;   ;User Defined 15     ;Text100       ;CaptionML=ENU=User Defined 15 }
    { 141 ;   ;Dimension 1 Value   ;Text20        ;CaptionML=ENU=Dimension 1 Value }
    { 142 ;   ;Dimension 1 Description;Text50     ;CaptionML=ENU=Dimension 1 Description }
    { 146 ;   ;Dimension 2 Value   ;Text20        ;CaptionML=ENU=Dimension 2 Value }
    { 147 ;   ;Dimension 2 Description;Text50     ;CaptionML=ENU=Dimension 2 Description }
    { 151 ;   ;Dimension 3 Value   ;Text20        ;CaptionML=ENU=Dimension 3 Value }
    { 152 ;   ;Dimension 3 Description;Text50     ;CaptionML=ENU=Dimension 3 Description }
    { 156 ;   ;Dimension 4 Value   ;Text20        ;CaptionML=ENU=Dimension 4 Value }
    { 157 ;   ;Dimension 4 Description;Text50     ;CaptionML=ENU=Dimension 4 Description }
    { 161 ;   ;Dimension 5 Value   ;Text20        ;CaptionML=ENU=Dimension 5 Value }
    { 162 ;   ;Dimension 5 Description;Text50     ;CaptionML=ENU=Dimension 5 Description }
    { 166 ;   ;Dimension 6 Value   ;Text20        ;CaptionML=ENU=Dimension 6 Value }
    { 167 ;   ;Dimension 6 Description;Text50     ;CaptionML=ENU=Dimension 6 Description }
    { 171 ;   ;Dimension 7 Value   ;Text20        ;CaptionML=ENU=Dimension 7 Value }
    { 172 ;   ;Dimension 7 Description;Text50     ;CaptionML=ENU=Dimension 7 Description }
    { 176 ;   ;Dimension 8 Value   ;Text20        ;CaptionML=ENU=Dimension 8 Value }
    { 177 ;   ;Dimension 8 Description;Text50     ;CaptionML=ENU=Dimension 8 Description }
    { 181 ;   ;Dimension 9 Value   ;Text20        ;CaptionML=ENU=Dimension 9 Value }
    { 182 ;   ;Dimension 9 Description;Text50     ;CaptionML=ENU=Dimension 9 Description }
    { 186 ;   ;Dimension 10 Value  ;Text20        ;CaptionML=ENU=Dimension 10 Value }
    { 187 ;   ;Dimension 10 Description;Text50    ;CaptionML=ENU=Dimension 10 Description }
    { 191 ;   ;Dimension 11 Value  ;Text20        ;CaptionML=ENU=Dimension 11 Value }
    { 192 ;   ;Dimension 11 Description;Text50    ;CaptionML=ENU=Dimension 11 Description }
    { 196 ;   ;Dimension 12 Value  ;Text20        ;CaptionML=ENU=Dimension 12 Value }
    { 197 ;   ;Dimension 12 Description;Text50    ;CaptionML=ENU=Dimension 12 Description }
    { 201 ;   ;Dimension 13 Value  ;Text20        ;CaptionML=ENU=Dimension 13 Value }
    { 202 ;   ;Dimension 13 Description;Text50    ;CaptionML=ENU=Dimension 13 Description }
    { 206 ;   ;Dimension 14 Value  ;Text20        ;CaptionML=ENU=Dimension 14 Value }
    { 207 ;   ;Dimension 14 Description;Text50    ;CaptionML=ENU=Dimension 14 Description }
    { 211 ;   ;Dimension 15 Value  ;Text20        ;CaptionML=ENU=Dimension 15 Value }
    { 212 ;   ;Dimension 15 Description;Text50    ;CaptionML=ENU=Dimension 15 Description }
    { 301 ;   ;ProductValue        ;Text100       ;CaptionML=ENU=ProductValue }
    { 302 ;   ;ProductDesc         ;Text250       ;CaptionML=ENU=ProductDesc }
    { 303 ;   ;ProductDescriptionFree;Text250     ;CaptionML=ENU=ProductDescriptionFree }
    { 311 ;   ;Received            ;Boolean       ;CaptionML=ENU=Received }
    { 321 ;   ;ReceivedUnits       ;Decimal       ;CaptionML=ENU=ReceivedUnits }
    { 1000;   ;No VAT              ;Boolean       ;CaptionML=[ENU=No VAT;
                                                              NOR=Ingen moms] }
  }
  KEYS
  {
    {    ;Header GUID,Line No.                    ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    {
      CMP001 1.00 2014-07-23 Integration with Compello Document Management
                               Object created
    }
    END.
  }
}

OBJECT Table 70013 Header and Line Relation
{
  OBJECT-PROPERTIES
  {
    Date=01.10.16;
    Time=11:00:00;
    Modified=Yes;
    Version List=CMP1.00;
  }
  PROPERTIES
  {
    CaptionML=ENU=Header and Line Relation;
  }
  FIELDS
  {
    { 1   ;   ;Table Code          ;Code20        ;TableRelation="Compello Integr. Table".Code;
                                                   OnValidate=VAR
                                                                IntegrTable@1000 : Record 70003;
                                                              BEGIN
                                                                IntegrTable.GET("Table Code");
                                                                "Line Table No." := IntegrTable."Table ID";
                                                                "Header Table No." := IntegrTable."Header Table ID";
                                                              END;

                                                   CaptionML=ENU=Table Code;
                                                   NotBlank=Yes }
    { 2   ;   ;Header Field No.    ;Integer       ;CaptionML=ENU=Header Field No. }
    { 21  ;   ;Line Field No.      ;Integer       ;CaptionML=ENU=Line Field No. }
    { 31  ;   ;Header Table No.    ;Integer       ;CaptionML=ENU=Header Table No. }
    { 32  ;   ;Line Table No.      ;Integer       ;CaptionML=ENU=Line Table No. }
    { 41  ;   ;Validate            ;Boolean       ;CaptionML=ENU=Validate }
    { 101 ;   ;Header Field Caption;Text250       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Field."Field Caption" WHERE (TableNo=FIELD(Header Table No.),
                                                                                                   No.=FIELD(Header Field No.)));
                                                   CaptionML=ENU=Header Field Caption;
                                                   Editable=No }
    { 102 ;   ;Line Field Caption  ;Text250       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Field."Field Caption" WHERE (TableNo=FIELD(Line Table No.),
                                                                                                   No.=FIELD(Line Field No.)));
                                                   CaptionML=ENU=Line Field Caption;
                                                   Editable=No }
  }
  KEYS
  {
    {    ;Table Code,Header Field No.             ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    PROCEDURE TableFieldLookUp@1(VAR Text@1001 : Text[20];HeaderTable@1002 : Boolean) : Boolean;
    VAR
      FieldTable@1000 : Record 2000000041;
    BEGIN
      FieldTable.FILTERGROUP := 2;
      IF HeaderTable THEN BEGIN
        FieldTable.SETRANGE(TableNo, "Header Table No.");
      END ELSE BEGIN
        FieldTable.SETRANGE(TableNo, "Line Table No.");
      END;
      FieldTable.FILTERGROUP := 0;
      IF PAGE.RUNMODAL(PAGE::"Field List For Integration", FieldTable) = ACTION::LookupOK THEN BEGIN
        Text := FORMAT(FieldTable."No.");
        EXIT(TRUE);
      END;

      EXIT(FALSE);
    END;

    BEGIN
    {
      CMP001 1.00 2014-07-23 Integration with Compello Document Management
                               Object created
    }
    END.
  }
}

OBJECT Table 70014 Compello Import Comment
{
  OBJECT-PROPERTIES
  {
    Date=01.10.16;
    Time=11:00:00;
    Modified=Yes;
    Version List=CMP1.01;
  }
  PROPERTIES
  {
  }
  FIELDS
  {
    { 1   ;   ;GUID                ;GUID          ;CaptionML=ENU=GUID }
    { 2   ;   ;Line No.            ;Integer        }
    { 3   ;   ;Comment             ;Text80         }
  }
  KEYS
  {
    {    ;GUID,Line No.                           ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    {
      CMP001 1.01 2014-08-26 Integration with Compello Document Management
                               Object created
    }
    END.
  }
}

OBJECT Table 70015 Compello Import Comment Arch.
{
  OBJECT-PROPERTIES
  {
    Date=01.10.16;
    Time=11:00:00;
    Modified=Yes;
    Version List=CMP1.01;
  }
  PROPERTIES
  {
  }
  FIELDS
  {
    { 1   ;   ;GUID                ;GUID          ;CaptionML=ENU=GUID }
    { 2   ;   ;Line No.            ;Integer        }
    { 3   ;   ;Comment             ;Text80         }
  }
  KEYS
  {
    {    ;GUID,Line No.                           ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    {
      CMP001 1.01 2014-08-26 Integration with Compello Document Management
                               Object created
    }
    END.
  }
}

OBJECT Report 70000 Export Table Data to Compello
{
  OBJECT-PROPERTIES
  {
    Date=01.10.16;
    Time=11:00:00;
    Modified=Yes;
    Version List=CMP1.00;
  }
  PROPERTIES
  {
    CaptionML=ENU=Export Table Data to Compello;
    ProcessingOnly=Yes;
    OnPreReport=BEGIN
                  IF NOT LogMgt.IsIntegrationRecord(TableID) THEN BEGIN
                    ERROR(Text002, TableID);
                  END;

                  TableRecRef.OPEN(TableID);
                  IF TableRecRef.FINDSET THEN BEGIN
                    Window.OPEN(Text001);
                    Window.UPDATE(1, TableRecRef.CAPTION);
                    TotalRec := TableRecRef.COUNT;
                    REPEAT
                      CurrRec := CurrRec + 1;
                      IF CurrRec MOD 20 = 0 THEN BEGIN
                        Window.UPDATE(2, ROUND(CurrRec / TotalRec * 10000, 1));
                      END;

                      LogMgt.OnDatabaseInsert(TableRecRef);
                    UNTIL TableRecRef.NEXT = 0;
                    Window.CLOSE;
                  END;
                END;

  }
  DATASET
  {
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
      { 1   ;    ;Container ;
                  ContainerType=ContentArea }

      { 2   ;1   ;Field     ;
                  CaptionML=ENU=Table ID;
                  SourceExpr=TableID;
                  TableRelation=Object.ID WHERE (Type=CONST(Table)) }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      LogMgt@1002 : Codeunit 70000;
      TableID@1000 : Integer;
      TableRecRef@1001 : RecordRef;
      Window@1003 : Dialog;
      Text001@1004 : TextConst 'ENU=Table: #1##########\@2@@@@@@@@@@@@@@@@@';
      CurrRec@1005 : Integer;
      TotalRec@1006 : Integer;
      Text002@1007 : TextConst 'ENU=Table %1 is not setup for integration';

    PROCEDURE SetTable@2(NewTableID@1000 : Integer);
    BEGIN
      TableID := NewTableID;
    END;

    BEGIN
    {
      CMP001 1.00 2014-07-23 Integration with Compello Document Management
                               Object created
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Codeunit 408 DimensionManagement
{
  OBJECT-PROPERTIES
  {
    Date=01.10.16;
    Time=11:00:00;
    Modified=Yes;
    Version List=NAVW110.00.00.15601,CMP1.00;
  }
  PROPERTIES
  {
    Permissions=TableData 80=imd,
                TableData 232=imd,
                TableData 355=imd;
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      Text000@1000 : TextConst 'ENU=Dimensions %1 and %2 can''t be used concurrently.;NOR=Dimensjonene %1 og %2 kan ikke brukes samtidig.';
      Text001@1001 : TextConst 'ENU=Dimension combinations %1 - %2 and %3 - %4 can''t be used concurrently.;NOR=Dimensjonskombinasjonene %1 - %2 og %3 - %4 kan ikke brukes samtidig.';
      Text002@1002 : TextConst 'ENU=This Shortcut Dimension is not defined in the %1.;NOR=Denne snarveisdimensjonen er ikke definert i %1.';
      Text003@1003 : TextConst 'ENU=%1 is not an available %2 for that dimension.;NOR=%1 er ikke en tilgjengelig %2 for den dimensjonen.';
      Text004@1004 : TextConst 'ENU=Select a %1 for the %2 %3.;NOR=Velg en %1 for %2 %3.';
      Text005@1005 : TextConst 'ENU=Select a %1 for the %2 %3 for %4 %5.;NOR=Velg en %1 for %2 %3 for %4 %5.';
      Text006@1006 : TextConst 'ENU=Select %1 %2 for the %3 %4.;NOR=Velg %1 %2 for %3 %4.';
      Text007@1007 : TextConst 'ENU=Select %1 %2 for the %3 %4 for %5 %6.;NOR=Velg %1 %2 for %3 %4 for %5 %6.';
      Text008@1008 : TextConst 'ENU=%1 %2 must be blank.;NOR=%1 %2 m† v‘re tom.';
      Text009@1009 : TextConst 'ENU=%1 %2 must be blank for %3 %4.;NOR=%1 %2 m† v‘re tom for %3 %4.';
      Text010@1010 : TextConst 'ENU=%1 %2 must not be mentioned.;NOR=%1 %2 skal ikke nevnes.';
      Text011@1011 : TextConst 'ENU=%1 %2 must not be mentioned for %3 %4.;NOR=%1 %2 skal ikke nevnes for %3 %4.';
      Text012@1012 : TextConst 'ENU=A %1 used in %2 has not been used in %3.;NOR=En %1 som brukes i %2 er ikke brukt i %3.';
      Text013@1013 : TextConst 'ENU=%1 for %2 %3 is not the same in %4 and %5.;NOR=%1 for %2 %3 er ikke det samme i %4 og %5.';
      Text014@1014 : TextConst 'ENU=%1 %2 is blocked.;NOR=%1 %2 er sperret.';
      Text015@1015 : TextConst 'ENU=%1 %2 can''t be found.;NOR=%1 %2 kan ikke finnes.';
      Text016@1016 : TextConst 'ENU=%1 %2 - %3 is blocked.;NOR=%1 %2 - %3 er sperret.';
      Text017@1017 : TextConst 'ENU=%1 for %2 %3 - %4 must not be %5.;NOR=%1 for %2 %3 - %4 kan ikke v‘re %5.';
      Text018@1018 : TextConst 'ENU=%1 for %2 is missing.;NOR=%1 for %2 mangler.';
      Text019@1028 : TextConst 'ENU=You have changed a dimension.\\Do you want to update the lines?;NOR=Du har endret en dimensjon.\\Vil du oppdatere linjene?';
      TempDimBuf1@1019 : TEMPORARY Record 360;
      TempDimBuf2@1020 : TEMPORARY Record 360;
      ObjTransl@1027 : Record 377;
      DimValComb@1032 : Record 351;
      JobTaskDimTemp@1033 : TEMPORARY Record 1002;
      DefaultDim@1035 : Record 352;
      DimSetEntry@1034 : Record 480;
      TempDimSetEntry2@1029 : TEMPORARY Record 480;
      TempDimCombInitialized@1031 : Boolean;
      TempDimCombEmpty@1030 : Boolean;
      DimCombErr@1021 : Text[250];
      DimValuePostingErr@1022 : Text[250];
      DimErr@1023 : Text[250];
      DocDimConsistencyErr@1024 : Text[250];
      HasGotGLSetup@1025 : Boolean;
      GLSetupShortcutDimCode@1026 : ARRAY [8] OF Code[20];
      DimSetFilterCtr@1036 : Integer;
      LastDimSetIDInFilter@1037 : Integer;

    PROCEDURE GetDimensionSetID@123(VAR DimSetEntry2@1000 : Record 480) : Integer;
    BEGIN
      EXIT(DimSetEntry.GetDimensionSetID(DimSetEntry2));
    END;

    PROCEDURE GetDimensionSet@124(VAR TempDimSetEntry@1000 : TEMPORARY Record 480;DimSetID@1001 : Integer);
    VAR
      DimSetEntry2@1002 : Record 480;
    BEGIN
      TempDimSetEntry.DELETEALL;
      WITH DimSetEntry2 DO BEGIN
        SETRANGE("Dimension Set ID",DimSetID);
        IF FINDSET THEN
          REPEAT
            TempDimSetEntry := DimSetEntry2;
            TempDimSetEntry.INSERT;
          UNTIL NEXT = 0;
      END;
    END;

    PROCEDURE ShowDimensionSet@125(DimSetID@1000 : Integer;NewCaption@1003 : Text[250]);
    VAR
      DimSetEntries@1002 : Page 479;
    BEGIN
      DimSetEntry.RESET;
      DimSetEntry.FILTERGROUP(2);
      DimSetEntry.SETRANGE("Dimension Set ID",DimSetID);
      DimSetEntry.FILTERGROUP(0);
      DimSetEntries.SETTABLEVIEW(DimSetEntry);
      DimSetEntries.SetFormCaption(NewCaption);
      DimSetEntry.RESET;
      DimSetEntries.RUNMODAL;
    END;

    PROCEDURE EditDimensionSet@128(DimSetID@1000 : Integer;NewCaption@1003 : Text[250]) : Integer;
    VAR
      EditDimSetEntries@1002 : Page 480;
      NewDimSetID@1004 : Integer;
    BEGIN
      NewDimSetID := DimSetID;
      DimSetEntry.RESET;
      DimSetEntry.FILTERGROUP(2);
      DimSetEntry.SETRANGE("Dimension Set ID",DimSetID);
      DimSetEntry.FILTERGROUP(0);
      EditDimSetEntries.SETTABLEVIEW(DimSetEntry);
      EditDimSetEntries.SetFormCaption(NewCaption);
      EditDimSetEntries.RUNMODAL;
      NewDimSetID := EditDimSetEntries.GetDimensionID;
      DimSetEntry.RESET;
      EXIT(NewDimSetID);
    END;

    PROCEDURE EditDimensionSet2@131(DimSetID@1000 : Integer;NewCaption@1003 : Text[250];VAR GlobalDimVal1@1006 : Code[20];VAR GlobalDimVal2@1005 : Code[20]) : Integer;
    VAR
      EditDimSetEntries@1002 : Page 480;
      NewDimSetID@1004 : Integer;
    BEGIN
      NewDimSetID := DimSetID;
      DimSetEntry.RESET;
      DimSetEntry.FILTERGROUP(2);
      DimSetEntry.SETRANGE("Dimension Set ID",DimSetID);
      DimSetEntry.FILTERGROUP(0);
      EditDimSetEntries.SETTABLEVIEW(DimSetEntry);
      EditDimSetEntries.SetFormCaption(NewCaption);
      EditDimSetEntries.RUNMODAL;
      NewDimSetID := EditDimSetEntries.GetDimensionID;
      UpdateGlobalDimFromDimSetID(NewDimSetID,GlobalDimVal1,GlobalDimVal2);
      DimSetEntry.RESET;
      EXIT(NewDimSetID);
    END;

    PROCEDURE EditReclasDimensionSet2@133(VAR DimSetID@1001 : Integer;VAR NewDimSetID@1002 : Integer;NewCaption@1000 : Text[250];VAR GlobalDimVal1@1005 : Code[20];VAR GlobalDimVal2@1003 : Code[20];VAR NewGlobalDimVal1@1007 : Code[20];VAR NewGlobalDimVal2@1006 : Code[20]);
    VAR
      EditReclasDimensions@1004 : Page 484;
    BEGIN
      EditReclasDimensions.SetDimensionIDs(DimSetID,NewDimSetID);
      EditReclasDimensions.SetFormCaption(NewCaption);
      EditReclasDimensions.RUNMODAL;
      EditReclasDimensions.GetDimensionIDs(DimSetID,NewDimSetID);
      UpdateGlobalDimFromDimSetID(DimSetID,GlobalDimVal1,GlobalDimVal2);
      UpdateGlobalDimFromDimSetID(NewDimSetID,NewGlobalDimVal1,NewGlobalDimVal2);
    END;

    PROCEDURE UpdateGlobalDimFromDimSetID@130(DimSetID@1000 : Integer;VAR GlobalDimVal1@1001 : Code[20];VAR GlobalDimVal2@1002 : Code[20]);
    BEGIN
      GetGLSetup;
      GlobalDimVal1 := '';
      GlobalDimVal2 := '';
      IF GLSetupShortcutDimCode[1] <> '' THEN
        IF DimSetEntry.GET(DimSetID,GLSetupShortcutDimCode[1]) THEN
          GlobalDimVal1 := DimSetEntry."Dimension Value Code";
      IF GLSetupShortcutDimCode[2] <> '' THEN
        IF DimSetEntry.GET(DimSetID,GLSetupShortcutDimCode[2]) THEN
          GlobalDimVal2 := DimSetEntry."Dimension Value Code";
    END;

    PROCEDURE GetCombinedDimensionSetID@132(DimensionSetIDArr@1000 : ARRAY [10] OF Integer;VAR GlobalDimVal1@1004 : Code[20];VAR GlobalDimVal2@1005 : Code[20]) : Integer;
    VAR
      TempDimSetEntry@1003 : TEMPORARY Record 480;
      i@1001 : Integer;
    BEGIN
      GetGLSetup;
      GlobalDimVal1 := '';
      GlobalDimVal2 := '';
      DimSetEntry.RESET;
      FOR i := 1 TO 10 DO
        IF DimensionSetIDArr[i] <> 0 THEN BEGIN
          DimSetEntry.SETRANGE("Dimension Set ID",DimensionSetIDArr[i]);
          IF DimSetEntry.FINDSET THEN
            REPEAT
              IF TempDimSetEntry.GET(0,DimSetEntry."Dimension Code") THEN
                TempDimSetEntry.DELETE;
              TempDimSetEntry := DimSetEntry;
              TempDimSetEntry."Dimension Set ID" := 0;
              TempDimSetEntry.INSERT;
              IF GLSetupShortcutDimCode[1] = TempDimSetEntry."Dimension Code" THEN
                GlobalDimVal1 := TempDimSetEntry."Dimension Value Code";
              IF GLSetupShortcutDimCode[2] = TempDimSetEntry."Dimension Code" THEN
                GlobalDimVal2 := TempDimSetEntry."Dimension Value Code";
            UNTIL DimSetEntry.NEXT = 0;
        END;
      EXIT(GetDimensionSetID(TempDimSetEntry));
    END;

    PROCEDURE GetDeltaDimSetID@137(DimSetID@1005 : Integer;NewParentDimSetID@1000 : Integer;OldParentDimSetID@1001 : Integer) : Integer;
    VAR
      TempDimSetEntry@1004 : TEMPORARY Record 480;
      TempDimSetEntryNew@1003 : TEMPORARY Record 480;
      TempDimSetEntryDeleted@1002 : TEMPORARY Record 480;
    BEGIN
      // Returns an updated DimSetID based on parent's old and new DimSetID
      IF NewParentDimSetID = OldParentDimSetID THEN
        EXIT(DimSetID);
      GetDimensionSet(TempDimSetEntry,DimSetID);
      GetDimensionSet(TempDimSetEntryNew,NewParentDimSetID);
      GetDimensionSet(TempDimSetEntryDeleted,OldParentDimSetID);
      IF TempDimSetEntryDeleted.FINDSET THEN
        REPEAT
          IF TempDimSetEntryNew.GET(NewParentDimSetID,TempDimSetEntryDeleted."Dimension Code") THEN BEGIN
            IF TempDimSetEntryNew."Dimension Value Code" = TempDimSetEntryDeleted."Dimension Value Code" THEN
              TempDimSetEntryNew.DELETE;
            TempDimSetEntryDeleted.DELETE;
          END;
        UNTIL TempDimSetEntryDeleted.NEXT = 0;

      IF TempDimSetEntryDeleted.FINDSET THEN
        REPEAT
          IF TempDimSetEntry.GET(DimSetID,TempDimSetEntryDeleted."Dimension Code") THEN
            TempDimSetEntry.DELETE;
        UNTIL TempDimSetEntryDeleted.NEXT = 0;

      IF TempDimSetEntryNew.FINDSET THEN
        REPEAT
          IF TempDimSetEntry.GET(DimSetID,TempDimSetEntryNew."Dimension Code") THEN BEGIN
            IF TempDimSetEntry."Dimension Value Code" <> TempDimSetEntryNew."Dimension Value Code" THEN BEGIN
              TempDimSetEntry."Dimension Value Code" := TempDimSetEntryNew."Dimension Value Code";
              TempDimSetEntry."Dimension Value ID" := TempDimSetEntryNew."Dimension Value ID";
              TempDimSetEntry.MODIFY;
            END;
          END ELSE BEGIN
            TempDimSetEntry := TempDimSetEntryNew;
            TempDimSetEntry."Dimension Set ID" := DimSetID;
            TempDimSetEntry.INSERT;
          END;
        UNTIL TempDimSetEntryNew.NEXT = 0;

      EXIT(GetDimensionSetID(TempDimSetEntry));
    END;

    LOCAL PROCEDURE GetGLSetup@52();
    VAR
      GLSetup@1000 : Record 98;
    BEGIN
      IF NOT HasGotGLSetup THEN BEGIN
        GLSetup.GET;
        GLSetupShortcutDimCode[1] := GLSetup."Shortcut Dimension 1 Code";
        GLSetupShortcutDimCode[2] := GLSetup."Shortcut Dimension 2 Code";
        GLSetupShortcutDimCode[3] := GLSetup."Shortcut Dimension 3 Code";
        GLSetupShortcutDimCode[4] := GLSetup."Shortcut Dimension 4 Code";
        GLSetupShortcutDimCode[5] := GLSetup."Shortcut Dimension 5 Code";
        GLSetupShortcutDimCode[6] := GLSetup."Shortcut Dimension 6 Code";
        GLSetupShortcutDimCode[7] := GLSetup."Shortcut Dimension 7 Code";
        GLSetupShortcutDimCode[8] := GLSetup."Shortcut Dimension 8 Code";
        HasGotGLSetup := TRUE;
      END;
    END;

    PROCEDURE CheckDimIDComb@138(DimSetID@1002 : Integer) : Boolean;
    BEGIN
      TempDimBuf1.RESET;
      TempDimBuf1.DELETEALL;
      DimSetEntry.RESET;
      DimSetEntry.SETRANGE("Dimension Set ID",DimSetID);
      IF DimSetEntry.FINDSET THEN
        REPEAT
          TempDimBuf1.INIT;
          TempDimBuf1."Table ID" := DATABASE::"Dimension Buffer";
          TempDimBuf1."Entry No." := 0;
          TempDimBuf1."Dimension Code" := DimSetEntry."Dimension Code";
          TempDimBuf1."Dimension Value Code" := DimSetEntry."Dimension Value Code";
          TempDimBuf1.INSERT;
        UNTIL DimSetEntry.NEXT = 0;

      DimSetEntry.RESET;
      EXIT(CheckDimComb);
    END;

    PROCEDURE CheckDimValuePosting@14(TableID@1000 : ARRAY [10] OF Integer;No@1001 : ARRAY [10] OF Code[20];DimSetID@1003 : Integer) : Boolean;
    VAR
      i@1004 : Integer;
      j@1005 : Integer;
      NoFilter@1006 : ARRAY [2] OF Text[250];
    BEGIN
      IF NOT CheckBlockedDimAndValues(DimSetID) THEN
        EXIT(FALSE);
      DefaultDim.SETFILTER("Value Posting",'<>%1',DefaultDim."Value Posting"::" ");
      DimSetEntry.RESET;
      DimSetEntry.SETRANGE("Dimension Set ID",DimSetID);
      NoFilter[2] := '';
      FOR i := 1 TO ARRAYLEN(TableID) DO BEGIN
        IF (TableID[i] <> 0) AND (No[i] <> '') THEN BEGIN
          DefaultDim.SETRANGE("Table ID",TableID[i]);
          NoFilter[1] := No[i];
          FOR j := 1 TO 2 DO BEGIN
            DefaultDim.SETRANGE("No.",NoFilter[j]);
            IF DefaultDim.FINDSET THEN
              REPEAT
                DimSetEntry.SETRANGE("Dimension Code",DefaultDim."Dimension Code");
                CASE DefaultDim."Value Posting" OF
                  DefaultDim."Value Posting"::"Code Mandatory":
                    BEGIN
                      IF NOT DimSetEntry.FINDFIRST OR (DimSetEntry."Dimension Value Code" = '') THEN BEGIN
                        IF DefaultDim."No." = '' THEN
                          DimValuePostingErr :=
                            STRSUBSTNO(
                              Text004,
                              DefaultDim.FIELDCAPTION("Dimension Value Code"),
                              DefaultDim.FIELDCAPTION("Dimension Code"),DefaultDim."Dimension Code")
                        ELSE
                          DimValuePostingErr :=
                            STRSUBSTNO(
                              Text005,
                              DefaultDim.FIELDCAPTION("Dimension Value Code"),
                              DefaultDim.FIELDCAPTION("Dimension Code"),
                              DefaultDim."Dimension Code",
                              ObjTransl.TranslateObject(ObjTransl."Object Type"::Table,DefaultDim."Table ID"),
                              DefaultDim."No.");
                        EXIT(FALSE);
                      END;
                    END;
                  DefaultDim."Value Posting"::"Same Code":
                    BEGIN
                      IF DefaultDim."Dimension Value Code" <> '' THEN BEGIN
                        IF NOT DimSetEntry.FINDFIRST OR
                           (DefaultDim."Dimension Value Code" <> DimSetEntry."Dimension Value Code")
                        THEN BEGIN
                          IF DefaultDim."No." = '' THEN
                            DimValuePostingErr :=
                              STRSUBSTNO(
                                Text006,
                                DefaultDim.FIELDCAPTION("Dimension Value Code"),DefaultDim."Dimension Value Code",
                                DefaultDim.FIELDCAPTION("Dimension Code"),DefaultDim."Dimension Code")
                          ELSE
                            DimValuePostingErr :=
                              STRSUBSTNO(
                                Text007,
                                DefaultDim.FIELDCAPTION("Dimension Value Code"),
                                DefaultDim."Dimension Value Code",
                                DefaultDim.FIELDCAPTION("Dimension Code"),
                                DefaultDim."Dimension Code",
                                ObjTransl.TranslateObject(ObjTransl."Object Type"::Table,DefaultDim."Table ID"),
                                DefaultDim."No.");
                          EXIT(FALSE);
                        END;
                      END ELSE BEGIN
                        IF DimSetEntry.FINDFIRST THEN BEGIN
                          IF DefaultDim."No." = '' THEN
                            DimValuePostingErr :=
                              STRSUBSTNO(
                                Text008,
                                DimSetEntry.FIELDCAPTION("Dimension Code"),DimSetEntry."Dimension Code")
                          ELSE
                            DimValuePostingErr :=
                              STRSUBSTNO(
                                Text009,
                                DimSetEntry.FIELDCAPTION("Dimension Code"),
                                DimSetEntry."Dimension Code",
                                ObjTransl.TranslateObject(ObjTransl."Object Type"::Table,DefaultDim."Table ID"),
                                DefaultDim."No.");
                          EXIT(FALSE);
                        END;
                      END;
                    END;
                  DefaultDim."Value Posting"::"No Code":
                    BEGIN
                      IF DimSetEntry.FINDFIRST THEN BEGIN
                        IF DefaultDim."No." = '' THEN
                          DimValuePostingErr :=
                            STRSUBSTNO(
                              Text010,
                              DimSetEntry.FIELDCAPTION("Dimension Code"),DimSetEntry."Dimension Code")
                        ELSE
                          DimValuePostingErr :=
                            STRSUBSTNO(
                              Text011,
                              DimSetEntry.FIELDCAPTION("Dimension Code"),
                              DimSetEntry."Dimension Code",
                              ObjTransl.TranslateObject(ObjTransl."Object Type"::Table,DefaultDim."Table ID"),
                              DefaultDim."No.");
                        EXIT(FALSE);
                      END;
                    END;
                END;
              UNTIL DefaultDim.NEXT = 0;
          END;
        END;
      END;
      DimSetEntry.RESET;
      EXIT(TRUE);
    END;

    PROCEDURE CheckDimBuffer@64(VAR DimBuffer@1000 : Record 360) : Boolean;
    VAR
      i@1001 : Integer;
    BEGIN
      TempDimBuf1.RESET;
      TempDimBuf1.DELETEALL;
      IF DimBuffer.FINDSET THEN BEGIN
        i := 1;
        REPEAT
          TempDimBuf1.INIT;
          TempDimBuf1."Table ID" := DATABASE::"Dimension Buffer";
          TempDimBuf1."Entry No." := i;
          TempDimBuf1."Dimension Code" := DimBuffer."Dimension Code";
          TempDimBuf1."Dimension Value Code" := DimBuffer."Dimension Value Code";
          TempDimBuf1.INSERT;
          i := i + 1;
        UNTIL DimBuffer.NEXT = 0;
      END;
      EXIT(CheckDimComb);
    END;

    LOCAL PROCEDURE CheckDimComb@3() : Boolean;
    VAR
      DimComb@1000 : Record 350;
      CurrentDimCode@1002 : Code[20];
      CurrentDimValCode@1003 : Code[20];
      DimFilter@1004 : Text[1024];
      FilterTooLong@1005 : Boolean;
    BEGIN
      IF NOT TempDimCombInitialized THEN BEGIN
        TempDimCombInitialized := TRUE;
        IF DimComb.ISEMPTY THEN
          TempDimCombEmpty := TRUE;
      END;

      IF TempDimCombEmpty THEN
        EXIT(TRUE);

      IF NOT TempDimBuf1.FINDSET THEN
        EXIT(TRUE);

      REPEAT
        IF STRLEN(DimFilter) + 1 + STRLEN(TempDimBuf1."Dimension Code") > MAXSTRLEN(DimFilter) THEN
          FilterTooLong := TRUE
        ELSE
          IF DimFilter = '' THEN
            DimFilter := TempDimBuf1."Dimension Code"
          ELSE
            DimFilter := DimFilter + '|' + TempDimBuf1."Dimension Code";
      UNTIL FilterTooLong OR (TempDimBuf1.NEXT = 0);

      IF NOT FilterTooLong THEN BEGIN
        DimComb.SETFILTER("Dimension 1 Code",DimFilter);
        DimComb.SETFILTER("Dimension 2 Code",DimFilter);
        IF DimComb.FINDSET THEN
          REPEAT
            IF DimComb."Combination Restriction" = DimComb."Combination Restriction"::Blocked THEN BEGIN
              DimCombErr := STRSUBSTNO(Text000,DimComb."Dimension 1 Code",DimComb."Dimension 2 Code");
              EXIT(FALSE);
            END ELSE BEGIN
              TempDimBuf1.SETRANGE("Dimension Code",DimComb."Dimension 1 Code");
              TempDimBuf1.FINDFIRST;
              CurrentDimCode := TempDimBuf1."Dimension Code";
              CurrentDimValCode := TempDimBuf1."Dimension Value Code";
              TempDimBuf1.SETRANGE("Dimension Code",DimComb."Dimension 2 Code");
              TempDimBuf1.FINDFIRST;
              IF NOT
                 CheckDimValueComb(
                   TempDimBuf1."Dimension Code",TempDimBuf1."Dimension Value Code",
                   CurrentDimCode,CurrentDimValCode)
              THEN
                EXIT(FALSE);
              IF NOT
                 CheckDimValueComb(
                   CurrentDimCode,CurrentDimValCode,
                   TempDimBuf1."Dimension Code",TempDimBuf1."Dimension Value Code")
              THEN
                EXIT(FALSE);
            END;
          UNTIL DimComb.NEXT = 0;
        EXIT(TRUE);
      END;

      WHILE TempDimBuf1.FINDFIRST DO BEGIN
        CurrentDimCode := TempDimBuf1."Dimension Code";
        CurrentDimValCode := TempDimBuf1."Dimension Value Code";
        TempDimBuf1.DELETE;
        IF TempDimBuf1.FINDSET THEN
          REPEAT
            IF CurrentDimCode > TempDimBuf1."Dimension Code" THEN BEGIN
              IF DimComb.GET(TempDimBuf1."Dimension Code",CurrentDimCode) THEN BEGIN
                IF DimComb."Combination Restriction" = DimComb."Combination Restriction"::Blocked THEN BEGIN
                  DimCombErr :=
                    STRSUBSTNO(
                      Text000,
                      TempDimBuf1."Dimension Code",CurrentDimCode);
                  EXIT(FALSE);
                END;
                IF NOT
                   CheckDimValueComb(
                     TempDimBuf1."Dimension Code",TempDimBuf1."Dimension Value Code",
                     CurrentDimCode,CurrentDimValCode)
                THEN
                  EXIT(FALSE);
              END;
            END ELSE BEGIN
              IF DimComb.GET(CurrentDimCode,TempDimBuf1."Dimension Code") THEN BEGIN
                IF DimComb."Combination Restriction" = DimComb."Combination Restriction"::Blocked THEN BEGIN
                  DimCombErr :=
                    STRSUBSTNO(
                      Text000,
                      CurrentDimCode,TempDimBuf1."Dimension Code");
                  EXIT(FALSE);
                END;
                IF NOT
                   CheckDimValueComb(
                     CurrentDimCode,CurrentDimValCode,TempDimBuf1."Dimension Code",
                     TempDimBuf1."Dimension Value Code")
                THEN
                  EXIT(FALSE);
              END;
            END;
          UNTIL TempDimBuf1.NEXT = 0;
      END;
      EXIT(TRUE);
    END;

    LOCAL PROCEDURE CheckDimValueComb@9(Dim1@1000 : Code[20];Dim1Value@1001 : Code[20];Dim2@1002 : Code[20];Dim2Value@1003 : Code[20]) : Boolean;
    BEGIN
      IF DimValComb.GET(Dim1,Dim1Value,Dim2,Dim2Value) THEN BEGIN
        DimCombErr :=
          STRSUBSTNO(Text001,
            Dim1,Dim1Value,Dim2,Dim2Value);
        EXIT(FALSE);
      END;
      EXIT(TRUE);
    END;

    PROCEDURE GetDimCombErr@41() : Text[250];
    BEGIN
      EXIT(DimCombErr);
    END;

    PROCEDURE UpdateDefaultDim@59(TableID@1000 : Integer;No@1001 : Code[20];VAR GlobalDim1Code@1002 : Code[20];VAR GlobalDim2Code@1003 : Code[20]);
    VAR
      DefaultDim@1004 : Record 352;
    BEGIN
      GetGLSetup;
      IF DefaultDim.GET(TableID,No,GLSetupShortcutDimCode[1]) THEN
        GlobalDim1Code := DefaultDim."Dimension Value Code"
      ELSE
        GlobalDim1Code := '';
      IF DefaultDim.GET(TableID,No,GLSetupShortcutDimCode[2]) THEN
        GlobalDim2Code := DefaultDim."Dimension Value Code"
      ELSE
        GlobalDim2Code := '';
    END;

    PROCEDURE GetDefaultDimID@8(TableID@1000 : ARRAY [10] OF Integer;No@1001 : ARRAY [10] OF Code[20];SourceCode@1002 : Code[20];VAR GlobalDim1Code@1003 : Code[20];VAR GlobalDim2Code@1004 : Code[20];InheritFromDimSetID@1014 : Integer;InheritFromTableNo@1015 : Integer) : Integer;
    VAR
      DimVal@1012 : Record 349;
      DefaultDimPriority1@1005 : Record 354;
      DefaultDimPriority2@1006 : Record 354;
      DefaultDim@1007 : Record 352;
      TempDimSetEntry@1011 : TEMPORARY Record 480;
      TempDimSetEntry0@1016 : TEMPORARY Record 480;
      i@1010 : Integer;
      j@1009 : Integer;
      NoFilter@1008 : ARRAY [2] OF Code[20];
      NewDimSetID@1013 : Integer;
    BEGIN
      GetGLSetup;
      IF InheritFromDimSetID > 0 THEN
        GetDimensionSet(TempDimSetEntry0,InheritFromDimSetID);
      TempDimBuf2.RESET;
      TempDimBuf2.DELETEALL;
      IF TempDimSetEntry0.FINDSET THEN
        REPEAT
          TempDimBuf2.INIT;
          TempDimBuf2."Table ID" := InheritFromTableNo;
          TempDimBuf2."Entry No." := 0;
          TempDimBuf2."Dimension Code" := TempDimSetEntry0."Dimension Code";
          TempDimBuf2."Dimension Value Code" := TempDimSetEntry0."Dimension Value Code";
          TempDimBuf2.INSERT;
        UNTIL TempDimSetEntry0.NEXT = 0;

      NoFilter[2] := '';
      FOR i := 1 TO ARRAYLEN(TableID) DO BEGIN
        IF (TableID[i] <> 0) AND (No[i] <> '') THEN BEGIN
          DefaultDim.SETRANGE("Table ID",TableID[i]);
          NoFilter[1] := No[i];
          FOR j := 1 TO 2 DO BEGIN
            DefaultDim.SETRANGE("No.",NoFilter[j]);
            IF DefaultDim.FINDSET THEN
              REPEAT
                IF DefaultDim."Dimension Value Code" <> '' THEN BEGIN
                  TempDimBuf2.SETRANGE("Dimension Code",DefaultDim."Dimension Code");
                  IF NOT TempDimBuf2.FINDFIRST THEN BEGIN
                    TempDimBuf2.INIT;
                    TempDimBuf2."Table ID" := DefaultDim."Table ID";
                    TempDimBuf2."Entry No." := 0;
                    TempDimBuf2."Dimension Code" := DefaultDim."Dimension Code";
                    TempDimBuf2."Dimension Value Code" := DefaultDim."Dimension Value Code";
                    TempDimBuf2.INSERT;
                  END ELSE BEGIN
                    IF DefaultDimPriority1.GET(SourceCode,DefaultDim."Table ID") THEN BEGIN
                      IF DefaultDimPriority2.GET(SourceCode,TempDimBuf2."Table ID") THEN BEGIN
                        IF DefaultDimPriority1.Priority < DefaultDimPriority2.Priority THEN BEGIN
                          TempDimBuf2.DELETE;
                          TempDimBuf2."Table ID" := DefaultDim."Table ID";
                          TempDimBuf2."Entry No." := 0;
                          TempDimBuf2."Dimension Value Code" := DefaultDim."Dimension Value Code";
                          TempDimBuf2.INSERT;
                        END;
                      END ELSE BEGIN
                        TempDimBuf2.DELETE;
                        TempDimBuf2."Table ID" := DefaultDim."Table ID";
                        TempDimBuf2."Entry No." := 0;
                        TempDimBuf2."Dimension Value Code" := DefaultDim."Dimension Value Code";
                        TempDimBuf2.INSERT;
                      END;
                    END;
                  END;
                  IF GLSetupShortcutDimCode[1] = TempDimBuf2."Dimension Code" THEN
                    GlobalDim1Code := TempDimBuf2."Dimension Value Code";
                  IF GLSetupShortcutDimCode[2] = TempDimBuf2."Dimension Code" THEN
                    GlobalDim2Code := TempDimBuf2."Dimension Value Code";
                END;
              UNTIL DefaultDim.NEXT = 0;
          END;
        END;
      END;
      TempDimBuf2.RESET;
      IF TempDimBuf2.FINDSET THEN BEGIN
        REPEAT
          DimVal.GET(TempDimBuf2."Dimension Code",TempDimBuf2."Dimension Value Code");
          TempDimSetEntry."Dimension Code" := TempDimBuf2."Dimension Code";
          TempDimSetEntry."Dimension Value Code" := TempDimBuf2."Dimension Value Code";
          TempDimSetEntry."Dimension Value ID" := DimVal."Dimension Value ID";
          TempDimSetEntry.INSERT;
        UNTIL TempDimBuf2.NEXT = 0;
        NewDimSetID := GetDimensionSetID(TempDimSetEntry);
      END;
      EXIT(NewDimSetID);
    END;

    PROCEDURE TypeToTableID1@11(Type@1000 : 'G/L Account,Customer,Vendor,Bank Account,Fixed Asset,IC Partner') : Integer;
    BEGIN
      CASE Type OF
        Type::"G/L Account":
          EXIT(DATABASE::"G/L Account");
        Type::Customer:
          EXIT(DATABASE::Customer);
        Type::Vendor:
          EXIT(DATABASE::Vendor);
        Type::"Bank Account":
          EXIT(DATABASE::"Bank Account");
        Type::"Fixed Asset":
          EXIT(DATABASE::"Fixed Asset");
        Type::"IC Partner":
          EXIT(DATABASE::"IC Partner");
      END;
    END;

    PROCEDURE TypeToTableID2@13(Type@1000 : 'Resource,Item,G/L Account') : Integer;
    BEGIN
      CASE Type OF
        Type::Resource:
          EXIT(DATABASE::Resource);
        Type::Item:
          EXIT(DATABASE::Item);
        Type::"G/L Account":
          EXIT(DATABASE::"G/L Account");
      END;
    END;

    PROCEDURE TypeToTableID3@16(Type@1000 : ' ,G/L Account,Item,Resource,Fixed Asset,Charge (Item)') : Integer;
    BEGIN
      CASE Type OF
        Type::" ":
          EXIT(0);
        Type::"G/L Account":
          EXIT(DATABASE::"G/L Account");
        Type::Item:
          EXIT(DATABASE::Item);
        Type::Resource:
          EXIT(DATABASE::Resource);
        Type::"Fixed Asset":
          EXIT(DATABASE::"Fixed Asset");
        Type::"Charge (Item)":
          EXIT(DATABASE::"Item Charge");
      END;
    END;

    PROCEDURE TypeToTableID4@1(Type@1000 : ' ,Item,Resource') : Integer;
    BEGIN
      CASE Type OF
        Type::" ":
          EXIT(0);
        Type::Item:
          EXIT(DATABASE::Item);
        Type::Resource:
          EXIT(DATABASE::Resource);
      END;
    END;

    PROCEDURE TypeToTableID5@119(Type@1000 : ' ,Item,Resource,Cost,G/L Account') : Integer;
    BEGIN
      CASE Type OF
        Type::" ":
          EXIT(0);
        Type::Item:
          EXIT(DATABASE::Item);
        Type::Resource:
          EXIT(DATABASE::Resource);
        Type::Cost:
          EXIT(DATABASE::"Service Cost");
        Type::"G/L Account":
          EXIT(DATABASE::"G/L Account");
      END;
    END;

    PROCEDURE DeleteDefaultDim@58(TableID@1000 : Integer;No@1001 : Code[20]);
    VAR
      DefaultDim@1002 : Record 352;
    BEGIN
      DefaultDim.SETRANGE("Table ID",TableID);
      DefaultDim.SETRANGE("No.",No);
      IF NOT DefaultDim.ISEMPTY THEN
        DefaultDim.DELETEALL;
    END;

    PROCEDURE LookupDimValueCode@21(FieldNumber@1000 : Integer;VAR ShortcutDimCode@1001 : Code[20]);
    VAR
      DimVal@1002 : Record 349;
      GLSetup@1003 : Record 98;
    BEGIN
      GetGLSetup;
      IF GLSetupShortcutDimCode[FieldNumber] = '' THEN
        ERROR(Text002,GLSetup.TABLECAPTION);
      DimVal.SETRANGE("Dimension Code",GLSetupShortcutDimCode[FieldNumber]);
      DimVal."Dimension Code" := GLSetupShortcutDimCode[FieldNumber];
      DimVal.Code := ShortcutDimCode;
      IF PAGE.RUNMODAL(0,DimVal) = ACTION::LookupOK THEN BEGIN
        CheckDim(DimVal."Dimension Code");
        CheckDimValue(DimVal."Dimension Code",DimVal.Code);
        ShortcutDimCode := DimVal.Code;
      END;
    END;

    PROCEDURE ValidateDimValueCode@22(FieldNumber@1000 : Integer;VAR ShortcutDimCode@1001 : Code[20]);
    VAR
      DimVal@1002 : Record 349;
      GLSetup@1003 : Record 98;
    BEGIN
      GetGLSetup;
      IF (GLSetupShortcutDimCode[FieldNumber] = '') AND (ShortcutDimCode <> '') THEN
        ERROR(Text002,GLSetup.TABLECAPTION);
      DimVal.SETRANGE("Dimension Code",GLSetupShortcutDimCode[FieldNumber]);
      IF ShortcutDimCode <> '' THEN BEGIN
        DimVal.SETRANGE(Code,ShortcutDimCode);
        IF NOT DimVal.FINDFIRST THEN BEGIN
          DimVal.SETFILTER(Code,STRSUBSTNO('%1*',ShortcutDimCode));
          IF DimVal.FINDFIRST THEN
            ShortcutDimCode := DimVal.Code
          ELSE
            ERROR(
              STRSUBSTNO(Text003,
                ShortcutDimCode,DimVal.FIELDCAPTION(Code)));
        END;
      END;
    END;

    PROCEDURE ValidateShortcutDimValues@127(FieldNumber@1000 : Integer;VAR ShortcutDimCode@1001 : Code[20];VAR DimSetID@1004 : Integer);
    VAR
      DimVal@1002 : Record 349;
      TempDimSetEntry@1005 : TEMPORARY Record 480;
    BEGIN
      ValidateDimValueCode(FieldNumber,ShortcutDimCode);
      DimVal."Dimension Code" := GLSetupShortcutDimCode[FieldNumber];
      IF ShortcutDimCode <> '' THEN BEGIN
        DimVal.GET(DimVal."Dimension Code",ShortcutDimCode);
        IF NOT CheckDim(DimVal."Dimension Code") THEN
          ERROR(GetDimErr);
        IF NOT CheckDimValue(DimVal."Dimension Code",ShortcutDimCode) THEN
          ERROR(GetDimErr);
      END;
      GetDimensionSet(TempDimSetEntry,DimSetID);
      IF TempDimSetEntry.GET(TempDimSetEntry."Dimension Set ID",DimVal."Dimension Code") THEN
        IF TempDimSetEntry."Dimension Value Code" <> ShortcutDimCode THEN
          TempDimSetEntry.DELETE;
      IF ShortcutDimCode <> '' THEN BEGIN
        TempDimSetEntry."Dimension Code" := DimVal."Dimension Code";
        TempDimSetEntry."Dimension Value Code" := DimVal.Code;
        TempDimSetEntry."Dimension Value ID" := DimVal."Dimension Value ID";
        IF TempDimSetEntry.INSERT THEN;
      END;
      DimSetID := GetDimensionSetID(TempDimSetEntry);
    END;

    PROCEDURE SaveDefaultDim@53(TableID@1000 : Integer;No@1001 : Code[20];FieldNumber@1002 : Integer;ShortcutDimCode@1003 : Code[20]);
    VAR
      DefaultDim@1004 : Record 352;
    BEGIN
      GetGLSetup;
      IF ShortcutDimCode <> '' THEN BEGIN
        IF DefaultDim.GET(TableID,No,GLSetupShortcutDimCode[FieldNumber])
        THEN BEGIN
          DefaultDim.VALIDATE("Dimension Value Code",ShortcutDimCode);
          DefaultDim.MODIFY;
        END ELSE BEGIN
          DefaultDim.INIT;
          DefaultDim.VALIDATE("Table ID",TableID);
          DefaultDim.VALIDATE("No.",No);
          DefaultDim.VALIDATE("Dimension Code",GLSetupShortcutDimCode[FieldNumber]);
          DefaultDim.VALIDATE("Dimension Value Code",ShortcutDimCode);
          DefaultDim.INSERT;
        END;
      END ELSE
        IF DefaultDim.GET(TableID,No,GLSetupShortcutDimCode[FieldNumber]) THEN
          DefaultDim.DELETE;
    END;

    PROCEDURE GetShortcutDimensions@129(DimSetID@1000 : Integer;VAR ShortcutDimCode@1004 : ARRAY [8] OF Code[20]);
    VAR
      i@1006 : Integer;
    BEGIN
      GetGLSetup;
      FOR i := 3 TO 8 DO BEGIN
        ShortcutDimCode[i] := '';
        IF GLSetupShortcutDimCode[i] <> '' THEN
          IF DimSetEntry.GET(DimSetID,GLSetupShortcutDimCode[i]) THEN
            ShortcutDimCode[i] := DimSetEntry."Dimension Value Code";
      END;
    END;

    PROCEDURE CheckDimBufferValuePosting@68(VAR DimBuffer@1000 : Record 360;TableID@1001 : ARRAY [10] OF Integer;No@1002 : ARRAY [10] OF Code[20]) : Boolean;
    VAR
      i@1005 : Integer;
    BEGIN
      TempDimBuf2.RESET;
      TempDimBuf2.DELETEALL;
      IF DimBuffer.FINDSET THEN BEGIN
        i := 1;
        REPEAT
          IF (NOT CheckDimValue(
                DimBuffer."Dimension Code",DimBuffer."Dimension Value Code")) OR
             (NOT CheckDim(DimBuffer."Dimension Code"))
          THEN BEGIN
            DimValuePostingErr := DimErr;
            EXIT(FALSE);
          END;
          TempDimBuf2.INIT;
          TempDimBuf2."Entry No." := i;
          TempDimBuf2."Dimension Code" := DimBuffer."Dimension Code";
          TempDimBuf2."Dimension Value Code" := DimBuffer."Dimension Value Code";
          TempDimBuf2.INSERT;
          i := i + 1;
        UNTIL DimBuffer.NEXT = 0;
      END;
      EXIT(CheckValuePosting(TableID,No));
    END;

    LOCAL PROCEDURE CheckValuePosting@36(TableID@1000 : ARRAY [10] OF Integer;No@1001 : ARRAY [10] OF Code[20]) : Boolean;
    VAR
      DefaultDim@1002 : Record 352;
      i@1004 : Integer;
      j@1005 : Integer;
      NoFilter@1006 : ARRAY [2] OF Text[250];
    BEGIN
      DefaultDim.SETFILTER("Value Posting",'<>%1',DefaultDim."Value Posting"::" ");
      NoFilter[2] := '';
      FOR i := 1 TO ARRAYLEN(TableID) DO BEGIN
        IF (TableID[i] <> 0) AND (No[i] <> '') THEN BEGIN
          DefaultDim.SETRANGE("Table ID",TableID[i]);
          NoFilter[1] := No[i];
          FOR j := 1 TO 2 DO BEGIN
            DefaultDim.SETRANGE("No.",NoFilter[j]);
            IF DefaultDim.FINDSET THEN BEGIN
              REPEAT
                TempDimBuf2.SETRANGE("Dimension Code",DefaultDim."Dimension Code");
                CASE DefaultDim."Value Posting" OF
                  DefaultDim."Value Posting"::"Code Mandatory":
                    BEGIN
                      IF (NOT TempDimBuf2.FINDFIRST) OR
                         (TempDimBuf2."Dimension Value Code" = '')
                      THEN BEGIN
                        IF DefaultDim."No." = '' THEN
                          DimValuePostingErr :=
                            STRSUBSTNO(
                              Text004,
                              DefaultDim.FIELDCAPTION("Dimension Value Code"),
                              DefaultDim.FIELDCAPTION("Dimension Code"),DefaultDim."Dimension Code")
                        ELSE
                          DimValuePostingErr :=
                            STRSUBSTNO(
                              Text005,
                              DefaultDim.FIELDCAPTION("Dimension Value Code"),
                              DefaultDim.FIELDCAPTION("Dimension Code"),
                              DefaultDim."Dimension Code",
                              ObjTransl.TranslateObject(ObjTransl."Object Type"::Table,DefaultDim."Table ID"),
                              DefaultDim."No.");
                        EXIT(FALSE);
                      END;
                    END;
                  DefaultDim."Value Posting"::"Same Code":
                    BEGIN
                      IF DefaultDim."Dimension Value Code" <> '' THEN BEGIN
                        IF (NOT TempDimBuf2.FINDFIRST) OR
                           (DefaultDim."Dimension Value Code" <> TempDimBuf2."Dimension Value Code")
                        THEN BEGIN
                          IF DefaultDim."No." = '' THEN
                            DimValuePostingErr :=
                              STRSUBSTNO(
                                Text006,
                                DefaultDim.FIELDCAPTION("Dimension Value Code"),DefaultDim."Dimension Value Code",
                                DefaultDim.FIELDCAPTION("Dimension Code"),DefaultDim."Dimension Code")
                          ELSE
                            DimValuePostingErr :=
                              STRSUBSTNO(
                                Text007,
                                DefaultDim.FIELDCAPTION("Dimension Value Code"),
                                DefaultDim."Dimension Value Code",
                                DefaultDim.FIELDCAPTION("Dimension Code"),
                                DefaultDim."Dimension Code",
                                ObjTransl.TranslateObject(ObjTransl."Object Type"::Table,DefaultDim."Table ID"),
                                DefaultDim."No.");
                          EXIT(FALSE);
                        END;
                      END ELSE BEGIN
                        IF TempDimBuf2.FINDFIRST THEN BEGIN
                          IF DefaultDim."No." = '' THEN
                            DimValuePostingErr :=
                              STRSUBSTNO(
                                Text008,
                                TempDimBuf2.FIELDCAPTION("Dimension Code"),TempDimBuf2."Dimension Code")
                          ELSE
                            DimValuePostingErr :=
                              STRSUBSTNO(
                                Text009,
                                TempDimBuf2.FIELDCAPTION("Dimension Code"),
                                TempDimBuf2."Dimension Code",
                                ObjTransl.TranslateObject(ObjTransl."Object Type"::Table,DefaultDim."Table ID"),
                                DefaultDim."No.");
                          EXIT(FALSE);
                        END;
                      END;
                    END;
                  DefaultDim."Value Posting"::"No Code":
                    BEGIN
                      IF TempDimBuf2.FINDFIRST THEN BEGIN
                        IF DefaultDim."No." = '' THEN
                          DimValuePostingErr :=
                            STRSUBSTNO(
                              Text010,
                              TempDimBuf2.FIELDCAPTION("Dimension Code"),TempDimBuf2."Dimension Code")
                        ELSE
                          DimValuePostingErr :=
                            STRSUBSTNO(
                              Text011,
                              TempDimBuf2.FIELDCAPTION("Dimension Code"),
                              TempDimBuf2."Dimension Code",
                              ObjTransl.TranslateObject(ObjTransl."Object Type"::Table,DefaultDim."Table ID"),
                              DefaultDim."No.");
                        EXIT(FALSE);
                      END;
                    END;
                END;
              UNTIL DefaultDim.NEXT = 0;
              TempDimBuf2.RESET;
            END;
          END;
        END;
      END;
      EXIT(TRUE);
    END;

    PROCEDURE GetDimValuePostingErr@98() : Text[250];
    BEGIN
      EXIT(DimValuePostingErr);
    END;

    PROCEDURE SetupObjectNoList@40(VAR TempAllObjWithCaption@1000 : TEMPORARY Record 2000000058);
    BEGIN
      InsertObject(TempAllObjWithCaption,DATABASE::"Salesperson/Purchaser");
      InsertObject(TempAllObjWithCaption,DATABASE::"G/L Account");
      InsertObject(TempAllObjWithCaption,DATABASE::Customer);
      InsertObject(TempAllObjWithCaption,DATABASE::Vendor);
      InsertObject(TempAllObjWithCaption,DATABASE::Item);
      InsertObject(TempAllObjWithCaption,DATABASE::"Resource Group");
      InsertObject(TempAllObjWithCaption,DATABASE::Resource);
      InsertObject(TempAllObjWithCaption,DATABASE::Job);
      InsertObject(TempAllObjWithCaption,DATABASE::"Bank Account");
      InsertObject(TempAllObjWithCaption,DATABASE::Campaign);
      InsertObject(TempAllObjWithCaption,DATABASE::Employee);
      InsertObject(TempAllObjWithCaption,DATABASE::"Fixed Asset");
      InsertObject(TempAllObjWithCaption,DATABASE::Insurance);
      InsertObject(TempAllObjWithCaption,DATABASE::"Responsibility Center");
      InsertObject(TempAllObjWithCaption,DATABASE::"Item Charge");
      InsertObject(TempAllObjWithCaption,DATABASE::"Work Center");
      InsertObject(TempAllObjWithCaption,DATABASE::"Service Contract Header");
      InsertObject(TempAllObjWithCaption,DATABASE::"Customer Template");
      InsertObject(TempAllObjWithCaption,DATABASE::"Service Contract Template");
      InsertObject(TempAllObjWithCaption,DATABASE::"IC Partner");
      InsertObject(TempAllObjWithCaption,DATABASE::"Service Order Type");
      InsertObject(TempAllObjWithCaption,DATABASE::"Service Item Group");
      InsertObject(TempAllObjWithCaption,DATABASE::"Service Item");
      InsertObject(TempAllObjWithCaption,DATABASE::"Cash Flow Manual Expense");
      InsertObject(TempAllObjWithCaption,DATABASE::"Cash Flow Manual Revenue");
      OnAfterSetupObjectNoList(TempAllObjWithCaption);
    END;

    PROCEDURE GetDocDimConsistencyErr@56() : Text[250];
    BEGIN
      EXIT(DocDimConsistencyErr);
    END;

    PROCEDURE CheckDim@60(DimCode@1000 : Code[20]) : Boolean;
    VAR
      Dim@1001 : Record 348;
    BEGIN
      IF Dim.GET(DimCode) THEN BEGIN
        IF Dim.Blocked THEN BEGIN
          DimErr :=
            STRSUBSTNO(Text014,Dim.TABLECAPTION,DimCode);
          EXIT(FALSE);
        END;
      END ELSE BEGIN
        DimErr :=
          STRSUBSTNO(Text015,Dim.TABLECAPTION,DimCode);
        EXIT(FALSE);
      END;
      EXIT(TRUE);
    END;

    PROCEDURE CheckDimValue@61(DimCode@1000 : Code[20];DimValCode@1001 : Code[20]) : Boolean;
    VAR
      DimVal@1002 : Record 349;
    BEGIN
      IF (DimCode <> '') AND (DimValCode <> '') THEN BEGIN
        IF DimVal.GET(DimCode,DimValCode) THEN BEGIN
          IF DimVal.Blocked THEN BEGIN
            DimErr :=
              STRSUBSTNO(
                Text016,DimVal.TABLECAPTION,DimCode,DimValCode);
            EXIT(FALSE);
          END;
          IF NOT (DimVal."Dimension Value Type" IN
                  [DimVal."Dimension Value Type"::Standard,
                   DimVal."Dimension Value Type"::"Begin-Total"])
          THEN BEGIN
            DimErr :=
              STRSUBSTNO(Text017,DimVal.FIELDCAPTION("Dimension Value Type"),
                DimVal.TABLECAPTION,DimCode,DimValCode,FORMAT(DimVal."Dimension Value Type"));
            EXIT(FALSE);
          END;
        END ELSE BEGIN
          DimErr :=
            STRSUBSTNO(
              Text018,DimVal.TABLECAPTION,DimCode);
          EXIT(FALSE);
        END;
      END;
      EXIT(TRUE);
    END;

    LOCAL PROCEDURE CheckBlockedDimAndValues@6(DimSetID@1000 : Integer) : Boolean;
    VAR
      DimSetEntry@1001 : Record 480;
    BEGIN
      IF DimSetID = 0 THEN
        EXIT(TRUE);
      DimSetEntry.RESET;
      DimSetEntry.SETRANGE("Dimension Set ID",DimSetID);
      IF DimSetEntry.FINDSET THEN
        REPEAT
          IF NOT CheckDim(DimSetEntry."Dimension Code") OR
             NOT CheckDimValue(DimSetEntry."Dimension Code",DimSetEntry."Dimension Value Code")
          THEN BEGIN
            DimValuePostingErr := DimErr;
            EXIT(FALSE);
          END;
        UNTIL DimSetEntry.NEXT = 0;
      EXIT(TRUE);
    END;

    PROCEDURE GetDimErr@71() : Text[250];
    BEGIN
      EXIT(DimErr);
    END;

    PROCEDURE LookupDimValueCodeNoUpdate@20(FieldNumber@1000 : Integer);
    VAR
      DimVal@1001 : Record 349;
      GLSetup@1002 : Record 98;
    BEGIN
      GetGLSetup;
      IF GLSetupShortcutDimCode[FieldNumber] = '' THEN
        ERROR(Text002,GLSetup.TABLECAPTION);
      DimVal.SETRANGE("Dimension Code",GLSetupShortcutDimCode[FieldNumber]);
      IF PAGE.RUNMODAL(0,DimVal) = ACTION::LookupOK THEN;
    END;

    PROCEDURE CopyJnlLineDimToICJnlDim@93(TableID@1000 : Integer;TransactionNo@1001 : Integer;PartnerCode@1002 : Code[20];TransactionSource@1008 : Option;LineNo@1003 : Integer;DimSetID@1004 : Integer);
    VAR
      InOutBoxJnlLineDim@1005 : Record 423;
      DimSetEntry@1009 : Record 480;
      ICDim@1006 : Code[20];
      ICDimValue@1007 : Code[20];
    BEGIN
      DimSetEntry.SETRANGE("Dimension Set ID",DimSetID);
      IF DimSetEntry.FINDSET THEN
        REPEAT
          ICDim := ConvertDimtoICDim(DimSetEntry."Dimension Code");
          ICDimValue := ConvertDimValuetoICDimVal(DimSetEntry."Dimension Code",DimSetEntry."Dimension Value Code");
          IF (ICDim <> '') AND (ICDimValue <> '') THEN BEGIN
            InOutBoxJnlLineDim.INIT;
            InOutBoxJnlLineDim."Table ID" := TableID;
            InOutBoxJnlLineDim."IC Partner Code" := PartnerCode;
            InOutBoxJnlLineDim."Transaction No." := TransactionNo;
            InOutBoxJnlLineDim."Transaction Source" := TransactionSource;
            InOutBoxJnlLineDim."Line No." := LineNo;
            InOutBoxJnlLineDim."Dimension Code" := ICDim;
            InOutBoxJnlLineDim."Dimension Value Code" := ICDimValue;
            InOutBoxJnlLineDim.INSERT;
          END;
        UNTIL DimSetEntry.NEXT = 0;
    END;

    PROCEDURE DefaultDimOnInsert@17(DefaultDimension@1000 : Record 352);
    VAR
      CallingTrigger@1001 : 'OnInsert,OnModify,OnDelete';
    BEGIN
      IF DefaultDimension."Table ID" = DATABASE::Job THEN
        UpdateJobTaskDim(DefaultDimension,FALSE);

      UpdateCostType(DefaultDimension,CallingTrigger::OnInsert);
    END;

    PROCEDURE DefaultDimOnModify@18(DefaultDimension@1000 : Record 352);
    VAR
      CallingTrigger@1001 : 'OnInsert,OnModify,OnDelete';
    BEGIN
      IF DefaultDimension."Table ID" = DATABASE::Job THEN
        UpdateJobTaskDim(DefaultDimension,FALSE);

      UpdateCostType(DefaultDimension,CallingTrigger::OnModify);
    END;

    PROCEDURE DefaultDimOnDelete@19(DefaultDimension@1000 : Record 352);
    VAR
      CallingTrigger@1001 : 'OnInsert,OnModify,OnDelete';
    BEGIN
      IF DefaultDimension."Table ID" = DATABASE::Job THEN
        UpdateJobTaskDim(DefaultDimension,TRUE);

      UpdateCostType(DefaultDimension,CallingTrigger::OnDelete);
    END;

    PROCEDURE CopyICJnlDimToICJnlDim@97(VAR FromInOutBoxLineDim@1001 : Record 423;VAR ToInOutBoxlineDim@1000 : Record 423);
    BEGIN
      IF FromInOutBoxLineDim.FINDSET THEN
        REPEAT
          ToInOutBoxlineDim := FromInOutBoxLineDim;
          ToInOutBoxlineDim.INSERT;
        UNTIL FromInOutBoxLineDim.NEXT = 0;
    END;

    PROCEDURE CopyDocDimtoICDocDim@107(TableID@1005 : Integer;TransactionNo@1004 : Integer;PartnerCode@1003 : Code[20];TransactionSource@1002 : Option;LineNo@1001 : Integer;DimSetEntryID@1000 : Integer);
    VAR
      InOutBoxDocDim@1008 : Record 442;
      DimSetEntry@1009 : Record 480;
      ICDim@1007 : Code[20];
      ICDimValue@1006 : Code[20];
    BEGIN
      DimSetEntry.SETRANGE("Dimension Set ID",DimSetEntryID);
      IF DimSetEntry.FINDSET THEN
        REPEAT
          ICDim := ConvertDimtoICDim(DimSetEntry."Dimension Code");
          ICDimValue := ConvertDimValuetoICDimVal(DimSetEntry."Dimension Code",DimSetEntry."Dimension Value Code");
          IF (ICDim <> '') AND (ICDimValue <> '') THEN BEGIN
            InOutBoxDocDim.INIT;
            InOutBoxDocDim."Table ID" := TableID;
            InOutBoxDocDim."IC Partner Code" := PartnerCode;
            InOutBoxDocDim."Transaction No." := TransactionNo;
            InOutBoxDocDim."Transaction Source" := TransactionSource;
            InOutBoxDocDim."Line No." := LineNo;
            InOutBoxDocDim."Dimension Code" := ICDim;
            InOutBoxDocDim."Dimension Value Code" := ICDimValue;
            InOutBoxDocDim.INSERT;
          END;
        UNTIL DimSetEntry.NEXT = 0;
    END;

    PROCEDURE CopyICDocDimtoICDocDim@108(FromSourceICDocDim@1003 : Record 442;VAR ToSourceICDocDim@1002 : Record 442;ToTableID@1001 : Integer;ToTransactionSource@1000 : Integer);
    BEGIN
      WITH FromSourceICDocDim DO BEGIN
        SetICDocDimFilters(FromSourceICDocDim,"Table ID","Transaction No.","IC Partner Code","Transaction Source","Line No.");
        IF FINDSET THEN
          REPEAT
            ToSourceICDocDim := FromSourceICDocDim;
            ToSourceICDocDim."Table ID" := ToTableID;
            ToSourceICDocDim."Transaction Source" := ToTransactionSource;
            ToSourceICDocDim.INSERT;
          UNTIL NEXT = 0;
      END;
    END;

    PROCEDURE MoveICDocDimtoICDocDim@112(FromSourceICDocDim@1003 : Record 442;VAR ToSourceICDocDim@1002 : Record 442;ToTableID@1001 : Integer;ToTransactionSource@1000 : Integer);
    BEGIN
      WITH FromSourceICDocDim DO BEGIN
        SetICDocDimFilters(FromSourceICDocDim,"Table ID","Transaction No.","IC Partner Code","Transaction Source","Line No.");
        IF FINDSET THEN
          REPEAT
            ToSourceICDocDim := FromSourceICDocDim;
            ToSourceICDocDim."Table ID" := ToTableID;
            ToSourceICDocDim."Transaction Source" := ToTransactionSource;
            ToSourceICDocDim.INSERT;
            DELETE;
          UNTIL NEXT = 0;
      END;
    END;

    PROCEDURE SetICDocDimFilters@110(VAR ICDocDim@1000 : Record 442;TableID@1001 : Integer;TransactionNo@1002 : Integer;PartnerCode@1003 : Code[20];TransactionSource@1004 : Integer;LineNo@1005 : Integer);
    BEGIN
      ICDocDim.RESET;
      ICDocDim.SETRANGE("Table ID",TableID);
      ICDocDim.SETRANGE("Transaction No.",TransactionNo);
      ICDocDim.SETRANGE("IC Partner Code",PartnerCode);
      ICDocDim.SETRANGE("Transaction Source",TransactionSource);
      ICDocDim.SETRANGE("Line No.",LineNo);
    END;

    PROCEDURE DeleteICDocDim@109(TableID@1000 : Integer;ICTransactionNo@1001 : Integer;ICPartnerCode@1002 : Code[20];TransactionSource@1003 : Option;LineNo@1005 : Integer);
    VAR
      ICDocDim@1004 : Record 442;
    BEGIN
      SetICDocDimFilters(ICDocDim,TableID,ICTransactionNo,ICPartnerCode,TransactionSource,LineNo);
      IF NOT ICDocDim.ISEMPTY THEN
        ICDocDim.DELETEALL;
    END;

    PROCEDURE DeleteICJnlDim@116(TableID@1000 : Integer;ICTransactionNo@1001 : Integer;ICPartnerCode@1002 : Code[20];TransactionSource@1003 : Option;LineNo@1005 : Integer);
    VAR
      ICJnlDim@1004 : Record 423;
    BEGIN
      ICJnlDim.SETRANGE("Table ID",TableID);
      ICJnlDim.SETRANGE("Transaction No.",ICTransactionNo);
      ICJnlDim.SETRANGE("IC Partner Code",ICPartnerCode);
      ICJnlDim.SETRANGE("Transaction Source",TransactionSource);
      ICJnlDim.SETRANGE("Line No.",LineNo);
      IF NOT ICJnlDim.ISEMPTY THEN
        ICJnlDim.DELETEALL;
    END;

    LOCAL PROCEDURE ConvertICDimtoDim@99(FromICDim@1000 : Code[20]) DimCode : Code[20];
    VAR
      ICDim@1002 : Record 411;
    BEGIN
      IF ICDim.GET(FromICDim) THEN
        DimCode := ICDim."Map-to Dimension Code";
    END;

    LOCAL PROCEDURE ConvertICDimValuetoDimValue@100(FromICDim@1000 : Code[20];FromICDimValue@1001 : Code[20]) DimValueCode : Code[20];
    VAR
      ICDimValue@1002 : Record 412;
    BEGIN
      IF ICDimValue.GET(FromICDim,FromICDimValue) THEN
        DimValueCode := ICDimValue."Map-to Dimension Value Code";
    END;

    PROCEDURE ConvertDimtoICDim@102(FromDim@1001 : Code[20]) ICDimCode : Code[20];
    VAR
      Dim@1000 : Record 348;
    BEGIN
      IF Dim.GET(FromDim) THEN
        ICDimCode := Dim."Map-to IC Dimension Code";
    END;

    PROCEDURE ConvertDimValuetoICDimVal@103(FromDim@1000 : Code[20];FromDimValue@1001 : Code[20]) ICDimValueCode : Code[20];
    VAR
      DimValue@1002 : Record 349;
    BEGIN
      IF DimValue.GET(FromDim,FromDimValue) THEN
        ICDimValueCode := DimValue."Map-to IC Dimension Value Code";
    END;

    PROCEDURE CheckICDimValue@113(ICDimCode@1001 : Code[20];ICDimValCode@1000 : Code[20]) : Boolean;
    VAR
      ICDimVal@1002 : Record 412;
    BEGIN
      IF (ICDimCode <> '') AND (ICDimValCode <> '') THEN BEGIN
        IF ICDimVal.GET(ICDimCode,ICDimValCode) THEN BEGIN
          IF ICDimVal.Blocked THEN BEGIN
            DimErr :=
              STRSUBSTNO(
                Text016,ICDimVal.TABLECAPTION,ICDimCode,ICDimValCode);
            EXIT(FALSE);
          END;
          IF NOT (ICDimVal."Dimension Value Type" IN
                  [ICDimVal."Dimension Value Type"::Standard,
                   ICDimVal."Dimension Value Type"::"Begin-Total"])
          THEN BEGIN
            DimErr :=
              STRSUBSTNO(Text017,ICDimVal.FIELDCAPTION("Dimension Value Type"),
                ICDimVal.TABLECAPTION,ICDimCode,ICDimValCode,FORMAT(ICDimVal."Dimension Value Type"));
            EXIT(FALSE);
          END;
        END ELSE BEGIN
          DimErr :=
            STRSUBSTNO(
              Text018,ICDimVal.TABLECAPTION,ICDimCode);
          EXIT(FALSE);
        END;
      END;
      EXIT(TRUE);
    END;

    PROCEDURE CheckICDim@114(ICDimCode@1000 : Code[20]) : Boolean;
    VAR
      ICDim@1001 : Record 411;
    BEGIN
      IF ICDim.GET(ICDimCode) THEN BEGIN
        IF ICDim.Blocked THEN BEGIN
          DimErr :=
            STRSUBSTNO(Text014,ICDim.TABLECAPTION,ICDimCode);
          EXIT(FALSE);
        END;
      END ELSE BEGIN
        DimErr :=
          STRSUBSTNO(Text015,ICDim.TABLECAPTION,ICDimCode);
        EXIT(FALSE);
      END;
      EXIT(TRUE);
    END;

    PROCEDURE SaveJobTaskDim@39(JobNo@1000 : Code[20];JobTaskNo@1001 : Code[20];FieldNumber@1003 : Integer;ShortcutDimCode@1002 : Code[20]);
    VAR
      JobTaskDim@1004 : Record 1002;
    BEGIN
      GetGLSetup;
      IF ShortcutDimCode <> '' THEN BEGIN
        IF JobTaskDim.GET(JobNo,JobTaskNo,GLSetupShortcutDimCode[FieldNumber])
        THEN BEGIN
          JobTaskDim.VALIDATE("Dimension Value Code",ShortcutDimCode);
          JobTaskDim.MODIFY;
        END ELSE BEGIN
          JobTaskDim.INIT;
          JobTaskDim.VALIDATE("Job No.",JobNo);
          JobTaskDim.VALIDATE("Job Task No.",JobTaskNo);
          JobTaskDim.VALIDATE("Dimension Code",GLSetupShortcutDimCode[FieldNumber]);
          JobTaskDim.VALIDATE("Dimension Value Code",ShortcutDimCode);
          JobTaskDim.INSERT;
        END;
      END ELSE
        IF JobTaskDim.GET(JobNo,JobTaskNo,GLSetupShortcutDimCode[FieldNumber]) THEN
          JobTaskDim.DELETE;
    END;

    PROCEDURE SaveJobTaskTempDim@46(FieldNumber@1001 : Integer;ShortcutDimCode@1000 : Code[20]);
    BEGIN
      GetGLSetup;
      IF ShortcutDimCode <> '' THEN BEGIN
        IF JobTaskDimTemp.GET('','',GLSetupShortcutDimCode[FieldNumber])
        THEN BEGIN
          JobTaskDimTemp."Dimension Value Code" := ShortcutDimCode;
          JobTaskDimTemp.MODIFY;
        END ELSE BEGIN
          JobTaskDimTemp.INIT;
          JobTaskDimTemp."Dimension Code" := GLSetupShortcutDimCode[FieldNumber];
          JobTaskDimTemp."Dimension Value Code" := ShortcutDimCode;
          JobTaskDimTemp.INSERT;
        END;
      END ELSE
        IF JobTaskDimTemp.GET('','',GLSetupShortcutDimCode[FieldNumber]) THEN
          JobTaskDimTemp.DELETE;
    END;

    PROCEDURE InsertJobTaskDim@54(JobNo@1000 : Code[20];JobTaskNo@1001 : Code[20];VAR GlobalDim1Code@1005 : Code[20];VAR GlobalDim2Code@1004 : Code[20]);
    VAR
      DefaultDim@1002 : Record 352;
      JobTaskDim@1003 : Record 1002;
    BEGIN
      GetGLSetup;
      DefaultDim.SETRANGE("Table ID",DATABASE::Job);
      DefaultDim.SETRANGE("No.",JobNo);
      IF DefaultDim.FINDSET(FALSE,FALSE) THEN
        REPEAT
          IF DefaultDim."Dimension Value Code" <> '' THEN BEGIN
            JobTaskDim.INIT;
            JobTaskDim."Job No." := JobNo;
            JobTaskDim."Job Task No." := JobTaskNo;
            JobTaskDim."Dimension Code" := DefaultDim."Dimension Code";
            JobTaskDim."Dimension Value Code" := DefaultDim."Dimension Value Code";
            JobTaskDim.INSERT;
            IF JobTaskDim."Dimension Code" = GLSetupShortcutDimCode[1] THEN
              GlobalDim1Code := JobTaskDim."Dimension Value Code";
            IF JobTaskDim."Dimension Code" = GLSetupShortcutDimCode[2] THEN
              GlobalDim2Code := JobTaskDim."Dimension Value Code";
          END;
        UNTIL DefaultDim.NEXT = 0;

      JobTaskDimTemp.RESET;
      IF JobTaskDimTemp.FINDSET THEN
        REPEAT
          IF NOT JobTaskDim.GET(JobNo,JobTaskNo,JobTaskDimTemp."Dimension Code") THEN BEGIN
            JobTaskDim.INIT;
            JobTaskDim."Job No." := JobNo;
            JobTaskDim."Job Task No." := JobTaskNo;
            JobTaskDim."Dimension Code" := JobTaskDimTemp."Dimension Code";
            JobTaskDim."Dimension Value Code" := JobTaskDimTemp."Dimension Value Code";
            JobTaskDim.INSERT;
            IF JobTaskDim."Dimension Code" = GLSetupShortcutDimCode[1] THEN
              GlobalDim1Code := JobTaskDim."Dimension Value Code";
            IF JobTaskDim."Dimension Code" = GLSetupShortcutDimCode[2] THEN
              GlobalDim2Code := JobTaskDim."Dimension Value Code";
          END;
        UNTIL JobTaskDimTemp.NEXT = 0;
      JobTaskDimTemp.DELETEALL;
    END;

    LOCAL PROCEDURE UpdateJobTaskDim@15(DefaultDimension@1000 : Record 352;FromOnDelete@1003 : Boolean);
    VAR
      JobTaskDimension@1001 : Record 1002;
      JobTask@1002 : Record 1001;
    BEGIN
      IF DefaultDimension."Table ID" <> DATABASE::Job THEN
        EXIT;

      JobTask.SETRANGE("Job No.",DefaultDimension."No.");
      IF JobTask.ISEMPTY THEN
        EXIT;

      IF NOT CONFIRM(Text019,TRUE) THEN
        EXIT;

      JobTaskDimension.SETRANGE("Job No.",DefaultDimension."No.");
      JobTaskDimension.SETRANGE("Dimension Code",DefaultDimension."Dimension Code");
      JobTaskDimension.DELETEALL(TRUE);

      IF FromOnDelete OR
         (DefaultDimension."Value Posting" = DefaultDimension."Value Posting"::"No Code") OR
         (DefaultDimension."Dimension Value Code" = '')
      THEN
        EXIT;

      IF JobTask.FINDSET THEN
        REPEAT
          CLEAR(JobTaskDimension);
          JobTaskDimension."Job No." := JobTask."Job No.";
          JobTaskDimension."Job Task No." := JobTask."Job Task No.";
          JobTaskDimension."Dimension Code" := DefaultDimension."Dimension Code";
          JobTaskDimension."Dimension Value Code" := DefaultDimension."Dimension Value Code";
          JobTaskDimension.INSERT(TRUE);
        UNTIL JobTask.NEXT = 0;
    END;

    PROCEDURE DeleteJobTaskTempDim@76();
    BEGIN
      JobTaskDimTemp.RESET;
      JobTaskDimTemp.DELETEALL;
    END;

    PROCEDURE CopyJobTaskDimToJobTaskDim@77(JobNo@1000 : Code[20];JobTaskNo@1001 : Code[20];NewJobNo@1002 : Code[20];NewJobTaskNo@1003 : Code[20]);
    VAR
      JobTaskDimension@1004 : Record 1002;
      JobTaskDimension2@1005 : Record 1002;
    BEGIN
      JobTaskDimension.RESET;
      JobTaskDimension.SETRANGE("Job No.",JobNo);
      JobTaskDimension.SETRANGE("Job Task No.",JobTaskNo);
      IF JobTaskDimension.FINDSET THEN
        REPEAT
          IF NOT JobTaskDimension2.GET(NewJobNo,NewJobTaskNo,JobTaskDimension."Dimension Code") THEN BEGIN
            JobTaskDimension2.INIT;
            JobTaskDimension2."Job No." := NewJobNo;
            JobTaskDimension2."Job Task No." := NewJobTaskNo;
            JobTaskDimension2."Dimension Code" := JobTaskDimension."Dimension Code";
            JobTaskDimension2."Dimension Value Code" := JobTaskDimension."Dimension Value Code";
            JobTaskDimension2.INSERT(TRUE);
          END;
        UNTIL JobTaskDimension.NEXT = 0;
    END;

    PROCEDURE CheckDimIDConsistency@10(VAR DimSetEntry@1000 : Record 480;VAR PostedDimSetEntry@1001 : Record 480;DocTableID@1002 : Integer;PostedDocTableID@1003 : Integer) : Boolean;
    BEGIN
      IF DimSetEntry.FINDSET THEN;
      IF PostedDimSetEntry.FINDSET THEN;
      REPEAT
        CASE TRUE OF
          DimSetEntry."Dimension Code" > PostedDimSetEntry."Dimension Code":
            BEGIN
              DocDimConsistencyErr :=
                STRSUBSTNO(
                  Text012,
                  DimSetEntry.FIELDCAPTION("Dimension Code"),
                  ObjTransl.TranslateObject(ObjTransl."Object Type"::Table,DocTableID),
                  ObjTransl.TranslateObject(ObjTransl."Object Type"::Table,PostedDocTableID));
              EXIT(FALSE);
            END;
          DimSetEntry."Dimension Code" < PostedDimSetEntry."Dimension Code":
            BEGIN
              DocDimConsistencyErr :=
                STRSUBSTNO(
                  Text012,
                  PostedDimSetEntry.FIELDCAPTION("Dimension Code"),
                  ObjTransl.TranslateObject(ObjTransl."Object Type"::Table,PostedDocTableID),
                  ObjTransl.TranslateObject(ObjTransl."Object Type"::Table,DocTableID));
              EXIT(FALSE);
            END;
          DimSetEntry."Dimension Code" = PostedDimSetEntry."Dimension Code":
            BEGIN
              IF DimSetEntry."Dimension Value Code" <> PostedDimSetEntry."Dimension Value Code" THEN BEGIN
                DocDimConsistencyErr :=
                  STRSUBSTNO(
                    Text013,
                    DimSetEntry.FIELDCAPTION("Dimension Value Code"),
                    DimSetEntry.FIELDCAPTION("Dimension Code"),
                    DimSetEntry."Dimension Code",
                    ObjTransl.TranslateObject(ObjTransl."Object Type"::Table,DocTableID),
                    ObjTransl.TranslateObject(ObjTransl."Object Type"::Table,PostedDocTableID));
                EXIT(FALSE);
              END;
            END;
        END;
      UNTIL (DimSetEntry.NEXT = 0) AND (PostedDimSetEntry.NEXT = 0);
      EXIT(TRUE);
    END;

    LOCAL PROCEDURE CreateDimSetEntryFromDimValue@4(DimValue@1000 : Record 349;VAR TempDimSetEntry@1001 : TEMPORARY Record 480);
    BEGIN
      TempDimSetEntry."Dimension Code" := DimValue."Dimension Code";
      TempDimSetEntry."Dimension Value Code" := DimValue.Code;
      TempDimSetEntry."Dimension Value ID" := DimValue."Dimension Value ID";
      TempDimSetEntry.INSERT;
    END;

    PROCEDURE CreateDimSetIDFromICDocDim@5(VAR ICDocDim@1000 : Record 442) : Integer;
    VAR
      DimValue@1004 : Record 349;
      TempDimSetEntry@1003 : TEMPORARY Record 480;
    BEGIN
      IF ICDocDim.FIND('-') THEN
        REPEAT
          DimValue.GET(
            ConvertICDimtoDim(ICDocDim."Dimension Code"),
            ConvertICDimValuetoDimValue(ICDocDim."Dimension Code",ICDocDim."Dimension Value Code"));
          CreateDimSetEntryFromDimValue(DimValue,TempDimSetEntry);
        UNTIL ICDocDim.NEXT = 0;
      EXIT(GetDimensionSetID(TempDimSetEntry));
    END;

    PROCEDURE CreateDimSetIDFromICJnlLineDim@7(VAR ICInboxOutboxJnlLineDim@1000 : Record 423) : Integer;
    VAR
      DimValue@1001 : Record 349;
      TempDimSetEntry@1002 : TEMPORARY Record 480;
    BEGIN
      IF ICInboxOutboxJnlLineDim.FIND('-') THEN
        REPEAT
          DimValue.GET(
            ConvertICDimtoDim(ICInboxOutboxJnlLineDim."Dimension Code"),
            ConvertICDimValuetoDimValue(
              ICInboxOutboxJnlLineDim."Dimension Code",ICInboxOutboxJnlLineDim."Dimension Value Code"));
          CreateDimSetEntryFromDimValue(DimValue,TempDimSetEntry);
        UNTIL ICInboxOutboxJnlLineDim.NEXT = 0;
      EXIT(GetDimensionSetID(TempDimSetEntry));
    END;

    PROCEDURE CopyDimBufToDimSetEntry@65(VAR FromDimBuf@1000 : Record 360;VAR DimSetEntry@1001 : Record 480);
    VAR
      DimValue@1005 : Record 349;
    BEGIN
      WITH FromDimBuf DO
        IF FINDSET THEN
          REPEAT
            DimValue.GET("Dimension Code","Dimension Value Code");
            DimSetEntry."Dimension Code" := "Dimension Code";
            DimSetEntry."Dimension Value Code" := "Dimension Value Code";
            DimSetEntry."Dimension Value ID" := DimValue."Dimension Value ID";
            DimSetEntry.INSERT;
          UNTIL NEXT = 0;
    END;

    PROCEDURE CreateDimSetIDFromDimBuf@12(VAR DimBuf@1000 : Record 360) : Integer;
    VAR
      DimValue@1001 : Record 349;
      TempDimSetEntry@1002 : TEMPORARY Record 480;
    BEGIN
      IF DimBuf.FINDSET THEN
        REPEAT
          DimValue.GET(DimBuf."Dimension Code",DimBuf."Dimension Value Code");
          CreateDimSetEntryFromDimValue(DimValue,TempDimSetEntry);
        UNTIL DimBuf.NEXT = 0;
      EXIT(GetDimensionSetID(TempDimSetEntry));
    END;

    PROCEDURE GetDimSetIDsForFilter@23(DimCode@1000 : Code[20];DimValueFilter@1001 : Text[250]);
    VAR
      DimSetEntry2@1002 : Record 480;
    BEGIN
      DimSetEntry2.SETFILTER("Dimension Code",'%1',DimCode);
      DimSetEntry2.SETFILTER("Dimension Value Code",DimValueFilter);
      IF DimSetEntry2.FINDSET THEN
        REPEAT
          AddDimSetIDtoTempEntry(TempDimSetEntry2,DimSetEntry2."Dimension Set ID");
        UNTIL DimSetEntry2.NEXT = 0;
      IF FilterIncludesBlank(DimCode,DimValueFilter) THEN
        GetDimSetIDsForBlank(DimCode);
      DimSetFilterCtr += 1;
    END;

    LOCAL PROCEDURE GetDimSetIDsForBlank@27(DimCode@1000 : Code[20]);
    VAR
      TempDimSetEntry@1001 : TEMPORARY Record 480;
      DimSetEntry2@1002 : Record 480;
      PrevDimSetID@1004 : Integer;
      i@1003 : Integer;
    BEGIN
      AddDimSetIDtoTempEntry(TempDimSetEntry,0);
      FOR i := 1 TO 2 DO BEGIN
        IF i = 2 THEN
          DimSetEntry2.SETFILTER("Dimension Code",'%1',DimCode);
        IF DimSetEntry2.FINDSET THEN BEGIN
          PrevDimSetID := 0;
          REPEAT
            IF DimSetEntry2."Dimension Set ID" <> PrevDimSetID THEN BEGIN
              AddDimSetIDtoTempEntry(TempDimSetEntry,DimSetEntry2."Dimension Set ID");
              PrevDimSetID := DimSetEntry2."Dimension Set ID";
            END;
          UNTIL DimSetEntry2.NEXT = 0;
        END;
      END;
      TempDimSetEntry.SETFILTER("Dimension Value ID",'%1',1);
      IF TempDimSetEntry.FINDSET THEN
        REPEAT
          AddDimSetIDtoTempEntry(TempDimSetEntry2,TempDimSetEntry."Dimension Set ID");
        UNTIL TempDimSetEntry.NEXT = 0;
    END;

    PROCEDURE GetNextDimSetFilterChunk@24(Length@1000 : Integer) DimSetFilterChunk : Text[1024];
    VAR
      EndLoop@1002 : Boolean;
    BEGIN
      IF Length > MAXSTRLEN(DimSetFilterChunk) THEN
        Length := MAXSTRLEN(DimSetFilterChunk);
      TempDimSetEntry2.SETFILTER("Dimension Value ID",'%1',DimSetFilterCtr);
      TempDimSetEntry2.SETFILTER("Dimension Set ID",'>%1',LastDimSetIDInFilter);
      IF TempDimSetEntry2.FINDSET THEN BEGIN
        DimSetFilterChunk := FORMAT(TempDimSetEntry2."Dimension Set ID");
        LastDimSetIDInFilter := TempDimSetEntry2."Dimension Set ID";
        WHILE (STRLEN(DimSetFilterChunk) < Length) AND (NOT EndLoop) DO BEGIN
          IF TempDimSetEntry2.NEXT <> 0 THEN BEGIN
            IF STRLEN(DimSetFilterChunk + '|' + FORMAT(TempDimSetEntry2."Dimension Set ID")) <= Length THEN BEGIN
              DimSetFilterChunk += '|' + FORMAT(TempDimSetEntry2."Dimension Set ID");
              LastDimSetIDInFilter := TempDimSetEntry2."Dimension Set ID";
            END ELSE
              EndLoop := TRUE;
          END ELSE
            EndLoop := TRUE;
        END;
      END;
    END;

    LOCAL PROCEDURE FilterIncludesBlank@25(DimCode@1001 : Code[20];DimValueFilter@1000 : Text[250]) : Boolean;
    VAR
      TempDimSetEntry@1002 : TEMPORARY Record 480;
    BEGIN
      TempDimSetEntry."Dimension Code" := DimCode;
      TempDimSetEntry.INSERT;
      TempDimSetEntry.SETFILTER("Dimension Value Code",DimValueFilter);
      EXIT(NOT TempDimSetEntry.ISEMPTY);
    END;

    LOCAL PROCEDURE AddDimSetIDtoTempEntry@30(VAR TempDimSetEntry@1001 : TEMPORARY Record 480;DimSetID@1000 : Integer);
    BEGIN
      IF TempDimSetEntry.GET(DimSetID,'') THEN BEGIN
        TempDimSetEntry."Dimension Value ID" += 1;
        TempDimSetEntry.MODIFY;
      END ELSE BEGIN
        TempDimSetEntry."Dimension Set ID" := DimSetID;
        TempDimSetEntry."Dimension Value ID" := 1;
        TempDimSetEntry.INSERT
      END;
    END;

    PROCEDURE ClearDimSetFilter@26();
    BEGIN
      TempDimSetEntry2.RESET;
      TempDimSetEntry2.DELETEALL;
      DimSetFilterCtr := 0;
      LastDimSetIDInFilter := 0;
    END;

    PROCEDURE GetTempDimSetEntry@31(VAR TempDimSetEntry@1000 : TEMPORARY Record 480);
    BEGIN
      TempDimSetEntry.COPY(TempDimSetEntry2,TRUE);
    END;

    LOCAL PROCEDURE UpdateCostType@28(DefaultDimension@1000 : Record 352;CallingTrigger@1004 : 'OnInsert,OnModify,OnDelete');
    VAR
      GLAcc@1003 : Record 15;
      CostAccSetup@1002 : Record 1108;
      CostAccMgt@1001 : Codeunit 1100;
    BEGIN
      IF CostAccSetup.GET AND (DefaultDimension."Table ID" = DATABASE::"G/L Account") THEN
        IF GLAcc.GET(DefaultDimension."No.") THEN
          CostAccMgt.UpdateCostTypeFromDefaultDimension(DefaultDimension,GLAcc,CallingTrigger);
    END;

    PROCEDURE CreateDimSetFromJobTaskDim@32(JobNo@1006 : Code[20];JobTaskNo@1001 : Code[20];VAR GlobalDimVal1@1005 : Code[20];VAR GlobalDimVal2@1004 : Code[20]) NewDimSetID : Integer;
    VAR
      JobTaskDimension@1000 : Record 1002;
      DimValue@1002 : Record 349;
      TempDimSetEntry@1003 : TEMPORARY Record 480;
    BEGIN
      WITH JobTaskDimension DO BEGIN
        SETRANGE("Job No.",JobNo);
        SETRANGE("Job Task No.",JobTaskNo);
        IF FINDSET THEN BEGIN
          REPEAT
            DimValue.GET("Dimension Code","Dimension Value Code");
            TempDimSetEntry."Dimension Code" := "Dimension Code";
            TempDimSetEntry."Dimension Value Code" := "Dimension Value Code";
            TempDimSetEntry."Dimension Value ID" := DimValue."Dimension Value ID";
            TempDimSetEntry.INSERT(TRUE);
          UNTIL NEXT = 0;
          NewDimSetID := GetDimensionSetID(TempDimSetEntry);
          UpdateGlobalDimFromDimSetID(NewDimSetID,GlobalDimVal1,GlobalDimVal2);
        END;
      END;
    END;

    PROCEDURE UpdateGenJnlLineDim@34(VAR GenJnlLine@1000 : Record 81;DimSetID@1001 : Integer);
    BEGIN
      GenJnlLine."Dimension Set ID" := DimSetID;
      UpdateGlobalDimFromDimSetID(
        GenJnlLine."Dimension Set ID",
        GenJnlLine."Shortcut Dimension 1 Code",GenJnlLine."Shortcut Dimension 2 Code");
    END;

    PROCEDURE UpdateGenJnlLineDimFromCustLedgEntry@33(VAR GenJnlLine@1000 : Record 81;DtldCustLedgEntry@1001 : Record 379);
    VAR
      CustLedgEntry@1002 : Record 21;
    BEGIN
      IF DtldCustLedgEntry."Cust. Ledger Entry No." <> 0 THEN BEGIN
        CustLedgEntry.GET(DtldCustLedgEntry."Cust. Ledger Entry No.");
        UpdateGenJnlLineDim(GenJnlLine,CustLedgEntry."Dimension Set ID");
      END;
    END;

    PROCEDURE UpdateGenJnlLineDimFromVendLedgEntry@29(VAR GenJnlLine@1001 : Record 81;DtldVendLedgEntry@1000 : Record 380);
    VAR
      VendLedgEntry@1002 : Record 25;
    BEGIN
      IF DtldVendLedgEntry."Vendor Ledger Entry No." <> 0 THEN BEGIN
        VendLedgEntry.GET(DtldVendLedgEntry."Vendor Ledger Entry No.");
        UpdateGenJnlLineDim(GenJnlLine,VendLedgEntry."Dimension Set ID");
      END;
    END;

    PROCEDURE GetDimSetEntryDefaultDim@45(VAR DimSetEntry2@1001 : Record 480);
    VAR
      DimValue@1000 : Record 349;
    BEGIN
      IF NOT DimSetEntry2.ISEMPTY THEN
        DimSetEntry2.DELETEALL;
      IF TempDimBuf2.FINDSET THEN
        REPEAT
          DimValue.GET(TempDimBuf2."Dimension Code",TempDimBuf2."Dimension Value Code");
          DimSetEntry2."Dimension Code" := TempDimBuf2."Dimension Code";
          DimSetEntry2."Dimension Value Code" := TempDimBuf2."Dimension Value Code";
          DimSetEntry2."Dimension Value ID" := DimValue."Dimension Value ID";
          DimSetEntry2.INSERT;
        UNTIL TempDimBuf2.NEXT = 0;
      TempDimBuf2.RESET;
      TempDimBuf2.DELETEALL;
    END;

    PROCEDURE InsertObject@35(VAR TempAllObjWithCaption@1000 : TEMPORARY Record 2000000058;TableID@1001 : Integer);
    VAR
      AllObjWithCaption@1002 : Record 2000000058;
    BEGIN
      AllObjWithCaption.SETRANGE("Object Type",AllObjWithCaption."Object Type"::Table);
      AllObjWithCaption.SETRANGE("Object ID",TableID);
      IF AllObjWithCaption.FINDFIRST THEN BEGIN
        TempAllObjWithCaption := AllObjWithCaption;
        TempAllObjWithCaption.INSERT;
      END;
    END;

    PROCEDURE GetConsolidatedDimFilterByDimFilter@37(VAR Dimension@1000 : Record 348;DimFilter@1001 : Text) ConsolidatedDimFilter : Text;
    BEGIN
      Dimension.SETFILTER("Consolidation Code",DimFilter);
      ConsolidatedDimFilter += DimFilter;
      IF Dimension.FINDSET THEN
        REPEAT
          ConsolidatedDimFilter += '|' + Dimension.Code;
        UNTIL Dimension.NEXT = 0;
    END;

    PROCEDURE AddDimToDimSet@70000(VAR DimSetID@1000 : Integer;DimCode@1001 : Code[20];DimValue@1003 : Code[20]) : Boolean;
    VAR
      DimVal@1002 : Record 349;
      TempDimSetEntry@1004 : TEMPORARY Record 480;
    BEGIN
      //CMP001 Function created
      IF DimValue <> '' THEN BEGIN
        IF NOT DimVal.GET(DimCode, DimValue) THEN BEGIN
          EXIT(FALSE);
        END;
      END;

      GetDimensionSet(TempDimSetEntry, DimSetID);
      IF TempDimSetEntry.GET(DimSetID, DimCode) THEN BEGIN
        IF TempDimSetEntry."Dimension Value Code" <> DimValue THEN BEGIN
          TempDimSetEntry.DELETE;
        END ELSE BEGIN
          EXIT(TRUE);
        END;
      END;
      IF DimValue <> '' THEN BEGIN
        TempDimSetEntry."Dimension Set ID" := DimSetID;
        TempDimSetEntry."Dimension Code" := DimVal."Dimension Code";
        TempDimSetEntry."Dimension Value Code" := DimVal.Code;
        TempDimSetEntry."Dimension Value ID" := DimVal."Dimension Value ID";
        TempDimSetEntry.INSERT;
      END;
      DimSetID := GetDimensionSetID(TempDimSetEntry);
      EXIT(TRUE);
    END;

    PROCEDURE CopyDimSetToDimSet@70001(FromDimSetID@1000 : Integer;ToDimSetID@1001 : Integer) ResultDimSetID : Integer;
    VAR
      TempDimSetEntry@1002 : TEMPORARY Record 480;
      TempDimSetEntry2@1003 : TEMPORARY Record 480;
    BEGIN
      //CMP001 Function created

      IF FromDimSetID = 0 THEN BEGIN
        EXIT(ToDimSetID);
      END;
      IF ToDimSetID = 0 THEN BEGIN
        EXIT(FromDimSetID);
      END;

      GetDimensionSet(TempDimSetEntry, FromDimSetID);
      GetDimensionSet(TempDimSetEntry2, ToDimSetID);
      IF TempDimSetEntry.FINDSET THEN BEGIN
        REPEAT
          IF TempDimSetEntry2.GET(ToDimSetID, TempDimSetEntry."Dimension Code") THEN BEGIN
            TempDimSetEntry2."Dimension Value Code" := TempDimSetEntry."Dimension Value Code";
            TempDimSetEntry2."Dimension Value ID" := TempDimSetEntry."Dimension Value ID";
            TempDimSetEntry2.MODIFY;
          END ELSE BEGIN
            TempDimSetEntry2."Dimension Set ID" := ToDimSetID;
            TempDimSetEntry2."Dimension Code" := TempDimSetEntry."Dimension Code";
            TempDimSetEntry2."Dimension Value Code" := TempDimSetEntry."Dimension Value Code";
            TempDimSetEntry2."Dimension Value ID" := TempDimSetEntry."Dimension Value ID";
            TempDimSetEntry2.INSERT;
          END;
        UNTIL TempDimSetEntry.NEXT = 0;
      END;

      ResultDimSetID := GetDimensionSetID(TempDimSetEntry2);
    END;

    [Integration]
    PROCEDURE OnAfterSetupObjectNoList@2(VAR TempAllObjWithCaption@1000 : TEMPORARY Record 2000000058);
    BEGIN
    END;

    BEGIN
    {
      CMP001 1.00 2014-07-23 Integration with Compello Document Management
                               New Functions: AddDimToDimSet(), CopyDimSetToDimSet()
    }
    END.
  }
}

OBJECT Codeunit 5150 Integration Management
{
  OBJECT-PROPERTIES
  {
    Date=01.10.16;
    Time=11:00:00;
    Modified=Yes;
    Version List=NAVW110.00,CMP1.00;
  }
  PROPERTIES
  {
    Permissions=TableData 112=rm,
                TableData 113=rm;
    SingleInstance=Yes;
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      IntegrationIsActivated@1003 : Boolean;
      PageServiceNameTok@1004 : TextConst 'ENU=Integration %1;NOR=Integrering %1';
      IntegrationServicesEnabledMsg@1006 : TextConst '@@@=%1 - product name;ENU=Integration services have been enabled.\The %1 service should be restarted.;NOR=Integreringstjenester er aktivert.\Tjenesten %1 m† startes p† nytt.';
      IntegrationServicesDisabledMsg@1005 : TextConst '@@@=%1 - product name;ENU=Integration services have been disabled.\The %1 service should be restarted.;NOR=Integreringstjenester er deaktivert.\Tjenesten %1 m† startes p† nytt.';
      CompelloIntegrMgt@1007 : Codeunit 70000;

    PROCEDURE GetDatabaseTableTriggerSetup@1(TableID@1000 : Integer;VAR Insert@1001 : Boolean;VAR Modify@1002 : Boolean;VAR Delete@1003 : Boolean;VAR Rename@1004 : Boolean);
    BEGIN
      IF COMPANYNAME = '' THEN
        EXIT;
      //CMP001 Start
      IF CompelloIntegrMgt.IsIntegrationRecord(TableID) THEN BEGIN
        Insert := TRUE;
        Modify := TRUE;
        Delete := TRUE;
        Rename := TRUE;
        EXIT;
      END;
      //CMP001 End
      IF NOT GetIntegrationActivated THEN
        EXIT;

      IF IsIntegrationRecord(TableID) OR IsIntegrationRecordChild(TableID) THEN BEGIN
        Insert := TRUE;
        Modify := TRUE;
        Delete := TRUE;
        Rename := TRUE;
      END;
    END;

    PROCEDURE OnDatabaseInsert@2(RecRef@1000 : RecordRef);
    VAR
      TimeStamp@1001 : DateTime;
    BEGIN
      //CMP001 Start
      CompelloIntegrMgt.OnDatabaseInsert(RecRef);
      //CMP001 End
      IF NOT GetIntegrationActivated THEN
        EXIT;

      TimeStamp := CURRENTDATETIME;
      UpdateParentIntegrationRecord(RecRef,TimeStamp);
      InsertUpdateIntegrationRecord(RecRef,TimeStamp);
    END;

    PROCEDURE OnDatabaseModify@3(RecRef@1000 : RecordRef);
    VAR
      TimeStamp@1001 : DateTime;
    BEGIN
      //CMP001 Start
      CompelloIntegrMgt.OnDatabaseModify(RecRef);
      //CMP001 End
      IF NOT GetIntegrationActivated THEN
        EXIT;

      TimeStamp := CURRENTDATETIME;
      UpdateParentIntegrationRecord(RecRef,TimeStamp);
      InsertUpdateIntegrationRecord(RecRef,TimeStamp);
    END;

    PROCEDURE OnDatabaseDelete@4(RecRef@1000 : RecordRef);
    VAR
      SalesHeader@1002 : Record 36;
      IntegrationRecord@1001 : Record 5151;
      SkipDeletion@1004 : Boolean;
      TimeStamp@1003 : DateTime;
    BEGIN
      //CMP001 Start
      CompelloIntegrMgt.OnDatabaseDelete(RecRef);
      //CMP001 End
      IF NOT GetIntegrationActivated THEN
        EXIT;

      TimeStamp := CURRENTDATETIME;
      UpdateParentIntegrationRecord(RecRef,TimeStamp);
      IF IsIntegrationRecord(RecRef.NUMBER) THEN BEGIN
        IntegrationRecord.SETRANGE("Record ID",RecRef.RECORDID);
        IF IntegrationRecord.FINDFIRST THEN BEGIN
          // Handle exceptions where "Deleted On" should not be set.
          IF RecRef.NUMBER = DATABASE::"Sales Header" THEN BEGIN
            RecRef.SETTABLE(SalesHeader);
            SkipDeletion := SalesHeader.Invoice;
          END;

          IF NOT SkipDeletion THEN
            IntegrationRecord."Deleted On" := TimeStamp;

          CLEAR(IntegrationRecord."Record ID");
          IntegrationRecord."Modified On" := TimeStamp;
          IntegrationRecord.MODIFY;
        END;
      END;
    END;

    PROCEDURE OnDatabaseRename@5(RecRef@1000 : RecordRef;XRecRef@1001 : RecordRef);
    VAR
      IntegrationRecord@1003 : Record 5151;
      TimeStamp@1002 : DateTime;
    BEGIN
      //CMP001 Start
      CompelloIntegrMgt.OnDatabaseRename(RecRef, XRecRef);
      //CMP001 End
      IF NOT GetIntegrationActivated THEN
        EXIT;

      TimeStamp := CURRENTDATETIME;
      UpdateParentIntegrationRecord(RecRef,TimeStamp);
      IF IsIntegrationRecord(RecRef.NUMBER) THEN BEGIN
        IntegrationRecord.SETRANGE("Record ID",XRecRef.RECORDID);
        IF IntegrationRecord.FINDFIRST THEN BEGIN
          IntegrationRecord."Record ID" := RecRef.RECORDID;
          IntegrationRecord.MODIFY;
        END;
      END;
      InsertUpdateIntegrationRecord(RecRef,TimeStamp);
    END;

    LOCAL PROCEDURE UpdateParentIntegrationRecord@17(RecRef@1000 : RecordRef;TimeStamp@1008 : DateTime);
    VAR
      Currency@1012 : Record 4;
      SalesHeader@1001 : Record 36;
      SalesLine@1007 : Record 37;
      SalesInvoiceHeader@1002 : Record 112;
      SalesInvoiceLine@1009 : Record 113;
      Customer@1003 : Record 18;
      ShipToAddress@1010 : Record 222;
      CurrencyExchangeRate@1011 : Record 330;
      SalesPrice@1004 : Record 7002;
      CustomerPriceGroup@1005 : Record 6;
      ParentRecRef@1006 : RecordRef;
    BEGIN
      // Handle cases where entities change should update the parent record
      // Function must not fail even if the parent record cannot be found
      CASE RecRef.NUMBER OF
        DATABASE::"Sales Line":
          BEGIN
            RecRef.SETTABLE(SalesLine);
            IF SalesHeader.GET(SalesLine."Document Type",SalesLine."Document No.") THEN BEGIN
              ParentRecRef.GETTABLE(SalesHeader);
              InsertUpdateIntegrationRecord(ParentRecRef,TimeStamp);
            END;
          END;
        DATABASE::"Sales Invoice Line":
          BEGIN
            RecRef.SETTABLE(SalesInvoiceLine);
            IF SalesInvoiceHeader.GET(SalesInvoiceLine."Document No.") THEN BEGIN
              ParentRecRef.GETTABLE(SalesInvoiceHeader);
              InsertUpdateIntegrationRecord(ParentRecRef,TimeStamp);
            END;
          END;
        DATABASE::"Sales Price":
          BEGIN
            RecRef.SETTABLE(SalesPrice);
            IF SalesPrice."Sales Type" <> SalesPrice."Sales Type"::"Customer Price Group" THEN
              EXIT;

            IF CustomerPriceGroup.GET(SalesPrice."Sales Code") THEN BEGIN
              ParentRecRef.GETTABLE(CustomerPriceGroup);
              InsertUpdateIntegrationRecord(ParentRecRef,TimeStamp);
            END;
          END;
        DATABASE::"Ship-to Address":
          BEGIN
            RecRef.SETTABLE(ShipToAddress);
            IF Customer.GET(ShipToAddress."Customer No.") THEN BEGIN
              ParentRecRef.GETTABLE(Customer);
              InsertUpdateIntegrationRecord(ParentRecRef,TimeStamp);
            END;
          END;
        DATABASE::"Currency Exchange Rate":
          BEGIN
            RecRef.SETTABLE(CurrencyExchangeRate);
            IF Currency.GET(CurrencyExchangeRate."Currency Code") THEN BEGIN
              ParentRecRef.GETTABLE(Currency);
              InsertUpdateIntegrationRecord(ParentRecRef,TimeStamp);
            END;
          END;
      END;
    END;

    PROCEDURE SetupIntegrationTables@8();
    VAR
      TempNameValueBuffer@1000 : TEMPORARY Record 823;
      TableId@1001 : Integer;
    BEGIN
      CreateIntegrationPageList(TempNameValueBuffer);
      TempNameValueBuffer.FINDFIRST;
      REPEAT
        EVALUATE(TableId,TempNameValueBuffer.Value);
        InitializeIntegrationRecords(TableId);
      UNTIL TempNameValueBuffer.NEXT = 0;
    END;

    PROCEDURE CreateIntegrationPageList@23(VAR TempNameValueBuffer@1000 : TEMPORARY Record 823);
    VAR
      NextId@1001 : Integer;
    BEGIN
      WITH TempNameValueBuffer DO BEGIN
        DELETEALL;
        NextId := 1;

        AddToIntegrationPageList(PAGE::"Resource List",DATABASE::Resource,TempNameValueBuffer,NextId);
        AddToIntegrationPageList(PAGE::"Payment Terms",DATABASE::"Payment Terms",TempNameValueBuffer,NextId);
        AddToIntegrationPageList(PAGE::"Shipment Methods",DATABASE::"Shipment Method",TempNameValueBuffer,NextId);
        AddToIntegrationPageList(PAGE::"Shipping Agents",DATABASE::"Shipping Agent",TempNameValueBuffer,NextId);
        AddToIntegrationPageList(PAGE::Currencies,DATABASE::Currency,TempNameValueBuffer,NextId);
        AddToIntegrationPageList(PAGE::"Salespersons/Purchasers",DATABASE::"Salesperson/Purchaser",TempNameValueBuffer,NextId);
        AddToIntegrationPageList(PAGE::"Customer Card",DATABASE::Customer,TempNameValueBuffer,NextId);
        AddToIntegrationPageList(PAGE::"Item Card",DATABASE::Item,TempNameValueBuffer,NextId);
        AddToIntegrationPageList(PAGE::"Sales Order",DATABASE::"Sales Header",TempNameValueBuffer,NextId);
        AddToIntegrationPageList(PAGE::"Sales Invoice",DATABASE::"Sales Header",TempNameValueBuffer,NextId);
        AddToIntegrationPageList(PAGE::"Posted Sales Invoice",DATABASE::"Sales Invoice Header",TempNameValueBuffer,NextId);
        AddToIntegrationPageList(PAGE::"Units of Measure",DATABASE::"Unit of Measure",TempNameValueBuffer,NextId);
        AddToIntegrationPageList(PAGE::"Ship-to Address",DATABASE::"Ship-to Address",TempNameValueBuffer,NextId);
        AddToIntegrationPageList(PAGE::"Contact Card",DATABASE::Contact,TempNameValueBuffer,NextId);
        AddToIntegrationPageList(PAGE::"Countries/Regions",DATABASE::"Country/Region",TempNameValueBuffer,NextId);
      END;
    END;

    PROCEDURE IsIntegrationServicesEnabled@24() : Boolean;
    VAR
      WebService@1000 : Record 2000000076;
    BEGIN
      EXIT(WebService.GET(WebService."Object Type"::Codeunit,'Integration Service'));
    END;

    PROCEDURE IsIntegrationActivated@21() : Boolean;
    BEGIN
      EXIT(IntegrationIsActivated);
    END;

    PROCEDURE EnableIntegrationServices@25();
    BEGIN
      IF IsIntegrationServicesEnabled THEN
        EXIT;

      SetupIntegrationService;
      SetupIntegrationServices;

      MESSAGE(IntegrationServicesEnabledMsg,PRODUCTNAME.FULL);
    END;

    PROCEDURE DisableIntegrationServices@26();
    BEGIN
      IF NOT IsIntegrationServicesEnabled THEN
        EXIT;

      DeleteIntegrationService;
      DeleteIntegrationServices;

      MESSAGE(IntegrationServicesDisabledMsg,PRODUCTNAME.FULL);
    END;

    PROCEDURE SetConnectorIsEnabledForSession@27(IsEnabled@1000 : Boolean);
    BEGIN
      IntegrationIsActivated := IsEnabled;
    END;

    PROCEDURE IsIntegrationRecord@6(TableID@1000 : Integer) : Boolean;
    BEGIN
      EXIT(TableID IN
        [DATABASE::Resource,
         DATABASE::"Payment Terms",
         DATABASE::"Shipment Method",
         DATABASE::"Shipping Agent",
         DATABASE::Currency,
         DATABASE::"Salesperson/Purchaser",
         DATABASE::Customer,
         DATABASE::Item,
         DATABASE::"Sales Header",
         DATABASE::"Sales Invoice Header",
         DATABASE::"Unit of Measure",
         DATABASE::"Ship-to Address",
         DATABASE::Contact,
         DATABASE::"Country/Region",
         DATABASE::"Customer Price Group"]);
    END;

    PROCEDURE IsIntegrationRecordChild@18(TableID@1000 : Integer) : Boolean;
    BEGIN
      EXIT(TableID IN
        [DATABASE::"Sales Line",
         DATABASE::"Currency Exchange Rate",
         DATABASE::"Sales Invoice Line",
         DATABASE::"Sales Price"]);
    END;

    LOCAL PROCEDURE GetIntegrationActivated@20() : Boolean;
    VAR
      CRMConnectionSetup@1001 : Record 5330;
    BEGIN
      IF NOT IntegrationIsActivated THEN BEGIN
        CRMConnectionSetup.SETRANGE("Is Enabled",TRUE);
        IntegrationIsActivated := CRMConnectionSetup.COUNT > 0;
      END;

      EXIT(IntegrationIsActivated);
    END;

    LOCAL PROCEDURE SetupIntegrationService@12();
    VAR
      WebService@1000 : Record 2000000076;
      WebServiceManagement@1001 : Codeunit 9750;
    BEGIN
      WebServiceManagement.CreateWebService(WebService."Object Type"::Codeunit,5151,'Integration Service',TRUE);
    END;

    LOCAL PROCEDURE DeleteIntegrationService@14();
    VAR
      WebService@1000 : Record 2000000076;
    BEGIN
      IF WebService.GET(WebService."Object Type"::Codeunit,'Integration Service') THEN
        WebService.DELETE;
    END;

    LOCAL PROCEDURE SetupIntegrationServices@28();
    VAR
      TempNameValueBuffer@1000 : TEMPORARY Record 823;
      WebService@1003 : Record 2000000076;
      Objects@1002 : Record 2000000038;
      WebServiceManagement@1004 : Codeunit 9750;
      PageId@1001 : Integer;
    BEGIN
      CreateIntegrationPageList(TempNameValueBuffer);
      TempNameValueBuffer.FINDFIRST;

      REPEAT
        EVALUATE(PageId,TempNameValueBuffer.Name);

        Objects.SETRANGE("Object Type",Objects."Object Type"::Page);
        Objects.SETRANGE("Object ID",PageId);
        IF Objects.FINDFIRST THEN
          WebServiceManagement.CreateWebService(WebService."Object Type"::Page,Objects."Object ID",
            STRSUBSTNO(PageServiceNameTok,Objects."Object Name"),TRUE);
      UNTIL TempNameValueBuffer.NEXT = 0;
    END;

    LOCAL PROCEDURE DeleteIntegrationServices@38();
    VAR
      TempNameValueBuffer@1003 : TEMPORARY Record 823;
      WebService@1002 : Record 2000000076;
      Objects@1001 : Record 2000000038;
      PageId@1000 : Integer;
    BEGIN
      CreateIntegrationPageList(TempNameValueBuffer);
      TempNameValueBuffer.FINDFIRST;

      WebService.SETRANGE("Object Type",WebService."Object Type"::Page);
      REPEAT
        EVALUATE(PageId,TempNameValueBuffer.Name);
        WebService.SETRANGE("Object ID",PageId);

        Objects.SETRANGE("Object Type",WebService."Object Type"::Page);
        Objects.SETRANGE("Object ID",PageId);
        IF Objects.FINDFIRST THEN BEGIN
          WebService.SETRANGE("Service Name",STRSUBSTNO(PageServiceNameTok,Objects."Object Name"));
          IF WebService.FINDFIRST THEN
            WebService.DELETE;
        END;
      UNTIL TempNameValueBuffer.NEXT = 0;
    END;

    LOCAL PROCEDURE InitializeIntegrationRecords@9(TableID@1000 : Integer);
    VAR
      RecRef@1002 : RecordRef;
    BEGIN
      WITH RecRef DO BEGIN
        OPEN(TableID,FALSE);
        IF FINDSET(FALSE) THEN
          REPEAT
            InsertUpdateIntegrationRecord(RecRef,CURRENTDATETIME);
          UNTIL NEXT = 0;
        CLOSE;
      END;
    END;

    LOCAL PROCEDURE InsertUpdateIntegrationRecord@16(RecRef@1000 : RecordRef;IntegrationLastModified@1001 : DateTime);
    VAR
      IntegrationRecord@1002 : Record 5151;
      Contact@1003 : Record 5050;
    BEGIN
      IF IsIntegrationRecord(RecRef.NUMBER) THEN
        WITH IntegrationRecord DO BEGIN
          SETRANGE("Record ID",RecRef.RECORDID);
          IF FINDFIRST THEN BEGIN
            // Handle exceptions where entities change state and should not be integrated.
            IF RecRef.NUMBER = DATABASE::Contact THEN BEGIN
              RecRef.SETTABLE(Contact);
              IF Contact.Type = Contact.Type::Company THEN BEGIN
                CLEAR("Record ID");
                "Deleted On" := IntegrationLastModified;
              END;
            END;
            "Modified On" := IntegrationLastModified;
            MODIFY;
          END ELSE BEGIN
            // Handle exceptions where entities should not be integrated.
            IF RecRef.NUMBER = DATABASE::Contact THEN BEGIN
              RecRef.SETTABLE(Contact);
              IF Contact.Type = Contact.Type::Company THEN
                EXIT;
            END;
            RESET;
            INIT;
            "Integration ID" := CREATEGUID;
            "Record ID" := RecRef.RECORDID;
            "Table ID" := RecRef.NUMBER;
            "Modified On" := IntegrationLastModified;
            INSERT;
          END;
        END;
    END;

    LOCAL PROCEDURE AddToIntegrationPageList@22(PageId@1002 : Integer;TableId@1003 : Integer;VAR TempNameValueBuffer@1000 : TEMPORARY Record 823;VAR NextId@1001 : Integer);
    BEGIN
      WITH TempNameValueBuffer DO BEGIN
        INIT;
        ID := NextId;
        NextId := NextId + 1;
        Name := FORMAT(PageId);
        Value := FORMAT(TableId);
        INSERT;
      END;
    END;

    BEGIN
    {
      CMP001 1.00 2014-07-23 Integration with Compello Document Management
                               New Globals: CompelloIntegrMgt
                               Changed Functions: OnDatabaseInsert(), OnDatabaseModify(), OnDatabaseDelete(), OnDatabaseRename(), GetDatabaseTableTriggerSetup()
    }
    END.
  }
}

OBJECT Codeunit 70000 Compello Integr. Log Mgt.
{
  OBJECT-PROPERTIES
  {
    Date=01.10.16;
    Time=11:00:00;
    Modified=Yes;
    Version List=CMP2.00;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      IntegrationIsActive@1000 : Boolean;
      IntegrRecRead@1001 : Boolean;

    PROCEDURE OnDatabaseInsert@2(RecRef@1000 : RecordRef);
    VAR
      TimeStamp@1001 : DateTime;
    BEGIN
      IF NOT GetIntegrationActivated THEN
        EXIT;

      TimeStamp := CURRENTDATETIME;
      InsertUpdateIntegrationRecord(RecRef, TimeStamp, 0);
    END;

    PROCEDURE OnDatabaseModify@3(RecRef@1000 : RecordRef);
    VAR
      TimeStamp@1001 : DateTime;
    BEGIN
      IF NOT GetIntegrationActivated THEN
        EXIT;

      TimeStamp := CURRENTDATETIME;
      InsertUpdateIntegrationRecord(RecRef, TimeStamp, 1);
    END;

    PROCEDURE OnDatabaseDelete@4(RecRef@1000 : RecordRef);
    VAR
      IntegrationRecord@1001 : Record 70001;
      TimeStamp@1003 : DateTime;
    BEGIN
      IF NOT GetIntegrationActivated THEN
        EXIT;

      TimeStamp := CURRENTDATETIME;
      InsertUpdateIntegrationRecord(RecRef,TimeStamp, 2);
    END;

    PROCEDURE OnDatabaseRename@5(RecRef@1000 : RecordRef;XRecRef@1001 : RecordRef);
    VAR
      IntegrationRecord@1003 : Record 5151;
      TimeStamp@1002 : DateTime;
    BEGIN
      IF NOT GetIntegrationActivated THEN
        EXIT;

      TimeStamp := CURRENTDATETIME;
      InsertUpdateIntegrationRecord(XRecRef, TimeStamp, 2);
      InsertUpdateIntegrationRecord(RecRef, TimeStamp, 0);
    END;

    PROCEDURE CollectFieldValuesForExport@6(IntegrTable@1002 : Record 70003;VAR IntegrationRecord@1001 : Record 70001;TableRef@1005 : RecordRef);
    VAR
      IntegrTableFields@1000 : Record 70004;
      FieldRef@1004 : FieldRef;
      FieldValue@1003 : Text[100];
    BEGIN
      IntegrTableFields.SETRANGE("Table Code", IntegrTable.Code);
      IF NOT IntegrTableFields.FINDSET THEN BEGIN
        EXIT;
      END;

      REPEAT
        IF TableRef.FIELDEXIST(IntegrTableFields."Field ID") THEN BEGIN
          FieldRef := TableRef.FIELD(IntegrTableFields."Field ID");
          FieldValue := COPYSTR(FORMAT(FieldRef.VALUE), 1, 100);
          CASE IntegrTableFields."Map-to Field No." OF
            1 : BEGIN
              IntegrationRecord.Value := COPYSTR(FieldValue, 1, 20);
            END;
            2 : BEGIN
              IntegrationRecord.Description := COPYSTR(FieldValue, 1, 50);
            END;
            3 : BEGIN
              IntegrationRecord."Description 2" := FieldValue;
            END;
            4 : BEGIN
              IntegrationRecord."Description 3" := FieldValue;
            END;
          END;
        END;
      UNTIL IntegrTableFields.NEXT = 0;

      IF IntegrTable."Filter Field 1" <> 0 THEN BEGIN
        IF TableRef.FIELDEXIST(IntegrTable."Filter Field 1") THEN BEGIN
          FieldRef := TableRef.FIELD(IntegrTable."Filter Field 1");
          FieldValue := COPYSTR(FORMAT(FieldRef.VALUE), 1, 100);
          IntegrationRecord."Filter Field 1" := FieldValue;
        END;
      END;
      IF IntegrTable."Filter Field 2" <> 0 THEN BEGIN
        IF TableRef.FIELDEXIST(IntegrTable."Filter Field 2") THEN BEGIN
          FieldRef := TableRef.FIELD(IntegrTable."Filter Field 2");
          FieldValue := COPYSTR(FORMAT(FieldRef.VALUE), 1, 100);
          IntegrationRecord."Filter Field 2" := FieldValue;
        END;
      END;
      IF IntegrTable."Filter Field 3" <> 0 THEN BEGIN
        IF TableRef.FIELDEXIST(IntegrTable."Filter Field 3") THEN BEGIN
          FieldRef := TableRef.FIELD(IntegrTable."Filter Field 3");
          FieldValue := COPYSTR(FORMAT(FieldRef.VALUE), 1, 100);
          IntegrationRecord."Filter Field 3" := FieldValue;
        END;
      END;
    END;

    LOCAL PROCEDURE InsertUpdateIntegrationRecord@16(RecRef@1000 : RecordRef;IntegrationLastModified@1001 : DateTime;AfterAction@1004 : 'Insert,Modify,Delete');
    VAR
      CurrLanguage@1000000000 : Integer;
      IntegrationRecord@1002 : Record 70001;
      IntegrRecArchive@1005 : Record 70002;
      IntegrTable@1003 : Record 70003;
      DimValue@1007 : Record 349;
      SessionIDResult@1006 : Integer;
      CompelloIntgrExpMgt@1101103000 : Codeunit 70001;
    BEGIN
      IntegrTable.SETRANGE("Table ID", RecRef.NUMBER);
      IntegrTable.SETFILTER(Synchronize, '<>%1', IntegrTable.Synchronize::None);
      IntegrTable.SETRANGE("Action IO", IntegrTable."Action IO"::Export);
      IF RecRef.NUMBER = DATABASE::"Dimension Value" THEN BEGIN
        RecRef.SETTABLE(DimValue);
        IntegrTable.SETRANGE("Dimension Code", DimValue."Dimension Code");
      END;
      IF NOT IntegrTable.FINDSET THEN BEGIN
        EXIT;
      END;

      CurrLanguage := GLOBALLANGUAGE;
      GLOBALLANGUAGE(1033);

      REPEAT
        IntegrationRecord.INIT;
        IntegrationRecord.GUID := CREATEGUID;
        IntegrationRecord."Record ID" := RecRef.RECORDID;
        IntegrationRecord."Table ID" := RecRef.NUMBER;
        IntegrationRecord."User Action" := AfterAction;
        IntegrationRecord.Date := IntegrationLastModified;
        IntegrationRecord.DataType := IntegrTable."Data Type";
        CollectFieldValuesForExport(IntegrTable, IntegrationRecord, RecRef);
        IntegrationRecord.Inactive := (AfterAction = AfterAction::Delete);
        IntegrationRecord."Table Code" := IntegrTable.Code;

        IF NOT CheckFilterValues(IntegrationRecord, IntegrTable) THEN BEGIN
          IntegrationRecord.Inactive := TRUE;
        END;

        IF (CompelloIntgrExpMgt.TableIsPOMatch(IntegrationRecord."Table ID")) AND (RemovePOMatch(RecRef)) THEN BEGIN
        // Do not insert PO match log lines that have been filtered to inactive
        END ELSE
          IntegrationRecord.INSERT;

        IF IntegrTable.Synchronize = IntegrTable.Synchronize::"On-line" THEN BEGIN
          STARTSESSION(SessionIDResult, CODEUNIT::"Compello Integr. Export Mgt.", COMPANYNAME, IntegrationRecord);
        END;
      UNTIL IntegrTable.NEXT = 0;

      GLOBALLANGUAGE(CurrLanguage);
    END;

    PROCEDURE IsIntegrationRecord@1(TableID@1000 : Integer) : Boolean;
    VAR
      IntegrTable@1001 : Record 70003;
    BEGIN
      IntegrTable.SETRANGE("Table ID", TableID);
      IntegrTable.SETFILTER(Synchronize, '<>%1', IntegrTable.Synchronize::None);
      IntegrTable.SETRANGE("Action IO", IntegrTable."Action IO"::Export);
      EXIT(IntegrTable.FINDFIRST);
    END;

    LOCAL PROCEDURE GetIntegrationActivated@20() : Boolean;
    VAR
      IntegrTable@1000 : Record 70003;
    BEGIN
      IF NOT IntegrRecRead THEN BEGIN
        IntegrRecRead := TRUE;

        IntegrTable.SETFILTER(Synchronize, '<>%1', IntegrTable.Synchronize::None);
        IntegrTable.SETRANGE("Action IO", IntegrTable."Action IO"::Export);
        IntegrationIsActive := IntegrTable.FINDFIRST;
      END;

      EXIT(IntegrationIsActive);
    END;

    PROCEDURE CheckFilterValues@1000000001(VAR IntegrationRecord@1000000001 : Record 70001;VAR IntegrTable@1000000000 : Record 70003) : Boolean;
    VAR
      IntegrationRecordTemp@1000000002 : TEMPORARY Record 70001;
    BEGIN
      IntegrationRecordTemp.DELETEALL;
      IntegrationRecordTemp.TRANSFERFIELDS(IntegrationRecord);
      IntegrationRecordTemp.INSERT;

      IF IntegrTable."Filter Value 1" <> '' THEN BEGIN
        IntegrationRecordTemp.SETFILTER("Filter Field 1", IntegrTable."Filter Value 1");
      END;

      IF IntegrTable."Filter Value 2" <> '' THEN BEGIN
        IntegrationRecordTemp.SETFILTER("Filter Field 2", IntegrTable."Filter Value 2");
      END;

      IF IntegrTable."Filter Value 3" <> '' THEN BEGIN
        IntegrationRecordTemp.SETFILTER("Filter Field 3", IntegrTable."Filter Value 3");
      END;

      IF IntegrationRecordTemp.ISEMPTY THEN BEGIN
        EXIT(FALSE);
      END;

      EXIT(TRUE);
    END;

    PROCEDURE RemovePOMatch@1101103000(VAR RecRef@1000000001 : RecordRef) : Boolean;
    VAR
      OrderNoFieldRef@1101103000 : FieldRef;
      PurchaseHeader@1101103001 : Record 38;
    BEGIN

      IF RecRef.NUMBER = DATABASE::"Purch. Rcpt. Header" THEN
      BEGIN
        OrderNoFieldRef := RecRef.FIELD(44);

        IF NOT PurchaseHeader.GET(PurchaseHeader."Document Type"::Order, OrderNoFieldRef) THEN
          EXIT(TRUE);

        IF FORMAT(OrderNoFieldRef.VALUE) = '' THEN
          EXIT(TRUE);
      END;

      EXIT(FALSE);
    END;

    PROCEDURE ResendReceipt@1101103001(ReceiptNo@1101103003 : Code[20]);
    VAR
      TimeStamp@1001 : DateTime;
      RecRef@1101103000 : RecordRef;
      IntegrationRecord@1101103002 : Record 70001;
      PurchRcptHeader@1101103001 : Record 120;
      CurrLanguage@1101103010 : Integer;
      IntegrRecArchive@1101103008 : Record 70002;
      IntegrTable@1101103007 : Record 70003;
      DimValue@1101103006 : Record 349;
      SessionIDResult@1101103005 : Integer;
      CompelloIntgrExpMgt@1101103004 : Codeunit 70001;
    BEGIN

      PurchRcptHeader.SETRANGE("No.", ReceiptNo);

      IF PurchRcptHeader.FINDFIRST THEN BEGIN
        RecRef.OPEN(120);
        RecRef.SETPOSITION(PurchRcptHeader.GETPOSITION);

        TimeStamp := CURRENTDATETIME;
        IntegrTable.SETRANGE("Table ID", RecRef.NUMBER);
        IntegrTable.SETFILTER(Synchronize, '<>%1', IntegrTable.Synchronize::None);
        IntegrTable.SETRANGE("Action IO", IntegrTable."Action IO"::Export);
        IF RecRef.NUMBER = DATABASE::"Dimension Value" THEN BEGIN
          RecRef.SETTABLE(DimValue);
          IntegrTable.SETRANGE("Dimension Code", DimValue."Dimension Code");
        END;

        IF NOT IntegrTable.FINDSET THEN BEGIN
          EXIT;
        END;

        CurrLanguage := GLOBALLANGUAGE;
        GLOBALLANGUAGE(1033);

          IntegrationRecord.INIT;
          IntegrationRecord.GUID := CREATEGUID;
          IntegrationRecord."Record ID" := RecRef.RECORDID;
          IntegrationRecord."Table ID" := RecRef.NUMBER;
          IntegrationRecord."User Action" := IntegrationRecord."User Action"::Modify;
          IntegrationRecord.Date := TimeStamp;
          IntegrationRecord.DataType := IntegrTable."Data Type";
          CollectFieldValuesForExport(IntegrTable, IntegrationRecord, RecRef);
          IntegrationRecord.Inactive := FALSE;
          IntegrationRecord."Table Code" := IntegrTable.Code;

          IF NOT CheckFilterValues(IntegrationRecord, IntegrTable) THEN BEGIN
            IntegrationRecord.Inactive := TRUE;
          END;

         IntegrationRecord.INSERT;


        GLOBALLANGUAGE(CurrLanguage);
        InsertUpdateIntegrationRecord(RecRef, TimeStamp, 1);

       RecRef.CLOSE;
      END;
    END;

    BEGIN
    {
      +---------------------------------------------+
      | SI-Data                                     |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 24.04.15 JAL Exclude inactive Purchase Orders reiceipt lines
    }
    END.
  }
}

OBJECT Codeunit 70001 Compello Integr. Export Mgt.
{
  OBJECT-PROPERTIES
  {
    Date=02.01.17;
    Time=09:28:59;
    Modified=Yes;
    Version List=CMP2.00;
  }
  PROPERTIES
  {
    TableNo=70001;
    OnRun=BEGIN
            IF SyncOneRec(Rec) THEN BEGIN
            END;
          END;

  }
  CODE
  {
    VAR
      IntegrSetup@1000 : Record 70000;
      CompelloIntegr@1002 : DotNet "'CompelloIntegration, Version=8.0.0.0, Culture=neutral, PublicKeyToken=09a47ba60ac3be91'.Compello.IntegrationAPI.CompelloIntegration";
      ImportDataG@1001 : DotNet "'CompelloIntegration, Version=8.0.0.0, Culture=neutral, PublicKeyToken=09a47ba60ac3be91'.Compello.IntegrationAPI.ImportData";
      Text001@1003 : TextConst 'ENU=Synchronization done. Updated: %1, New: %2';
      SetupLoaded@1004 : Boolean;
      Text002@1005 : TextConst 'ENU=Synchronization with Compello failed';
      Window@1006 : Dialog;
      Text003@1007 : TextConst 'ENU=Logging to Compello';
      Text004@1008 : TextConst 'ENU=Sending data to Compello';
      IsAccData@1101103000 : Boolean;
      ErrorLogin@1101103001 : TextConst 'ENU=Unable to logon to Compello;NOR=Feil logging til Compello';

    PROCEDURE SyncOneRec@4(IntegrLogEntry@1000 : Record 70001) : Boolean;
    VAR
      InsertedRec@1002 : Integer;
      UpdatedRec@1001 : Integer;
    BEGIN
      IF NOT RecordShouldBeSync(IntegrLogEntry) THEN BEGIN
        EXIT;
      END;

      IF GUIALLOWED THEN BEGIN
        Window.OPEN('#1###################');
        Window.UPDATE(1, Text003);
      END;

      IF StartIntegrSession THEN BEGIN
        CompressOneRecord(IntegrLogEntry);
        IF GUIALLOWED THEN BEGIN
          Window.UPDATE(1, Text004);
        END;
        SendData(IntegrLogEntry, InsertedRec);
        COMMIT;
        EndIntegrSession(InsertedRec, UpdatedRec);
        IF (InsertedRec + UpdatedRec) = 1 THEN BEGIN
          ArchiveLog(IntegrLogEntry);
        END;
        IF GUIALLOWED THEN BEGIN
          Window.CLOSE;
        END;
        EXIT(TRUE);
      END;

      AddNotificationsFromLog(IntegrLogEntry);
      IF GUIALLOWED THEN BEGIN
        Window.CLOSE;
      END;

      EXIT(FALSE);
    END;

    PROCEDURE SyncMultipleRecords@7(VAR IntegrLogEntry@1000 : Record 70001;ThroughNAS@1006 : Boolean) : Boolean;
    VAR
      IntegrLogEntry2@1001 : Record 70001;
      IntegrLogEntryTmp@1002 : TEMPORARY Record 70001;
      IntegrTable@1007 : Record 70003;
      InsertedRec@1004 : Integer;
      UpdatedRec@1003 : Integer;
      UploadedNoOfRecs@1005 : Integer;
    BEGIN
      IntegrSetup.GET;
      IF NOT IntegrLogEntry.FINDSET THEN BEGIN
        EXIT(FALSE);
      END;

      IF GUIALLOWED THEN BEGIN
        Window.OPEN('#1###################');
        Window.UPDATE(1, Text003);
      END;

      //Compressing records
      REPEAT
        IntegrLogEntry2 := IntegrLogEntry;
        CompressOneRecord(IntegrLogEntry2);
      UNTIL IntegrLogEntry.NEXT = 0;
      COMMIT;

      IF NOT StartIntegrSession THEN BEGIN
        AddNotificationsFromLog(IntegrLogEntry);
        IF GUIALLOWED THEN BEGIN
          Window.CLOSE;
        END;
        EXIT(FALSE);
      END;

      IF GUIALLOWED THEN BEGIN
        Window.UPDATE(1, Text004);
      END;
      IntegrLogEntry.SETCURRENTKEY("Table ID", Date);
      IntegrLogEntry.SETFILTER("No. of Tries", '<=%1', IntegrSetup."Max. No. of Tries");
      IntegrLogEntry.FINDSET;
      REPEAT
        IntegrTable.GET(IntegrLogEntry."Table Code");
        IF (IntegrTable.Synchronize = IntegrTable.Synchronize::NAS) OR (NOT ThroughNAS) THEN BEGIN
          SendData(IntegrLogEntry, InsertedRec);
          IntegrLogEntryTmp := IntegrLogEntry;
          IntegrLogEntryTmp.INSERT;
          UploadedNoOfRecs := UploadedNoOfRecs + 1;
        END;
      UNTIL (IntegrLogEntry.NEXT = 0) OR ((UploadedNoOfRecs >= IntegrSetup."Max No. of Rec. per Transact.") AND (IntegrSetup."Max No. of Rec. per Transact." <> 0));

      IF UploadedNoOfRecs = 0 THEN BEGIN
        CLEAR(CompelloIntegr);
        CLEAR(ImportDataG);
        IF GUIALLOWED THEN BEGIN
          Window.CLOSE;
        END;
        EXIT(TRUE);
      END;

      EndIntegrSession(InsertedRec, UpdatedRec);

      IF IntegrLogEntryTmp.FINDSET THEN
        REPEAT
          IF ((IntegrLogEntryTmp.Status = IntegrLogEntry.Status::"In progress") OR (IntegrLogEntryTmp.Status = IntegrLogEntry.Status::Sent)) THEN
           IF IntegrLogEntry.GET(IntegrLogEntryTmp.GUID) THEN BEGIN
              ArchiveLog(IntegrLogEntry);
              IntegrLogEntryTmp.DELETE;
           END;
        UNTIL IntegrLogEntryTmp.NEXT = 0;

      COMMIT;

      IF GUIALLOWED THEN BEGIN
        Window.CLOSE;
      END;

      EXIT(TRUE);
    END;

    LOCAL PROCEDURE StartIntegrSession@3() : Boolean;
    VAR
      Result@1000 : Text[250];
    BEGIN
      LoadSetup;
      IntegrSetup.TESTFIELD("Web Service Address");
      IntegrSetup.TESTFIELD("Customer ID");

      CompelloIntegr := CompelloIntegr.CompelloIntegration;
      Result := COPYSTR(CompelloIntegr.Logon(IntegrSetup."User Name", IntegrSetup.Password, IntegrSetup."Customer ID", IntegrSetup."Web Service Address"), 1, 250);

      IF Result = '' THEN BEGIN
        EXIT(TRUE);
      END;

      //Log error
      EXIT(FALSE);
    END;

    LOCAL PROCEDURE EndIntegrSession@5(VAR InsertedRec@1004 : Integer;VAR UpdatedRec@1003 : Integer) : Text[250];
    VAR
      ImportResult@1001 : DotNet "'CompelloIntegration, Version=8.0.0.0, Culture=neutral, PublicKeyToken=09a47ba60ac3be91'.Compello.IntegrationAPI.ImportResult";
      ResultArray@1000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array";
      i@1002 : Integer;
    BEGIN
      IF IsAccData THEN BEGIN
        ResultArray := CompelloIntegr.ImportRegisterData();
        FOR i := 1 TO ResultArray.Length DO BEGIN
          ImportResult := ResultArray.GetValue(i-1);
          UpdatedRec := UpdatedRec + ImportResult.Updated;
          InsertedRec := InsertedRec + ImportResult.New;
          //Needs "Value" to mark successfull transaction
        END;
      END;
      CLEAR(CompelloIntegr);
      CLEAR(ImportDataG);
      CLEAR(ImportResult);
      CLEAR(ResultArray);

      COMMIT;
      AddExportLog(STRSUBSTNO(Text001, UpdatedRec, InsertedRec));
      EXIT(STRSUBSTNO(Text001, UpdatedRec, InsertedRec));
    END;

    LOCAL PROCEDURE SendData@1(VAR IntegtEntry@1014 : Record 70001;VAR InsertedRec@1101103000 : Integer);
    VAR
      Result@1101103001 : Text[1000];
    BEGIN
      IsAccData := FALSE;
      IF TableIsPOMatch(IntegtEntry."Table ID") THEN BEGIN
        Result := SendPOFile(IntegtEntry);
        IF Result = '' THEN BEGIN
           InsertedRec := InsertedRec + 1;
           IntegtEntry.Status := IntegtEntry.Status::Sent;
        END
        ELSE BEGIN
          IntegtEntry.Status := IntegtEntry.Status::Error;
          IntegtEntry."Error Message" := Result;
          AddNotificationsFromLog(IntegtEntry); //02. 26.01.16 JAL
        END;
      END
      ELSE BEGIN
        ImportDataG := ImportDataG.ImportData;
        ImportDataG.ClientId := IntegrSetup."Client ID";
        ImportDataG.DataTypeInt := IntegtEntry.DataType;
        ImportDataG.Value := IntegtEntry.Value;
        ImportDataG.Desc := IntegtEntry.Description;
        ImportDataG.Desc2 := IntegtEntry."Description 2";
        ImportDataG.Desc3 := IntegtEntry."Description 3";
        ImportDataG.Inactive := IntegtEntry.Inactive;

        CompelloIntegr.ImportRegisterDataGeneral(ImportDataG);
        IntegtEntry.Status := IntegtEntry.Status::"In progress";
        IsAccData := TRUE;
      END;

      IntegtEntry."No. of Tries" := IntegtEntry."No. of Tries" + 1;
      IntegtEntry.MODIFY;
    END;

    LOCAL PROCEDURE ArchiveLog@11(IntegrLogEntry@1000 : Record 70001);
    VAR
      IntegrLogEntryArchive@1001 : Record 70002;
    BEGIN
      IntegrLogEntryArchive.TRANSFERFIELDS(IntegrLogEntry, TRUE);
      IntegrLogEntryArchive.Status := IntegrLogEntryArchive.Status::Sent;
      IntegrLogEntryArchive."Transaction DateTime" := CURRENTDATETIME;
      IntegrLogEntryArchive."Transaction Date" := DT2DATE(IntegrLogEntryArchive."Transaction DateTime");
      IntegrLogEntryArchive.INSERT;
      IntegrLogEntry.DELETE;
    END;

    LOCAL PROCEDURE CompressOneRecord@2(VAR IntegrLogEntry@1001 : Record 70001);
    VAR
      IntegrLogEntry2@1000 : Record 70001;
    BEGIN
      IntegrLogEntry2.SETRANGE("Table ID", IntegrLogEntry."Table ID");
      IntegrLogEntry2.SETRANGE("Record ID", IntegrLogEntry."Record ID");
      IntegrLogEntry2.SETRANGE("User Action", IntegrLogEntry."User Action");
      IntegrLogEntry2.SETCURRENTKEY("Table ID",Date);
      IF IntegrLogEntry2.COUNT > 1 THEN BEGIN
        IntegrLogEntry2.FINDLAST;
        IntegrLogEntry.GET(IntegrLogEntry2.GUID);
        IntegrLogEntry2.SETFILTER(GUID, '<>%1', IntegrLogEntry2.GUID);
        IntegrLogEntry2.DELETEALL;
      END;

      IF IntegrLogEntry."User Action" = IntegrLogEntry."User Action"::Delete THEN BEGIN
        IntegrLogEntry2.SETFILTER("User Action", '<>%1', IntegrLogEntry."User Action"::Delete);
        IntegrLogEntry2.SETFILTER(Date, '<%1', IntegrLogEntry.Date);
        IntegrLogEntry2.DELETEALL;
      END;
    END;

    LOCAL PROCEDURE RecordShouldBeSync@9(IntegrLogEntry@1000 : Record 70001) : Boolean;
    BEGIN
      LoadSetup;
      IF IntegrSetup."Max. No. of Tries" > 0 THEN BEGIN
        EXIT(IntegrLogEntry."No. of Tries" < IntegrSetup."Max. No. of Tries");
      END;

      EXIT(TRUE);
    END;

    LOCAL PROCEDURE LoadSetup@10();
    BEGIN
      IF NOT SetupLoaded THEN BEGIN
        IntegrSetup.GET;
        SetupLoaded := TRUE;
      END;
    END;

    LOCAL PROCEDURE AddNotificationsFromLog@8(IntegrLogEntry@1000 : Record 70001);
    VAR
      UserNotification@1002 : Record 70007;
      MyRec@1001 : RecordRef;
    BEGIN
      UserNotification.SETRANGE("Table Code", IntegrLogEntry."Table Code");
      IF NOT UserNotification.FINDSET THEN BEGIN
        EXIT;
      END;

      MyRec.GETTABLE(IntegrLogEntry);
      REPEAT
        IF UserNotification."User ID" <> '' THEN BEGIN
          AddNotification(MyRec, Text002, UserNotification."User ID");
        END;
      UNTIL UserNotification.NEXT = 0;
      AddExportLog(Text002);
    END;

    LOCAL PROCEDURE AddNotification@6(VAR RecRefToAdd@1001 : RecordRef;MyText@1005 : Text[250];NotifyUser@1006 : Code[50]);
    VAR
      RecordLink@1000 : Record 2000000068;
      ListPage@1004 : Page 70001;
      MyOutStream@1002 : OutStream;
      MyChar@1003 : Char;
    BEGIN
      LoadSetup;

      RecordLink.INIT;
      RecordLink.URL1 := IntegrSetup."URL for Export Log";
      RecordLink."Record ID" := RecRefToAdd.RECORDID;
      RecordLink.Type := RecordLink.Type::Note;
      RecordLink.Description := ListPage.CAPTION;
      RecordLink.Created := CURRENTDATETIME;
      RecordLink."User ID" := USERID;
      RecordLink.Company := COMPANYNAME;
      RecordLink.Notify := TRUE;
      RecordLink."To User ID" := NotifyUser;
      RecordLink.Note.CREATEOUTSTREAM(MyOutStream);
      MyChar := STRLEN(MyText);
      MyOutStream.WRITETEXT := FORMAT(MyChar) + MyText;
      RecordLink.INSERT;
    END;

    LOCAL PROCEDURE AddExportLog@12(MyText@1001 : Text[250]);
    VAR
      ExportLog@1000 : Record 70006;
    BEGIN
      ExportLog.INIT;
      ExportLog.GUID := CREATEGUID;
      ExportLog."Export date" := CURRENTDATETIME;
      ExportLog.Result := MyText;
      ExportLog.INSERT;
    END;

    PROCEDURE CleanExportLog@1101103002();
    VAR
      CompelloSetup@1101103007 : Record 70000;
      ChangeLogArchive@1101103000 : Record 70002;
      ExportLog@1101103005 : Record 70006;
      EndDate@1101103001 : Date;
      CurrYear@1101103002 : Integer;
      CurrMonth@1101103003 : Integer;
      ConfirmTxt@1101103004 : TextConst 'ENU=Do you want to delete all posts before the date %1?;NOR=Vil du slette alle poster f›r datoen %1?';
      MsgTxt@1101103006 : TextConst 'ENU=All record before %1 deleted.;NOR=Alle poster f›r %1 er slettet.';
      MonthsToKeep@1101103008 : Integer;
    BEGIN
      CompelloSetup.GET;

      IF CompelloSetup."Keep Export Log" < 1 THEN
        MonthsToKeep := 1
      ELSE
        MonthsToKeep := CompelloSetup."Keep Export Log";

      CurrYear := DATE2DMY(TODAY,3);
      CurrMonth := DATE2DMY(TODAY,2);
      EndDate   := DMY2DATE(1, (CurrMonth - MonthsToKeep), CurrYear);

      ChangeLogArchive.SETFILTER("Table ID", '<>120');
      ChangeLogArchive.SETFILTER(Date, '..%1', CREATEDATETIME(EndDate,235900T));

      ExportLog.SETFILTER("Export date", '..%1', CREATEDATETIME(EndDate,235900T));

      IF ChangeLogArchive.FINDSET THEN BEGIN
        IF GUIALLOWED THEN BEGIN
          IF CONFIRM(ConfirmTxt, FALSE, EndDate) THEN BEGIN
            ChangeLogArchive.DELETEALL;
            ExportLog.DELETEALL;
            MESSAGE(MsgTxt, EndDate);
          END;
        END ELSE BEGIN
          ChangeLogArchive.DELETEALL;
          ExportLog.DELETEALL;
        END;
      END;
    END;

    LOCAL PROCEDURE SendPOFile@1101103012(VAR IntegtEntry@1101103000 : Record 70001) : Text[1000];
    VAR
      CompelloDocImport@1101103002 : DotNet "'Compello.Integration.DocumentImport, Version=8.0.0.0, Culture=neutral, PublicKeyToken=b68c3ee786d7f8a3'.Compello.Integration.DocumentImport.DocumentImport";
      Result@1101103007 : Text[1000];
      XLSFilePath@1101103008 : Text;
      XSLTFilePath@1101103009 : Text;
      ImageFilePath@1101103010 : Text;
      XMLFileName@1101103011 : Text;
    BEGIN
      LoadSetup;

      XMLFileName := CreatePOXML(IntegtEntry);
      CompelloDocImport := CompelloDocImport.DocumentImport;
      Result := COPYSTR(CompelloDocImport.Logon(IntegrSetup."User Name", IntegrSetup.Password, IntegrSetup."Customer ID", IntegrSetup."Web Service Address"), 1, 250);
      IF Result <> '' THEN BEGIN
        MESSAGE(ErrorLogin);
      END;

      Result := COPYSTR(CompelloDocImport.UploadInvoiceAfterConversion(XMLFileName, IntegrSetup."XLS File Path", XMLFileName, IntegrSetup."Image File Stylesheet",IntegrSetup."XML Folder Archive"), 1, 250);

      CLEAR(CompelloDocImport);
      EXIT(Result);
    END;

    LOCAL PROCEDURE CreatePOXML@1101103001(VAR IntegtEntry@1101103000 : Record 70001) : Text[1000];
    VAR
      ReceiptHeader@1101103002 : Record 120;
      XMLFileName@1101103001 : Text[1000];
    BEGIN
      ReceiptHeader.GET(IntegtEntry."Record ID");

      XMLFileName := CreatePOXMLFromPurchaseHeader(ReceiptHeader);

      EXIT(XMLFileName);
    END;

    PROCEDURE CreatePOXMLFromPurchaseHeader@1101103000(VAR ReceiptHeader@1101103000 : Record 120) : Text[1000];
    VAR
      XMLPortPO@1101103004 : XMLport 70002;
      POXMLFile@1101103003 : File;
      XMLOutStream@1101103002 : OutStream;
      XMLFileName@1101103001 : Text[1000];
    BEGIN
      XMLFileName := IntegrSetup."XML Folder" + ReceiptHeader."No." + '.xml';

      POXMLFile.CREATE(XMLFileName);
      POXMLFile.CREATEOUTSTREAM(XMLOutStream);

      XMLPortPO.SetTableFilters(ReceiptHeader);
      XMLPortPO.SETDESTINATION(XMLOutStream);
      XMLPortPO.EXPORT;

      POXMLFile.CLOSE;

      CLEAR(POXMLFile);
      CLEAR(XMLPortPO);

      EXIT(XMLFileName);
    END;

    PROCEDURE TableIsPOMatch@1101103003(TableID@1101103000 : Integer) : Boolean;
    BEGIN
      IF (TableID = DATABASE::"Purch. Rcpt. Header") OR (TableID= DATABASE::"Return Receipt Header") THEN
        EXIT(TRUE)
      ELSE
        EXIT(FALSE);
    END;

    BEGIN
    {
      +---------------------------------------------+
      | SI-Data                                     |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 24.04.15 JAL Added functions to upload xml file for Purchase Order Receipt lines.
      02. 26.01.16 JAL Added AddNotificationsFromLog when uploading failes.
    }
    END.
  }
}

OBJECT Codeunit 70002 Compello Integr. Import Mgt.
{
  OBJECT-PROPERTIES
  {
    Date=01.06.17;
    Time=11:43:24;
    Modified=Yes;
    Version List=CMP2.03;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      IntegrSetup@1000 : Record 70000;
      CompelloIntegr@1002 : DotNet "'CompelloIntegration, Version=8.0.0.0, Culture=neutral, PublicKeyToken=09a47ba60ac3be91'.Compello.IntegrationAPI.CompelloIntegration";
      ExportHdr@1003 : DotNet "'CompelloIntegration, Version=8.0.0.0, Culture=neutral, PublicKeyToken=09a47ba60ac3be91'.Compello.IntegrationAPI.CompelloExport";
      ExportLine@1001 : DotNet "'CompelloIntegration, Version=8.0.0.0, Culture=neutral, PublicKeyToken=09a47ba60ac3be91'.Compello.IntegrationAPI.CompelloExportLine";
      HeaderNo@1004 : GUID;
      LineNo@1005 : Integer;
      RestoredDocs@1008 : Integer;
      ImportedDocs@1009 : Integer;
      Window@1006 : Dialog;
      Text001@1007 : TextConst 'ENU=Action: #1###############\Restored: #2#############\Imported: #3#############';
      Text002@1010 : TextConst 'ENU=Imported: %1, Restored: %2';
      Text003@1011 : TextConst 'ENU=Logging to Compello;NOR=Logger p† Compello';
      Text004@1012 : TextConst 'ENU=Restoring documents';
      Text005@1013 : TextConst 'ENU=Importing documents';
      Text006@1014 : TextConst 'ENU=Delete record and Reactivate in Compello,Delete record';
      Text007@1101103000 : TextConst 'ENU=Delete record and Reactivate in Compello;NOR=Slett linje og send i retur til Compello';
      NoVAT@1101103001 : Boolean;

    LOCAL PROCEDURE StartIntegrSession@3() : Boolean;
    VAR
      Result@1000 : Text[250];
    BEGIN
      IntegrSetup.GET;
      IntegrSetup.TESTFIELD("Web Service Address");
      IntegrSetup.TESTFIELD("Customer ID");

      CompelloIntegr := CompelloIntegr.CompelloIntegration;
      Result := COPYSTR(CompelloIntegr.Logon(IntegrSetup."User Name", IntegrSetup.Password, IntegrSetup."Customer ID", IntegrSetup."Web Service Address"), 1, 250);

      IF Result = '' THEN BEGIN
        EXIT(TRUE);
      END;

      EXIT(FALSE);
    END;

    LOCAL PROCEDURE EndIntegrSession@5() : Text[250];
    VAR
      ImportResult@1001 : DotNet "'CompelloIntegration, Version=8.0.0.0, Culture=neutral, PublicKeyToken=09a47ba60ac3be91'.Compello.IntegrationAPI.ImportResult";
      ResultArray@1000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array";
      i@1002 : Integer;
      InsertedRec@1004 : Integer;
      UpdatedRec@1003 : Integer;
    BEGIN
      CLEAR(CompelloIntegr);
      CLEAR(ExportHdr);
      CLEAR(ExportLine);

      EXIT(STRSUBSTNO(Text002, ImportedDocs, RestoredDocs));
    END;

    PROCEDURE LoadDocuments@1();
    BEGIN
      IF GUIALLOWED THEN BEGIN
        Window.OPEN(Text001);
        RestoredDocs := 0;
        ImportedDocs := 0;
        Window.UPDATE(1, Text003);
      END;

      StartIntegrSession;
      IF GUIALLOWED THEN BEGIN
        Window.UPDATE(1, Text004);
      END;
      ReactivateOnError;
      IF GUIALLOWED THEN BEGIN
        Window.UPDATE(1, Text005);
      END;
      LoadNewDocuments;
      IF GUIALLOWED THEN BEGIN
        Window.CLOSE;
        MESSAGE(EndIntegrSession);
      END ELSE BEGIN
        EndIntegrSession;
      END;
    END;

    LOCAL PROCEDURE LoadNewDocuments@2();
    VAR
      ResultArray@1001 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array";
      ResultArray2@1000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array";
      Emit@1002 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.String";
      SuccessArray@1003 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array";
      i@1004 : Integer;
      j@1005 : Integer;
      MyChar@1006 : Char;
      CompelloMgt@1101103000 : Codeunit 70005;
      HasSuccess@1101103001 : Boolean;
    BEGIN
      ResultArray := CompelloIntegr.GetDocumentsForExportArray(IntegrSetup."Client ID");

      IF ResultArray.Length = 0 THEN BEGIN
        EXIT;
      END;

      Emit := Emit.String(MyChar, 50);
      SuccessArray := SuccessArray.CreateInstance(Emit.GetType, ResultArray.Length);
      HasSuccess := FALSE;

      FOR i := 1 TO ResultArray.Length DO BEGIN
        IF GUIALLOWED THEN BEGIN
          ImportedDocs := ImportedDocs + 1;
          Window.UPDATE(3, ImportedDocs);
        END;

        ExportHdr := ResultArray.GetValue(i-1);
        IF CompelloMgt.IsVoucherTypeValid(ExportHdr.VoucherType) THEN BEGIN
          NoVAT := FALSE;
          InsertHeader;
          ResultArray2 := ExportHdr.GetCompelloExportLines();
          FOR j := 1 TO ResultArray2.Length DO BEGIN
            ExportLine := ResultArray2.GetValue(j-1);
            InsertLine;
          END;
          HasSuccess := TRUE;
          SuccessArray.SetValue(ExportHdr.ArchiveRef, i-1);
        END;
      END;

      IF HasSuccess THEN
        CompelloIntegr.UpdateExportedSuccessArray(IntegrSetup."Client ID", SuccessArray, '');
    END;

    LOCAL PROCEDURE InsertHeader@4();
    VAR
      CommentsArray@1002 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array";
      ImportHdr@1000 : Record 70008;
      ImportComment@1004 : Record 70014;
      MyDateTime@1001 : DateTime;
      i@1003 : Integer;
    BEGIN
      ImportHdr.INIT;
      ImportHdr.GUID := CREATEGUID;
      ImportHdr.Supplier := ExportHdr.Supplier;
      ImportHdr."Client ID" := ExportHdr.ClientId;
      ImportHdr."Archive Ref" := ExportHdr.ArchiveRef;
      MyDateTime := ExportHdr.ScannedDate;
      ImportHdr."Scanned Date" := DT2DATE(MyDateTime);
      ImportHdr."Scanned Time" := DT2TIME(MyDateTime);
      ImportHdr."Voucher Type" := ExportHdr.VoucherType;
      ImportHdr."Invoice No." := ExportHdr.InvoiceNo;
      ImportHdr."Order Ref" := ExportHdr.OrderRef;
      MyDateTime := ExportHdr.VoucherDate;
      ImportHdr."Voucher Date" := DT2DATE(MyDateTime);
      ImportHdr."Voucher Time" := DT2TIME(MyDateTime);
      MyDateTime := ExportHdr.DueDate;
      ImportHdr."Due Date" := DT2DATE(MyDateTime);
      ImportHdr."Due Date Time" := DT2TIME(MyDateTime);
      ImportHdr.KID := ExportHdr.KID;
      ImportHdr."Transaction No." := ExportHdr.TransactionNo;
      ImportHdr."User Defined 1" := ExportHdr.UserDef1;
      ImportHdr."User Defined 2" := ExportHdr.UserDef2;
      ImportHdr."User Defined 3" := ExportHdr.UserDef3;
      ImportHdr."User Defined 4" := ExportHdr.UserDef4;
      ImportHdr."User Defined 5" := ExportHdr.UserDef5;
      ImportHdr."User Defined 6" := ExportHdr.UserDef6;
      ImportHdr."User Defined 7" := ExportHdr.UserDef7;
      ImportHdr."Image GUID" := ExportHdr.GUID;
      ImportHdr."Import Date" := CURRENTDATETIME;
      ImportHdr.INSERT;

      CommentsArray := ExportHdr.CommentsArray();
      FOR i := 1 TO CommentsArray.Length DO BEGIN
        ImportComment.INIT;
        ImportComment.GUID := ImportHdr.GUID;
        ImportComment."Line No." := i;
        ImportComment.Comment := CommentsArray.GetValue(i-1);
        ImportComment.INSERT;
      END;

      HeaderNo := ImportHdr.GUID;
      LineNo := 0;
    END;

    LOCAL PROCEDURE InsertLine@7();
    VAR
      ImportLine@1000 : Record 70009;
      MyDateTime@1001 : DateTime;
      CompelloMgt@1101103000 : Codeunit 70005;
      CompelloSetup@1101103001 : Record 70000;
      DiscountL@1101103002 : Decimal;
    BEGIN
      CompelloSetup.GET;

      LineNo := LineNo + 1;

      ImportLine.INIT;
      ImportLine."Header GUID" := HeaderNo;
      ImportLine."Line No." := LineNo;
      MyDateTime := ExportLine.UserDef7;
      ImportLine."User Defined 7" := DT2DATE(MyDateTime);
      ImportLine."User Defined 7 Time" := DT2TIME(MyDateTime);
      ImportLine."Period Value" := ExportLine.PeriodValue;
      ImportLine."Period Description" := ExportLine.PeriodDesc;

      IF ExportLine.DebetValue <> '' THEN BEGIN
        ImportLine."Debet Type" := ExportLine.DebetType;
        ImportLine."Debet Value" := ExportLine.DebetValue;
      END;
      IF ExportLine.CreditValue <> '' THEN BEGIN
        ImportLine."Credit Type" := ExportLine.CreditType;
        ImportLine."Credit Value" := ExportLine.CreditValue;
      END;

      // Set VAT code for GL accounts when tax code is blank
      IF (ExportLine.DebetType = 'H') AND (ExportLine.DebetTaxCode = '') AND (ExportLine.UserDef8 = '') THEN
        ImportLine."Debet Tax Code" := CompelloSetup."Default Free VAT Code"
      ELSE
        ImportLine."Debet Tax Code" := ExportLine.DebetTaxCode;

      IF (ExportLine.CreditType = 'H') AND (ExportLine.CreditTaxCode = '') THEN
        ImportLine."Credit Tax Code" := CompelloSetup."Default Free VAT Code"
      ELSE
        ImportLine."Credit Tax Code" := ExportLine.CreditTaxCode;

      // Set lines to no VAT when VAT amount from Compello is 0.
      IF (LineNo = 1) AND (ExportLine.VatAmount = 0) AND (NOT CompelloMgt.IsVoucherType2Journal(ExportHdr.VoucherType)) THEN
        NoVAT := TRUE;

      IF (NoVAT) AND (ExportLine.DebetType = 'H') THEN
        ImportLine."Debet Tax Code" := CompelloSetup."Default Free VAT Code";

      IF (NoVAT) AND (ExportLine.CreditType = 'H') THEN
        ImportLine."Credit Tax Code" := CompelloSetup."Default Free VAT Code";

      ImportLine."No VAT" := NoVAT;

      ImportLine."Debet Description" := ExportLine.DebetDesc;
      ImportLine."Debet Tax Code Description" := ExportLine.DebetTaxCodeDesc;
      ImportLine."Credit Description" := ExportLine.CreditDesc;
      ImportLine."Credit Tax Code Description" := ExportLine.CreditTaxCodeDesc;
      ImportLine."Currency Amount" := ExportLine.CurrencyAmount;
      ImportLine."VAT Amount" := ExportLine.VatAmount;
      ImportLine."Currency Value" := ExportLine.CurrencyValue;
      ImportLine."Currency Description" := ExportLine.CurrencyDesc;
      ImportLine.Discount := ExportLine.Discount;
      MyDateTime := ExportLine.DiscountDate;
      ImportLine."Discount Date" := DT2DATE(MyDateTime);
      ImportLine."Discount Date Time" := DT2TIME(MyDateTime);
      ImportLine.Text := ExportLine.Text;
      ImportLine."User Defined 1" := ExportLine.UserDef1;
      ImportLine."User Defined 2" := ExportLine.UserDef2;
      ImportLine."User Defined 3" := ExportLine.UserDef3;
      ImportLine."User Defined 4" := ExportLine.UserDef4;
      ImportLine."User Defined 5" := ExportLine.UserDef5;
      ImportLine."User Defined 6" := ExportLine.UserDef6;
      ImportLine."User Defined 8" := ExportLine.UserDef8;
      ImportLine."User Defined 9" := ExportLine.UserDef9;
      ImportLine."User Defined 10" := ExportLine.UserDef10;
      ImportLine."User Defined 11" := ExportLine.UserDef11;
      ImportLine."User Defined 12" := ExportLine.UserDef12;
      ImportLine."User Defined 13" := ExportLine.UserDef13;
      ImportLine."User Defined 14" := ExportLine.UserDef14;
      ImportLine."User Defined 15" := ExportLine.UserDef15;
      ImportLine."Dimension 1 Value" := ExportLine.Dim1Value;
      ImportLine."Dimension 1 Description" := ExportLine.Dim1Desc;
      ImportLine."Dimension 2 Value" := ExportLine.Dim2Value;
      ImportLine."Dimension 2 Description" := ExportLine.Dim2Desc;
      ImportLine."Dimension 3 Value" := ExportLine.Dim3Value;
      ImportLine."Dimension 3 Description" := ExportLine.Dim3Desc;
      ImportLine."Dimension 4 Value" := ExportLine.Dim4Value;
      ImportLine."Dimension 4 Description" := ExportLine.Dim4Desc;
      ImportLine."Dimension 5 Value" := ExportLine.Dim5Value;
      ImportLine."Dimension 5 Description" := ExportLine.Dim5Desc;
      ImportLine."Dimension 6 Value" := ExportLine.Dim6Value;
      ImportLine."Dimension 6 Description" := ExportLine.Dim6Desc;
      ImportLine."Dimension 7 Value" := ExportLine.Dim7Value;
      ImportLine."Dimension 7 Description" := ExportLine.Dim7Desc;
      ImportLine."Dimension 8 Value" := ExportLine.Dim8Value;
      ImportLine."Dimension 8 Description" := ExportLine.Dim8Desc;
      ImportLine."Dimension 9 Value" := ExportLine.Dim9Value;
      ImportLine."Dimension 9 Description" := ExportLine.Dim9Desc;
      ImportLine."Dimension 10 Value" := ExportLine.Dim10Value;
      ImportLine."Dimension 10 Description" := ExportLine.Dim10Desc;
      ImportLine."Dimension 11 Value" := ExportLine.Dim11Value;
      ImportLine."Dimension 11 Description" := ExportLine.Dim11Desc;
      ImportLine."Dimension 12 Value" := ExportLine.Dim12Value;
      ImportLine."Dimension 12 Description" := ExportLine.Dim12Desc;
      ImportLine."Dimension 13 Value" := ExportLine.Dim13Value;
      ImportLine."Dimension 13 Description" := ExportLine.Dim13Desc;
      ImportLine."Dimension 14 Value" := ExportLine.Dim14Value;
      ImportLine."Dimension 14 Description" := ExportLine.Dim14Desc;
      ImportLine."Dimension 15 Value" := ExportLine.Dim15Value;
      ImportLine."Dimension 15 Description" := ExportLine.Dim15Desc;
      ImportLine.ProductValue := ExportLine.ProductValue;
      ImportLine.ProductDesc := ExportLine.ProductDesc;
      ImportLine.ProductDescriptionFree := ExportLine.ProductDescFree;
      ImportLine.Received := ExportLine.Received;
      ImportLine.ReceivedUnits := ExportLine.ReceivedUnits;

      ImportLine.Amount := ExportLine.Amount;
      ImportLine.UnitPrice := ExportLine.UnitPrice;
      ImportLine.Volume := ExportLine.Volume;

      IF (ImportLine.UnitPrice = 0) OR (ImportLine.Volume = 0) THEN
      BEGIN
        ImportLine.Volume := 1;
        ImportLine.UnitPrice := ExportLine.Amount;
      END;
      //02. JAL 17.02.17 -->
      IF TODAY < 300617D THEN
        ImportLine."User Defined 14" := '';
      DiscountL := 0;
      IF ImportLine."User Defined 5" <> '' THEN
        EVALUATE(DiscountL, ImportLine."User Defined 5");

      IF DiscountL = 0 THEN
        ImportLine.UnitPrice := ROUND((ImportLine.Amount / ImportLine.Volume), 0.00001)
      ELSE
        ImportLine.UnitPrice := ROUND((ImportLine.Amount / (1 - (DiscountL / 100)) / ImportLine.Volume), 0.00001);
      //02. JAL 17.02.17 -->
      IF CompelloMgt.IsVoucherTypeInvoice(ExportHdr.VoucherType) AND (ExportLine.CreditType = 'H') THEN
        ImportLine.Volume := (ImportLine.Volume * -1);

      IF CompelloMgt.IsVoucherTypeCreditMemo(ExportHdr.VoucherType) AND (ExportLine.DebetType = 'H') THEN
        ImportLine.Volume := (ImportLine.Volume * -1);

      CompelloMgt.CheckForReceiptLineInfo(ImportLine);
      SetCurrencyFactor(ImportLine, ExportLine.UserDef14);
      ClearVATCode(ImportLine);

      IF ((ImportLine."Debet Value" <> '') OR (ImportLine."Credit Value" <> '')) THEN
        ImportLine.INSERT;
    END;

    LOCAL PROCEDURE ReactivateOnError@6();
    VAR
      ResultArray@1000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array";
      ReactivateArray@1001 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array";
      Emit@1003 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.String";
      ErrData@1005 : DotNet "'CompelloIntegration, Version=8.0.0.0, Culture=neutral, PublicKeyToken=09a47ba60ac3be91'.Compello.IntegrationAPI.CompelloExport";
      i@1002 : Integer;
      MyChar@1004 : Char;
    BEGIN
      ResultArray := CompelloIntegr.GetErrorDocumentsArray(IntegrSetup."Client ID", '');

      IF ResultArray.Length > 0 THEN BEGIN
        Emit := Emit.String(MyChar, 50);
        //ReactivateArray := ReactivateArray.CreateInstance(Emit.GetType, 1);//03. 01.06.17 JAL
        FOR i := 1 TO ResultArray.Length DO BEGIN
          IF GUIALLOWED THEN BEGIN
            RestoredDocs := RestoredDocs + 1;
            Window.UPDATE(2, RestoredDocs);
          END;
          ReactivateArray := ReactivateArray.CreateInstance(Emit.GetType, 1);//03. 01.06.17 JAL
          ErrData := ResultArray.GetValue(i-1);
          ReactivateArray.SetValue(ErrData.ArchiveRef, 0);
          CompelloIntegr.UpdateExportedReactivateArray(IntegrSetup."Client ID", ReactivateArray, '');//03. 01.06.17 JAL
        END;
        //CompelloIntegr.UpdateExportedReactivateArray(IntegrSetup."Client ID", ReactivateArray, '');//03. 01.06.17 JAL
      END;
    END;

    LOCAL PROCEDURE ReactivateOneRecord@10(ArchiveRef@1006 : Text[30]) : Boolean;
    VAR
      ReactivateArray@1004 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array";
      Emit@1003 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.String";
      MyChar@1000 : Char;
    BEGIN
      StartIntegrSession;

      Emit := Emit.String(MyChar, 50);
      ReactivateArray := ReactivateArray.CreateInstance(Emit.GetType, 1);
      ReactivateArray.SetValue(ArchiveRef, 0);

      CompelloIntegr.UpdateExportedReactivateArray(IntegrSetup."Client ID", ReactivateArray, '');

      EndIntegrSession;
      EXIT(TRUE);
    END;

    PROCEDURE ReactivateArchiveImport@1101103007(VAR ImportHdrArchive@1000 : Record 70011);
    VAR
      ImportLineArchive@1001 : Record 70012;
      ImportCommentArchive@1006 : Record 70015;
    BEGIN
      IF ImportHdrArchive.FINDFIRST THEN BEGIN
        IF ReactivateOneRecord(ImportHdrArchive."Archive Ref") THEN BEGIN
          ImportLineArchive.SETRANGE("Header GUID", ImportHdrArchive.GUID);
          IF ImportLineArchive.FINDSET THEN BEGIN
            ImportLineArchive.DELETEALL;
          END;

          ImportCommentArchive.SETRANGE(GUID, ImportHdrArchive.GUID);
          IF ImportCommentArchive.FINDSET THEN BEGIN
            ImportCommentArchive.DELETEALL;
          END;

          ImportHdrArchive.DELETE;
        END;
      END;
    END;

    PROCEDURE DeleteImportedRecord@8(VAR ImportHdr@1000 : Record 70008) : Boolean;
    BEGIN

      IF CONFIRM(Text007, FALSE) THEN BEGIN
        IF ImportHdr."Archive Ref" <> '' THEN BEGIN
          ReactivateOneRecord(ImportHdr."Archive Ref");
          ArchiveImport(ImportHdr, TRUE);
        END;

        EXIT(TRUE);
      END;

      EXIT(FALSE);
    END;

    PROCEDURE ArchiveImport@9(VAR ImportHdr@1000 : Record 70008;IsDeleted@1004 : Boolean);
    VAR
      ImportLine@1003 : Record 70009;
      ImportHdrArchive@1002 : Record 70011;
      ImportLineArchive@1001 : Record 70012;
      ImportComment@1005 : Record 70014;
      ImportCommentArchive@1006 : Record 70015;
    BEGIN
      ImportHdrArchive.TRANSFERFIELDS(ImportHdr, TRUE);
      IF IsDeleted THEN BEGIN
        ImportHdrArchive.Status := ImportHdrArchive.Status::Deleted;
      END ELSE BEGIN
        ImportHdrArchive.Status := ImportHdrArchive.Status::Created;
      END;
      ImportHdrArchive."Last Action Date" := CURRENTDATETIME;
      IF NOT IsDeleted THEN
        ImportHdrArchive.INSERT;

      ImportLine.SETRANGE("Header GUID", ImportHdr.GUID);
      IF ImportLine.FINDSET THEN BEGIN
        REPEAT
          ImportLineArchive.TRANSFERFIELDS(ImportLine, TRUE);
          IF NOT IsDeleted THEN
            ImportLineArchive.INSERT;
        UNTIL ImportLine.NEXT = 0;
        ImportLine.DELETEALL;
      END;

      ImportComment.SETRANGE(GUID, ImportHdr.GUID);
      IF ImportComment.FINDSET THEN BEGIN
        REPEAT
          ImportCommentArchive.TRANSFERFIELDS(ImportComment);
          IF NOT IsDeleted THEN
            ImportCommentArchive.INSERT;
        UNTIL ImportComment.NEXT = 0;
        ImportComment.DELETEALL;
      END;

      ImportHdr.DELETE;
    END;

    LOCAL PROCEDURE SetCurrencyFactor@1101103000(VAR ImportLine@1101103000 : Record 70009;Factor@1101103001 : Text[100]);
    VAR
      Currency@1101103002 : Record 4;
      GenLedgSetup@1101103003 : Record 98;
      FactorDec@1101103004 : Decimal;
    BEGIN
      GenLedgSetup.GET;
      GenLedgSetup.TESTFIELD(GenLedgSetup."LCY Code");
      IF (ImportLine."Currency Value" = '') OR (ImportLine."Currency Value" = GenLedgSetup."LCY Code") THEN BEGIN
        ImportLine."Currency Value" := '';
        ImportLine."User Defined 14" := '';
      END;

      IF ((Factor <> '') AND (ImportLine."Currency Value" <> '')) THEN
        IF Currency.GET(ImportLine."Currency Value") THEN BEGIN
          Currency.TESTFIELD("Units to NOK");
          EVALUATE(FactorDec, Factor);
          ImportLine."User Defined 14" :=  FORMAT(Currency."Units to NOK" / FactorDec);
        END;
    END;

    LOCAL PROCEDURE ClearVATCode@1101103001(VAR ImportLine@1101103000 : Record 70009);
    BEGIN
      // Delete TAX code for lines with definition for both Credit and Debet from Compello.
      IF ((ImportLine."Credit Type" <> '') AND (ImportLine."Credit Value" <> '')) THEN
        ImportLine."Debet Tax Code" := '';
      IF ((ImportLine."Debet Type" <> '') AND (ImportLine."Debet Value" <> '')) THEN
        ImportLine."Credit Tax Code" := '';
    END;

    BEGIN
    {
      +---------------------------------------------+
      | SI-Data                                     |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 24.04.15 JAL Download only defined voucher types
                       Handle Tax Code for PO match in user defined fields
                       Set Unit Price and Volume for Purchase Invoice
      02. 17.02.17 JAL Calculate "Unit Price"
      03. 01.06.17 JAL Fixing bug when ReactivateOnError fails.
    }
    END.
  }
}

OBJECT Codeunit 70003 Compello Create Document
{
  OBJECT-PROPERTIES
  {
    Date=20.02.17;
    Time=11:25:49;
    Modified=Yes;
    Version List=CMP2.00.02;
  }
  PROPERTIES
  {
    TableNo=70008;
    OnRun=BEGIN
            CreatePurchaseHeader(Rec);
          END;

  }
  CODE
  {
    VAR
      Text001@1000 : TextConst 'ENU=Field type "%1" is not supported;NOR=Felt type "%1" er ikke st›ttet';
      ErrorText@1001 : Text[250];
      Text002@1002 : TextConst 'ENU=Cannot be added dimension %1 with value %2;NOR=Dimensjon %1 kan ikke bli lagt til med verdi %2';
      Text003@1003 : TextConst 'ENU=Dimension Set ID field should have field ID 480 in table %1;NOR=Dimension Set ID feltet skal ha verdi i felt ID 480 in table %1';
      ErrorsExist@1004 : Boolean;
      CompelloSetup@1101103000 : Record 70000;
      Text004@1101103001 : TextConst 'ENU=Rounding cannot be more than 1,00. Rounding amount is %1.;NOR=Avrunding kan ikke v‘re mer enn 1,00. Avrunding er %1.';
      Text005@1101103002 : TextConst 'ENU=The %1 on the %2 %3 and the %4 %5 must be the same.;NOR=%1 p† %2 %3 og %4 %5 m† v‘re lik.';
      Test006@1101103003 : TextConst 'ENU=Header setup not found for %1;NOR=Oppsett for Hode finnes ikke for %1';
      Test007@1101103004 : TextConst 'ENU=Line is not found for %1 and  Credit Type %2;NOR=Linje finnes ikke for %1 og Credit Type %2';

    PROCEDURE CreatePurchaseHeader@1101103001(VAR ImportHdr@1101103000 : Record 70008) : Boolean;
    VAR
      PurchaseRcptLine@1101103004 : Record 121;
      CompelloSetup@1101103001 : Record 70000;
      errorNoVoucerType@1101103002 : TextConst 'ENU=Voucher type in Navision does not correspond with the document type in Compello;NOR=Dokumentypen i Navision stemmer ikke overens med dokumenttypen i Compello';
      Created@1101103003 : Boolean;
    BEGIN
      ErrorText := '';
      ErrorsExist := FALSE;

      CompelloSetup.GET;
      CompelloSetup.TESTFIELD("Doc. Type Item Invoice");
      CompelloSetup.TESTFIELD("Doc. Type Item Credit");
      CompelloSetup.TESTFIELD("Doc. Type Journal Invoice");
      CompelloSetup.TESTFIELD("Doc. Type Journal Credit");

      Created := FALSE;

      IF (ImportHdr."Voucher Type" = CompelloSetup."Doc. Type Item Credit") OR
         (ImportHdr."Voucher Type" = CompelloSetup."Doc. Type Journal Credit") THEN
        Created := CreatePurchCrMemo(ImportHdr)
      ELSE IF (ImportHdr."Voucher Type" = CompelloSetup."Doc. Type Item Invoice") OR
         (ImportHdr."Voucher Type" = CompelloSetup."Doc. Type Journal Invoice") THEN
        Created := CreatePurchInvoice(ImportHdr)
      ELSE
        ErrorText := errorNoVoucerType;

      EXIT(Created);
    END;

    LOCAL PROCEDURE CreatePurchInvoice@1(VAR ImportHdr@1000 : Record 70008) : Boolean;
    VAR
      ImportSetupHdr@1001 : Record 70003;
      ImportSetupHdr2@1004 : Record 70003;
      ImportLine@1002 : Record 70009;
      ImportMgt@1006 : Codeunit 70002;
      HeaderRecRef@1003 : RecordRef;
      LineNo@1005 : Integer;
      DocumentType@1000000000 : ' ,Invoice,Credit Memo';
      POHeaderAmount@1101103000 : Decimal;
      CompelloMgt@1101103001 : Codeunit 70005;
    BEGIN
      ErrorText := '';
      LineNo := 0;

      IF NOT GetPurchHdrSetup(ImportSetupHdr, ImportSetupHdr2, FALSE) THEN BEGIN
        ErrorText := STRSUBSTNO(Test006, ImportSetupHdr.Code);
        EXIT(FALSE);
      END;
      IF NOT GetPurchHdrLine(ImportHdr, ImportLine, 'L', '') THEN BEGIN
        ErrorText := STRSUBSTNO(Test007, ImportHdr.GUID, 'L');
        EXIT(FALSE);
      END;

      HeaderRecRef.OPEN(ImportSetupHdr."Table ID");

      IF NOT CreatePurchInvHeader(ImportHdr, ImportLine, ImportSetupHdr, ImportSetupHdr2, HeaderRecRef) THEN BEGIN
        HeaderRecRef.CLOSE;
        EXIT(FALSE);
      END;

      POHeaderAmount := ImportLine.Amount;

      ImportLine.SETRANGE("Header GUID", ImportHdr.GUID);
      ImportLine.SETFILTER("Credit Type", '<>%1', 'L');
      ImportLine.SETFILTER("Debet Type", '<>%1', 'L');
      IF ImportLine.FINDSET THEN BEGIN
        REPEAT
          ErrorsExist := ErrorsExist OR CreatePurchInvLine(ImportHdr,ImportLine, ImportSetupHdr2, HeaderRecRef, LineNo);
        UNTIL (ImportLine.NEXT = 0) OR (ErrorsExist);
      END;

      IF NOT ErrorsExist THEN BEGIN
        SaveLinkToPurchaseHeader(ImportHdr, HeaderRecRef, DocumentType::Invoice);
        CreatePurchInvComment(ImportHdr, HeaderRecRef);
      END;
      ImportLine.RESET;
      GetPurchHdrLine(ImportHdr, ImportLine, 'L', '');
      UpdateVAT(ImportLine, HeaderRecRef, ImportHdr);

      IF ErrorsExist THEN BEGIN
        HeaderRecRef.DELETE(TRUE);
        HeaderRecRef.CLOSE;
        EXIT(FALSE);
      END;

      CompelloMgt.CreateGenJnlLine(ImportHdr, HeaderRecRef, POHeaderAmount);

      HeaderRecRef.CLOSE;
      ImportMgt.ArchiveImport(ImportHdr, FALSE);
      EXIT(TRUE);
    END;

    LOCAL PROCEDURE CreatePurchCrMemo@4(VAR ImportHdr@1000 : Record 70008) : Boolean;
    VAR
      ImportSetupHdr@1001 : Record 70003;
      ImportSetupHdr2@1004 : Record 70003;
      ImportLine@1002 : Record 70009;
      ImportMgt@1006 : Codeunit 70002;
      HeaderRecRef@1003 : RecordRef;
      LineNo@1005 : Integer;
      DocumentType@1000000000 : ' ,Invoice,Credit Memo';
      POHeaderAmount@1101103001 : Decimal;
      CompelloMgt@1101103000 : Codeunit 70005;
    BEGIN
      ErrorText := '';
      LineNo := 0;
      IF NOT GetPurchHdrSetup(ImportSetupHdr, ImportSetupHdr2, TRUE) THEN BEGIN
        EXIT(FALSE);
      END;
      IF NOT GetPurchHdrLine(ImportHdr, ImportLine, '', 'L') THEN BEGIN
        EXIT(FALSE);
      END;

      HeaderRecRef.OPEN(ImportSetupHdr."Table ID");

      IF NOT CreatePurchInvHeader(ImportHdr, ImportLine, ImportSetupHdr, ImportSetupHdr2, HeaderRecRef) THEN BEGIN
        EXIT(FALSE);
      END;

      POHeaderAmount := ImportLine.Amount;

      ImportLine.SETRANGE("Header GUID", ImportHdr.GUID);
      ImportLine.SETFILTER("Credit Type", '<>%1', 'L');
      ImportLine.SETFILTER("Debet Type", '<>%1', 'L');
      IF ImportLine.FINDSET THEN BEGIN
        REPEAT
          CreatePurchInvLine(ImportHdr, ImportLine, ImportSetupHdr2, HeaderRecRef, LineNo);
        UNTIL ImportLine.NEXT = 0;
      END;

      IF NOT ErrorsExist THEN BEGIN
        SaveLinkToPurchaseHeader(ImportHdr, HeaderRecRef, DocumentType::"Credit Memo");
        CreatePurchInvComment(ImportHdr, HeaderRecRef);
      END;

      CompelloMgt.CreateGenJnlLine(ImportHdr, HeaderRecRef, POHeaderAmount);

      HeaderRecRef.CLOSE;
      ImportMgt.ArchiveImport(ImportHdr, FALSE);
      EXIT(TRUE);
    END;

    LOCAL PROCEDURE CreatePurchInvHeader@16(VAR ImportHdr@1000 : Record 70008;ImportLine@1001 : Record 70009;ImportSetupHdr@1003 : Record 70003;ImportSetupHdr2@1002 : Record 70003;VAR HeaderRecRef@1005 : RecordRef) : Boolean;
    VAR
      ImportSetupLine@1004 : Record 70004;
      DimMgt@1012 : Codeunit 408;
      PrimaryKeyRef@1006 : KeyRef;
      HdrFieldRef@1007 : FieldRef;
      KeyFieldRef@1009 : FieldRef;
      i@1008 : Integer;
      DimSetID@1011 : Integer;
      ExistingDimSetID@1013 : Integer;
      PrimaryKeyField@1010 : Boolean;
      PurchaseHeader@1101103000 : Record 38;
      DueDate@1101103001 : Date;
      DocDate@1101103002 : Date;
      PostingDate@1101103007 : Date;
      NoSeriesFieldRef@1101103003 : FieldRef;
      PostingNoSeriesFieldRef@1101103004 : FieldRef;
      NoFieldRef@1101103005 : FieldRef;
      CompelloMgt@1101103006 : Codeunit 70005;
      CurrFactor@1101103008 : Decimal;
    BEGIN
      CompelloSetup.GET;

      ImportSetupLine.SETFILTER("Table Code", '%1|%2', ImportSetupHdr.Code, ImportSetupHdr2.Code);
      ImportSetupLine.SETRANGE("Table ID", ImportSetupHdr."Table ID");

      PrimaryKeyRef := HeaderRecRef.KEYINDEX(1);
      HeaderRecRef.INIT;

      //Insert primary key field values
      FOR i := 1 TO PrimaryKeyRef.FIELDCOUNT DO BEGIN
        KeyFieldRef := PrimaryKeyRef.FIELDINDEX(i);
        HdrFieldRef := HeaderRecRef.FIELD(KeyFieldRef.NUMBER);
        ImportSetupLine.SETRANGE("Field ID", KeyFieldRef.NUMBER);
        IF ImportSetupLine.FINDFIRST THEN BEGIN
          IF ImportSetupLine."Use Default Value" <> '' THEN BEGIN
            SetDefValueToField(ImportSetupLine, HdrFieldRef);
          END ELSE BEGIN
            IF ImportSetupLine."Map To Table Data Type" = 101 THEN BEGIN
              SetValueToFieldFromHdr(ImportHdr, HdrFieldRef, ImportSetupLine);
            END ELSE BEGIN
              SetValueToFieldFromLine(ImportLine, HdrFieldRef, ImportSetupLine);
            END;
          END;
        END;
      END;
      ImportSetupLine.SETRANGE("Field ID");

      //Set other fields than primary key
      ImportSetupLine.SETCURRENTKEY("Sequence No.");
      IF ImportSetupLine.FINDSET THEN BEGIN
        REPEAT
          IF ImportSetupLine."Field ID" <> 0 THEN BEGIN
            IF (ImportSetupLine."Field ID" = 15) THEN MESSAGE(FORMAT(ImportLine.Volume));
            //Normal fields management
            PrimaryKeyField := FALSE;
            FOR i := 1 TO PrimaryKeyRef.FIELDCOUNT DO BEGIN
              KeyFieldRef := PrimaryKeyRef.FIELDINDEX(i);
              IF KeyFieldRef.NUMBER = ImportSetupLine."Field ID" THEN BEGIN
                PrimaryKeyField := TRUE;
              END;
            END;
            IF NOT PrimaryKeyField THEN BEGIN
              HdrFieldRef := HeaderRecRef.FIELD(ImportSetupLine."Field ID");
              IF ImportSetupLine."Use Default Value" <> '' THEN BEGIN
                SetDefValueToField(ImportSetupLine, HdrFieldRef);
              END ELSE BEGIN
                IF ImportSetupLine."Map To Table Data Type" = 101 THEN BEGIN
                  SetValueToFieldFromHdr(ImportHdr, HdrFieldRef, ImportSetupLine);
                END ELSE BEGIN
                  SetValueToFieldFromLine(ImportLine, HdrFieldRef, ImportSetupLine);
                END;
              END;
            END;
          END ELSE BEGIN
            //Dimension management
            IF ImportSetupLine."Dimension Code" <> '' THEN BEGIN
              IF ImportSetupLine."Use Default Value" <> '' THEN BEGIN
                IF NOT DimMgt.AddDimToDimSet(DimSetID, ImportSetupLine."Dimension Code", ImportSetupLine."Use Default Value") THEN BEGIN
                  ErrorText := STRSUBSTNO(Text002, ImportSetupLine."Dimension Code", ImportSetupLine."Use Default Value");
                  EXIT(FALSE);
                END;
              END ELSE BEGIN
                IF ImportSetupLine."Map To Table Data Type" = 101 THEN BEGIN
                  IF NOT DimMgt.AddDimToDimSet(DimSetID, ImportSetupLine."Dimension Code", GetDimValueFromHdr(ImportHdr, HdrFieldRef, ImportSetupLine)) THEN BEGIN
                    ErrorText := STRSUBSTNO(Text002, ImportSetupLine."Dimension Code", GetDimValueFromHdr(ImportHdr, HdrFieldRef, ImportSetupLine));
                    EXIT(FALSE);
                  END;
                END ELSE BEGIN
                  IF NOT DimMgt.AddDimToDimSet(DimSetID, ImportSetupLine."Dimension Code", GetDimValueFromLine(ImportLine, HdrFieldRef, ImportSetupLine)) THEN BEGIN
                    ErrorText := STRSUBSTNO(Text002, ImportSetupLine."Dimension Code", GetDimValueFromLine(ImportLine, HdrFieldRef, ImportSetupLine));
                    EXIT(FALSE);
                  END;
                END;
              END;
            END;
          END;
        UNTIL ImportSetupLine.NEXT = 0;

        IF DimSetID <> 0 THEN BEGIN
          IF HeaderRecRef.FIELDEXIST(480) THEN BEGIN
            HdrFieldRef := HeaderRecRef.FIELD(480);
            IF UPPERCASE(FORMAT(HdrFieldRef.TYPE)) = 'INTEGER' THEN BEGIN
              EVALUATE(ExistingDimSetID, FORMAT(HdrFieldRef.VALUE));
              HdrFieldRef.VALUE(DimMgt.CopyDimSetToDimSet(DimSetID, ExistingDimSetID));
            END ELSE BEGIN
              ErrorText := STRSUBSTNO(Text003, HdrFieldRef.NUMBER);
              EXIT(FALSE);
            END;
          END ELSE BEGIN
            ErrorText := STRSUBSTNO(Text003, HdrFieldRef.NUMBER);
            EXIT(FALSE);
          END;
        END;

        IF CompelloMgt.CheckVoucherType(ImportHdr) THEN BEGIN
          NoSeriesFieldRef := HeaderRecRef.FIELD(107);
          NoSeriesFieldRef.VALUE := '';
          PostingNoSeriesFieldRef := HeaderRecRef.FIELD(108);
          PostingNoSeriesFieldRef.VALUE :='';
          NoFieldRef := HeaderRecRef.FIELD(3);
          NoFieldRef.VALUE := '1';
        END;

        HeaderRecRef.INSERT(TRUE);

        IF ImportSetupHdr."Table ID" = DATABASE::"Purchase Header" THEN BEGIN
          PurchaseHeader.GET(HeaderRecRef.RECORDID);
          PurchaseHeader.SetHideValidationDialog(TRUE);
          DocDate := PurchaseHeader."Document Date";
          DueDate := PurchaseHeader."Due Date";
          PostingDate := PurchaseHeader."Posting Date";
          IF (PurchaseHeader."Posting Date" = 0D) THEN
            PurchaseHeader.VALIDATE("Posting Date", DocDate)
          ELSE
            PurchaseHeader.VALIDATE("Posting Date", PostingDate);

          IF ImportLine."Currency Value" <> '' THEN
            PurchaseHeader.VALIDATE("Currency Code", ImportLine."Currency Value")
          ELSE
           PurchaseHeader.VALIDATE("Currency Code", '');

          IF ImportLine."User Defined 14" <> '' THEN BEGIN
            EVALUATE(CurrFactor, ImportLine."User Defined 14");
            PurchaseHeader.VALIDATE("Currency Factor", CurrFactor);
          END;

          PurchaseHeader.VALIDATE("Document Date", DocDate);
          PurchaseHeader.VALIDATE("Due Date", DueDate);
          PurchaseHeader.MODIFY(TRUE);

          ImportHdr."Vendor No." := PurchaseHeader."Buy-from Vendor No.";
        END;
      END;

      EXIT(TRUE);
    END;

    LOCAL PROCEDURE CreatePurchInvLine@5(ImportHdr@1101103000 : Record 70008;ImportLine@1001 : Record 70009;ImportSetupHdr@1003 : Record 70003;VAR HeaderRecRef@1005 : RecordRef;VAR LineNo@1000 : Integer) : Boolean;
    VAR
      ImportSetupLine@1004 : Record 70004;
      HeaderLineRelation@1011 : Record 70013;
      DimMgt@1013 : Codeunit 408;
      LineRecRef@1002 : RecordRef;
      LineRecRef2@1000000000 : RecordRef;
      PrimaryKeyRef@1012 : KeyRef;
      HdrFieldRef@1007 : FieldRef;
      LineFieldRef@1006 : FieldRef;
      KeyFieldRef@1009 : FieldRef;
      i@1008 : Integer;
      DimSetID@1014 : Integer;
      ExistingDimSetID@1015 : Integer;
      PrimaryKeyField@1010 : Boolean;
      CreatedRcpLine@1101103003 : Boolean;
      PurchaseRcptLine@1101103001 : Record 121;
      PurchaseLine@1101103004 : Record 39;
      CompelloMgt@1101103002 : Codeunit 70005;
    BEGIN
      LineRecRef.OPEN(ImportSetupHdr."Table ID");
      LineRecRef.INIT;

      CLEAR(PurchaseLine);
      LineNo := LineNo + 10000;
      CreatedRcpLine := FALSE;
      IF (ImportSetupHdr."Table ID" = DATABASE::"Purchase Line") THEN BEGIN
          CreatedRcpLine := CreatePurchInvLineFromReceipt(ImportSetupHdr, ImportLine, HeaderRecRef, PurchaseLine);
          IF CreatedRcpLine THEN BEGIN
            LineRecRef.GETTABLE(PurchaseLine);
            LineNo :=  PurchaseLine."Line No.";
          END;
      END;

      IF (NOT CreatedRcpLine) THEN BEGIN
        HeaderLineRelation.SETRANGE("Table Code", ImportSetupHdr.Code);
        IF HeaderLineRelation.FINDSET THEN BEGIN
          REPEAT
            IF (HeaderLineRelation."Header Field No." <> 0) AND (HeaderLineRelation."Line Field No." <> 0) THEN BEGIN
              HdrFieldRef := HeaderRecRef.FIELD(HeaderLineRelation."Header Field No.");
              LineFieldRef := LineRecRef.FIELD(HeaderLineRelation."Line Field No.");
              IF HeaderLineRelation.Validate THEN BEGIN
                LineFieldRef.VALIDATE(HdrFieldRef.VALUE);
              END ELSE BEGIN
                LineFieldRef.VALUE(HdrFieldRef.VALUE);
              END;
            END;
          UNTIL HeaderLineRelation.NEXT = 0;
        END;

        PrimaryKeyRef := LineRecRef.KEYINDEX(1);
        KeyFieldRef := PrimaryKeyRef.FIELDINDEX(PrimaryKeyRef.FIELDCOUNT);
        IF FORMAT(KeyFieldRef.TYPE)= 'Integer' THEN BEGIN
          LineFieldRef := LineRecRef.FIELD(KeyFieldRef.NUMBER);
          LineFieldRef.VALUE(LineNo);
        END;

        LineFieldRef := LineRecRef.FIELD(5);
        LineFieldRef.VALIDATE(PurchaseRcptLine.Type::"G/L Account");
        LineFieldRef := LineRecRef.FIELD(6);
        IF ImportLine."Debet Value" <> '' THEN
          LineFieldRef.VALIDATE(ImportLine."Debet Value")
        ELSE
          LineFieldRef.VALIDATE(ImportLine."Credit Value");
      END;

      ImportSetupLine.SETRANGE("Table Code", ImportSetupHdr.Code);
      ImportSetupLine.SETRANGE("Table ID", ImportSetupHdr."Table ID");
      ImportSetupLine.SETCURRENTKEY("Sequence No.");

      //Set other fields than primary key
      IF ImportSetupLine.FINDSET THEN BEGIN
        PrimaryKeyRef := LineRecRef.KEYINDEX(1);
        REPEAT
          IF ImportSetupLine."Field ID" <> 0 THEN BEGIN
            //normal field management
            PrimaryKeyField := FALSE;
            FOR i := 1 TO PrimaryKeyRef.FIELDCOUNT DO BEGIN
              KeyFieldRef := PrimaryKeyRef.FIELDINDEX(i);
              IF KeyFieldRef.NUMBER = ImportSetupLine."Field ID" THEN BEGIN
                PrimaryKeyField := TRUE;
              END;
            END;
            IF ((NOT PrimaryKeyField) AND (NOT CreatedRcpLine)) THEN BEGIN
              LineFieldRef := LineRecRef.FIELD(ImportSetupLine."Field ID");
              IF ImportSetupLine."Use Default Value" <> '' THEN BEGIN
                SetDefValueToField(ImportSetupLine, LineFieldRef);
              END ELSE BEGIN
                SetValueToFieldFromLine(ImportLine, LineFieldRef, ImportSetupLine);
              END;
            END;
          ImportSetupLine.CALCFIELDS("Field Name","Map-to Field Name");
          END ELSE BEGIN
            //Dimension management
            IF ImportSetupLine."Dimension Code" <> '' THEN BEGIN
              IF ImportSetupLine."Use Default Value" <> '' THEN BEGIN
                IF NOT DimMgt.AddDimToDimSet(DimSetID, ImportSetupLine."Dimension Code", ImportSetupLine."Use Default Value") THEN BEGIN
                  ErrorText := STRSUBSTNO(Text002, ImportSetupLine."Dimension Code", ImportSetupLine."Use Default Value");
                  EXIT(FALSE);
                END;
              END ELSE BEGIN
                IF NOT DimMgt.AddDimToDimSet(DimSetID, ImportSetupLine."Dimension Code", GetDimValueFromLine(ImportLine, HdrFieldRef, ImportSetupLine)) THEN BEGIN
                  ErrorText := STRSUBSTNO(Text002, ImportSetupLine."Dimension Code", GetDimValueFromLine(ImportLine, HdrFieldRef, ImportSetupLine));
                  EXIT(FALSE);
                END;
              END;
            END;
          END;
        UNTIL ImportSetupLine.NEXT = 0;

        IF DimSetID <> 0 THEN BEGIN
          IF LineRecRef.FIELDEXIST(480) THEN BEGIN
            LineFieldRef := LineRecRef.FIELD(480);
            IF UPPERCASE(FORMAT(LineFieldRef.TYPE)) = 'INTEGER' THEN BEGIN
              EVALUATE(ExistingDimSetID, FORMAT(LineFieldRef.VALUE));
              LineFieldRef.VALUE(DimMgt.CopyDimSetToDimSet(DimSetID, ExistingDimSetID));
            END ELSE BEGIN
              ErrorText := STRSUBSTNO(Text003, LineFieldRef.NUMBER);
              EXIT(FALSE);
            END;
          END ELSE BEGIN
            ErrorText := STRSUBSTNO(Text003, LineFieldRef.NUMBER);
            EXIT(FALSE);
          END;
        END;

        IF LineRecRef.INSERT(TRUE) THEN;
        IF CreatedRcpLine THEN BEGIN
          LineRecRef.MODIFY(TRUE);
        END;

      END;

      LineRecRef.CLOSE;
    END;

    LOCAL PROCEDURE CreatePurchInvComment@2(ImportHdr@1001 : Record 70008;VAR HeaderRecRef@1000 : RecordRef);
    VAR
      ImportComment@1002 : Record 70014;
      PurchaseHeader@1003 : Record 38;
      PurchCommentLine@1004 : Record 43;
    BEGIN
      HeaderRecRef.SETTABLE(PurchaseHeader);

      ImportComment.RESET;
      ImportComment.SETRANGE(GUID, ImportHdr.GUID);
      IF ImportComment.FINDSET THEN BEGIN
        REPEAT
          PurchCommentLine.INIT;
          PurchCommentLine.VALIDATE("Document Type", PurchaseHeader."Document Type");
          PurchCommentLine.VALIDATE("No.", PurchaseHeader."No.");
          PurchCommentLine.Date := WORKDATE;
          PurchCommentLine."Line No." := ImportComment."Line No.";
          PurchCommentLine.Comment := ImportComment.Comment;
          PurchCommentLine.INSERT;
        UNTIL ImportComment.NEXT = 0;
      END;
    END;

    LOCAL PROCEDURE CreatePurchInvLineFromReceipt@1101103000(VAR ImportSetupHdr@1101103000 : Record 70003;VAR ImportLine@1001 : Record 70009;VAR HeaderRecRef@1005 : RecordRef;VAR PurchaseLine@1101103005 : Record 39) Result : Boolean;
    VAR
      CompelloSetup@1101103008 : Record 70000;
      PurchaseHeader@1101103003 : Record 38;
      GetReceipts@1101103002 : Codeunit 74;
      CompelloMgt@1101103004 : Codeunit 70005;
      PurchaseRcptLineTmp@1101103001 : Record 121;
      LineNumber@1101103006 : Integer;
      PurchaseRcptLine@1101103007 : Record 121;
      DiscountL@1101103009 : Decimal;
    BEGIN
      CompelloSetup.GET;

      Result := FALSE;
      IF (ImportSetupHdr."Table ID" = DATABASE::"Purchase Line") THEN BEGIN
        IF CompelloMgt.GetReceiptFromImportLine(ImportLine, PurchaseRcptLine) THEN BEGIN
          PurchaseHeader.GET(HeaderRecRef.RECORDID);
          GetReceipts.SetPurchHeader(PurchaseHeader);
          PurchaseRcptLineTmp.RESET;
          PurchaseRcptLineTmp.SETRANGE("Document No.", PurchaseRcptLine."Document No.");
          PurchaseRcptLineTmp.SETRANGE("Line No.", PurchaseRcptLine."Line No.");
          GetReceipts.CreateInvLines(PurchaseRcptLineTmp);

          CheckCurrency(PurchaseHeader, PurchaseRcptLine);

          PurchaseLine.SETRANGE("Document Type", PurchaseLine."Document Type"::Invoice);
          PurchaseLine.SETRANGE("Document No.", PurchaseHeader."No.");
          PurchaseLine.SETRANGE("Receipt No.", PurchaseRcptLine."Document No.");
          PurchaseLine.SETRANGE("Receipt Line No.", PurchaseRcptLine."Line No.");
          PurchaseLine.FINDFIRST;
          PurchaseLine.VALIDATE(Quantity, ImportLine.Volume);
          PurchaseLine.VALIDATE("Direct Unit Cost", ImportLine.UnitPrice);
          DiscountL := 0;
          IF ImportLine."User Defined 5" <> '' THEN
            EVALUATE(DiscountL, ImportLine."User Defined 5");
          PurchaseLine.VALIDATE("Line Discount %", DiscountL); //03. 17.02.17 JAL

          IF ImportLine."No VAT" THEN
            PurchaseLine.VALIDATE(PurchaseLine."VAT Prod. Posting Group", CompelloSetup."Default Free VAT Code");

          Result := TRUE;
        END;
      END;

      EXIT(Result);
    END;

    LOCAL PROCEDURE SaveLinkToPurchaseHeader@1000000004(VAR ImportHdr@1000000001 : Record 70008;VAR HeaderRecRef@1000000000 : RecordRef;DocumentType@1000000003 : ' ,Invoice,Credit Memo');
    VAR
      PurchaseHeader@1000000002 : Record 38;
    BEGIN
      HeaderRecRef.SETTABLE(PurchaseHeader);

      ImportHdr."Created Document Type" := DocumentType;
      ImportHdr."Created Document No." := PurchaseHeader."No.";
      ImportHdr.MODIFY;
    END;

    LOCAL PROCEDURE GetPurchHdrSetup@3(VAR ImportSetupHdr@1000 : Record 70003;VAR ImportSetupHdr2@1002 : Record 70003;CreditMemo@1001 : Boolean) : Boolean;
    BEGIN
      ImportSetupHdr.SETRANGE("Data Type", 101);
      ImportSetupHdr.SETRANGE("Action IO", ImportSetupHdr."Action IO"::Import);
      ImportSetupHdr.SETRANGE("Credit Document", CreditMemo);
      IF NOT ImportSetupHdr.FINDFIRST THEN BEGIN
        EXIT(FALSE);
      END;

      ImportSetupHdr2.SETRANGE("Related to Header", ImportSetupHdr.Code);
      EXIT(ImportSetupHdr2.FINDFIRST);
    END;

    LOCAL PROCEDURE GetPurchHdrLine@11(ImportHdr@1001 : Record 70008;VAR ImportLine@1000 : Record 70009;CreditType@1002 : Text[10];DebetType@1003 : Text[10]) : Boolean;
    BEGIN
      ImportLine.SETRANGE("Header GUID", ImportHdr.GUID);
      IF CreditType <> '' THEN BEGIN
        ImportLine.SETRANGE("Credit Type", CreditType);
      END;
      IF DebetType <> '' THEN BEGIN
        ImportLine.SETRANGE("Debet Type", DebetType);
      END;
      EXIT(ImportLine.FINDFIRST);
    END;

    LOCAL PROCEDURE SetDefValueToField@6(ImportSetupLine@1000 : Record 70004;VAR MyFieldRef@1001 : FieldRef);
    VAR
      MyInteger@1002 : Integer;
      MyDecimal@1003 : Decimal;
      MyDate@1101103000 : Date;
      MYTime@1101103001 : Time;
    BEGIN
      CASE UPPERCASE(FORMAT(MyFieldRef.TYPE)) OF
        'OPTION', 'INTEGER' : BEGIN
          EVALUATE(MyInteger, ImportSetupLine."Use Default Value");
          IF ImportSetupLine.Validate THEN BEGIN
            MyFieldRef.VALIDATE(MyInteger);
          END ELSE BEGIN
            MyFieldRef.VALUE(MyInteger);
          END;
        END;
        'DECIMAL' : BEGIN
          EVALUATE(MyDecimal, ImportSetupLine."Use Default Value");
          IF ImportSetupLine.Validate THEN BEGIN
            MyFieldRef.VALIDATE(MyDecimal);
          END ELSE BEGIN
            MyFieldRef.VALUE(MyDecimal);
          END;
        END;
        'TEXT', 'CODE' : BEGIN
          IF ImportSetupLine.Validate THEN BEGIN
            MyFieldRef.VALIDATE(ImportSetupLine."Use Default Value");
          END ELSE BEGIN
            MyFieldRef.VALUE(ImportSetupLine."Use Default Value");
          END;
        END;
        ELSE BEGIN
          ERROR(Text001, FORMAT(MyFieldRef.TYPE));
        END;
      END;
    END;

    LOCAL PROCEDURE SetValueToFieldFromHdr@13(ImportHdr@1000 : Record 70008;VAR HdrFieldRef@1001 : FieldRef;ImportSetupLine@1002 : Record 70004);
    VAR
      MyRecRef@1003 : RecordRef;
      MyFieldRef@1004 : FieldRef;
      Dec@1005 : Decimal;
      Text1@1006 : Text[250];
    BEGIN
      MyRecRef.GETTABLE(ImportHdr);
      MyFieldRef := MyRecRef.FIELD(ImportSetupLine."Map-to Field No.");
      IF ImportSetupLine."Only If Not Blank" THEN BEGIN
        CASE UPPERCASE(FORMAT(MyFieldRef.TYPE)) OF
          'OPTION', 'INTEGER', 'DECIMAL' : BEGIN
            Dec := MyFieldRef.VALUE;
            IF (Dec = 0) THEN BEGIN
              MyRecRef.CLOSE;
              EXIT;
            END;
          END;
          'TEXT', 'CODE' : BEGIN
            Text1 := MyFieldRef.VALUE;
            IF (Text1 = '') THEN BEGIN
              MyRecRef.CLOSE;
              EXIT;
            END;
          END;
        END;
      END;
      IF ImportSetupLine.Validate THEN BEGIN
        HdrFieldRef.VALIDATE(MyFieldRef.VALUE);
      END ELSE BEGIN
        HdrFieldRef.VALUE(MyFieldRef.VALUE);
      END;
      MyRecRef.CLOSE;
    END;

    LOCAL PROCEDURE SetValueToFieldFromLine@14(ImportLine@1000 : Record 70009;VAR HdrFieldRef@1001 : FieldRef;ImportSetupLine@1002 : Record 70004);
    VAR
      MyRecRef@1004 : RecordRef;
      MyFieldRef@1003 : FieldRef;
      Dec@1006 : Decimal;
      Text1@1005 : Text[250];
    BEGIN
      MyRecRef.GETTABLE(ImportLine);
      MyFieldRef := MyRecRef.FIELD(ImportSetupLine."Map-to Field No.");
      IF ImportSetupLine."Only If Not Blank" THEN BEGIN
        CASE UPPERCASE(FORMAT(MyFieldRef.TYPE)) OF
          'OPTION', 'INTEGER', 'DECIMAL' : BEGIN
            Dec := MyFieldRef.VALUE;
            IF (Dec = 0) THEN BEGIN
              MyRecRef.CLOSE;
              EXIT;
            END;
          END;
          'TEXT', 'CODE' : BEGIN
            Text1 := MyFieldRef.VALUE;
            IF (Text1 = '') THEN BEGIN
              MyRecRef.CLOSE;
              EXIT;
            END;
          END;
        END;
      END;
      IF ImportSetupLine.Validate THEN BEGIN
        HdrFieldRef.VALIDATE(MyFieldRef.VALUE);
      END ELSE BEGIN
        HdrFieldRef.VALUE(MyFieldRef.VALUE);
      END;
      MyRecRef.CLOSE;
    END;

    LOCAL PROCEDURE GetDimValueFromHdr@7(ImportHdr@1000 : Record 70008;VAR HdrFieldRef@1001 : FieldRef;ImportSetupLine@1002 : Record 70004) FieldValue : Text[20];
    VAR
      MyRecRef@1003 : RecordRef;
      MyFieldRef@1004 : FieldRef;
    BEGIN
      MyRecRef.GETTABLE(ImportHdr);
      MyFieldRef := MyRecRef.FIELD(ImportSetupLine."Map-to Field No.");
      FieldValue := FORMAT(MyFieldRef.VALUE);
      MyRecRef.CLOSE;
    END;

    LOCAL PROCEDURE GetDimValueFromLine@8(ImportLine@1000 : Record 70009;VAR HdrFieldRef@1001 : FieldRef;ImportSetupLine@1002 : Record 70004) FieldValue : Text[20];
    VAR
      MyRecRef@1004 : RecordRef;
      MyFieldRef@1003 : FieldRef;
    BEGIN
      MyRecRef.GETTABLE(ImportLine);
      MyFieldRef := MyRecRef.FIELD(ImportSetupLine."Map-to Field No.");
      FieldValue := FORMAT(MyFieldRef.VALUE);
      MyRecRef.CLOSE;
    END;

    PROCEDURE GetErrorText@10() : Text[250];
    BEGIN
      EXIT(ErrorText);
    END;

    PROCEDURE UpdateVAT@1000000000(ImportLine@1000000000 : Record 70009;VAR HeaderRecRef@1000000006 : RecordRef;VAR ImportHdr@1101103003 : Record 70008);
    VAR
      PurchaseHeader@1000000007 : Record 38;
      PurchLine@1000000005 : Record 39;
      TempPurchLine@1000000004 : TEMPORARY Record 39;
      TotalPurchLine@1000000009 : Record 39;
      TotalPurchLineLCY@1000000008 : Record 39;
      TempVATAmountLine@1000000012 : TEMPORARY Record 290;
      PurchSetup@1000000002 : Record 312;
      PurchPost@1000000003 : Codeunit 90;
      TotalVATRecieved@1000000001 : Decimal;
      VATAmount@1000000010 : Decimal;
      VATDif@1000000013 : Decimal;
      VATAmountText@1000000011 : Text[30];
      VATDifOneLine@1000000014 : Decimal;
      VATDifTotal@1000000015 : Decimal;
      CompelloSetup@1101103000 : Record 70000;
      PurchLineRounding@1101103001 : Record 39;
    BEGIN
      TotalVATRecieved := ImportLine."VAT Amount";
      //03. 17.02.17 JAL -->
      //The SUM for Item Puchase Invoice is without VAT. SUM for Purchase Invoice in journal is with VAT.
      IF (ImportHdr."Voucher Type" = CompelloSetup."Doc. Type Journal Credit") OR
        (ImportHdr."Voucher Type" = CompelloSetup."Doc. Type Journal Invoice")
        THEN BEGIN
          EXIT;
      END;
      //03. 17.02.17 JAL <--

      HeaderRecRef.SETTABLE(PurchaseHeader);
      CLEAR(PurchPost);
      PurchPost.GetPurchLines(PurchaseHeader,TempPurchLine,0);
      CLEAR(PurchPost);
      PurchPost.SumPurchLinesTemp(
        PurchaseHeader,TempPurchLine,0,TotalPurchLine,TotalPurchLineLCY,VATAmount,VATAmountText);

      PurchLine.CalcVATAmountLines(0,PurchaseHeader,TempPurchLine,TempVATAmountLine);
      TempVATAmountLine.MODIFYALL(Modified,FALSE);

      VATDif := TotalVATRecieved - VATAmount;
      IF VATDif <> 0 THEN BEGIN

        //Insert extra rounding amount. Due to how Compello/Navision handles VAT on Total/Lines
        IF ABS(VATDif) > 1 THEN BEGIN
          ErrorText := STRSUBSTNO(Text004, VATDif);
          ErrorsExist := TRUE;
          EXIT;
        END;
        CompelloSetup.GET;
        CompelloSetup.TESTFIELD("Rounding account");
        CompelloSetup.TESTFIELD("Default Free VAT Code");
        PurchLine.SETRANGE("Document Type",PurchaseHeader."Document Type");
        PurchLine.SETRANGE("Document No.",PurchaseHeader."No.");
        PurchLine.SETRANGE("Buy-from Vendor No.",PurchaseHeader."Buy-from Vendor No.");
        IF PurchLine.FINDLAST THEN BEGIN
          PurchLineRounding.INIT;
          PurchLineRounding.VALIDATE("Document Type",PurchLine."Document Type");
          PurchLineRounding.VALIDATE("Document No.",PurchLine."Document No.");
          PurchLineRounding."Line No." := PurchLine."Line No." + 10000;
          PurchLineRounding.VALIDATE("Buy-from Vendor No.",PurchLine."Buy-from Vendor No.");
          PurchLineRounding.VALIDATE(Type,PurchLineRounding.Type::"G/L Account");
          PurchLineRounding.VALIDATE("No.",CompelloSetup."Rounding account");
          IF VATDif > 0 THEN
            PurchLineRounding.VALIDATE(Quantity,1)
          ELSE
            PurchLineRounding.VALIDATE(Quantity,-1);
          PurchLineRounding.VALIDATE("Direct Unit Cost",ABS(VATDif));
          PurchLineRounding.VALIDATE("VAT Prod. Posting Group",CompelloSetup."Default Free VAT Code");
          PurchLineRounding.INSERT(TRUE);

          //Do not proceed with rest of VAT differnce code, as total now is correct based on Navision calculation of VAT
          EXIT;
        END;

        PurchSetup.GET;
        PurchSetup.TESTFIELD("Allow VAT Difference");
        IF TempVATAmountLine.FINDSET THEN BEGIN
          REPEAT
            VATDifOneLine := (TempVATAmountLine."VAT Amount" / VATAmount) * VATDif;
            TempVATAmountLine.VALIDATE("VAT Amount", TempVATAmountLine."VAT Amount" + VATDifOneLine);
            IF PurchaseHeader."Prices Including VAT" THEN
              TempVATAmountLine."VAT Base" := TempVATAmountLine."Amount Including VAT" - TempVATAmountLine."VAT Amount"
            ELSE
              TempVATAmountLine."Amount Including VAT" := TempVATAmountLine."VAT Amount" + TempVATAmountLine."VAT Base";
            VATDifTotal += VATDifOneLine;
            TempVATAmountLine.CheckVATDifference(PurchaseHeader."Currency Code",PurchSetup."Allow VAT Difference");//NEW only 2 par.,PurchaseHeader."Prices Including VAT");
            TempVATAmountLine.Modified := TRUE;
            TempVATAmountLine.MODIFY;
          UNTIL TempVATAmountLine.NEXT = 0;

          IF VATDifTotal <> VATDif THEN BEGIN
            TempVATAmountLine.FINDFIRST;
            TempVATAmountLine.VALIDATE("VAT Amount", VATDif - VATDifTotal);
            IF PurchaseHeader."Prices Including VAT" THEN
              TempVATAmountLine."VAT Base" := TempVATAmountLine."Amount Including VAT" - TempVATAmountLine."VAT Amount"
            ELSE
              TempVATAmountLine."Amount Including VAT" := TempVATAmountLine."VAT Amount" + TempVATAmountLine."VAT Base";
            TempVATAmountLine.CheckVATDifference(PurchaseHeader."Currency Code",PurchSetup."Allow VAT Difference"); //NEW only 2 par.,PurchaseHeader."Prices Including VAT");
            TempVATAmountLine.Modified := TRUE;
            TempVATAmountLine.MODIFY;
          END;
        END;

        PurchLine.UpdateVATOnLines(0,PurchaseHeader,PurchLine,TempVATAmountLine);
        PurchLine.UpdateVATOnLines(1,PurchaseHeader,PurchLine,TempVATAmountLine);
      END;
    END;

    PROCEDURE CreatePurchDoc@1101103002(VAR Rec@1101103002 : Record 70008);
    VAR
      Text002@1101103001 : TextConst 'ENU=Do you want to create Purchase Invoice document?;NOR=Vil du opprette Innkj›psfaktura?';
      Text003@1101103000 : TextConst 'ENU=Document created;NOR=Dokument opprettet';
    BEGIN
      IF CONFIRM(Text002, TRUE) THEN BEGIN
        IF CreatePurchaseHeader(Rec) THEN
          MESSAGE(Text003)
        ELSE
          MESSAGE(GetErrorText);
      END;
    END;

    LOCAL PROCEDURE CheckCurrency@1101103003(VAR PurchaseHeader@1101103002 : Record 38;VAR PurchaseRcptLine@1101103000 : Record 121) RetValue : Boolean;
    VAR
      PurchaseRcptHeader@1101103001 : Record 120;
    BEGIN
      RetValue := TRUE;
      IF PurchaseRcptHeader.GET(PurchaseRcptLine."Document No.") THEN BEGIN
        IF PurchaseRcptHeader."Currency Code" <> PurchaseHeader."Currency Code" THEN BEGIN
         ErrorText := STRSUBSTNO(
            Text005,
            PurchaseHeader.FIELDCAPTION("Currency Code"),
            PurchaseHeader.TABLECAPTION,PurchaseHeader."No.",
            PurchaseRcptHeader.TABLECAPTION,PurchaseRcptHeader."No.");
            RetValue := FALSE;
          ERROR(ErrorText);
        END;
      END;
      EXIT(RetValue);
    END;

    BEGIN
    {
      +---------------------------------------------+
      | SI-Data                                     |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 24.04.15 JAL Handle creation of journal lines
                       First create Purchase Invoice with "No." = 1
                       then create journal lines from the Purhcae Invoice
                       Delete the Purchase Invoice after the lines have been created.

      02. 04.12.16 GST Functions changed to use less parameteres in 2017
      03. 17.02.17 JAL Fix on "Unit Price" and Discount
                       Add VAT calculation for 0 VAT header line for Item Puchase Invoice.
    }
    END.
  }
}

OBJECT Codeunit 70004 NAS - Integr. With Compello
{
  OBJECT-PROPERTIES
  {
    Date=01.10.16;
    Time=11:00:00;
    Modified=Yes;
    Version List=CMP1.00;
  }
  PROPERTIES
  {
    TableNo=472;
    OnRun=BEGIN
            IF "Parameter String" = 'Export' THEN BEGIN
              SendData;
              COMMIT;
            END
            ELSE IF "Parameter String" = 'Import' THEN BEGIN
              DownloadData;
              COMMIT;
              StoreData;
            END
            ELSE IF "Parameter String" = 'Clean Log' THEN BEGIN
                CleanLog;
            END
            ELSE BEGIN
              SendData;
              COMMIT;
              DownloadData;
              COMMIT;
              StoreData;
            END;
          END;

  }
  CODE
  {
    VAR
      Text001@1000 : TextConst 'ENU=Document with Archive reference %1 already exists as created';
      Text002@1001 : TextConst 'ENU=Error when creating document.;NOR=Feil ved † opprette dokument.';
      Text003@1002 : TextConst 'ENU=In progress';
      Text004@1003 : TextConst 'ENU=Error when creating document. Check Job Queue log for more information';
      Text005@1004 : TextConst 'ENU=Error when running Job Que for integration with Compello';

    PROCEDURE SendData@1();
    VAR
      IntegrLogEntry@1000 : Record 70001;
      ExportMgt@1001 : Codeunit 70001;
    BEGIN
      IF IntegrLogEntry.FINDFIRST THEN BEGIN
        ExportMgt.SyncMultipleRecords(IntegrLogEntry, TRUE);
      END;
    END;

    PROCEDURE DownloadData@2();
    VAR
      ImportMgt@1000 : Codeunit 70002;
    BEGIN
      ImportMgt.LoadDocuments;
    END;

    PROCEDURE StoreData@3();
    VAR
      ImportHdr@1000 : Record 70008;
      ImportHdrArchive@1002 : Record 70011;
      CreateDocMgt@1001 : Codeunit 70003;
      FoundErrors@1003 : Boolean;
    BEGIN
      IF NOT ImportHdr.FINDSET THEN BEGIN
        EXIT;
      END;

      REPEAT
        ImportHdr.Status := ImportHdr.Status::"In Progress";
        ImportHdr."Status Text" := Text003;
        ImportHdr.MODIFY;
        COMMIT;

        //Process document creation
        CLEARLASTERROR;
        // Catch error
        IF NOT CreateDocMgt.RUN(ImportHdr) THEN BEGIN
          ImportHdr."Status Text" := CreateDocMgt.GetErrorText + '. ' + GETLASTERRORTEXT;
          IF ImportHdr."Status Text" <> '' THEN BEGIN
            ImportHdr.Status := ImportHdr.Status::Error;
            ImportHdr.MODIFY;
            FoundErrors := TRUE;
          END ELSE BEGIN
            ImportHdr.Status := ImportHdr.Status::Error;
            ImportHdr."Status Text" := Text002;
            ImportHdr.MODIFY;
          END;
        END;
        // Catch handled error;
        IF (CreateDocMgt.GetErrorText <> '') THEN BEGIN
          ImportHdr."Status Text" := CreateDocMgt.GetErrorText;
          ImportHdr.Status := ImportHdr.Status::Error;
          ImportHdr.MODIFY;
          FoundErrors := TRUE;
        END;
        COMMIT;
      UNTIL ImportHdr.NEXT = 0;

      IF FoundErrors THEN BEGIN
        AddNotificationsFromRec;
      END;
    END;

    LOCAL PROCEDURE AddNotificationsFromRec@8();
    VAR
      IntegrTable@1003 : Record 70003;
      UserNotification@1002 : Record 70007;
    BEGIN
      IntegrTable.SETRANGE("Data Type", 101);
      IntegrTable.SETRANGE("Action IO", IntegrTable."Action IO"::Import);
      IF NOT IntegrTable.FINDFIRST THEN BEGIN
        EXIT;
      END;

      UserNotification.SETRANGE("Table Code", IntegrTable.Code);
      IF NOT UserNotification.FINDSET THEN BEGIN
        EXIT;
      END;

      REPEAT
        IF UserNotification."User ID" <> '' THEN BEGIN
          AddNotification(Text005, UserNotification."User ID");
        END;
      UNTIL UserNotification.NEXT = 0;
    END;

    LOCAL PROCEDURE AddNotification@6(MyText@1005 : Text[250];NotifyUser@1006 : Code[50]);
    VAR
      RecordLink@1000 : Record 2000000068;
      IntegrSetup@1007 : Record 70000;
      ListPage@1004 : Page 70001;
      MyOutStream@1002 : OutStream;
      MyChar@1003 : Char;
    BEGIN
      IntegrSetup.GET;

      RecordLink.INIT;
      RecordLink.Type := RecordLink.Type::Note;
      RecordLink.Description := ListPage.CAPTION;
      RecordLink.Created := CURRENTDATETIME;
      RecordLink."User ID" := USERID;
      RecordLink.Company := COMPANYNAME;
      RecordLink.Notify := TRUE;
      RecordLink."To User ID" := NotifyUser;
      RecordLink.Note.CREATEOUTSTREAM(MyOutStream);
      MyChar := STRLEN(MyText);
      MyOutStream.WRITETEXT := FORMAT(MyChar) + MyText;
      RecordLink.INSERT;
    END;

    LOCAL PROCEDURE CleanLog@1101103000();
    VAR
      ExportMgt@1101103000 : Codeunit 70001;
    BEGIN
      ExportMgt.CleanExportLog;
    END;

    BEGIN
    {
      +---------------------------------------------+
      | SI-Data                                     |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 24.04.15 JAL Removed check for duplicates
    }
    END.
  }
}

OBJECT Codeunit 70005 Compello Management
{
  OBJECT-PROPERTIES
  {
    Date=13.01.17;
    Time=11:03:09;
    Modified=Yes;
    Version List=CMP2.00;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      CompelloSetup@1101103000 : Record 70000;
      NextDocNo@1101103001 : Code[20];
      NextLineNo@1101103002 : Integer;
      HasGotGLSetup@1101103003 : Boolean;
      GLSetupShortcutDimCode@1101103004 : ARRAY [8] OF Code[20];
      DimensionUpdatedTxt@1101103005 : TextConst 'ENU=All referances to dimension numbers have been updated based on Financial Setup for Dimensions.;NOR=Alle referanser til dimensjon tallene har blitt oppdatert basert p† Finansoppsett for Dimensjoner.';

    PROCEDURE CreateGenJnlLine@5(VAR ImportHdr@1101103005 : Record 70008;VAR HeaderRecRef@1101103000 : RecordRef;VAR POHeaderAmount@1101103003 : Decimal);
    VAR
      PurchaseHeader@1101103002 : Record 38;
      PurchaseLine@1101103001 : Record 39;
      GenJnlLine@1101103006 : Record 81;
      LastGenJnlLine@1101103009 : Record 81;
    BEGIN
      CompelloSetup.GET;

      IF CheckVoucherType(ImportHdr) THEN BEGIN
        CompelloSetup.TESTFIELD("Journal Template");
        CompelloSetup.TESTFIELD("Journal Batch");

        NextDocNo := '';
        NextLineNo := 0;

        IF PurchaseHeader.GET(HeaderRecRef.RECORDID) THEN BEGIN
          GenJnlLineSetLineNo(GenJnlLine);

          CreateGenJnlLinePurchHeader(PurchaseHeader, GenJnlLine, POHeaderAmount);

          LastGenJnlLine := GenJnlLine;

          PurchaseLine.SETRANGE("Document Type", PurchaseHeader."Document Type");
          PurchaseLine.SETRANGE("Document No.", PurchaseHeader."No.");
          PurchaseLine.SETRANGE(Type, PurchaseLine.Type::"G/L Account");
          PurchaseLine.SETFILTER("Line Amount", '<>0');
          IF PurchaseLine.FINDFIRST THEN BEGIN
            REPEAT
              NextLineNo := NextLineNo + 10000;
              CreateGenJnlLinePurchLine(PurchaseHeader, PurchaseLine, GenJnlLine, LastGenJnlLine);
            UNTIL PurchaseLine.NEXT = 0;
          END;
        END;

        PurchaseHeader.DELETE(TRUE);
      END;
    END;

    LOCAL PROCEDURE CreateGenJnlLinePurchHeader@1101103004(VAR PurchaseHeader@1101103000 : Record 38;VAR GenJnlLine@1101103002 : Record 81;VAR POHeaderAmount@1101103003 : Decimal);
    VAR
      DimensionMgt@1101103004 : Codeunit 408;
      AmountLCY@1101103001 : Decimal;
    BEGIN
      //Create Vendor line
      GenJnlLine.INIT;
      GenJnlLine.VALIDATE(GenJnlLine."Journal Template Name",CompelloSetup."Journal Template");
      GenJnlLine.VALIDATE(GenJnlLine."Journal Batch Name",CompelloSetup."Journal Batch");
      GenJnlLine.VALIDATE(GenJnlLine."Line No.", NextLineNo);
      GenJnlLine.VALIDATE(GenJnlLine."Document No.", NextDocNo);
      IF PurchaseHeader."Posting Date" <> 0D THEN
        GenJnlLine.VALIDATE(GenJnlLine."Posting Date", PurchaseHeader."Posting Date");

      GenJnlLine.VALIDATE(GenJnlLine."Document Date", PurchaseHeader."Document Date");
      GenJnlLine.VALIDATE(GenJnlLine."Account Type", GenJnlLine."Account Type"::Vendor);
      GenJnlLine.VALIDATE(GenJnlLine."Account No.", PurchaseHeader."Pay-to Vendor No.");
      GenJnlLine.VALIDATE(GenJnlLine."Currency Code", PurchaseHeader."Currency Code");
      GenJnlLine.VALIDATE(KID, PurchaseHeader.KID);
      CalcPurhaseHeaderLCY(PurchaseHeader, AmountLCY);

      IF PurchaseHeader."Document Type" = PurchaseHeader."Document Type"::Invoice THEN BEGIN
        GenJnlLine.VALIDATE(GenJnlLine."Document Type", PurchaseHeader."Document Type"::Invoice);
        GenJnlLine.VALIDATE(GenJnlLine.Amount, -POHeaderAmount);
        GenJnlLine.VALIDATE(GenJnlLine."Sales/Purch. (LCY)", -AmountLCY);
        GenJnlLine.VALIDATE(GenJnlLine."External Document No.", PurchaseHeader."Vendor Invoice No.");
      END ELSE BEGIN
        GenJnlLine.VALIDATE(GenJnlLine."Document Type", PurchaseHeader."Document Type"::"Credit Memo");
        GenJnlLine.VALIDATE(GenJnlLine.Amount, POHeaderAmount);
        GenJnlLine.VALIDATE(GenJnlLine."Sales/Purch. (LCY)", AmountLCY);
        GenJnlLine.VALIDATE(GenJnlLine."External Document No.", PurchaseHeader."Vendor Cr. Memo No.");
      END;

      GenJnlLine.VALIDATE(GenJnlLine."Due Date", PurchaseHeader."Due Date");
      DimensionMgt.UpdateGenJnlLineDim(GenJnlLine, PurchaseHeader."Dimension Set ID");
      GenJnlLine.UpdateSource;
      GenJnlLine.INSERT(TRUE);
    END;

    LOCAL PROCEDURE CreateGenJnlLinePurchLine@1101103005(VAR PurchaseHeader@1101103005 : Record 38;VAR PurchaseLine@1101103000 : Record 39;VAR GenJnlLine@1101103003 : Record 81;VAR LastGenJnlLine@1101103004 : Record 81);
    VAR
      GenJnlBatch@1101103006 : Record 232;
      DimensionMgt@1101103002 : Codeunit 408;
    BEGIN
      GenJnlLine.INIT;
      GenJnlLine.VALIDATE(GenJnlLine."Journal Template Name",CompelloSetup."Journal Template");
      GenJnlLine.VALIDATE(GenJnlLine."Journal Batch Name",CompelloSetup."Journal Batch");
      GenJnlLine.VALIDATE(GenJnlLine."Line No.", NextLineNo);
      GenJnlLine.SetUpNewLine(LastGenJnlLine, 0, TRUE);
      GenJnlLine.VALIDATE(GenJnlLine."Account Type", GenJnlLine."Account Type"::"G/L Account");
      GenJnlLine.VALIDATE(GenJnlLine."Account No.", PurchaseLine."No.");
      GenJnlLine.VALIDATE(GenJnlLine."Gen. Posting Type", GenJnlLine."Gen. Posting Type"::" ");
      GenJnlLine.VALIDATE(GenJnlLine."Gen. Bus. Posting Group", '');
      GenJnlLine.VALIDATE(GenJnlLine."Gen. Prod. Posting Group", '');
      GenJnlLine.VALIDATE(GenJnlLine."VAT Bus. Posting Group", '');
      GenJnlLine.VALIDATE(GenJnlLine."VAT Prod. Posting Group", '');
      GenJnlLine.VALIDATE(GenJnlLine."VAT Code", PurchaseLine."VAT Prod. Posting Group");
      GenJnlLine.VALIDATE(GenJnlLine."Currency Code", PurchaseLine."Currency Code");
      GenJnlLine.VALIDATE(KID, PurchaseHeader.KID);

      IF PurchaseLine."Document Type" = PurchaseLine."Document Type"::Invoice THEN BEGIN
        GenJnlLine.VALIDATE(GenJnlLine."Document Type", PurchaseLine."Document Type"::Invoice);
        GenJnlLine.VALIDATE(GenJnlLine.Amount, (PurchaseLine.Quantity * PurchaseLine."Direct Unit Cost"));
        GenJnlLine.VALIDATE(GenJnlLine."External Document No.", PurchaseHeader."Vendor Invoice No.");
      END ELSE BEGIN
         GenJnlLine.VALIDATE(GenJnlLine."Document Type", PurchaseLine."Document Type"::"Credit Memo");
         GenJnlLine.VALIDATE(GenJnlLine.Amount, -(PurchaseLine.Quantity * PurchaseLine."Direct Unit Cost"));
         GenJnlLine.VALIDATE(GenJnlLine."External Document No.", PurchaseHeader."Vendor Cr. Memo No.");
      END;

      GenJnlLine.VALIDATE(Description, PurchaseLine.Description);
      GenJnlLine.VALIDATE(GenJnlLine."Due Date", PurchaseHeader."Due Date");
      DimensionMgt.UpdateGenJnlLineDim(GenJnlLine, PurchaseLine."Dimension Set ID");
      GenJnlLine.UpdateSource;
      GenJnlLine.INSERT(TRUE);
    END;

    LOCAL PROCEDURE GenJnlLineSetLineNo@1101103007(VAR GenJnlLine@1101103000 : Record 81);
    VAR
      LastGenJnlLine@1101103002 : Record 81;
      GenJnlBatch@1101103003 : Record 232;
      NoSeriesMgt@1101103005 : Codeunit 396;
    BEGIN
      GenJnlBatch.GET(CompelloSetup."Journal Template", CompelloSetup."Journal Batch");

      GenJnlLine.SETRANGE("Journal Template Name", CompelloSetup."Journal Template");
      GenJnlLine.SETRANGE("Journal Batch Name", CompelloSetup."Journal Batch");

      IF GenJnlLine.FINDLAST THEN BEGIN
        NextLineNo := GenJnlLine."Line No." + 10000;
        NextDocNo := INCSTR(GenJnlLine."Document No.");
      END
      ELSE BEGIN
        NextLineNo := 10000;
        NextDocNo := NoSeriesMgt.GetNextNo(GenJnlBatch."No. Series", TODAY, FALSE);
      END;
    END;

    PROCEDURE CheckVoucherType@1101103001(ImportHdr@1101103000 : Record 70008) : Boolean;
    BEGIN
      EXIT(IsVoucherType2Journal(ImportHdr."Voucher Type"));
    END;

    PROCEDURE IsVoucherTypeValid@1101103010(VoucherType@1101103000 : Text[30]) : Boolean;
    BEGIN
      CompelloSetup.GET;

      IF (VoucherType IN [CompelloSetup."Doc. Type Journal Invoice",
                          CompelloSetup."Doc. Type Journal Credit",
                          CompelloSetup."Doc. Type Item Invoice",
                          CompelloSetup."Doc. Type Item Credit"]) THEN
        EXIT(TRUE)
      ELSE
        EXIT(FALSE);
    END;

    PROCEDURE IsVoucherType2Journal@1101103002(VoucherType@1101103000 : Text[30]) : Boolean;
    BEGIN
      CompelloSetup.GET;
      IF (VoucherType IN [CompelloSetup."Doc. Type Journal Invoice", CompelloSetup."Doc. Type Journal Credit"]) THEN
        EXIT(TRUE)
      ELSE
        EXIT(FALSE);
    END;

    PROCEDURE IsVoucherTypeInvoice@1101103000(VoucherType@1101103000 : Text[30]) : Boolean;
    BEGIN
      CompelloSetup.GET;
      IF (VoucherType IN [CompelloSetup."Doc. Type Journal Invoice", CompelloSetup."Doc. Type Item Invoice"]) THEN
        EXIT(TRUE)
      ELSE
        EXIT(FALSE);
    END;

    PROCEDURE IsVoucherTypeCreditMemo@1101103003(VoucherType@1101103000 : Text[30]) : Boolean;
    BEGIN
      CompelloSetup.GET;
      IF (VoucherType IN [CompelloSetup."Doc. Type Journal Credit", CompelloSetup."Doc. Type Item Credit"]) THEN
        EXIT(TRUE)
      ELSE
        EXIT(FALSE);
    END;

    PROCEDURE GetDimensionCodeByNumber@1101103008(DimNo@1101103000 : Integer) : Code[20];
    BEGIN
      IF (DimNo < 1) OR (DimNo > 8) THEN EXIT;

      GetGLSetup;

      EXIT(GLSetupShortcutDimCode[DimNo]);
    END;

    LOCAL PROCEDURE GetGLSetup@52();
    VAR
      GLSetup@1000 : Record 98;
    BEGIN
      IF NOT HasGotGLSetup THEN BEGIN
        GLSetup.GET;
        GLSetupShortcutDimCode[1] := GLSetup."Shortcut Dimension 1 Code";
        GLSetupShortcutDimCode[2] := GLSetup."Shortcut Dimension 2 Code";
        GLSetupShortcutDimCode[3] := GLSetup."Shortcut Dimension 3 Code";
        GLSetupShortcutDimCode[4] := GLSetup."Shortcut Dimension 4 Code";
        GLSetupShortcutDimCode[5] := GLSetup."Shortcut Dimension 5 Code";
        GLSetupShortcutDimCode[6] := GLSetup."Shortcut Dimension 6 Code";
        GLSetupShortcutDimCode[7] := GLSetup."Shortcut Dimension 7 Code";
        GLSetupShortcutDimCode[8] := GLSetup."Shortcut Dimension 8 Code";
        HasGotGLSetup := TRUE;
      END;
    END;

    PROCEDURE UpdateDimensionsForSetupTables@1101103006();
    VAR
      CompelloIntegrTable@1101103000 : Record 70003;
      CompelloIntegrTableField@1101103001 : Record 70004;
    BEGIN
      CompelloIntegrTable.SETFILTER("Dimension No.", '>0');
      IF CompelloIntegrTable.FINDSET THEN BEGIN
        REPEAT
          CompelloIntegrTable."Dimension Code" := GetDimensionCodeByNumber(CompelloIntegrTable."Dimension No.");
          CompelloIntegrTable.MODIFY;
        UNTIL CompelloIntegrTable.NEXT = 0;
      END;

      CompelloIntegrTableField.SETFILTER("Dimension No.", '>0');
      IF CompelloIntegrTableField.FINDSET THEN BEGIN
        REPEAT
          CompelloIntegrTableField."Dimension Code" := GetDimensionCodeByNumber(CompelloIntegrTableField."Dimension No.");
          CompelloIntegrTableField.MODIFY;
        UNTIL CompelloIntegrTableField.NEXT = 0;
      END;
      MESSAGE(DimensionUpdatedTxt);
    END;

    PROCEDURE UpdateDimensions@1101103009(VAR CompelloIntegrTable@1101103000 : Record 70003);
    VAR
      CompelloIntegrTableField@1101103001 : Record 70004;
    BEGIN
      IF (CompelloIntegrTable."Dimension No." > 0) AND (CompelloIntegrTable."Dimension No." < 9) THEN BEGIN
        CompelloIntegrTable."Dimension Code" := GetDimensionCodeByNumber(CompelloIntegrTable."Dimension No.");
        CompelloIntegrTable.MODIFY;
      END;

      CompelloIntegrTableField.SETRANGE("Table Code", CompelloIntegrTable.Code);
      CompelloIntegrTableField.SETFILTER("Dimension No.", '>0');
      IF CompelloIntegrTableField.FINDSET THEN BEGIN
        REPEAT
          CompelloIntegrTableField."Dimension Code" := GetDimensionCodeByNumber(CompelloIntegrTableField."Dimension No.");
          CompelloIntegrTableField.MODIFY;
        UNTIL CompelloIntegrTableField.NEXT = 0;
      END;
      MESSAGE(DimensionUpdatedTxt);
    END;

    PROCEDURE GetReceiptFromImportLine@1101103011(VAR ImportLine@1101103000 : Record 70009;VAR PurchaseRcptLine@1101103004 : Record 121) : Boolean;
    VAR
      ReceiptDocNo@1101103003 : Code[20];
      ReceiptLineNo@1101103002 : Integer;
      SplitSympolPos@1101103001 : Integer;
    BEGIN
      // The solution excpect receipt "Document No." to be in "User Defined 8" field.
      // and the receipt "Line No." in "User Defined 15" field.
      // Some company have receipt "Document No." and receipt "Line No." attached with the ù-ù in "User Defined 6" field.

      IF (ImportLine."User Defined 8" <> '') AND (ImportLine."User Defined 15" <> '') THEN BEGIN
        ReceiptDocNo := ImportLine."User Defined 8";
        EVALUATE(ReceiptLineNo, ImportLine."User Defined 15");
      END ELSE IF(ImportLine."User Defined 6" <> '') THEN BEGIN
        SplitSympolPos := GetLastSplitSympolPos(ImportLine."User Defined 6", '-'); //02. 13.01.17 JAL
        ReceiptDocNo := GetReceiptNo(ImportLine."User Defined 6"); //02. 13.01.17 JAL
        EVALUATE(ReceiptLineNo, COPYSTR(ImportLine."User Defined 6", (SplitSympolPos + 1), (STRLEN(ImportLine."User Defined 6") - SplitSympolPos)));
      END;
      IF (ReceiptDocNo <> '') AND (ReceiptLineNo > 0) THEN
        IF PurchaseRcptLine.GET(ReceiptDocNo, ReceiptLineNo) THEN
          EXIT(TRUE);

      EXIT(FALSE)
    END;

    PROCEDURE CheckForReceiptLineInfo@1101103012(VAR ImportLine@1101103000 : Record 70009);
    VAR
      ReceiptDocNo@1101103003 : Code[20];
      ReceiptLineNo@1101103002 : Integer;
      SplitSympolPos@1101103001 : Integer;
    BEGIN
      // The solution excpect receipt "Document No." to be in "User Defined 8" field.
      // and the receipt "Line No." in "User Defined 15" field.
      // Some company have receipt "Document No." and receipt "Line No." attached with the ù-ù in "User Defined 6" field.

      IF ((ImportLine."User Defined 8" = '') OR (ImportLine."User Defined 15" = '')) AND (ImportLine."User Defined 6" <> '') THEN BEGIN
        SplitSympolPos := GetLastSplitSympolPos(ImportLine."User Defined 6", '-'); //02. 13.01.17 JAL
        ReceiptDocNo := GetReceiptNo(ImportLine."User Defined 6"); //02. 13.01.17 JAL
        EVALUATE(ReceiptLineNo, COPYSTR(ImportLine."User Defined 6", (SplitSympolPos + 1), (STRLEN(ImportLine."User Defined 6") - SplitSympolPos)));
        IF (ReceiptDocNo <> '') AND (ReceiptLineNo > 0) THEN BEGIN
          ImportLine."User Defined 8" := ReceiptDocNo;
          ImportLine."User Defined 15" := FORMAT(ReceiptLineNo);
        END;
      END ELSE IF (ImportLine."User Defined 8" <> '') OR (ImportLine."User Defined 15" <> '') THEN BEGIN
        ImportLine."User Defined 8" := '';
        ImportLine."User Defined 15" := '';
      END;
    END;

    LOCAL PROCEDURE CalcPurhaseHeaderLCY@1101103013(VAR PurchaseHeader@1101103004 : Record 38;VAR LCYAmount@1101103000 : Decimal);
    VAR
      TotalPurchLine@1101103001 : Record 39;
      TotalPurchLineLCY@1101103002 : Record 39;
      TempPurchLine@1101103003 : TEMPORARY Record 39;
      PurchPost@1101103005 : Codeunit 90;
      VATAmount@1101103006 : Decimal;
      VATAmountText@1101103007 : Text;
    BEGIN
      CLEAR(TempPurchLine);
      CLEAR(TotalPurchLine);
      CLEAR(TotalPurchLineLCY);
      CLEAR(PurchPost);

      PurchPost.GetPurchLines(PurchaseHeader,TempPurchLine,0);
      CLEAR(PurchPost);
      PurchPost.SumPurchLinesTemp(
        PurchaseHeader,TempPurchLine, 0, TotalPurchLine, TotalPurchLineLCY, VATAmount, VATAmountText);

      LCYAmount := TotalPurchLineLCY.Amount;
    END;

    PROCEDURE UserInAdminRole@1101103014() : Boolean;
    VAR
      AccessControl@1101103001 : Record 2000000053;
      CompelloSetup@1101103000 : Record 70000;
    BEGIN
      CompelloSetup.GET;
      AccessControl.SETRANGE("User Name", USERID);
      AccessControl.SETRANGE("Role ID", CompelloSetup."Admin Role ID");
      IF AccessControl.FINDFIRST THEN
        EXIT(TRUE)
      ELSE
        EXIT(FALSE);
    END;

    LOCAL PROCEDURE GetReceiptNo@1101103021(FieldValueP@1101103000 : Text) : Code[20];
    VAR
      ReceiptNoL@1101103001 : Code[20];
    BEGIN
      ReceiptNoL := '';
      ReceiptNoL := COPYSTR(FieldValueP, 1, (GetLastSplitSympolPos(FieldValueP, '-') - 1));
      EXIT(ReceiptNoL);
    END;

    LOCAL PROCEDURE GetLastSplitSympolPos@1101103015(StringP@1101103000 : Text;SplitSymbolP@1101103001 : Text) : Integer;
    VAR
      SplitSympolPosL@1101103002 : Integer;
      iStrPosL@1101103003 : Integer;
    BEGIN
      SplitSympolPosL := 0;
      IF STRLEN(StringP) < 1 THEN
        EXIT(SplitSympolPosL);
      FOR iStrPosL := STRLEN(StringP) DOWNTO 1 DO BEGIN
        IF COPYSTR(StringP, iStrPosL, 1) = SplitSymbolP THEN BEGIN
          SplitSympolPosL := iStrPosL;
          BREAK;
        END;
      END;
      EXIT(SplitSympolPosL);
    END;

    BEGIN
    {
      +---------------------------------------------+
      | SI-Data                                     |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 24.04.15 JAL Created the object
      02. 13.01.17 JAL Fixed bug when Receipt No. has '-' symbol.
    }
    END.
  }
}

OBJECT Codeunit 70006 Compello Show Document
{
  OBJECT-PROPERTIES
  {
    Date=01.10.16;
    Time=11:00:00;
    Modified=Yes;
    Version List=CMP2.00;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      CompIntSetup@1101103000 : Record 70000;
      NoDocumentMsg@1101103001 : TextConst 'ENU=There is no Compello document for this document number.;NOR=Det finnes ikke et Compello dokument for dette bilagsnummer.';

    PROCEDURE ShowCompelloDocPurchaseHeader@1101103001(VAR PurchaseHeader@1101103003 : Record 38);
    VAR
      ImportHdrArchive@1101103001 : Record 70011;
    BEGIN
      CheckSetup;

      ImportHdrArchive.RESET;
      IF (PurchaseHeader."Document Type" = PurchaseHeader."Document Type"::Invoice) THEN BEGIN
       ImportHdrArchive.SETRANGE("Created Document Type", ImportHdrArchive."Created Document Type"::Invoice);
       ImportHdrArchive.SETRANGE("Invoice No.", PurchaseHeader."Vendor Invoice No.");
      END
      ELSE IF (PurchaseHeader."Document Type" = PurchaseHeader."Document Type"::"Credit Memo") THEN BEGIN
       ImportHdrArchive.SETRANGE("Created Document Type", ImportHdrArchive."Created Document Type"::"Credit Memo");
       ImportHdrArchive.SETRANGE("Invoice No.", PurchaseHeader."Vendor Cr. Memo No.");
      END;

      ImportHdrArchive.SETRANGE("Vendor No.", PurchaseHeader."Buy-from Vendor No.");

      GetImportHdrArcShowDoc(ImportHdrArchive);
    END;

    PROCEDURE ShowCompelloDocPurchaseInvHeader@1101103008(VAR PurchaseInvHeader@1101103003 : Record 122);
    VAR
      ImportHdrArchive@1101103001 : Record 70011;
    BEGIN
      CheckSetup;

      ImportHdrArchive.RESET;
      ImportHdrArchive.SETRANGE("Created Document Type", ImportHdrArchive."Created Document Type"::Invoice);
      ImportHdrArchive.SETRANGE("Vendor No.", PurchaseInvHeader."Buy-from Vendor No.");
      ImportHdrArchive.SETRANGE("Invoice No.", PurchaseInvHeader."Vendor Invoice No.");

      GetImportHdrArcShowDoc(ImportHdrArchive);
    END;

    PROCEDURE ShowCompelloDocPurchaseCrMemoHeader@1101103011(VAR PurchaseCrMemoHeader@1101103003 : Record 124);
    VAR
      ImportHdrArchive@1101103001 : Record 70011;
    BEGIN
      CheckSetup;

      ImportHdrArchive.RESET;
      ImportHdrArchive.SETRANGE("Created Document Type", ImportHdrArchive."Created Document Type"::"Credit Memo");
      ImportHdrArchive.SETRANGE("Vendor No.", PurchaseCrMemoHeader."Buy-from Vendor No.");
      ImportHdrArchive.SETRANGE("Invoice No.", PurchaseCrMemoHeader."Vendor Cr. Memo No.");

      GetImportHdrArcShowDoc(ImportHdrArchive);
    END;

    PROCEDURE CompelloShowDocVendorLedgerEntry@1101103000(VAR VendorLedgerEntry@1101103000 : Record 25);
    VAR
      ImportHdrArchive@1101103002 : Record 70011;
    BEGIN
      CheckSetup;

      ImportHdrArchive.RESET;

      IF (VendorLedgerEntry."Document Type" = VendorLedgerEntry."Document Type"::Invoice) THEN
       ImportHdrArchive.SETRANGE("Created Document Type", ImportHdrArchive."Created Document Type"::Invoice);

      IF (VendorLedgerEntry."Document Type" = VendorLedgerEntry."Document Type"::"Credit Memo") THEN
       ImportHdrArchive.SETRANGE("Created Document Type", ImportHdrArchive."Created Document Type"::"Credit Memo");

      ImportHdrArchive.SETRANGE("Vendor No.", VendorLedgerEntry."Vendor No.");
      ImportHdrArchive.SETRANGE("Invoice No.", VendorLedgerEntry."External Document No.");

      GetImportHdrArcShowDoc(ImportHdrArchive);
    END;

    PROCEDURE ShowCompelloDocGeneralLedgerEntry@1101103005(VAR GeneralLedgerEntry@1101103003 : Record 17);
    VAR
      ImportHdrArchive@1101103001 : Record 70011;
    BEGIN
      CheckSetup;

      ImportHdrArchive.RESET;
      IF GeneralLedgerEntry."Source Type" <> GeneralLedgerEntry."Source Type"::Vendor THEN BEGIN
        MESSAGE(NoDocumentMsg);
        EXIT;
      END;

      IF (GeneralLedgerEntry."Document Type" = GeneralLedgerEntry."Document Type"::Invoice) THEN
       ImportHdrArchive.SETRANGE("Created Document Type", ImportHdrArchive."Created Document Type"::Invoice)
      ELSE IF (GeneralLedgerEntry."Document Type" = GeneralLedgerEntry."Document Type"::"Credit Memo") THEN
       ImportHdrArchive.SETRANGE("Created Document Type", ImportHdrArchive."Created Document Type"::"Credit Memo");

      ImportHdrArchive.SETRANGE("Vendor No.", GeneralLedgerEntry."Source No.");
      ImportHdrArchive.SETRANGE("Invoice No.", GeneralLedgerEntry."External Document No.");

      GetImportHdrArcShowDoc(ImportHdrArchive);
    END;

    PROCEDURE ShowCompelloDocGenJournalLinePurch@1101103006(VAR GenJournalLine@1101103003 : Record 81);
    VAR
      ImportHdrArchive@1101103001 : Record 70011;
      GenJournalLineFindVend@1101103000 : Record 81;
    BEGIN
      CheckSetup;

      ImportHdrArchive.RESET;
      IF GenJournalLine."Account Type" <> GenJournalLine."Account Type"::Vendor THEN BEGIN
        GetGenJournalLineVend(GenJournalLine, GenJournalLineFindVend);
        IF GenJournalLineFindVend.FINDFIRST THEN
          ImportHdrArchive.SETRANGE("Vendor No.", GenJournalLineFindVend."Account No.")
        ELSE BEGIN
          MESSAGE(NoDocumentMsg);
          EXIT;
        END;
      END ELSE
        ImportHdrArchive.SETRANGE("Vendor No.", GenJournalLine."Account No.");

      IF (GenJournalLine."Document Type" = GenJournalLine."Document Type"::Invoice) THEN
       ImportHdrArchive.SETRANGE("Created Document Type", ImportHdrArchive."Created Document Type"::Invoice);

      IF (GenJournalLine."Document Type" = GenJournalLine."Document Type"::"Credit Memo") THEN
       ImportHdrArchive.SETRANGE("Created Document Type", ImportHdrArchive."Created Document Type"::"Credit Memo");

      ImportHdrArchive.SETRANGE("Invoice No.", GenJournalLine."External Document No.");

      GetImportHdrArcShowDoc(ImportHdrArchive);
    END;

    PROCEDURE ShowCompelloDocGenJournalLinePaym@1101103007(VAR GenJournalLine@1101103003 : Record 81);
    VAR
      ImportHdrArchive@1101103001 : Record 70011;
    BEGIN
      CheckSetup;

      ImportHdrArchive.RESET;
      IF GenJournalLine."Account Type" <> GenJournalLine."Account Type"::Vendor THEN BEGIN
        MESSAGE(NoDocumentMsg);
        EXIT;
      END;

      IF (GenJournalLine."Applies-to Doc. Type" = GenJournalLine."Applies-to Doc. Type"::Invoice) THEN
       ImportHdrArchive.SETRANGE("Created Document Type", ImportHdrArchive."Created Document Type"::Invoice);

      IF (GenJournalLine."Applies-to Doc. Type" = GenJournalLine."Applies-to Doc. Type"::"Credit Memo") THEN
       ImportHdrArchive.SETRANGE("Created Document Type", ImportHdrArchive."Created Document Type"::"Credit Memo");

      ImportHdrArchive.SETRANGE("Vendor No.", GenJournalLine."Account No.");
      IF GenJournalLine."External Document No." <> '' THEN
        ImportHdrArchive.SETRANGE("Invoice No.", GenJournalLine."External Document No.");

      IF GenJournalLine."Applies-to Ext. Doc. No." <> '' THEN
        ImportHdrArchive.SETRANGE("Invoice No.", GenJournalLine."Applies-to Ext. Doc. No.");

      GetImportHdrArcShowDoc(ImportHdrArchive);
    END;

    LOCAL PROCEDURE ShowCompelloDocument@1101103003(VAR ImportHdrArchive@1101103000 : Record 70011);
    BEGIN
      IF ImportHdrArchive."Image GUID" <> '' THEN
        HYPERLINK(CompIntSetup."Web Service Address" +
                  '/InvoiceViewer.aspx?cci=' +
                  CompIntSetup."Customer ID" +
                  '&img='+ImportHdrArchive."Image GUID")
      ELSE
        HYPERLINK(CompIntSetup."Web Service Address" +
                  '/InvoiceViewer.aspx?cci=' + CompIntSetup."Customer ID" +
                  '&clientId=' + CompIntSetup."Client ID" +
                  '&archiveno=' + ImportHdrArchive."Archive Ref");
    END;

    LOCAL PROCEDURE CheckSetup@1101103002();
    BEGIN
      CompIntSetup.GET;
      CompIntSetup.TESTFIELD("Customer ID");
      CompIntSetup.TESTFIELD("Web Service Address");
    END;

    LOCAL PROCEDURE GetImportHdrArcShowDoc@1101103004(VAR ImportHdrArchive@1101103000 : Record 70011);
    BEGIN
      IF NOT ImportHdrArchive.FINDFIRST THEN BEGIN
        MESSAGE(NoDocumentMsg);
        EXIT;
      END;

      ShowCompelloDocument(ImportHdrArchive);
    END;

    LOCAL PROCEDURE GetGenJournalLineVend@1101103009(GenJournalLine@1101103000 : Record 81;VAR GenJournalLineFindVend@1101103001 : Record 81);
    BEGIN
      GenJournalLineFindVend.RESET;
      GenJournalLineFindVend.SETRANGE("Journal Template Name", GenJournalLine."Journal Template Name");
      GenJournalLineFindVend.SETRANGE("Journal Batch Name", GenJournalLine."Journal Batch Name");
      GenJournalLineFindVend.SETRANGE("Document Type", GenJournalLine."Document Type");
      GenJournalLineFindVend.SETRANGE("Document No.", GenJournalLine."Document No.");
      GenJournalLineFindVend.SETRANGE("Account Type", GenJournalLine."Account Type"::Vendor);
      GenJournalLineFindVend.SETRANGE("External Document No.", GenJournalLine."External Document No.");
    END;

    BEGIN
    {
      +---------------------------------------------+
      | SI-Data                                     |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 24.04.15 JAL Created the object
    }
    END.
  }
}

OBJECT Codeunit 70007 Compello move Document Link
{
  OBJECT-PROPERTIES
  {
    Date=03.05.17;
    Time=15:06:38;
    Modified=Yes;
    Version List=CMP2.00;
  }
  PROPERTIES
  {
    OnRun=BEGIN
            //CheckVendorLedgerKID();
          END;

  }
  CODE
  {
    VAR
      CompIntSetup@1101103000 : Record 70000;
      NoDocumentMsg@1101103001 : TextConst 'ENU=There is no Compello document for this document number.;NOR=Det finnes ikke et Compello dokument for dette bilagsnummer.';

    PROCEDURE CopyFromGenLedgerEntry@1101103027();
    VAR
      GeneralLedgerEntry@1101103000 : Record 17;
    BEGIN
      // GeneralLedgerEntry.SETFILTER("Compello Archive No",'<>%1','');
      // IF GeneralLedgerEntry.FINDSET THEN BEGIN
      //  REPEAT
      //    UpdImportHeaderFromDocGeneralLedgerEntry(GeneralLedgerEntry);
      //  UNTIL GeneralLedgerEntry.NEXT = 0;
      // END;
    END;

    PROCEDURE CopyFromVendorLedgerEntry@1101103004();
    VAR
      VendorLedgerEntry@1101103000 : Record 25;
    BEGIN
      // VendorLedgerEntry.SETFILTER("Compello Archive No",'<>%1','');
      // IF VendorLedgerEntry.FINDSET THEN BEGIN
      //  REPEAT
      //    UpdImportHeaderFromDocVendorLedgerEntry(VendorLedgerEntry);
      //  UNTIL VendorLedgerEntry.NEXT = 0;
      // END;
    END;

    PROCEDURE CopyFromPurchaseHeader@1101103006();
    VAR
      PurchaseHeader@1101103000 : Record 38;
    BEGIN
      // PurchaseHeader.SETFILTER("Compello Archive No",'<>%1','');
      // IF PurchaseHeader.FINDSET THEN BEGIN
      //  REPEAT
      //    UpdImportHeaderFromDocPurchaseHeader(PurchaseHeader);
      //  UNTIL PurchaseHeader.NEXT = 0;
      // END;
    END;

    PROCEDURE CopyFromPurchaseInvHeader@1101103009();
    VAR
      PurchaseInvHeader@1101103000 : Record 122;
    BEGIN
      // PurchaseInvHeader.SETFILTER("Compello Archive No",'<>%1','');
      // IF PurchaseInvHeader.FINDSET THEN BEGIN
      //  REPEAT
      //    UpdImportHeaderFromDocPurchaseInvHeader(PurchaseInvHeader);
      //  UNTIL PurchaseInvHeader.NEXT = 0;
      // END;
    END;

    PROCEDURE CopyFromPurchaseCrMemoHeader@1101103016();
    VAR
      PurchaseCrMemoHeader@1101103000 : Record 124;
    BEGIN
      // PurchaseCrMemoHeader.SETFILTER("Compello Archive No",'<>%1','');
      // IF PurchaseCrMemoHeader.FINDSET THEN BEGIN
      //  REPEAT
      //    UpdImportHeaderFromDocPurchaseCrMemoHeader(PurchaseCrMemoHeader);
      //  UNTIL PurchaseCrMemoHeader.NEXT = 0;
      // END;
    END;

    PROCEDURE UpdImportHeaderFromDocPurchaseHeader@1101103001(VAR PurchaseHeader@1101103003 : Record 38);
    VAR
      ImportHdrArchive@1101103001 : Record 70011;
    BEGIN
      // CLEAR(ImportHdrArchive);
      //
      // IF NOT GetImportHeader(ImportHdrArchive, PurchaseHeader."Compello Archive No") THEN
      //  ImportHdrArchive.INIT;
      //
      // IF (PurchaseHeader."Document Type" = PurchaseHeader."Document Type"::Invoice) THEN BEGIN
      // ImportHdrArchive.VALIDATE("Created Document Type", ImportHdrArchive."Created Document Type"::Invoice);
      // ImportHdrArchive.VALIDATE("Invoice No.", PurchaseHeader."Vendor Invoice No.");
      // END
      // ELSE IF (PurchaseHeader."Document Type" = PurchaseHeader."Document Type"::"Credit Memo") THEN BEGIN
      // ImportHdrArchive.VALIDATE("Created Document Type", ImportHdrArchive."Created Document Type"::"Credit Memo");
      // ImportHdrArchive.VALIDATE("Invoice No.", PurchaseHeader."Vendor Cr. Memo No.");
      // END;
      //
      // ImportHdrArchive.VALIDATE("Vendor No.", PurchaseHeader."Buy-from Vendor No.");
      // ImportHdrArchive.VALIDATE("Archive Ref", PurchaseHeader."Compello Archive No");
      // ImportHdrArchive.VALIDATE("Order Ref", PurchaseHeader."Compello PO No");
      // ImportHdrArchive.VALIDATE(KID, PurchaseHeader.KID);
      // ImportHdrArchive.VALIDATE("Voucher Date", PurchaseHeader."Document Date");
      //
      // InsertUpdateImportHeader(ImportHdrArchive);
    END;

    PROCEDURE UpdImportHeaderFromDocPurchaseInvHeader@1101103008(VAR PurchaseInvHeader@1101103003 : Record 122);
    VAR
      ImportHdrArchive@1101103001 : Record 70011;
    BEGIN
      // CLEAR(ImportHdrArchive);
      //
      // IF NOT GetImportHeader(ImportHdrArchive, PurchaseInvHeader."Compello Archive No") THEN
      //  ImportHdrArchive.INIT;
      //
      // ImportHdrArchive.VALIDATE("Created Document Type", ImportHdrArchive."Created Document Type"::Invoice);
      // ImportHdrArchive.VALIDATE("Vendor No.", PurchaseInvHeader."Buy-from Vendor No.");
      // ImportHdrArchive.VALIDATE("Invoice No.", PurchaseInvHeader."Vendor Invoice No.");
      //
      // ImportHdrArchive.VALIDATE("Archive Ref", PurchaseInvHeader."Compello Archive No");
      // ImportHdrArchive.VALIDATE("Order Ref", PurchaseInvHeader."Order No.");
      // ImportHdrArchive.VALIDATE(KID, PurchaseInvHeader.KID);
      // ImportHdrArchive.VALIDATE("Voucher Date", PurchaseInvHeader."Document Date");
      //
      // InsertUpdateImportHeader(ImportHdrArchive);
    END;

    PROCEDURE UpdImportHeaderFromDocPurchaseCrMemoHeader@1101103011(VAR PurchaseCrMemoHeader@1101103003 : Record 124);
    VAR
      ImportHdrArchive@1101103001 : Record 70011;
    BEGIN
      // CLEAR(ImportHdrArchive);
      //
      // IF NOT GetImportHeader(ImportHdrArchive, PurchaseCrMemoHeader."Compello Archive No") THEN
      //  ImportHdrArchive.INIT;
      //
      // ImportHdrArchive.VALIDATE("Created Document Type", ImportHdrArchive."Created Document Type"::"Credit Memo");
      // ImportHdrArchive.VALIDATE("Vendor No.", PurchaseCrMemoHeader."Buy-from Vendor No.");
      // ImportHdrArchive.VALIDATE("Invoice No.", PurchaseCrMemoHeader."Vendor Cr. Memo No.");
      //
      // ImportHdrArchive.VALIDATE("Archive Ref", PurchaseCrMemoHeader."Compello Archive No");
      // //ImportHdrArchive."Order Ref" := PurchaseCrMemoHeader."Order No.";
      // //ImportHdrArchive.KID := PurchaseCrMemoHeader.KID;
      // ImportHdrArchive.VALIDATE("Voucher Date", PurchaseCrMemoHeader."Document Date");
      //
      //
      // InsertUpdateImportHeader(ImportHdrArchive);
    END;

    PROCEDURE UpdImportHeaderFromDocVendorLedgerEntry@1101103000(VAR VendorLedgerEntry@1101103000 : Record 25);
    VAR
      ImportHdrArchive@1101103002 : Record 70011;
    BEGIN
      // CLEAR(ImportHdrArchive);
      //
      // IF NOT GetImportHeader(ImportHdrArchive, VendorLedgerEntry."Compello Archive No") THEN
      //  ImportHdrArchive.INIT;
      //
      // IF (VendorLedgerEntry."Document Type" = VendorLedgerEntry."Document Type"::Invoice) THEN
      // ImportHdrArchive.VALIDATE("Created Document Type", ImportHdrArchive."Created Document Type"::Invoice);
      //
      // IF (VendorLedgerEntry."Document Type" = VendorLedgerEntry."Document Type"::"Credit Memo") THEN
      // ImportHdrArchive.VALIDATE("Created Document Type", ImportHdrArchive."Created Document Type"::"Credit Memo");
      //
      // ImportHdrArchive.VALIDATE("Vendor No.", VendorLedgerEntry."Vendor No.");
      // ImportHdrArchive.VALIDATE("Invoice No.", VendorLedgerEntry."External Document No.");
      // ImportHdrArchive.VALIDATE("Vendor No.", VendorLedgerEntry."Buy-from Vendor No.");
      // ImportHdrArchive.VALIDATE("Archive Ref", VendorLedgerEntry."Compello Archive No");
      // ImportHdrArchive.VALIDATE(KID, VendorLedgerEntry.KID);
      // ImportHdrArchive.VALIDATE("Voucher Date", VendorLedgerEntry."Document Date");
      //
      // InsertUpdateImportHeader(ImportHdrArchive);
    END;

    PROCEDURE UpdImportHeaderFromDocGeneralLedgerEntry@1101103005(VAR GeneralLedgerEntry@1101103003 : Record 17);
    VAR
      ImportHdrArchive@1101103001 : Record 70011;
    BEGIN
      // CLEAR(ImportHdrArchive);
      //
      // IF GeneralLedgerEntry."Source Type" <> GeneralLedgerEntry."Source Type"::Vendor THEN BEGIN
      //  EXIT;
      // END;
      //
      // IF NOT GetImportHeader(ImportHdrArchive, GeneralLedgerEntry."Compello Archive No") THEN
      //  ImportHdrArchive.INIT;
      //
      // IF (GeneralLedgerEntry."Document Type" = GeneralLedgerEntry."Document Type"::Invoice) THEN
      // ImportHdrArchive.VALIDATE("Created Document Type", ImportHdrArchive."Created Document Type"::Invoice)
      // ELSE IF (GeneralLedgerEntry."Document Type" = GeneralLedgerEntry."Document Type"::"Credit Memo") THEN
      // ImportHdrArchive.VALIDATE("Created Document Type", ImportHdrArchive."Created Document Type"::"Credit Memo");
      //
      // ImportHdrArchive.VALIDATE("Vendor No.", GeneralLedgerEntry."Source No.");
      // ImportHdrArchive.VALIDATE("Invoice No.", GeneralLedgerEntry."External Document No.");
      // ImportHdrArchive.VALIDATE("Archive Ref", GeneralLedgerEntry."Compello Archive No");
      // ImportHdrArchive.VALIDATE("Voucher Date", GeneralLedgerEntry."Document Date");
      //
      // InsertUpdateImportHeader(ImportHdrArchive);
    END;

    LOCAL PROCEDURE GetImportHeader@1101103020(VAR ImportHdrArchive@1101103000 : Record 70011;CompelloArchiveNo@1101103001 : Text[30]) : Boolean;
    VAR
      ImportHdrArchiveFind@1101103003 : Record 70011;
    BEGIN
      CheckSetup;

      ImportHdrArchiveFind.SETRANGE("Archive Ref", CompelloArchiveNo);
      IF ImportHdrArchiveFind.FINDFIRST THEN BEGIN
        ImportHdrArchive.GET(ImportHdrArchiveFind.GUID);
        EXIT(TRUE);
      END
      ELSE BEGIN
        ImportHdrArchive.INIT;
        ImportHdrArchive.GUID := CREATEGUID;
        EXIT(FALSE);
      END;
    END;

    LOCAL PROCEDURE InsertUpdateImportHeader@1101103003(VAR ImportHdrArchive@1101103000 : Record 70011);
    BEGIN
      CheckSetup;

      ImportHdrArchive."Client ID" := CompIntSetup."Client ID";
      ImportHdrArchive."Last Action Date" := CURRENTDATETIME;
      ImportHdrArchive."User Defined 1" := 'Upgrade process';

      IF NOT ImportHdrArchive.MODIFY THEN
        ImportHdrArchive.INSERT;
    END;

    LOCAL PROCEDURE CheckSetup@1101103002();
    BEGIN
      CompIntSetup.GET;
      CompIntSetup.TESTFIELD("Customer ID");
      CompIntSetup.TESTFIELD("Web Service Address");
    END;

    PROCEDURE RemoveDuplicates@1101103007();
    VAR
      ImportHdrArchive@1101103001 : Record 70011;
      ImportHdrArchiveDel@1101103000 : Record 70011;
      UseConfirm@1101103003 : Boolean;
    BEGIN
      CheckSetup;

      UseConfirm := FALSE;

      ImportHdrArchive.SETRANGE("User Defined 1", 'Upgrade process');

      IF ImportHdrArchive.FINDSET THEN
      REPEAT
        ImportHdrArchiveDel.SETRANGE("Client ID", ImportHdrArchive."Client ID");
        ImportHdrArchiveDel.SETRANGE(Supplier, ImportHdrArchive.Supplier);
        ImportHdrArchiveDel.SETRANGE("Archive Ref", ImportHdrArchive."Archive Ref");
        ImportHdrArchiveDel.SETRANGE("Voucher Type", ImportHdrArchive."Voucher Type");
        ImportHdrArchiveDel.SETRANGE("Invoice No.", ImportHdrArchive."Invoice No.");
        ImportHdrArchiveDel.SETRANGE("Voucher Date", ImportHdrArchive."Voucher Date");
        IF ImportHdrArchiveDel.COUNT > 1 THEN BEGIN
          ImportHdrArchiveDel.FINDFIRST;
          ImportHdrArchiveDel.NEXT;
          IF UseConfirm THEN BEGIN
            IF DIALOG.CONFIRM('Do you want to delete this post %1', TRUE, ImportHdrArchiveDel."Archive Ref") THEN BEGIN
              REPEAT
                ImportHdrArchiveDel.DELETE;
              UNTIL ImportHdrArchiveDel.NEXT = 0;
            END ELSE
              EXIT;
          END ELSE
            ImportHdrArchiveDel.DELETE;
        END;

      UNTIL ImportHdrArchive.NEXT = 0;
    END;

    PROCEDURE CheckVendorLedgerKID@1000000001();
    VAR
      VendorLedgerEntryL@1000000000 : Record 25;
      VendorLedgerEntryTempL@1000000001 : TEMPORARY Record 25;
      PageManagementL@1000000002 : Codeunit 700;
    BEGIN
      VendorLedgerEntryL.RESET;
      VendorLedgerEntryL.SETFILTER(KID, '<>%1', '');
      //MESSAGE('%1', VendorLedgerEntryL.COUNT);
      IF VendorLedgerEntryL.FINDFIRST  THEN
        REPEAT
          IF NOT CheckKID(VendorLedgerEntryL) THEN BEGIN
            VendorLedgerEntryTempL.TRANSFERFIELDS(VendorLedgerEntryL, TRUE);
            VendorLedgerEntryTempL.INSERT;
          END;
        UNTIL VendorLedgerEntryL.NEXT = 0;
      PageManagementL.PageRun(VendorLedgerEntryTempL);
    END;

    [TryFunction]
    LOCAL PROCEDURE CheckKID@1000000004(VAR VendorLedgerEntryP@1000000000 : Record 25);
    BEGIN
      VendorLedgerEntryP.VALIDATE(KID, VendorLedgerEntryP.KID);
    END;

    BEGIN
    {
      +---------------------------------------------+
      | SI-Data                                     |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 24.04.15 JAL Created the object
    }
    END.
  }
}

OBJECT Codeunit 70008 Compello NAS Handler
{
  OBJECT-PROPERTIES
  {
    Date=01.10.16;
    Time=11:00:00;
    Modified=Yes;
    Version List=CMP2.00;
  }
  PROPERTIES
  {
    TableNo=472;
    OnRun=VAR
            CompelloNASIntegr@1101103000 : Codeunit 70004;
          BEGIN
            CLEARLASTERROR;

            IF NOT CompelloNASIntegr.RUN(Rec) THEN
              MESSAGE(GETLASTERRORTEXT);
          END;

  }
  CODE
  {

    BEGIN
    {
      +---------------------------------------------+
      | SI-Data                                     |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 24.04.15 JAL Created the object
    }
    END.
  }
}

OBJECT XMLport 70000 Import Map-To Fields
{
  OBJECT-PROPERTIES
  {
    Date=01.10.16;
    Time=11:00:00;
    Modified=Yes;
    Version List=CMP2.00;
  }
  PROPERTIES
  {
    CaptionML=ENU=Import Map-To Fields;
    Direction=Both;
    OnPostXMLport=BEGIN
                    MESSAGE(Text001);
                  END;

  }
  ELEMENTS
  {
    { [{71AA39D5-6AA0-4C76-AC47-8462D18DB499}];0 ;ImportMapping       ;Element ;Text     }

    { [{8131488B-6547-4E17-8FA4-9633EA69D9EF}];1 ;MapToFields         ;Element ;Text     }

    { [{076A58CD-28CB-4872-B29F-6AEE4A5B2928}];2 ;MapToField          ;Element ;Table   ;
                                                  VariableName=MapToField;
                                                  SourceTable=Table70005 }

    { [{7B1324A8-A4D5-46FE-AFC5-298DBE4F52C3}];3 ;Code                ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=MapToField::Code }

    { [{7E2F2906-1597-44C0-813C-20067651B514}];3 ;Name                ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=MapToField::Name }

    { [{7E151EFA-E8DF-4A4B-B314-2BC445621864}];3 ;DataType            ;Element ;Field   ;
                                                  DataType=Integer;
                                                  SourceField=MapToField::Data Type }

    { [{E0CEB8C8-A0F9-49BD-A672-55A70575335F}];3 ;FieldNo             ;Element ;Field   ;
                                                  DataType=Integer;
                                                  SourceField=MapToField::Field No. }

    { [{28ADF35A-AD51-462A-919A-5F988FD2E419}];3 ;TableType           ;Element ;Field   ;
                                                  DataType=Option;
                                                  SourceField=MapToField::Table Type }

  }
  EVENTS
  {
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      Text001@1000 : TextConst 'ENU=Map-to Fields setup imported';

    BEGIN
    {
      CMP001 1.00 2014-07-23 Integration with Compello Document Management
                               Object created
    }
    END.
  }
}

OBJECT XMLport 70001 Import Integration Tables
{
  OBJECT-PROPERTIES
  {
    Date=01.10.16;
    Time=11:00:00;
    Modified=Yes;
    Version List=CMP2.00;
  }
  PROPERTIES
  {
    CaptionML=ENU=Import Integration Tables;
  }
  ELEMENTS
  {
    { [{71AA39D5-6AA0-4C76-AC47-8462D18DB499}];  ;ImportTables        ;Element ;Text     }

    { [{49E83F9C-1E90-4AFE-B770-2D3A54881F9D}];1 ;IntegrTables        ;Element ;Text     }

    { [{644ACF6D-3127-4BCC-A9EA-F5A8AEFD3482}];2 ;IntegrTable         ;Element ;Table   ;
                                                  SourceTable=Table70003;
                                                  Import::OnBeforeInsertRecord=VAR
                                                                                 CompelloMgt@1101103000 : Codeunit 70005;
                                                                               BEGIN
                                                                                 "Compello Integr. Table"."Dimension Code" := CompelloMgt.GetDimensionCodeByNumber("Compello Integr. Table"."Dimension No.");
                                                                               END;
                                                                                }

    { [{87D27554-8AE7-4E72-ACD7-2F2372DDE564}];3 ;Code                ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Compello Integr. Table::Code }

    { [{1217F619-35D4-4FD7-8D63-5C4D29AB6F60}];3 ;TableID             ;Element ;Field   ;
                                                  DataType=Integer;
                                                  SourceField=Compello Integr. Table::Table ID }

    { [{360D285C-0853-4BAD-8C4A-B933596F0208}];3 ;HeaderTableID       ;Element ;Field   ;
                                                  DataType=Integer;
                                                  SourceField=Compello Integr. Table::Header Table ID }

    { [{A1A32744-6DEA-452C-8860-66713F009B52}];3 ;Synchronize         ;Element ;Field   ;
                                                  DataType=Option;
                                                  SourceField=Compello Integr. Table::Synchronize }

    { [{6D39C07C-9D52-41DA-A582-684952D15B7C}];3 ;MapToTable          ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Compello Integr. Table::Map To Table }

    { [{6B8227C6-C062-415B-9901-2329B190DFBF}];3 ;TableType           ;Element ;Field   ;
                                                  DataType=Option;
                                                  SourceField=Compello Integr. Table::Table Type }

    { [{4B189A20-10A6-4192-B52D-40E1DB76284E}];3 ;ActionIO            ;Element ;Field   ;
                                                  DataType=Option;
                                                  SourceField=Compello Integr. Table::Action IO }

    { [{35892009-99BD-4A10-82DA-DAC35FB2D2F6}];3 ;NoSeries            ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Compello Integr. Table::No. Series }

    { [{8AEBBD61-7297-464B-9F4F-7D53FD4B8F89}];3 ;DataType            ;Element ;Field   ;
                                                  DataType=Integer;
                                                  SourceField=Compello Integr. Table::Data Type }

    { [{2F72647D-4EB0-479D-B91A-F6E40C2D9F7C}];3 ;DimensionNo         ;Element ;Field   ;
                                                  DataType=Integer;
                                                  SourceField=Compello Integr. Table::Dimension No. }

    { [{BCBA559A-EC4F-43F4-9222-41E6A2A4C083}];3 ;RelatedtoHeader     ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Compello Integr. Table::Related to Header }

    { [{B876808B-C121-4735-8AA5-CE7C370D2EA1}];3 ;CreditDocument      ;Element ;Field   ;
                                                  DataType=Boolean;
                                                  SourceField=Compello Integr. Table::Credit Document }

    { [{112D73C4-3330-4262-959D-E96DF343C56C}];3 ;FilterField1        ;Element ;Field   ;
                                                  DataType=Integer;
                                                  SourceField=Compello Integr. Table::Filter Field 1 }

    { [{933AD34F-3D92-449A-9225-3A6A60416418}];3 ;FilterValue1        ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Compello Integr. Table::Filter Value 1 }

    { [{BB312792-9209-4ED9-87E0-B73D9037F363}];3 ;FilterField2        ;Element ;Field   ;
                                                  DataType=Integer;
                                                  SourceField=Compello Integr. Table::Filter Field 2 }

    { [{76A12862-001E-492F-9A84-A6284BF419A9}];3 ;FilterValue2        ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Compello Integr. Table::Filter Value 2 }

    { [{906C67B5-C2D4-49CA-8A17-4F8A57B7CBAD}];3 ;FilterField3        ;Element ;Field   ;
                                                  DataType=Integer;
                                                  SourceField=Compello Integr. Table::Filter Field 3 }

    { [{40287CA5-452E-4E08-8D58-A76117F2FC48}];3 ;FilterValue3        ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Compello Integr. Table::Filter Value 3 }

    { [{6CC3B657-CE8A-4F12-96D7-B5BD9D659EAE}];3 ;IntegrFields        ;Element ;Text    ;
                                                  MinOccurs=Zero }

    { [{B2158AE7-4EAC-4786-BD72-0394D9117E0D}];4 ;IntegrField         ;Element ;Table   ;
                                                  SourceTable=Table70004;
                                                  SourceTableView=SORTING(Field1,Field2);
                                                  LinkFields=Field1=FIELD(Field1);
                                                  LinkTable=Compello Integr. Table;
                                                  MinOccurs=Zero;
                                                  Import::OnBeforeInsertRecord=VAR
                                                                                 CompelloMgt@1101103000 : Codeunit 70005;
                                                                               BEGIN
                                                                                 "Compello Integr. Table Field"."Dimension Code" := CompelloMgt.GetDimensionCodeByNumber("Compello Integr. Table Field"."Dimension No.");
                                                                               END;
                                                                                }

    { [{2E85605D-1ED8-4866-83FE-AD305C03CBA2}];5 ;TableCode           ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Compello Integr. Table Field::Table Code }

    { [{1CF9140C-0F0D-4160-8D93-923EC9F1063D}];5 ;LineNo              ;Element ;Field   ;
                                                  DataType=Integer;
                                                  SourceField=Compello Integr. Table Field::Line No. }

    { [{C42D54A0-0326-4DA3-B6BB-B9CEF580394B}];5 ;TableID             ;Element ;Field   ;
                                                  DataType=Integer;
                                                  SourceField=Compello Integr. Table Field::Table ID }

    { [{B63F4285-B088-40F2-AC7B-A12D4BC0BB46}];5 ;FieldID             ;Element ;Field   ;
                                                  DataType=Integer;
                                                  SourceField=Compello Integr. Table Field::Field ID }

    { [{C809913F-E444-4204-A1BF-156816A72621}];5 ;DimensionNo         ;Element ;Field   ;
                                                  DataType=Integer;
                                                  SourceField=Compello Integr. Table Field::Dimension No.;
                                                  MinOccurs=Zero }

    { [{1137D417-CDA6-4C9D-85F3-8F3AAF3D3FD3}];5 ;MaptoField          ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Compello Integr. Table Field::Map-to Field }

    { [{1F2987FC-101B-4D39-BEE4-D8F5D3BBA569}];5 ;MapToTableDataType  ;Element ;Field   ;
                                                  DataType=Integer;
                                                  SourceField=Compello Integr. Table Field::Map To Table Data Type }

    { [{9B0C4993-13D4-47BD-8242-EDE554E62876}];5 ;MaptoFieldNo        ;Element ;Field   ;
                                                  DataType=Integer;
                                                  SourceField=Compello Integr. Table Field::Map-to Field No. }

    { [{94BB1340-AADB-4315-9489-3F6063A98BE7}];5 ;SequenceNo          ;Element ;Field   ;
                                                  DataType=Integer;
                                                  SourceField=Compello Integr. Table Field::Sequence No. }

    { [{0D349A53-AA64-4652-B4CB-6CC4599D2F74}];5 ;Validate            ;Element ;Field   ;
                                                  DataType=Boolean;
                                                  SourceField=Compello Integr. Table Field::Validate }

    { [{BE543D09-18AF-40C4-8C33-0AFED05FA1A6}];5 ;OnlyIfNotBlank      ;Element ;Field   ;
                                                  DataType=Boolean;
                                                  SourceField=Compello Integr. Table Field::Only If Not Blank }

    { [{556FEFE0-E31A-4A29-BD28-235FBA69553F}];5 ;UseDefaultValue     ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Compello Integr. Table Field::Use Default Value }

    { [{2672F29F-6386-4F78-8F65-26085C30CFD5}];4 ;Relations           ;Element ;Text    ;
                                                  MinOccurs=Zero }

    { [{55C3C940-F2F9-4111-99A2-977433FA8E46}];5 ;Relation            ;Element ;Table   ;
                                                  SourceTable=Table70013;
                                                  SourceTableView=SORTING(Field1,Field2);
                                                  LinkFields=Field1=FIELD(Field1);
                                                  LinkTable=Compello Integr. Table;
                                                  MinOccurs=Zero }

    { [{19AF80A4-C648-4BA3-96BA-2438A8003D1C}];6 ;TableCode           ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Header and Line Relation::Table Code }

    { [{7FED6BDC-A814-4D98-8E00-C7580EE3BED8}];6 ;HeaderFieldNo       ;Element ;Field   ;
                                                  DataType=Integer;
                                                  SourceField=Header and Line Relation::Header Field No. }

    { [{7123B068-F7B4-403B-B08D-9A8DDC0EAB12}];6 ;LineFieldNo         ;Element ;Field   ;
                                                  DataType=Integer;
                                                  SourceField=Header and Line Relation::Line Field No. }

    { [{90879214-EA88-4DDB-B424-F64F35D42660}];6 ;HeaderTableNo       ;Element ;Field   ;
                                                  DataType=Integer;
                                                  SourceField=Header and Line Relation::Header Table No. }

    { [{14D0C9D3-4693-4276-8169-FCB77D2F61DD}];6 ;LineTableNo         ;Element ;Field   ;
                                                  DataType=Integer;
                                                  SourceField=Header and Line Relation::Line Table No. }

    { [{BFF575F3-3F18-41B5-A277-002573D8A56B}];6 ;Validate            ;Element ;Field   ;
                                                  DataType=Boolean;
                                                  SourceField=Header and Line Relation::Validate }

  }
  EVENTS
  {
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {

    BEGIN
    {
      CMP001 1.00 2014-07-23 Integration with Compello Document Management
                               Object created
      CMP001 1.01 2014-09-18 Integration with Compello Document Management
                               New Nodes
                                 FilterField1
                                 FilterValue1
                                 FilterField2
                                 FilterValue2
                                 FilterField3
                                 FilterValue3
    }
    END.
  }
}

OBJECT XMLport 70002 Export Receipt to Compello
{
  OBJECT-PROPERTIES
  {
    Date=02.02.17;
    Time=09:58:23;
    Modified=Yes;
    Version List=CMP2.00;
  }
  PROPERTIES
  {
    Direction=Export;
    Encoding=ISO-8859-2;
    Format/Evaluate=XML Format/Evaluate;
    OnInitXMLport=BEGIN
                    CompelloSetup.GET;
                    "Company Information".GET;
                  END;

  }
  ELEMENTS
  {
    { [{22E17649-2B83-46B0-B47F-D07E0CAE62D2}];  ;CMPORDER            ;Element ;Text     }

    { [{72103C2D-B097-4921-BCEB-032F0C231C28}];1 ;OrderHeader         ;Element ;Table   ;
                                                  SourceTable=Table38;
                                                  SourceTableView=SORTING(Field1,Field3)
                                                                  ORDER(Ascending)
                                                                  WHERE(Field1=CONST(1));
                                                  Export::OnAfterGetRecord=VAR
                                                                             ReceiptHeader@1101103000 : Record 120;
                                                                           BEGIN
                                                                             "Purchase Header".CALCFIELDS(Amount, "Amount Including VAT");
                                                                             NetOrderAmount := FORMAT("Purchase Header".Amount);
                                                                             TotalTaxAmount := FORMAT("Purchase Header"."Amount Including VAT" - "Purchase Header".Amount);
                                                                             TotalOrderAmount :=FORMAT("Purchase Header"."Amount Including VAT");
                                                                             RoundAmount := '0';
                                                                             Currency := FORMAT("Purchase Header"."Currency Code");
                                                                             Currency := "Purchase Header"."Currency Code";

                                                                             ReceiptHeader.SETRANGE("Order No.", "Purchase Header"."No.");
                                                                             IF ReceiptHeader.FINDFIRST THEN BEGIN
                                                                               IF(ReceiptHeader."No." <> ReceiptHeaderG."No.") THEN
                                                                                 Update := 'true'
                                                                               ELSE
                                                                                 Update := 'false';
                                                                             END;
                                                                             //PageNo := '1';
                                                                             Status := FORMAT(CompelloSetup."Authentication Code");
                                                                             DocType := CompelloSetup."Doc. Type Purchase Order";
                                                                             ScannerSeries := CompelloSetup."Scan. Doc. Type Purchase Order";
                                                                           END;
                                                                            }

    { [{3537FC93-8706-4E21-95CA-8D24B893BB0F}];2 ;CompanyInfo         ;Element ;Table   ;
                                                  SourceTable=Table79 }

    { [{F52FB115-CC29-4E9D-96EF-F7FC50DC595F}];3 ;CompanyName         ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Company Information::Name }

    { [{3130CBFE-E313-4BBC-8F32-E8C50BAB5711}];3 ;CompanyAddress      ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Company Information::Address }

    { [{DE08CBA0-B633-403E-BFA8-F79A8BC17C44}];3 ;CompanyCity         ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Company Information::City }

    { [{9A320375-4FFC-4A88-8F27-DE2A19B587FB}];3 ;CompanyPhone        ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Company Information::Phone No. }

    { [{F054A7D7-C934-469A-B18C-FA44C1F1CBF5}];3 ;CompanyTelefax      ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Company Information::Fax No. }

    { [{4D2DCAFF-45C4-4C98-8DE7-558D98FFF125}];3 ;CompanyGiro         ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Company Information::Giro No. }

    { [{7013B50E-B1DD-419D-BB6C-6EDA444225DA}];3 ;CompanyRegNo        ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Company Information::VAT Registration No. }

    { [{A5BC80B4-F860-4E37-8230-F841DE7D10DE}];3 ;ClientId            ;Element ;Text    ;
                                                  VariableName=ClientId;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 ClientId := CompelloSetup."Client ID";
                                                                               END;
                                                                                }

    { [{25B0E513-46C5-41FF-8C2B-9C521A0F7062}];2 ;VendorInfo          ;Element ;Table   ;
                                                  SourceTable=Table23;
                                                  LinkFields=Field1=FIELD(Field2);
                                                  LinkTable=Purchase Header;
                                                  Export::OnAfterGetRecord=BEGIN
                                                                             VendorName := DELCHR(Vendor.Name, '=', ''''); //03. 18.01.17 JAL
                                                                           END;
                                                                            }

    { [{AED7DD12-6DBA-4334-AA44-BEFECB89DED7}];3 ;VendorId            ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Vendor::No. }

    { [{CF6321D1-7661-4E97-A761-2A352814A512}];3 ;VendorName          ;Element ;Text    ;
                                                  DataType=Text }

    { [{222B8DB3-5CC9-43B4-82D0-69D94B7D578A}];3 ;VendorAddress       ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Vendor::Address }

    { [{E7FF0BDF-1DE7-4AA1-BACF-039C2FE2867E}];3 ;VendorCity          ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Vendor::City }

    { [{ADDDE1C8-24EF-426E-BD70-5D1FA15A8433}];3 ;VendorCountry       ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Vendor::Country/Region Code }

    { [{F87F309E-1FE1-4712-BCC9-115B7FEC1752}];2 ;PurchaseInfo        ;Element ;Text     }

    { [{37BE1DBB-1952-448B-92C2-2427B6CC720D}];3 ;PurchaseNumber      ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Purchase Header::No. }

    { [{A32F50E5-1DF3-48D9-8011-C2C186BC9EC0}];3 ;PackingSlip         ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Purchase Header::Vendor Shipment No. }

    { [{644F24B8-D17E-4D18-8676-48DA15D75821}];3 ;Update              ;Element ;Text     }

    { [{3EF071BC-1F1D-4D30-9139-4C733CC78274}];3 ;PurchaseDate        ;Element ;Field   ;
                                                  DataType=Date;
                                                  SourceField=Purchase Header::Order Date }

    { [{B0F9DCA6-CB21-461A-A9B3-36B8B223EB73}];3 ;PageNo              ;Element ;Text     }

    { [{DDAF7763-A209-4AB2-8EB4-DE42CFC264AC}];3 ;Status              ;Element ;Text     }

    { [{8F00E312-ABE5-465C-BC35-6E5FDFEFCF45}];3 ;DocType             ;Element ;Text     }

    { [{83BE98A4-7D3E-464F-8715-A83284B6A345}];3 ;ScannerSeries       ;Element ;Text     }

    { [{599CC3D2-32DF-4BFC-93F8-DE9325904998}];2 ;DeliveryInfo        ;Element ;Text     }

    { [{A4665EFD-A730-4DC0-8AD1-E249DD3467B1}];3 ;DeliveryName        ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Purchase Header::Ship-to Name }

    { [{4FC36E36-FC52-4260-AC8F-70D4EE073DB2}];3 ;DeliveryAddress     ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Purchase Header::Ship-to Address }

    { [{86BA1392-40A8-4BCB-9372-259495F89949}];3 ;DeliveryCity        ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Purchase Header::Ship-to City }

    { [{699E7DA5-6726-45D9-9EA7-6BA2A4309EDB}];3 ;DeliveryCountry     ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Purchase Header::Ship-to Country/Region Code }

    { [{F2D4FDCA-E1A8-42F3-9267-FD5D179E8C27}];1 ;OrderDetails        ;Element ;Text     }

    { [{0245A113-C023-45AB-B874-DB8B1ADBD3C0}];2 ;OrderLines          ;Element ;Table   ;
                                                  SourceTable=Table39;
                                                  SourceTableView=SORTING(Field1,Field3,Field4)
                                                                  ORDER(Ascending)
                                                                  WHERE(Field5=FILTER(2|1));
                                                  LinkFields=Field1=FIELD(Field1),
                                                             Field3=FIELD(Field3);
                                                  LinkTable=Purchase Header;
                                                  Export::OnAfterGetRecord=VAR
                                                                             ReceiptLine@1101103000 : Record 121;
                                                                             DimMgt@1101103001 : Codeunit 408;
                                                                             Dimension@1101103002 : ARRAY [8] OF Code[20];
                                                                           BEGIN

                                                                             ReceiptLine.SETRANGE("Document No." ,ReceiptHeaderG."No.");
                                                                             ReceiptLine.SETRANGE("Order No.", "Purchase Line"."Document No.");
                                                                             ReceiptLine.SETRANGE("Order Line No.", "Purchase Line"."Line No.");
                                                                             ReceiptLine.SETFILTER(Quantity, '<>0');

                                                                             IF ReceiptLine.FINDFIRST THEN BEGIN
                                                                               UserDef8 := ReceiptLine."Document No.";
                                                                               UserDef15 := FORMAT(ReceiptLine."Line No.");
                                                                               TotalDelivered := FORMAT(ReceiptLine.Quantity, 0,'<Sign><Integer><Decimals>');
                                                                               TotalDelivered := CONVERTSTR(TotalDelivered, ',', '.');
                                                                               Quantity := FORMAT(ReceiptLine.Quantity, 0,'<Sign><Integer><Decimals>');
                                                                               Quantity := CONVERTSTR(Quantity, ',', '.');
                                                                               UserDef12 := FORMAT(ReceiptLine."Posting Date");
                                                                               DeliveryDate := FORMAT(ReceiptHeaderG."Posting Date",0,0); //FMY Changed after request from compello 21.03.16
                                                                             END
                                                                             ELSE
                                                                                currXMLport.SKIP;

                                                                             UserDef9 := "Purchase Header"."Vendor Shipment No.";
                                                                             Dim15 := "Purchase Header"."Purchaser Code";
                                                                             LineStatus := FORMAT(CompelloSetup."Authentication Code");
                                                                             InventTransId := ReceiptLine."Document No." + '-' + FORMAT(ReceiptLine."Line No.");

                                                                             IF ReceiptLine.Type = ReceiptLine.Type::Item  THEN
                                                                               Account := CompelloSetup."Default PO Account"
                                                                             ELSE
                                                                               Account := ReceiptLine."No.";


                                                                             DimMgt.GetShortcutDimensions(ReceiptLine."Dimension Set ID", Dimension);

                                                                             Dim1 := ReceiptLine."Shortcut Dimension 1 Code";
                                                                             Dim2 := ReceiptLine."Shortcut Dimension 2 Code";
                                                                             Dim3 := Dimension[3];
                                                                             Dim4 := Dimension[4];
                                                                             Dim5 := Dimension[5];
                                                                             Dim6 := Dimension[6];
                                                                             Dim7 := Dimension[7];
                                                                             Dim8 := Dimension[8];
                                                                             //Dim9 := Dimension[9];
                                                                             //Dim10 := Dimension[10];
                                                                             Description := DELCHR("Purchase Line".Description, '=', ''''); //03. 18.01.17 JAL
                                                                           END;
                                                                            }

    { [{7533944A-EC26-4AE2-98CE-059E1CF202B9}];3 ;ItemNumber          ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Purchase Line::No. }

    { [{1CB0A2E0-297B-410A-93DA-D5BE92F3FC30}];3 ;Description         ;Element ;Text    ;
                                                  DataType=Text }

    { [{F42FC1BE-C254-4365-A012-04D6CE59AF8A}];3 ;DeliveryDate        ;Element ;Text    ;
                                                  DataType=Date }

    { [{E0DA296A-B6C7-4DB7-AA99-5711089AEF20}];3 ;Quantity            ;Element ;Text    ;
                                                  DataType=Decimal }

    { [{B544EC31-AD3E-4D17-9ADD-B38D04DE9C46}];3 ;CostPrice           ;Element ;Field   ;
                                                  DataType=Decimal;
                                                  SourceField=Purchase Line::Direct Unit Cost }

    { [{8B55041B-C391-4C73-8E76-16E16CAEEB2C}];3 ;DiscPercent         ;Element ;Field   ;
                                                  DataType=Decimal;
                                                  SourceField=Purchase Line::Line Discount % }

    { [{C1D98945-073B-4D50-9EE1-B4ACAA453D78}];3 ;TotalDelivered      ;Element ;Text    ;
                                                  DataType=Decimal }

    { [{F2F76A9D-6633-4280-82A1-D192BEBAF197}];3 ;InventTransId       ;Element ;Text    ;
                                                  DataType=Integer }

    { [{EC54060B-FFAE-478B-990A-0E7436350601}];3 ;LineAmount          ;Element ;Field   ;
                                                  DataType=Decimal;
                                                  SourceField=Purchase Line::Line Amount }

    { [{10515D72-F803-4E9C-A009-5393C3D6FE32}];3 ;Currency            ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Purchase Line::Currency Code }

    { [{1FDB8032-D061-4B3F-A551-B611225EBF0B}];3 ;UserDef8            ;Element ;Text     }

    { [{AA353828-65E9-4B00-9C5F-024DD240A987}];3 ;UserDef9            ;Element ;Text     }

    { [{4B7ADDF3-021C-4EE7-BF97-825A8ACD193B}];3 ;UserDef11           ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Purchase Line::Vendor Item No. }

    { [{21A4E535-E327-49A3-BB54-F9154CA8B0C3}];3 ;UserDef12           ;Element ;Text     }

    { [{3105EA09-712E-40E9-9F38-AEAAA4CFF996}];3 ;UserDef13           ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Purchase Line::Location Code }

    { [{C017E1EE-8D62-42F2-A375-4DBE511BAB9F}];3 ;UserDef15           ;Element ;Text     }

    { [{61C182CA-319D-4006-BF71-8376EF9DE4D8}];3 ;Dim1                ;Element ;Text     }

    { [{A7DEAE0A-FE5B-4062-B761-3A8336502353}];3 ;Dim2                ;Element ;Text     }

    { [{88A91CD3-2A34-4D7F-875C-82BC0BA30579}];3 ;Dim3                ;Element ;Text     }

    { [{3CAB40A7-3ADA-44FE-8B79-EFF293F8F8DD}];3 ;Dim4                ;Element ;Text     }

    { [{25CBD9DA-A2F5-4A04-8124-53D6BDC2E86C}];3 ;Dim5                ;Element ;Text     }

    { [{AB047FE8-BFDB-4344-8A37-4C5F7AA4E62F}];3 ;Dim6                ;Element ;Text     }

    { [{AAF5B753-1F2C-4E90-90CB-E01BD9133713}];3 ;Dim7                ;Element ;Text     }

    { [{F4B78786-A17A-4C33-BBC3-FDF24BC37549}];3 ;Dim8                ;Element ;Text     }

    { [{17D4D3E6-E860-4622-A900-4666FA9E2793}];3 ;Dim9                ;Element ;Text     }

    { [{FA23820E-C853-45C3-91A3-B0F8355CE0BC}];3 ;Dim10               ;Element ;Text     }

    { [{A179C7DE-DE6A-405B-8E94-2375B2EC7A55}];3 ;Dim11               ;Element ;Text     }

    { [{910EB023-5C1A-4E44-B4B9-67257FEF2301}];3 ;Dim12               ;Element ;Text     }

    { [{F20245EE-4523-4920-9B35-0B864DED30AD}];3 ;Dim13               ;Element ;Text     }

    { [{CCADA77C-586C-47A2-8037-F5E46C4B3833}];3 ;Dim14               ;Element ;Text     }

    { [{36FF0B7B-54BC-4680-97FA-80269615A153}];3 ;Dim15               ;Element ;Text     }

    { [{1BFB548C-FEF2-4559-90E9-E51AB5A0291A}];3 ;Purchaser           ;Element ;Text     }

    { [{255776C2-2B01-44A7-9D7B-1A4B7AC1740A}];3 ;Responsible         ;Element ;Text     }

    { [{943928F9-13AC-41DF-92C8-29DC79E34EAE}];3 ;Status              ;Element ;Text    ;
                                                  VariableName=LineStatus }

    { [{30C6EB96-5FC9-495A-8889-4F9AB2C3D3F9}];3 ;Account             ;Element ;Text     }

    { [{0D13B042-B409-4F8C-97A8-6B038A5BD6DD}];3 ;TaxCode             ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Purchase Line::VAT Code }

    { [{B8218288-6B12-4205-B42E-0496146B6CED}];1 ;OrderTotals         ;Element ;Text     }

    { [{2FD77AF4-3760-475A-9172-3FBC20FB2FA6}];2 ;Totals              ;Element ;Text     }

    { [{C68988DF-9231-42F5-ADC1-217A1D8F6370}];3 ;NetOrderAmount      ;Element ;Text    ;
                                                  VariableName=NetOrderAmount }

    { [{B2A3FCFA-EDF3-45C4-88AE-E20A521D7994}];3 ;TotalTaxAmount      ;Element ;Text    ;
                                                  VariableName=TotalTaxAmount }

    { [{8395801E-1CF8-4601-835C-671FF18260F6}];3 ;RoundAmount         ;Element ;Text    ;
                                                  VariableName=RoundAmount }

    { [{BD4CC9C0-C37D-4057-A575-CDC04ADD0FC9}];3 ;Freight             ;Element ;Text    ;
                                                  VariableName=Freight }

    { [{A2ADBEF2-A1A3-48B9-AD9A-DCB271C68969}];3 ;Packaging           ;Element ;Text    ;
                                                  VariableName=Packaging }

    { [{53B3BB47-C8C3-473E-B77E-5FCDDA5D637F}];3 ;TotalOrderAmount    ;Element ;Text    ;
                                                  VariableName=TotalOrderAmount }

    { [{57725DF3-F1B9-4F2D-B3F1-5A9697205F8C}];3 ;Currency            ;Element ;Text    ;
                                                  VariableName=Currency }

  }
  EVENTS
  {
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      CompelloSetup@1101103000 : Record 70000;
      ReceiptHeaderG@1101103001 : Record 120;

    PROCEDURE SetTableFilters@1101103000(VAR ReceiptHeader@1101103000 : Record 120);
    BEGIN
      ReceiptHeaderG := ReceiptHeader;
      "Purchase Header".SETRANGE("No.", ReceiptHeader."Order No.");
    END;

    BEGIN
    {
      +---------------------------------------------+
      | SI-Data                                     |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 08.04.15 JAL Created the object
      02. 21.03.16 FMY Changed after request from compello 21.03.16 Mottaksdato/DeliveryDate
      03. 18.01.17 JAL Removing the symbol ' from Item Description and Vendor Name because import to Compello fails.
    }
    END.
  }
}

OBJECT MenuSuite 1052 Compello Integration
{
  OBJECT-PROPERTIES
  {
    Date=06.12.16;
    Time=20:58:43;
    Modified=Yes;
    Version List=CMP2.00;
  }
  PROPERTIES
  {
  }
  MENUNODES
  {
    {                ;[{783B68E0-4D0F-4CDF-A60B-D45CE7B35B27}] ;NextNodeID=[{FE934872-8126-4816-B5CD-E0EFB68C47E4}] }
    { MenuGroup      ;[{FE934872-8126-4816-B5CD-E0EFB68C47E4}] ;Name=[Compello Integrationµ! ];
                                                                CaptionML=ENU=Compello Integration;
                                                                MemberOfMenu=[{19A352FE-D90D-424E-B85F-CF3B8E98CF0E}];
                                                                ParentNodeID=[{28B406BE-DD89-43EC-B2B9-6BB90DC2583B}];
                                                                Visible=Yes;
                                                                NextNodeID=[{B0697E0F-6AD6-425A-9E5C-F0BD41F9BC72}];
                                                                FirstChild=[{6CFADC49-7CDD-47C3-A47E-3C6A05D32D55}] }
    { MenuItem       ;[{F08308A9-245E-4443-8B73-DFB7130A5CA7}] ;Name=Compello Map-to Fields;
                                                                CaptionML=ENU=Compello Map-to Fields;
                                                                MemberOfMenu=[{19A352FE-D90D-424E-B85F-CF3B8E98CF0E}];
                                                                RunObjectType=Page;
                                                                RunObjectID=70005;
                                                                ParentNodeID=[{FE934872-8126-4816-B5CD-E0EFB68C47E4}];
                                                                Visible=Yes;
                                                                NextNodeID=[{A131DC04-EA78-4E38-AEC9-B15C3332E0A8}];
                                                                DepartmentCategory=Administration }
    { MenuItem       ;[{6CFADC49-7CDD-47C3-A47E-3C6A05D32D55}] ;Name=Integration To Compello Setup;
                                                                CaptionML=ENU=Integration To Compello Setup;
                                                                MemberOfMenu=[{19A352FE-D90D-424E-B85F-CF3B8E98CF0E}];
                                                                RunObjectType=Page;
                                                                RunObjectID=70010;
                                                                ParentNodeID=[{FE934872-8126-4816-B5CD-E0EFB68C47E4}];
                                                                Visible=Yes;
                                                                NextNodeID=[{F08308A9-245E-4443-8B73-DFB7130A5CA7}];
                                                                DepartmentCategory=Administration }
    { MenuItem       ;[{A131DC04-EA78-4E38-AEC9-B15C3332E0A8}] ;Name=Compello Integr. Table List;
                                                                CaptionML=ENU=Compello Integr. Table List;
                                                                MemberOfMenu=[{19A352FE-D90D-424E-B85F-CF3B8E98CF0E}];
                                                                RunObjectType=Page;
                                                                RunObjectID=70002;
                                                                ParentNodeID=[{FE934872-8126-4816-B5CD-E0EFB68C47E4}];
                                                                Visible=Yes;
                                                                NextNodeID=[{6CFADC49-7CDD-47C3-A47E-3C6A05D32D55}];
                                                                DepartmentCategory=Administration }
    {                ;[{502E3FFC-A7CC-48F7-88A4-89A841F0C628}] ;NextNodeID=[{F17F96B7-D5DF-4C82-B90E-D172A36E4942}] }
    { MenuItem       ;[{F17F96B7-D5DF-4C82-B90E-D172A36E4942}] ;Name=Incoming Documents Setup;
                                                                CaptionML=[ENU=Incoming Documents Setup;
                                                                           NOR=Oppsett for inng†ende dokumenter];
                                                                RunObjectType=Page;
                                                                RunObjectID=191;
                                                                Visible=Yes;
                                                                DepartmentCategory=Tasks }
    {                ;[{BAD8AF38-254A-4266-AF07-EDC55674B5FA}] ;NextNodeID=[{A2E2F2F9-5AB0-4C65-9A60-F9BAE2B24023}] }
    { MenuItem       ;[{A2E2F2F9-5AB0-4C65-9A60-F9BAE2B24023}] ;Name=VAT Clauses;
                                                                CaptionML=[ENU=VAT Clauses;
                                                                           NOR=Mva-setninger];
                                                                RunObjectType=Page;
                                                                RunObjectID=747;
                                                                Visible=Yes;
                                                                DepartmentCategory=Administration }
    {                ;[{9474DF8C-B0E7-4FED-AF54-367E0639F7B0}] ;NextNodeID=[{C68C0462-288A-42CC-8BC7-6F224D8846CE}] }
    { MenuItem       ;[{C68C0462-288A-42CC-8BC7-6F224D8846CE}] ;Name=VAT Clauses;
                                                                CaptionML=[ENU=VAT Clauses;
                                                                           NOR=Mva-setninger];
                                                                RunObjectType=Page;
                                                                RunObjectID=747;
                                                                Visible=Yes;
                                                                DepartmentCategory=Tasks }
    {                ;[{44DC36A4-3D38-427C-B37D-02811193E52A}] ;NextNodeID=[{9CBA63AC-73D3-438F-818D-476B76D5DB75}] }
    { MenuItem       ;[{9CBA63AC-73D3-438F-818D-476B76D5DB75}] ;Name=Posting Exchange Definition;
                                                                CaptionML=[ENU=Posting Exchange Definitions;
                                                                           NOR=Definisjoner av bokf›ringsutveksling];
                                                                RunObjectType=Page;
                                                                RunObjectID=1211;
                                                                Visible=Yes;
                                                                DepartmentCategory=Lists }
    { MenuItem       ;[{BB2D12FC-2EEB-4165-869B-098BBB42C6F6}] ;Name=Bank Export/Import Setup;
                                                                CaptionML=[ENU=Bank Export/Import Setup;
                                                                           NOR=Konfigurasjon av bankeksport/-import];
                                                                RunObjectType=Page;
                                                                RunObjectID=1200;
                                                                Visible=Yes;
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{C0BECAC0-F100-4C39-BBCA-714333A54406}] ;Name=SEPA Schema Viewer;
                                                                CaptionML=[ENU=SEPA Schema Viewer;
                                                                           NOR=Visningsprogram for SEPA-skjema];
                                                                RunObjectType=Page;
                                                                RunObjectID=9610;
                                                                Visible=Yes;
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{7FD6154D-F047-4A31-B857-0DA1E0BA97D8}] ;Name=XML Schemas;
                                                                CaptionML=[ENU=XML Schemas;
                                                                           NOR=XML-skjemaer];
                                                                RunObjectType=Page;
                                                                RunObjectID=9600;
                                                                Visible=Yes;
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{D7B287A5-D9C4-4D9D-AE3D-A0274EA004D6}] ;Name=Bank Data Conv. Service Setup;
                                                                CaptionML=[ENU=Bank Data Conv. Service Setup;
                                                                           NOR=Tjenesteoppsett for bankdatakonvertering];
                                                                RunObjectType=Page;
                                                                RunObjectID=1260;
                                                                Visible=Yes;
                                                                NextNodeID=[{063C5F4E-8D4F-45ED-97BF-C6B9BBDE8CA6}];
                                                                DepartmentCategory=Tasks }
    {                ;[{387B2D8D-4249-4D63-BE9C-850416EA6E81}] ;NextNodeID=[{34E4BEA4-29EB-4579-8568-973A8449A4A1}] }
    { MenuItem       ;[{34E4BEA4-29EB-4579-8568-973A8449A4A1}] ;Name=Certificates of Supply;
                                                                CaptionML=[ENU=Certificates of Supply;
                                                                           NOR=Mottaksdeklarasjoner];
                                                                RunObjectType=Page;
                                                                RunObjectID=780;
                                                                Visible=Yes;
                                                                NextNodeID=[{3E2FEC16-BE73-41A6-94E5-BAFFDE0CFB12}];
                                                                DepartmentCategory=Lists }
    { MenuGroup      ;[{B0697E0F-6AD6-425A-9E5C-F0BD41F9BC72}] ;Name=New Group;
                                                                CaptionML=[ENU=Employee Portal;
                                                                           NOR=Employee Portal];
                                                                Visible=Yes }
    { Menu           ;[{AD1A5692-E9A6-4366-8DD8-A0F836F01ED5}] ;Name=Compello;
                                                                CaptionML=[ENU=Compello;
                                                                           NOR=Compello];
                                                                MemberOfMenu=[{AD1A5692-E9A6-4366-8DD8-A0F836F01ED5}];
                                                                ParentNodeID=[{00000000-0000-0000-0000-000000000000}];
                                                                Image=3;
                                                                IsShortcut=No;
                                                                Visible=Yes;
                                                                Enabled=Yes;
                                                                NextNodeID=[{8D5D65D8-68A2-4A84-9BCE-3742CEDA47BF}];
                                                                FirstChild=[{E31CCDE1-8E17-48F3-870A-5843835C6F2B}] }
    {                ;[{03134937-C76A-4D80-A8B2-FF6458E180EB}] ;NextNodeID=[{AD1A5692-E9A6-4366-8DD8-A0F836F01ED5}] }
    { MenuItem       ;[{44CC109E-2119-4CF6-A0F8-49B795492E19}] ;Name=Compello Change Log List;
                                                                CaptionML=ENU=Compello Change Log List;
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{AD1A5692-E9A6-4366-8DD8-A0F836F01ED5}];
                                                                RunObjectType=Page;
                                                                RunObjectID=70001;
                                                                ParentNodeID=[{E31CCDE1-8E17-48F3-870A-5843835C6F2B}];
                                                                Visible=Yes;
                                                                NextNodeID=[{5F174F29-DFCD-4AF9-9765-C6A37F637367}];
                                                                DepartmentCategory=Lists }
    { MenuItem       ;[{FDBAE915-9F5E-45B3-8B2F-894A5B8D4A8B}] ;Name=Compello Change Log List;
                                                                CaptionML=ENU=Compello Export Log;
                                                                MemberOfMenu=[{AD1A5692-E9A6-4366-8DD8-A0F836F01ED5}];
                                                                RunObjectType=Page;
                                                                RunObjectID=70008;
                                                                ParentNodeID=[{5F174F29-DFCD-4AF9-9765-C6A37F637367}];
                                                                Visible=Yes;
                                                                NextNodeID=[{00000000-0000-0000-0000-000000000000}];
                                                                DepartmentCategory=History }
    { MenuItem       ;[{B2FC9242-2E63-4139-96DE-61D306792BC8}] ;Name=Compello Change Log List;
                                                                CaptionML=ENU=Compello Import Log List;
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{AD1A5692-E9A6-4366-8DD8-A0F836F01ED5}];
                                                                RunObjectType=Page;
                                                                RunObjectID=70013;
                                                                ParentNodeID=[{35AE6FA6-4543-49CF-A3BE-145616586725}];
                                                                Visible=Yes;
                                                                NextNodeID=[{14B34649-2097-4837-8A62-2341267EE4AD}];
                                                                DepartmentCategory=Lists }
    { MenuItem       ;[{6833AECE-90C9-4287-9393-BB1FD093A869}] ;Name=Compello Change Log Arch. List;
                                                                CaptionML=ENU=Compello Change Log Arch. List;
                                                                MemberOfMenu=[{AD1A5692-E9A6-4366-8DD8-A0F836F01ED5}];
                                                                RunObjectType=Page;
                                                                RunObjectID=70007;
                                                                ParentNodeID=[{5F174F29-DFCD-4AF9-9765-C6A37F637367}];
                                                                Visible=Yes;
                                                                NextNodeID=[{FDBAE915-9F5E-45B3-8B2F-894A5B8D4A8B}];
                                                                DepartmentCategory=History }
    { MenuItem       ;[{D0F9C228-2552-4B64-8CEC-C9B62AD42A72}] ;Name=Compello Change Log Arch. List;
                                                                CaptionML=ENU=Compello Imp. Arch. Log List;
                                                                MemberOfMenu=[{AD1A5692-E9A6-4366-8DD8-A0F836F01ED5}];
                                                                RunObjectType=Page;
                                                                RunObjectID=70016;
                                                                ParentNodeID=[{14B34649-2097-4837-8A62-2341267EE4AD}];
                                                                Visible=Yes;
                                                                NextNodeID=[{00000000-0000-0000-0000-000000000000}];
                                                                DepartmentCategory=History }
    { MenuGroup      ;[{E31CCDE1-8E17-48F3-870A-5843835C6F2B}] ;Name=To Compello;
                                                                CaptionML=[ENU=To Compello;
                                                                           NOR=Til Compello];
                                                                MemberOfMenu=[{AD1A5692-E9A6-4366-8DD8-A0F836F01ED5}];
                                                                ParentNodeID=[{AD1A5692-E9A6-4366-8DD8-A0F836F01ED5}];
                                                                Visible=Yes;
                                                                NextNodeID=[{35AE6FA6-4543-49CF-A3BE-145616586725}];
                                                                FirstChild=[{44CC109E-2119-4CF6-A0F8-49B795492E19}];
                                                                IsDepartmentPage=No }
    { MenuGroup      ;[{35AE6FA6-4543-49CF-A3BE-145616586725}] ;Name=From Compello;
                                                                CaptionML=[ENU=From Compello;
                                                                           NOR=Fra Compello];
                                                                MemberOfMenu=[{AD1A5692-E9A6-4366-8DD8-A0F836F01ED5}];
                                                                ParentNodeID=[{AD1A5692-E9A6-4366-8DD8-A0F836F01ED5}];
                                                                Visible=Yes;
                                                                NextNodeID=[{00000000-0000-0000-0000-000000000000}];
                                                                FirstChild=[{B2FC9242-2E63-4139-96DE-61D306792BC8}];
                                                                IsDepartmentPage=No }
    { MenuGroup      ;[{5F174F29-DFCD-4AF9-9765-C6A37F637367}] ;Name=Historikk;
                                                                CaptionML=[ENU=Historikk;
                                                                           NOR=History];
                                                                MemberOfMenu=[{AD1A5692-E9A6-4366-8DD8-A0F836F01ED5}];
                                                                ParentNodeID=[{E31CCDE1-8E17-48F3-870A-5843835C6F2B}];
                                                                Visible=Yes;
                                                                NextNodeID=[{00000000-0000-0000-0000-000000000000}];
                                                                FirstChild=[{6833AECE-90C9-4287-9393-BB1FD093A869}];
                                                                IsDepartmentPage=No }
    { MenuGroup      ;[{14B34649-2097-4837-8A62-2341267EE4AD}] ;Name=Historikk;
                                                                CaptionML=[ENU=Historikk;
                                                                           NOR=History];
                                                                MemberOfMenu=[{AD1A5692-E9A6-4366-8DD8-A0F836F01ED5}];
                                                                ParentNodeID=[{35AE6FA6-4543-49CF-A3BE-145616586725}];
                                                                Visible=Yes;
                                                                NextNodeID=[{00000000-0000-0000-0000-000000000000}];
                                                                FirstChild=[{D0F9C228-2552-4B64-8CEC-C9B62AD42A72}];
                                                                IsDepartmentPage=No }
    {                ;[{8B53F309-FB1D-47BA-A2FE-1460E0D5ECDB}] ;NextNodeID=[{7D84E2C7-9D7A-4DA2-87C1-DDBB9435B63C}] }
    { MenuItem       ;[{7D84E2C7-9D7A-4DA2-87C1-DDBB9435B63C}] ;Name=Item Tracking Codes;
                                                                CaptionML=[ENU=Item Tracking Codes;
                                                                           NOR=Varesporingskoder];
                                                                RunObjectType=Page;
                                                                RunObjectID=6502;
                                                                Visible=Yes;
                                                                DepartmentCategory=Lists }
    { MenuItem       ;[{49448471-4DCE-4BAC-B6A9-BD8614D01A48}] ;Name=Transfer Routes;
                                                                CaptionML=[ENU=Transfer Routes;
                                                                           NOR=Overf›ringsruter];
                                                                RunObjectType=Page;
                                                                RunObjectID=5747;
                                                                Visible=Yes;
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{81D2CE2C-6499-43ED-9A0B-398248B6B87B}] ;Name=Item Journal Templates;
                                                                CaptionML=[ENU=Item Journal Templates;
                                                                           NOR=Varekladdemaler];
                                                                RunObjectType=Page;
                                                                RunObjectID=102;
                                                                Visible=Yes;
                                                                DepartmentCategory=Lists }
    { MenuItem       ;[{7CEA59FF-A695-44FD-A274-BF6178760FD7}] ;Name=Report Selections Inventory;
                                                                CaptionML=[ENU=Report Selections Inventory;
                                                                           NOR=Rapportvalg - beholdning];
                                                                RunObjectType=Page;
                                                                RunObjectID=5754;
                                                                Visible=Yes;
                                                                NextNodeID=[{00000000-0000-0000-0000-000000000000}];
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{063C5F4E-8D4F-45ED-97BF-C6B9BBDE8CA6}] ;Name=Currency Exchange Rate Services;
                                                                CaptionML=[ENU=Currency Exchange Rate Services;
                                                                           NOR=Valutakurstjenester];
                                                                ApplicationArea=#Suite;
                                                                RunObjectType=Page;
                                                                RunObjectID=1650;
                                                                Visible=Yes;
                                                                DepartmentCategory=Administration }
    { MenuItem       ;[{2E248CCA-400D-4FCB-91DD-CE38F9351F2F}] ;Name=Web Services;
                                                                CaptionML=[ENU=Web Services;
                                                                           NOR=Webtjenester];
                                                                ApplicationArea=#Basic,#Suite;
                                                                RunObjectType=Page;
                                                                RunObjectID=810;
                                                                Visible=Yes;
                                                                DepartmentCategory=Lists }
    { MenuItem       ;[{6475F264-C31C-40E2-8278-B59082477099}] ;Name=Service Connections Overview;
                                                                CaptionML=[ENU=Service Connections;
                                                                           NOR=Tjenestetilkoblinger];
                                                                ApplicationArea=#Basic,#Suite;
                                                                RunObjectType=Page;
                                                                RunObjectID=1279;
                                                                Visible=Yes;
                                                                DepartmentCategory=Lists }
    { MenuItem       ;[{1E5DA5B4-C075-4977-98B1-561D0FE52D42}] ;Name=Integration Table Mappings;
                                                                CaptionML=[ENU=Integration Table Mappings;
                                                                           NOR=Tilordninger for integreringstabell];
                                                                ApplicationArea=#Suite;
                                                                RunObjectType=Page;
                                                                RunObjectID=5335;
                                                                Visible=Yes;
                                                                DepartmentCategory=Lists }
    { MenuItem       ;[{164F1071-174D-4C2D-B5BB-7D4B236CAE1B}] ;Name=Integration Synchronization Jobs;
                                                                CaptionML=[ENU=Integration Synchronization Jobs;
                                                                           NOR=Synkroniseringsjobber for integrering];
                                                                ApplicationArea=#Suite;
                                                                RunObjectType=Page;
                                                                RunObjectID=5338;
                                                                Visible=Yes;
                                                                DepartmentCategory=Lists }
    { MenuItem       ;[{24F755DE-8930-4260-BDAD-B04509BCDAA4}] ;Name=Integration Synchronization Errors;
                                                                CaptionML=[ENU=Integration Synchronization Errors;
                                                                           NOR=Synkroniseringsfeil for integrering];
                                                                ApplicationArea=#Suite;
                                                                RunObjectType=Page;
                                                                RunObjectID=5339;
                                                                Visible=Yes;
                                                                DepartmentCategory=Lists }
    { MenuItem       ;[{51B7B594-3BCB-4639-81EE-66C491879B59}] ;Name=Online Payments;
                                                                CaptionML=[ENU=Payment Services;
                                                                           NOR=Betalingstjenester];
                                                                ApplicationArea=#Basic,#Suite;
                                                                RunObjectType=Page;
                                                                RunObjectID=1060;
                                                                Visible=Yes;
                                                                DepartmentCategory=Administration }
    { MenuItem       ;[{DE4A96D2-9635-48C6-8354-8873EA929C6C}] ;Name=Office Add-In Management;
                                                                CaptionML=[ENU=Office Add-in Management;
                                                                           NOR=Administrasjon av Office-tillegg];
                                                                ApplicationArea=#Basic,#Suite;
                                                                RunObjectType=Page;
                                                                RunObjectID=1610;
                                                                Visible=Yes;
                                                                DepartmentCategory=Administration }
    { MenuItem       ;[{36FD5978-1AAA-4307-8C6A-156D51A778B3}] ;Name=Exchange Sync. Setup;
                                                                CaptionML=[ENU=Exchange Sync. Setup;
                                                                           NOR=Konfigurasjon av Exchange-synkronisering];
                                                                ApplicationArea=#Basic,#Suite;
                                                                RunObjectType=Page;
                                                                RunObjectID=6700;
                                                                Visible=Yes;
                                                                NextNodeID=[{44A4DAAA-604A-4D16-854B-BD8B7E6F7460}];
                                                                DepartmentCategory=Administration }
    { MenuItem       ;[{44A4DAAA-604A-4D16-854B-BD8B7E6F7460}] ;Name=Doc. Exch. Service Setup;
                                                                CaptionML=[ENU=Document Exchange Service Setup;
                                                                           NOR=Oppsett av dokumentutvekslingstjeneste];
                                                                ApplicationArea=#Basic,#Suite;
                                                                RunObjectType=Page;
                                                                RunObjectID=1275;
                                                                Visible=Yes;
                                                                DepartmentCategory=Administration }
    { MenuItem       ;[{85C60724-2BF2-4C45-BF83-4F2C3297876F}] ;Name=CRM Connection Setup;
                                                                AccessByPermission=TableData 5330=IM;
                                                                CaptionML=[ENU=Microsoft Dynamics CRM Connection Setup;
                                                                           NOR=Tilkoblingsoppsett for Microsoft Dynamics CRM];
                                                                ApplicationArea=#Suite;
                                                                RunObjectType=Page;
                                                                RunObjectID=5330;
                                                                Visible=Yes;
                                                                DepartmentCategory=Administration }
    { MenuItem       ;[{2A96CC77-0DDE-449E-A583-3C2AB989AC9D}] ;Name=SharePoint Connection Setup;
                                                                CaptionML=[ENU=SharePoint Connection Setup;
                                                                           NOR=Tilkoblingsoppsett for SharePoint];
                                                                RunObjectType=Page;
                                                                RunObjectID=9551;
                                                                Visible=Yes;
                                                                DepartmentCategory=Administration }
    { MenuItem       ;[{F120CBC2-793A-49E5-A12B-3BAA4F9BE2BC}] ;Name=SMTP Mail Setup;
                                                                CaptionML=[ENU=SMTP Mail Setup;
                                                                           NOR=Oppsett av SMTP-e-post];
                                                                ApplicationArea=#Basic,#Suite;
                                                                RunObjectType=Page;
                                                                RunObjectID=409;
                                                                Visible=Yes;
                                                                DepartmentCategory=Administration }
    { MenuItem       ;[{F9797B04-ACF3-4D64-A323-00939AB7D376}] ;Name=Social Listening Setup;
                                                                CaptionML=[ENU=Social Engagement Setup;
                                                                           NOR=Konfigurer Social Engagement];
                                                                RunObjectType=Page;
                                                                RunObjectID=870;
                                                                Visible=Yes;
                                                                NextNodeID=[{06D18B49-2CC3-46E2-99B5-E73CFEB51F56}];
                                                                DepartmentCategory=Administration }
    { MenuItem       ;[{06D18B49-2CC3-46E2-99B5-E73CFEB51F56}] ;Name=OCR Service Setup;
                                                                CaptionML=[ENU=OCR Service Setup;
                                                                           NOR=Oppsett for OCR-tjeneste];
                                                                ApplicationArea=#Basic,#Suite;
                                                                RunObjectType=Page;
                                                                RunObjectID=1270;
                                                                Visible=Yes;
                                                                NextNodeID=[{4D3D68E9-6A4A-4F4A-8D33-747D76821EC8}];
                                                                DepartmentCategory=Administration }
    {                ;[{8A3934DD-BE0A-4851-B8E0-50A64106B98A}] ;NextNodeID=[{E0433AFB-5B38-4E2F-ADE7-0317B7ADE93D}] }
    { MenuItem       ;[{E0433AFB-5B38-4E2F-ADE7-0317B7ADE93D}] ;Name=Application Area;
                                                                CaptionML=[ENU=Application Area;
                                                                           NOR=Modul];
                                                                ApplicationArea=#All;
                                                                RunObjectType=Page;
                                                                RunObjectID=9179;
                                                                Visible=Yes;
                                                                NextNodeID=[{0D3D0EB4-59D7-4D3E-95AC-49CD269C6C04}];
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{0D3D0EB4-59D7-4D3E-95AC-49CD269C6C04}] ;Name=Data Migration Settings;
                                                                AccessByPermission=TableData 1806=R;
                                                                CaptionML=[ENU=Data Migration Settings;
                                                                           NOR=Innstillinger for datamigrering];
                                                                ApplicationArea=#Basic,#Suite;
                                                                RunObjectType=Page;
                                                                RunObjectID=1807;
                                                                Visible=Yes;
                                                                DepartmentCategory=Administration }
    { MenuItem       ;[{00646221-3EEF-4883-8640-FECFD9BEC705}] ;Name=Report Configuration;
                                                                AccessByPermission=TableData 2000000196=IMD;
                                                                CaptionML=[ENU=Report Settings;
                                                                           NOR=Rapportinnstillinger];
                                                                ApplicationArea=#Basic,#Suite;
                                                                RunObjectType=Page;
                                                                RunObjectID=1560;
                                                                Visible=Yes;
                                                                DepartmentCategory=Administration }
    { MenuItem       ;[{A1E3A413-B0C4-4D20-8B1F-AFF7DFFDB43C}] ;Name=Setup and Help Resources;
                                                                CaptionML=[ENU=Setup and Help Resources;
                                                                           NOR=Ressurser for oppsett og hjelp];
                                                                ApplicationArea=#Basic,#Suite;
                                                                RunObjectType=Page;
                                                                RunObjectID=1822;
                                                                Visible=Yes;
                                                                NextNodeID=[{4D3D68E9-6A4A-4F4A-8D33-747D76821EC8}];
                                                                DepartmentCategory=Administration }
    {                ;[{A07A2127-D15F-4AF6-8301-EC0DA819FAE6}] ;NextNodeID=[{FE934872-8126-4816-B5CD-E0EFB68C47E4}] }
  }
}
OBJECT Page 20 General Ledger Entries
{
  OBJECT-PROPERTIES
  {
    Date=20.02.17;
    Time=16:40:25;
    Modified=Yes;
    Version List=NAVW110.00.00.14199,CMP2.00;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=General Ledger Entries;
               NOR=Finansposter];
    SourceTable=Table17;
    DataCaptionExpr=GetCaption;
    SourceTableView=SORTING(G/L Account No.,Posting Date)
                    ORDER(Descending);
    PageType=List;
    OnOpenPage=BEGIN
                 IF FINDFIRST THEN;
               END;

    OnAfterGetCurrRecord=VAR
                           IncomingDocument@1000 : Record 130;
                         BEGIN
                           HasIncomingDocument := IncomingDocument.PostedDocExists("Document No.","Posting Date");
                           CurrPage.IncomingDocAttachFactBox.PAGE.LoadDataFromRecord(Rec);
                         END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 48      ;1   ;ActionGroup;
                      CaptionML=[ENU=Ent&ry;
                                 NOR=Po&st];
                      Image=Entry }
      { 49      ;2   ;Action    ;
                      AccessByPermission=TableData 348=R;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 NOR=Dimensjoner];
                      ToolTipML=[ENU=View or edits dimensions, such as area, project, or department, that you can assign to sales and purchase documents to distribute costs and analyze transaction history.;
                                 NOR=Vis eller rediger dimensjoner, for eksempel omr†de, prosjekt eller avdeling, som du kan tilordne til salgs- og kj›psdokumenter for † distribuere kostnader og analysere transaksjonshistorikk.];
                      ApplicationArea=#Suite;
                      Image=Dimensions;
                      Scope=Repeater;
                      OnAction=BEGIN
                                 ShowDimensions;
                                 CurrPage.SAVERECORD;
                               END;
                                }
      { 50      ;2   ;Action    ;
                      Name=GLDimensionOverview;
                      AccessByPermission=TableData 348=R;
                      CaptionML=[ENU=G/L Dimension Overview;
                                 NOR=Finansdimensjon - oversikt];
                      ToolTipML=[ENU=View an overview of general ledger entries and dimensions.;
                                 NOR=Vis en oversikt over finansposter og -dimensjoner.];
                      ApplicationArea=#Suite;
                      Image=Dimensions;
                      OnAction=VAR
                                 GLEntriesDimensionOverview@1000 : Page 563;
                               BEGIN
                                 IF ISTEMPORARY THEN BEGIN
                                   GLEntriesDimensionOverview.SetTempGLEntry(Rec);
                                   GLEntriesDimensionOverview.RUN;
                                 END ELSE
                                   PAGE.RUN(PAGE::"G/L Entries Dimension Overview",Rec);
                               END;
                                }
      { 65      ;2   ;Action    ;
                      AccessByPermission=TableData 27=R;
                      CaptionML=[ENU=Value Entries;
                                 NOR=Verdiposter];
                      ToolTipML=[ENU=View all amounts relating to an item.;
                                 NOR=Vis alle bel›p som er knyttet til en vare.];
                      ApplicationArea=#Basic,#Suite;
                      Image=ValueLedger;
                      Scope=Repeater;
                      OnAction=BEGIN
                                 ShowValueEntries;
                               END;
                                }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 57      ;1   ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 NOR=F&unksjoner];
                      Image=Action }
      { 63      ;2   ;Action    ;
                      Name=ReverseTransaction;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Reverse Transaction;
                                 NOR=Tilbakef›r transaksjon];
                      ToolTipML=[ENU=Reverse a posted general ledger entry.;
                                 NOR=Tilbakef›r en bokf›rt finanspost.];
                      ApplicationArea=#Basic,#Suite;
                      Image=ReverseRegister;
                      Scope=Repeater;
                      OnAction=VAR
                                 ReversalEntry@1000 : Record 179;
                               BEGIN
                                 CLEAR(ReversalEntry);
                                 IF Reversed THEN
                                   ReversalEntry.AlreadyReversedEntry(TABLECAPTION,"Entry No.");
                                 IF "Journal Batch Name" = '' THEN
                                   ReversalEntry.TestFieldError;
                                 TESTFIELD("Transaction No.");
                                 ReversalEntry.ReverseTransaction("Transaction No.")
                               END;
                                }
      { 15      ;2   ;ActionGroup;
                      Name=IncomingDocument;
                      CaptionML=[ENU=Incoming Document;
                                 NOR=Inng†ende dokument];
                      ActionContainerType=NewDocumentItems;
                      Image=Documents }
      { 13      ;3   ;Action    ;
                      Name=IncomingDocCard;
                      CaptionML=[ENU=View Incoming Document;
                                 NOR=Vis inng†ende dokument];
                      ToolTipML=[ENU=View any incoming document records and file attachments that exist for the entry or document.;
                                 NOR=Vis poster og filvedlegg for innkommende dokument som finnes for oppf›ringen eller dokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      Enabled=HasIncomingDocument;
                      Image=ViewOrder;
                      OnAction=VAR
                                 IncomingDocument@1000 : Record 130;
                               BEGIN
                                 IncomingDocument.ShowCard("Document No.","Posting Date");
                               END;
                                }
      { 9       ;3   ;Action    ;
                      Name=SelectIncomingDoc;
                      AccessByPermission=TableData 130=R;
                      CaptionML=[ENU=Select Incoming Document;
                                 NOR=Velg inng†ende dokument];
                      ToolTipML=[ENU=Select an incoming document record and file attachment that you want to link to the entry or document.;
                                 NOR=Velg en post og et filvedlegg for innkommende dokument som du vil koble til oppf›ringen eller dokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      Enabled=NOT HasIncomingDocument;
                      Image=SelectLineToApply;
                      OnAction=VAR
                                 IncomingDocument@1000 : Record 130;
                               BEGIN
                                 IncomingDocument.SelectIncomingDocumentForPostedDocument("Document No.","Posting Date",RECORDID);
                               END;
                                }
      { 3       ;3   ;Action    ;
                      Name=IncomingDocAttachFile;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Create Incoming Document from File;
                                 NOR=Opprett inng†ende dokument fra fil];
                      ToolTipML=[ENU=Create an incoming document record by selecting a file to attach, and then link the incoming document record to the entry or document.;
                                 NOR=Opprett en post for innkommende dokument ved † velge en fil som skal legges ved, og koble deretter posten for det innkommende dokumentet til oppf›ringen eller dokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      Enabled=NOT HasIncomingDocument;
                      Image=Attach;
                      OnAction=VAR
                                 IncomingDocumentAttachment@1000 : Record 133;
                               BEGIN
                                 IncomingDocumentAttachment.NewAttachmentFromPostedDocument("Document No.","Posting Date");
                               END;
                                }
      { 24      ;1   ;Action    ;
                      CaptionML=[ENU=&Navigate;
                                 NOR=&Naviger];
                      ToolTipML=[ENU=Find all entries and documents that exist for the document number and posting date on the selected entry or document.;
                                 NOR=Finn alle oppf›ringer og dokumenter som finnes for dokumentnummeret og bokf›ringsdatoen i den valgte oppf›ringen eller dokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Image=Navigate;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 Navigate@1000 : Page 344;
                               BEGIN
                                 Navigate.SetDoc("Posting Date","Document No.");
                                 Navigate.RUN;
                               END;
                                }
      { 11      ;1   ;Action    ;
                      Name=DocsWithoutIC;
                      CaptionML=[ENU=Posted Documents without Incoming Document;
                                 NOR=Bokf›rte dokumenter uten inng†ende dokument];
                      ToolTipML=[ENU=View posted purchase and sales documents under the G/L account that do not have related incoming document records.;
                                 NOR=Vis bokf›rte kj›ps- og salgsdokumenter under finanskontoen som ikke har relaterte poster for innkommende dokument.];
                      ApplicationArea=#Basic,#Suite;
                      Image=Documents;
                      OnAction=VAR
                                 PostedDocsWithNoIncBuf@1001 : Record 134;
                               BEGIN
                                 COPYFILTER("G/L Account No.",PostedDocsWithNoIncBuf."G/L Account No. Filter");
                                 PAGE.RUN(PAGE::"Posted Docs. With No Inc. Doc.",PostedDocsWithNoIncBuf);
                               END;
                                }
      { 1101103003;1 ;Action    ;
                      Name=Open Document in Compello;
                      CaptionML=[ENU=Open Document in Compello;
                                 NOR=pne Dokument i Compello];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Document;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 CompelloShowDoc@1101103000 : Codeunit 70006;
                               BEGIN
                                 CompelloShowDoc.ShowCompelloDocGeneralLedgerEntry(Rec);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the posting date for the entry.;
                           NOR=Angir postens bokf›ringsdato.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Posting Date" }

    { 4   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the Document Type that the entry belongs to.;
                           NOR=Angir dokumenttypen som posten tilh›rer.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Document Type" }

    { 6   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the entry's Document No.;
                           NOR=Angir postens dokumentnummer.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Document No." }

    { 8   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the account that the entry has been posted to.;
                           NOR=Angir nummeret for kontoen som posten er bokf›rt p†.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="G/L Account No." }

    { 40  ;2   ;Field     ;
                DrillDown=No;
                ToolTipML=[ENU=Specifies the name of the account that the entry has been posted to.;
                           NOR=Angir navnet p† kontoen som posten er bokf›rt p†.];
                SourceExpr="G/L Account Name";
                Visible=FALSE }

    { 10  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a description of the entry.;
                           NOR=Angir en beskrivelse av posten.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Description }

    { 26  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the Job No. corresponding the to G/L entry.;
                           NOR=Angir prosjektnummeret som svarer til finansposten.];
                SourceExpr="Job No.";
                Visible=FALSE }

    { 28  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the dimension value code that the entry is linked to.;
                           NOR=Angir dimensjonsverdikoden som posten er knyttet til.];
                SourceExpr="Global Dimension 1 Code";
                Visible=FALSE }

    { 30  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the dimension value code that the entry is linked to.;
                           NOR=Angir dimensjonsverdikoden som posten er knyttet til.];
                SourceExpr="Global Dimension 2 Code";
                Visible=FALSE }

    { 51  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code of the intercompany partner that the transaction is with if the entry was posted from an intercompany transaction.;
                           NOR=Angir koden for den konserninterne partneren som transaksjonen er med hvis posten ble bokf›rt fra en konsernintern transaksjon.];
                SourceExpr="IC Partner Code";
                Visible=FALSE }

    { 12  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the Gen. Posting Type that applies to the entry.;
                           NOR=Angir den generelle bokf›ringstypen som gjelder for posten.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Gen. Posting Type" }

    { 32  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the general business posting group that applies to the entry.;
                           NOR=Angir firmabokf›ringsgruppen som er knyttet til posten.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Gen. Bus. Posting Group" }

    { 14  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the general product posting group that applies to the entry.;
                           NOR=Angir den generelle varebokf›ringsgruppen som er knyttet til posten.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Gen. Prod. Posting Group" }

    { 1000000000;2;Field  ;
                SourceExpr="VAT Bus. Posting Group" }

    { 1000000001;2;Field  ;
                SourceExpr="VAT Prod. Posting Group" }

    { 1000000002;2;Field  ;
                SourceExpr="System-Created Entry" }

    { 5   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the quantity that was posted on the entry.;
                           NOR=Angir antallet som er bokf›rt i posten.];
                SourceExpr=Quantity;
                Visible=False }

    { 16  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the Amount of the entry.;
                           NOR=Angir bel›pet for posten.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Amount }

    { 54  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the general ledger entry that is posted if you post in an additional reporting currency.;
                           NOR=Angir finansposten som er bokf›rt hvis du bokf›rer til en tilleggsrapporteringsvaluta.];
                SourceExpr="Additional-Currency Amount";
                Visible=FALSE }

    { 36  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the VAT Amount that was posted as a result of the entry.;
                           NOR=Angir mva-bel›pet som ble bokf›rt som et resultat av posten.];
                SourceExpr="VAT Amount";
                Visible=FALSE }

    { 52  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the type of balancing account used in the entry: G/L Account, Bank Account, Vendor, Customer, or Fixed Asset.;
                           NOR=Angir hvilken type motkonto som er brukt i posten: Finanskonto, Bankkonto, Leverand›r, Kunde eller Aktiva.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Bal. Account Type" }

    { 18  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the G/L account or the bank account, that a balancing entry has been posted to.;
                           NOR=Angir nummeret for finanskontoen eller bankkontoen som en motpost m† bokf›res til.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Bal. Account No." }

    { 46  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the ID of the user that is associated with the entry.;
                           NOR=Angir ID-en for brukeren som er knyttet til posten.];
                SourceExpr="User ID";
                Visible=FALSE }

    { 42  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the Source Code that is linked to the entry.;
                           NOR=Angir kildekoden som er knyttet til posten.];
                SourceExpr="Source Code";
                Visible=FALSE }

    { 44  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the reason code on the entry.;
                           NOR=Angir †rsakskoden i posten.];
                SourceExpr="Reason Code";
                Visible=FALSE }

    { 58  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies if the entry has been part of a reverse transaction (correction) made by the Reverse function.;
                           NOR=Angir om posten har v‘rt del av en omvendt transaksjon (korrigering) som ble utf›rt med reverseringsfunksjonen.];
                SourceExpr=Reversed;
                Visible=FALSE }

    { 60  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the correcting entry. If the field Specifies a number, the entry cannot be reversed again.;
                           NOR=Angir nummeret p† den korrigerende posten. Hvis feltet angir et nummer, kan ikke posten reverseres p† nytt.];
                SourceExpr="Reversed by Entry No.";
                Visible=FALSE }

    { 62  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the original entry that was undone by the reverse transaction.;
                           NOR=Angir nummeret p† den opprinnelige posten som ble angret av tilbakef›ringstransaksjonen.];
                SourceExpr="Reversed Entry No.";
                Visible=FALSE }

    { 34  ;2   ;Field     ;
                ToolTipML=[ENU=This field is automatically updated.;
                           NOR=Dette feltet oppdateres automatisk.];
                SourceExpr="FA Entry Type";
                Visible=FALSE }

    { 38  ;2   ;Field     ;
                ToolTipML=[ENU=This field is automatically updated.;
                           NOR=Dette feltet oppdateres automatisk.];
                SourceExpr="FA Entry No.";
                Visible=FALSE }

    { 20  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the Entry No. that the program has given the entry.;
                           NOR=Angir l›penummeret som programmet har gitt posten.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Entry No." }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 7   ;1   ;Part      ;
                Name=IncomingDocAttachFactBox;
                ApplicationArea=#Basic,#Suite;
                PagePartID=Page193;
                PartType=Page;
                ShowFilter=No }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      GLAcc@1000 : Record 15;
      HasIncomingDocument@1001 : Boolean;

    LOCAL PROCEDURE GetCaption@2() : Text[250];
    BEGIN
      IF GLAcc."No." <> "G/L Account No." THEN
        IF NOT GLAcc.GET("G/L Account No.") THEN
          IF GETFILTER("G/L Account No.") <> '' THEN
            IF GLAcc.GET(GETRANGEMIN("G/L Account No.")) THEN;
      EXIT(STRSUBSTNO('%1 %2',GLAcc."No.",GLAcc.Name))
    END;

    BEGIN
    {
      +---------------------------------------------+
      | SI-Data                                     |
      +---------------------------------------------+
      No. Date     Id  Description
      //CMP2.0
        Menu item: "Show Compello Document" in Function button
      //CMP2.0
    }
    END.
  }
}

OBJECT Page 29 Vendor Ledger Entries
{
  OBJECT-PROPERTIES
  {
    Date=22.03.17;
    Time=14:02:26;
    Modified=Yes;
    Version List=NAVW110.00,NAVNO10.00,CMP2.00;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Vendor Ledger Entries;
               NOR=Leverand›rposter];
    InsertAllowed=No;
    DeleteAllowed=No;
    SourceTable=Table25;
    SourceTableView=SORTING(Entry No.)
                    ORDER(Descending);
    DataCaptionFields=Vendor No.;
    PageType=List;
    OnOpenPage=BEGIN
                 IF FINDFIRST THEN;
               END;

    OnAfterGetRecord=BEGIN
                       StyleTxt := SetStyle;
                     END;

    OnModifyRecord=BEGIN
                     CODEUNIT.RUN(CODEUNIT::"Vend. Entry-Edit",Rec);
                     EXIT(FALSE);
                   END;

    OnAfterGetCurrRecord=VAR
                           IncomingDocument@1000 : Record 130;
                         BEGIN
                           HasIncomingDocument := IncomingDocument.PostedDocExists("Document No.","Posting Date");
                           CurrPage.IncomingDocAttachFactBox.PAGE.LoadDataFromRecord(Rec);
                         END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 53      ;1   ;ActionGroup;
                      CaptionML=[ENU=Ent&ry;
                                 NOR=&Post];
                      Image=Entry }
      { 72      ;2   ;Action    ;
                      CaptionML=[ENU=Applied E&ntries;
                                 NOR=Utlignede p&oster];
                      ToolTipML=[ENU=View the ledger entries that have been applied to this record.;
                                 NOR=Vis postene som har blitt brukt for denne posten.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 62;
                      RunPageOnRec=Yes;
                      Image=Approve;
                      Scope=Repeater }
      { 55      ;2   ;Action    ;
                      AccessByPermission=TableData 348=R;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 NOR=Dimensjoner];
                      ToolTipML=[ENU=View or edits dimensions, such as area, project, or department, that you can assign to sales and purchase documents to distribute costs and analyze transaction history.;
                                 NOR=Vis eller rediger dimensjoner, for eksempel omr†de, prosjekt eller avdeling, som du kan tilordne til salgs- og kj›psdokumenter for † distribuere kostnader og analysere transaksjonshistorikk.];
                      ApplicationArea=#Suite;
                      Image=Dimensions;
                      Scope=Repeater;
                      OnAction=BEGIN
                                 ShowDimensions;
                               END;
                                }
      { 54      ;2   ;Action    ;
                      ShortCutKey=Ctrl+F7;
                      CaptionML=[ENU=Detailed &Ledger Entries;
                                 NOR=Deta&ljerte poster];
                      ToolTipML=[ENU=View a summary of the all posted entries and adjustments related to a specific vendor ledger entry;
                                 NOR=Vis et sammendrag av alle bokf›rte poster og justeringer som er knyttet til en bestemt leverand›rpost];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 574;
                      RunPageView=SORTING(Vendor Ledger Entry No.,Posting Date);
                      RunPageLink=Vendor Ledger Entry No.=FIELD(Entry No.),
                                  Vendor No.=FIELD(Vendor No.);
                      Image=View;
                      Scope=Repeater }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 34      ;1   ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 NOR=F&unksjoner];
                      Image=Action }
      { 36      ;2   ;Action    ;
                      Name=ActionApplyEntries;
                      ShortCutKey=Shift+F11;
                      CaptionML=[ENU=Apply Entries;
                                 NOR=Utlign poster];
                      ToolTipML=[ENU=Select one or more ledger entries that you want to apply this record to so that the related posted documents are closed as paid or refunded.;
                                 NOR=Velg ‚n eller flere poster du vil utligne mot denne posten slik at de relaterte bokf›rte dokumentene lukkes som betalte eller refunderte.];
                      ApplicationArea=#Basic,#Suite;
                      Image=ApplyEntries;
                      Scope=Repeater;
                      OnAction=VAR
                                 VendLedgEntry@1001 : Record 25;
                                 VendEntryApplyPostEntries@1000 : Codeunit 227;
                               BEGIN
                                 VendLedgEntry.COPY(Rec);
                                 VendEntryApplyPostEntries.ApplyVendEntryFormEntry(VendLedgEntry);
                                 Rec := VendLedgEntry;
                                 CurrPage.UPDATE;
                               END;
                                }
      { 66      ;2   ;Separator  }
      { 67      ;2   ;Action    ;
                      Name=UnapplyEntries;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Unapply Entries;
                                 NOR=Opphev utligning];
                      ToolTipML=[ENU=Unselect one or more ledger entries that you want to unapply this record.;
                                 NOR=Opphev merkingen av ‚n eller flere poster du vil oppheve utligningen av denne posten for.];
                      ApplicationArea=#Basic,#Suite;
                      Image=UnApply;
                      Scope=Repeater;
                      OnAction=VAR
                                 VendEntryApplyPostedEntries@1000 : Codeunit 227;
                               BEGIN
                                 VendEntryApplyPostedEntries.UnApplyVendLedgEntry("Entry No.");
                               END;
                                }
      { 68      ;2   ;Separator  }
      { 69      ;2   ;Action    ;
                      Name=ReverseTransaction;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Reverse Transaction;
                                 NOR=Tilbakef›r transaksjon];
                      ToolTipML=[ENU=Reverse an erroneous vendor ledger entry.;
                                 NOR=Tilbakef›r en leverand›rpost som inneholder feil.];
                      ApplicationArea=#Basic,#Suite;
                      Image=ReverseRegister;
                      Scope=Repeater;
                      OnAction=VAR
                                 ReversalEntry@1000 : Record 179;
                               BEGIN
                                 CLEAR(ReversalEntry);
                                 IF Reversed THEN
                                   ReversalEntry.AlreadyReversedEntry(TABLECAPTION,"Entry No.");
                                 IF "Journal Batch Name" = '' THEN
                                   ReversalEntry.TestFieldError;
                                 TESTFIELD("Transaction No.");
                                 ReversalEntry.ReverseTransaction("Transaction No.");
                               END;
                                }
      { 17      ;2   ;ActionGroup;
                      Name=IncomingDocument;
                      CaptionML=[ENU=Incoming Document;
                                 NOR=Inng†ende dokument];
                      ActionContainerType=NewDocumentItems;
                      Image=Documents }
      { 19      ;3   ;Action    ;
                      Name=IncomingDocCard;
                      CaptionML=[ENU=View Incoming Document;
                                 NOR=Vis inng†ende dokument];
                      ToolTipML=[ENU=View any incoming document records and file attachments that exist for the entry or document.;
                                 NOR=Vis poster og filvedlegg for innkommende dokument som finnes for oppf›ringen eller dokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      Enabled=HasIncomingDocument;
                      Image=ViewOrder;
                      OnAction=VAR
                                 IncomingDocument@1000 : Record 130;
                               BEGIN
                                 IncomingDocument.ShowCard("Document No.","Posting Date");
                               END;
                                }
      { 11      ;3   ;Action    ;
                      Name=SelectIncomingDoc;
                      AccessByPermission=TableData 130=R;
                      CaptionML=[ENU=Select Incoming Document;
                                 NOR=Velg inng†ende dokument];
                      ToolTipML=[ENU=Select an incoming document record and file attachment that you want to link to the entry or document.;
                                 NOR=Velg en post og et filvedlegg for innkommende dokument som du vil koble til oppf›ringen eller dokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      Enabled=NOT HasIncomingDocument;
                      Image=SelectLineToApply;
                      OnAction=VAR
                                 IncomingDocument@1000 : Record 130;
                               BEGIN
                                 IncomingDocument.SelectIncomingDocumentForPostedDocument("Document No.","Posting Date",RECORDID);
                               END;
                                }
      { 15      ;3   ;Action    ;
                      Name=IncomingDocAttachFile;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Create Incoming Document from File;
                                 NOR=Opprett inng†ende dokument fra fil];
                      ToolTipML=[ENU=Create an incoming document record by selecting a file to attach, and then link the incoming document record to the entry or document.;
                                 NOR=Opprett en post for innkommende dokument ved † velge en fil som skal legges ved, og koble deretter posten for det innkommende dokumentet til oppf›ringen eller dokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      Enabled=NOT HasIncomingDocument;
                      Image=Attach;
                      OnAction=VAR
                                 IncomingDocumentAttachment@1000 : Record 133;
                               BEGIN
                                 IncomingDocumentAttachment.NewAttachmentFromPostedDocument("Document No.","Posting Date");
                               END;
                                }
      { 37      ;1   ;Action    ;
                      CaptionML=[ENU=&Navigate;
                                 NOR=&Naviger];
                      ToolTipML=[ENU=Find all entries and documents that exist for the document number and posting date on the selected entry or document.;
                                 NOR=Finn alle oppf›ringer og dokumenter som finnes for dokumentnummeret og bokf›ringsdatoen i den valgte oppf›ringen eller dokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Image=Navigate;
                      PromotedCategory=Process;
                      Scope=Repeater;
                      OnAction=BEGIN
                                 Navigate.SetDoc("Posting Date","Document No.");
                                 Navigate.RUN;
                               END;
                                }
      { 13      ;1   ;Action    ;
                      ShortCutKey=Return;
                      CaptionML=[ENU=Show Posted Document;
                                 NOR=Vis bokf›rt dokument];
                      ToolTipML=[ENU=Show details for the posted payment, invoice, or credit memo.;
                                 NOR=Vis detaljer for den bokf›rte betalingen, fakturaen eller kreditnotaen.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Document;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 ShowDoc
                               END;
                                }
      { 1101103002;1 ;Action    ;
                      Name=Open Document in Compello;
                      CaptionML=[ENU=Open Document in Compello;
                                 NOR=pne Dokument i Compello];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Document;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 CompelloShowDoc@1101103000 : Codeunit 70006;
                               BEGIN
                                 CompelloShowDoc.CompelloShowDocVendorLedgerEntry(Rec);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the vendor entry's posting date.;
                           NOR=Angir leverand›rpostens bokf›ringsdato.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Posting Date";
                Editable=FALSE }

    { 4   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the document type that the vendor entry belongs to.;
                           NOR=Angir dokumenttypen som leverand›rposten tilh›rer.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Document Type";
                Editable=FALSE;
                StyleExpr=StyleTxt }

    { 6   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the vendor entry's document number.;
                           NOR=Angir leverand›rpostens dokumentnummer.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Document No.";
                Editable=FALSE;
                StyleExpr=StyleTxt }

    { 51  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the external document number that was entered on the purchase header or journal line.;
                           NOR=Angir eksterndokumentnummeret som er angitt i bestillingshodet eller p† kladdelinjen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="External Document No.";
                Editable=FALSE }

    { 8   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the vendor account that the entry is linked to.;
                           NOR=Angir nummeret p† leverand›rkontoen som er knyttet til posten.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Vendor No.";
                Editable=FALSE }

    { 1101103000;2;Field  ;
                SourceExpr="Vendor Name" }

    { 5   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the message exported to the payment file when you use the Export Payments to File function in the Payment Journal window.;
                           NOR=Angir meldingen som eksporteres til betalingsfilen n†r du bruker funksjonen Eksporter betalinger til fil i vinduet Betalingskladd.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Message to Recipient" }

    { 10  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a description of the vendor entry.;
                           NOR=Angir en beskrivelse av leverand›rposten.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Description;
                Editable=FALSE }

    { 39  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the dimension value code linked to the entry.;
                           NOR=Angir dimensjonsverdikoden som er knyttet til posten.];
                SourceExpr="Global Dimension 1 Code";
                Visible=FALSE;
                Editable=FALSE }

    { 41  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the dimension value code linked to the entry.;
                           NOR=Angir dimensjonsverdikoden som er knyttet til posten.];
                SourceExpr="Global Dimension 2 Code";
                Visible=FALSE;
                Editable=FALSE }

    { 70  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the customer's IC partner code, if the customer is one of your intercompany partners.;
                           NOR=Angir kundens KI-partnerkode hvis kunden er en av dine konserninterne partnere.];
                SourceExpr="IC Partner Code";
                Visible=FALSE;
                Editable=FALSE }

    { 43  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for the purchaser whom the entry is linked to.;
                           NOR=Angir koden for innkj›peren som posten er knyttet til.];
                SourceExpr="Purchaser Code";
                Visible=FALSE;
                Editable=FALSE }

    { 45  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the currency code for the amount on the line.;
                           NOR=Angir valutakoden for bel›pet p† linjen.];
                ApplicationArea=#Suite;
                SourceExpr="Currency Code";
                Editable=FALSE }

    { 100 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the payment method that was used to make the payment that resulted in the entry.;
                           NOR=Angir betalingsm†ten som ble brukt til † utf›re betalingen som resulterte i posten.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Payment Method Code" }

    { 110 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the payment of the purchase invoice.;
                           NOR=Angir betalingen for kj›psfakturaen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Payment Reference" }

    { 115 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the vendor who sent the purchase invoice.;
                           NOR=Angir leverand›ren som sendte kj›psfakturaen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Creditor No." }

    { 58  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the amount of the original entry.;
                           NOR=Angir bel›pet for den opprinnelige posten.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Original Amount";
                Editable=FALSE }

    { 56  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the amount that the entry originally consisted of, in LCY.;
                           NOR=Angir bel›pet som posten opprinnelig bestod av i NOK.];
                SourceExpr="Original Amt. (LCY)";
                Visible=FALSE;
                Editable=FALSE }

    { 12  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the amount of the entry.;
                           NOR=Angir bel›pet for posten.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Amount;
                Editable=FALSE }

    { 47  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the amount of the entry in LCY.;
                           NOR=Angir bel›pet for posten i NOK.];
                SourceExpr="Amount (LCY)";
                Visible=FALSE;
                Editable=FALSE }

    { 14  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the amount that remains to be applied to before the entry is totally applied to.;
                           NOR=Angir bel›pet som gjenst†r † bli utlignet, f›r posten utlignes helt.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Remaining Amount";
                Editable=FALSE }

    { 49  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the amount that remains to be applied to before the entry is totally applied to.;
                           NOR=Angir bel›pet som gjenst†r † bli utlignet, f›r posten utlignes helt.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Remaining Amt. (LCY)";
                Editable=FALSE }

    { 24  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the type of balancing account used on the entry.;
                           NOR=Angir hvilken type motkonto som er benyttet i posten.];
                SourceExpr="Bal. Account Type";
                Visible=FALSE;
                Editable=FALSE }

    { 26  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the balancing account number used on the entry.;
                           NOR=Angir motkontonummeret som er brukt i posten.];
                SourceExpr="Bal. Account No.";
                Visible=FALSE;
                Editable=FALSE }

    { 16  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the due date on the entry.;
                           NOR=Angir forfallsdatoen p† posten.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Due Date";
                StyleExpr=StyleTxt }

    { 18  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date on which the amount in the entry must be paid for a payment discount to be granted.;
                           NOR=Angir datoen da bel›pet i posten m† v‘re betalt for at det kan oppn†s kontantrabatt.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pmt. Discount Date" }

    { 62  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the latest date the amount in the entry must be paid in order for payment discount tolerance to be granted.;
                           NOR=Angir den seneste datoen da bel›pet i posten m† v‘re betalt for at det kan oppn†s kontantrabatt.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pmt. Disc. Tolerance Date" }

    { 20  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the discount that you can obtain if the entry is applied to before the payment discount date.;
                           NOR=Angir rabatten som du kan oppn† hvis posten blir utlignet f›r kontantrabattdatoen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Original Pmt. Disc. Possible" }

    { 60  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the remaining payment discount which can be received if the payment is made before the payment discount date.;
                           NOR=Angir resterende kontantrabatt som kan mottas hvis betalingen foretas f›r kontantrabattdatoen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Remaining Pmt. Disc. Possible" }

    { 64  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the maximum tolerated amount the entry can differ from the amount on the invoice or credit memo.;
                           NOR=Angir det maksimalt tillatte bel›pet som posten kan avvike fra bel›pet p† fakturaen eller kreditnotaen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Max. Payment Tolerance" }

    { 28  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies whether the amount on the entry has been fully paid or there is still a remaining amount that must be applied to.;
                           NOR=Angir om posten er helt utlignet, eller om det stadig gjenst†r † utligne et bel›p.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Open;
                Editable=FALSE }

    { 22  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies when a vendor ledger has been invoiced and you run the Suggest Vendor Payments batch job.;
                           NOR=Angir n†r en leverand›rpost er fakturert og du starter kj›rselen Betalingsforslag - leverand›r.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="On Hold" }

    { 1080004;2;Field     ;
                ToolTipML=[ENU=Specifies the Kunde ID (KID) associated with the vendor ledger entry.;
                           NOR=Angir kunde-ID-en (KID) som er knyttet til leverand›rposten.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=KID }

    { 77  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the ID of the user associated with the entry.;
                           NOR=Angir ID-en til brukeren som er knyttet til posten.];
                SourceExpr="User ID";
                Visible=FALSE;
                Editable=FALSE }

    { 1080006;2;Field     ;
                ToolTipML=[ENU=Specifies a unique ID for the remittance.;
                           NOR=Angir en unik ID for remitteringen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Remittance ID" }

    { 79  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the source code that is linked to the entry.;
                           NOR=Angir kildekoden som er knyttet til posten.];
                SourceExpr="Source Code";
                Visible=FALSE;
                Editable=FALSE }

    { 81  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the reason code on the entry.;
                           NOR=Angir †rsakskoden i posten.];
                SourceExpr="Reason Code";
                Visible=FALSE;
                Editable=FALSE }

    { 35  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies if the entry has been part of a reverse transaction.;
                           NOR=Angir om posten har v‘rt del av en tilbakef›ringstransaksjon.];
                SourceExpr=Reversed;
                Visible=FALSE }

    { 74  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the correcting entry that replaced the original entry in the reverse transaction.;
                           NOR=Angir nummeret p† den korrigerende posten som erstattet den opprinnelige posten i tilbakef›ringstransaksjonen.];
                SourceExpr="Reversed by Entry No.";
                Visible=FALSE }

    { 76  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the original entry that was undone by the reverse transaction.;
                           NOR=Angir nummeret p† den opprinnelige posten som ble angret av tilbakef›ringstransaksjonen.];
                SourceExpr="Reversed Entry No.";
                Visible=FALSE }

    { 30  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the entry number that is assigned to the entry.;
                           NOR=Angir oppf›ringsnummeret som er knyttet til posten.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Entry No.";
                Editable=FALSE }

    { 290 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies that the entry was created as a result of exporting a payment journal line.;
                           NOR=Angir at posten ble opprettet som et resultat av eksport av en utbetalingskladdelinje.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Exported to Payment File" }

    { 1080008;2;Field     ;
                ToolTipML=[ENU=Specifies a two-digit code for the payment type.;
                           NOR=Angir en tosifret kode for betalingstypen.];
                SourceExpr="Payment Type Code Abroad";
                Visible=FALSE }

    { 1080010;2;Field     ;
                ToolTipML=[ENU=Specifies information for your local government bank.;
                           NOR=Angir informasjon for sentralbanken i landet.];
                SourceExpr="Specification (Norges Bank)";
                Visible=FALSE }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 3   ;1   ;Part      ;
                Name=IncomingDocAttachFactBox;
                ApplicationArea=#Basic,#Suite;
                PagePartID=Page193;
                PartType=Page;
                ShowFilter=No }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      Navigate@1000 : Page 344;
      StyleTxt@1001 : Text;
      HasIncomingDocument@1002 : Boolean;

    BEGIN
    {
      ----------------------------------------------
      SI-DATA AS
      ----------------------------------------------
      No  Date      ID      Description
      ----------------------------------------------
      CMP2.0
           PageAction: ShowCompelloDocument
      CMP2.0

      SID.01 :: Show field : Vendor Name
    }
    END.
  }
}

OBJECT Page 51 Purchase Invoice
{
  OBJECT-PROPERTIES
  {
    Date=01.10.16;
    Time=11:00:00;
    Modified=Yes;
    Version List=NAVW110.00.00.15140,NAVNO10.00.00.15140,CMP2.00;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Purchase Invoice;
               NOR=Kj›psfaktura];
    SourceTable=Table38;
    SourceTableView=WHERE(Document Type=FILTER(Invoice));
    PageType=Document;
    RefreshOnActivate=Yes;
    PromotedActionCategoriesML=[ENU=New,Process,Report,Approve,Invoice,Posting,View,Request Approval,Incoming Document;
                                NOR=Ny,Behandle,Rapportere,Godkjenne,Faktura,Bokf›ring,Visning,Be om godkjenning,Inng†ende dokument];
    OnInit=VAR
             PurchasesPayablesSetup@1001 : Record 312;
           BEGIN
             SetExtDocNoMandatoryCondition;
             JobQueuesUsed := PurchasesPayablesSetup."Post & Print with Job Queue";
           END;

    OnOpenPage=VAR
                 OfficeMgt@1000 : Codeunit 1630;
               BEGIN
                 SetDocNoVisible;
                 IsOfficeAddin := OfficeMgt.IsAvailable;
                 CreateIncomingDocFromEmailAttachment := OfficeMgt.OCRAvailable;
                 CreateIncomingDocumentVisible := NOT OfficeMgt.IsOutlookMobileApp;

                 IF UserMgt.GetPurchasesFilter <> '' THEN BEGIN
                   FILTERGROUP(2);
                   SETRANGE("Responsibility Center",UserMgt.GetPurchasesFilter);
                   FILTERGROUP(0);
                 END;
               END;

    OnNewRecord=BEGIN
                  "Responsibility Center" := UserMgt.GetPurchasesFilter;

                  IF (NOT DocNoVisible) AND ("No." = '') THEN
                    SetBuyFromVendorFromFilter;
                END;

    OnDeleteRecord=BEGIN
                     CurrPage.SAVERECORD;
                     EXIT(ConfirmDeletion);
                   END;

    OnQueryClosePage=BEGIN
                       IF NOT DocumentIsPosted THEN
                         EXIT(ConfirmCloseUnposted);
                     END;

    OnAfterGetCurrRecord=BEGIN
                           CurrPage.IncomingDocAttachFactBox.PAGE.LoadDataFromRecord(Rec);
                           CurrPage.ApprovalFactBox.PAGE.UpdateApprovalEntriesFromSourceRecord(RECORDID);
                           ShowWorkflowStatus := CurrPage.WorkflowStatus.PAGE.SetFilterOnWorkflowRecord(RECORDID);
                           SetControlAppearance;
                         END;

    ActionList=ACTIONS
    {
      { 1900000003;  ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 55      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Invoice;
                                 NOR=&Faktura];
                      Image=Invoice }
      { 57      ;2   ;Action    ;
                      Name=Statistics;
                      ShortCutKey=F7;
                      CaptionML=[ENU=Statistics;
                                 NOR=Statistikk];
                      Promoted=Yes;
                      Image=Statistics;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CalcInvDiscForHeader;
                                 COMMIT;
                                 PAGE.RUNMODAL(PAGE::"Purchase Statistics",Rec);
                                 PurchCalcDiscByType.ResetRecalculateInvoiceDisc(Rec);
                               END;
                                }
      { 58      ;2   ;Action    ;
                      ShortCutKey=Shift+F7;
                      CaptionML=[ENU=Vendor;
                                 NOR=Leverand›r];
                      ToolTipML=[ENU=View or edit detailed information about the vendor on the purchase document.;
                                 NOR=Vis eller rediger detaljert informasjon om leverand›ren i kj›psdokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 26;
                      RunPageLink=No.=FIELD(Buy-from Vendor No.);
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Vendor;
                      PromotedCategory=Category5;
                      PromotedOnly=Yes }
      { 59      ;2   ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 NOR=&Merknader];
                      RunObject=Page 66;
                      RunPageLink=Document Type=FIELD(Document Type),
                                  No.=FIELD(No.),
                                  Document Line No.=CONST(0);
                      Image=ViewComments }
      { 113     ;2   ;Action    ;
                      Name=Dimensions;
                      AccessByPermission=TableData 348=R;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 NOR=Dimensjoner];
                      ToolTipML=[ENU=View or edits dimensions, such as area, project, or department, that you can assign to sales and purchase documents to distribute costs and analyze transaction history.;
                                 NOR=Vis eller rediger dimensjoner, for eksempel omr†de, prosjekt eller avdeling, som du kan tilordne til salgs- og kj›psdokumenter for † distribuere kostnader og analysere transaksjonshistorikk.];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      Enabled="No." <> '';
                      PromotedIsBig=Yes;
                      Image=Dimensions;
                      PromotedCategory=Category5;
                      PromotedOnly=Yes;
                      OnAction=BEGIN
                                 ShowDocDim;
                                 CurrPage.SAVERECORD;
                               END;
                                }
      { 41      ;2   ;ActionGroup;
                      Name=IncomingDocument;
                      CaptionML=[ENU=Incoming Document;
                                 NOR=Inng†ende dokument];
                      Visible=FALSE }
      { 39      ;3   ;Action    ;
                      Name=IncomingDocCard;
                      CaptionML=[ENU=View;
                                 NOR=Vis];
                      ToolTipML=[ENU=View any incoming document records and file attachments that exist for the entry or document.;
                                 NOR=Vis poster og filvedlegg for innkommende dokument som finnes for oppf›ringen eller dokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Enabled=HasIncomingDocument;
                      PromotedIsBig=Yes;
                      Image=ViewOrder;
                      PromotedCategory=Category9;
                      PromotedOnly=Yes;
                      OnAction=VAR
                                 IncomingDocument@1000 : Record 130;
                               BEGIN
                                 IncomingDocument.ShowCardFromEntryNo("Incoming Document Entry No.");
                               END;
                                }
      { 37      ;3   ;Action    ;
                      Name=SelectIncomingDoc;
                      AccessByPermission=TableData 130=R;
                      CaptionML=[ENU=Select;
                                 NOR=Velg];
                      ToolTipML=[ENU=Select an incoming document record and file attachment that you want to link to the entry or document.;
                                 NOR=Velg en post og et filvedlegg for innkommende dokument som du vil koble til oppf›ringen eller dokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=SelectLineToApply;
                      PromotedCategory=Category9;
                      PromotedOnly=Yes;
                      OnAction=VAR
                                 IncomingDocument@1000 : Record 130;
                               BEGIN
                                 VALIDATE("Incoming Document Entry No.",IncomingDocument.SelectIncomingDocument("Incoming Document Entry No.",RECORDID));
                               END;
                                }
      { 35      ;3   ;Action    ;
                      Name=IncomingDocAttachFile;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Create from File;
                                 NOR=Opprett fra fil];
                      ToolTipML=[ENU=Create an incoming document record by selecting a file to attach, and then link the incoming document record to the entry or document.;
                                 NOR=Opprett en post for innkommende dokument ved † velge en fil som skal legges ved, og koble deretter posten for det innkommende dokumentet til oppf›ringen eller dokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Visible=CreateIncomingDocumentVisible;
                      Enabled=CreateIncomingDocumentEnabled;
                      PromotedIsBig=Yes;
                      Image=Attach;
                      PromotedCategory=Category9;
                      PromotedOnly=Yes;
                      OnAction=VAR
                                 IncomingDocumentAttachment@1000 : Record 133;
                               BEGIN
                                 IncomingDocumentAttachment.NewAttachmentFromPurchaseDocument(Rec);
                               END;
                                }
      { 16      ;3   ;Action    ;
                      Name=IncomingDocEmailAttachment;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Create from Attachment;
                                 NOR=Opprett fra vedlegg];
                      ToolTipML=[ENU=Create an incoming document record by selecting an attachment from outlook email, and then link the incoming document record to the entry or document.;
                                 NOR=Opprett en post for innkommende dokument ved † velge et vedlegg fra en e-postmelding i Outlook, og koble deretter posten for det innkommende dokumentet til oppf›ringen eller dokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Visible=CreateIncomingDocFromEmailAttachment;
                      Enabled=IncomingDocEmailAttachmentEnabled;
                      PromotedIsBig=Yes;
                      Image=SendElectronicDocument;
                      PromotedCategory=Category9;
                      PromotedOnly=Yes;
                      OnAction=VAR
                                 OfficeMgt@1001 : Codeunit 1630;
                               BEGIN
                                 IF NOT INSERT(TRUE) THEN
                                   MODIFY(TRUE);
                                 OfficeMgt.InitiateSendToIncomingDocumentsWithPurchaseHeaderLink(Rec,"Buy-from Vendor No.");
                               END;
                                }
      { 29      ;3   ;Action    ;
                      Name=RemoveIncomingDoc;
                      CaptionML=[ENU=Remove;
                                 NOR=Fjern];
                      ToolTipML=[ENU=Remove an external document that has been recorded, manually or automatically, and attached as a file to a document or ledger entry.;
                                 NOR=Fjern et eksternt dokument som er registrert manuelt eller automatisk, og knyttet som en fil til et dokument eller en post.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Enabled=HasIncomingDocument;
                      PromotedIsBig=Yes;
                      Image=RemoveLine;
                      PromotedCategory=Category9;
                      PromotedOnly=Yes;
                      OnAction=VAR
                                 IncomingDocument@1000 : Record 130;
                               BEGIN
                                 IF IncomingDocument.GET("Incoming Document Entry No.") THEN
                                   IncomingDocument.RemoveLinkToRelatedRecord;
                                 "Incoming Document Entry No." := 0;
                                 MODIFY(TRUE);
                               END;
                                }
      { 25      ;1   ;ActionGroup;
                      CaptionML=[ENU=Approval;
                                 NOR=Godkjenning] }
      { 23      ;2   ;Action    ;
                      Name=Approve;
                      CaptionML=[ENU=Approve;
                                 NOR=Godkjenn];
                      ToolTipML=[ENU=Approve the requested changes.;
                                 NOR=Godkjenn de forespurte endringene.];
                      ApplicationArea=#All;
                      Promoted=Yes;
                      Visible=OpenApprovalEntriesExistForCurrUser;
                      PromotedIsBig=Yes;
                      Image=Approve;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.ApproveRecordApprovalRequest(RECORDID)
                               END;
                                }
      { 21      ;2   ;Action    ;
                      Name=Reject;
                      CaptionML=[ENU=Reject;
                                 NOR=Avvis];
                      ToolTipML=[ENU=Reject the approval request.;
                                 NOR=Avvis godkjenningsforesp›rselen.];
                      ApplicationArea=#All;
                      Promoted=Yes;
                      Visible=OpenApprovalEntriesExistForCurrUser;
                      PromotedIsBig=Yes;
                      Image=Reject;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.RejectRecordApprovalRequest(RECORDID)
                               END;
                                }
      { 19      ;2   ;Action    ;
                      Name=Delegate;
                      CaptionML=[ENU=Delegate;
                                 NOR=Deleger];
                      ToolTipML=[ENU=Delegate the approval to a substitute approver.;
                                 NOR=Deleger godkjenningen til en stedfortredende godkjenner.];
                      ApplicationArea=#All;
                      Promoted=Yes;
                      Visible=OpenApprovalEntriesExistForCurrUser;
                      Image=Delegate;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.DelegateRecordApprovalRequest(RECORDID)
                               END;
                                }
      { 13      ;2   ;Action    ;
                      Name=Comment;
                      CaptionML=[ENU=Comments;
                                 NOR=Merknader];
                      ToolTipML=[ENU=View or add comments.;
                                 NOR=Vis eller legg til merknader.];
                      ApplicationArea=#All;
                      Promoted=Yes;
                      Visible=OpenApprovalEntriesExistForCurrUser;
                      Image=ViewComments;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.GetApprovalComment(Rec);
                               END;
                                }
      { 9       ;1   ;ActionGroup;
                      CaptionML=[ENU=Release;
                                 NOR=Frigi];
                      Image=Release }
      { 120     ;2   ;Action    ;
                      ShortCutKey=Ctrl+F9;
                      CaptionML=[ENU=Re&lease;
                                 NOR=&Frigi];
                      Promoted=Yes;
                      Image=ReleaseDoc;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ReleasePurchDoc@1000 : Codeunit 415;
                               BEGIN
                                 ReleasePurchDoc.PerformManualRelease(Rec);
                               END;
                                }
      { 121     ;2   ;Action    ;
                      Name=Reopen;
                      CaptionML=[ENU=Re&open;
                                 NOR=pne p† &nytt];
                      ToolTipML=[ENU=Reopen the document to change it after it has been approved. Approved documents have the Released status and must be opened before they can be changed.;
                                 NOR=pne dokumentet p† nytt for † endre det etter at det har blitt godkjent. Godkjente dokumenter har statusen Frigitt, og de m† †pnes f›r de kan endres.];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      Enabled=Status <> Status::Open;
                      PromotedIsBig=Yes;
                      Image=ReOpen;
                      PromotedCategory=Process;
                      PromotedOnly=Yes;
                      OnAction=VAR
                                 ReleasePurchDoc@1001 : Codeunit 415;
                               BEGIN
                                 ReleasePurchDoc.PerformManualReopen(Rec);
                               END;
                                }
      { 1101103005;2 ;Action    ;
                      Name=Open Document in Compello;
                      CaptionML=[ENU=Open Document in Compello;
                                 NOR=pne Dokument i Compello];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Document;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 CompelloShowDoc@1101103000 : Codeunit 70006;
                               BEGIN
                                 CompelloShowDoc.ShowCompelloDocPurchaseHeader(Rec);
                               END;
                                }
      { 60      ;1   ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 NOR=F&unksjoner];
                      Image=Action }
      { 4       ;2   ;Action    ;
                      Name=GetRecurringPurchaseLines;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Get Recurring Purchase Lines;
                                 NOR=Hent gjentakende bestillingslinjer];
                      ToolTipML=[ENU=Insert purchase document lines that you have set up for the vendor as recurring. Recurring purchase lines could be for a monthly replenishment order or a fixed freight expense.;
                                 NOR=Sett inn kj›psdokumentlinjer du har definert som gjentakende for leverand›ren. Gjentakende kj›pslinjer kan brukes for en m†nedlig etterfyllingsordre eller en fast fraktutgift.];
                      ApplicationArea=#Suite;
                      PromotedIsBig=Yes;
                      Image=VendorCode;
                      OnAction=VAR
                                 StdVendPurchCode@1000 : Record 175;
                               BEGIN
                                 StdVendPurchCode.InsertPurchLines(Rec);
                               END;
                                }
      { 63      ;2   ;Action    ;
                      Name=CopyDocument;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Copy Document;
                                 NOR=Kopier dokument];
                      ToolTipML=[ENU=Copy document lines and header information from another purchase document to this document. You can copy a posted purchase invoice into a new purchase invoice to quickly create a similar document.;
                                 NOR=Kopier dokumentlinjer og hodeopplysninger fra et annet kj›psdokument til dette dokumentet. Du kan kopiere en bokf›rt kj›psfaktura til en ny kj›psfaktura for † opprette et lignende dokument raskt.];
                      ApplicationArea=#Suite;
                      PromotedIsBig=Yes;
                      Image=CopyDocument;
                      OnAction=BEGIN
                                 CopyPurchDoc.SetPurchHeader(Rec);
                                 CopyPurchDoc.RUNMODAL;
                                 CLEAR(CopyPurchDoc);
                               END;
                                }
      { 61      ;2   ;Action    ;
                      Name=CalculateInvoiceDiscount;
                      AccessByPermission=TableData 24=R;
                      CaptionML=[ENU=Calculate &Invoice Discount;
                                 NOR=Beregn &fakturarabatt];
                      ToolTipML=[ENU=Calculate the invoice discount for the entire purchase invoice.;
                                 NOR=Beregn fakturarabatten for hele kj›psfakturaen.];
                      ApplicationArea=#Basic,#Suite;
                      Image=CalculateInvoiceDiscount;
                      OnAction=BEGIN
                                 ApproveCalcInvDisc;
                                 PurchCalcDiscByType.ResetRecalculateInvoiceDisc(Rec);
                               END;
                                }
      { 136     ;2   ;Separator  }
      { 62      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Copy Document;
                                 NOR=Kopier dokument];
                      Image=CopyDocument;
                      OnAction=BEGIN
                                 CopyPurchDoc.SetPurchHeader(Rec);
                                 CopyPurchDoc.RUNMODAL;
                                 CLEAR(CopyPurchDoc);
                                 IF GET("Document Type","No.") THEN;
                               END;
                                }
      { 137     ;2   ;Separator  }
      { 112     ;2   ;Action    ;
                      Name=MoveNegativeLines;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Move Negative Lines;
                                 NOR=Flytt negative linjer];
                      Image=MoveNegativeLines;
                      OnAction=BEGIN
                                 CLEAR(MoveNegPurchLines);
                                 MoveNegPurchLines.SetPurchHeader(Rec);
                                 MoveNegPurchLines.RUNMODAL;
                                 MoveNegPurchLines.ShowDocument;
                               END;
                                }
      { 47      ;1   ;ActionGroup;
                      CaptionML=[ENU=Request Approval;
                                 NOR=Be om godkjenning] }
      { 45      ;2   ;Action    ;
                      Name=Approvals;
                      AccessByPermission=TableData 454=R;
                      CaptionML=[ENU=Approvals;
                                 NOR=Godkjenninger];
                      ToolTipML=[ENU=View a list of the records that are waiting to be approved. For example, you can see who requested the record to be approved, when it was sent, and when it is due to be approved.;
                                 NOR=Vis en liste med poster dom venter p† † bli godkjent. Du kan for eksempel se hvem som har bedt om godkjenning av posten, n†r den ble sendt og n†r den forfaller til godkjenning.];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Approvals;
                      PromotedCategory=Category8;
                      PromotedOnly=Yes;
                      OnAction=VAR
                                 ApprovalEntries@1001 : Page 658;
                               BEGIN
                                 ApprovalEntries.Setfilters(DATABASE::"Purchase Header","Document Type","No.");
                                 ApprovalEntries.RUN;
                               END;
                                }
      { 142     ;2   ;Action    ;
                      Name=SendApprovalRequest;
                      CaptionML=[ENU=Send A&pproval Request;
                                 NOR=&Send godkjenningsforesp›rsel];
                      ToolTipML=[ENU=Send an approval request.;
                                 NOR=Send en godkjenningsforesp›rsel.];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      Enabled=NOT OpenApprovalEntriesExist;
                      PromotedIsBig=Yes;
                      Image=SendApprovalRequest;
                      PromotedCategory=Category8;
                      PromotedOnly=Yes;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 IF ApprovalsMgmt.CheckPurchaseApprovalPossible(Rec) THEN
                                   ApprovalsMgmt.OnSendPurchaseDocForApproval(Rec);
                               END;
                                }
      { 143     ;2   ;Action    ;
                      Name=CancelApprovalRequest;
                      CaptionML=[ENU=Cancel Approval Re&quest;
                                 NOR=&Annuller godkjenningsforesp›rsel];
                      ToolTipML=[ENU=Cancel the approval request.;
                                 NOR=Annuller godkjenningsforesp›rselen.];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      Enabled=CanCancelApprovalForRecord;
                      PromotedIsBig=Yes;
                      Image=CancelApprovalRequest;
                      PromotedCategory=Category8;
                      PromotedOnly=Yes;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.OnCancelPurchaseApprovalRequest(Rec);
                               END;
                                }
      { 66      ;1   ;ActionGroup;
                      CaptionML=[ENU=P&osting;
                                 NOR=B&okf›ring];
                      Image=Post }
      { 68      ;2   ;Action    ;
                      Name=Post;
                      ShortCutKey=F9;
                      CaptionML=[ENU=P&ost;
                                 NOR=B&okf›r];
                      ToolTipML=[ENU=Finalize the document or journal by posting the amounts and quantities to the related accounts in your company books.;
                                 NOR=Fullf›r dokumentet eller kladden ved † bokf›re bel›pene og antallene til de relaterte kontoene i selskapstabl†ene.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PostOrder;
                      PromotedCategory=Process;
                      PromotedOnly=Yes;
                      OnAction=BEGIN
                                 VerifyTotal;
                                 Post(CODEUNIT::"Purch.-Post (Yes/No)");
                               END;
                                }
      { 33      ;2   ;Action    ;
                      Name=Preview;
                      CaptionML=[ENU=Preview Posting;
                                 NOR=Forh†ndsvis bokf›ring];
                      ToolTipML=[ENU=Review the different types of entries that will be created when you post the document or journal.;
                                 NOR=Se gjennom de ulike typene poster som blir opprettet n†r du bokf›rer dokumentet eller kladden.];
                      ApplicationArea=#Basic,#Suite;
                      Image=ViewPostedOrder;
                      OnAction=VAR
                                 PurchPostYesNo@1000 : Codeunit 91;
                               BEGIN
                                 PurchPostYesNo.Preview(Rec);
                               END;
                                }
      { 67      ;2   ;Action    ;
                      Name=TestReport;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Test Report;
                                 NOR=Kontrollrapport];
                      ToolTipML=[ENU=View a test report so that you can find and correct any errors before you perform the actual posting of the journal or document.;
                                 NOR=Vis en kontrollrapport slik at du kan finne og rette eventuelle feil f›r du bokf›rer kladden eller dokumentet.];
                      Image=TestReport;
                      OnAction=BEGIN
                                 ReportPrint.PrintPurchHeader(Rec);
                               END;
                                }
      { 69      ;2   ;Action    ;
                      Name=PostAndPrint;
                      ShortCutKey=Shift+F9;
                      CaptionML=[ENU=Post and &Print;
                                 NOR=Bokf›r og &skriv ut];
                      Promoted=Yes;
                      Visible=NOT IsOfficeAddin;
                      PromotedIsBig=Yes;
                      Image=PostPrint;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 VerifyTotal;
                                 Post(CODEUNIT::"Purch.-Post + Print");
                               END;
                                }
      { 70      ;2   ;Action    ;
                      Name=PostBatch;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Post &Batch;
                                 NOR=&Massebokf›r];
                      Image=PostBatch;
                      OnAction=BEGIN
                                 VerifyTotal;
                                 REPORT.RUNMODAL(REPORT::"Batch Post Purchase Invoices",TRUE,TRUE,Rec);
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 7       ;2   ;Action    ;
                      Name=RemoveFromJobQueue;
                      CaptionML=[ENU=Remove From Job Queue;
                                 NOR=Fjern fra jobbk›];
                      ToolTipML=[ENU=Remove the scheduled processing of this record from the job queue.;
                                 NOR=Fjern den planlagte behandlingen av denne posten fra prosjektk›en.];
                      ApplicationArea=#All;
                      Visible="Job Queue Status" = "Job Queue Status"::"Scheduled For Posting";
                      Image=RemoveLine;
                      OnAction=BEGIN
                                 CancelBackgroundPosting;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=[ENU=General;
                           NOR=Generelt] }

    { 2   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the purchase document. The field is only visible if you have not set up a number series for the type of purchase document, or if the Manual Nos. field is selected for the number series.;
                           NOR=Angir nummeret for kj›psdokumentet. Feltet vises bare hvis du ikke har konfigurert en nummerserie for typen kj›psdokument, eller hvis feltet Manuelle nr. er valgt for nummerserien.];
                ApplicationArea=#All;
                SourceExpr="No.";
                Importance=Additional;
                Visible=DocNoVisible;
                OnAssistEdit=BEGIN
                               IF AssistEdit(xRec) THEN
                                 CurrPage.UPDATE;
                             END;
                              }

    { 6   ;2   ;Field     ;
                CaptionML=[ENU=Vendor;
                           NOR=Leverand›r];
                ToolTipML=[ENU=Specifies the name of the vendor who sends the items. The field is filled automatically when you fill the Buy-from Vendor No. field.;
                           NOR=Angir navnet p† leverand›ren som sender varene. Feltet fylles ut automatisk n†r du fyller ut feltet Kj›p fra-leverand›rnr.];
                ApplicationArea=#All;
                NotBlank=Yes;
                SourceExpr="Buy-from Vendor Name";
                Importance=Promoted;
                OnValidate=VAR
                             ApplicationAreaSetup@1000 : Record 9178;
                           BEGIN
                             IF GETFILTER("Buy-from Vendor No.") = xRec."Buy-from Vendor No." THEN
                               IF "Buy-from Vendor No." <> xRec."Buy-from Vendor No." THEN
                                 SETRANGE("Buy-from Vendor No.");

                             IF ApplicationAreaSetup.IsFoundationEnabled THEN
                               PurchCalcDiscByType.ApplyDefaultInvoiceDiscount(0,Rec);

                             CurrPage.UPDATE;
                           END;

                ShowMandatory=TRUE }

    { 51  ;2   ;Group     ;
                CaptionML=[ENU=Buy-from;
                           NOR=Kj›p fra];
                GroupType=Group }

    { 72  ;3   ;Field     ;
                CaptionML=[ENU=Address;
                           NOR=Adresse];
                ToolTipML=[ENU=Specifies the address of the vendor who ships the items.;
                           NOR=Angir adressen til leverand›ren som leverer varene.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Buy-from Address";
                Importance=Additional }

    { 74  ;3   ;Field     ;
                CaptionML=[ENU=Address 2;
                           NOR=Adresse 2];
                ToolTipML=[ENU=Specifies additional address information.;
                           NOR=Angir ekstra adresseinformasjon.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Buy-from Address 2";
                Importance=Additional }

    { 77  ;3   ;Field     ;
                CaptionML=[ENU=Post Code;
                           NOR=Postnr.];
                ToolTipML=[ENU=Specifies the postal code.;
                           NOR=Angir postnummeret.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Buy-from Post Code";
                Importance=Additional }

    { 76  ;3   ;Field     ;
                CaptionML=[ENU=City;
                           NOR=Sted];
                ToolTipML=[ENU=Specifies the city of the vendor who ships the items.;
                           NOR=Angir poststedet til leverand›ren som leverer varene.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Buy-from City";
                Importance=Additional }

    { 128 ;3   ;Field     ;
                CaptionML=[ENU=Contact No.;
                           NOR=Kontaktnr.];
                ToolTipML=[ENU=Specifies the number of your contact at the vendor.;
                           NOR=Angir nummeret for kontakten hos leverand›ren.];
                SourceExpr="Buy-from Contact No.";
                Importance=Additional }

    { 8   ;2   ;Field     ;
                CaptionML=[ENU=Contact;
                           NOR=Kontakt];
                ToolTipML=[ENU=Specifies the name of the person to contact about shipment of the item from this vendor.;
                           NOR=Angir navnet p† kontaktpersonen som kan kontaktes ang†ende varelevering fra denne leverand›ren.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Buy-from Contact" }

    { 43  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date on which the vendor created the purchase document.;
                           NOR=Angir datoen da leverand›ren opprettet kj›psdokumentet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Document Date";
                Importance=Additional }

    { 12  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date when the posting of the purchase document will be recorded.;
                           NOR=Angir datoen n†r bokf›ringen av kj›psdokumentet blir registrert.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Posting Date";
                Importance=Promoted }

    { 30  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies when the invoice is due. The program calculates the date using the Payment Terms Code and Document Date fields.;
                           NOR=Angir n†r fakturaen forfaller. Programmet beregner datoen ved hjelp av feltet Betalingsbet.kode og Dokumentdato.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Due Date";
                Importance=Promoted }

    { 11  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the incoming document that this purchase document is created for.;
                           NOR=Angir nummeret p† det innkommende dokumentet som dette kj›psdokumentet er opprettet for.];
                SourceExpr="Incoming Document Entry No.";
                Importance=Additional;
                Visible=FALSE }

    { 14  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number that the vendor uses on the invoice that they sent to you.;
                           NOR=Angir nummeret som leverand›ren bruker p† fakturaen de sendte deg.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Vendor Invoice No.";
                ShowMandatory=VendorInvoiceNoMandatory }

    { 10  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies which purchaser is assigned to the vendor.;
                           NOR=Angir hvilken innkj›per som er knyttet til leverand›ren.];
                ApplicationArea=#Suite;
                SourceExpr="Purchaser Code";
                Importance=Additional;
                OnValidate=BEGIN
                             PurchaserCodeOnAfterValidate;
                           END;
                            }

    { 1102601000;2;Field  ;
                ToolTipML=[ENU=Specifies the campaign number the document is linked to.;
                           NOR=Angir kampanjenummeret som dokumentet er koblet til.];
                SourceExpr="Campaign No.";
                Importance=Additional }

    { 115 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code of the responsibility center that is associated with the user, company, or vendor.;
                           NOR=Angir koden for ansvarssentret som er knyttet til brukeren, selskapet eller leverand›ren.];
                SourceExpr="Responsibility Center";
                Importance=Additional }

    { 65  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the ID of the user who is responsible for the document.;
                           NOR=Angir ID-en til brukeren som er ansvarlig for dokumentet.];
                SourceExpr="Assigned User ID";
                Importance=Additional }

    { 118 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies whether the record is open, waiting to be approved, invoiced for prepayment, or released to the next stage of processing.;
                           NOR=Angir om posten er †pen, om den venter p† godkjenning, om den er fakturert for forskudd eller om den er frigitt til neste fase i behandlingen.];
                SourceExpr=Status;
                Importance=Promoted }

    { 5   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the status of a job queue entry that handles the posting of purchase orders.;
                           NOR=Angir status for en jobbk›post som h†ndterer bokf›ring av bestillinger.];
                ApplicationArea=#All;
                SourceExpr="Job Queue Status";
                Importance=Additional;
                Visible=JobQueuesUsed }

    { 54  ;1   ;Part      ;
                Name=PurchLines;
                ApplicationArea=#Basic,#Suite;
                SubPageLink=Document No.=FIELD(No.);
                PagePartID=Page55;
                Enabled="Buy-from Vendor No." <> '';
                Editable="Buy-from Vendor No." <> '';
                UpdatePropagation=Both }

    { 1905885101;1;Group  ;
                CaptionML=[ENU=Invoice Details;
                           NOR=Fakturadetaljer];
                GroupType=Group }

    { 104 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the currency code for amounts on the purchase lines.;
                           NOR=Angir valutakoden for bel›pet p† kj›pslinjene.];
                ApplicationArea=#Suite;
                SourceExpr="Currency Code";
                Importance=Promoted;
                OnValidate=BEGIN
                             CurrPage.UPDATE;
                             PurchCalcDiscByType.ApplyDefaultInvoiceDiscount(0,Rec);
                           END;

                OnAssistEdit=BEGIN
                               CLEAR(ChangeExchangeRate);
                               IF "Posting Date" <> 0D THEN
                                 ChangeExchangeRate.SetParameter("Currency Code","Currency Factor","Posting Date")
                               ELSE
                                 ChangeExchangeRate.SetParameter("Currency Code","Currency Factor",WORKDATE);
                               IF ChangeExchangeRate.RUNMODAL = ACTION::OK THEN BEGIN
                                 VALIDATE("Currency Factor",ChangeExchangeRate.GetParameter);
                                 CurrPage.UPDATE;
                               END;
                               CLEAR(ChangeExchangeRate);
                             END;
                              }

    { 48  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date you expect to receive the items on the purchase document.;
                           NOR=Angir datoen du forventer † motta varer, p† kj›psdokumentet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Expected Receipt Date";
                Importance=Promoted }

    { 108 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies whether the unit price on the line should be displayed including or excluding VAT.;
                           NOR=Angir om salgsprisen p† linjen skal vises inklusiv eller eksklusiv mva.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Prices Including VAT";
                OnValidate=BEGIN
                             PricesIncludingVATOnAfterValid;
                           END;
                            }

    { 138 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the vendor's VAT specification to link transactions made for this vendor with the appropriate general ledger account according to the VAT posting setup.;
                           NOR=Angir leverand›rens mva-spesifikasjon for † koble transaksjoner gjort for denne leverand›ren, med riktig finanskonto i henhold til det generelle mva-bokf›ringsoppsettet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="VAT Bus. Posting Group";
                OnValidate=VAR
                             ApplicationAreaSetup@1000 : Record 9178;
                           BEGIN
                             CurrPage.UPDATE;

                             IF ApplicationAreaSetup.IsFoundationEnabled THEN
                               PurchCalcDiscByType.ApplyDefaultInvoiceDiscount(0,Rec);
                           END;
                            }

    { 28  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a formula that calculates the payment due date, payment discount date, and payment discount amount on the purchase document.;
                           NOR=Angir en formel som beregner forfallsdatoen for betalingen, kontantrabattdatoen og kontantrabattbel›pet, p† kj›psdokumentet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Payment Terms Code";
                Importance=Promoted }

    { 102 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies how payment for the purchase document must be submitted, such as bank transfer or check.;
                           NOR=Angir hvordan betaling for kj›psdokumentet m† sendes, for eksempel bankoverf›ring eller sjekk.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Payment Method Code";
                Importance=Additional }

    { 50  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number for the transaction type, for the purpose of reporting to INTRASTAT.;
                           NOR=Angir nummeret for transaksjonstypen for rapportering til INTRASTAT.];
                SourceExpr="Transaction Type" }

    { 85  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the dimension value code associated with the purchase header.;
                           NOR=Angir dimensjonsverdikoden som er knyttet til kj›pshodet.];
                SourceExpr="Shortcut Dimension 1 Code";
                OnValidate=BEGIN
                             ShortcutDimension1CodeOnAfterV;
                           END;
                            }

    { 87  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the dimension value code associated with the purchase header.;
                           NOR=Angir dimensjonsverdikoden som er knyttet til kj›pshodet.];
                SourceExpr="Shortcut Dimension 2 Code";
                OnValidate=BEGIN
                             ShortcutDimension2CodeOnAfterV;
                           END;
                            }

    { 32  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the payment discount percent granted if payment is made on or before the date in the Pmt. Discount Date field.;
                           NOR=Angir kontantrabattprosenten som gis hvis betaling utf›res innen datoen i feltet Kont.rabattdato.];
                SourceExpr="Payment Discount %" }

    { 34  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the last date on which you can pay the invoice and still receive a payment discount.;
                           NOR=Angir siste betalingsfrist for fakturaen, hvis det skal oppn†s kontantrabatt.];
                SourceExpr="Pmt. Discount Date";
                Importance=Additional }

    { 89  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a code for the location where you want the items to be placed when they are received.;
                           NOR=Angir en kode for lokasjonen der du vil at de bestilte varene skal plasseres.];
                SourceExpr="Location Code";
                Importance=Additional }

    { 46  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code that represents the shipment method for this purchase.;
                           NOR=Angir koden for leveringsm†ten som gjelder for kj›pet.];
                SourceExpr="Shipment Method Code";
                Importance=Additional }

    { 17  ;2   ;Field     ;
                ToolTipML=[ENU=Identifies the payment of the purchase invoice.;
                           NOR=Identifiserer betalingen for kj›psfakturaen.];
                SourceExpr="Payment Reference";
                Importance=Additional }

    { 15  ;2   ;Field     ;
                ToolTipML=[ENU=Identifies the vendor who sent the purchase invoice.;
                           NOR=Identifiserer leverand›ren som sendte kj›psfakturaen.];
                SourceExpr="Creditor No.";
                Importance=Additional }

    { 91  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies if the posted invoice will be included in the payment suggestion.;
                           NOR=Angir om den bokf›rte fakturaen skal tas med i betalingsforslaget.];
                SourceExpr="On Hold";
                Importance=Additional }

    { 1906801201;1;Group  ;
                CaptionML=[ENU=Shipping and Payment;
                           NOR=Levering og betaling];
                GroupType=Group }

    { 53  ;2   ;Group     ;
                CaptionML=[ENU=Ship-to;
                           NOR=Lever til];
                GroupType=Group }

    { 81  ;3   ;Field     ;
                CaptionML=[ENU=Code;
                           NOR=Kode];
                ToolTipML=[ENU=Specifies the order address code linked to the relevant vendor's order address.;
                           NOR=Angir bestillingsadressekoden som er knyttet til den relevante leverand›rens bestillingsadresse.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Order Address Code";
                Importance=Additional }

    { 36  ;3   ;Field     ;
                CaptionML=[ENU=Name;
                           NOR=Navn];
                ToolTipML=[ENU=Specifies the name of the company at the address to which you want the items in the purchase order to be shipped.;
                           NOR=Angir navnet p† selskapet med adressen som du vil at varene i bestillingen skal leveres til.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Name";
                Importance=Additional }

    { 38  ;3   ;Field     ;
                CaptionML=[ENU=Address;
                           NOR=Adresse];
                ToolTipML=[ENU=Specifies the address that you want the items in the purchase order to be shipped to.;
                           NOR=Angir adressen du vil at varene i bestillingen skal leveres til.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Address";
                Importance=Additional }

    { 40  ;3   ;Field     ;
                CaptionML=[ENU=Address 2;
                           NOR=Adresse 2];
                ToolTipML=[ENU=Specifies additional address information.;
                           NOR=Angir ekstra adresseinformasjon.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Address 2";
                Importance=Additional }

    { 94  ;3   ;Field     ;
                CaptionML=[ENU=Post Code;
                           NOR=Postnr.];
                ToolTipML=[ENU=Specifies the postal code.;
                           NOR=Angir postnummeret.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Post Code";
                Importance=Additional }

    { 42  ;3   ;Field     ;
                CaptionML=[ENU=City;
                           NOR=Sted];
                ToolTipML=[ENU=Specifies the city the items in the purchase order will be shipped to.;
                           NOR=Angir poststedet du vil at varene i bestillingen skal leveres til.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to City";
                Importance=Additional }

    { 44  ;3   ;Field     ;
                CaptionML=[ENU=Contact;
                           NOR=Kontakt];
                ToolTipML=[ENU=Specifies the name of a contact person for the address where the items in the purchase order should be shipped.;
                           NOR=Angir navnet p† kontaktpersonen med adressen som varene i bestillingen skal leveres til.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Contact";
                Importance=Additional }

    { 56  ;2   ;Group     ;
                CaptionML=[ENU=Pay-to;
                           NOR=Betal til];
                GroupType=Group }

    { 18  ;3   ;Field     ;
                CaptionML=[ENU=Name;
                           NOR=Navn];
                ToolTipML=[ENU=Specifies the name of the vendor sending the invoice.;
                           NOR=Angir navnet p† leverand›ren som sender fakturaen.];
                ApplicationArea=#Basic,#Suite;
                NotBlank=Yes;
                SourceExpr="Pay-to Name";
                Importance=Promoted;
                OnValidate=VAR
                             ApplicationAreaSetup@1000 : Record 9178;
                           BEGIN
                             IF GETFILTER("Pay-to Vendor No.") = xRec."Pay-to Vendor No." THEN
                               IF "Pay-to Vendor No." <> xRec."Pay-to Vendor No." THEN
                                 SETRANGE("Pay-to Vendor No.");

                             IF ApplicationAreaSetup.IsFoundationEnabled THEN
                               PurchCalcDiscByType.ApplyDefaultInvoiceDiscount(0,Rec);

                             CurrPage.UPDATE;
                           END;
                            }

    { 20  ;3   ;Field     ;
                CaptionML=[ENU=Address;
                           NOR=Adresse];
                ToolTipML=[ENU=Specifies the address of the vendor sending the invoice.;
                           NOR=Angir adressen til leverand›ren som sender fakturaen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pay-to Address";
                Importance=Additional }

    { 22  ;3   ;Field     ;
                CaptionML=[ENU=Address 2;
                           NOR=Adresse 2];
                ToolTipML=[ENU=Specifies additional address information.;
                           NOR=Angir ekstra adresseinformasjon.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pay-to Address 2";
                Importance=Additional }

    { 82  ;3   ;Field     ;
                CaptionML=[ENU=Post Code;
                           NOR=Postnr.];
                ToolTipML=[ENU=Specifies the postal code.;
                           NOR=Angir postnummeret.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pay-to Post Code";
                Importance=Additional }

    { 24  ;3   ;Field     ;
                CaptionML=[ENU=City;
                           NOR=Sted];
                ToolTipML=[ENU=Specifies the city of the vendor sending the invoice.;
                           NOR=Angir poststedet for leverand›ren som sender fakturaen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pay-to City";
                Importance=Additional }

    { 130 ;3   ;Field     ;
                CaptionML=[ENU=Contact No.;
                           NOR=Kontaktnr.];
                ToolTipML=[ENU=Specifies the number of the contact who sends the invoice.;
                           NOR=Angir nummeret til kontakten som sender fakturaen.];
                SourceExpr="Pay-to Contact No.";
                Importance=Additional }

    { 26  ;3   ;Field     ;
                CaptionML=[ENU=Contact;
                           NOR=Kontakt];
                ToolTipML=[ENU=Specifies the name of the person to contact about an invoice from this vendor.;
                           NOR=Angir navnet p† den personen som skal kontaktes hvis det oppst†r sp›rsm†l til en faktura fra denne leverand›ren.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pay-to Contact";
                Importance=Additional }

    { 1080000;2;Field     ;
                ToolTipML=[ENU=Specifies the Kunde ID (KID) associated with purchase header.;
                           NOR=Angir kunde-ID-en (KID) som er knyttet til bestillingshodet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=KID }

    { 1907468901;1;Group  ;
                CaptionML=[ENU=Foreign Trade;
                           NOR=Utenrikshandel] }

    { 100 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a code for the purchase header's transaction specification here.;
                           NOR=Angir en kode for transaksjonsspesifikasjonen i bestillingshodet.];
                SourceExpr="Transaction Specification" }

    { 52  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for the transport method to be used with this purchase header.;
                           NOR=Angir koden for transportm†ten som skal brukes med dette bestillingshodet.];
                SourceExpr="Transport Method" }

    { 96  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code of the port of entry where the items pass into your country/region.;
                           NOR=Angir koden for innf›rselsstedet der varene kommer inn i landet/regionen.];
                SourceExpr="Entry Point" }

    { 98  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for the area of the vendor's address.;
                           NOR=Angir koden for omr†det for leverand›rens adresse.];
                SourceExpr=Area }

    { 1080002;2;Field     ;
                ToolTipML=[ENU=Specifies a two-digit code for the payment type.;
                           NOR=Angir en tosifret kode for betalingstypen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Payment Type Code Abroad" }

    { 1080004;2;Field     ;
                ToolTipML=[ENU=Specifies information for your local government bank. Contact your bank for additional information.;
                           NOR=Angir informasjon for sentralbanken i landet. Kontakt banken din for mer informasjon.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Specification (Norges Bank)" }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 27  ;1   ;Part      ;
                ApplicationArea=#All;
                SubPageLink=Table ID=CONST(38),
                            Document Type=FIELD(Document Type),
                            Document No.=FIELD(No.);
                PagePartID=Page9103;
                Visible=OpenApprovalEntriesExistForCurrUser;
                PartType=Page }

    { 1906354007;1;Part   ;
                Name=ApprovalFactBox;
                PagePartID=Page9092;
                Visible=FALSE;
                PartType=Page }

    { 1901138007;1;Part   ;
                SubPageLink=No.=FIELD(Buy-from Vendor No.);
                PagePartID=Page9093;
                Visible=FALSE;
                PartType=Page }

    { 31  ;1   ;Part      ;
                Name=IncomingDocAttachFactBox;
                ApplicationArea=#Basic,#Suite;
                PagePartID=Page193;
                Visible=NOT IsOfficeAddin;
                PartType=Page;
                ShowFilter=No }

    { 1904651607;1;Part   ;
                SubPageLink=No.=FIELD(Pay-to Vendor No.);
                PagePartID=Page9094;
                PartType=Page }

    { 1903435607;1;Part   ;
                SubPageLink=No.=FIELD(Buy-from Vendor No.);
                PagePartID=Page9095;
                Visible=FALSE;
                PartType=Page }

    { 1906949207;1;Part   ;
                SubPageLink=No.=FIELD(Pay-to Vendor No.);
                PagePartID=Page9096;
                Visible=FALSE;
                PartType=Page }

    { 3   ;1   ;Part      ;
                SubPageLink=Document Type=FIELD(Document Type),
                            Document No.=FIELD(Document No.),
                            Line No.=FIELD(Line No.);
                PagePartID=Page9100;
                ProviderID=54;
                Visible=FALSE;
                PartType=Page }

    { 49  ;1   ;Part      ;
                Name=WorkflowStatus;
                ApplicationArea=#All;
                PagePartID=Page1528;
                Visible=ShowWorkflowStatus;
                Enabled=FALSE;
                Editable=FALSE;
                PartType=Page;
                ShowFilter=No }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      DummyApplicationAreaSetup@1027 : Record 9178;
      CopyPurchDoc@1002 : Report 492;
      MoveNegPurchLines@1005 : Report 6698;
      ReportPrint@1003 : Codeunit 228;
      UserMgt@1004 : Codeunit 5700;
      PurchCalcDiscByType@1007 : Codeunit 66;
      OfficeMgt@1022 : Codeunit 1630;
      ChangeExchangeRate@1001 : Page 511;
      HasIncomingDocument@1010 : Boolean;
      DocNoVisible@1006 : Boolean;
      VendorInvoiceNoMandatory@1008 : Boolean;
      OpenApprovalEntriesExist@1009 : Boolean;
      OpenApprovalEntriesExistForCurrUser@1000 : Boolean;
      ShowWorkflowStatus@1011 : Boolean;
      JobQueuesUsed@1014 : Boolean;
      OpenPostedPurchaseInvQst@1015 : TextConst 'ENU=The invoice has been posted and moved to the Posted Purchase Invoices window.\\Do you want to open the posted invoice?;NOR=Fakturaen er bokf›rt og flyttet til vinduet Bokf›rte kj›psfakturaer.\\Vil du †pne den bokf›rte fakturaen?';
      IsOfficeAddin@1017 : Boolean;
      CanCancelApprovalForRecord@1013 : Boolean;
      DocumentIsPosted@1012 : Boolean;
      CreateIncomingDocumentEnabled@1016 : Boolean;
      CreateIncomingDocumentVisible@1021 : Boolean;
      CreateIncomingDocFromEmailAttachment@1018 : Boolean;
      TotalsMismatchErr@1019 : TextConst 'ENU=The invoice cannot be posted because the total is different from the total on the related incoming document.;NOR=Fakturaen kan ikke bokf›res fordi summen er forskjellig fra summen p† det relaterte innkommende dokumentet.';
      IncomingDocEmailAttachmentEnabled@1020 : Boolean;

    PROCEDURE LineModified@7();
    BEGIN
    END;

    LOCAL PROCEDURE Post@4(PostingCodeunitID@1000 : Integer);
    VAR
      PurchaseHeader@1002 : Record 38;
      PurchInvHeader@1003 : Record 122;
      LinesInstructionMgt@1001 : Codeunit 1320;
      InstructionMgt@1004 : Codeunit 1330;
    BEGIN
      IF DummyApplicationAreaSetup.IsFoundationEnabled THEN
        LinesInstructionMgt.PurchaseCheckAllLinesHaveQuantityAssigned(Rec);

      SendToPosting(PostingCodeunitID);

      DocumentIsPosted := NOT PurchaseHeader.GET("Document Type","No.");

      IF "Job Queue Status" = "Job Queue Status"::"Scheduled for Posting" THEN
        CurrPage.CLOSE;
      CurrPage.UPDATE(FALSE);

      IF PostingCodeunitID <> CODEUNIT::"Purch.-Post (Yes/No)" THEN
        EXIT;

      IF IsOfficeAddin THEN BEGIN
        PurchInvHeader.SETRANGE("Pre-Assigned No.","No.");
        PurchInvHeader.SETRANGE("Order No.",'');
        IF PurchInvHeader.FINDFIRST THEN
          PAGE.RUN(PAGE::"Posted Purchase Invoice",PurchInvHeader);
      END ELSE
        IF InstructionMgt.IsEnabled(InstructionMgt.ShowPostedConfirmationMessageCode) THEN
          ShowPostedConfirmationMessage;
    END;

    LOCAL PROCEDURE VerifyTotal@22();
    BEGIN
      IF NOT IsTotalValid THEN
        ERROR(TotalsMismatchErr);
    END;

    LOCAL PROCEDURE ApproveCalcInvDisc@1();
    BEGIN
      CurrPage.PurchLines.PAGE.ApproveCalcInvDisc;
    END;

    LOCAL PROCEDURE PurchaserCodeOnAfterValidate@19046120();
    BEGIN
      CurrPage.PurchLines.PAGE.UpdateForm(TRUE);
    END;

    LOCAL PROCEDURE ShortcutDimension1CodeOnAfterV@19029405();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE ShortcutDimension2CodeOnAfterV@19008725();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE PricesIncludingVATOnAfterValid@19009096();
    BEGIN
      CurrPage.UPDATE;
      CALCFIELDS("Invoice Discount Amount");
    END;

    LOCAL PROCEDURE SetDocNoVisible@2();
    VAR
      DocumentNoVisibility@1000 : Codeunit 1400;
      DocType@1003 : 'Quote,Order,Invoice,Credit Memo,Blanket Order,Return Order,Reminder,FinChMemo';
    BEGIN
      DocNoVisible := DocumentNoVisibility.PurchaseDocumentNoIsVisible(DocType::Invoice,"No.");
    END;

    LOCAL PROCEDURE SetExtDocNoMandatoryCondition@3();
    VAR
      PurchasesPayablesSetup@1000 : Record 312;
    BEGIN
      PurchasesPayablesSetup.GET;
      VendorInvoiceNoMandatory := PurchasesPayablesSetup."Ext. Doc. No. Mandatory"
    END;

    LOCAL PROCEDURE SetControlAppearance@5();
    VAR
      ApprovalsMgmt@1002 : Codeunit 1535;
    BEGIN
      HasIncomingDocument := "Incoming Document Entry No." <> 0;
      CreateIncomingDocumentEnabled := (NOT HasIncomingDocument) AND ("No." <> '');
      SetExtDocNoMandatoryCondition;

      IncomingDocEmailAttachmentEnabled := OfficeMgt.EmailHasAttachments;
      OpenApprovalEntriesExistForCurrUser := ApprovalsMgmt.HasOpenApprovalEntriesForCurrentUser(RECORDID);
      OpenApprovalEntriesExist := ApprovalsMgmt.HasOpenApprovalEntries(RECORDID);

      CanCancelApprovalForRecord := ApprovalsMgmt.CanCancelApprovalForRecord(RECORDID);
    END;

    LOCAL PROCEDURE ShowPostedConfirmationMessage@13();
    VAR
      PurchInvHeader@1000 : Record 122;
      InstructionMgt@1001 : Codeunit 1330;
    BEGIN
      PurchInvHeader.SETRANGE("Pre-Assigned No.","No.");
      PurchInvHeader.SETRANGE("Order No.",'');
      IF PurchInvHeader.FINDFIRST THEN
        IF InstructionMgt.ShowConfirm(OpenPostedPurchaseInvQst,InstructionMgt.ShowPostedConfirmationMessageCode) THEN
          PAGE.RUN(PAGE::"Posted Purchase Invoice",PurchInvHeader);
    END;

    BEGIN
    {
      ----------------------------------------------
      SI-DATA AS
      ----------------------------------------------
      No  Date      ID      Description
      ----------------------------------------------
      CMP2.0
        New Menu Item / Functions: "Show Compello Document"
      CMP2.0
    }
    END.
  }
}

OBJECT Page 52 Purchase Credit Memo
{
  OBJECT-PROPERTIES
  {
    Date=01.10.16;
    Time=11:00:00;
    Modified=Yes;
    Version List=NAVW110.00.00.15140,CMP2.00;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Purchase Credit Memo;
               NOR=Kj›pskreditnota];
    SourceTable=Table38;
    SourceTableView=WHERE(Document Type=FILTER(Credit Memo));
    PageType=Document;
    RefreshOnActivate=Yes;
    PromotedActionCategoriesML=[ENU=New,Process,Report,Approve,Request Approval;
                                NOR=Ny,Prosess,Rapport,Godkjenn,Foresp›rselsgodkjenning];
    OnInit=BEGIN
             SetExtDocNoMandatoryCondition;
           END;

    OnOpenPage=VAR
                 OfficeMgt@1000 : Codeunit 1630;
               BEGIN
                 SetDocNoVisible;
                 IsOfficeAddin := OfficeMgt.IsAvailable;

                 IF UserMgt.GetPurchasesFilter <> '' THEN BEGIN
                   FILTERGROUP(2);
                   SETRANGE("Responsibility Center",UserMgt.GetPurchasesFilter);
                   FILTERGROUP(0);
                 END;
               END;

    OnNewRecord=BEGIN
                  "Responsibility Center" := UserMgt.GetPurchasesFilter;

                  IF (NOT DocNoVisible) AND ("No." = '') THEN
                    SetBuyFromVendorFromFilter;
                END;

    OnDeleteRecord=BEGIN
                     CurrPage.SAVERECORD;
                     EXIT(ConfirmDeletion);
                   END;

    OnQueryClosePage=BEGIN
                       IF NOT DocumentIsPosted THEN
                         EXIT(ConfirmCloseUnposted);
                     END;

    OnAfterGetCurrRecord=BEGIN
                           SetControlAppearance;
                           CurrPage.IncomingDocAttachFactBox.PAGE.LoadDataFromRecord(Rec);
                           CurrPage.ApprovalFactBox.PAGE.UpdateApprovalEntriesFromSourceRecord(RECORDID);
                           ShowWorkflowStatus := CurrPage.WorkflowStatus.PAGE.SetFilterOnWorkflowRecord(RECORDID);
                         END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 47      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Credit Memo;
                                 NOR=&Kreditnota];
                      Image=CreditMemo }
      { 49      ;2   ;Action    ;
                      Name=Statistics;
                      ShortCutKey=F7;
                      CaptionML=[ENU=Statistics;
                                 NOR=Statistikk];
                      Promoted=Yes;
                      Image=Statistics;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CalcInvDiscForHeader;
                                 COMMIT;
                                 PAGE.RUNMODAL(PAGE::"Purchase Statistics",Rec);
                                 PurchCalcDiscByType.ResetRecalculateInvoiceDisc(Rec);
                               END;
                                }
      { 50      ;2   ;Action    ;
                      ShortCutKey=Shift+F7;
                      CaptionML=[ENU=Vendor;
                                 NOR=Leverand›r];
                      ToolTipML=[ENU=View or edit detailed information about the vendor on the purchase document.;
                                 NOR=Vis eller rediger detaljert informasjon om leverand›ren i kj›psdokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 26;
                      RunPageLink=No.=FIELD(Buy-from Vendor No.);
                      Image=Vendor }
      { 105     ;2   ;Action    ;
                      AccessByPermission=TableData 348=R;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 NOR=Dimensjoner];
                      ToolTipML=[ENU=View or edits dimensions, such as area, project, or department, that you can assign to sales and purchase documents to distribute costs and analyze transaction history.;
                                 NOR=Vis eller rediger dimensjoner, for eksempel omr†de, prosjekt eller avdeling, som du kan tilordne til salgs- og kj›psdokumenter for † distribuere kostnader og analysere transaksjonshistorikk.];
                      ApplicationArea=#Suite;
                      Enabled="No." <> '';
                      Image=Dimensions;
                      OnAction=BEGIN
                                 ShowDocDim;
                                 CurrPage.SAVERECORD;
                               END;
                                }
      { 43      ;2   ;Action    ;
                      Name=Approvals;
                      AccessByPermission=TableData 454=R;
                      CaptionML=[ENU=Approvals;
                                 NOR=Godkjenninger];
                      ToolTipML=[ENU=View a list of the records that are waiting to be approved. For example, you can see who requested the record to be approved, when it was sent, and when it is due to be approved.;
                                 NOR=Vis en liste med poster dom venter p† † bli godkjent. Du kan for eksempel se hvem som har bedt om godkjenning av posten, n†r den ble sendt og n†r den forfaller til godkjenning.];
                      ApplicationArea=#Suite;
                      Image=Approvals;
                      OnAction=VAR
                                 ApprovalEntries@1001 : Page 658;
                               BEGIN
                                 ApprovalEntries.Setfilters(DATABASE::"Purchase Header","Document Type","No.");
                                 ApprovalEntries.RUN;
                               END;
                                }
      { 51      ;2   ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 NOR=&Merknader];
                      RunObject=Page 66;
                      RunPageLink=Document Type=FIELD(Document Type),
                                  No.=FIELD(No.),
                                  Document Line No.=CONST(0);
                      Image=ViewComments }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 23      ;1   ;ActionGroup;
                      CaptionML=[ENU=Approval;
                                 NOR=Godkjenning] }
      { 25      ;2   ;Action    ;
                      Name=Approve;
                      CaptionML=[ENU=Approve;
                                 NOR=Godkjenn];
                      ToolTipML=[ENU=Approve the requested changes.;
                                 NOR=Godkjenn de forespurte endringene.];
                      ApplicationArea=#All;
                      Promoted=Yes;
                      Visible=OpenApprovalEntriesExistForCurrUser;
                      PromotedIsBig=Yes;
                      Image=Approve;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.ApproveRecordApprovalRequest(RECORDID);
                               END;
                                }
      { 19      ;2   ;Action    ;
                      Name=Reject;
                      CaptionML=[ENU=Reject;
                                 NOR=Avvis];
                      ToolTipML=[ENU=Reject the approval request.;
                                 NOR=Avvis godkjenningsforesp›rselen.];
                      ApplicationArea=#All;
                      Promoted=Yes;
                      Visible=OpenApprovalEntriesExistForCurrUser;
                      PromotedIsBig=Yes;
                      Image=Reject;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.RejectRecordApprovalRequest(RECORDID);
                               END;
                                }
      { 21      ;2   ;Action    ;
                      Name=Delegate;
                      CaptionML=[ENU=Delegate;
                                 NOR=Deleger];
                      ToolTipML=[ENU=Delegate the approval to a substitute approver.;
                                 NOR=Deleger godkjenningen til en stedfortredende godkjenner.];
                      ApplicationArea=#All;
                      Promoted=Yes;
                      Visible=OpenApprovalEntriesExistForCurrUser;
                      Image=Delegate;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.DelegateRecordApprovalRequest(RECORDID);
                               END;
                                }
      { 17      ;2   ;Action    ;
                      Name=Comment;
                      CaptionML=[ENU=Comments;
                                 NOR=Merknader];
                      ToolTipML=[ENU=View or add comments.;
                                 NOR=Vis eller legg til merknader.];
                      ApplicationArea=#All;
                      Promoted=Yes;
                      Visible=OpenApprovalEntriesExistForCurrUser;
                      Image=ViewComments;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.GetApprovalComment(Rec);
                               END;
                                }
      { 9       ;1   ;ActionGroup;
                      CaptionML=[ENU=Release;
                                 NOR=Frigi];
                      Image=ReleaseDoc }
      { 112     ;2   ;Action    ;
                      Name=Release;
                      ShortCutKey=Ctrl+F9;
                      CaptionML=[ENU=Re&lease;
                                 NOR=Fri&gi];
                      Promoted=Yes;
                      Image=ReleaseDoc;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ReleasePurchDoc@1000 : Codeunit 415;
                               BEGIN
                                 ReleasePurchDoc.PerformManualRelease(Rec);
                               END;
                                }
      { 113     ;2   ;Action    ;
                      Name=Reopen;
                      CaptionML=[ENU=Re&open;
                                 NOR=&pne p† nytt];
                      ToolTipML=[ENU=Reopen the document to change it after it has been approved. Approved documents have the Released status and must be opened before they can be changed.;
                                 NOR=pne dokumentet p† nytt for † endre det etter at det har blitt godkjent. Godkjente dokumenter har statusen Frigitt, og de m† †pnes f›r de kan endres.];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      Enabled=Status <> Status::Open;
                      Image=ReOpen;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ReleasePurchDoc@1001 : Codeunit 415;
                               BEGIN
                                 ReleasePurchDoc.PerformManualReopen(Rec);
                               END;
                                }
      { 1101103002;2 ;Action    ;
                      Name=Open Document in Compello;
                      CaptionML=[ENU=Open Document in Compello;
                                 NOR=pne Dokument i Compello];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Document;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 CompelloShowDoc@1101103000 : Codeunit 70006;
                               BEGIN
                                 CompelloShowDoc.ShowCompelloDocPurchaseHeader(Rec);
                               END;
                                }
      { 52      ;1   ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 NOR=F&unksjoner];
                      Image=Action }
      { 127     ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Get St&d. Vend. Purchase Codes;
                                 NOR=Hent st&d. kj›pskode for lev.];
                      Image=VendorCode;
                      OnAction=VAR
                                 StdVendPurchCode@1000 : Record 175;
                               BEGIN
                                 StdVendPurchCode.InsertPurchLines(Rec);
                               END;
                                }
      { 53      ;2   ;Action    ;
                      Name=CalculateInvoiceDiscount;
                      AccessByPermission=TableData 24=R;
                      CaptionML=[ENU=Calculate &Invoice Discount;
                                 NOR=&Beregn fakturarabatt];
                      ToolTipML=[ENU=Calculate the invoice discount for the entire document.;
                                 NOR=Beregne fakturarabatten for hele dokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      Image=CalculateInvoiceDiscount;
                      OnAction=BEGIN
                                 ApproveCalcInvDisc;
                                 PurchCalcDiscByType.ResetRecalculateInvoiceDisc(Rec);
                               END;
                                }
      { 128     ;2   ;Separator  }
      { 93      ;2   ;Action    ;
                      Name=ApplyEntries;
                      ShortCutKey=Shift+F11;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Apply Entries;
                                 NOR=Utlign poster];
                      ToolTipML=[ENU=Apply open entries for the relevant account type.;
                                 NOR=Utlign †pne poster for den relevante kontotypen.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Image=ApplyEntries;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CODEUNIT.RUN(CODEUNIT::"Purchase Header Apply",Rec);
                               END;
                                }
      { 129     ;2   ;Separator  }
      { 143     ;2   ;Action    ;
                      Name=GetPostedDocumentLinesToReverse;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Get Posted Doc&ument Lines to Reverse;
                                 NOR=Hent bokf›rte dok&umentlinjer som skal tilbakef›res];
                      ToolTipML=[ENU=Copy one or more posted purchase document lines in order to reverse the original order.;
                                 NOR=Kopier ‚n eller flere bokf›rte kj›psdokumentlinjer for † tilbakef›re den opprinnelige ordren.];
                      Image=ReverseLines;
                      OnAction=BEGIN
                                 GetPstdDocLinesToRevere;
                               END;
                                }
      { 54      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Copy Document;
                                 NOR=Kopier dokument];
                      Promoted=Yes;
                      Image=CopyDocument;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CopyPurchDoc.SetPurchHeader(Rec);
                                 CopyPurchDoc.RUNMODAL;
                                 CLEAR(CopyPurchDoc);
                                 IF GET("Document Type","No.") THEN;
                               END;
                                }
      { 131     ;2   ;Separator  }
      { 114     ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Move Negative Lines;
                                 NOR=Flytt negative linjer];
                      Image=MoveNegativeLines;
                      OnAction=BEGIN
                                 CLEAR(MoveNegPurchLines);
                                 MoveNegPurchLines.SetPurchHeader(Rec);
                                 MoveNegPurchLines.RUNMODAL;
                                 MoveNegPurchLines.ShowDocument;
                               END;
                                }
      { 132     ;2   ;Separator  }
      { 37      ;2   ;ActionGroup;
                      Name=IncomingDocument;
                      CaptionML=[ENU=Incoming Document;
                                 NOR=Inng†ende dokument];
                      ActionContainerType=NewDocumentItems;
                      Image=Documents }
      { 35      ;3   ;Action    ;
                      Name=IncomingDocCard;
                      CaptionML=[ENU=View Incoming Document;
                                 NOR=Vis inng†ende dokument];
                      ToolTipML=[ENU=View any incoming document records and file attachments that exist for the entry or document.;
                                 NOR=Vis poster og filvedlegg for innkommende dokument som finnes for oppf›ringen eller dokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      Enabled=HasIncomingDocument;
                      Image=ViewOrder;
                      OnAction=VAR
                                 IncomingDocument@1000 : Record 130;
                               BEGIN
                                 IncomingDocument.ShowCardFromEntryNo("Incoming Document Entry No.");
                               END;
                                }
      { 33      ;3   ;Action    ;
                      Name=SelectIncomingDoc;
                      AccessByPermission=TableData 130=R;
                      CaptionML=[ENU=Select Incoming Document;
                                 NOR=Velg inng†ende dokument];
                      ToolTipML=[ENU=Select an incoming document record and file attachment that you want to link to the entry or document.;
                                 NOR=Velg en post og et filvedlegg for innkommende dokument som du vil koble til oppf›ringen eller dokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      Image=SelectLineToApply;
                      OnAction=VAR
                                 IncomingDocument@1000 : Record 130;
                               BEGIN
                                 VALIDATE("Incoming Document Entry No.",IncomingDocument.SelectIncomingDocument("Incoming Document Entry No.",RECORDID));
                               END;
                                }
      { 31      ;3   ;Action    ;
                      Name=IncomingDocAttachFile;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Create Incoming Document from File;
                                 NOR=Opprett inng†ende dokument fra fil];
                      ToolTipML=[ENU=Create an incoming document record by selecting a file to attach, and then link the incoming document record to the entry or document.;
                                 NOR=Opprett en post for innkommende dokument ved † velge en fil som skal legges ved, og koble deretter posten for det innkommende dokumentet til oppf›ringen eller dokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      Enabled=CreateIncomingDocumentEnabled;
                      Image=Attach;
                      OnAction=VAR
                                 IncomingDocumentAttachment@1000 : Record 133;
                               BEGIN
                                 IncomingDocumentAttachment.NewAttachmentFromPurchaseDocument(Rec);
                               END;
                                }
      { 41      ;3   ;Action    ;
                      Name=RemoveIncomingDoc;
                      CaptionML=[ENU=Remove Incoming Document;
                                 NOR=Fjern inng†ende dokument];
                      ToolTipML=[ENU=Remove an external document that has been recorded, manually or automatically, and attached as a file to a document or ledger entry.;
                                 NOR=Fjern et eksternt dokument som er registrert manuelt eller automatisk, og knyttet som en fil til et dokument eller en post.];
                      ApplicationArea=#Basic,#Suite;
                      Enabled=HasIncomingDocument;
                      Image=RemoveLine;
                      OnAction=VAR
                                 IncomingDocument@1000 : Record 130;
                               BEGIN
                                 IF IncomingDocument.GET("Incoming Document Entry No.") THEN
                                   IncomingDocument.RemoveLinkToRelatedRecord;
                                 "Incoming Document Entry No." := 0;
                                 MODIFY(TRUE);
                               END;
                                }
      { 11      ;1   ;ActionGroup;
                      CaptionML=[ENU=Request Approval;
                                 NOR=Be om godkjenning];
                      Image=Approval }
      { 146     ;2   ;Action    ;
                      Name=SendApprovalRequest;
                      CaptionML=[ENU=Send A&pproval Request;
                                 NOR=&Send godkjenningsforesp›rsel];
                      ToolTipML=[ENU=Send an approval request.;
                                 NOR=Send en godkjenningsforesp›rsel.];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      Enabled=NOT OpenApprovalEntriesExist;
                      PromotedIsBig=Yes;
                      Image=SendApprovalRequest;
                      PromotedCategory=Category5;
                      PromotedOnly=Yes;
                      OnAction=VAR
                                 ApprovalsMgmt@1001 : Codeunit 1535;
                               BEGIN
                                 IF ApprovalsMgmt.CheckPurchaseApprovalPossible(Rec) THEN
                                   ApprovalsMgmt.OnSendPurchaseDocForApproval(Rec);
                               END;
                                }
      { 147     ;2   ;Action    ;
                      Name=CancelApprovalRequest;
                      CaptionML=[ENU=Cancel Approval Re&quest;
                                 NOR=&Annuller godkjenningsforesp›rsel];
                      ToolTipML=[ENU=Cancel the approval request.;
                                 NOR=Annuller godkjenningsforesp›rselen.];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      Enabled=CanCancelApprovalForRecord;
                      PromotedIsBig=Yes;
                      Image=CancelApprovalRequest;
                      PromotedCategory=Category5;
                      PromotedOnly=Yes;
                      OnAction=VAR
                                 ApprovalsMgmt@1001 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.OnCancelPurchaseApprovalRequest(Rec);
                               END;
                                }
      { 144     ;2   ;Separator  }
      { 57      ;1   ;ActionGroup;
                      CaptionML=[ENU=P&osting;
                                 NOR=B&okf›ring];
                      Image=Post }
      { 59      ;2   ;Action    ;
                      Name=Post;
                      ShortCutKey=F9;
                      CaptionML=[ENU=P&ost;
                                 NOR=B&okf›r];
                      ToolTipML=[ENU=Finalize the document or journal by posting the amounts and quantities to the related accounts in your company books.;
                                 NOR=Fullf›r dokumentet eller kladden ved † bokf›re bel›pene og antallene til de relaterte kontoene i selskapstabl†ene.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PostOrder;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Post(CODEUNIT::"Purch.-Post (Yes/No)");
                               END;
                                }
      { 27      ;2   ;Action    ;
                      Name=Preview;
                      CaptionML=[ENU=Preview Posting;
                                 NOR=Forh†ndsvis bokf›ring];
                      ToolTipML=[ENU=Review the different types of entries that will be created when you post the document or journal.;
                                 NOR=Se gjennom de ulike typene poster som blir opprettet n†r du bokf›rer dokumentet eller kladden.];
                      ApplicationArea=#Basic,#Suite;
                      Image=ViewPostedOrder;
                      OnAction=VAR
                                 PurchPostYesNo@1000 : Codeunit 91;
                               BEGIN
                                 PurchPostYesNo.Preview(Rec);
                               END;
                                }
      { 58      ;2   ;Action    ;
                      Name=TestReport;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Test Report;
                                 NOR=Kontrollrapport];
                      ToolTipML=[ENU=View a test report so that you can find and correct any errors before you perform the actual posting of the journal or document.;
                                 NOR=Vis en kontrollrapport slik at du kan finne og rette eventuelle feil f›r du bokf›rer kladden eller dokumentet.];
                      Image=TestReport;
                      OnAction=BEGIN
                                 ReportPrint.PrintPurchHeader(Rec);
                               END;
                                }
      { 60      ;2   ;Action    ;
                      Name=PostAndPrint;
                      ShortCutKey=Shift+F9;
                      CaptionML=[ENU=Post and &Print;
                                 NOR=Bokf›r og &skriv ut];
                      ToolTipML=[ENU=Finalize and prepare to print the document or journal. The values and quantities are posted to the related accounts. A report request window where you can specify what to include on the print-out.;
                                 NOR=Fullf›r og klargj›r for † skrive ut dokumentet eller kladden. Verdiene og antallene blir bokf›rt til de relaterte kontiene. Det vises en rapportforesp›rselsside der du kan angi hva som skal inkluderes p† utskriften.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Visible=NOT IsOfficeAddin;
                      PromotedIsBig=Yes;
                      Image=PostPrint;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Post(CODEUNIT::"Purch.-Post + Print");
                               END;
                                }
      { 3       ;2   ;Action    ;
                      CaptionML=[ENU=Remove From Job Queue;
                                 NOR=Fjern fra jobbk›];
                      ToolTipML=[ENU=Remove the scheduled processing of this record from the job queue.;
                                 NOR=Fjern den planlagte behandlingen av denne posten fra prosjektk›en.];
                      ApplicationArea=#All;
                      Visible=JobQueueVisible;
                      Image=RemoveLine;
                      OnAction=BEGIN
                                 CancelBackgroundPosting;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=[ENU=General;
                           NOR=Generelt] }

    { 2   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the purchase document. The field is only visible if you have not set up a number series for the type of purchase document, or if the Manual Nos. field is selected for the number series.;
                           NOR=Angir nummeret for kj›psdokumentet. Feltet vises bare hvis du ikke har konfigurert en nummerserie for typen kj›psdokument, eller hvis feltet Manuelle nr. er valgt for nummerserien.];
                ApplicationArea=#All;
                SourceExpr="No.";
                Importance=Additional;
                Visible=DocNoVisible;
                OnAssistEdit=BEGIN
                               IF AssistEdit(xRec) THEN
                                 CurrPage.UPDATE;
                             END;
                              }

    { 6   ;2   ;Field     ;
                CaptionML=[ENU=Vendor;
                           NOR=Leverand›r];
                ToolTipML=[ENU=Specifies the name of the vendor who sends the items.;
                           NOR=Angir navnet p† leverand›ren som sender varene.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Buy-from Vendor Name";
                Importance=Promoted;
                OnValidate=VAR
                             ApplicationAreaSetup@1001 : Record 9178;
                           BEGIN
                             IF "No." = '' THEN
                               InitRecord;

                             IF GETFILTER("Buy-from Vendor No.") = xRec."Buy-from Vendor No." THEN
                               IF "Buy-from Vendor No." <> xRec."Buy-from Vendor No." THEN
                                 SETRANGE("Buy-from Vendor No.");

                             IF ApplicationAreaSetup.IsFoundationEnabled THEN
                               PurchCalcDiscByType.ApplyDefaultInvoiceDiscount(0,Rec);

                             CurrPage.UPDATE;
                           END;

                ShowMandatory=TRUE;
                QuickEntry=FALSE }

    { 4   ;2   ;Group     ;
                CaptionML=[ENU=Buy-from;
                           NOR=Kj›p fra];
                GroupType=Group }

    { 63  ;3   ;Field     ;
                CaptionML=[ENU=Address;
                           NOR=Adresse];
                ToolTipML=[ENU=Specifies the address of the vendor who ships the items.;
                           NOR=Angir adressen til leverand›ren som leverer varene.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Buy-from Address";
                Importance=Additional }

    { 65  ;3   ;Field     ;
                CaptionML=[ENU=Address 2;
                           NOR=Adresse 2];
                ToolTipML=[ENU=Specifies additional address information.;
                           NOR=Angir ekstra adresseinformasjon.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Buy-from Address 2";
                Importance=Additional }

    { 68  ;3   ;Field     ;
                CaptionML=[ENU=Post Code;
                           NOR=Postnr.];
                ToolTipML=[ENU=Specifies the postal code.;
                           NOR=Angir postnummeret.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Buy-from Post Code";
                Importance=Additional }

    { 67  ;3   ;Field     ;
                CaptionML=[ENU=City;
                           NOR=Sted];
                ToolTipML=[ENU=Specifies the city of the vendor who ships the items.;
                           NOR=Angir poststedet til leverand›ren som leverer varene.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Buy-from City";
                Importance=Additional;
                QuickEntry=FALSE }

    { 123 ;3   ;Field     ;
                CaptionML=[ENU=Contact No.;
                           NOR=Kontaktnr.];
                ToolTipML=[ENU=Specifies the number of your contact at the vendor.;
                           NOR=Angir nummeret for kontakten hos leverand›ren.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Buy-from Contact No.";
                Importance=Additional;
                QuickEntry=FALSE }

    { 8   ;2   ;Field     ;
                CaptionML=[ENU=Contact;
                           NOR=Kontakt];
                ToolTipML=[ENU=Specifies the name of the person to contact about shipment of the item from this vendor.;
                           NOR=Angir navnet p† kontaktpersonen som kan kontaktes ang†ende varelevering fra denne leverand›ren.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Buy-from Contact" }

    { 12  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date when the posting of the purchase document will be recorded.;
                           NOR=Angir datoen n†r bokf›ringen av kj›psdokumentet blir registrert.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Posting Date";
                Importance=Additional;
                QuickEntry=FALSE }

    { 39  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date on which the vendor created the purchase document.;
                           NOR=Angir datoen da leverand›ren opprettet kj›psdokumentet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Document Date";
                Importance=Additional;
                QuickEntry=FALSE }

    { 18  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies when the invoice is due. The program calculates the date using the Payment Terms Code and Document Date fields.;
                           NOR=Angir n†r fakturaen forfaller. Programmet beregner datoen ved hjelp av feltet Betalingsbet.kode og Dokumentdato.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Due Date";
                Importance=Promoted }

    { 96  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date you expect to receive the items on the purchase document.;
                           NOR=Angir datoen du forventer † motta varer, p† kj›psdokumentet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Expected Receipt Date" }

    { 115 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the identification number of a compensation agreement.;
                           NOR=Angir ID-nummeret for en kompensasjonsavtale.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Vendor Authorization No." }

    { 13  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the incoming document that this purchase document is created for.;
                           NOR=Angir nummeret p† det innkommende dokumentet som dette kj›psdokumentet er opprettet for.];
                SourceExpr="Incoming Document Entry No.";
                Visible=FALSE }

    { 14  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number that the vendor uses for the credit memo you are creating in this purchase credit memo header.;
                           NOR=Angir nummeret som leverand›ren bruker for kreditnotaen du oppretter i denne bestillingen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Vendor Cr. Memo No.";
                ShowMandatory=VendorCreditMemoNoMandatory }

    { 72  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the order address code linked to the relevant vendor's order address.;
                           NOR=Angir bestillingsadressekoden som er knyttet til den relevante leverand›rens bestillingsadresse.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Order Address Code" }

    { 10  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies which purchaser is assigned to the vendor.;
                           NOR=Angir hvilken innkj›per som er knyttet til leverand›ren.];
                ApplicationArea=#Suite;
                SourceExpr="Purchaser Code";
                Importance=Additional;
                OnValidate=BEGIN
                             PurchaserCodeOnAfterValidate;
                           END;
                            }

    { 1102601000;2;Field  ;
                ToolTipML=[ENU=Specifies the campaign number the document is linked to.;
                           NOR=Angir kampanjenummeret som dokumentet er koblet til.];
                SourceExpr="Campaign No.";
                Importance=Additional }

    { 107 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code of the responsibility center that is associated with the user, company, or vendor.;
                           NOR=Angir koden for ansvarssentret som er knyttet til brukeren, selskapet eller leverand›ren.];
                SourceExpr="Responsibility Center";
                Importance=Additional }

    { 56  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the ID of the user who is responsible for the document.;
                           NOR=Angir ID-en til brukeren som er ansvarlig for dokumentet.];
                SourceExpr="Assigned User ID";
                Importance=Additional;
                QuickEntry=FALSE }

    { 7   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the status of a job queue entry that handles the posting of purchase orders.;
                           NOR=Angir status for en jobbk›post som h†ndterer bokf›ring av bestillinger.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Job Queue Status";
                Importance=Additional }

    { 101 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies whether the record is open, is waiting to be approved, has been invoiced for prepayment, or has been released to the next stage of processing.;
                           NOR=Angir om posten er †pen, om den venter p† godkjenning, om den er fakturert for forskudd eller om den er frigitt til neste fase i behandlingen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Status;
                Importance=Promoted;
                QuickEntry=FALSE }

    { 46  ;1   ;Part      ;
                Name=PurchLines;
                ApplicationArea=#Basic,#Suite;
                SubPageLink=Document No.=FIELD(No.);
                PagePartID=Page98;
                Enabled="Buy-from Vendor No." <> '';
                Editable="Buy-from Vendor No." <> '';
                UpdatePropagation=Both }

    { 1905885101;1;Group  ;
                CaptionML=[ENU=Invoice Details;
                           NOR=Fakturadetaljer];
                GroupType=Group }

    { 91  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the currency code for amounts on the purchase lines.;
                           NOR=Angir valutakoden for bel›pet p† kj›pslinjene.];
                ApplicationArea=#Suite;
                SourceExpr="Currency Code";
                Importance=Promoted;
                OnValidate=BEGIN
                             CurrPage.UPDATE;
                             PurchCalcDiscByType.ApplyDefaultInvoiceDiscount(0,Rec);
                           END;

                OnAssistEdit=BEGIN
                               CLEAR(ChangeExchangeRate);
                               IF "Posting Date" <> 0D THEN
                                 ChangeExchangeRate.SetParameter("Currency Code","Currency Factor","Posting Date")
                               ELSE
                                 ChangeExchangeRate.SetParameter("Currency Code","Currency Factor",WORKDATE);
                               IF ChangeExchangeRate.RUNMODAL = ACTION::OK THEN BEGIN
                                 VALIDATE("Currency Factor",ChangeExchangeRate.GetParameter);
                                 CurrPage.UPDATE;
                               END;
                               CLEAR(ChangeExchangeRate);
                             END;
                              }

    { 110 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies whether the unit price on the line should be displayed including or excluding VAT.;
                           NOR=Angir om salgsprisen p† linjen skal vises inklusiv eller eksklusiv mva.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Prices Including VAT";
                OnValidate=BEGIN
                             PricesIncludingVATOnAfterValid;
                           END;
                            }

    { 141 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the vendor's VAT specification to link transactions made for this vendor with the appropriate general ledger account according to the VAT posting setup.;
                           NOR=Angir leverand›rens mva-spesifikasjon for † koble transaksjoner gjort for denne leverand›ren, med riktig finanskonto i henhold til det generelle mva-bokf›ringsoppsettet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="VAT Bus. Posting Group";
                OnValidate=VAR
                             ApplicationAreaSetup@1000 : Record 9178;
                           BEGIN
                             IF ApplicationAreaSetup.IsFoundationEnabled THEN
                               PurchCalcDiscByType.ApplyDefaultInvoiceDiscount(0,Rec);
                           END;
                            }

    { 16  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a formula that calculates the payment due date, payment discount date, and payment discount amount on the purchase document.;
                           NOR=Angir en formel som beregner forfallsdatoen for betalingen, kontantrabattdatoen og kontantrabattbel›pet, p† kj›psdokumentet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Payment Terms Code";
                Importance=Promoted }

    { 42  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number for the transaction type, for the purpose of reporting to Intrastat.;
                           NOR=Angir nummeret for transaksjonstypen for rapportering til Intrastat.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Transaction Type" }

    { 76  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for Shortcut Dimension 1.;
                           NOR=Angir koden for Snarveisdimensjon 1.];
                ApplicationArea=#Suite;
                SourceExpr="Shortcut Dimension 1 Code";
                OnValidate=BEGIN
                             ShortcutDimension1CodeOnAfterV;
                           END;
                            }

    { 78  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for Shortcut Dimension 2.;
                           NOR=Angir koden for Snarveisdimensjon 2.];
                ApplicationArea=#Suite;
                SourceExpr="Shortcut Dimension 2 Code";
                OnValidate=BEGIN
                             ShortcutDimension2CodeOnAfterV;
                           END;
                            }

    { 94  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the payment discount percent that will be given if you pay for the purchase on or before the date in the Pmt. Discount Date field.;
                           NOR=Angir kontantrabattprosenten som gis hvis du betaler innen datoen som er angitt i feltet Kont.rabattdato.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Payment Discount %" }

    { 139 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the last date on which you can pay the invoice and still receive a payment discount.;
                           NOR=Angir siste betalingsfrist for fakturaen, hvis det skal oppn†s kontantrabatt.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pmt. Discount Date";
                Importance=Additional }

    { 80  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a code for the location where you want the items to be placed when they are received.;
                           NOR=Angir en kode for lokasjonen der du vil at de bestilte varene skal plasseres.];
                SourceExpr="Location Code";
                Importance=Additional }

    { 1906801201;1;Group  ;
                CaptionML=[ENU=Shipping and Payment;
                           NOR=Levering og betaling];
                GroupType=Group }

    { 48  ;2   ;Group     ;
                CaptionML=[ENU=Ship-to;
                           NOR=Lever til];
                GroupType=Group }

    { 32  ;3   ;Field     ;
                CaptionML=[ENU=Name;
                           NOR=Navn];
                ToolTipML=[ENU=Specifies the name of the company at the address to which you want the items in the purchase order to be shipped.;
                           NOR=Angir navnet p† selskapet med adressen som du vil at varene i bestillingen skal leveres til.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Name" }

    { 34  ;3   ;Field     ;
                CaptionML=[ENU=Address;
                           NOR=Adresse];
                ToolTipML=[ENU=Specifies the address that you want the items in the purchase order to be shipped to.;
                           NOR=Angir adressen du vil at varene i bestillingen skal leveres til.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Address" }

    { 36  ;3   ;Field     ;
                CaptionML=[ENU=Address 2;
                           NOR=Adresse 2];
                ToolTipML=[ENU=Specifies additional address information.;
                           NOR=Angir ekstra adresseinformasjon.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Address 2" }

    { 83  ;3   ;Field     ;
                CaptionML=[ENU=Post Code;
                           NOR=Postnr.];
                ToolTipML=[ENU=Specifies the postal code.;
                           NOR=Angir postnummeret.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Post Code" }

    { 38  ;3   ;Field     ;
                CaptionML=[ENU=City;
                           NOR=Sted];
                ToolTipML=[ENU=Specifies the city the items in the purchase order will be shipped to.;
                           NOR=Angir poststedet du vil at varene i bestillingen skal leveres til.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to City" }

    { 40  ;3   ;Field     ;
                CaptionML=[ENU=Contact;
                           NOR=Kontakt];
                ToolTipML=[ENU=Specifies the name of a contact person for the address where the items in the purchase order should be shipped.;
                           NOR=Angir navnet p† kontaktpersonen med adressen som varene i bestillingen skal leveres til.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Contact" }

    { 55  ;2   ;Group     ;
                CaptionML=[ENU=Pay-to;
                           NOR=Betal til];
                GroupType=Group }

    { 20  ;3   ;Field     ;
                CaptionML=[ENU=Name;
                           NOR=Navn];
                ToolTipML=[ENU=Specifies the vendor who is sending the invoice.;
                           NOR=Angir leverand›ren som sender fakturaen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pay-to Name";
                Importance=Promoted;
                OnValidate=VAR
                             ApplicationAreaSetup@1000 : Record 9178;
                           BEGIN
                             IF GETFILTER("Pay-to Vendor No.") = xRec."Pay-to Vendor No." THEN
                               IF "Pay-to Vendor No." <> xRec."Pay-to Vendor No." THEN
                                 SETRANGE("Pay-to Vendor No.");

                             IF ApplicationAreaSetup.IsFoundationEnabled THEN
                               PurchCalcDiscByType.ApplyDefaultInvoiceDiscount(0,Rec);

                             CurrPage.UPDATE;
                           END;
                            }

    { 24  ;3   ;Field     ;
                CaptionML=[ENU=Address;
                           NOR=Adresse];
                ToolTipML=[ENU=Specifies the address of the vendor sending the invoice.;
                           NOR=Angir adressen til leverand›ren som sender fakturaen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pay-to Address";
                Importance=Additional }

    { 26  ;3   ;Field     ;
                CaptionML=[ENU=Address 2;
                           NOR=Adresse 2];
                ToolTipML=[ENU=Specifies additional address information.;
                           NOR=Angir ekstra adresseinformasjon.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pay-to Address 2";
                Importance=Additional }

    { 73  ;3   ;Field     ;
                CaptionML=[ENU=Post Code;
                           NOR=Postnr.];
                ToolTipML=[ENU=Specifies the postal code.;
                           NOR=Angir postnummeret.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pay-to Post Code";
                Importance=Additional }

    { 28  ;3   ;Field     ;
                CaptionML=[ENU=City;
                           NOR=Sted];
                ToolTipML=[ENU=Specifies the city of the vendor sending the invoice.;
                           NOR=Angir poststedet for leverand›ren som sender fakturaen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pay-to City";
                Importance=Additional }

    { 125 ;3   ;Field     ;
                CaptionML=[ENU=Contact No.;
                           NOR=Kontaktnr.];
                ToolTipML=[ENU=Specifies the number of the contact who sends the invoice.;
                           NOR=Angir nummeret til kontakten som sender fakturaen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pay-to Contact No.";
                Importance=Additional }

    { 30  ;3   ;Field     ;
                CaptionML=[ENU=Contact;
                           NOR=Kontakt];
                ToolTipML=[ENU=Specifies the name of the person to contact about an invoice from this vendor.;
                           NOR=Angir navnet p† den personen som skal kontaktes hvis det oppst†r sp›rsm†l til en faktura fra denne leverand›ren.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pay-to Contact" }

    { 1907468901;1;Group  ;
                CaptionML=[ENU=Foreign Trade;
                           NOR=Utenrikshandel] }

    { 89  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a code for the purchase header's transaction specification here.;
                           NOR=Angir en kode for transaksjonsspesifikasjonen i bestillingshodet.];
                SourceExpr="Transaction Specification" }

    { 44  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for the transport method to be used with this purchase header.;
                           NOR=Angir koden for transportm†ten som skal brukes med dette bestillingshodet.];
                SourceExpr="Transport Method" }

    { 85  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code of the port of entry where the items pass into your country/region.;
                           NOR=Angir koden for innf›rselsstedet der varene kommer inn i landet/regionen.];
                SourceExpr="Entry Point" }

    { 87  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for the area of the vendor's address.;
                           NOR=Angir koden for omr†det for leverand›rens adresse.];
                SourceExpr=Area }

    { 1904409301;1;Group  ;
                CaptionML=[ENU=Application;
                           NOR=Utligning] }

    { 135 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the type of the posted document that this document or journal line will be applied to when you post, for example to register payment.;
                           NOR=Angir typen bokf›rt dokument som dette dokumentet eller denne kladdelinjen blir utlignet til n†r du bokf›rer, for eksempel for † registrere utbetaling.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Applies-to Doc. Type" }

    { 137 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the posted document that this document or journal line will be applied to when you post, for example to register payment.;
                           NOR=Angir nummeret for det bokf›rte dokumentet som dette dokumentet eller denne kladdelinjen blir utlignet til n†r du bokf›rer, for eksempel for † registrere utbetaling.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Applies-to Doc. No." }

    { 133 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the ID of entries that will be applied to when you choose the Apply Entries action.;
                           NOR=Angir ID-en for postene som blir utlignet n†r du velger handlingen Utlign poster.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Applies-to ID" }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 15  ;1   ;Part      ;
                ApplicationArea=#All;
                SubPageLink=Table ID=CONST(38),
                            Document Type=FIELD(Document Type),
                            Document No.=FIELD(No.);
                PagePartID=Page9103;
                Visible=OpenApprovalEntriesExistForCurrUser;
                PartType=Page }

    { 1906354007;1;Part   ;
                Name=ApprovalFactBox;
                PagePartID=Page9092;
                Visible=FALSE;
                PartType=Page }

    { 1901138007;1;Part   ;
                SubPageLink=No.=FIELD(Buy-from Vendor No.);
                PagePartID=Page9093;
                Visible=FALSE;
                PartType=Page }

    { 1904651607;1;Part   ;
                SubPageLink=No.=FIELD(Pay-to Vendor No.);
                PagePartID=Page9094;
                PartType=Page }

    { 1903435607;1;Part   ;
                SubPageLink=No.=FIELD(Buy-from Vendor No.);
                PagePartID=Page9095;
                PartType=Page }

    { 1906949207;1;Part   ;
                SubPageLink=No.=FIELD(Pay-to Vendor No.);
                PagePartID=Page9096;
                Visible=FALSE;
                PartType=Page }

    { 29  ;1   ;Part      ;
                Name=IncomingDocAttachFactBox;
                PagePartID=Page193;
                Visible=NOT IsOfficeAddin;
                PartType=Page;
                ShowFilter=No }

    { 5   ;1   ;Part      ;
                SubPageLink=Document Type=FIELD(Document Type),
                            Document No.=FIELD(Document No.),
                            Line No.=FIELD(Line No.);
                PagePartID=Page9100;
                ProviderID=46;
                Visible=FALSE;
                PartType=Page }

    { 45  ;1   ;Part      ;
                Name=WorkflowStatus;
                ApplicationArea=#All;
                PagePartID=Page1528;
                Visible=ShowWorkflowStatus;
                Enabled=FALSE;
                Editable=FALSE;
                PartType=Page;
                ShowFilter=No }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      CopyPurchDoc@1002 : Report 492;
      MoveNegPurchLines@1005 : Report 6698;
      ReportPrint@1003 : Codeunit 228;
      UserMgt@1004 : Codeunit 5700;
      PurchCalcDiscByType@1007 : Codeunit 66;
      LinesInstructionMgt@1017 : Codeunit 1320;
      ChangeExchangeRate@1001 : Page 511;
      JobQueueVisible@1000 : Boolean INDATASET;
      HasIncomingDocument@1010 : Boolean;
      DocNoVisible@1006 : Boolean;
      VendorCreditMemoNoMandatory@1008 : Boolean;
      OpenApprovalEntriesExist@1009 : Boolean;
      OpenApprovalEntriesExistForCurrUser@1012 : Boolean;
      ShowWorkflowStatus@1011 : Boolean;
      IsOfficeAddin@1015 : Boolean;
      CanCancelApprovalForRecord@1014 : Boolean;
      DocumentIsPosted@1018 : Boolean;
      OpenPostedPurchCrMemoQst@1013 : TextConst 'ENU=The credit memo has been posted and archived.\\Do you want to open the posted credit memo from the Posted Purchase Credit Memos window?;NOR=Kreditnotaen er bokf›rt og arkivert.\\Vil du †pne den bokf›rte kreditnotaen fra vinduet Bokf›rte kj›pskreditnotaer?';
      CreateIncomingDocumentEnabled@1016 : Boolean;

    LOCAL PROCEDURE Post@4(PostingCodeunitID@1000 : Integer);
    VAR
      PurchaseHeader@1001 : Record 38;
      PurchCrMemoHdr@1002 : Record 124;
      ApplicationAreaSetup@1003 : Record 9178;
      InstructionMgt@1004 : Codeunit 1330;
    BEGIN
      IF ApplicationAreaSetup.IsFoundationEnabled THEN
        LinesInstructionMgt.PurchaseCheckAllLinesHaveQuantityAssigned(Rec);

      SendToPosting(PostingCodeunitID);

      DocumentIsPosted := NOT PurchaseHeader.GET("Document Type","No.");

      IF "Job Queue Status" = "Job Queue Status"::"Scheduled for Posting" THEN
        CurrPage.CLOSE;
      CurrPage.UPDATE(FALSE);

      IF PostingCodeunitID <> CODEUNIT::"Purch.-Post (Yes/No)" THEN
        EXIT;

      IF IsOfficeAddin THEN BEGIN
        PurchCrMemoHdr.SETRANGE("Pre-Assigned No.","No.");
        IF PurchCrMemoHdr.FINDFIRST THEN
          PAGE.RUN(PAGE::"Posted Purchase Credit Memo",PurchCrMemoHdr);
      END ELSE
        IF InstructionMgt.IsEnabled(InstructionMgt.ShowPostedConfirmationMessageCode) THEN
          ShowPostedConfirmationMessage;
    END;

    LOCAL PROCEDURE ApproveCalcInvDisc@1();
    BEGIN
      CurrPage.PurchLines.PAGE.ApproveCalcInvDisc;
    END;

    LOCAL PROCEDURE PurchaserCodeOnAfterValidate@19046120();
    BEGIN
      CurrPage.PurchLines.PAGE.UpdateForm(TRUE);
    END;

    LOCAL PROCEDURE ShortcutDimension1CodeOnAfterV@19029405();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE ShortcutDimension2CodeOnAfterV@19008725();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE PricesIncludingVATOnAfterValid@19009096();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE SetDocNoVisible@2();
    VAR
      DocumentNoVisibility@1001 : Codeunit 1400;
      DocType@1000 : 'Quote,Order,Invoice,Credit Memo,Blanket Order,Return Order,Reminder,FinChMemo';
    BEGIN
      DocNoVisible := DocumentNoVisibility.PurchaseDocumentNoIsVisible(DocType::"Credit Memo","No.");
    END;

    LOCAL PROCEDURE SetExtDocNoMandatoryCondition@3();
    VAR
      PurchasesPayablesSetup@1000 : Record 312;
    BEGIN
      PurchasesPayablesSetup.GET;
      VendorCreditMemoNoMandatory := PurchasesPayablesSetup."Ext. Doc. No. Mandatory"
    END;

    LOCAL PROCEDURE SetControlAppearance@5();
    VAR
      ApprovalsMgmt@1002 : Codeunit 1535;
    BEGIN
      JobQueueVisible := "Job Queue Status" = "Job Queue Status"::"Scheduled for Posting";
      HasIncomingDocument := "Incoming Document Entry No." <> 0;
      CreateIncomingDocumentEnabled := (NOT HasIncomingDocument) AND ("No." <> '');
      SetExtDocNoMandatoryCondition;

      OpenApprovalEntriesExistForCurrUser := ApprovalsMgmt.HasOpenApprovalEntriesForCurrentUser(RECORDID);
      OpenApprovalEntriesExist := ApprovalsMgmt.HasOpenApprovalEntries(RECORDID);

      CanCancelApprovalForRecord := ApprovalsMgmt.CanCancelApprovalForRecord(RECORDID);
    END;

    LOCAL PROCEDURE ShowPostedConfirmationMessage@13();
    VAR
      PurchCrMemoHdr@1000 : Record 124;
      InstructionMgt@1001 : Codeunit 1330;
    BEGIN
      PurchCrMemoHdr.SETRANGE("Pre-Assigned No.","No.");
      IF PurchCrMemoHdr.FINDFIRST THEN
        IF InstructionMgt.ShowConfirm(OpenPostedPurchCrMemoQst,InstructionMgt.ShowPostedConfirmationMessageCode) THEN
          PAGE.RUN(PAGE::"Posted Purchase Credit Memo",PurchCrMemoHdr);
    END;

    BEGIN
    {
      +---------------------------------------------+
      | SI-Data                                     |
      +---------------------------------------------+
      No. Date     Id  Description
      CMP2.00 new page action to show Compello document
    }
    END.
  }
}

OBJECT Page 138 Posted Purchase Invoice
{
  OBJECT-PROPERTIES
  {
    Date=01.10.16;
    Time=11:00:00;
    Modified=Yes;
    Version List=NAVW110.00.00.15052,CMP2.00;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Posted Purchase Invoice;
               NOR=Bokf›rt kj›psfaktura];
    InsertAllowed=No;
    ModifyAllowed=No;
    SourceTable=Table122;
    PageType=Document;
    RefreshOnActivate=Yes;
    PromotedActionCategoriesML=[ENU=New,Process,Report,Correct,Navigation;
                                NOR=Ny,Prosess,Rapport,Korriger,Navigasjon];
    OnOpenPage=VAR
                 OfficeMgt@1000 : Codeunit 1630;
               BEGIN
                 SetSecurityFilterOnRespCenter;
                 IsOfficeAddin := OfficeMgt.IsAvailable;
               END;

    OnAfterGetCurrRecord=VAR
                           IncomingDocument@1000 : Record 130;
                         BEGIN
                           HasIncomingDocument := IncomingDocument.PostedDocExists("No.","Posting Date");
                           CurrPage.IncomingDocAttachFactBox.PAGE.LoadDataFromRecord(Rec);
                         END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 53      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Invoice;
                                 NOR=F&aktura];
                      Image=Invoice }
      { 45      ;2   ;Action    ;
                      Name=Statistics;
                      ShortCutKey=F7;
                      CaptionML=[ENU=Statistics;
                                 NOR=Statistikk];
                      RunObject=Page 400;
                      RunPageLink=No.=FIELD(No.);
                      Promoted=Yes;
                      Image=Statistics;
                      PromotedCategory=Process }
      { 55      ;2   ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 NOR=&Merknader];
                      RunObject=Page 66;
                      RunPageLink=Document Type=CONST(Posted Invoice),
                                  No.=FIELD(No.),
                                  Document Line No.=CONST(0);
                      Image=ViewComments }
      { 89      ;2   ;Action    ;
                      Name=Dimensions;
                      AccessByPermission=TableData 348=R;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 NOR=Dimensjoner];
                      ToolTipML=[ENU=View or edits dimensions, such as area, project, or department, that you can assign to sales and purchase documents to distribute costs and analyze transaction history.;
                                 NOR=Vis eller rediger dimensjoner, for eksempel omr†de, prosjekt eller avdeling, som du kan tilordne til salgs- og kj›psdokumenter for † distribuere kostnader og analysere transaksjonshistorikk.];
                      ApplicationArea=#Suite;
                      Image=Dimensions;
                      OnAction=BEGIN
                                 ShowDimensions;
                               END;
                                }
      { 106     ;2   ;Action    ;
                      AccessByPermission=TableData 456=R;
                      CaptionML=[ENU=Approvals;
                                 NOR=Godkjenninger];
                      ToolTipML=[ENU=View a list of the records that are waiting to be approved. For example, you can see who requested the record to be approved, when it was sent, and when it is due to be approved.;
                                 NOR=Vis en liste med poster dom venter p† † bli godkjent. Du kan for eksempel se hvem som har bedt om godkjenning av posten, n†r den ble sendt og n†r den forfaller til godkjenning.];
                      ApplicationArea=#Suite;
                      Image=Approvals;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.ShowPostedApprovalEntries(RECORDID);
                               END;
                                }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 25      ;1   ;ActionGroup;
                      CaptionML=[ENU=Correct;
                                 NOR=Korriger] }
      { 23      ;2   ;Action    ;
                      Name=CorrectInvoice;
                      CaptionML=[ENU=Correct;
                                 NOR=Korriger];
                      ToolTipML=[ENU=Reverse this posted invoice and automatically create a new invoice with the same information that you can correct before posting. This posted invoice will automatically be canceled.;
                                 NOR=Tilbakef›r denne bokf›rte fakturaen, og opprett automatisk en ny faktura med den samme informasjonen som du kan korrigere f›r bokf›ring. Denne bokf›rte fakturaen annulleres automatisk.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Undo;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 CorrectPstdPurchInvYesNo@1000 : Codeunit 1324;
                               BEGIN
                                 IF CorrectPstdPurchInvYesNo.CorrectInvoice(Rec) THEN
                                   CurrPage.CLOSE;
                               END;
                                }
      { 11      ;2   ;Action    ;
                      Name=CancelInvoice;
                      CaptionML=[ENU=Cancel;
                                 NOR=Annuller];
                      ToolTipML=[ENU=Create and post a purchase credit memo that reverses this posted purchase invoice. This posted purchase invoice will be canceled.;
                                 NOR=Opprett og bokf›r en kj›pskreditnota som tilbakef›rer denne bokf›rte kj›psfakturaen. Denne bokf›rte kj›psfakturaen vil bli annullert.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Cancel;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 CancelPstdPurchInvYesNo@1000 : Codeunit 1325;
                               BEGIN
                                 IF CancelPstdPurchInvYesNo.CancelInvoice(Rec) THEN
                                   CurrPage.CLOSE;
                               END;
                                }
      { 21      ;2   ;Action    ;
                      Name=CreateCreditMemo;
                      CaptionML=[ENU=Create Corrective Credit Memo;
                                 NOR=Opprett korrigerende kreditnota];
                      ToolTipML=[ENU=Create a credit memo for this posted invoice that you complete and post manually to reverse the posted invoice.;
                                 NOR=Opprett en kreditnota for denne bokf›rte fakturaen som du fullf›rer og bokf›rer manuelt for † tilbakef›re den bokf›rte fakturaen.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Image=CreateCreditMemo;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 PurchaseHeader@1001 : Record 38;
                                 CorrectPostedPurchInvoice@1000 : Codeunit 1313;
                               BEGIN
                                 CorrectPostedPurchInvoice.CreateCreditMemoCopyDocument(Rec,PurchaseHeader);
                                 PAGE.RUN(PAGE::"Purchase Credit Memo",PurchaseHeader);
                                 CurrPage.CLOSE;
                               END;
                                }
      { 39      ;1   ;ActionGroup;
                      CaptionML=[ENU=Actions;
                                 NOR=Handlinger];
                      Image=Invoice }
      { 37      ;2   ;Action    ;
                      Name=Vendor;
                      ShortCutKey=Shift+F7;
                      CaptionML=[ENU=Vendor;
                                 NOR=Leverand›r];
                      ToolTipML=[ENU=View or edit detailed information about the vendor on the posted purchase document.;
                                 NOR=Vis eller rediger detaljert informasjon om leverand›ren i det bokf›rte kj›psdokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 26;
                      RunPageLink=No.=FIELD(Buy-from Vendor No.);
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Vendor;
                      PromotedCategory=Category5 }
      { 49      ;2   ;Action    ;
                      Name=ShowCreditMemo;
                      CaptionML=[ENU=Show Canceled/Corrective Credit Memo;
                                 NOR=Vis annullert/korrigerende kreditnota];
                      ToolTipML=[ENU=Open the posted purchase credit memo that was created when you canceled the posted purchase invoice. If the posted purchase invoice is the result of a canceled purchase credit memo, then canceled purchase credit memo will open.;
                                 NOR=pne den bokf›rte kj›pskreditnotaen som ble opprettet da du kansellerte den bokf›rte kj›psfakturaen. Hvis den bokf›rte kj›psfakturaen er et resultat av den kansellerte kj›pskreditnotaen, s† vil den kansellerte kj›pskreditnotaen bli †pnet.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Enabled=Cancelled OR Corrective;
                      PromotedIsBig=Yes;
                      Image=CreditMemo;
                      PromotedCategory=Category5;
                      OnAction=BEGIN
                                 ShowCanceledOrCorrCrMemo;
                               END;
                                }
      { 33      ;2   ;Action    ;
                      Name=Navigate;
                      CaptionML=[ENU=&Navigate;
                                 NOR=&Naviger];
                      ToolTipML=[ENU=Find all entries and documents that exist for the document number and posting date on the posted purchase document.;
                                 NOR=Finn alle poster og dokumenter som finnes for dokumentnummeret og bokf›ringsdatoen p† det bokf›rte kj›psdokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Visible=NOT IsOfficeAddin;
                      PromotedIsBig=Yes;
                      Image=Navigate;
                      PromotedCategory=Category5;
                      OnAction=BEGIN
                                 Navigate;
                               END;
                                }
      { 29      ;1   ;ActionGroup;
                      CaptionML=[ENU=Print;
                                 NOR=Skriv ut] }
      { 27      ;2   ;Action    ;
                      Name=Print;
                      Ellipsis=Yes;
                      CaptionML=[ENU=&Print;
                                 NOR=&Skriv ut];
                      ToolTipML=[ENU=Prepare to print the document. A report request window for the document opens where you can specify what to include on the print-out.;
                                 NOR=Klargj›r for † skrive ut dokumentet. Det vises et rapportforesp›rselsvindu for dokumentet der du kan angi hva som skal inkluderes p† utskriften.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Visible=NOT IsOfficeAddin;
                      Image=Print;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CurrPage.SETSELECTIONFILTER(PurchInvHeader);
                                 PurchInvHeader.PrintRecords(TRUE);
                               END;
                                }
      { 57      ;1   ;Action    ;
                      CaptionML=[ENU=&Navigate;
                                 NOR=&Naviger];
                      ToolTipML=[ENU=Find all entries and documents that exist for the document number and posting date on the selected entry or document.;
                                 NOR=Finn alle oppf›ringer og dokumenter som finnes for dokumentnummeret og bokf›ringsdatoen i den valgte oppf›ringen eller dokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Visible=NOT IsOfficeAddin;
                      Image=Navigate;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Navigate;
                               END;
                                }
      { 1101103002;1 ;Action    ;
                      Name=Open Document in Compello;
                      CaptionML=[ENU=Open Document in Compello;
                                 NOR=pne Dokument i Compello];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Document;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 CompelloShowDoc@1101103000 : Codeunit 70006;
                               BEGIN
                                 CompelloShowDoc.ShowCompelloDocPurchaseInvHeader(Rec);
                               END;
                                }
      { 19      ;1   ;ActionGroup;
                      Name=IncomingDocument;
                      CaptionML=[ENU=Incoming Document;
                                 NOR=Inng†ende dokument];
                      ActionContainerType=NewDocumentItems;
                      Image=Documents }
      { 17      ;2   ;Action    ;
                      Name=IncomingDocCard;
                      CaptionML=[ENU=View Incoming Document;
                                 NOR=Vis inng†ende dokument];
                      ToolTipML=[ENU=View any incoming document records and file attachments that exist for the entry or document.;
                                 NOR=Vis poster og filvedlegg for innkommende dokument som finnes for oppf›ringen eller dokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      Enabled=HasIncomingDocument;
                      Image=ViewOrder;
                      OnAction=VAR
                                 IncomingDocument@1000 : Record 130;
                               BEGIN
                                 IncomingDocument.ShowCard("No.","Posting Date");
                               END;
                                }
      { 15      ;2   ;Action    ;
                      Name=SelectIncomingDoc;
                      AccessByPermission=TableData 130=R;
                      CaptionML=[ENU=Select Incoming Document;
                                 NOR=Velg inng†ende dokument];
                      ToolTipML=[ENU=Select an incoming document record and file attachment that you want to link to the entry or document.;
                                 NOR=Velg en post og et filvedlegg for innkommende dokument som du vil koble til oppf›ringen eller dokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      Enabled=NOT HasIncomingDocument;
                      Image=SelectLineToApply;
                      OnAction=VAR
                                 IncomingDocument@1000 : Record 130;
                               BEGIN
                                 IncomingDocument.SelectIncomingDocumentForPostedDocument("No.","Posting Date",RECORDID);
                               END;
                                }
      { 13      ;2   ;Action    ;
                      Name=IncomingDocAttachFile;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Create Incoming Document from File;
                                 NOR=Opprett inng†ende dokument fra fil];
                      ToolTipML=[ENU=Create an incoming document record by selecting a file to attach, and then link the incoming document record to the entry or document.;
                                 NOR=Opprett en post for innkommende dokument ved † velge en fil som skal legges ved, og koble deretter posten for det innkommende dokumentet til oppf›ringen eller dokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      Enabled=NOT HasIncomingDocument;
                      Image=Attach;
                      OnAction=VAR
                                 IncomingDocumentAttachment@1000 : Record 133;
                               BEGIN
                                 IncomingDocumentAttachment.NewAttachmentFromPostedDocument("No.","Posting Date");
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=[ENU=General;
                           NOR=Generelt] }

    { 2   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the posted invoice number.;
                           NOR=Angir det bokf›rte fakturanummeret.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="No.";
                Importance=Additional;
                Editable=FALSE }

    { 59  ;2   ;Field     ;
                CaptionML=[ENU=Vendor;
                           NOR=Leverand›r];
                ToolTipML=[ENU=Specifies the name of the vendor who shipped the items.;
                           NOR=Angir navnet p† leverand›ren som leverte varene.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Buy-from Vendor Name";
                TableRelation=Vendor.Name;
                Editable=FALSE }

    { 4   ;2   ;Group     ;
                CaptionML=[ENU=Buy-from;
                           NOR=Kj›p fra];
                GroupType=Group }

    { 61  ;3   ;Field     ;
                CaptionML=[ENU=Address;
                           NOR=Adresse];
                ToolTipML=[ENU=Specifies the address of the vendor who shipped the items.;
                           NOR=Angir adressen til leverand›ren som leverte varene.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Buy-from Address";
                Importance=Additional;
                Editable=FALSE }

    { 63  ;3   ;Field     ;
                CaptionML=[ENU=Address 2;
                           NOR=Adresse 2];
                ToolTipML=[ENU=Specifies additional address information.;
                           NOR=Angir ekstra adresseinformasjon.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Buy-from Address 2";
                Importance=Additional;
                Editable=FALSE }

    { 6   ;3   ;Field     ;
                CaptionML=[ENU=Post Code;
                           NOR=Postnr.];
                ToolTipML=[ENU=Specifies the postal code.;
                           NOR=Angir postnummeret.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Buy-from Post Code";
                Importance=Additional;
                Editable=FALSE }

    { 65  ;3   ;Field     ;
                CaptionML=[ENU=City;
                           NOR=Sted];
                ToolTipML=[ENU=Specifies the city of the vendor who shipped the items.;
                           NOR=Angir poststedet til leverand›ren som leverte varene.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Buy-from City";
                Importance=Additional;
                Editable=FALSE }

    { 100 ;3   ;Field     ;
                CaptionML=[ENU=Contact No.;
                           NOR=Kontaktnr.];
                ToolTipML=[ENU=Specifies the number of the contact you bought the items from.;
                           NOR=Angir nummeret p† kontakten som du kj›pte varene fra.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Buy-from Contact No.";
                Importance=Additional;
                Editable=FALSE }

    { 67  ;2   ;Field     ;
                CaptionML=[ENU=Contact;
                           NOR=Kontakt];
                ToolTipML=[ENU=Specifies the name of the person to contact at the vendor who shipped the items.;
                           NOR=Angir navnet p† kontaktpersonen hos den leverand›ren som leverte varene.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Buy-from Contact";
                Editable=FALSE }

    { 12  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date the purchase header was posted.;
                           NOR=Angir datoen da bestillingshodet ble bokf›rt.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Posting Date";
                Importance=Promoted;
                Editable=FALSE }

    { 71  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date on which the purchase document was created.;
                           NOR=Angir datoen da kj›psdokumentet ble opprettet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Document Date";
                Importance=Additional;
                Editable=FALSE }

    { 32  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies when the invoice is due. The program calculates the date using the Payment Terms Code and Document Date fields on the purchase header.;
                           NOR=Angir n†r fakturaen forfaller. Programmet beregner datoen ved hjelp av feltet Betalingsbet.kode og Bilagsdato i bestillingshodet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Due Date";
                Importance=Promoted;
                Editable=FALSE }

    { 110 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the purchase quote document if a quote was used to start the purchase process.;
                           NOR=Angir nummeret p† foresp›rselsdokumentet hvis en foresp›rsel ble brukt til † starte kj›psprosessen.];
                SourceExpr="Quote No.";
                Importance=Additional }

    { 81  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the purchase order that this invoice was posted from.;
                           NOR=Angir nummeret p† bestillingen som denne fakturaen er bokf›rt fra.];
                SourceExpr="Order No.";
                Importance=Additional;
                Editable=FALSE }

    { 14  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the vendor's own invoice number.;
                           NOR=Angir leverand›rens eget fakturanummer.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Vendor Invoice No.";
                Importance=Promoted;
                Editable=FALSE }

    { 104 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the vendor's order number.;
                           NOR=Angir leverand›rens ordrenummer.];
                SourceExpr="Vendor Order No.";
                Importance=Additional;
                Editable=FALSE }

    { 83  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the purchase document that the posted invoice was created for.;
                           NOR=Angir nummeret p† kj›psdokumentet som den bokf›rte fakturaen ble opprettet for.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pre-Assigned No.";
                Importance=Additional;
                Editable=FALSE }

    { 16  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies how many times the invoice has been printed.;
                           NOR=Angir hvor mange ganger fakturaen har blitt skrevet ut.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="No. Printed";
                Importance=Additional;
                Editable=FALSE }

    { 7   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the order address code used in the invoice.;
                           NOR=Angir bestillingsadressekoden som brukes i fakturaen.];
                SourceExpr="Order Address Code";
                Importance=Additional;
                Editable=FALSE }

    { 10  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies which purchaser is associated with the invoice.;
                           NOR=Angir hvilken innkj›per som er tilknyttet fakturaen.];
                SourceExpr="Purchaser Code";
                Importance=Additional;
                Editable=FALSE }

    { 92  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for the responsibility center that serves the vendor on this purchase document.;
                           NOR=Angir koden for ansvarssenteret som betjener leverand›ren p† dette kj›psdokumentet.];
                SourceExpr="Responsibility Center";
                Importance=Additional;
                Editable=FALSE }

    { 31  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies if the posted purchase invoice has been either corrected or canceled.;
                           NOR=Angir om den bokf›rte kj›psfakturaen er blitt korrigert eller kansellert.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Cancelled;
                Importance=Additional;
                Style=Unfavorable;
                StyleExpr=Cancelled;
                OnDrillDown=BEGIN
                              ShowCorrectiveCreditMemo;
                            END;
                             }

    { 18  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies if the posted purchase invoice is a corrective document.;
                           NOR=Angir om den bokf›rte kj›psfakturaen er et korrigerende dokument.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Corrective;
                Importance=Additional;
                Style=Unfavorable;
                StyleExpr=Corrective;
                OnDrillDown=BEGIN
                              ShowCancelledCreditMemo;
                            END;
                             }

    { 52  ;1   ;Part      ;
                Name=PurchInvLines;
                ApplicationArea=#Basic,#Suite;
                SubPageLink=Document No.=FIELD(No.);
                PagePartID=Page139 }

    { 1905885101;1;Group  ;
                CaptionML=[ENU=Invoice Details;
                           NOR=Fakturadetaljer];
                GroupType=Group }

    { 87  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the currency code used to calculate the amounts on the invoice.;
                           NOR=Angir valutakoden som er brukt til † beregne bel›pene i fakturaen.];
                ApplicationArea=#Suite;
                SourceExpr="Currency Code";
                Importance=Promoted;
                OnAssistEdit=VAR
                               ChangeExchangeRate@1000 : Page 511;
                             BEGIN
                               ChangeExchangeRate.SetParameter("Currency Code","Currency Factor","Posting Date");
                               ChangeExchangeRate.EDITABLE(FALSE);
                               IF ChangeExchangeRate.RUNMODAL = ACTION::OK THEN BEGIN
                                 "Currency Factor" := ChangeExchangeRate.GetParameter;
                                 MODIFY;
                               END;
                             END;
                              }

    { 50  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date on which the invoiced items were expected.;
                           NOR=Angir forventet mottaksdato for de fakturerte varene.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Expected Receipt Date";
                Importance=Promoted;
                Editable=FALSE }

    { 30  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code to use to find the payment terms that apply to the purchase header.;
                           NOR=Angir koden som skal brukes for † finne betalingsbetingelsene som gjelder for bestillingshodet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Payment Terms Code";
                Importance=Promoted;
                Editable=FALSE }

    { 84  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the method of payment to vendors. The program has copied the code from the Payment Method Code field on the purchase header.;
                           NOR=Angir betalingsm†ten til leverand›rer. Programmet har overf›rt koden fra feltet Betalingsm†te - kode i bestillingshodet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Payment Method Code";
                Importance=Additional;
                Editable=FALSE }

    { 72  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for the dimension value associated with the invoice.;
                           NOR=Angir koden for dimensjonsverdien som er knyttet til fakturaen.];
                SourceExpr="Shortcut Dimension 1 Code";
                Editable=FALSE }

    { 74  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for the dimension value associated with the invoice.;
                           NOR=Angir koden for dimensjonsverdien som er knyttet til fakturaen.];
                SourceExpr="Shortcut Dimension 2 Code";
                Editable=FALSE }

    { 34  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the payment discount percent granted if payment is made on or before the date in the Pmt. Discount Date field.;
                           NOR=Angir kontantrabattprosenten som gis hvis betaling utf›res innen datoen i feltet Kont.rabattdato.];
                SourceExpr="Payment Discount %";
                Editable=FALSE }

    { 36  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the last date on which you can pay the invoice and still receive a payment discount.;
                           NOR=Angir siste betalingsfrist for fakturaen, hvis det skal oppn†s kontantrabatt.];
                SourceExpr="Pmt. Discount Date";
                Importance=Additional;
                Editable=FALSE }

    { 76  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for the location where the items are registered.;
                           NOR=Angir koden for lokasjonen som varene er registrert p†.];
                SourceExpr="Location Code";
                Importance=Additional;
                Editable=FALSE }

    { 48  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code that represents the shipment method for this invoice.;
                           NOR=Angir koden for leveringsm†ten som gjelder for fakturaen.];
                SourceExpr="Shipment Method Code";
                Importance=Additional;
                Editable=FALSE }

    { 3   ;2   ;Field     ;
                ToolTipML=[ENU=Identifies the payment of the purchase invoice.;
                           NOR=Identifiserer betalingen for kj›psfakturaen.];
                SourceExpr="Payment Reference";
                Importance=Additional }

    { 5   ;2   ;Field     ;
                ToolTipML=[ENU=Identifies the vendor who sent the purchase invoice.;
                           NOR=Identifiserer leverand›ren som sendte kj›psfakturaen.];
                SourceExpr="Creditor No.";
                Importance=Additional }

    { 41  ;1   ;Group     ;
                CaptionML=[ENU=Shipping and Payment;
                           NOR=Levering og betaling];
                GroupType=Group }

    { 1906801201;2;Group  ;
                CaptionML=[ENU=Ship-to;
                           NOR=Lever til];
                GroupType=Group }

    { 47  ;3   ;Field     ;
                CaptionML=[ENU=Address Code;
                           NOR=Adressekode];
                ToolTipML=[ENU=Specifies the address on purchase orders shipped with a drop shipment directly from the vendor to a customer.;
                           NOR=Angir adressen p† bestillinger som ble levert direkte fra leverand›ren til en kunde.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Code";
                Importance=Promoted }

    { 38  ;3   ;Field     ;
                CaptionML=[ENU=Name;
                           NOR=Navn];
                ToolTipML=[ENU=Specifies the name of the company at the address to which the items in the purchase order were shipped.;
                           NOR=Angir navnet p† selskapet med adressen som varene i bestillingen ble levert til.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Name";
                Editable=FALSE }

    { 40  ;3   ;Field     ;
                CaptionML=[ENU=Address;
                           NOR=Adresse];
                ToolTipML=[ENU=Specifies the address that the items in the purchase order were shipped to.;
                           NOR=Angir adressen du vil at varene i bestillingen ble levert til.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Address";
                Editable=FALSE }

    { 42  ;3   ;Field     ;
                CaptionML=[ENU=Address 2;
                           NOR=Adresse 2];
                ToolTipML=[ENU=Specifies additional address information.;
                           NOR=Angir ekstra adresseinformasjon.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Address 2";
                Editable=FALSE }

    { 8   ;3   ;Field     ;
                CaptionML=[ENU=Post Code;
                           NOR=Postnr.];
                ToolTipML=[ENU=Specifies the postal code.;
                           NOR=Angir postnummeret.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Post Code";
                Editable=FALSE }

    { 44  ;3   ;Field     ;
                CaptionML=[ENU=City;
                           NOR=Sted];
                ToolTipML=[ENU=Specifies the city the items in the purchase order were shipped to.;
                           NOR=Angir poststedet du vil at varene i bestillingen ble levert til.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to City";
                Editable=FALSE }

    { 46  ;3   ;Field     ;
                CaptionML=[ENU=Contact;
                           NOR=Kontakt];
                ToolTipML=[ENU=Specifies the name of a contact person at the address that the items in the purchase order were shipped to.;
                           NOR=Angir navnet p† kontaktpersonen p† adressen som varene i bestillingen ble levert til.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Contact";
                Editable=FALSE }

    { 43  ;2   ;Group     ;
                CaptionML=[ENU=Pay-to;
                           NOR=Betal til];
                GroupType=Group }

    { 20  ;3   ;Field     ;
                CaptionML=[ENU=Name;
                           NOR=Navn];
                ToolTipML=[ENU=Specifies the name of the vendor who you received the invoice from.;
                           NOR=Angir navnet p† leverand›ren du har mottatt fakturaen fra.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pay-to Name";
                Importance=Promoted;
                Editable=FALSE }

    { 22  ;3   ;Field     ;
                CaptionML=[ENU=Address;
                           NOR=Adresse];
                ToolTipML=[ENU=Specifies the address of the vendor that you received the invoice from.;
                           NOR=Angir adressen til leverand›ren som du har mottatt fakturaen fra.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pay-to Address";
                Importance=Additional;
                Editable=FALSE }

    { 24  ;3   ;Field     ;
                CaptionML=[ENU=Address 2;
                           NOR=Adresse 2];
                ToolTipML=[ENU=Specifies additional address information.;
                           NOR=Angir ekstra adresseinformasjon.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pay-to Address 2";
                Importance=Additional;
                Editable=FALSE }

    { 78  ;3   ;Field     ;
                CaptionML=[ENU=Post Code;
                           NOR=Postnr.];
                ToolTipML=[ENU=Specifies the postal code.;
                           NOR=Angir postnummeret.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pay-to Post Code";
                Importance=Additional;
                Editable=FALSE }

    { 26  ;3   ;Field     ;
                CaptionML=[ENU=City;
                           NOR=Sted];
                ToolTipML=[ENU=Specifies the city of the vendor you received the invoice from.;
                           NOR=Angir poststedet til leverand›ren du har mottatt fakturaen fra.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pay-to City";
                Importance=Additional;
                Editable=FALSE }

    { 102 ;3   ;Field     ;
                CaptionML=[ENU=Contact No.;
                           NOR=Kontaktnr.];
                ToolTipML=[ENU=Specifies the number of the contact you received the invoice from.;
                           NOR=Angir nummeret p† kontakten som du mottok fakturaen fra.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pay-to Contact No.";
                Importance=Additional;
                Editable=FALSE }

    { 28  ;3   ;Field     ;
                CaptionML=[ENU=Contact;
                           NOR=Kontakt];
                ToolTipML=[ENU=Specifies the name of the person you should contact at the vendor who you received the invoice from.;
                           NOR=Angir navnet p† kontaktperson hos leverand›ren som du mottok fakturaen fra.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pay-to Contact";
                Editable=FALSE }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 9   ;1   ;Part      ;
                Name=IncomingDocAttachFactBox;
                ApplicationArea=#Basic,#Suite;
                PagePartID=Page193;
                Visible=NOT IsOfficeAddin;
                PartType=Page;
                ShowFilter=No }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      PurchInvHeader@1000 : Record 122;
      HasIncomingDocument@1002 : Boolean;
      IsOfficeAddin@1003 : Boolean;

    BEGIN
    {
      +---------------------------------------------+
      | SI-Data                                     |
      +---------------------------------------------+
      CMP2.00 SI-Data compello integration - page action -show document
    }
    END.
  }
}

OBJECT Page 140 Posted Purchase Credit Memo
{
  OBJECT-PROPERTIES
  {
    Date=01.10.16;
    Time=11:00:00;
    Modified=Yes;
    Version List=NAVW110.00.00.15052,CMP2.00;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Posted Purchase Credit Memo;
               NOR=Bokf›rt kj›pskreditnota];
    InsertAllowed=No;
    ModifyAllowed=No;
    SourceTable=Table124;
    PageType=Document;
    RefreshOnActivate=Yes;
    PromotedActionCategoriesML=[ENU=New,Process,Report,Cancel;
                                NOR=Ny,Prosess,Rapport,Avbryt];
    OnOpenPage=VAR
                 OfficeMgt@1000 : Codeunit 1630;
               BEGIN
                 SetSecurityFilterOnRespCenter;
                 IsOfficeAddin := OfficeMgt.IsAvailable;
               END;

    OnAfterGetCurrRecord=VAR
                           IncomingDocument@1000 : Record 130;
                         BEGIN
                           HasIncomingDocument := IncomingDocument.PostedDocExists("No.","Posting Date");
                           CurrPage.IncomingDocAttachFactBox.PAGE.LoadDataFromRecord(Rec);
                         END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 45      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Cr. Memo;
                                 NOR=Kredi&tnota];
                      Image=CreditMemo }
      { 8       ;2   ;Action    ;
                      Name=Statistics;
                      ShortCutKey=F7;
                      CaptionML=[ENU=Statistics;
                                 NOR=Statistikk];
                      RunObject=Page 401;
                      RunPageLink=No.=FIELD(No.);
                      Promoted=Yes;
                      Image=Statistics;
                      PromotedCategory=Process }
      { 47      ;2   ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 NOR=&Merknader];
                      ToolTipML=[ENU=View or add notes about the posted purchase credit memo.;
                                 NOR=Viser eller legger til merknader om den bokf›rte kj›pskreditnotaen.];
                      RunObject=Page 66;
                      RunPageLink=Document Type=CONST(Posted Credit Memo),
                                  No.=FIELD(No.),
                                  Document Line No.=CONST(0);
                      Image=ViewComments }
      { 79      ;2   ;Action    ;
                      AccessByPermission=TableData 348=R;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 NOR=Dimensjoner];
                      ToolTipML=[ENU=View or edits dimensions, such as area, project, or department, that you can assign to sales and purchase documents to distribute costs and analyze transaction history.;
                                 NOR=Vis eller rediger dimensjoner, for eksempel omr†de, prosjekt eller avdeling, som du kan tilordne til salgs- og kj›psdokumenter for † distribuere kostnader og analysere transaksjonshistorikk.];
                      ApplicationArea=#Suite;
                      Image=Dimensions;
                      OnAction=BEGIN
                                 ShowDimensions;
                               END;
                                }
      { 88      ;2   ;Action    ;
                      AccessByPermission=TableData 456=R;
                      CaptionML=[ENU=Approvals;
                                 NOR=Godkjenninger];
                      ToolTipML=[ENU=View a list of the records that are waiting to be approved. For example, you can see who requested the record to be approved, when it was sent, and when it is due to be approved.;
                                 NOR=Vis en liste med poster dom venter p† † bli godkjent. Du kan for eksempel se hvem som har bedt om godkjenning av posten, n†r den ble sendt og n†r den forfaller til godkjenning.];
                      ApplicationArea=#Suite;
                      Image=Approvals;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.ShowPostedApprovalEntries(RECORDID);
                               END;
                                }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 15      ;1   ;Action    ;
                      ShortCutKey=Shift+F7;
                      CaptionML=[ENU=Vendor;
                                 NOR=Leverand›r];
                      ToolTipML=[ENU=View or edit detailed information about the vendor on the selected posted purchase document.;
                                 NOR=Vis eller rediger detaljert informasjon om leverand›ren i det valgte bokf›rte kj›psdokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 26;
                      RunPageLink=No.=FIELD(Buy-from Vendor No.);
                      Promoted=Yes;
                      Image=Vendor;
                      PromotedCategory=Process }
      { 48      ;1   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=&Print;
                                 NOR=&Skriv ut];
                      ToolTipML=[ENU=Prepare to print the document. A report request window for the document opens where you can specify what to include on the print-out.;
                                 NOR=Klargj›r for † skrive ut dokumentet. Det vises et rapportforesp›rselsvindu for dokumentet der du kan angi hva som skal inkluderes p† utskriften.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Visible=NOT IsOfficeAddin;
                      Image=Print;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CurrPage.SETSELECTIONFILTER(PurchCrMemoHeader);
                                 PurchCrMemoHeader.PrintRecords(TRUE);
                               END;
                                }
      { 49      ;1   ;Action    ;
                      CaptionML=[ENU=&Navigate;
                                 NOR=&Naviger];
                      ToolTipML=[ENU=Find all entries and documents that exist for the document number and posting date on the selected entry or document.;
                                 NOR=Finn alle oppf›ringer og dokumenter som finnes for dokumentnummeret og bokf›ringsdatoen i den valgte oppf›ringen eller dokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Visible=NOT IsOfficeAddin;
                      Image=Navigate;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Navigate;
                               END;
                                }
      { 1101103001;1 ;Action    ;
                      Name=Open Document in Compello;
                      CaptionML=[ENU=Open Document in Compello;
                                 NOR=pne Dokument i Compello];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Document;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 CompelloShowDoc@1101103000 : Codeunit 70006;
                               BEGIN
                                 CompelloShowDoc.ShowCompelloDocPurchaseCrMemoHeader(Rec);
                               END;
                                }
      { 29      ;1   ;ActionGroup;
                      CaptionML=[ENU=Cancel;
                                 NOR=Annuller] }
      { 24      ;2   ;Action    ;
                      Name=CancelCrMemo;
                      CaptionML=[ENU=Cancel;
                                 NOR=Annuller];
                      ToolTipML=[ENU=Create and post a purchase invoice that reverses this posted purchase credit memo. This posted purchase credit memo will be canceled.;
                                 NOR=Opprett og bokf›r en kj›psfaktura som tilbakef›rer denne bokf›rte kj›pskreditnotaen. Denne bokf›rte kj›pskreditnotaen vil bli annullert.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Cancel;
                      PromotedCategory=Category4;
                      OnAction=BEGIN
                                 CODEUNIT.RUN(CODEUNIT::"Cancel PstdPurchCrM (Yes/No)",Rec);
                               END;
                                }
      { 27      ;2   ;Action    ;
                      Name=ShowInvoice;
                      CaptionML=[ENU=Show Canceled/Corrective Invoice;
                                 NOR=Vis annullert/korrigerende faktura];
                      ToolTipML=[ENU=Open the posted sales invoice that was created when you canceled the posted sales credit memo. If the posted sales credit memo is the result of a canceled sales invoice, then canceled invoice will open.;
                                 NOR=pne den bokf›rte salgsfakturaen som ble opprettet da du kansellerte den bokf›rte salgskreditnotaen. Hvis den bokf›rte salgskreditnotaen er et resultat av den kansellerte salgsfakturaen, s† vil den kansellerte fakturaen bli †pnet.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Enabled=Cancelled OR Corrective;
                      PromotedIsBig=Yes;
                      Image=Invoice;
                      PromotedCategory=Category4;
                      Scope=Repeater;
                      OnAction=BEGIN
                                 ShowCanceledOrCorrInvoice;
                               END;
                                }
      { 13      ;1   ;ActionGroup;
                      Name=IncomingDocument;
                      CaptionML=[ENU=Incoming Document;
                                 NOR=Inng†ende dokument];
                      ActionContainerType=NewDocumentItems;
                      Image=Documents }
      { 11      ;2   ;Action    ;
                      Name=IncomingDocCard;
                      CaptionML=[ENU=View Incoming Document;
                                 NOR=Vis inng†ende dokument];
                      ToolTipML=[ENU=View any incoming document records and file attachments that exist for the entry or document.;
                                 NOR=Vis poster og filvedlegg for innkommende dokument som finnes for oppf›ringen eller dokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      Visible=NOT IsOfficeAddin;
                      Enabled=HasIncomingDocument;
                      Image=ViewOrder;
                      OnAction=VAR
                                 IncomingDocument@1000 : Record 130;
                               BEGIN
                                 IncomingDocument.ShowCard("No.","Posting Date");
                               END;
                                }
      { 9       ;2   ;Action    ;
                      Name=SelectIncomingDoc;
                      AccessByPermission=TableData 130=R;
                      CaptionML=[ENU=Select Incoming Document;
                                 NOR=Velg inng†ende dokument];
                      ToolTipML=[ENU=Select an incoming document record and file attachment that you want to link to the entry or document.;
                                 NOR=Velg en post og et filvedlegg for innkommende dokument som du vil koble til oppf›ringen eller dokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      Enabled=NOT HasIncomingDocument;
                      Image=SelectLineToApply;
                      OnAction=VAR
                                 IncomingDocument@1000 : Record 130;
                               BEGIN
                                 IncomingDocument.SelectIncomingDocumentForPostedDocument("No.","Posting Date",RECORDID);
                               END;
                                }
      { 5       ;2   ;Action    ;
                      Name=IncomingDocAttachFile;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Create Incoming Document from File;
                                 NOR=Opprett inng†ende dokument fra fil];
                      ToolTipML=[ENU=Create an incoming document record by selecting a file to attach, and then link the incoming document record to the entry or document.;
                                 NOR=Opprett en post for innkommende dokument ved † velge en fil som skal legges ved, og koble deretter posten for det innkommende dokumentet til oppf›ringen eller dokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      Enabled=NOT HasIncomingDocument;
                      Image=Attach;
                      OnAction=VAR
                                 IncomingDocumentAttachment@1000 : Record 133;
                               BEGIN
                                 IncomingDocumentAttachment.NewAttachmentFromPostedDocument("No.","Posting Date");
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=[ENU=General;
                           NOR=Generelt] }

    { 2   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the posted credit memo number.;
                           NOR=Angir nummeret p† den bokf›rte kreditnotaen.];
                ApplicationArea=#All;
                SourceExpr="No.";
                Importance=Promoted;
                Editable=FALSE }

    { 51  ;2   ;Field     ;
                CaptionML=[ENU=Vendor;
                           NOR=Leverand›r];
                ToolTipML=[ENU=Specifies the name of the vendor who shipped the items.;
                           NOR=Angir navnet p† leverand›ren som leverte varene.];
                ApplicationArea=#All;
                SourceExpr="Buy-from Vendor Name";
                TableRelation=Vendor.Name;
                Importance=Promoted;
                Editable=FALSE }

    { 4   ;2   ;Group     ;
                CaptionML=[ENU=Buy-from;
                           NOR=Kj›p fra];
                GroupType=Group }

    { 53  ;3   ;Field     ;
                CaptionML=[ENU=Address;
                           NOR=Adresse];
                ToolTipML=[ENU=Specifies the address of the vendor who shipped the items.;
                           NOR=Angir adressen til leverand›ren som leverte varene.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Buy-from Address";
                Importance=Additional;
                Editable=FALSE }

    { 55  ;3   ;Field     ;
                CaptionML=[ENU=Address 2;
                           NOR=Adresse 2];
                ToolTipML=[ENU=Specifies additional address information.;
                           NOR=Angir ekstra adresseinformasjon.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Buy-from Address 2";
                Importance=Additional;
                Editable=FALSE }

    { 6   ;3   ;Field     ;
                CaptionML=[ENU=Post Code;
                           NOR=Postnr.];
                ToolTipML=[ENU=Specifies the postal code.;
                           NOR=Angir postnummeret.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Buy-from Post Code";
                Importance=Additional;
                Editable=FALSE }

    { 57  ;3   ;Field     ;
                CaptionML=[ENU=City;
                           NOR=Sted];
                ToolTipML=[ENU=Specifies the city of the vendor who shipped the items.;
                           NOR=Angir poststedet til leverand›ren som leverte varene.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Buy-from City";
                Importance=Additional;
                Editable=FALSE }

    { 91  ;3   ;Field     ;
                CaptionML=[ENU=Contact No.;
                           NOR=Kontaktnr.];
                ToolTipML=[ENU=Specifies the number of the contact who you sent the purchase credit memo to.;
                           NOR=Angir nummeret til kontakten som du sendte kj›pskreditnotaen til.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Buy-from Contact No.";
                Importance=Additional;
                Editable=FALSE }

    { 59  ;2   ;Field     ;
                CaptionML=[ENU=Contact;
                           NOR=Kontakt];
                ToolTipML=[ENU=Specifies the name of the person to contact at the vendor who shipped the items.;
                           NOR=Angir navnet p† kontaktpersonen hos den leverand›ren som leverte varene.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Buy-from Contact";
                Editable=FALSE }

    { 12  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date the credit memo was posted.;
                           NOR=Angir datoen da kreditnotaen ble bokf›rt.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Posting Date";
                Importance=Promoted;
                Editable=FALSE }

    { 31  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date on which the purchase document was created.;
                           NOR=Angir datoen da kj›psdokumentet ble opprettet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Document Date";
                Editable=FALSE }

    { 63  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the credit memo that the posted credit memo was created from.;
                           NOR=Angir nummeret p† kreditnotaen som den bokf›rte kreditnotaen ble opprettet fra.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pre-Assigned No.";
                Importance=Additional;
                Editable=FALSE }

    { 14  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the vendor's number for this credit memo.;
                           NOR=Angir leverand›rnummeret for denne kreditnotaen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Vendor Cr. Memo No.";
                Importance=Promoted;
                Editable=FALSE }

    { 7   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the order address code used in the credit memo.;
                           NOR=Angir bestillingsadressekoden som brukes i kreditnotaen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Order Address Code";
                Editable=FALSE }

    { 10  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies which purchaser is associated with the credit memo.;
                           NOR=Angir hvilken innkj›per som er knyttet til kreditnotaen.];
                ApplicationArea=#Suite;
                SourceExpr="Purchaser Code";
                Importance=Additional;
                Editable=FALSE }

    { 80  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for the responsibility center that serves the vendor on this purchase document.;
                           NOR=Angir koden for ansvarssenteret som betjener leverand›ren p† dette kj›psdokumentet.];
                SourceExpr="Responsibility Center";
                Importance=Additional;
                Editable=FALSE }

    { 21  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies if the posted purchase invoice that relates to this purchase credit memo has been either corrected or canceled.;
                           NOR=Angir om den bokf›rte kj›psfakturaen som er knyttet til denne kj›pskreditnotaen, er blitt korrigert eller kansellert.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Cancelled;
                Importance=Additional;
                Style=Unfavorable;
                StyleExpr=Cancelled;
                OnDrillDown=BEGIN
                              ShowCorrectiveInvoice;
                            END;
                             }

    { 23  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies if the posted purchase invoice has been either corrected or canceled by this purchase credit memo .;
                           NOR=Angir om den bokf›rte kj›psfakturaen er blitt korrigert eller kansellert av denne kj›pskreditnotaen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Corrective;
                Importance=Additional;
                Style=Unfavorable;
                StyleExpr=Corrective;
                OnDrillDown=BEGIN
                              ShowCancelledInvoice;
                            END;
                             }

    { 20  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies how many times the credit memo has been printed.;
                           NOR=Angir hvor mange ganger kreditnotaen har blitt skrevet ut.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="No. Printed";
                Importance=Additional;
                Editable=FALSE }

    { 44  ;1   ;Part      ;
                Name=PurchCrMemoLines;
                ApplicationArea=#Basic,#Suite;
                SubPageLink=Document No.=FIELD(No.);
                PagePartID=Page141 }

    { 1905885101;1;Group  ;
                CaptionML=[ENU=Invoice Details;
                           NOR=Fakturadetaljer];
                GroupType=Group }

    { 75  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the currency code used to calculate the amounts on the credit memo.;
                           NOR=Angir valutakoden som er brukt til † beregne bel›pene i kreditnotaen.];
                ApplicationArea=#Suite;
                SourceExpr="Currency Code";
                Importance=Promoted;
                OnAssistEdit=BEGIN
                               ChangeExchangeRate.SetParameter("Currency Code","Currency Factor","Posting Date");
                               ChangeExchangeRate.EDITABLE(FALSE);
                               IF ChangeExchangeRate.RUNMODAL = ACTION::OK THEN BEGIN
                                 "Currency Factor" := ChangeExchangeRate.GetParameter;
                                 MODIFY;
                               END;
                               CLEAR(ChangeExchangeRate);
                             END;
                              }

    { 64  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for Shortcut Dimension 1.;
                           NOR=Angir koden for Snarveisdimensjon 1.];
                ApplicationArea=#Suite;
                SourceExpr="Shortcut Dimension 1 Code";
                Importance=Additional;
                Editable=FALSE }

    { 66  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for Shortcut Dimension 2.;
                           NOR=Angir koden for Snarveisdimensjon 2.];
                ApplicationArea=#Suite;
                SourceExpr="Shortcut Dimension 2 Code";
                Importance=Additional;
                Editable=FALSE }

    { 68  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for the location used when you posted the credit memo.;
                           NOR=Angir koden for lokasjonen som er brukt i bokf›ringen av kreditnotaen.];
                SourceExpr="Location Code";
                Editable=FALSE }

    { 16  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the type of the posted document that this document or journal line is applied to.;
                           NOR=Angir typen p† det bokf›rte dokumentet som dokumentet eller kladdelinjen er brukt for.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Applies-to Doc. Type";
                Editable=FALSE }

    { 18  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the posted document that this document or journal line is applied to.;
                           NOR=Angir nummeret p† det bokf›rte dokumentet som dokumentet eller kladdelinjen er brukt for.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Applies-to Doc. No.";
                Editable=FALSE }

    { 1906801201;1;Group  ;
                CaptionML=[ENU=Shipping and Payment;
                           NOR=Levering og betaling];
                GroupType=Group }

    { 19  ;2   ;Group     ;
                CaptionML=[ENU=Ship-to;
                           NOR=Lever til];
                GroupType=Group }

    { 34  ;3   ;Field     ;
                CaptionML=[ENU=Name;
                           NOR=Navn];
                ToolTipML=[ENU=Specifies the name of the company at the address to which the items in the purchase order were shipped.;
                           NOR=Angir navnet p† selskapet med adressen som varene i bestillingen ble levert til.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Name";
                Editable=FALSE }

    { 36  ;3   ;Field     ;
                CaptionML=[ENU=Address;
                           NOR=Adresse];
                ToolTipML=[ENU=Specifies the address that the items in the purchase order were shipped to.;
                           NOR=Angir adressen du vil at varene i bestillingen ble levert til.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Address";
                Editable=FALSE }

    { 38  ;3   ;Field     ;
                CaptionML=[ENU=Address 2;
                           NOR=Adresse 2];
                ToolTipML=[ENU=Specifies additional address information.;
                           NOR=Angir ekstra adresseinformasjon.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Address 2";
                Editable=FALSE }

    { 72  ;3   ;Field     ;
                CaptionML=[ENU=Post Code;
                           NOR=Postnr.];
                ToolTipML=[ENU=Specifies the postal code.;
                           NOR=Angir postnummeret.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Post Code";
                Editable=FALSE }

    { 40  ;3   ;Field     ;
                CaptionML=[ENU=City;
                           NOR=Sted];
                ToolTipML=[ENU=Specifies the city the items in the purchase order were shipped to.;
                           NOR=Angir poststedet du vil at varene i bestillingen ble levert til.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to City";
                Editable=FALSE }

    { 42  ;3   ;Field     ;
                CaptionML=[ENU=Contact;
                           NOR=Kontakt];
                ToolTipML=[ENU=Specifies the name of a contact person at the address that the items were shipped to.;
                           NOR=Angir navnet p† en kontaktperson p† adressen som varene ble levert til.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Contact";
                Editable=FALSE }

    { 17  ;2   ;Group     ;
                CaptionML=[ENU=Pay-to;
                           NOR=Betal til];
                GroupType=Group }

    { 22  ;3   ;Field     ;
                CaptionML=[ENU=Name;
                           NOR=Navn];
                ToolTipML=[ENU=Specifies the name of the vendor that you received the credit memo from.;
                           NOR=Angir navnet p† leverand›ren som du har mottatt kreditnotaen fra.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pay-to Name";
                Importance=Promoted;
                Editable=FALSE }

    { 26  ;3   ;Field     ;
                CaptionML=[ENU=Address;
                           NOR=Adresse];
                ToolTipML=[ENU=Specifies the address of the vendor that you received the credit memo from.;
                           NOR=Angir adressen til leverand›ren som du har mottatt kreditnotaen fra.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pay-to Address";
                Importance=Additional;
                Editable=FALSE }

    { 28  ;3   ;Field     ;
                CaptionML=[ENU=Address 2;
                           NOR=Adresse 2];
                ToolTipML=[ENU=Specifies additional address information.;
                           NOR=Angir ekstra adresseinformasjon.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pay-to Address 2";
                Importance=Additional;
                Editable=FALSE }

    { 70  ;3   ;Field     ;
                CaptionML=[ENU=Post Code;
                           NOR=Postnr.];
                ToolTipML=[ENU=Specifies the postal code.;
                           NOR=Angir postnummeret.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pay-to Post Code";
                Importance=Additional;
                Editable=FALSE }

    { 30  ;3   ;Field     ;
                CaptionML=[ENU=City;
                           NOR=Sted];
                ToolTipML=[ENU=Specifies the city of the vendor you received the credit memo from.;
                           NOR=Angir poststedet til leverand›ren som du har mottatt kreditnotaen fra.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pay-to City";
                Importance=Additional;
                Editable=FALSE }

    { 93  ;3   ;Field     ;
                CaptionML=[ENU=Contact No.;
                           NOR=Kontaktnr.];
                ToolTipML=[ENU=Specifies the number of the contact at the vendor who handles the credit memo.;
                           NOR=Angir nummeret til kontakten hos leverand›ren som behandler kreditnotaen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pay-to Contact No.";
                Importance=Additional;
                Editable=FALSE }

    { 32  ;3   ;Field     ;
                CaptionML=[ENU=Contact;
                           NOR=Kontakt];
                ToolTipML=[ENU=Specifies the name of the person you should contact at the vendor who you received the credit memo from.;
                           NOR=Angir navnet p† kontaktperson hos leverand›ren som du mottok kreditnotaen fra.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pay-to Contact";
                Editable=FALSE }

    { 1907468901;1;Group  ;
                CaptionML=[ENU=Foreign Trade;
                           NOR=Utenrikshandel] }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 3   ;1   ;Part      ;
                Name=IncomingDocAttachFactBox;
                ApplicationArea=#Basic,#Suite;
                PagePartID=Page193;
                Visible=NOT IsOfficeAddin;
                PartType=Page;
                ShowFilter=No }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      PurchCrMemoHeader@1000 : Record 124;
      ChangeExchangeRate@1001 : Page 511;
      HasIncomingDocument@1002 : Boolean;
      IsOfficeAddin@1003 : Boolean;

    BEGIN
    {
      +---------------------------------------------+
      | SI-Data                                     |
      +---------------------------------------------+
      No. Date     Id  Description
      CMP2.00 - SI-Data compello Integratin - page action - Show document in Compello
    }
    END.
  }
}

OBJECT Page 145 Posted Purchase Receipts
{
  OBJECT-PROPERTIES
  {
    Date=07.02.17;
    Time=08:50:13;
    Modified=Yes;
    Version List=NAVW110.00,CMP2.00,SID.04;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Posted Purchase Receipts;
               NOR=Bokf›rte mottak];
    SourceTable=Table120;
    SourceTableView=SORTING(Posting Date)
                    ORDER(Descending);
    PageType=List;
    CardPageID=Posted Purchase Receipt;
    OnOpenPage=VAR
                 OfficeMgt@1000 : Codeunit 1630;
                 CompelloMgt@1101103000 : Codeunit 70005;
               BEGIN
                 SetSecurityFilterOnRespCenter;
                 //02. 28.05.15 CMP2.00 -->
                 EnableResendToCompelloAction := CompelloMgt.UserInAdminRole;
                 //02. 28.05.15 CMP2.00 -->
                 IF FINDFIRST THEN;
                 IsOfficeAddin := OfficeMgt.IsAvailable;
               END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 8       ;1   ;ActionGroup;
                      CaptionML=[ENU=&Receipt;
                                 NOR=&Mottak];
                      Image=Receipt }
      { 23      ;2   ;Action    ;
                      ShortCutKey=F7;
                      CaptionML=[ENU=Statistics;
                                 NOR=Statistikk];
                      RunObject=Page 399;
                      RunPageLink=No.=FIELD(No.);
                      Promoted=Yes;
                      Image=Statistics;
                      PromotedCategory=Process }
      { 24      ;2   ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 NOR=&Merknader];
                      RunObject=Page 66;
                      RunPageLink=Document Type=CONST(Receipt),
                                  No.=FIELD(No.);
                      Image=ViewComments }
      { 1102601000;2 ;Action    ;
                      AccessByPermission=TableData 348=R;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 NOR=Dimensjoner];
                      ToolTipML=[ENU=View or edit dimensions, such as area, project, or department, that you can assign to sales and purchase documents to distribute costs and analyze transaction history.;
                                 NOR=Vis eller rediger dimensjoner, for eksempel omr†de, prosjekt eller avdeling, som du kan tilordne til salgs- og kj›psdokumenter for † distribuere kostnader og analysere transaksjonshistorikk.];
                      ApplicationArea=#Suite;
                      Image=Dimensions;
                      OnAction=BEGIN
                                 ShowDimensions;
                               END;
                                }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 9       ;1   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=&Print;
                                 NOR=&Skriv ut];
                      Promoted=Yes;
                      Visible=NOT IsOfficeAddin;
                      Image=Print;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 PurchRcptHeader@1102 : Record 120;
                               BEGIN
                                 CurrPage.SETSELECTIONFILTER(PurchRcptHeader);
                                 PurchRcptHeader.PrintRecords(TRUE);
                               END;
                                }
      { 17      ;1   ;Action    ;
                      CaptionML=[ENU=&Navigate;
                                 NOR=&Naviger];
                      Promoted=Yes;
                      Visible=NOT IsOfficeAddin;
                      Image=Navigate;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Navigate;
                               END;
                                }
      { 1101103002;1 ;Action    ;
                      Name=Resend to Compello;
                      Promoted=Yes;
                      Visible=true;
                      Enabled=[EnableResendToCompelloAction ];
                      PromotedIsBig=Yes;
                      Image=ReOpen;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 RecRef@1101103000 : RecordRef;
                                 CompelloIntgr@1101103001 : Codeunit 70000;
                               BEGIN

                                 CompelloIntgr.ResendReceipt(Rec."No.");
                                 MESSAGE('Receipt send to Compello ' + Rec."No.");
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 4   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the receipt number.;
                           NOR=Angir mottaksnummeret.];
                ApplicationArea=#Suite;
                SourceExpr="No." }

    { 2   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the vendor that you bought the items from.;
                           NOR=Angir nummeret p† leverand›ren som du kj›pte varene fra.];
                SourceExpr="Buy-from Vendor No." }

    { 1101103000;2;Field  ;
                SourceExpr="Order No." }

    { 13  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the order address code used in the receipt.;
                           NOR=Angir bestillingsadressekoden som brukes i mottaket.];
                SourceExpr="Order Address Code";
                Visible=FALSE }

    { 6   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the name of the vendor who delivered the items.;
                           NOR=Angir navnet p† leverand›ren som leverte varene.];
                ApplicationArea=#Suite;
                SourceExpr="Buy-from Vendor Name" }

    { 25  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the postal code of the address.;
                           NOR=Angir postnummeret for adressen.];
                SourceExpr="Buy-from Post Code";
                Visible=FALSE }

    { 21  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the country/region code of the address.;
                           NOR=Angir lands-/omr†dekoden for adressen.];
                SourceExpr="Buy-from Country/Region Code";
                Visible=FALSE }

    { 33  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the name of the person to contact at the vendor who shipped the items.;
                           NOR=Angir navnet p† kontaktpersonen hos den leverand›ren som leverte varene.];
                SourceExpr="Buy-from Contact";
                Visible=FALSE }

    { 103 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the vendor who invoiced the shipment.;
                           NOR=Angir nummeret p† leverand›ren som fakturerte leveringen.];
                SourceExpr="Pay-to Vendor No.";
                Visible=FALSE }

    { 101 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the name of the vendor who invoiced the shipment.;
                           NOR=Angir navnet p† leverand›ren som fakturerte leveringen.];
                SourceExpr="Pay-to Name";
                Visible=FALSE }

    { 31  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the postal code of the address.;
                           NOR=Angir postnummeret for adressen.];
                SourceExpr="Pay-to Post Code";
                Visible=FALSE }

    { 27  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the country/region code of the address.;
                           NOR=Angir lands-/omr†dekoden for adressen.];
                SourceExpr="Pay-to Country/Region Code";
                Visible=FALSE }

    { 91  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the name of the person you should contact at the vendor who invoiced the shipment.;
                           NOR=Angir navnet p† kontaktperson hos leverand›ren som fakturerte leveringen.];
                SourceExpr="Pay-to Contact";
                Visible=FALSE }

    { 87  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the shipment of the sales order that is linked to the purchase order for drop shipment from the vendor to a customer.;
                           NOR=Angir leveringen av ordren som er koblet til bestillingen for direkte levering fra leverand›r til en kunde.];
                SourceExpr="Ship-to Code";
                Visible=FALSE }

    { 85  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the name of the company at the address to which the items were shipped.;
                           NOR=Angir navnet p† selskapet med adressen som varene ble levert til.];
                SourceExpr="Ship-to Name";
                Visible=FALSE }

    { 1101103003;2;Field  ;
                SourceExpr="Ship-to Address" }

    { 1101103004;2;Field  ;
                SourceExpr="Your Reference" }

    { 1101103001;2;Field  ;
                ToolTipML=[ENU=Specifies the name of the contact person at the address that products will be shipped to.;
                           NOR=Angir navnet p† kontaktpersonen i adressen som produkter skal leveres til.];
                SourceExpr="Ship-to Contact";
                Visible=FALSE }

    { 19  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the postal code of the address.;
                           NOR=Angir postnummeret for adressen.];
                SourceExpr="Ship-to Post Code";
                Visible=FALSE }

    { 15  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the country/region code of the address.;
                           NOR=Angir lands-/omr†dekoden for adressen.];
                SourceExpr="Ship-to Country/Region Code";
                Visible=FALSE }

    { 71  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date the purchase header was posted.;
                           NOR=Angir datoen da bestillingshodet ble bokf›rt.];
                ApplicationArea=#Suite;
                SourceExpr="Posting Date";
                Visible=FALSE }

    { 57  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies which purchaser is associated with the receipt.;
                           NOR=Angir hvilken innkj›per som er tilknyttet mottaket.];
                ApplicationArea=#Suite;
                SourceExpr="Purchaser Code";
                Visible=FALSE }

    { 63  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for Shortcut Dimension 1.;
                           NOR=Angir koden for Snarveisdimensjon 1.];
                ApplicationArea=#Suite;
                SourceExpr="Shortcut Dimension 1 Code";
                Visible=FALSE }

    { 61  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for Shortcut Dimension 2.;
                           NOR=Angir koden for Snarveisdimensjon 2.];
                ApplicationArea=#Suite;
                SourceExpr="Shortcut Dimension 2 Code";
                Visible=FALSE }

    { 65  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for the location where the items on the receipt were registered.;
                           NOR=Angir koden for lokasjonen der varene i leveransen er registrert.];
                SourceExpr="Location Code";
                Visible=TRUE }

    { 53  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies how many times the receipt has been printed.;
                           NOR=Angir hvor mange ganger kvitteringen har blitt skrevet ut.];
                SourceExpr="No. Printed" }

    { 1102601001;2;Field  ;
                ToolTipML=[ENU=Specifies the date when the purchase document was created.;
                           NOR=Angir datoen da kj›psdokumentet ble opprettet.];
                ApplicationArea=#Suite;
                SourceExpr="Document Date";
                Visible=FALSE }

    { 1102601003;2;Field  ;
                ToolTipML=[ENU=Specifies the code used to find the shipment method for this receipt.;
                           NOR=Angir koden som brukes til † finne leveringsm†ten for dette mottaket.];
                SourceExpr="Shipment Method Code";
                Visible=FALSE }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=TRUE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      IsOfficeAddin@1000 : Boolean;
      EnableResendToCompelloAction@1101103000 : Boolean INDATASET;
      PostedReceiveHead@1101103001 : Record 120;

    BEGIN
    {
      +---------------------------------------------+
      | SI-Data                                     |
      +---------------------------------------------+
      No. Date     Id  Description
      CMP2.00CMP2.00 - Added "Resend to Compello" action item and visibility code.

      SID.01 :: Show field :: "Order No."
      SID.02 :: Show field : "Ship-to Address"
      SID.03 :: Show field : "Your Reference"
      SID.04 :: Show field : "Ship-to Contact" (std on some pages)
    }
    END.
  }
}

OBJECT Page 147 Posted Purchase Credit Memos
{
  OBJECT-PROPERTIES
  {
    Date=07.02.17;
    Time=08:50:37;
    Modified=Yes;
    Version List=NAVW110.00,CMP2.00,SID.02;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Posted Purchase Credit Memos;
               NOR=Bokf›rte kj›pskreditnotaer];
    SourceTable=Table124;
    SourceTableView=SORTING(Posting Date)
                    ORDER(Descending);
    PageType=List;
    CardPageID=Posted Purchase Credit Memo;
    PromotedActionCategoriesML=[ENU=New,Process,Report,Cancel;
                                NOR=Ny,Prosess,Rapport,Avbryt];
    OnOpenPage=VAR
                 OfficeMgt@1000 : Codeunit 1630;
               BEGIN
                 SetSecurityFilterOnRespCenter;
                 IF FINDFIRST THEN;
                 IsOfficeAddin := OfficeMgt.IsAvailable;
               END;

    OnAfterGetCurrRecord=BEGIN
                           CurrPage.IncomingDocAttachFactBox.PAGE.LoadDataFromRecord(Rec);
                         END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 23      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Cr. Memo;
                                 NOR=Kredi&tnota];
                      Image=CreditMemo }
      { 29      ;2   ;Action    ;
                      ShortCutKey=F7;
                      CaptionML=[ENU=Statistics;
                                 NOR=Statistikk];
                      RunObject=Page 401;
                      RunPageLink=No.=FIELD(No.);
                      Promoted=Yes;
                      Image=Statistics;
                      PromotedCategory=Process }
      { 30      ;2   ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 NOR=&Merknader];
                      ToolTipML=[ENU=View or add notes about the posted purchase credit memo.;
                                 NOR=Viser eller legger til merknader om den bokf›rte kj›pskreditnotaen.];
                      RunObject=Page 66;
                      RunPageLink=Document Type=CONST(Posted Credit Memo),
                                  No.=FIELD(No.);
                      Image=ViewComments }
      { 1102601000;2 ;Action    ;
                      AccessByPermission=TableData 348=R;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 NOR=Dimensjoner];
                      ToolTipML=[ENU=View or edit dimensions, such as area, project, or department, that you can assign to sales and purchase documents to distribute costs and analyze transaction history.;
                                 NOR=Vis eller rediger dimensjoner, for eksempel omr†de, prosjekt eller avdeling, som du kan tilordne til salgs- og kj›psdokumenter for † distribuere kostnader og analysere transaksjonshistorikk.];
                      ApplicationArea=#Suite;
                      Image=Dimensions;
                      OnAction=BEGIN
                                 ShowDimensions;
                               END;
                                }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 5       ;1   ;Action    ;
                      ShortCutKey=Shift+F7;
                      CaptionML=[ENU=Vendor;
                                 NOR=Leverand›r];
                      ToolTipML=[ENU=View or edit detailed information about the vendor on the selected posted purchase document.;
                                 NOR=Vis eller rediger detaljert informasjon om leverand›ren i det valgte bokf›rte kj›psdokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 26;
                      RunPageLink=No.=FIELD(Buy-from Vendor No.);
                      Promoted=Yes;
                      Image=Vendor;
                      PromotedCategory=Process;
                      Scope=Repeater }
      { 21      ;1   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=&Print;
                                 NOR=&Skriv ut];
                      ToolTipML=[ENU=Prepare to print the document. A report request window for the document opens where you can specify what to include on the print-out.;
                                 NOR=Klargj›r for † skrive ut dokumentet. Det vises et rapportforesp›rselsvindu for dokumentet der du kan angi hva som skal inkluderes p† utskriften.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Visible=NOT IsOfficeAddin;
                      Image=Print;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 PurchCrMemoHdr@1102 : Record 124;
                               BEGIN
                                 CurrPage.SETSELECTIONFILTER(PurchCrMemoHdr);
                                 PurchCrMemoHdr.PrintRecords(TRUE);
                               END;
                                }
      { 22      ;1   ;Action    ;
                      CaptionML=[ENU=&Navigate;
                                 NOR=&Naviger];
                      ToolTipML=[ENU=Find all entries and documents that exist for the document number and posting date on the selected entry or document.;
                                 NOR=Finn alle oppf›ringer og dokumenter som finnes for dokumentnummeret og bokf›ringsdatoen i den valgte oppf›ringen eller dokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Visible=NOT IsOfficeAddin;
                      Image=Navigate;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Navigate;
                               END;
                                }
      { 1101103000;1 ;Action    ;
                      Name=Open Document in Compello;
                      CaptionML=[ENU=Open Document in Compello;
                                 NOR=pne Dokument i Compello];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Document;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 CompelloShowDoc@1101103000 : Codeunit 70006;
                               BEGIN
                                 CompelloShowDoc.ShowCompelloDocPurchaseCrMemoHeader(Rec);
                               END;
                                }
      { 20      ;1   ;ActionGroup;
                      CaptionML=[ENU=Cancel;
                                 NOR=Annuller] }
      { 14      ;2   ;Action    ;
                      Name=CancelCrMemo;
                      CaptionML=[ENU=Cancel;
                                 NOR=Annuller];
                      ToolTipML=[ENU=Create and post a purchase invoice that reverses this posted purchase credit memo. This posted purchase credit memo will be canceled.;
                                 NOR=Opprett og bokf›r en kj›psfaktura som tilbakef›rer denne bokf›rte kj›pskreditnotaen. Denne bokf›rte kj›pskreditnotaen vil bli annullert.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Cancel;
                      PromotedCategory=Category4;
                      Scope=Repeater;
                      OnAction=BEGIN
                                 CODEUNIT.RUN(CODEUNIT::"Cancel PstdPurchCrM (Yes/No)",Rec);
                               END;
                                }
      { 16      ;2   ;Action    ;
                      Name=ShowInvoice;
                      CaptionML=[ENU=Show Canceled/Corrective Invoice;
                                 NOR=Vis annullert/korrigerende faktura];
                      ToolTipML=[ENU=Open the posted sales invoice that was created when you canceled the posted sales credit memo. If the posted sales credit memo is the result of a canceled sales invoice, then canceled invoice will open.;
                                 NOR=pne den bokf›rte salgsfakturaen som ble opprettet da du kansellerte den bokf›rte salgskreditnotaen. Hvis den bokf›rte salgskreditnotaen er et resultat av den kansellerte salgsfakturaen, s† vil den kansellerte fakturaen bli †pnet.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Enabled=Cancelled OR Corrective;
                      PromotedIsBig=Yes;
                      Image=Invoice;
                      PromotedCategory=Category4;
                      Scope=Repeater;
                      OnAction=BEGIN
                                 ShowCanceledOrCorrInvoice;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the posted credit memo number.;
                           NOR=Angir nummeret p† den bokf›rte kreditnotaen.];
                ApplicationArea=#All;
                SourceExpr="No." }

    { 4   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the vendor associated with the credit memo.;
                           NOR=Angir leverand›rnummeret som er tilknyttet kreditnotaen.];
                ApplicationArea=#All;
                SourceExpr="Buy-from Vendor No." }

    { 15  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the order address code used in the credit memo.;
                           NOR=Angir bestillingsadressekoden som brukes i kreditnotaen.];
                SourceExpr="Order Address Code";
                Visible=FALSE }

    { 6   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the name of the vendor who delivered the items.;
                           NOR=Angir navnet p† leverand›ren som leverte varene.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Buy-from Vendor Name" }

    { 35  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the currency code used to calculate the amounts on the credit memo.;
                           NOR=Angir valutakoden som er brukt til † beregne bel›pene i kreditnotaen.];
                SourceExpr="Currency Code" }

    { 7   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies when the credit memo is due. The program calculates the date using the Payment Terms Code and Posting Date fields on the purchase header.;
                           NOR=Angir n†r kreditnotaen forfaller. Programmet beregner datoen ved hjelp av feltet Betalingsbet.kode og Bokf›ringsdato i bestillingshodet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Due Date" }

    { 13  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the total, in the currency of the credit memo, of the amounts on all the credit memo lines.;
                           NOR=Angir summen av bel›pene p† alle kreditnotalinjene i valutaen som er i kreditnotaen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Amount;
                OnDrillDown=BEGIN
                              SETRANGE("No.");
                              PAGE.RUNMODAL(PAGE::"Posted Purchase Credit Memo",Rec)
                            END;
                             }

    { 17  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the total, in the currency of the credit memo, of the amounts on all the credit memo lines - including VAT.;
                           NOR=Angir summen av bel›pene p† alle kreditnotalinjene i valutaen som er i kreditnotaen, inkl. mva..];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Amount Including VAT";
                OnDrillDown=BEGIN
                              SETRANGE("No.");
                              PAGE.RUNMODAL(PAGE::"Posted Purchase Credit Memo",Rec)
                            END;
                             }

    { 12  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the amount that remains to be paid for the posted purchase invoice that relates to this purchase credit memo.;
                           NOR=Angir bel›pet som gjenst†r † bli betalt for den bokf›rte kj›psfakturaen som er knyttet til denne kj›pskreditnotaen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Remaining Amount" }

    { 10  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies if the posted purchase invoice that relates to this purchase credit memo is paid. The check box will also be selected if a credit memo for the remaining amount has been applied.;
                           NOR=Angir om den bokf›rte kj›psfakturaen, som er knyttet til denne kj›pskreditnotaen, er betalt. Det vil ogs† merkes av for hvis en kreditnota for det gjenst†ende bel›pet er brukt.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Paid }

    { 9   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies if the posted purchase invoice that relates to this purchase credit memo has been either corrected or canceled.;
                           NOR=Angir om den bokf›rte kj›psfakturaen som er knyttet til denne kj›pskreditnotaen, er blitt korrigert eller kansellert.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Cancelled;
                Editable=FALSE;
                LookupPageID=Posted Sales Invoices;
                DrillDownPageID=Posted Sales Invoices;
                HideValue=NOT Cancelled;
                Style=Unfavorable;
                StyleExpr=Cancelled;
                OnDrillDown=BEGIN
                              ShowCorrectiveInvoice;
                            END;
                             }

    { 11  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies if the posted purchase invoice has been either corrected or canceled by this purchase credit memo .;
                           NOR=Angir om den bokf›rte kj›psfakturaen er blitt korrigert eller kansellert av denne kj›pskreditnotaen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Corrective;
                Editable=FALSE;
                LookupPageID=Posted Sales Invoices;
                DrillDownPageID=Posted Sales Invoices;
                HideValue=NOT Corrective;
                Style=Unfavorable;
                StyleExpr=Corrective;
                OnDrillDown=BEGIN
                              ShowCancelledInvoice;
                            END;
                             }

    { 31  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the postal code of the address.;
                           NOR=Angir postnummeret for adressen.];
                SourceExpr="Buy-from Post Code";
                Visible=FALSE }

    { 27  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the country/region code of the address.;
                           NOR=Angir lands-/omr†dekoden for adressen.];
                SourceExpr="Buy-from Country/Region Code";
                Visible=FALSE }

    { 39  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the name of the person to contact at the vendor who shipped the items.;
                           NOR=Angir navnet p† kontaktpersonen hos den leverand›ren som leverte varene.];
                SourceExpr="Buy-from Contact";
                Visible=FALSE }

    { 127 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the vendor who you received the credit memo from.;
                           NOR=Angir nummeret til leverand›ren som du har mottatt kreditnotaen fra.];
                SourceExpr="Pay-to Vendor No.";
                Visible=FALSE }

    { 125 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the name of the vendor who you received the credit memo from.;
                           NOR=Angir navnet p† leverand›ren som du har mottatt kreditnotaen fra.];
                SourceExpr="Pay-to Name";
                Visible=FALSE }

    { 37  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the postal code of the address.;
                           NOR=Angir postnummeret for adressen.];
                SourceExpr="Pay-to Post Code";
                Visible=FALSE }

    { 33  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the country/region code of the address.;
                           NOR=Angir lands-/omr†dekoden for adressen.];
                SourceExpr="Pay-to Country/Region Code";
                Visible=FALSE }

    { 115 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the name of the person you should contact at the vendor who you received the credit memo from.;
                           NOR=Angir navnet p† kontaktperson hos leverand›ren som du mottok kreditnotaen fra.];
                SourceExpr="Pay-to Contact";
                Visible=FALSE }

    { 111 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the shipment of the sales order that is linked to the purchase order for drop shipment from the vendor to a customer.;
                           NOR=Angir leveringen av ordren som er koblet til bestillingen for direkte levering fra leverand›r til en kunde.];
                SourceExpr="Ship-to Code";
                Visible=FALSE }

    { 109 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the name of the company at the address to which the items were shipped.;
                           NOR=Angir navnet p† selskapet med adressen som varene ble levert til.];
                SourceExpr="Ship-to Name";
                Visible=FALSE }

    { 1101103003;2;Field  ;
                SourceExpr="Ship-to Address" }

    { 1101103002;2;Field  ;
                SourceExpr="Your Reference" }

    { 1101103001;2;Field  ;
                ToolTipML=[ENU=Specifies the name of the contact person at the address that products will be shipped to.;
                           NOR=Angir navnet p† kontaktpersonen i adressen som produkter skal leveres til.];
                SourceExpr="Ship-to Contact";
                Visible=FALSE }

    { 25  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the postal code of the address.;
                           NOR=Angir postnummeret for adressen.];
                SourceExpr="Ship-to Post Code";
                Visible=FALSE }

    { 19  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the country/region code of the address.;
                           NOR=Angir lands-/omr†dekoden for adressen.];
                SourceExpr="Ship-to Country/Region Code";
                Visible=FALSE }

    { 97  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date the credit memo was posted.;
                           NOR=Angir datoen da kreditnotaen ble bokf›rt.];
                SourceExpr="Posting Date";
                Visible=FALSE }

    { 71  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies which purchaser is associated with the credit memo.;
                           NOR=Angir hvilken innkj›per som er knyttet til kreditnotaen.];
                SourceExpr="Purchaser Code";
                Visible=FALSE }

    { 87  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for the dimension value associated with the credit memo.;
                           NOR=Angir koden for dimensjonsverdien tilknyttet kreditnotaen.];
                SourceExpr="Shortcut Dimension 1 Code";
                Visible=FALSE }

    { 85  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for the dimension value associated with the credit memo.;
                           NOR=Angir koden for dimensjonsverdien tilknyttet kreditnotaen.];
                SourceExpr="Shortcut Dimension 2 Code";
                Visible=FALSE }

    { 89  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for the location used when you posted the credit memo.;
                           NOR=Angir koden for lokasjonen som er brukt i bokf›ringen av kreditnotaen.];
                SourceExpr="Location Code" }

    { 8   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies how many times the credit memo has been printed.;
                           NOR=Angir hvor mange ganger kreditnotaen har blitt skrevet ut.];
                SourceExpr="No. Printed" }

    { 1102601001;2;Field  ;
                ToolTipML=[ENU=Specifies the date when the purchase document was created.;
                           NOR=Angir datoen da kj›psdokumentet ble opprettet.];
                SourceExpr="Document Date";
                Visible=FALSE }

    { 1102601003;2;Field  ;
                ToolTipML=[ENU=Specifies whether the credit memo has been applied to an already-posted document.;
                           NOR=Angir om kreditnotaen har utlignet et bilag som allerede er bokf›rt.];
                SourceExpr="Applies-to Doc. Type";
                Visible=FALSE }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 3   ;1   ;Part      ;
                Name=IncomingDocAttachFactBox;
                ApplicationArea=#Basic,#Suite;
                PagePartID=Page193;
                Visible=NOT IsOfficeAddin;
                PartType=Page;
                ShowFilter=No }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      IsOfficeAddin@1000 : Boolean;

    BEGIN
    {
      ----------------------------------------------
      SI-DATA AS
      ----------------------------------------------
      No  Date      ID      Description
      ----------------------------------------------
      CMP2.00 - page action  - Open Compello document
      SID.01 :: Show field : "Ship-to Address"
      SID.02 :: Show field : "Your Reference"
      SID.03 :: Show field : "Ship-to Contact" (std on some pages)
    }
    END.
  }
}

OBJECT Page 254 Purchase Journal
{
  OBJECT-PROPERTIES
  {
    Date=01.10.16;
    Time=11:00:00;
    Modified=Yes;
    Version List=NAVW110.00,NAVNO10.00,CMP2.00;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Purchase Journal;
               NOR=Kj›pskladd];
    SaveValues=Yes;
    SourceTable=Table81;
    DataCaptionExpr=DataCaption;
    DelayedInsert=Yes;
    PageType=Worksheet;
    AutoSplitKey=Yes;
    OnInit=BEGIN
             TotalBalanceVisible := TRUE;
             BalanceVisible := TRUE;
           END;

    OnOpenPage=VAR
                 JnlSelected@1000 : Boolean;
               BEGIN
                 BalAccName := '';
                 IF IsOpenedFromBatch THEN BEGIN
                   CurrentJnlBatchName := "Journal Batch Name";
                   GenJnlManagement.OpenJnl(CurrentJnlBatchName,Rec);
                   EXIT;
                 END;
                 GenJnlManagement.TemplateSelection(PAGE::"Purchase Journal",2,FALSE,Rec,JnlSelected);
                 IF NOT JnlSelected THEN
                   ERROR('');
                 GenJnlManagement.OpenJnl(CurrentJnlBatchName,Rec);
               END;

    OnAfterGetRecord=BEGIN
                       ShowShortcutDimCode(ShortcutDimCode);
                     END;

    OnNewRecord=BEGIN
                  UpdateBalance;
                  SetUpNewLine(xRec,Balance,BelowxRec);
                  CLEAR(ShortcutDimCode);
                END;

    OnAfterGetCurrRecord=BEGIN
                           HasIncomingDocument := "Incoming Document Entry No." <> 0;
                           GenJnlManagement.GetAccounts(Rec,AccName,BalAccName);
                           UpdateBalance;
                           CurrPage.IncomingDocAttachFactBox.PAGE.LoadDataFromRecord(Rec);
                         END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 67      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Line;
                                 NOR=&Linje];
                      Image=Line }
      { 68      ;2   ;Action    ;
                      AccessByPermission=TableData 348=R;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 NOR=Dimensjoner];
                      ToolTipML=[ENU=View or edits dimensions, such as area, project, or department, that you can assign to sales and purchase documents to distribute costs and analyze transaction history.;
                                 NOR=Vis eller rediger dimensjoner, for eksempel omr†de, prosjekt eller avdeling, som du kan tilordne til salgs- og kj›psdokumenter for † distribuere kostnader og analysere transaksjonshistorikk.];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      Image=Dimensions;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 ShowDimensions;
                                 CurrPage.SAVERECORD;
                               END;
                                }
      { 41      ;1   ;ActionGroup;
                      CaptionML=[ENU=A&ccount;
                                 NOR=K&onto];
                      Image=ChartOfAccounts }
      { 42      ;2   ;Action    ;
                      ShortCutKey=Shift+F7;
                      CaptionML=[ENU=Card;
                                 NOR=Kort];
                      ToolTipML=[ENU=View or change detailed information about the record that is being processed on the journal line.;
                                 NOR=Vis eller endre detaljert informasjon om posten som behandles p† kladdelinjen.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Codeunit 15;
                      Image=EditLines }
      { 43      ;2   ;Action    ;
                      ShortCutKey=Ctrl+F7;
                      CaptionML=[ENU=Ledger E&ntries;
                                 NOR=&Poster];
                      ToolTipML=[ENU=View the history of transactions that have been posted for the selected record.;
                                 NOR=Vis transaksjonshistorikken som har blitt bokf›rt for den valgte posten.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Codeunit 14;
                      Promoted=No;
                      Image=GLRegisters;
                      PromotedCategory=Process }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 44      ;1   ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 NOR=F&unksjoner];
                      Image=Action }
      { 7       ;2   ;Action    ;
                      CaptionML=[ENU=Renumber Document Numbers;
                                 NOR=Nummerer dokumentnumre p† nytt];
                      ToolTipML=[ENU=Resort the numbers in the Document No. column to avoid posting errors because the document numbers are not in sequence. Entry applications and line groupings are preserved.;
                                 NOR=Sorter tallene i kolonnen Dokumentnr. p† nytt for † unng† bokf›ringsfeil, fordi dokumentnumrene ikke st†r etter hverandre. Postutligninger og linjegrupperinger beholdes.];
                      ApplicationArea=#Basic,#Suite;
                      Image=EditLines;
                      OnAction=BEGIN
                                 RenumberDocumentNo
                               END;
                                }
      { 97      ;2   ;Action    ;
                      ShortCutKey=Shift+F11;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Apply Entries;
                                 NOR=Utlign poster];
                      ToolTipML=[ENU=Select one or more ledger entries that you want to apply this record to so that the related posted documents are closed as paid or refunded.;
                                 NOR=Velg ‚n eller flere poster du vil utligne mot denne posten slik at de relaterte bokf›rte dokumentene lukkes som betalte eller refunderte.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Codeunit 225;
                      Promoted=Yes;
                      Image=ApplyEntries;
                      PromotedCategory=Process }
      { 98      ;2   ;Action    ;
                      CaptionML=[ENU=Insert Conv. LCY Rndg. Lines;
                                 NOR=Sett inn konv.avrund.linjer - NOK];
                      ToolTipML=[ENU=Insert a rounding correction line in the journal. This rounding correction line will balance in LCY when amounts in the foreign currency also balance. You can then post the journal.;
                                 NOR=Sett inn en avrundingskorreksjonslinje i kladden. Denne avrundingskorreksjonslinjen balanseres i NOK n†r bel›pene i utenlandsk valuta ogs† balanseres. Deretter kan du bokf›re kladden.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Codeunit 407;
                      Image=InsertCurrency }
      { 1101103001;2 ;Action    ;
                      Name=Open Document in Compello;
                      CaptionML=[ENU=Open Document in Compello;
                                 NOR=pne Dokument i Compello];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Document;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 CompelloShowDoc@1101103000 : Codeunit 70006;
                               BEGIN
                                 CompelloShowDoc.ShowCompelloDocGenJournalLinePurch(Rec);
                               END;
                                }
      { 21      ;2   ;ActionGroup;
                      Name=IncomingDocument;
                      CaptionML=[ENU=Incoming Document;
                                 NOR=Inng†ende dokument];
                      ActionContainerType=NewDocumentItems;
                      Image=Documents }
      { 19      ;3   ;Action    ;
                      Name=IncomingDocCard;
                      CaptionML=[ENU=View Incoming Document;
                                 NOR=Vis inng†ende dokument];
                      ToolTipML=[ENU=View any incoming document records and file attachments that exist for the entry or document.;
                                 NOR=Vis poster og filvedlegg for innkommende dokument som finnes for oppf›ringen eller dokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      Enabled=HasIncomingDocument;
                      Image=ViewOrder;
                      OnAction=VAR
                                 IncomingDocument@1000 : Record 130;
                               BEGIN
                                 IncomingDocument.ShowCardFromEntryNo("Incoming Document Entry No.");
                               END;
                                }
      { 17      ;3   ;Action    ;
                      Name=SelectIncomingDoc;
                      AccessByPermission=TableData 130=R;
                      CaptionML=[ENU=Select Incoming Document;
                                 NOR=Velg inng†ende dokument];
                      ToolTipML=[ENU=Select an incoming document record and file attachment that you want to link to the entry or document.;
                                 NOR=Velg en post og et filvedlegg for innkommende dokument som du vil koble til oppf›ringen eller dokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      Image=SelectLineToApply;
                      OnAction=VAR
                                 IncomingDocument@1000 : Record 130;
                               BEGIN
                                 VALIDATE("Incoming Document Entry No.",IncomingDocument.SelectIncomingDocument("Incoming Document Entry No.",RECORDID));
                               END;
                                }
      { 15      ;3   ;Action    ;
                      Name=IncomingDocAttachFile;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Create Incoming Document from File;
                                 NOR=Opprett inng†ende dokument fra fil];
                      ToolTipML=[ENU=Create an incoming document record by selecting a file to attach, and then link the incoming document record to the entry or document.;
                                 NOR=Opprett en post for innkommende dokument ved † velge en fil som skal legges ved, og koble deretter posten for det innkommende dokumentet til oppf›ringen eller dokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      Enabled=NOT HasIncomingDocument;
                      Image=Attach;
                      OnAction=VAR
                                 IncomingDocumentAttachment@1000 : Record 133;
                               BEGIN
                                 IncomingDocumentAttachment.NewAttachmentFromGenJnlLine(Rec);
                               END;
                                }
      { 13      ;3   ;Action    ;
                      Name=RemoveIncomingDoc;
                      CaptionML=[ENU=Remove Incoming Document;
                                 NOR=Fjern inng†ende dokument];
                      ToolTipML=[ENU=Remove the link to an incoming document record and file attachment.;
                                 NOR=Fjern koblingen til en innkommende dokumentpost og filvedlegg.];
                      ApplicationArea=#Basic,#Suite;
                      Enabled=HasIncomingDocument;
                      Image=RemoveLine;
                      OnAction=VAR
                                 IncomingDocument@1000 : Record 130;
                               BEGIN
                                 IF IncomingDocument.GET("Incoming Document Entry No.") THEN
                                   IncomingDocument.RemoveLinkToRelatedRecord;
                                 "Incoming Document Entry No." := 0;
                                 MODIFY(TRUE);
                               END;
                                }
      { 45      ;1   ;ActionGroup;
                      CaptionML=[ENU=P&osting;
                                 NOR=B&okf›ring];
                      Image=Post }
      { 46      ;2   ;Action    ;
                      ShortCutKey=Ctrl+F11;
                      CaptionML=[ENU=Reconcile;
                                 NOR=Avstem];
                      ToolTipML=[ENU=View the balances on bank accounts that are marked for reconciliation, usually liquid accounts.;
                                 NOR=Vis saldoene p† bankkonti som er merket for avstemming, vanligvis likviditetskonti.];
                      ApplicationArea=#Basic,#Suite;
                      Image=Reconcile;
                      OnAction=BEGIN
                                 GLReconcile.SetGenJnlLine(Rec);
                                 GLReconcile.RUN;
                               END;
                                }
      { 47      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Test Report;
                                 NOR=Kontrollrapport];
                      ToolTipML=[ENU=View a test report so that you can find and correct any errors before you perform the actual posting of the journal or document.;
                                 NOR=Vis en kontrollrapport slik at du kan finne og rette eventuelle feil f›r du bokf›rer kladden eller dokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      Image=TestReport;
                      OnAction=BEGIN
                                 ReportPrint.PrintGenJnlLine(Rec);
                               END;
                                }
      { 48      ;2   ;Action    ;
                      Name=Post;
                      ShortCutKey=F9;
                      CaptionML=[ENU=P&ost;
                                 NOR=B&okf›r];
                      ToolTipML=[ENU=Finalize the document or journal by posting the amounts and quantities to the related accounts in your company books.;
                                 NOR=Fullf›r dokumentet eller kladden ved † bokf›re bel›pene og antallene til de relaterte kontoene i selskapstabl†ene.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PostOrder;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CODEUNIT.RUN(CODEUNIT::"Gen. Jnl.-Post",Rec);
                                 CurrentJnlBatchName := GETRANGEMAX("Journal Batch Name");
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 9       ;2   ;Action    ;
                      Name=Preview;
                      CaptionML=[ENU=Preview Posting;
                                 NOR=Forh†ndsvis bokf›ring];
                      ToolTipML=[ENU=Review the different types of entries that will be created when you post the document or journal.;
                                 NOR=Se gjennom de ulike typene poster som blir opprettet n†r du bokf›rer dokumentet eller kladden.];
                      ApplicationArea=#Basic,#Suite;
                      Image=ViewPostedOrder;
                      OnAction=VAR
                                 GenJnlPost@1001 : Codeunit 231;
                               BEGIN
                                 GenJnlPost.Preview(Rec);
                               END;
                                }
      { 49      ;2   ;Action    ;
                      ShortCutKey=Shift+F9;
                      CaptionML=[ENU=Post and &Print;
                                 NOR=Bokf›r og &skriv ut];
                      ToolTipML=[ENU=Finalize and prepare to print the document or journal. The values and quantities are posted to the related accounts. A report request window where you can specify what to include on the print-out.;
                                 NOR=Fullf›r og klargj›r for † skrive ut dokumentet eller kladden. Verdiene og antallene blir bokf›rt til de relaterte kontiene. Det vises en rapportforesp›rselsside der du kan angi hva som skal inkluderes p† utskriften.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PostPrint;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CODEUNIT.RUN(CODEUNIT::"Gen. Jnl.-Post+Print",Rec);
                                 CurrentJnlBatchName := GETRANGEMAX("Journal Batch Name");
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 37  ;1   ;Field     ;
                Lookup=Yes;
                CaptionML=[ENU=Batch Name;
                           NOR=Bunkenavn];
                ToolTipML=[ENU=Specifies the batch name on the purchase journal.;
                           NOR=Angir kladdenavnet i kj›pskladden.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=CurrentJnlBatchName;
                OnValidate=BEGIN
                             GenJnlManagement.CheckName(CurrentJnlBatchName,Rec);
                             CurrentJnlBatchNameOnAfterVali;
                           END;

                OnLookup=BEGIN
                           CurrPage.SAVERECORD;
                           GenJnlManagement.LookupName(CurrentJnlBatchName,Rec);
                           CurrPage.UPDATE(FALSE);
                         END;
                          }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the posting date for the entry.;
                           NOR=Angir postens bokf›ringsdato.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Posting Date" }

    { 87  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date on the document that provides the basis for the entry on the journal line.;
                           NOR=Angir datoen i dokumentet som danner grunnlaget for posten p† kladdelinjen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Document Date";
                Visible=FALSE }

    { 4   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the type of document that the entry on the journal line is.;
                           NOR=Angir hvilken type bilag posten p† kladdelinjen er.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Document Type" }

    { 6   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a document number for the journal line.;
                           NOR=Angir et dokumentnummer for kladdelinjen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Document No." }

    { 5   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the incoming document that this general journal line is created for.;
                           NOR=Angir nummeret p† det innkommende dokumentet som denne finanskladdelinjen er opprettet for.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Incoming Document Entry No.";
                Visible=FALSE;
                OnAssistEdit=BEGIN
                               IF "Incoming Document Entry No." > 0 THEN
                                 HYPERLINK(GetIncomingDocumentURL);
                             END;
                              }

    { 85  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a document number that refers to the customer's or vendor's numbering system.;
                           NOR=Angir et dokumentnummer som henviser til kundens eller leverand›rens nummereringssystem.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="External Document No.";
                Visible=FALSE }

    { 8   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the type of account that the entry on the journal line will be posted to.;
                           NOR=Angir kontotypen som posten p† kladdelinjen skal bokf›res p†.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Account Type";
                OnValidate=BEGIN
                             GenJnlManagement.GetAccounts(Rec,AccName,BalAccName);
                           END;
                            }

    { 10  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the account number that the entry on the journal line will be posted to.;
                           NOR=Angir kontonummeret som posten p† kladdelinjen skal bokf›res p†.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Account No.";
                OnValidate=BEGIN
                             GenJnlManagement.GetAccounts(Rec,AccName,BalAccName);
                             ShowShortcutDimCode(ShortcutDimCode);
                           END;
                            }

    { 12  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a description of the entry. The field is automatically filled when the Account No. field is filled.;
                           NOR=Angir en beskrivelse av posten. Feltet fylles automatisk ut n†r feltet Kontonr. fylles ut.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Description }

    { 55  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the salesperson or purchaser who is linked to the journal line.;
                           NOR=Angir hvilken selger eller innkj›per som er tilknyttet kladdelinjen.];
                ApplicationArea=#Suite;
                SourceExpr="Salespers./Purch. Code";
                Visible=FALSE }

    { 99  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the campaign the journal line is linked to.;
                           NOR=Angir nummeret for kampanjen som kladdelinjen er knyttet til.];
                SourceExpr="Campaign No.";
                Visible=FALSE }

    { 57  ;2   ;Field     ;
                AssistEdit=Yes;
                ToolTipML=[ENU=Specifies the code of the currency for the amounts on the journal line.;
                           NOR=Angir valutakoden for bel›pene p† kladdelinjen.];
                ApplicationArea=#Suite;
                SourceExpr="Currency Code";
                Visible=FALSE;
                OnAssistEdit=BEGIN
                               ChangeExchangeRate.SetParameter("Currency Code","Currency Factor","Posting Date");
                               IF ChangeExchangeRate.RUNMODAL = ACTION::OK THEN
                                 VALIDATE("Currency Factor",ChangeExchangeRate.GetParameter);

                               CLEAR(ChangeExchangeRate);
                             END;
                              }

    { 1080000;2;Field     ;
                ToolTipML=[ENU=Specifies the VAT Code to be used on the line.;
                           NOR=Angir mva-koden som skal brukes p† linjen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="VAT Code" }

    { 14  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the general posting type that will be used when you post the entry on this journal line.;
                           NOR=Angir bokf›ringstypen som vil bli brukt n†r du bokf›rer posten p† kladdelinjen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Gen. Posting Type" }

    { 81  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the vendor's trade type to link transactions made for this vendor with the appropriate general ledger account according to the general posting setup.;
                           NOR=Angir leverand›rens handelstype for † koble transaksjoner gjort for denne leverand›ren, med riktig finanskonto i henhold til det generelle bokf›ringsoppsettet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Gen. Bus. Posting Group" }

    { 16  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the vendor's product type to link transactions made for this vendor with the appropriate general ledger account according to the general posting setup.;
                           NOR=Angir leverand›rens produkttype for † koble transaksjoner gjort for denne leverand›ren, med riktig finanskonto i henhold til det generelle bokf›ringsoppsettet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Gen. Prod. Posting Group" }

    { 39  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the VAT business posting group code that will be used when you post the entry on the journal line.;
                           NOR=Angir koden for mva-bokf›ringsgruppe - firma som gjelder for posten p† kladdelinjen.];
                SourceExpr="VAT Bus. Posting Group";
                Visible=FALSE }

    { 91  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code of the VAT product posting group that will be used when you post the entry on the journal line.;
                           NOR=Angir koden for mva-bokf›ringsgruppe - vare som vil brukes n†r du bokf›rer posten p† kladdelinjen.];
                SourceExpr="VAT Prod. Posting Group";
                Visible=FALSE }

    { 18  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the total amount (including VAT) that the journal line consists of.;
                           NOR=Angir det totale bel›pet (inkl. mva.) som kladdelinjen best†r av.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Amount }

    { 1000;2   ;Field     ;
                ToolTipML=[ENU=Specifies the total amount (including VAT) that the journal line consists of, if it is a debit amount.;
                           NOR=Angir bruttobel›p (bel›p inkl. mva.) som kladdelinjen best†r av hvis det er et debetbel›p.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Debit Amount";
                Visible=False }

    { 1001;2   ;Field     ;
                ToolTipML=[ENU=Specifies the total amount (including VAT) that the journal line consists of, if it is a credit amount.;
                           NOR=Angir bruttobel›p (bel›p inkl. mva.) som kladdelinjen best†r av hvis det er et kreditbel›p.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Credit Amount";
                Visible=False }

    { 105 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the amount of VAT included in the total amount.;
                           NOR=Angir bel›pet for mva som utgj›r bruttobel›pet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="VAT Amount";
                Visible=FALSE }

    { 109 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the difference between the calculate VAT amount and the VAT amount that you have entered manually.;
                           NOR=Angir forskjellen mellom det beregnede mva-bel›pet og mva-bel›pet du har angitt manuelt.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="VAT Difference";
                Visible=FALSE }

    { 107 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the amount of Bal. VAT included in the total amount.;
                           NOR=Angir bel›pet for Motkonto-mva. som utgj›r bruttobel›pet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Bal. VAT Amount";
                Visible=FALSE }

    { 111 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the difference between the calculate VAT amount and the VAT amount that you have entered manually.;
                           NOR=Angir forskjellen mellom det beregnede mva-bel›pet og mva-bel›pet du har angitt manuelt.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Bal. VAT Difference";
                Visible=FALSE }

    { 59  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for the balancing account type that should be used in this journal line.;
                           NOR=Angir koden for motkontotypen som skal brukes p† denne kladdelinjen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Bal. Account Type" }

    { 61  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the general ledger, customer, vendor, or bank account to which a balancing entry for the journal line will posted (for example, a cash account for cash purchases).;
                           NOR=Angir nummeret p† finans-, kunde-, leverand›r- eller bankkontoen som en motpost for kladdelinjen skal bokf›res p† (for eksempel en kassakonto for kontantkj›p).];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Bal. Account No.";
                OnValidate=BEGIN
                             GenJnlManagement.GetAccounts(Rec,AccName,BalAccName);
                             ShowShortcutDimCode(ShortcutDimCode);
                           END;
                            }

    { 1080002;2;Field     ;
                ToolTipML=[ENU=Specifies the VAT Code to be used on the line.;
                           NOR=Angir mva-koden som skal brukes p† linjen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Bal. VAT Code" }

    { 63  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the general posting type associated with the balancing account that will be used when you post the entry on the journal line.;
                           NOR=Angir bokf›ringstypen som er knyttet til motkontoen som vil bli brukt n†r du bokf›rer posten p† kladdelinjen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Bal. Gen. Posting Type" }

    { 83  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the general business posting group code associated with the balancing account that will be used when you post the entry.;
                           NOR=Angir koden for firmabokf›ringsgruppen som er knyttet til motkontoen som vil bli brukt n†r du bokf›rer posten.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Bal. Gen. Bus. Posting Group" }

    { 65  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the general product posting group code associated with the balancing account that will be used when you post the entry.;
                           NOR=Angir koden for varebokf›ringsgruppen som er knyttet til motkontoen som brukes n†r du bokf›rer posten.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Bal. Gen. Prod. Posting Group" }

    { 93  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code of the VAT business posting group that will be used when you post the entry on the journal line.;
                           NOR=Angir koden for mva-bokf›ringsgruppe - firma som vil brukes n†r du bokf›rer posten p† kladdelinjen.];
                SourceExpr="Bal. VAT Bus. Posting Group";
                Visible=FALSE }

    { 95  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code of the VAT product posting group that will be used when you post the entry on the journal line.;
                           NOR=Angir koden for mva-bokf›ringsgruppe - vare som vil brukes n†r du bokf›rer posten p† kladdelinjen.];
                SourceExpr="Bal. VAT Prod. Posting Group";
                Visible=FALSE }

    { 101 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the address code of the bill-to customer or pay-to vendor that the entry is linked to.;
                           NOR=Angir adressekoden for Faktura til kundenummer eller Betal til leverand›r som posten er tilknyttet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Bill-to/Pay-to No.";
                Visible=FALSE }

    { 103 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the address code of the ship-to customer or order-from vendor that the entry is linked to.;
                           NOR=Angir adressekoden for kunden eller leverand›ren som denne posten er knyttet til.];
                SourceExpr="Ship-to/Order Address Code";
                Visible=FALSE }

    { 35  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for Shortcut Dimension 1.;
                           NOR=Angir koden for Snarveisdimensjon 1.];
                ApplicationArea=#Suite;
                SourceExpr="Shortcut Dimension 1 Code";
                Visible=FALSE }

    { 53  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for Shortcut Dimension 2.;
                           NOR=Angir koden for Snarveisdimensjon 2.];
                ApplicationArea=#Suite;
                SourceExpr="Shortcut Dimension 2 Code";
                Visible=FALSE }

    { 300 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[3];
                CaptionClass='1,2,3';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(3),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(3,ShortcutDimCode[3]);
                           END;
                            }

    { 302 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[4];
                CaptionClass='1,2,4';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(4),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(4,ShortcutDimCode[4]);
                           END;
                            }

    { 304 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[5];
                CaptionClass='1,2,5';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(5),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(5,ShortcutDimCode[5]);
                           END;
                            }

    { 306 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[6];
                CaptionClass='1,2,6';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(6),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(6,ShortcutDimCode[6]);
                           END;
                            }

    { 308 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[7];
                CaptionClass='1,2,7';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(7),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(7,ShortcutDimCode[7]);
                           END;
                            }

    { 310 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[8];
                CaptionClass='1,2,8';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(8),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(8,ShortcutDimCode[8]);
                           END;
                            }

    { 69  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the line's net amount (the amount excluding VAT) if you are using this journal line for an invoice.;
                           NOR=Viser linjens nettobel›p (bel›p eks. mva.) hvis du bruker denne kladdelinjen til en faktura.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Sales/Purch. (LCY)";
                Visible=FALSE }

    { 73  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the amount of the invoice discount if you are using this journal line for an invoice.;
                           NOR=Angir bel›pet for fakturarabatten hvis du bruker denne kladdelinjen til en faktura.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Inv. Discount (LCY)";
                Visible=FALSE }

    { 20  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code that represents the payments terms that apply to the entry on the journal line.;
                           NOR=Angir koden som skal brukes til † finne betalingsbetingelsene som gjelder for posten p† kladdelinjen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Payment Terms Code";
                Visible=FALSE }

    { 22  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the due date on the entry.;
                           NOR=Angir forfallsdatoen p† posten.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Due Date";
                Visible=FALSE }

    { 75  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the last date on which the amount in the journal line must be paid for the order to qualify for a payment discount.;
                           NOR=Angir n†r bel›pet p† kladdelinjen senest m† betales for † oppn† kontantrabatt p† ordren.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pmt. Discount Date";
                Visible=FALSE }

    { 77  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the possible payment discount percentage for the journal line.;
                           NOR=Angir den mulige kontantrabattprosenten for kladdelinjen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Payment Discount %";
                Visible=FALSE }

    { 24  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the type of the posted document that this document or journal line will be applied to when you post, for example to register payment.;
                           NOR=Angir typen bokf›rt dokument som dette dokumentet eller denne kladdelinjen blir utlignet til n†r du bokf›rer, for eksempel for † registrere utbetaling.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Applies-to Doc. Type" }

    { 26  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the posted document that this document or journal line will be applied to when you post, for example to register payment.;
                           NOR=Angir nummeret for det bokf›rte dokumentet som dette dokumentet eller denne kladdelinjen blir utlignet til n†r du bokf›rer, for eksempel for † registrere utbetaling.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Applies-to Doc. No." }

    { 71  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the entries that will be applied to by the journal line if you use the Apply Entries facility.;
                           NOR=Angir postene som vil bli utlignet av kladdelinjen hvis du bruker funksjonen Utlign poster.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Applies-to ID";
                Visible=FALSE }

    { 1080004;2;Field     ;
                ToolTipML=[ENU=Specifies the Kunde ID (KID) associated with the general journal line.;
                           NOR=Angir kunde-ID-en (KID) som er knyttet til finanskladdelinjen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=KID }

    { 51  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies if the journal line has been invoiced, and you execute the payment suggestions batch job, or you create a finance charge memo or reminder.;
                           NOR=Angir om kladdelinjen har blitt fakturert og du kj›rer kj›rselen for betalingsforslag eller du oppretter en rentenota eller p†minnelse.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="On Hold" }

    { 79  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the reason code that has been entered on the journal lines.;
                           NOR=Angir †rsakskoden som er satt inn p† kladdelinjene.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Reason Code";
                Visible=FALSE }

    { 3   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a comment related to registering a payment.;
                           NOR=Angir en kommentar som er knyttet til registrering av en betaling.];
                SourceExpr=Comment;
                Visible=FALSE }

    { 1080006;2;Field     ;
                ToolTipML=[ENU=Specifies a two-digit code for the payment type.;
                           NOR=Angir en tosifret kode for betalingstypen.];
                SourceExpr="Payment Type Code Abroad";
                Visible=FALSE }

    { 1080008;2;Field     ;
                ToolTipML=[ENU=Specifies information for your local government bank.;
                           NOR=Angir informasjon for sentralbanken i landet.];
                SourceExpr="Specification (Norges Bank)";
                Visible=FALSE }

    { 28  ;1   ;Group      }

    { 1902205001;2;Group  ;
                GroupType=FixedLayout }

    { 1901652501;3;Group  ;
                CaptionML=[ENU=Account Name;
                           NOR=Kontonavn] }

    { 33  ;4   ;Field     ;
                ToolTipML=[ENU=Specifies the name of the account.;
                           NOR=Angir navnet p† kontoen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=AccName;
                Editable=FALSE;
                ShowCaption=No }

    { 1903867901;3;Group  ;
                CaptionML=[ENU=Bal. Account Name;
                           NOR=Motkontonavn] }

    { 89  ;4   ;Field     ;
                CaptionML=[ENU=Bal. Account Name;
                           NOR=Motkontonavn];
                ToolTipML=[ENU=Specifies the name of the balancing account that has been entered on the journal line.;
                           NOR=Angir navnet p† motkontoen som er satt inn p† kladdelinjen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=BalAccName;
                Editable=FALSE }

    { 1903866901;3;Group  ;
                CaptionML=[ENU=Balance;
                           NOR=Saldo] }

    { 29  ;4   ;Field     ;
                Name=Balance;
                CaptionML=[ENU=Balance;
                           NOR=Saldo];
                ToolTipML=[ENU=Specifies the balance that has accumulated in the purchase journal on the line where the cursor is.;
                           NOR=Angir saldoen som er akkumulert i kj›pskladden p† den linjen hvor mark›ren er plassert.];
                ApplicationArea=#All;
                SourceExpr=Balance + "Balance (LCY)" - xRec."Balance (LCY)";
                AutoFormatType=1;
                Visible=BalanceVisible;
                Editable=FALSE }

    { 1902759701;3;Group  ;
                CaptionML=[ENU=Total Balance;
                           NOR=Total saldo] }

    { 31  ;4   ;Field     ;
                Name=TotalBalance;
                CaptionML=[ENU=Total Balance;
                           NOR=Total saldo];
                ToolTipML=[ENU=Specifies the total balance in the purchase journal.;
                           NOR=Angir den totale saldoen i kj›pskladden.];
                ApplicationArea=#All;
                SourceExpr=TotalBalance + "Balance (LCY)" - xRec."Balance (LCY)";
                AutoFormatType=1;
                Visible=TotalBalanceVisible;
                Editable=FALSE }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1900919607;1;Part   ;
                ApplicationArea=#Basic,#Suite;
                SubPageLink=Dimension Set ID=FIELD(Dimension Set ID);
                PagePartID=Page699;
                PartType=Page }

    { 11  ;1   ;Part      ;
                Name=IncomingDocAttachFactBox;
                ApplicationArea=#Basic,#Suite;
                PagePartID=Page193;
                PartType=Page;
                ShowFilter=No }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      GenJnlManagement@1002 : Codeunit 230;
      ReportPrint@1003 : Codeunit 228;
      ChangeExchangeRate@1001 : Page 511;
      GLReconcile@1000 : Page 345;
      CurrentJnlBatchName@1004 : Code[10];
      AccName@1005 : Text[50];
      BalAccName@1006 : Text[50];
      Balance@1007 : Decimal;
      TotalBalance@1008 : Decimal;
      ShowBalance@1009 : Boolean;
      ShowTotalBalance@1010 : Boolean;
      ShortcutDimCode@1011 : ARRAY [8] OF Code[20];
      HasIncomingDocument@1014 : Boolean;
      BalanceVisible@1015 : Boolean INDATASET;
      TotalBalanceVisible@1016 : Boolean INDATASET;

    LOCAL PROCEDURE UpdateBalance@1();
    BEGIN
      GenJnlManagement.CalcBalance(
        Rec,xRec,Balance,TotalBalance,ShowBalance,ShowTotalBalance);
      BalanceVisible := ShowBalance;
      TotalBalanceVisible := ShowTotalBalance;
    END;

    LOCAL PROCEDURE CurrentJnlBatchNameOnAfterVali@19002411();
    BEGIN
      CurrPage.SAVERECORD;
      GenJnlManagement.SetName(CurrentJnlBatchName,Rec);
      CurrPage.UPDATE(FALSE);
    END;

    BEGIN
    {
      +---------------------------------------------+
      | SI-Data                                     |
      +---------------------------------------------+
      No. Date     Id  Description
      CMP2.00 - Page action - Open Compello document
    }
    END.
  }
}

OBJECT Page 256 Payment Journal
{
  OBJECT-PROPERTIES
  {
    Date=01.10.16;
    Time=11:00:00;
    Modified=Yes;
    Version List=NAVW110.00,NAVNO10.00,CMP2.00,FIX.01;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Payment Journal;
               NOR=Betalingskladd];
    SaveValues=Yes;
    SourceTable=Table81;
    DataCaptionExpr=DataCaption;
    DelayedInsert=Yes;
    PageType=Worksheet;
    AutoSplitKey=Yes;
    PromotedActionCategoriesML=[ENU=New,Process,Report,Bank,Prepare,Approve;
                                NOR=Ny,Prosess,Rapport,Bank,Klargj›r,Godkjenn];
    OnInit=BEGIN
             TotalBalanceVisible := TRUE;
             BalanceVisible := TRUE;
           END;

    OnOpenPage=VAR
                 JnlSelected@1000 : Boolean;
               BEGIN
                 BalAccName := '';

                 IF IsOpenedFromBatch THEN BEGIN
                   CurrentJnlBatchName := "Journal Batch Name";
                   GenJnlManagement.OpenJnl(CurrentJnlBatchName,Rec);
                   SetControlAppearance;
                   EXIT;
                 END;
                 GenJnlManagement.TemplateSelection(PAGE::"Payment Journal",4,FALSE,Rec,JnlSelected);
                 IF NOT JnlSelected THEN
                   ERROR('');
                 GenJnlManagement.OpenJnl(CurrentJnlBatchName,Rec);
                 SetControlAppearance;
               END;

    OnAfterGetRecord=BEGIN
                       StyleTxt := GetOverdueDateInteractions(OverdueWarningText);
                       ShowShortcutDimCode(ShortcutDimCode);
                       HasPmtFileErr := HasPaymentFileErrors;
                       SetControlAppearance;
                     END;

    OnNewRecord=BEGIN
                  HasPmtFileErr := FALSE;
                  UpdateBalance;
                  SetUpNewLine(xRec,Balance,BelowxRec);
                  CLEAR(ShortcutDimCode);
                END;

    OnModifyRecord=BEGIN
                     CheckForPmtJnlErrors;
                   END;

    OnAfterGetCurrRecord=VAR
                           GenJournalBatch@1000 : Record 232;
                           WorkflowEventHandling@1001 : Codeunit 1520;
                           WorkflowManagement@1002 : Codeunit 1501;
                         BEGIN
                           StyleTxt := GetOverdueDateInteractions(OverdueWarningText);
                           GenJnlManagement.GetAccounts(Rec,AccName,BalAccName);
                           UpdateBalance;
                           CurrPage.IncomingDocAttachFactBox.PAGE.LoadDataFromRecord(Rec);

                           IF GenJournalBatch.GET("Journal Template Name","Journal Batch Name") THEN
                             ShowWorkflowStatusOnBatch := CurrPage.WorkflowStatusBatch.PAGE.SetFilterOnWorkflowRecord(GenJournalBatch.RECORDID);
                           ShowWorkflowStatusOnLine := CurrPage.WorkflowStatusLine.PAGE.SetFilterOnWorkflowRecord(RECORDID);

                           EventFilter := WorkflowEventHandling.RunWorkflowOnSendGeneralJournalLineForApprovalCode;
                           EnabledApprovalWorkflowsExist := WorkflowManagement.EnabledWorkflowExist(DATABASE::"Gen. Journal Line",EventFilter);
                         END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 57      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Line;
                                 NOR=&Linje];
                      Image=Line }
      { 58      ;2   ;Action    ;
                      AccessByPermission=TableData 348=R;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 NOR=Dimensjoner];
                      ToolTipML=[ENU=View or edits dimensions, such as area, project, or department, that you can assign to sales and purchase documents to distribute costs and analyze transaction history.;
                                 NOR=Vis eller rediger dimensjoner, for eksempel omr†de, prosjekt eller avdeling, som du kan tilordne til salgs- og kj›psdokumenter for † distribuere kostnader og analysere transaksjonshistorikk.];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      Image=Dimensions;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 ShowDimensions;
                                 CurrPage.SAVERECORD;
                               END;
                                }
      { 92      ;2   ;Action    ;
                      Name=IncomingDoc;
                      AccessByPermission=TableData 130=R;
                      CaptionML=[ENU=Incoming Document;
                                 NOR=Inng†ende dokument];
                      ToolTipML=[ENU=View or create an incoming document record that is linked to the entry or document.;
                                 NOR=Viser eller oppretter en post for innkommende dokument som er koblet til oppf›ringen eller dokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Image=Document;
                      PromotedCategory=Process;
                      Scope=Repeater;
                      OnAction=VAR
                                 IncomingDocument@1000 : Record 130;
                               BEGIN
                                 VALIDATE("Incoming Document Entry No.",IncomingDocument.SelectIncomingDocument("Incoming Document Entry No.",RECORDID));
                               END;
                                }
      { 37      ;1   ;ActionGroup;
                      CaptionML=[ENU=A&ccount;
                                 NOR=K&onto];
                      Image=ChartOfAccounts }
      { 38      ;2   ;Action    ;
                      ShortCutKey=Shift+F7;
                      CaptionML=[ENU=Card;
                                 NOR=Kort];
                      ToolTipML=[ENU=View or change detailed information about the record that is being processed on the journal line.;
                                 NOR=Vis eller endre detaljert informasjon om posten som behandles p† kladdelinjen.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Codeunit 15;
                      Image=EditLines }
      { 39      ;2   ;Action    ;
                      ShortCutKey=Ctrl+F7;
                      CaptionML=[ENU=Ledger E&ntries;
                                 NOR=&Poster];
                      ToolTipML=[ENU=View the history of transactions that have been posted for the selected record.;
                                 NOR=Vis transaksjonshistorikken som har blitt bokf›rt for den valgte posten.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Codeunit 14;
                      Promoted=No;
                      Image=GLRegisters;
                      PromotedCategory=Process }
      { 1080004 ;1   ;ActionGroup;
                      CaptionML=[ENU=Re&mittance;
                                 NOR=Re&mittering];
                      Image=Payables }
      { 1080005 ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Remittance Suggestion;
                                 NOR=Remitteringsforslag];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Image=SuggestPayment;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 remittSuggestion@1080000 : Report 15000001;
                               BEGIN
                                 remittSuggestion.SetGenJnlLine(Rec);
                                 remittSuggestion.RUNMODAL;
                                 CLEAR(remittSuggestion);
                               END;
                                }
      { 1080006 ;2   ;Action    ;
                      ShortCutKey=Ctrl+F9;
                      CaptionML=[ENU=Payment Info;
                                 NOR=Betalingsinformasjon];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 15000001;
                      RunPageLink=Journal Template Name=FIELD(Journal Template Name),
                                  Journal Batch Name=FIELD(Journal Batch Name),
                                  Line No.=FIELD(Line No.);
                      Image=Payment }
      { 1080007 ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Test Report;
                                 NOR=Kontrollrapport];
                      ApplicationArea=#Basic,#Suite;
                      Image=TestReport;
                      OnAction=VAR
                                 RemControl@1080000 : Report 15000002;
                               BEGIN
                                 RemControl.SetJournal(Rec);
                                 RemControl.RUN;
                               END;
                                }
      { 1080008 ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=E&xport Payments;
                                 NOR=Les &ut betalinger];
                      ApplicationArea=#Basic,#Suite;
                      Image=Export;
                      OnAction=VAR
                                 GenJnlLine@1080003 : Record 81;
                               BEGIN
                                 GenJnlLine.COPYFILTERS(Rec);
                                 GenJnlLine.FINDFIRST;
                                 //FIX.01 --> Norsk remittering
                                 //CODEUNIT.RUN(CODEUNIT::"Export Payment File (Yes/No)",GenJnlLine);
                                 CODEUNIT.RUN(CODEUNIT::"Export Remittance",GenJnlLine);
                                 //FIX.01 <--
                               END;
                                }
      { 1080010 ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=&Import Return Data;
                                 NOR=Les &inn returdata];
                      ApplicationArea=#Basic,#Suite;
                      Image=Import;
                      OnAction=VAR
                                 ImportPaymentOrder@1080000 : Report 15000003;
                               BEGIN
                                 // Import payments.
                                 // Start report (batch) with current journal lines. Imports payments into journal.
                                 ImportPaymentOrder.SetJournal(Rec);
                                 ImportPaymentOrder.RUNMODAL;
                                 CLEAR(ImportPaymentOrder);
                               END;
                                }
      { 1080011 ;2   ;Action    ;
                      ShortCutKey=Shift+Ctrl+F9;
                      CaptionML=[ENU=Settlement Info;
                                 NOR=Avregningsopplysninger];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 15000011;
                      RunPageLink=Journal Template Name=FIELD(Journal Template Name),
                                  Journal Batch Name=FIELD(Journal Batch Name),
                                  Line No.=FIELD(Line No.);
                      Image=Reconcile }
      { 1080013 ;2   ;Action    ;
                      CaptionML=[ENU=Payment Order;
                                 NOR=Oppdrag];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 15000002;
                      Image=Order }
      { 1080014 ;2   ;Action    ;
                      CaptionML=[ENU=Waiting Journal;
                                 NOR=Ventekladd];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 15000005;
                      Image=Journal }
      { 1080016 ;2   ;Action    ;
                      CaptionML=[ENU=About Remittance;
                                 NOR=Om Remittering];
                      ApplicationArea=#Basic,#Suite;
                      Image=Info;
                      OnAction=VAR
                                 RemTools@1080000 : Codeunit 15000002;
                               BEGIN
                                 RemTools.AboutRemittance;
                               END;
                                }
      { 41      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Payments;
                                 NOR=&Betalinger];
                      Image=Payment }
      { 42      ;2   ;Action    ;
                      Name=SuggestVendorPayments;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Suggest Vendor Payments;
                                 NOR=Betalingsforslag - leverand›r];
                      ToolTipML=[ENU=Create payment suggestion as lines in the payment journal.;
                                 NOR=Oppretter betalingsforslag som linjer i betalingskladden.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=SuggestVendorPayments;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 SuggestVendorPayments@1001 : Report 393;
                               BEGIN
                                 CLEAR(SuggestVendorPayments);
                                 SuggestVendorPayments.SetGenJnlLine(Rec);
                                 SuggestVendorPayments.RUNMODAL;
                               END;
                                }
      { 63      ;2   ;Action    ;
                      Name=PreviewCheck;
                      CaptionML=[ENU=P&review Check;
                                 NOR=&Forh†ndsvis sjekk];
                      ToolTipML=[ENU=Preview the check before printing it.;
                                 NOR=FOrh†ndsviser sjekken f›r den skrives ut.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 404;
                      RunPageLink=Journal Template Name=FIELD(Journal Template Name),
                                  Journal Batch Name=FIELD(Journal Batch Name),
                                  Line No.=FIELD(Line No.);
                      Image=ViewCheck }
      { 64      ;2   ;Action    ;
                      Name=PrintCheck;
                      AccessByPermission=TableData 272=R;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Print Check;
                                 NOR=Skriv ut sjekk];
                      ToolTipML=[ENU=Prepare to print the check.;
                                 NOR=Klargj›r for † skrive ut sjekken.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Image=PrintCheck;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 GenJnlLine.RESET;
                                 GenJnlLine.COPY(Rec);
                                 GenJnlLine.SETRANGE("Journal Template Name","Journal Template Name");
                                 GenJnlLine.SETRANGE("Journal Batch Name","Journal Batch Name");
                                 DocPrint.PrintCheck(GenJnlLine);
                                 CODEUNIT.RUN(CODEUNIT::"Adjust Gen. Journal Balance",Rec);
                               END;
                                }
      { 65      ;2   ;Action    ;
                      CaptionML=[ENU=Void Check;
                                 NOR=Kanseller sjekk];
                      ToolTipML=[ENU=Void the check if, for example, the check is not cashed by the bank.;
                                 NOR=Annullerer sjekken hvis den for eksempel ikke utbetales av banken.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Image=VoidCheck;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 TESTFIELD("Bank Payment Type","Bank Payment Type"::"Computer Check");
                                 TESTFIELD("Check Printed",TRUE);
                                 IF CONFIRM(Text000,FALSE,"Document No.") THEN
                                   CheckManagement.VoidCheck(Rec);
                               END;
                                }
      { 66      ;2   ;Action    ;
                      CaptionML=[ENU=Void &All Checks;
                                 NOR=Kanseller &alle sjekker];
                      ToolTipML=[ENU=Void all checks if, for example, the checks are not cashed by the bank.;
                                 NOR=Annullerer alle sjekkene hvis de for eksempel ikke utbetales av banken.];
                      ApplicationArea=#Basic,#Suite;
                      Image=VoidAllChecks;
                      OnAction=BEGIN
                                 IF CONFIRM(Text001,FALSE) THEN BEGIN
                                   GenJnlLine.RESET;
                                   GenJnlLine.COPY(Rec);
                                   GenJnlLine.SETRANGE("Bank Payment Type","Bank Payment Type"::"Computer Check");
                                   GenJnlLine.SETRANGE("Check Printed",TRUE);
                                   IF GenJnlLine.FIND('-') THEN
                                     REPEAT
                                       GenJnlLine2 := GenJnlLine;
                                       CheckManagement.VoidCheck(GenJnlLine2);
                                     UNTIL GenJnlLine.NEXT = 0;
                                 END;
                               END;
                                }
      { 26      ;2   ;Action    ;
                      Name=CreditTransferRegEntries;
                      CaptionML=[ENU=Credit Transfer Reg. Entries;
                                 NOR=Poster i kredittoverf›ringsreg.];
                      ToolTipML=[ENU=View or edit the credit transfer entries that are related to file export for credit transfers.;
                                 NOR=Viser eller redigerer kredittoverf›ringene som er relatert til fileksport for kredittoverf›ringer.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Codeunit 16;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=ExportReceipt;
                      PromotedCategory=Category4 }
      { 23      ;2   ;Action    ;
                      Name=CreditTransferRegisters;
                      CaptionML=[ENU=Credit Transfer Registers;
                                 NOR=Kredittoverf›ringsregistre];
                      ToolTipML=[ENU=View or edit the payment files that have been exported in connection with credit transfers.;
                                 NOR=Viser eller redigerer betalingsfilene som er eksportert i forbindelse med kredittoverf›ringer.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 1205;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=ExportElectronicDocument;
                      PromotedCategory=Category4 }
      { 54      ;1   ;Action    ;
                      Name=Approvals;
                      AccessByPermission=TableData 454=R;
                      CaptionML=[ENU=Approvals;
                                 NOR=Godkjenninger];
                      ToolTipML=[ENU=View a list of the records that are waiting to be approved. For example, you can see who requested the record to be approved, when it was sent, and when it is due to be approved.;
                                 NOR=Vis en liste med poster dom venter p† † bli godkjent. Du kan for eksempel se hvem som har bedt om godkjenning av posten, n†r den ble sendt og n†r den forfaller til godkjenning.];
                      ApplicationArea=#Suite;
                      Image=Approvals;
                      OnAction=VAR
                                 GenJournalLine@1001 : Record 81;
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 GetCurrentlySelectedLines(GenJournalLine);
                                 ApprovalsMgmt.ShowJournalApprovalEntries(GenJournalLine);
                               END;
                                }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 40      ;1   ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 NOR=F&unksjoner];
                      Image=Action }
      { 19      ;2   ;Action    ;
                      CaptionML=[ENU=Renumber Document Numbers;
                                 NOR=Nummerer dokumentnumre p† nytt];
                      ToolTipML=[ENU=Resort the numbers in the Document No. column to avoid posting errors because the document numbers are not in sequence. Entry applications and line groupings are preserved.;
                                 NOR=Sorter tallene i kolonnen Dokumentnr. p† nytt for † unng† bokf›ringsfeil, fordi dokumentnumrene ikke st†r etter hverandre. Postutligninger og linjegrupperinger beholdes.];
                      ApplicationArea=#Basic,#Suite;
                      Image=EditLines;
                      OnAction=BEGIN
                                 RenumberDocumentNo
                               END;
                                }
      { 93      ;2   ;Action    ;
                      Name=ApplyEntries;
                      ShortCutKey=Shift+F11;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Apply Entries;
                                 NOR=Utlign poster];
                      ToolTipML=[ENU=Select one or more ledger entries that you want to apply this record to so that the related posted documents are closed as paid or refunded.;
                                 NOR=Velg ‚n eller flere poster du vil utligne mot denne posten slik at de relaterte bokf›rte dokumentene lukkes som betalte eller refunderte.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Codeunit 225;
                      Promoted=Yes;
                      Image=ApplyEntries;
                      PromotedCategory=Process }
      { 68      ;2   ;Action    ;
                      Name=CalculatePostingDate;
                      CaptionML=[ENU=Calculate Posting Date;
                                 NOR=Beregn bokf›ringsdato];
                      ToolTipML=[ENU=Calculate the date that will appear as the posting date on the journal lines.;
                                 NOR=Beregner datoen som vises som bokf›ringsdato p† kladdelinjene.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Image=CalcWorkCenterCalendar;
                      PromotedCategory=Category5;
                      OnAction=BEGIN
                                 CalculatePostingDate;
                               END;
                                }
      { 94      ;2   ;Action    ;
                      CaptionML=[ENU=Insert Conv. LCY Rndg. Lines;
                                 NOR=Sett inn konv.avrund.linjer - NOK];
                      ToolTipML=[ENU=Insert a rounding correction line in the journal. This rounding correction line will balance in LCY when amounts in the foreign currency also balance. You can then post the journal.;
                                 NOR=Sett inn en avrundingskorreksjonslinje i kladden. Denne avrundingskorreksjonslinjen balanseres i NOK n†r bel›pene i utenlandsk valuta ogs† balanseres. Deretter kan du bokf›re kladden.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Codeunit 407;
                      Image=InsertCurrency }
      { 1101103003;2 ;Action    ;
                      Name=Open Document in Compello;
                      CaptionML=[ENU=Open Document in Compello;
                                 NOR=pne Dokument i Compello];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Document;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 CompelloShowDoc@1101103000 : Codeunit 70006;
                               BEGIN
                                 CompelloShowDoc.ShowCompelloDocGenJournalLinePaym(Rec);
                               END;
                                }
      { 34      ;2   ;Action    ;
                      Name=PositivePayExport;
                      CaptionML=[ENU=Positive Pay Export;
                                 NOR=Eksport for Positive Pay];
                      Visible=FALSE;
                      Image=Export;
                      OnAction=VAR
                                 GenJnlBatch@1000 : Record 232;
                                 BankAcc@1001 : Record 270;
                               BEGIN
                                 GenJnlBatch.GET("Journal Template Name",CurrentJnlBatchName);
                                 IF GenJnlBatch."Bal. Account Type" = GenJnlBatch."Bal. Account Type"::"Bank Account" THEN BEGIN
                                   BankAcc."No." := GenJnlBatch."Bal. Account No.";
                                   PAGE.RUN(PAGE::"Positive Pay Export",BankAcc);
                                 END;
                               END;
                                }
      { 43      ;1   ;ActionGroup;
                      CaptionML=[ENU=P&osting;
                                 NOR=B&okf›ring];
                      Image=Post }
      { 48      ;2   ;Action    ;
                      ShortCutKey=Ctrl+F11;
                      CaptionML=[ENU=Reconcile;
                                 NOR=Avstem];
                      ToolTipML=[ENU=View the balances on bank accounts that are marked for reconciliation, usually liquid accounts.;
                                 NOR=Vis saldoene p† bankkonti som er merket for avstemming, vanligvis likviditetskonti.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Image=Reconcile;
                      PromotedCategory=Category4;
                      OnAction=BEGIN
                                 GLReconcile.SetGenJnlLine(Rec);
                                 GLReconcile.RUN;
                               END;
                                }
      { 78      ;2   ;Action    ;
                      Name=PreCheck;
                      CaptionML=[ENU=Vendor Pre-Payment Journal;
                                 NOR=Forh†ndsbetalingskladd for leverand›r];
                      ToolTipML=[ENU=View journal line entries, payment discounts, discount tolerance amounts, payment tolerance, and any errors associated with the entries. You can use the results of the report to review payment journal lines and to review the results of posting before you actually post.;
                                 NOR=Vis kladdelinjeposter, kontantrabatter, rabattoleransebel›p, betalingstoleranse og eventuelle feil som er knyttet til postene. Du kan bruke resultatene i rapporten til † kontrollere betalingskladdelinjer, og til † kontrollere bokf›ringsresultater f›r du faktisk bokf›rer.];
                      ApplicationArea=#Basic,#Suite;
                      Image=PreviewChecks;
                      OnAction=VAR
                                 GenJournalBatch@1000 : Record 232;
                               BEGIN
                                 GenJournalBatch.INIT;
                                 GenJournalBatch.SETRANGE("Journal Template Name","Journal Template Name");
                                 GenJournalBatch.SETRANGE(Name,"Journal Batch Name");
                                 REPORT.RUN(REPORT::"Vendor Pre-Payment Journal",TRUE,FALSE,GenJournalBatch);
                               END;
                                }
      { 45      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Test Report;
                                 NOR=Kontrollrapport];
                      ToolTipML=[ENU=View a test report so that you can find and correct any errors before you perform the actual posting of the journal or document.;
                                 NOR=Vis en kontrollrapport slik at du kan finne og rette eventuelle feil f›r du bokf›rer kladden eller dokumentet.];
                      ApplicationArea=#Basic,#Suite;
                      Image=TestReport;
                      OnAction=BEGIN
                                 ReportPrint.PrintGenJnlLine(Rec);
                               END;
                                }
      { 46      ;2   ;Action    ;
                      Name=Post;
                      ShortCutKey=F9;
                      CaptionML=[ENU=P&ost;
                                 NOR=B&okf›r];
                      ToolTipML=[ENU=Finalize the document or journal by posting the amounts and quantities to the related accounts in your company books.;
                                 NOR=Fullf›r dokumentet eller kladden ved † bokf›re bel›pene og antallene til de relaterte kontoene i selskapstabl†ene.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PostOrder;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CODEUNIT.RUN(CODEUNIT::"Gen. Jnl.-Post",Rec);
                                 CurrentJnlBatchName := GETRANGEMAX("Journal Batch Name");
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 32      ;2   ;Action    ;
                      Name=Preview;
                      CaptionML=[ENU=Preview Posting;
                                 NOR=Forh†ndsvis bokf›ring];
                      ToolTipML=[ENU=Review the different types of entries that will be created when you post the document or journal.;
                                 NOR=Se gjennom de ulike typene poster som blir opprettet n†r du bokf›rer dokumentet eller kladden.];
                      ApplicationArea=#Basic,#Suite;
                      Image=ViewPostedOrder;
                      OnAction=VAR
                                 GenJnlPost@1001 : Codeunit 231;
                               BEGIN
                                 GenJnlPost.Preview(Rec);
                               END;
                                }
      { 47      ;2   ;Action    ;
                      ShortCutKey=Shift+F9;
                      CaptionML=[ENU=Post and &Print;
                                 NOR=Bokf›r og &skriv ut];
                      ToolTipML=[ENU=Finalize and prepare to print the document or journal. The values and quantities are posted to the related accounts. A report request window where you can specify what to include on the print-out.;
                                 NOR=Fullf›r og klargj›r for † skrive ut dokumentet eller kladden. Verdiene og antallene blir bokf›rt til de relaterte kontiene. Det vises en rapportforesp›rselsside der du kan angi hva som skal inkluderes p† utskriften.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PostPrint;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CODEUNIT.RUN(CODEUNIT::"Gen. Jnl.-Post+Print",Rec);
                                 CurrentJnlBatchName := GETRANGEMAX("Journal Batch Name");
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 36      ;1   ;ActionGroup;
                      CaptionML=[ENU=Request Approval;
                                 NOR=Be om godkjenning] }
      { 86      ;2   ;ActionGroup;
                      Name=SendApprovalRequest;
                      CaptionML=[ENU=Send Approval Request;
                                 NOR=Send godkjenningsforesp›rsel];
                      Image=SendApprovalRequest }
      { 76      ;3   ;Action    ;
                      Name=SendApprovalRequestJournalBatch;
                      CaptionML=[ENU=Journal Batch;
                                 NOR=Kladd];
                      ToolTipML=[ENU=Send all journal lines for approval, also those that you may not see because of filters.;
                                 NOR=Send alle kladdelinjer til godkjenning, ogs† de du kanskje ikke ser p† grunn av filtre.];
                      ApplicationArea=#Suite;
                      Enabled=NOT OpenApprovalEntriesOnBatchOrAnyJnlLineExist;
                      Image=SendApprovalRequest;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.TrySendJournalBatchApprovalRequest(Rec);
                                 SetControlAppearance;
                               END;
                                }
      { 74      ;3   ;Action    ;
                      Name=SendApprovalRequestJournalLine;
                      CaptionML=[ENU=Selected Journal Lines;
                                 NOR=Valgte kladdelinjer];
                      ToolTipML=[ENU=Send selected journal lines for approval.;
                                 NOR=Send valgte kladdelinjer til godkjenning.];
                      ApplicationArea=#Suite;
                      Enabled=NOT OpenApprovalEntriesOnBatchOrCurrJnlLineExist;
                      Image=SendApprovalRequest;
                      OnAction=VAR
                                 GenJournalLine@1001 : Record 81;
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 GetCurrentlySelectedLines(GenJournalLine);
                                 ApprovalsMgmt.TrySendJournalLineApprovalRequests(GenJournalLine);
                               END;
                                }
      { 52      ;2   ;ActionGroup;
                      Name=CancelApprovalRequest;
                      CaptionML=[ENU=Cancel Approval Request;
                                 NOR=Annuller godkjenningsforesp›rsel];
                      Image=Cancel }
      { 50      ;3   ;Action    ;
                      Name=CancelApprovalRequestJournalBatch;
                      CaptionML=[ENU=Journal Batch;
                                 NOR=Kladd];
                      ToolTipML=[ENU=Cancel sending all journal lines for approval, also those that you may not see because of filters.;
                                 NOR=Avbryt sending av alle kladdelinjer til godkjenning, ogs† de du kanskje ikke ser p† grunn av filtre.];
                      ApplicationArea=#Suite;
                      Enabled=CanCancelApprovalForJnlBatch;
                      Image=CancelApprovalRequest;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.TryCancelJournalBatchApprovalRequest(Rec);
                                 SetControlAppearance;
                               END;
                                }
      { 96      ;3   ;Action    ;
                      Name=CancelApprovalRequestJournalLine;
                      CaptionML=[ENU=Selected Journal Lines;
                                 NOR=Valgte kladdelinjer];
                      ToolTipML=[ENU=Cancel sending selected journal lines for approval.;
                                 NOR=Avbryt sending av valgte kladdelinjer til godkjenning.];
                      ApplicationArea=#Suite;
                      Enabled=CanCancelApprovalForJnlLine;
                      Image=CancelApprovalRequest;
                      OnAction=VAR
                                 GenJournalLine@1001 : Record 81;
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 GetCurrentlySelectedLines(GenJournalLine);
                                 ApprovalsMgmt.TryCancelJournalLineApprovalRequests(GenJournalLine);
                               END;
                                }
      { 98      ;1   ;ActionGroup;
                      CaptionML=[ENU=Workflow;
                                 NOR=Arbeidsflyt] }
      { 90      ;2   ;Action    ;
                      Name=CreateApprovalWorkflow;
                      CaptionML=[ENU=Create Approval Workflow;
                                 NOR=Opprett arbeidsflyt for godkjenning];
                      ToolTipML=[ENU=Set up an approval workflow for payment journal lines, by going through a few pages that will guide you.;
                                 NOR=Konfigurer en arbeidsflyt for godkjenning for betalingskladdelinjer, ved † lese gjennom et par sider med veiledning.];
                      ApplicationArea=#Suite;
                      Enabled=NOT EnabledApprovalWorkflowsExist;
                      Image=CreateWorkflow;
                      OnAction=VAR
                                 TempApprovalWorkflowWizard@1001 : TEMPORARY Record 1804;
                               BEGIN
                                 TempApprovalWorkflowWizard."Journal Batch Name" := "Journal Batch Name";
                                 TempApprovalWorkflowWizard."Journal Template Name" := "Journal Template Name";
                                 TempApprovalWorkflowWizard."For All Batches" := FALSE;
                                 TempApprovalWorkflowWizard.INSERT;

                                 PAGE.RUNMODAL(PAGE::"Pmt. App. Workflow Setup Wzrd.",TempApprovalWorkflowWizard);
                               END;
                                }
      { 102     ;2   ;Action    ;
                      Name=ManageApprovalWorkflows;
                      CaptionML=[ENU=Manage Approval Workflows;
                                 NOR=Administrer arbeidsflyter for godkjenning];
                      ToolTipML=[ENU=View or edit existing approval workflows for payment journal lines.;
                                 NOR=Viser eller redigerer eksisterende arbeidsflyter for betalingskladdelinjer.];
                      ApplicationArea=#Suite;
                      Enabled=EnabledApprovalWorkflowsExist;
                      Image=WorkflowSetup;
                      OnAction=VAR
                                 WorkflowManagement@1000 : Codeunit 1501;
                               BEGIN
                                 WorkflowManagement.NavigateToWorkflows(DATABASE::"Gen. Journal Line",EventFilter);
                               END;
                                }
      { 72      ;1   ;ActionGroup;
                      CaptionML=[ENU=Approval;
                                 NOR=Godkjenning] }
      { 70      ;2   ;Action    ;
                      Name=Approve;
                      CaptionML=[ENU=Approve;
                                 NOR=Godkjenn];
                      ToolTipML=[ENU=Approve the requested changes.;
                                 NOR=Godkjenn de forespurte endringene.];
                      ApplicationArea=#All;
                      Promoted=Yes;
                      Visible=OpenApprovalEntriesExistForCurrUser;
                      PromotedIsBig=Yes;
                      Image=Approve;
                      PromotedCategory=Category6;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.ApproveGenJournalLineRequest(Rec);
                               END;
                                }
      { 62      ;2   ;Action    ;
                      Name=Reject;
                      CaptionML=[ENU=Reject;
                                 NOR=Avvis];
                      ToolTipML=[ENU=Reject the approval request.;
                                 NOR=Avvis godkjenningsforesp›rselen.];
                      ApplicationArea=#All;
                      Promoted=Yes;
                      Visible=OpenApprovalEntriesExistForCurrUser;
                      PromotedIsBig=Yes;
                      Image=Reject;
                      PromotedCategory=Category6;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.RejectGenJournalLineRequest(Rec);
                               END;
                                }
      { 60      ;2   ;Action    ;
                      Name=Delegate;
                      CaptionML=[ENU=Delegate;
                                 NOR=Deleger];
                      ToolTipML=[ENU=Delegate the approval to a substitute approver.;
                                 NOR=Deleger godkjenningen til en stedfortredende godkjenner.];
                      ApplicationArea=#All;
                      Promoted=Yes;
                      Visible=OpenApprovalEntriesExistForCurrUser;
                      Image=Delegate;
                      PromotedCategory=Category6;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.DelegateGenJournalLineRequest(Rec);
                               END;
                                }
      { 56      ;2   ;Action    ;
                      Name=Comment;
                      CaptionML=[ENU=Comments;
                                 NOR=Merknader];
                      ToolTipML=[ENU=View or add comments.;
                                 NOR=Vis eller legg til merknader.];
                      ApplicationArea=#All;
                      Promoted=Yes;
                      Visible=OpenApprovalEntriesExistForCurrUser;
                      Image=ViewComments;
                      PromotedCategory=Category6;
                      OnAction=VAR
                                 GenJournalBatch@1001 : Record 232;
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 IF OpenApprovalEntriesOnJnlLineExist THEN
                                   ApprovalsMgmt.GetApprovalComment(Rec)
                                 ELSE
                                   IF OpenApprovalEntriesOnJnlBatchExist THEN
                                     IF GenJournalBatch.GET("Journal Template Name","Journal Batch Name") THEN
                                       ApprovalsMgmt.GetApprovalComment(GenJournalBatch);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 33  ;1   ;Field     ;
                Lookup=Yes;
                CaptionML=[ENU=Batch Name;
                           NOR=Bunkenavn];
                ToolTipML=[ENU=Specifies the batch name on the payment journal.;
                           NOR=Angir kladdenavnet i utbetalingskladden.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=CurrentJnlBatchName;
                OnValidate=BEGIN
                             GenJnlManagement.CheckName(CurrentJnlBatchName,Rec);
                             CurrentJnlBatchNameOnAfterVali;
                           END;

                OnLookup=BEGIN
                           CurrPage.SAVERECORD;
                           GenJnlManagement.LookupName(CurrentJnlBatchName,Rec);
                           CurrPage.UPDATE(FALSE);
                         END;
                          }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the posting date for the entry.;
                           NOR=Angir postens bokf›ringsdato.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Posting Date";
                Style=Attention;
                StyleExpr=HasPmtFileErr }

    { 35  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date on the document that provides the basis for the entry on the journal line.;
                           NOR=Angir datoen i dokumentet som danner grunnlaget for posten p† kladdelinjen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Document Date";
                Visible=FALSE;
                Style=Attention;
                StyleExpr=HasPmtFileErr }

    { 4   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the type of document that the entry on the journal line is.;
                           NOR=Angir hvilken type bilag posten p† kladdelinjen er.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Document Type";
                Style=Attention;
                StyleExpr=HasPmtFileErr }

    { 6   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a document number for the journal line.;
                           NOR=Angir et dokumentnummer for kladdelinjen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Document No.";
                Style=Attention;
                StyleExpr=HasPmtFileErr }

    { 9   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the incoming document that this general journal line is created for.;
                           NOR=Angir nummeret p† det innkommende dokumentet som denne finanskladdelinjen er opprettet for.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Incoming Document Entry No.";
                Visible=FALSE;
                OnAssistEdit=BEGIN
                               IF "Incoming Document Entry No." > 0 THEN
                                 HYPERLINK(GetIncomingDocumentURL);
                             END;
                              }

    { 83  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a document number that refers to the customer's or vendor's numbering system.;
                           NOR=Angir et dokumentnummer som henviser til kundens eller leverand›rens nummereringssystem.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="External Document No." }

    { 21  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the external document number that will be exported in the payment file.;
                           NOR=Angir det eksterne dokumentnummeret som skal eksporteres i betalingsfilen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Applies-to Ext. Doc. No.";
                Visible=FALSE }

    { 8   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the type of account that the entry on the journal line will be posted to.;
                           NOR=Angir kontotypen som posten p† kladdelinjen skal bokf›res p†.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Account Type";
                OnValidate=BEGIN
                             GenJnlManagement.GetAccounts(Rec,AccName,BalAccName);
                           END;
                            }

    { 10  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the account number that the entry on the journal line will be posted to.;
                           NOR=Angir kontonummeret som posten p† kladdelinjen skal bokf›res p†.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Account No.";
                Style=Attention;
                StyleExpr=HasPmtFileErr;
                OnValidate=BEGIN
                             GenJnlManagement.GetAccounts(Rec,AccName,BalAccName);
                             ShowShortcutDimCode(ShortcutDimCode);
                           END;

                ShowMandatory=True }

    { 13  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the bank account that the amount will be transferred to after it has been exported from the payment journal.;
                           NOR=Angir bankkontoen som bel›pet vil bli overf›rt til etter at det har blitt eksportert fra utbetalingskladden.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Recipient Bank Account";
                ShowMandatory=True }

    { 11  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the message exported to the payment file when you use the Export Payments to File function in the Payment Journal window.;
                           NOR=Angir meldingen som eksporteres til betalingsfilen n†r du bruker funksjonen Eksporter betalinger til fil i vinduet Betalingskladd.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Message to Recipient" }

    { 12  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a description of the entry. The field is automatically filled when the Account No. field is filled.;
                           NOR=Angir en beskrivelse av posten. Feltet fylles automatisk ut n†r feltet Kontonr. fylles ut.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Description;
                Style=Attention;
                StyleExpr=HasPmtFileErr }

    { 53  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the salesperson or purchaser who is linked to the journal line.;
                           NOR=Angir hvilken selger eller innkj›per som er tilknyttet kladdelinjen.];
                ApplicationArea=#Suite;
                SourceExpr="Salespers./Purch. Code";
                Visible=FALSE }

    { 95  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the campaign the journal line is linked to.;
                           NOR=Angir nummeret for kampanjen som kladdelinjen er knyttet til.];
                SourceExpr="Campaign No.";
                Visible=FALSE }

    { 55  ;2   ;Field     ;
                AssistEdit=Yes;
                ToolTipML=[ENU=Specifies the code of the currency for the amounts on the journal line.;
                           NOR=Angir valutakoden for bel›pene p† kladdelinjen.];
                ApplicationArea=#Suite;
                SourceExpr="Currency Code";
                OnAssistEdit=BEGIN
                               ChangeExchangeRate.SetParameter("Currency Code","Currency Factor","Posting Date");
                               IF ChangeExchangeRate.RUNMODAL = ACTION::OK THEN
                                 VALIDATE("Currency Factor",ChangeExchangeRate.GetParameter);

                               CLEAR(ChangeExchangeRate);
                             END;
                              }

    { 1080000;2;Field     ;
                ToolTipML=[ENU=Specifies the VAT Code to be used on the line.;
                           NOR=Angir mva-koden som skal brukes p† linjen.];
                SourceExpr="VAT Code";
                Visible=FALSE }

    { 77  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the general posting type that will be used when you post the entry on this journal line.;
                           NOR=Angir bokf›ringstypen som vil bli brukt n†r du bokf›rer posten p† kladdelinjen.];
                SourceExpr="Gen. Posting Type";
                Visible=FALSE }

    { 79  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code of the general business posting group that will be used when you post the entry on the journal line.;
                           NOR=Angir firmabokf›ringsgruppen som brukes n†r du bokf›rer posten p† kladdelinjen.];
                SourceExpr="Gen. Bus. Posting Group";
                Visible=FALSE }

    { 81  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code of the general product posting group that will be used when you post the entry on the journal line.;
                           NOR=Angir koden for den generelle bokf›ringsgruppen som brukes n†r du bokf›rer posten p† kladdelinjen.];
                SourceExpr="Gen. Prod. Posting Group";
                Visible=FALSE }

    { 85  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the VAT business posting group code that will be used when you post the entry on the journal line.;
                           NOR=Angir koden for mva-bokf›ringsgruppe - firma som gjelder for posten p† kladdelinjen.];
                SourceExpr="VAT Bus. Posting Group";
                Visible=FALSE }

    { 87  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code of the VAT product posting group that will be used when you post the entry on the journal line.;
                           NOR=Angir koden for mva-bokf›ringsgruppe - vare som vil brukes n†r du bokf›rer posten p† kladdelinjen.];
                SourceExpr="VAT Prod. Posting Group";
                Visible=FALSE }

    { 100 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the payment method that was used to make the payment that resulted in the entry.;
                           NOR=Angir betalingsm†ten som ble brukt til † utf›re betalingen som resulterte i posten.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Payment Method Code";
                ShowMandatory=True }

    { 110 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the payment of the purchase invoice.;
                           NOR=Angir betalingen for kj›psfakturaen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Payment Reference" }

    { 115 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the vendor who sent the purchase invoice.;
                           NOR=Angir leverand›ren som sendte kj›psfakturaen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Creditor No." }

    { 14  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the total amount (including VAT) that the journal line consists of.;
                           NOR=Angir det totale bel›pet (inkl. mva.) som kladdelinjen best†r av.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Amount;
                Style=Attention;
                StyleExpr=HasPmtFileErr;
                ShowMandatory=True }

    { 1000;2   ;Field     ;
                ToolTipML=[ENU=Specifies the total amount (including VAT) that the journal line consists of, if it is a debit amount. The amount must be entered in the currency represented by the currency code on the line.;
                           NOR=Angir bruttobel›pet (bel›p inkl. mva.) som kladdelinjen best†r av hvis det er et debetbel›p. Bel›pet skal angis i den valutaen som valutakoden p† linjen representerer.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Debit Amount";
                Visible=FALSE }

    { 1001;2   ;Field     ;
                ToolTipML=[ENU=Specifies the total amount (including VAT) that the journal line consists of, if it is a credit amount. The amount must be entered in the currency represented by the currency code on the line.;
                           NOR=Angir bruttobel›pet (bel›p inkl. mva.) som kladdelinjen best†r av hvis det er et kreditbel›p. Bel›pet skal angis i den valutaen som valutakoden p† linjen representerer.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Credit Amount";
                Visible=FALSE }

    { 97  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the amount of VAT included in the total amount.;
                           NOR=Angir bel›pet for mva som utgj›r bruttobel›pet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="VAT Amount";
                Visible=FALSE }

    { 101 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the difference between the calculate VAT amount and the VAT amount that you have entered manually.;
                           NOR=Angir forskjellen mellom det beregnede mva-bel›pet og mva-bel›pet du har angitt manuelt.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="VAT Difference";
                Visible=FALSE }

    { 99  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the amount of Bal. VAT included in the total amount.;
                           NOR=Angir bel›pet for Motkonto-mva. som utgj›r bruttobel›pet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Bal. VAT Amount";
                Visible=FALSE }

    { 103 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the difference between the calculate VAT amount and the VAT amount that you have entered manually.;
                           NOR=Angir forskjellen mellom det beregnede mva-bel›pet og mva-bel›pet du har angitt manuelt.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Bal. VAT Difference";
                Visible=FALSE }

    { 61  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for the balancing account type that should be used in this journal line.;
                           NOR=Angir koden for motkontotypen som skal brukes p† denne kladdelinjen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Bal. Account Type" }

    { 16  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the general ledger, customer, vendor, or bank account to which a balancing entry for the journal line will posted (for example, a cash account for cash purchases).;
                           NOR=Angir nummeret p† finans-, kunde-, leverand›r- eller bankkontoen som en motpost for kladdelinjen skal bokf›res p† (for eksempel en kassakonto for kontantkj›p).];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Bal. Account No.";
                OnValidate=BEGIN
                             GenJnlManagement.GetAccounts(Rec,AccName,BalAccName);
                             ShowShortcutDimCode(ShortcutDimCode);
                           END;
                            }

    { 1080002;2;Field     ;
                ToolTipML=[ENU=Specifies the VAT Code to be used on the line.;
                           NOR=Angir mva-koden som skal brukes p† linjen.];
                SourceExpr="Bal. VAT Code";
                Visible=FALSE }

    { 71  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the general posting type that will be used when you post the entry on the journal line.;
                           NOR=Angir bokf›ringstypen som vil bli brukt n†r du bokf›rer posten p† kladdelinjen.];
                SourceExpr="Bal. Gen. Posting Type";
                Visible=FALSE }

    { 73  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code of the general business posting group that will be used when you post the entry on the journal line.;
                           NOR=Angir firmabokf›ringsgruppen som brukes n†r du bokf›rer posten p† kladdelinjen.];
                SourceExpr="Bal. Gen. Bus. Posting Group";
                Visible=FALSE }

    { 75  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code of the general product posting group that will be used when you post the entry on the journal line.;
                           NOR=Angir koden for den generelle bokf›ringsgruppen som brukes n†r du bokf›rer posten p† kladdelinjen.];
                SourceExpr="Bal. Gen. Prod. Posting Group";
                Visible=FALSE }

    { 89  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code of the VAT business posting group that will be used when you post the entry on the journal line.;
                           NOR=Angir koden for mva-bokf›ringsgruppe - firma som vil brukes n†r du bokf›rer posten p† kladdelinjen.];
                SourceExpr="Bal. VAT Bus. Posting Group";
                Visible=FALSE }

    { 91  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code of the VAT product posting group that will be used when you post the entry on the journal line.;
                           NOR=Angir koden for mva-bokf›ringsgruppe - vare som vil brukes n†r du bokf›rer posten p† kladdelinjen.];
                SourceExpr="Bal. VAT Prod. Posting Group";
                Visible=FALSE }

    { 49  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for Shortcut Dimension 1.;
                           NOR=Angir koden for Snarveisdimensjon 1.];
                ApplicationArea=#Suite;
                SourceExpr="Shortcut Dimension 1 Code";
                Visible=FALSE }

    { 51  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for Shortcut Dimension 2.;
                           NOR=Angir koden for Snarveisdimensjon 2.];
                ApplicationArea=#Suite;
                SourceExpr="Shortcut Dimension 2 Code";
                Visible=FALSE }

    { 300 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[3];
                CaptionClass='1,2,3';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(3),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(3,ShortcutDimCode[3]);
                           END;
                            }

    { 302 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[4];
                CaptionClass='1,2,4';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(4),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(4,ShortcutDimCode[4]);
                           END;
                            }

    { 304 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[5];
                CaptionClass='1,2,5';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(5),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(5,ShortcutDimCode[5]);
                           END;
                            }

    { 306 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[6];
                CaptionClass='1,2,6';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(6),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(6,ShortcutDimCode[6]);
                           END;
                            }

    { 308 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[7];
                CaptionClass='1,2,7';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(7),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(7,ShortcutDimCode[7]);
                           END;
                            }

    { 310 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[8];
                CaptionClass='1,2,8';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(8),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(8,ShortcutDimCode[8]);
                           END;
                            }

    { 5   ;2   ;Field     ;
                Name=Applied (Yes/No);
                CaptionML=[ENU=Applied (Yes/No);
                           NOR=Utlignet (Ja/Nei)];
                ToolTipML=[ENU=Specifies if the payment has been applied.;
                           NOR=Angir om betalingen er utlignet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=IsApplied }

    { 18  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the type of the posted document that this document or journal line will be applied to when you post, for example to register payment.;
                           NOR=Angir typen bokf›rt dokument som dette dokumentet eller denne kladdelinjen blir utlignet til n†r du bokf›rer, for eksempel for † registrere utbetaling.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Applies-to Doc. Type" }

    { 20  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the posted document that this document or journal line will be applied to when you post, for example to register payment.;
                           NOR=Angir nummeret for det bokf›rte dokumentet som dette dokumentet eller denne kladdelinjen blir utlignet til n†r du bokf›rer, for eksempel for † registrere utbetaling.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Applies-to Doc. No.";
                StyleExpr=StyleTxt }

    { 22  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the entries that will be applied to by the journal line if you use the Apply Entries facility.;
                           NOR=Angir postene som vil bli utlignet av kladdelinjen hvis du bruker funksjonen Utlign poster.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Applies-to ID";
                Visible=FALSE;
                StyleExpr=StyleTxt }

    { 105 ;2   ;Field     ;
                Name=GetAppliesToDocDueDate;
                CaptionML=[ENU=Applies-to Doc. Due Date;
                           NOR=Forfallsdato for utligningsbilag];
                ToolTipML=[ENU=Specifies the due date from the Applies-to Doc. on the journal line.;
                           NOR=Angir forfallsdatoen fra utligningsbilaget p† kladdelinjen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=GetAppliesToDocDueDate;
                StyleExpr=StyleTxt }

    { 67  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for the payment type to be used for the entry on the payment journal line.;
                           NOR=Angir koden til betalingstypen som skal brukes for posten p† betalingskladdelinjen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Bank Payment Type" }

    { 59  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies whether a check has been printed for the amount on the payment journal line.;
                           NOR=Angir om en sjekk er skrevet ut for bel›pet p† betalingskladdelinjen.];
                SourceExpr="Check Printed";
                Visible=FALSE }

    { 69  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the reason code that has been entered on the journal lines.;
                           NOR=Angir †rsakskoden som er satt inn p† kladdelinjene.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Reason Code";
                Visible=FALSE }

    { 3   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a comment related to registering a payment.;
                           NOR=Angir en kommentar som er knyttet til registrering av en betaling.];
                SourceExpr=Comment;
                Visible=FALSE }

    { 290 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies that the payment journal line was exported to a payment file.;
                           NOR=Angir at utbetalingskladdelinjen ble eksportert til en betalingsfil.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Exported to Payment File" }

    { 1080017;2;Field     ;
                ToolTipML=[ENU=Specifies a two-digit code for the payment type.;
                           NOR=Angir en tosifret kode for betalingstypen.];
                SourceExpr="Payment Type Code Abroad";
                Visible=FALSE }

    { 1080019;2;Field     ;
                ToolTipML=[ENU=Specifies information for your local government bank.;
                           NOR=Angir informasjon for sentralbanken i landet.];
                SourceExpr="Specification (Norges Bank)";
                Visible=FALSE }

    { 28  ;2   ;Field     ;
                Name=TotalExportedAmount;
                DrillDown=Yes;
                CaptionML=[ENU=Total Exported Amount;
                           NOR=Totalt eksportert bel›p];
                ToolTipML=[ENU=Specifies the amount for the payment journal line that has been exported to payment files that are not canceled.;
                           NOR=Angir bel›pet for utbetalingskladdelinjen som er eksportert til betalingsfiler som ikke er kansellert.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=TotalExportedAmount;
                OnDrillDown=BEGIN
                              DrillDownExportedAmount
                            END;
                             }

    { 17  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies that an error occurred when you used the Export Payments to File function in the Payment Journal window.;
                           NOR=Angir at det oppstod en feil da du brukte funksjonen Eksporter betalinger til fil i vinduet Betalingskladd.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Has Payment Export Error" }

    { 24  ;1   ;Group      }

    { 80  ;2   ;Group     ;
                GroupType=FixedLayout }

    { 82  ;3   ;Group     ;
                GroupType=Group }

    { 84  ;4   ;Field     ;
                ToolTipML=[ENU=Specifies the text that is displayed for overdue payments.;
                           NOR=Angir teksten som vises for forfalte betalinger.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=OverdueWarningText;
                Style=Unfavorable;
                StyleExpr=TRUE }

    { 1903561801;2;Group  ;
                GroupType=FixedLayout }

    { 1903866901;3;Group  ;
                CaptionML=[ENU=Account Name;
                           NOR=Kontonavn] }

    { 29  ;4   ;Field     ;
                ToolTipML=[ENU=Specifies the name of the account.;
                           NOR=Angir navnet p† kontoen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=AccName;
                Editable=FALSE;
                ShowCaption=No }

    { 1902759701;3;Group  ;
                CaptionML=[ENU=Bal. Account Name;
                           NOR=Motkontonavn] }

    { 31  ;4   ;Field     ;
                CaptionML=[ENU=Bal. Account Name;
                           NOR=Motkontonavn];
                ToolTipML=[ENU=Specifies the name of the balancing account that has been entered on the journal line.;
                           NOR=Angir navnet p† motkontoen som er satt inn p† kladdelinjen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=BalAccName;
                Editable=FALSE }

    { 1900545401;3;Group  ;
                CaptionML=[ENU=Balance;
                           NOR=Saldo] }

    { 25  ;4   ;Field     ;
                Name=Balance;
                CaptionML=[ENU=Balance;
                           NOR=Saldo];
                ToolTipML=[ENU=Specifies the balance that has accumulated in the payment journal on the line where the cursor is.;
                           NOR=Angir saldoen som er akkumulert i utbetalingskladden p† den linjen hvor mark›ren er plassert.];
                ApplicationArea=#All;
                SourceExpr=Balance + "Balance (LCY)" - xRec."Balance (LCY)";
                AutoFormatType=1;
                Visible=BalanceVisible;
                Editable=FALSE }

    { 1900295801;3;Group  ;
                CaptionML=[ENU=Total Balance;
                           NOR=Total saldo] }

    { 27  ;4   ;Field     ;
                Name=TotalBalance;
                CaptionML=[ENU=Total Balance;
                           NOR=Total saldo];
                ToolTipML=[ENU=Specifies the total balance in the payment journal.;
                           NOR=Angir den totale saldoen i utbetalingskladden.];
                ApplicationArea=#All;
                SourceExpr=TotalBalance + "Balance (LCY)" - xRec."Balance (LCY)";
                AutoFormatType=1;
                Visible=TotalBalanceVisible;
                Editable=FALSE }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 30  ;1   ;Part      ;
                Name=IncomingDocAttachFactBox;
                ApplicationArea=#Basic,#Suite;
                PagePartID=Page193;
                PartType=Page;
                ShowFilter=No }

    { 7   ;1   ;Part      ;
                CaptionML=[ENU=Payment File Errors;
                           NOR=Feil i betalingsfil];
                ApplicationArea=#Basic,#Suite;
                SubPageLink=Journal Template Name=FIELD(Journal Template Name),
                            Journal Batch Name=FIELD(Journal Batch Name),
                            Journal Line No.=FIELD(Line No.);
                PagePartID=Page1228;
                PartType=Page }

    { 1900919607;1;Part   ;
                SubPageLink=Dimension Set ID=FIELD(Dimension Set ID);
                PagePartID=Page699;
                Visible=FALSE;
                PartType=Page }

    { 88  ;1   ;Part      ;
                Name=WorkflowStatusBatch;
                CaptionML=[ENU=Batch Workflows;
                           NOR=Bunkearbeidsflyt];
                ApplicationArea=#Suite;
                PagePartID=Page1528;
                Visible=ShowWorkflowStatusOnBatch;
                Enabled=FALSE;
                Editable=FALSE;
                PartType=Page;
                ShowFilter=No }

    { 44  ;1   ;Part      ;
                Name=WorkflowStatusLine;
                CaptionML=[ENU=Line Workflows;
                           NOR=Linjearbeidsflyter];
                ApplicationArea=#Suite;
                PagePartID=Page1528;
                Visible=ShowWorkflowStatusOnLine;
                Enabled=FALSE;
                Editable=FALSE;
                PartType=Page;
                ShowFilter=No }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      Text000@1000 : TextConst 'ENU=Void Check %1?;NOR=Kanseller sjekk %1?';
      Text001@1001 : TextConst 'ENU=Void all printed checks?;NOR=Kanseller alle utskrevne sjekker?';
      GenJnlLine@1003 : Record 81;
      GenJnlLine2@1004 : Record 81;
      GenJnlManagement@1007 : Codeunit 230;
      ReportPrint@1008 : Codeunit 228;
      DocPrint@1009 : Codeunit 229;
      CheckManagement@1010 : Codeunit 367;
      ChangeExchangeRate@1005 : Page 511;
      GLReconcile@1002 : Page 345;
      CurrentJnlBatchName@1011 : Code[10];
      AccName@1012 : Text[50];
      BalAccName@1013 : Text[50];
      Balance@1014 : Decimal;
      TotalBalance@1015 : Decimal;
      ShowBalance@1016 : Boolean;
      ShowTotalBalance@1017 : Boolean;
      HasPmtFileErr@1006 : Boolean;
      ShortcutDimCode@1018 : ARRAY [8] OF Code[20];
      BalanceVisible@19073040 : Boolean INDATASET;
      TotalBalanceVisible@19063333 : Boolean INDATASET;
      StyleTxt@1106 : Text;
      OverdueWarningText@1120 : Text;
      EventFilter@1029 : Text;
      OpenApprovalEntriesExistForCurrUser@1019 : Boolean;
      OpenApprovalEntriesOnJnlBatchExist@1024 : Boolean;
      OpenApprovalEntriesOnJnlLineExist@1023 : Boolean;
      OpenApprovalEntriesOnBatchOrCurrJnlLineExist@1022 : Boolean;
      OpenApprovalEntriesOnBatchOrAnyJnlLineExist@1021 : Boolean;
      ShowWorkflowStatusOnBatch@1020 : Boolean;
      ShowWorkflowStatusOnLine@1025 : Boolean;
      CanCancelApprovalForJnlBatch@1026 : Boolean;
      CanCancelApprovalForJnlLine@1027 : Boolean;
      EnabledApprovalWorkflowsExist@1028 : Boolean;

    LOCAL PROCEDURE CheckForPmtJnlErrors@5();
    VAR
      BankAccount@1000 : Record 270;
      BankExportImportSetup@1001 : Record 1200;
    BEGIN
      IF HasPmtFileErr THEN
        IF ("Bal. Account Type" = "Bal. Account Type"::"Bank Account") AND BankAccount.GET("Bal. Account No.") THEN
          IF BankExportImportSetup.GET(BankAccount."Payment Export Format") THEN
            IF BankExportImportSetup."Check Export Codeunit" > 0 THEN
              CODEUNIT.RUN(BankExportImportSetup."Check Export Codeunit",Rec);
    END;

    LOCAL PROCEDURE UpdateBalance@1();
    BEGIN
      GenJnlManagement.CalcBalance(
        Rec,xRec,Balance,TotalBalance,ShowBalance,ShowTotalBalance);
      BalanceVisible := ShowBalance;
      TotalBalanceVisible := ShowTotalBalance;
    END;

    LOCAL PROCEDURE CurrentJnlBatchNameOnAfterVali@19002411();
    BEGIN
      CurrPage.SAVERECORD;
      GenJnlManagement.SetName(CurrentJnlBatchName,Rec);
      CurrPage.UPDATE(FALSE);
    END;

    LOCAL PROCEDURE GetCurrentlySelectedLines@3(VAR GenJournalLine@1000 : Record 81) : Boolean;
    BEGIN
      CurrPage.SETSELECTIONFILTER(GenJournalLine);
      EXIT(GenJournalLine.FINDSET);
    END;

    LOCAL PROCEDURE SetControlAppearance@4();
    VAR
      GenJournalBatch@1000 : Record 232;
      ApprovalsMgmt@1002 : Codeunit 1535;
    BEGIN
      IF GenJournalBatch.GET("Journal Template Name","Journal Batch Name") THEN;
      OpenApprovalEntriesExistForCurrUser :=
        ApprovalsMgmt.HasOpenApprovalEntriesForCurrentUser(GenJournalBatch.RECORDID) OR
        ApprovalsMgmt.HasOpenApprovalEntriesForCurrentUser(RECORDID);

      OpenApprovalEntriesOnJnlBatchExist := ApprovalsMgmt.HasOpenApprovalEntries(GenJournalBatch.RECORDID);
      OpenApprovalEntriesOnJnlLineExist := ApprovalsMgmt.HasOpenApprovalEntries(RECORDID);
      OpenApprovalEntriesOnBatchOrCurrJnlLineExist := OpenApprovalEntriesOnJnlBatchExist OR OpenApprovalEntriesOnJnlLineExist;

      OpenApprovalEntriesOnBatchOrAnyJnlLineExist :=
        OpenApprovalEntriesOnJnlBatchExist OR
        ApprovalsMgmt.HasAnyOpenJournalLineApprovalEntries("Journal Template Name","Journal Batch Name");

      CanCancelApprovalForJnlBatch := ApprovalsMgmt.CanCancelApprovalForRecord(GenJournalBatch.RECORDID);
      CanCancelApprovalForJnlLine := ApprovalsMgmt.CanCancelApprovalForRecord(RECORDID);
    END;

    BEGIN
    {
      ----------------------------------------------
      SI-DATA AS
      ----------------------------------------------
      No  Date      ID      Description
      ----------------------------------------------
      CMP2.00 - page action  - Open Compello document
      FIX.01 :: Norsk remittering, les ut fil.
    }
    END.
  }
}

OBJECT Page 9063 Purchase Agent Activities
{
  OBJECT-PROPERTIES
  {
    Date=01.10.16;
    Time=11:00:00;
    Modified=Yes;
    Version List=NAVW110.00,CMP2.00;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Activities;
               NOR=Aktiviteter];
    SourceTable=Table9055;
    PageType=CardPart;
    RefreshOnActivate=Yes;
    OnOpenPage=BEGIN
                 RESET;
                 IF NOT GET THEN BEGIN
                   INIT;
                   INSERT;
                 END;
                 //CMP2.00 -->
                 IF NOT CompelloRCCue.GET THEN BEGIN
                   CompelloRCCue.INIT;
                   CompelloRCCue.INSERT;
                 END;
                 //CMP2.00 <--
                 SetRespCenterFilter;
                 SETFILTER("Date Filter",'>=%1',WORKDATE);
               END;

    OnAfterGetRecord=BEGIN
                       CalculateCueFieldValues;
                     END;

  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 9   ;1   ;Group     ;
                CaptionML=[ENU=Pre-arrival Follow-up on Purchase Orders;
                           NOR=Forbered mottak for bestillinger];
                GroupType=CueGroup;
                ActionList=ACTIONS
                {
                  { 3       ;0   ;Action    ;
                                  CaptionML=[ENU=New Purchase Quote;
                                             NOR=Ny foresp›rsel];
                                  ToolTipML=[ENU=Create a new purchase quote.;
                                             NOR=Opprett en ny foresp›rsel.];
                                  RunObject=Page 49;
                                  RunPageMode=Create }
                  { 8       ;0   ;Action    ;
                                  CaptionML=[ENU=New Purchase Order;
                                             NOR=Ny bestilling];
                                  ToolTipML=[ENU=Create a new purchase order.;
                                             NOR=Opprett en ny bestilling.];
                                  RunObject=Page 50;
                                  RunPageMode=Create }
                  { 7       ;0   ;Action    ;
                                  CaptionML=[ENU=Edit Purchase Journal;
                                             NOR=Rediger kj›pskladd];
                                  RunObject=Page 254 }
                }
                 }

    { 1   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of documents to send or confirm that are displayed in the Purchase Cue on the Role Center. The documents are filtered by today's date.;
                           NOR=Angir antall dokumenter som skal sendes eller bekreftes, som vises under Kj›psbunke-ikon i Rollesenter. Dokumentene filtreres etter dagens dato.];
                SourceExpr="To Send or Confirm";
                DrillDownPageID=Purchase Order List }

    { 5   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of upcoming orders that are displayed in the Purchase Cue on the Role Center. The documents are filtered by today's date.;
                           NOR=Angir antall kommende bestillinger som vises under Kj›psbunke-ikon i Rollesenter. Dokumentene filtreres etter dagens dato.];
                SourceExpr="Upcoming Orders";
                DrillDownPageID=Purchase Order List }

    { 10  ;1   ;Group     ;
                CaptionML=[ENU=Post Arrival Follow-up;
                           NOR=Oppf›lging etter mottak];
                GroupType=CueGroup;
                ActionList=ACTIONS
                {
                  { 16      ;0   ;Action    ;
                                  CaptionML=[ENU=Navigate;
                                             NOR=Naviger];
                                  ToolTipML=[ENU=View and link to all entries that exist for the document number on the selected line.;
                                             NOR=Vis og koble til alle poster som finnes for dokumentnummeret p† den valgte linjen.];
                                  RunObject=Page 344;
                                  Image=Navigate }
                  { 17      ;0   ;Action    ;
                                  CaptionML=[ENU=New Purchase Return Order;
                                             NOR=Ny bestillingsretur];
                                  ToolTipML=[ENU=Create a new purchase return order.;
                                             NOR=Opprett en ny bestillingsretur.];
                                  RunObject=Page 6640;
                                  RunPageMode=Create }
                }
                 }

    { 12  ;2   ;Field     ;
                Name=OutstandingOrders;
                CaptionML=[ENU=Outstanding Purchase Orders;
                           NOR=pne bestillinger];
                ToolTipML=[ENU=Specifies the number of outstanding purchase orders that are displayed in the Purchase Cue on the Role Center. The documents are filtered by today's date.;
                           NOR=Angir antall utest†ende bestillinger som vises under Kj›psbunke-ikon i Rollesenter. Dokumentene filtreres etter dagens dato.];
                SourceExpr="Outstanding Purchase Orders";
                DrillDownPageID=Purchase Order List;
                OnDrillDown=BEGIN
                              ShowOrders(FIELDNO("Outstanding Purchase Orders"));
                            END;
                             }

    { 14  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of purchase return orders that are displayed in the Purchase Cue on the Role Center. The documents are filtered by today's date.;
                           NOR=Angir antall bestillingsreturer som vises under Kj›psbunke-ikon i Rollesenter. Dokumentene filtreres etter dagens dato.];
                SourceExpr="Purchase Return Orders - All";
                DrillDownPageID=Purchase Return Order List }

    { 18  ;1   ;Group     ;
                CaptionML=[ENU=Purchase Orders - Authorize for Payment;
                           NOR=Bestillinger - godkjenn for betaling];
                GroupType=CueGroup }

    { 19  ;2   ;Field     ;
                Name=NotInvoiced;
                CaptionML=[ENU=Not Invoiced;
                           NOR=Ikke fakturert];
                ToolTipML=[ENU=Specifies the orders that are not invoiced that are displayed in the Purchase Cue on the Role Center. The documents are filtered by today's date.;
                           NOR=Angir ordrene som ikke er fakturert, som vises under Kj›psbunke-ikon i Rollesenter. Dokumentene filtreres etter dagens dato.];
                SourceExpr="Not Invoiced";
                DrillDownPageID=Purchase Order List;
                OnDrillDown=BEGIN
                              ShowOrders(FIELDNO("Not Invoiced"));
                            END;
                             }

    { 21  ;2   ;Field     ;
                Name=PartiallyInvoiced;
                CaptionML=[ENU=Partially Invoiced;
                           NOR=Delvis fakturert];
                ToolTipML=[ENU=Specifies the number of partially invoiced orders that are displayed in the Purchase Cue on the Role Center. The documents are filtered by today's date.;
                           NOR=Angir antall delvis fakturerte ordrer som vises under Kj›psbunke-ikon i Rollesenter. Dokumentene filtreres etter dagens dato.];
                SourceExpr="Partially Invoiced";
                DrillDownPageID=Purchase Order List;
                OnDrillDown=BEGIN
                              ShowOrders(FIELDNO("Partially Invoiced"));
                            END;
                             }

    { 1101103001;1;Group  ;
                Name=Compello;
                CaptionML=[ENU=Compello Import and Export;
                           NOR=Compello Import og Eksport];
                GroupType=CueGroup }

    { 1101103000;2;Field  ;
                Name=Not Synchronized Records;
                CaptionML=[ENU=Not Synchronized Records;
                           NOR=Not Synchronized Records];
                SourceExpr=NotSynchronizedRecords;
                Visible=false;
                Editable=False;
                DrillDownPageID=Compello Change Log List }

    { 1101103002;2;Field  ;
                Name=Imported Documents;
                CaptionML=[ENU=Imported Documents;
                           NOR=Imported Documents];
                SourceExpr=ImportedDocuments;
                Visible=false;
                Editable=False;
                DrillDownPageID=Compello Import Log List }

  }
  CODE
  {
    VAR
      CompelloRCCue@1101103000 : TEMPORARY Record 70010;
      NotSynchronizedRecords@1101103001 : Integer;
      ImportedDocuments@1101103002 : Integer;

    LOCAL PROCEDURE CalculateCueFieldValues@6();
    BEGIN
      IF FIELDACTIVE("Outstanding Purchase Orders") THEN
        "Outstanding Purchase Orders" := CountOrders(FIELDNO("Outstanding Purchase Orders"));

      IF FIELDACTIVE("Not Invoiced") THEN
        "Not Invoiced" := CountOrders(FIELDNO("Not Invoiced"));

      IF FIELDACTIVE("Partially Invoiced") THEN
        "Partially Invoiced" := CountOrders(FIELDNO("Partially Invoiced"));
    END;

    BEGIN
    {
      +---------------------------------------------+
      | SI-Data                                     |
      +---------------------------------------------+
      No. Date     Id  Description
      CMP2.00 Compello activities
    }
    END.
  }
}

OBJECT Page 70000 Compello Integr. Role Center
{
  OBJECT-PROPERTIES
  {
    Date=01.10.16;
    Time=11:00:00;
    Modified=Yes;
    Version List=CMP1.00;
  }
  PROPERTIES
  {
    CaptionML=ENU=Compello Integr. Role Center;
    PageType=RoleCenter;
    ActionList=ACTIONS
    {
      { 4       ;    ;ActionContainer;
                      ActionContainerType=HomeItems }
      { 5       ;1   ;Action    ;
                      CaptionML=ENU=Integration Tables;
                      RunObject=Page 70002 }
      { 6       ;1   ;Action    ;
                      CaptionML=ENU=Integration Change Log;
                      RunObject=Page 70001 }
      { 14      ;1   ;Action    ;
                      CaptionML=ENU=Import Log;
                      RunObject=Page 70013 }
      { 8       ;    ;ActionContainer;
                      ActionContainerType=ActivityButtons }
      { 10      ;1   ;ActionGroup;
                      CaptionML=ENU=History }
      { 9       ;2   ;Action    ;
                      CaptionML=ENU=Integration Change Log Archive;
                      RunObject=Page 70007 }
      { 11      ;2   ;Action    ;
                      CaptionML=ENU=Export Log;
                      RunObject=Page 70008 }
      { 15      ;2   ;Action    ;
                      CaptionML=ENU=Import Log Archive;
                      RunObject=Page 70016 }
      { 16      ;1   ;ActionGroup;
                      CaptionML=ENU=Standard NAV }
      { 17      ;2   ;Action    ;
                      CaptionML=ENU=Purchase Invoice;
                      RunObject=Page 9308 }
      { 18      ;2   ;Action    ;
                      CaptionML=ENU=Chart of Accounts;
                      RunObject=Page 16 }
      { 19      ;2   ;Action    ;
                      CaptionML=ENU=Vendor;
                      RunObject=Page 27 }
    }
  }
  CONTROLS
  {
    { 1   ;0   ;Container ;
                ContainerType=RoleCenterArea }

    { 2   ;1   ;Group     ;
                GroupType=Group }

    { 3   ;2   ;Part      ;
                PagePartID=Page70011;
                PartType=Page }

    { 12  ;1   ;Group     ;
                GroupType=Group }

    { 13  ;2   ;Part      ;
                CaptionML=ENU=My Notes;
                PartType=System;
                SystemPartID=MyNotes }

  }
  CODE
  {

    BEGIN
    {
      CMP001 1.00 2014-07-23 Integration with Compello Document Management
                               Object created
    }
    END.
  }
}

OBJECT Page 70001 Compello Change Log List
{
  OBJECT-PROPERTIES
  {
    Date=01.10.16;
    Time=11:00:00;
    Modified=Yes;
    Version List=CMP2.00;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=ENU=Compello Change Log List;
    SourceTable=Table70001;
    PageType=List;
    ActionList=ACTIONS
    {
      { 17      ;    ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 18      ;1   ;Action    ;
                      CaptionML=[ENU=Send to Compello;
                                 NOR=Send til Compello];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Export;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 IF "Table ID" <> 0 THEN BEGIN
                                   CASE STRMENU(Text001) OF
                                     1 : BEGIN
                                       IF CompelloExpMgt.SyncOneRec(Rec) THEN BEGIN
                                         MESSAGE(Text002);
                                       END ELSE BEGIN
                                         COMMIT;
                                         ERROR(Text003);
                                       END;
                                     END;
                                     2 : BEGIN
                                       IF CompelloExpMgt.SyncMultipleRecords(Rec, FALSE) THEN BEGIN
                                         MESSAGE(Text004);
                                       END ELSE BEGIN
                                         COMMIT;
                                         ERROR(Text003);
                                       END;
                                     END;
                                   END;
                                 END;
                               END;
                                }
      { 19      ;1   ;Action    ;
                      CaptionML=[ENU=Delete Records;
                                 NOR=Slett Rekord];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Delete;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 PAGE.RUNMODAL(70020, Rec);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1   ;0   ;Container ;
                ContainerType=ContentArea }

    { 2   ;1   ;Group     ;
                Name=Group;
                GroupType=Repeater }

    { 3   ;2   ;Field     ;
                SourceExpr=GUID }

    { 4   ;2   ;Field     ;
                SourceExpr="Table ID" }

    { 5   ;2   ;Field     ;
                Name=RecordID;
                CaptionML=[ENU=RecordID;
                           NOR=RecordID];
                SourceExpr=FORMAT("Record ID") }

    { 6   ;2   ;Field     ;
                SourceExpr="User Action" }

    { 7   ;2   ;Field     ;
                SourceExpr=Date }

    { 8   ;2   ;Field     ;
                SourceExpr=DataType }

    { 9   ;2   ;Field     ;
                SourceExpr=Value }

    { 10  ;2   ;Field     ;
                SourceExpr=Description }

    { 11  ;2   ;Field     ;
                SourceExpr="Description 2" }

    { 12  ;2   ;Field     ;
                SourceExpr="Description 3" }

    { 13  ;2   ;Field     ;
                SourceExpr=Inactive }

    { 14  ;2   ;Field     ;
                SourceExpr=Status }

    { 15  ;2   ;Field     ;
                SourceExpr="Error Message" }

    { 16  ;2   ;Field     ;
                SourceExpr="No. of Tries" }

    { 1000000000;2;Field  ;
                SourceExpr="Filter Field 1" }

    { 1000000001;2;Field  ;
                SourceExpr="Filter Field 2" }

    { 1000000002;2;Field  ;
                SourceExpr="Filter Field 3" }

  }
  CODE
  {
    VAR
      CompelloExpMgt@1000 : Codeunit 70001;
      Text001@1001 : TextConst 'ENU=Send one record to Compello,Send all records to Compello';
      Text002@1002 : TextConst 'ENU=Record synchronized';
      Text003@1003 : TextConst 'ENU=Synchronization was unsuccessful';
      Text004@1004 : TextConst 'ENU=Records synchronized';

    BEGIN
    {
      +---------------------------------------------+
      | SI-Data                                     |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 24.04.15 JAL Added format on the "Record ID" field
    }
    END.
  }
}

OBJECT Page 70002 Compello Integr. Table List
{
  OBJECT-PROPERTIES
  {
    Date=02.01.17;
    Time=20:45:19;
    Modified=Yes;
    Version List=CMP1.00;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=ENU=Compello Integr. Table List;
    SourceTable=Table70003;
    PageType=List;
    CardPageID=Compello Integr. Table Card;
    ActionList=ACTIONS
    {
      { 12      ;    ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 13      ;1   ;Action    ;
                      CaptionML=[ENU=Import/Export Integration Tables;
                                 NOR=Import/Eksport Integrasjon Tabeller];
                      RunObject=XMLport 70001;
                      Image=Import }
      { 1101103000;1 ;Action    ;
                      Name=Update Dimension References;
                      CaptionML=[ENU=Update Dimension References;
                                 NOR=Oppdater Dimensjon Referanser];
                      Image=UpdateXML;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 CompelloMgt@1101103000 : Codeunit 70005;
                               BEGIN
                                 CompelloMgt.UpdateDimensionsForSetupTables;
                               END;
                                }
      { 1101103001;1 ;Action    ;
                      CaptionML=ENU=Export Existing Records;
                      Image=Export;
                      OnAction=VAR
                                 ExportTable@1000 : Report 70000;
                               BEGIN
                                 TESTFIELD("Table ID");
                                 ExportTable.SetTable("Table ID");
                                 ExportTable.RUN;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1   ;0   ;Container ;
                ContainerType=ContentArea }

    { 2   ;1   ;Group     ;
                Name=Group;
                GroupType=Repeater }

    { 3   ;2   ;Field     ;
                SourceExpr=Code }

    { 4   ;2   ;Field     ;
                SourceExpr="Table ID" }

    { 11  ;2   ;Field     ;
                SourceExpr="Table Name" }

    { 5   ;2   ;Field     ;
                SourceExpr=Synchronize }

    { 6   ;2   ;Field     ;
                SourceExpr="Map To Table" }

    { 7   ;2   ;Field     ;
                SourceExpr="Action IO" }

    { 8   ;2   ;Field     ;
                SourceExpr="No. Series" }

    { 9   ;2   ;Field     ;
                SourceExpr="Data Type" }

    { 10  ;2   ;Field     ;
                SourceExpr="Data Type Name" }

  }
  CODE
  {

    BEGIN
    {
      +---------------------------------------------+
      | SI-Data                                     |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 24.04.15 JAL Added Page Action "Update Dimension References"
    }
    END.
  }
}

OBJECT Page 70003 Compello Integr. Table Card
{
  OBJECT-PROPERTIES
  {
    Date=01.10.16;
    Time=11:00:00;
    Modified=Yes;
    Version List=CMP2.00;
  }
  PROPERTIES
  {
    CaptionML=ENU=Compello Integr. Table Card;
    SourceTable=Table70003;
    PageType=Card;
    OnAfterGetRecord=BEGIN
                       SetRealtionSetupPossible;
                     END;

    ActionList=ACTIONS
    {
      { 12      ;    ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 13      ;1   ;Action    ;
                      CaptionML=ENU=User Notification;
                      RunObject=Page 70009;
                      RunPageLink=Entry No.=FIELD(Code);
                      Image=UserSetup }
      { 17      ;1   ;Action    ;
                      CaptionML=ENU=Relation to Header;
                      RunObject=Page 70019;
                      RunPageLink=Table Code=FIELD(Code);
                      Enabled=RealtionSetupPossible;
                      Image=SetupLines }
      { 22      ;1   ;Action    ;
                      CaptionML=ENU=Export Existing Records;
                      Image=Export;
                      OnAction=VAR
                                 ExportTable@1000 : Report 70000;
                               BEGIN
                                 TESTFIELD("Table ID");
                                 ExportTable.SetTable("Table ID");
                                 ExportTable.RUN;
                               END;
                                }
      { 1101103001;1 ;Action    ;
                      Name=Update Dimension references;
                      CaptionML=[ENU=Update Dimension references;
                                 NOR=Oppdater Dimensjon referanser];
                      Image=UpdateXML;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 CompelloMgt@1101103000 : Codeunit 70005;
                               BEGIN
                                 CompelloMgt.UpdateDimensions(Rec);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1   ;0   ;Container ;
                ContainerType=ContentArea }

    { 2   ;1   ;Group     ;
                Name=General;
                GroupType=Group }

    { 3   ;2   ;Field     ;
                SourceExpr=Code }

    { 4   ;2   ;Field     ;
                SourceExpr="Table ID";
                OnValidate=BEGIN
                             CurrPage.UPDATE(TRUE);
                           END;
                            }

    { 14  ;2   ;Field     ;
                SourceExpr="Table Name" }

    { 5   ;2   ;Field     ;
                SourceExpr=Synchronize }

    { 6   ;2   ;Field     ;
                SourceExpr="Map To Table";
                OnValidate=BEGIN
                             CurrPage.UPDATE(TRUE);
                             SetRealtionSetupPossible;
                           END;
                            }

    { 7   ;2   ;Field     ;
                SourceExpr="Action IO" }

    { 10  ;2   ;Field     ;
                SourceExpr="Data Type Name" }

    { 15  ;2   ;Field     ;
                SourceExpr="Related to Header" }

    { 21  ;2   ;Field     ;
                SourceExpr="Dimension Code" }

    { 1101103000;2;Field  ;
                SourceExpr="Dimension No." }

    { 20  ;2   ;Field     ;
                SourceExpr="Credit Document" }

    { 11  ;1   ;Part      ;
                CaptionML=ENU=Fields;
                SubPageLink=Table Code=FIELD(Code);
                PagePartID=Page70004;
                PartType=Page }

    { 1000000000;1;Group  ;
                CaptionML=ENU=Filters;
                GroupType=Group }

    { 1000000001;2;Field  ;
                SourceExpr="Filter Field 1";
                OnLookup=BEGIN
                           EXIT(TableFieldLookUp(Text));
                         END;
                          }

    { 1000000002;2;Field  ;
                SourceExpr="Filter Value 1" }

    { 1000000003;2;Field  ;
                SourceExpr="Filter Field 2";
                OnLookup=BEGIN
                           EXIT(TableFieldLookUp(Text));
                         END;
                          }

    { 1000000004;2;Field  ;
                SourceExpr="Filter Value 2" }

    { 1000000005;2;Field  ;
                SourceExpr="Filter Field 3";
                OnLookup=BEGIN
                           EXIT(TableFieldLookUp(Text));
                         END;
                          }

    { 1000000006;2;Field  ;
                SourceExpr="Filter Value 3" }

    { 18  ;0   ;Container ;
                ContainerType=FactBoxArea }

    { 19  ;1   ;Part      ;
                SubPageLink=Table Code=FIELD(Code);
                PagePartID=Page70019;
                Visible=FALSE;
                PartType=Page }

  }
  CODE
  {
    VAR
      RealtionSetupPossible@1000 : Boolean INDATASET;

    PROCEDURE SetRealtionSetupPossible@2();
    BEGIN
      RealtionSetupPossible := "Header Table ID" <> 0;
    END;

    BEGIN
    {
      +---------------------------------------------+
      | SI-Data                                     |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 24.04.15 JAL Added Page Action "Update Dimension References".
                       Added "Dimension No." field.
    }
    END.
  }
}

OBJECT Page 70004 Compello Integr. Table Subpage
{
  OBJECT-PROPERTIES
  {
    Date=01.10.16;
    Time=11:00:00;
    Modified=Yes;
    Version List=CMP2.00;
  }
  PROPERTIES
  {
    CaptionML=ENU=Compello Integr. Table Subpage;
    SourceTable=Table70004;
    DelayedInsert=Yes;
    PageType=ListPart;
    AutoSplitKey=Yes;
  }
  CONTROLS
  {
    { 1   ;0   ;Container ;
                ContainerType=ContentArea }

    { 2   ;1   ;Group     ;
                Name=Group;
                GroupType=Repeater }

    { 3   ;2   ;Field     ;
                SourceExpr="Table ID";
                Visible=FALSE }

    { 5   ;2   ;Field     ;
                SourceExpr="Map-to Field" }

    { 9   ;2   ;Field     ;
                SourceExpr="Map-to Field Name" }

    { 4   ;2   ;Field     ;
                SourceExpr="Field ID";
                OnLookup=BEGIN
                           EXIT(TableFieldLookUp(Text));
                         END;
                          }

    { 10  ;2   ;Field     ;
                SourceExpr="Field Name" }

    { 12  ;2   ;Field     ;
                SourceExpr="Dimension Code" }

    { 1101103000;2;Field  ;
                SourceExpr="Dimension No." }

    { 6   ;2   ;Field     ;
                SourceExpr="Map-to Field No." }

    { 7   ;2   ;Field     ;
                SourceExpr="Sequence No." }

    { 8   ;2   ;Field     ;
                SourceExpr=Validate }

    { 11  ;2   ;Field     ;
                SourceExpr="Use Default Value" }

    { 13  ;2   ;Field     ;
                SourceExpr="Only If Not Blank" }

  }
  CODE
  {

    BEGIN
    {
      +---------------------------------------------+
      | SI-Data                                     |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 24.04.15 JAL Added "Dimension No." field.
    }
    END.
  }
}

OBJECT Page 70005 Compello Map-to Fields
{
  OBJECT-PROPERTIES
  {
    Date=01.10.16;
    Time=11:00:00;
    Modified=Yes;
    Version List=CMP2.00;
  }
  PROPERTIES
  {
    CaptionML=ENU=Compello Map-to Fields;
    SourceTable=Table70005;
    PageType=List;
    ActionList=ACTIONS
    {
      { 7       ;    ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 8       ;1   ;Action    ;
                      CaptionML=[ENU=Import/Export Map-to Fields;
                                 NOR=Import/Eksporet Map-til Felter];
                      RunObject=XMLport 70000;
                      Image=Import }
    }
  }
  CONTROLS
  {
    { 1   ;0   ;Container ;
                ContainerType=ContentArea }

    { 2   ;1   ;Group     ;
                Name=Group;
                GroupType=Repeater }

    { 3   ;2   ;Field     ;
                SourceExpr=Code }

    { 4   ;2   ;Field     ;
                SourceExpr=Name }

    { 5   ;2   ;Field     ;
                SourceExpr="Data Type" }

    { 6   ;2   ;Field     ;
                SourceExpr="Field No." }

    { 9   ;2   ;Field     ;
                SourceExpr="Table Type" }

  }
  CODE
  {

    BEGIN
    {
      +---------------------------------------------+
      | SI-Data                                     |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 24.04.15 JAL Changed Caption for Page Action Caption to "Import/Export Map-to Fields"
    }
    END.
  }
}

OBJECT Page 70006 Field List For Integration
{
  OBJECT-PROPERTIES
  {
    Date=01.10.16;
    Time=11:00:00;
    Modified=Yes;
    Version List=CMP1.00;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=ENU=Field List For Integration;
    SourceTable=Table2000000041;
    SourceTableView=WHERE(Class=CONST(Normal),
                          Enabled=CONST(Yes));
    PageType=List;
  }
  CONTROLS
  {
    { 1   ;0   ;Container ;
                ContainerType=ContentArea }

    { 2   ;1   ;Group     ;
                Name=Group;
                GroupType=Repeater }

    { 3   ;2   ;Field     ;
                SourceExpr="No." }

    { 4   ;2   ;Field     ;
                SourceExpr=FieldName }

    { 5   ;2   ;Field     ;
                SourceExpr=Type }

    { 6   ;2   ;Field     ;
                SourceExpr=Len }

    { 7   ;2   ;Field     ;
                SourceExpr=Class }

    { 8   ;2   ;Field     ;
                SourceExpr="Field Caption" }

    { 9   ;2   ;Field     ;
                SourceExpr=OptionString }

  }
  CODE
  {

    BEGIN
    {
      CMP001 1.00 2014-07-23 Integration with Compello Document Management
                               Object created
    }
    END.
  }
}

OBJECT Page 70007 Compello Change Log Arch. List
{
  OBJECT-PROPERTIES
  {
    Date=01.10.16;
    Time=11:00:00;
    Modified=Yes;
    Version List=CMP1.01;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=ENU=Compello Change Log Arch. List;
    SourceTable=Table70002;
    SourceTableView=SORTING(Date);
    PageType=List;
    ActionList=ACTIONS
    {
      { 1101103000;  ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1101103001;1 ;Action    ;
                      Name=Clean Log;
                      CaptionML=[ENU=Clean Log;
                                 NOR=Fjern gamle poster fra Logg];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Delete;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 CompelloExportMgt@1101103000 : Codeunit 70001;
                               BEGIN
                                 CompelloExportMgt.CleanExportLog;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1   ;0   ;Container ;
                ContainerType=ContentArea }

    { 2   ;1   ;Group     ;
                Name=Group;
                GroupType=Repeater }

    { 3   ;2   ;Field     ;
                SourceExpr=GUID }

    { 4   ;2   ;Field     ;
                SourceExpr="Table ID" }

    { 5   ;2   ;Field     ;
                SourceExpr=FORMAT("Record ID") }

    { 6   ;2   ;Field     ;
                SourceExpr="User Action" }

    { 7   ;2   ;Field     ;
                SourceExpr=Date }

    { 8   ;2   ;Field     ;
                SourceExpr=DataType }

    { 9   ;2   ;Field     ;
                SourceExpr=Value }

    { 10  ;2   ;Field     ;
                SourceExpr=Description }

    { 11  ;2   ;Field     ;
                SourceExpr="Description 2" }

    { 12  ;2   ;Field     ;
                SourceExpr="Description 3" }

    { 13  ;2   ;Field     ;
                SourceExpr=Inactive }

    { 14  ;2   ;Field     ;
                SourceExpr=Status }

    { 15  ;2   ;Field     ;
                SourceExpr="Error Message" }

    { 16  ;2   ;Field     ;
                SourceExpr="No. of Tries" }

    { 17  ;2   ;Field     ;
                SourceExpr="Transaction No." }

    { 18  ;2   ;Field     ;
                SourceExpr="Transaction DateTime" }

    { 1000000001;2;Field  ;
                SourceExpr="Filter Field 1" }

    { 1000000002;2;Field  ;
                SourceExpr="Filter Field 2" }

    { 1000000000;2;Field  ;
                SourceExpr="Filter Field 3" }

  }
  CODE
  {

    BEGIN
    {
      CMP001 1.00 2014-07-23 Integration with Compello Document Management
                               Object created
      CMP001 1.01 2014-09-16 Integration with Compello Document Management
                               New Fields
                                 Filter Field 1
                                 Filter Field 2
                                 Filter Field 3
    }
    END.
  }
}

OBJECT Page 70008 Compello Export Log
{
  OBJECT-PROPERTIES
  {
    Date=01.10.16;
    Time=11:00:00;
    Modified=Yes;
    Version List=CMP1.00;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=ENU=Compello Export Log;
    SourceTable=Table70006;
    SourceTableView=SORTING(Export date);
    PageType=List;
  }
  CONTROLS
  {
    { 1   ;0   ;Container ;
                ContainerType=ContentArea }

    { 2   ;1   ;Group     ;
                Name=Group;
                GroupType=Repeater }

    { 3   ;2   ;Field     ;
                SourceExpr=GUID }

    { 4   ;2   ;Field     ;
                SourceExpr="Export date" }

    { 5   ;2   ;Field     ;
                SourceExpr=Result }

  }
  CODE
  {

    BEGIN
    {
      CMP001 1.00 2014-07-23 Integration with Compello Document Management
                               Object created
    }
    END.
  }
}

OBJECT Page 70009 Compello User Notification
{
  OBJECT-PROPERTIES
  {
    Date=01.10.16;
    Time=11:00:00;
    Modified=Yes;
    Version List=CMP1.00;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Compello User Notification;
               NOR=Compello Brukervarsler];
    LinksAllowed=No;
    SourceTable=Table70007;
    DelayedInsert=Yes;
    PageType=List;
  }
  CONTROLS
  {
    { 1   ;0   ;Container ;
                ContainerType=ContentArea }

    { 2   ;1   ;Group     ;
                Name=Group;
                GroupType=Repeater }

    { 3   ;2   ;Field     ;
                SourceExpr="Entry No.";
                Visible=FALSE }

    { 1101103001;2;Field  ;
                SourceExpr="Table Code" }

    { 5   ;2   ;Field     ;
                SourceExpr="User ID" }

  }
  CODE
  {

    BEGIN
    {
      CMP001 1.00 2014-07-23 Integration with Compello Document Management
                               Object created
    }
    END.
  }
}

OBJECT Page 70010 Integration To Compello Setup
{
  OBJECT-PROPERTIES
  {
    Date=01.10.16;
    Time=11:00:00;
    Modified=Yes;
    Version List=CMP2.00;
  }
  PROPERTIES
  {
    CaptionML=ENU=Integration To Compello Setup;
    SourceTable=Table70000;
    PageType=Card;
    OnOpenPage=BEGIN
                 CreateCue;
               END;

    ActionList=ACTIONS
    {
      { 1101103019;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1101103020;1 ;ActionGroup;
                      CaptionML=[ENU=Upgrade process;
                                 NOR=Oppgraderings prosess] }
      { 1101103017;2 ;Action    ;
                      Name=CopyReferencesGenLedgerEntry;
                      CaptionML=[ENU=Copy References from Gen. Ledger Entry;
                                 NOR=Copy References from Gen. Ledger Entry];
                      Promoted=No;
                      Visible=false;
                      PromotedIsBig=Yes;
                      Image=UpdateXML;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 CompelloMoveLink@1101103000 : Codeunit 70007;
                               BEGIN
                                 CompelloMoveLink.CopyFromGenLedgerEntry;
                               END;
                                }
      { 1101103018;2 ;Action    ;
                      Name=CopyReferencesVendorLedgerEntry;
                      CaptionML=[ENU=Copy References from Vendor Ledger Entry;
                                 NOR=Copy References from Vendor Ledger Entry];
                      Promoted=No;
                      PromotedIsBig=Yes;
                      Image=UpdateXML;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 CompelloMoveLink@1101103000 : Codeunit 70007;
                               BEGIN
                                 CompelloMoveLink.CopyFromVendorLedgerEntry;
                               END;
                                }
      { 1101103021;2 ;Action    ;
                      Name=CopyReferencesPurchaseHeader;
                      CaptionML=[ENU=Copy References from Purchase Header;
                                 NOR=Copy References from Purchase Header];
                      Promoted=No;
                      Visible=false;
                      PromotedIsBig=Yes;
                      Image=UpdateXML;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 CompelloMoveLink@1101103000 : Codeunit 70007;
                               BEGIN
                                 CompelloMoveLink.CopyFromPurchaseHeader;
                               END;
                                }
      { 1101103022;2 ;Action    ;
                      Name=CopyReferencesPurchaseInvHeader;
                      CaptionML=[ENU=Copy References from Purchase Inv. Header;
                                 NOR=Copy References from Purchase Inv. Header];
                      Promoted=No;
                      Visible=false;
                      PromotedIsBig=Yes;
                      Image=UpdateXML;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 CompelloMoveLink@1101103000 : Codeunit 70007;
                               BEGIN
                                 CompelloMoveLink.CopyFromPurchaseInvHeader;
                               END;
                                }
      { 1101103023;2 ;Action    ;
                      Name=CopyReferencesPurchaseCrMemoHeader;
                      CaptionML=[ENU=Copy References from Purchase Cr. Memo Header;
                                 NOR=Copy References from Purchase Cr. Memo Header];
                      Promoted=No;
                      Visible=false;
                      PromotedIsBig=Yes;
                      Image=UpdateXML;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 CompelloMoveLink@1101103000 : Codeunit 70007;
                               BEGIN
                                 CompelloMoveLink.CopyFromPurchaseCrMemoHeader;
                               END;
                                }
      { 1101103025;2 ;Action    ;
                      Name=RemoveDuplicates;
                      CaptionML=[ENU=Remove duplicates from Import Arch. Log;
                                 NOR=Fjern duplikater fra Import Arch. Log];
                      Promoted=No;
                      PromotedIsBig=Yes;
                      Image=UpdateXML;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 CompelloMoveLink@1101103000 : Codeunit 70007;
                               BEGIN
                                 CompelloMoveLink.RemoveDuplicates;
                               END;
                                }
      { 1101103028;2 ;Action    ;
                      Name=RunNASCodeUnit;
                      CaptionML=[ENU=Run NAS CodeUnit;
                                 NOR=Kj›r NAS CodeUnit];
                      Image=ExecuteBatch;
                      OnAction=VAR
                                 NASHandler@1101103000 : Codeunit 70004;
                                 Selected@1101103001 : Integer;
                                 MenuTxt@1101103002 : TextConst 'ENU=Import,Export,Clean Log;NOR=Import,Eksport,Slett logg';
                                 InstructionTxt@1101103003 : TextConst 'ENU=Choose job to run;NOR=Velg kj›ring';
                                 JobQueueEntry@1101103004 : Record 472;
                               BEGIN
                                 Selected := STRMENU(MenuTxt, 1, InstructionTxt);
                                 JobQueueEntry.INIT;

                                 IF Selected = 1 THEN
                                   JobQueueEntry."Parameter String" := 'Import'
                                 ELSE IF Selected = 2 THEN
                                   JobQueueEntry."Parameter String" := 'Export'
                                 ELSE IF Selected = 3 THEN
                                   JobQueueEntry."Parameter String" := 'Clean Log';

                                 IF Selected IN [1,2,3] THEN
                                   NASHandler.RUN(JobQueueEntry);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1   ;0   ;Container ;
                ContainerType=ContentArea }

    { 2   ;1   ;Group     ;
                Name=General;
                CaptionML=ENU=General;
                GroupType=Group }

    { 3   ;2   ;Field     ;
                SourceExpr="Max. No. of Tries" }

    { 4   ;2   ;Field     ;
                SourceExpr="Max No. of Rec. per Transact." }

    { 6   ;2   ;Field     ;
                SourceExpr="Integr. Table Nos." }

    { 11  ;2   ;Field     ;
                SourceExpr="Client ID" }

    { 13  ;2   ;Field     ;
                SourceExpr="URL for Export Log" }

    { 12  ;1   ;Group     ;
                Name=Web Service;
                CaptionML=ENU=Web Service;
                GroupType=Group }

    { 7   ;2   ;Field     ;
                SourceExpr="Web Service Address" }

    { 8   ;2   ;Field     ;
                SourceExpr="Customer ID" }

    { 9   ;2   ;Field     ;
                SourceExpr="User Name" }

    { 10  ;2   ;Field     ;
                SourceExpr=Password }

    { 1101103005;1;Group  ;
                Name=NAV Setup;
                CaptionML=[ENU=NAV Setup;
                           NOR=NAV Setup];
                GroupType=Group }

    { 1101103006;2;Field  ;
                SourceExpr="Doc. Type Item Invoice" }

    { 1101103007;2;Field  ;
                SourceExpr="Doc. Type Item Credit" }

    { 1101103008;2;Field  ;
                SourceExpr="Doc. Type Journal Invoice" }

    { 1101103009;2;Field  ;
                SourceExpr="Doc. Type Journal Credit" }

    { 1101103011;2;Field  ;
                SourceExpr="Journal Template" }

    { 1101103012;2;Field  ;
                SourceExpr="Journal Batch" }

    { 1101103024;2;Field  ;
                SourceExpr="Rounding account" }

    { 1101103014;2;Field  ;
                SourceExpr="Default Free VAT Code" }

    { 1101103027;2;Field  ;
                SourceExpr="Admin Role ID" }

    { 1101103026;2;Field  ;
                SourceExpr="Keep Export Log" }

    { 1101103000;1;Group  ;
                Name=Purchase Order XML File;
                CaptionML=[ENU=Purchase Order XML File;
                           NOR="Innkj›psordre XML fil "];
                GroupType=Group }

    { 1101103001;2;Field  ;
                SourceExpr="XLS File Path" }

    { 1101103002;2;Field  ;
                SourceExpr="Image File Stylesheet" }

    { 1101103015;2;Field  ;
                SourceExpr="XML Folder" }

    { 1101103003;2;Field  ;
                SourceExpr="XML Folder Archive" }

    { 1101103004;2;Field  ;
                SourceExpr="Doc. Type Purchase Order" }

    { 1101103016;2;Field  ;
                SourceExpr="Scan. Doc. Type Purchase Order" }

    { 1101103010;2;Field  ;
                SourceExpr="Default PO Account" }

    { 1101103013;2;Field  ;
                SourceExpr="Authentication Code" }

  }
  CODE
  {

    BEGIN
    {
      +---------------------------------------------+
      | SI-Data                                     |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 24.04.15 JAL Added fields to page.
                       Added 5 "Copy References..." Page Actions.
    }
    END.
  }
}

OBJECT Page 70011 Compello Import Activities
{
  OBJECT-PROPERTIES
  {
    Date=01.10.16;
    Time=11:00:00;
    Modified=Yes;
    Version List=CMP1.00;
  }
  PROPERTIES
  {
    CaptionML=ENU=Compello Import Activities;
    SourceTable=Table70010;
    PageType=CardPart;
    OnOpenPage=BEGIN
                 SETRANGE("Date Filter Today", TODAY);
               END;

  }
  CONTROLS
  {
    { 1   ;0   ;Container ;
                ContainerType=ContentArea }

    { 3   ;1   ;Group     ;
                CaptionML=ENU=Import;
                GroupType=CueGroup }

    { 2   ;2   ;Field     ;
                SourceExpr="Not Synchronized Records";
                DrillDownPageID=Compello Change Log List }

  }
  CODE
  {

    BEGIN
    {
      CMP001 1.00 2014-07-23 Integration with Compello Document Management
                               Object created
    }
    END.
  }
}

OBJECT Page 70012 Compello Export Activities
{
  OBJECT-PROPERTIES
  {
    Date=01.10.16;
    Time=11:00:00;
    Modified=Yes;
    Version List=CMP1.00;
  }
  PROPERTIES
  {
    CaptionML=ENU=Compello Export Activities;
    SourceTable=Table70010;
    PageType=CardPart;
  }
  CONTROLS
  {
    { 1   ;0   ;Container ;
                ContainerType=ContentArea }

    { 3   ;1   ;Group     ;
                CaptionML=ENU=Export;
                GroupType=CueGroup }

    { 2   ;2   ;Field     ;
                SourceExpr="Imported Documents" }

  }
  CODE
  {

    BEGIN
    {
      CMP001 1.00 2014-07-23 Integration with Compello Document Management
                               Object created
    }
    END.
  }
}

OBJECT Page 70013 Compello Import Log List
{
  OBJECT-PROPERTIES
  {
    Date=01.10.16;
    Time=11:00:00;
    Modified=Yes;
    Version List=CMP2.00;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=ENU=Compello Import Log List;
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=No;
    LinksAllowed=No;
    SourceTable=Table70008;
    SourceTableView=SORTING(Import Date);
    PageType=List;
    CardPageID=Compello Integration Log Card;
    ActionList=ACTIONS
    {
      { 22      ;    ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 23      ;1   ;Action    ;
                      Name=Import From Compello;
                      CaptionML=[ENU=Import From Compello;
                                 NOR=Les inn fra Compello];
                      Promoted=Yes;
                      Image=Import;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ImportMgt@1000 : Codeunit 70002;
                               BEGIN
                                 IF CONFIRM(Text001, TRUE) THEN BEGIN
                                   ImportMgt.LoadDocuments;
                                 //  MESSAGE(Text002);
                                 END;
                               END;
                                }
      { 24      ;1   ;Action    ;
                      Name=Reactivate in Compello;
                      CaptionML=[ENU=Reactivate in Compello;
                                 NOR=Send dokument i retur til Compello];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Delete;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ImportMgt@1000 : Codeunit 70002;
                               BEGIN
                                 IF ImportMgt.DeleteImportedRecord(Rec) THEN BEGIN
                                   CurrPage.UPDATE(FALSE);
                                 END;
                               END;
                                }
      { 1101103002;1 ;Action    ;
                      Name=Create Document;
                      CaptionML=[ENU=Create Document;
                                 NOR=Opprett dokument];
                      Promoted=Yes;
                      Image=CreateDocument;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 Text002@1101103001 : TextConst 'ENU=Do you want to create Purchase Invoice document?;NOR=Vil du opprette Innkj›psfaktura?';
                                 Text003@1101103000 : TextConst 'ENU=Document created;NOR=Dokument opprettet';
                                 CreateDoc@1101103002 : Codeunit 70003;
                               BEGIN
                                 CreateDoc.CreatePurchDoc(Rec);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1   ;0   ;Container ;
                ContainerType=ContentArea }

    { 2   ;1   ;Group     ;
                Name=Group;
                GroupType=Repeater }

    { 3   ;2   ;Field     ;
                SourceExpr=GUID;
                Visible=FALSE }

    { 25  ;2   ;Field     ;
                SourceExpr="Import Date" }

    { 4   ;2   ;Field     ;
                SourceExpr="Client ID";
                Visible=FALSE }

    { 5   ;2   ;Field     ;
                SourceExpr="Archive Ref" }

    { 6   ;2   ;Field     ;
                SourceExpr="Scanned Date" }

    { 7   ;2   ;Field     ;
                SourceExpr="Voucher Type" }

    { 8   ;2   ;Field     ;
                SourceExpr="Invoice No." }

    { 9   ;2   ;Field     ;
                SourceExpr="Order Ref";
                Visible=FALSE }

    { 10  ;2   ;Field     ;
                SourceExpr="Voucher Date" }

    { 11  ;2   ;Field     ;
                SourceExpr="Due Date" }

    { 12  ;2   ;Field     ;
                SourceExpr=KID }

    { 1101103000;2;Field  ;
                SourceExpr=Status }

    { 1101103001;2;Field  ;
                SourceExpr="Status Text" }

    { 13  ;2   ;Field     ;
                SourceExpr="Transaction No.";
                Visible=FALSE }

    { 14  ;2   ;Field     ;
                SourceExpr="User Defined 1" }

    { 15  ;2   ;Field     ;
                SourceExpr="User Defined 2" }

    { 16  ;2   ;Field     ;
                SourceExpr="User Defined 3";
                Visible=FALSE }

    { 17  ;2   ;Field     ;
                SourceExpr="User Defined 4";
                Visible=FALSE }

    { 18  ;2   ;Field     ;
                SourceExpr="User Defined 5";
                Visible=FALSE }

    { 19  ;2   ;Field     ;
                SourceExpr="User Defined 6";
                Visible=FALSE }

    { 20  ;2   ;Field     ;
                SourceExpr="User Defined 7";
                Visible=FALSE }

    { 21  ;2   ;Field     ;
                SourceExpr="Image GUID";
                Visible=FALSE }

  }
  CODE
  {
    VAR
      Text001@1000 : TextConst 'ENU=Do you want to import documents from Compello?';
      Text002@1001 : TextConst 'ENU=Import done';

    BEGIN
    {
      +---------------------------------------------+
      | SI-Data                                     |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 24.04.15 JAL
    }
    END.
  }
}

OBJECT Page 70014 Compello Integration Log Card
{
  OBJECT-PROPERTIES
  {
    Date=01.10.16;
    Time=11:00:00;
    Modified=Yes;
    Version List=CMP2.00;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=ENU=Compello Integration Log Card;
    DeleteAllowed=No;
    LinksAllowed=No;
    SourceTable=Table70008;
    PageType=Card;
    ActionList=ACTIONS
    {
      { 23      ;    ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 24      ;1   ;Action    ;
                      CaptionML=[ENU=Create Document;
                                 NOR=Opprett dokument];
                      Promoted=Yes;
                      Image=CreateDocument;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 Text002@1101103001 : TextConst 'ENU=Do you want to create Purchase Invoice document?';
                                 Text003@1101103000 : TextConst 'ENU=Document created';
                               BEGIN
                                 CreateDoc.CreatePurchDoc(Rec);
                               END;
                                }
      { 25      ;1   ;Action    ;
                      CaptionML=[ENU=Delete Record From Log;
                                 NOR=Slett linje fra logg];
                      Image=Delete;
                      OnAction=BEGIN
                                 IF ImportMgt.DeleteImportedRecord(Rec) THEN BEGIN
                                   CurrPage.UPDATE(FALSE);
                                 END;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1   ;0   ;Container ;
                ContainerType=ContentArea }

    { 2   ;1   ;Group     ;
                Name=General;
                GroupType=Group }

    { 3   ;2   ;Field     ;
                SourceExpr=GUID }

    { 4   ;2   ;Field     ;
                SourceExpr="Client ID" }

    { 5   ;2   ;Field     ;
                SourceExpr="Archive Ref" }

    { 6   ;2   ;Field     ;
                SourceExpr="Scanned Date" }

    { 7   ;2   ;Field     ;
                SourceExpr="Voucher Type" }

    { 8   ;2   ;Field     ;
                SourceExpr="Invoice No." }

    { 9   ;2   ;Field     ;
                SourceExpr="Order Ref" }

    { 10  ;2   ;Field     ;
                SourceExpr="Voucher Date" }

    { 11  ;2   ;Field     ;
                SourceExpr="Due Date" }

    { 12  ;2   ;Field     ;
                SourceExpr=KID }

    { 13  ;2   ;Field     ;
                SourceExpr="Transaction No." }

    { 14  ;2   ;Field     ;
                SourceExpr="User Defined 1" }

    { 15  ;2   ;Field     ;
                SourceExpr="User Defined 2" }

    { 16  ;2   ;Field     ;
                SourceExpr="User Defined 3" }

    { 17  ;2   ;Field     ;
                SourceExpr="User Defined 4" }

    { 18  ;2   ;Field     ;
                SourceExpr="User Defined 5" }

    { 19  ;2   ;Field     ;
                SourceExpr="User Defined 6" }

    { 20  ;2   ;Field     ;
                SourceExpr="User Defined 7" }

    { 21  ;2   ;Field     ;
                SourceExpr="Image GUID" }

    { 26  ;2   ;Field     ;
                SourceExpr=Status }

    { 1101103000;2;Field  ;
                SourceExpr="Status Text" }

    { 27  ;2   ;Field     ;
                SourceExpr="Import Date" }

    { 22  ;1   ;Part      ;
                SubPageLink=Header GUID=FIELD(GUID);
                PagePartID=Page70015;
                PartType=Page }

  }
  CODE
  {
    VAR
      CreateDoc@1000 : Codeunit 70003;
      ImportMgt@1002 : Codeunit 70002;
      Text002@1003 : TextConst 'ENU=Do you want to create Purchase Invoice document?';
      Text003@1004 : TextConst 'ENU=Document created';

    BEGIN
    {
      +---------------------------------------------+
      | SI-Data                                     |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 24.04.15 JAL
    }
    END.
  }
}

OBJECT Page 70015 Compello Integration Subpage
{
  OBJECT-PROPERTIES
  {
    Date=01.10.16;
    Time=11:00:00;
    Modified=Yes;
    Version List=CMP2.00;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=ENU=Compello Integration Subpage;
    SourceTable=Table70009;
    PageType=ListPart;
  }
  CONTROLS
  {
    { 1   ;0   ;Container ;
                ContainerType=ContentArea }

    { 2   ;1   ;Group     ;
                Name=Group;
                GroupType=Repeater }

    { 3   ;2   ;Field     ;
                SourceExpr="Header GUID";
                Visible=FALSE }

    { 4   ;2   ;Field     ;
                SourceExpr="Line No.";
                Visible=FALSE }

    { 5   ;2   ;Field     ;
                SourceExpr="User Defined 7" }

    { 6   ;2   ;Field     ;
                SourceExpr="Period Value" }

    { 7   ;2   ;Field     ;
                SourceExpr="Period Description" }

    { 8   ;2   ;Field     ;
                SourceExpr="Debet Type" }

    { 9   ;2   ;Field     ;
                SourceExpr="Debet Value" }

    { 10  ;2   ;Field     ;
                SourceExpr="Debet Description" }

    { 11  ;2   ;Field     ;
                SourceExpr="Debet Tax Code" }

    { 12  ;2   ;Field     ;
                SourceExpr="Debet Tax Code Description" }

    { 13  ;2   ;Field     ;
                SourceExpr="Credit Type" }

    { 14  ;2   ;Field     ;
                SourceExpr="Credit Value" }

    { 15  ;2   ;Field     ;
                SourceExpr="Credit Description" }

    { 16  ;2   ;Field     ;
                SourceExpr="Credit Tax Code" }

    { 17  ;2   ;Field     ;
                SourceExpr="Credit Tax Code Description" }

    { 74  ;2   ;Field     ;
                SourceExpr=ReceivedUnits }

    { 73  ;2   ;Field     ;
                SourceExpr=Received }

    { 1101103000;2;Field  ;
                SourceExpr=Volume }

    { 1101103001;2;Field  ;
                SourceExpr=UnitPrice }

    { 18  ;2   ;Field     ;
                SourceExpr=Amount }

    { 19  ;2   ;Field     ;
                SourceExpr="Currency Amount" }

    { 20  ;2   ;Field     ;
                SourceExpr="VAT Amount" }

    { 1101103002;2;Field  ;
                SourceExpr="No VAT" }

    { 21  ;2   ;Field     ;
                SourceExpr="Currency Value" }

    { 22  ;2   ;Field     ;
                SourceExpr="Currency Description" }

    { 23  ;2   ;Field     ;
                SourceExpr=Discount }

    { 24  ;2   ;Field     ;
                SourceExpr="Discount Date" }

    { 25  ;2   ;Field     ;
                SourceExpr=Text }

    { 26  ;2   ;Field     ;
                SourceExpr="User Defined 1" }

    { 27  ;2   ;Field     ;
                SourceExpr="User Defined 2" }

    { 28  ;2   ;Field     ;
                SourceExpr="User Defined 3" }

    { 29  ;2   ;Field     ;
                SourceExpr="User Defined 4" }

    { 30  ;2   ;Field     ;
                SourceExpr="User Defined 5" }

    { 31  ;2   ;Field     ;
                SourceExpr="User Defined 6" }

    { 32  ;2   ;Field     ;
                SourceExpr="User Defined 8" }

    { 33  ;2   ;Field     ;
                SourceExpr="User Defined 9" }

    { 34  ;2   ;Field     ;
                SourceExpr="User Defined 10" }

    { 35  ;2   ;Field     ;
                SourceExpr="User Defined 11" }

    { 36  ;2   ;Field     ;
                SourceExpr="User Defined 12" }

    { 37  ;2   ;Field     ;
                SourceExpr="User Defined 13" }

    { 38  ;2   ;Field     ;
                SourceExpr="User Defined 14" }

    { 39  ;2   ;Field     ;
                SourceExpr="User Defined 15" }

    { 40  ;2   ;Field     ;
                SourceExpr="Dimension 1 Value" }

    { 41  ;2   ;Field     ;
                SourceExpr="Dimension 1 Description" }

    { 42  ;2   ;Field     ;
                SourceExpr="Dimension 2 Value" }

    { 43  ;2   ;Field     ;
                SourceExpr="Dimension 2 Description" }

    { 44  ;2   ;Field     ;
                SourceExpr="Dimension 3 Value" }

    { 45  ;2   ;Field     ;
                SourceExpr="Dimension 3 Description" }

    { 46  ;2   ;Field     ;
                SourceExpr="Dimension 4 Value" }

    { 47  ;2   ;Field     ;
                SourceExpr="Dimension 4 Description" }

    { 48  ;2   ;Field     ;
                SourceExpr="Dimension 5 Value" }

    { 49  ;2   ;Field     ;
                SourceExpr="Dimension 5 Description" }

    { 50  ;2   ;Field     ;
                SourceExpr="Dimension 6 Value" }

    { 51  ;2   ;Field     ;
                SourceExpr="Dimension 6 Description" }

    { 52  ;2   ;Field     ;
                SourceExpr="Dimension 7 Value" }

    { 53  ;2   ;Field     ;
                SourceExpr="Dimension 7 Description" }

    { 54  ;2   ;Field     ;
                SourceExpr="Dimension 8 Value" }

    { 55  ;2   ;Field     ;
                SourceExpr="Dimension 8 Description" }

    { 56  ;2   ;Field     ;
                SourceExpr="Dimension 9 Value" }

    { 57  ;2   ;Field     ;
                SourceExpr="Dimension 9 Description" }

    { 58  ;2   ;Field     ;
                SourceExpr="Dimension 10 Value" }

    { 59  ;2   ;Field     ;
                SourceExpr="Dimension 10 Description" }

    { 60  ;2   ;Field     ;
                SourceExpr="Dimension 11 Value" }

    { 61  ;2   ;Field     ;
                SourceExpr="Dimension 11 Description" }

    { 62  ;2   ;Field     ;
                SourceExpr="Dimension 12 Value" }

    { 63  ;2   ;Field     ;
                SourceExpr="Dimension 12 Description" }

    { 64  ;2   ;Field     ;
                SourceExpr="Dimension 13 Value" }

    { 65  ;2   ;Field     ;
                SourceExpr="Dimension 13 Description" }

    { 66  ;2   ;Field     ;
                SourceExpr="Dimension 14 Value" }

    { 67  ;2   ;Field     ;
                SourceExpr="Dimension 14 Description" }

    { 68  ;2   ;Field     ;
                SourceExpr="Dimension 15 Value" }

    { 69  ;2   ;Field     ;
                SourceExpr="Dimension 15 Description" }

    { 70  ;2   ;Field     ;
                SourceExpr=ProductValue }

    { 71  ;2   ;Field     ;
                SourceExpr=ProductDesc }

    { 72  ;2   ;Field     ;
                SourceExpr=ProductDescriptionFree }

  }
  CODE
  {

    BEGIN
    {
      +---------------------------------------------+
      | SI-Data                                     |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 24.04.15 JAL
    }
    END.
  }
}

OBJECT Page 70016 Compello Imp. Arch. Log List
{
  OBJECT-PROPERTIES
  {
    Date=01.10.16;
    Time=11:00:00;
    Modified=Yes;
    Version List=CMP1.00;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=ENU=Compello Imp. Arch. Log List;
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=No;
    LinksAllowed=No;
    SourceTable=Table70011;
    SourceTableView=SORTING(Last Action Date)
                    ORDER(Descending);
    PageType=List;
    CardPageID=Compello Integr. Arch Log Card;
    ActionList=ACTIONS
    {
      { 22      ;    ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 23      ;1   ;Action    ;
                      Name=Reactivate in Compello;
                      CaptionML=[ENU=Reactivate in Compello;
                                 NOR=Send dokument i retur til Compello];
                      RunPageOnRec=Yes;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Delete;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ImportMgt@1000 : Codeunit 70002;
                                 ImportHdrArchive@1101103000 : Record 70011;
                               BEGIN
                                 IF CONFIRM(Text001, FALSE) THEN BEGIN
                                   CurrPage.SETSELECTIONFILTER(ImportHdrArchive);
                                   ImportMgt.ReactivateArchiveImport(ImportHdrArchive);
                                   MESSAGE(Text002);
                                 END;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1   ;0   ;Container ;
                ContainerType=ContentArea }

    { 2   ;1   ;Group     ;
                Name=Group;
                GroupType=Repeater }

    { 3   ;2   ;Field     ;
                SourceExpr=GUID;
                Visible=FALSE }

    { 4   ;2   ;Field     ;
                SourceExpr="Client ID";
                Visible=FALSE }

    { 25  ;2   ;Field     ;
                SourceExpr="Last Action Date" }

    { 5   ;2   ;Field     ;
                SourceExpr="Archive Ref" }

    { 6   ;2   ;Field     ;
                SourceExpr="Scanned Date" }

    { 7   ;2   ;Field     ;
                SourceExpr="Voucher Type" }

    { 8   ;2   ;Field     ;
                SourceExpr="Invoice No." }

    { 9   ;2   ;Field     ;
                SourceExpr="Order Ref";
                Visible=FALSE }

    { 10  ;2   ;Field     ;
                SourceExpr="Voucher Date" }

    { 11  ;2   ;Field     ;
                SourceExpr="Due Date" }

    { 12  ;2   ;Field     ;
                SourceExpr=KID }

    { 13  ;2   ;Field     ;
                SourceExpr="Transaction No.";
                Visible=FALSE }

    { 14  ;2   ;Field     ;
                SourceExpr="User Defined 1" }

    { 15  ;2   ;Field     ;
                SourceExpr="User Defined 2" }

    { 16  ;2   ;Field     ;
                SourceExpr="User Defined 3";
                Visible=FALSE }

    { 17  ;2   ;Field     ;
                SourceExpr="User Defined 4";
                Visible=FALSE }

    { 18  ;2   ;Field     ;
                SourceExpr="User Defined 5";
                Visible=FALSE }

    { 19  ;2   ;Field     ;
                SourceExpr="User Defined 6";
                Visible=FALSE }

    { 20  ;2   ;Field     ;
                SourceExpr="User Defined 7";
                Visible=FALSE }

    { 21  ;2   ;Field     ;
                SourceExpr="Image GUID";
                Visible=FALSE }

    { 24  ;2   ;Field     ;
                SourceExpr=Status }

  }
  CODE
  {
    VAR
      Text001@1000 : TextConst 'ENU=Do you want to reactivate document in Compello?';
      Text002@1001 : TextConst 'ENU=Reactivation done';

    BEGIN
    {
      +---------------------------------------------+
      | SI-Data                                     |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 24.04.15 JAL
    }
    END.
  }
}

OBJECT Page 70017 Compello Integr. Arch Log Card
{
  OBJECT-PROPERTIES
  {
    Date=01.10.16;
    Time=11:00:00;
    Modified=Yes;
    Version List=CMP1.01;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=ENU=Compello Integr. Arch Log Card;
    DeleteAllowed=No;
    LinksAllowed=No;
    SourceTable=Table70011;
    PageType=Card;
    ActionList=ACTIONS
    {
      { 1000000000;  ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000001;1 ;Action    ;
                      Name=Show Document;
                      OnAction=VAR
                                 CompIntSetup@1000000000 : Record 70000;
                               BEGIN
                                 //>> CMP001 1.01
                                 CompIntSetup.GET;
                                 CompIntSetup.TESTFIELD("Customer ID");
                                 CompIntSetup.TESTFIELD("Web Service Address");
                                 TESTFIELD("Image GUID");
                                 HYPERLINK(CompIntSetup."Web Service Address"+'/InvoiceViewer.aspx?cci='+CompIntSetup."Customer ID"+'&img='+"Image GUID");
                                 //<< CMP001 1.01
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1   ;0   ;Container ;
                ContainerType=ContentArea }

    { 2   ;1   ;Group     ;
                Name=General;
                GroupType=Group }

    { 3   ;2   ;Field     ;
                SourceExpr=GUID }

    { 4   ;2   ;Field     ;
                SourceExpr="Client ID" }

    { 5   ;2   ;Field     ;
                SourceExpr="Archive Ref" }

    { 6   ;2   ;Field     ;
                SourceExpr="Scanned Date" }

    { 7   ;2   ;Field     ;
                SourceExpr="Voucher Type" }

    { 8   ;2   ;Field     ;
                SourceExpr="Invoice No." }

    { 9   ;2   ;Field     ;
                SourceExpr="Order Ref" }

    { 10  ;2   ;Field     ;
                SourceExpr="Voucher Date" }

    { 11  ;2   ;Field     ;
                SourceExpr="Due Date" }

    { 12  ;2   ;Field     ;
                SourceExpr=KID }

    { 13  ;2   ;Field     ;
                SourceExpr="Transaction No." }

    { 14  ;2   ;Field     ;
                SourceExpr="User Defined 1" }

    { 15  ;2   ;Field     ;
                SourceExpr="User Defined 2" }

    { 16  ;2   ;Field     ;
                SourceExpr="User Defined 3" }

    { 17  ;2   ;Field     ;
                SourceExpr="User Defined 4" }

    { 18  ;2   ;Field     ;
                SourceExpr="User Defined 5" }

    { 19  ;2   ;Field     ;
                SourceExpr="User Defined 6" }

    { 20  ;2   ;Field     ;
                SourceExpr="User Defined 7" }

    { 21  ;2   ;Field     ;
                SourceExpr="Image GUID" }

    { 23  ;2   ;Field     ;
                SourceExpr=Status }

    { 24  ;2   ;Field     ;
                SourceExpr="Last Action Date" }

    { 22  ;1   ;Part      ;
                SubPageLink=Header GUID=FIELD(GUID);
                PagePartID=Page70018;
                PartType=Page }

  }
  CODE
  {
    VAR
      CreateDoc@1000 : Codeunit 70003;
      ImportMgt@1002 : Codeunit 70002;
      Text002@1003 : TextConst 'ENU=Do you want to create Purchase Invoice document?';
      Text003@1004 : TextConst 'ENU=Document created';

    BEGIN
    {
      CMP001 1.00 2014-07-23 Integration with Compello Document Management
                               Object created
      CMP001 1.01 2014-09-08 Integration with Compello Document Management
                               New Action
                                 Show Document
    }
    END.
  }
}

OBJECT Page 70018 Compello Integ. Arch. Subpage
{
  OBJECT-PROPERTIES
  {
    Date=01.10.16;
    Time=11:00:00;
    Modified=Yes;
    Version List=CMP2.00;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=ENU=Compello Integ. Arch. Subpage;
    SourceTable=Table70012;
    PageType=ListPart;
  }
  CONTROLS
  {
    { 1   ;0   ;Container ;
                ContainerType=ContentArea }

    { 2   ;1   ;Group     ;
                Name=Group;
                GroupType=Repeater }

    { 3   ;2   ;Field     ;
                SourceExpr="Header GUID";
                Visible=FALSE }

    { 4   ;2   ;Field     ;
                SourceExpr="Line No.";
                Visible=FALSE }

    { 5   ;2   ;Field     ;
                SourceExpr="User Defined 7" }

    { 6   ;2   ;Field     ;
                SourceExpr="Period Value" }

    { 7   ;2   ;Field     ;
                SourceExpr="Period Description" }

    { 8   ;2   ;Field     ;
                SourceExpr="Debet Type" }

    { 9   ;2   ;Field     ;
                SourceExpr="Debet Value" }

    { 10  ;2   ;Field     ;
                SourceExpr="Debet Description" }

    { 11  ;2   ;Field     ;
                SourceExpr="Debet Tax Code" }

    { 12  ;2   ;Field     ;
                SourceExpr="Debet Tax Code Description" }

    { 13  ;2   ;Field     ;
                SourceExpr="Credit Type" }

    { 14  ;2   ;Field     ;
                SourceExpr="Credit Value" }

    { 15  ;2   ;Field     ;
                SourceExpr="Credit Description" }

    { 16  ;2   ;Field     ;
                SourceExpr="Credit Tax Code" }

    { 17  ;2   ;Field     ;
                SourceExpr="Credit Tax Code Description" }

    { 74  ;2   ;Field     ;
                SourceExpr=ReceivedUnits }

    { 1101103000;2;Field  ;
                SourceExpr=Volume }

    { 1101103001;2;Field  ;
                SourceExpr=UnitPrice }

    { 18  ;2   ;Field     ;
                SourceExpr=Amount }

    { 19  ;2   ;Field     ;
                SourceExpr="Currency Amount" }

    { 20  ;2   ;Field     ;
                SourceExpr="VAT Amount" }

    { 21  ;2   ;Field     ;
                SourceExpr="Currency Value" }

    { 22  ;2   ;Field     ;
                SourceExpr="Currency Description" }

    { 23  ;2   ;Field     ;
                SourceExpr=Discount }

    { 24  ;2   ;Field     ;
                SourceExpr="Discount Date" }

    { 25  ;2   ;Field     ;
                SourceExpr=Text }

    { 26  ;2   ;Field     ;
                SourceExpr="User Defined 1" }

    { 27  ;2   ;Field     ;
                SourceExpr="User Defined 2" }

    { 28  ;2   ;Field     ;
                SourceExpr="User Defined 3" }

    { 29  ;2   ;Field     ;
                SourceExpr="User Defined 4" }

    { 30  ;2   ;Field     ;
                SourceExpr="User Defined 5" }

    { 31  ;2   ;Field     ;
                SourceExpr="User Defined 6" }

    { 32  ;2   ;Field     ;
                SourceExpr="User Defined 8" }

    { 33  ;2   ;Field     ;
                SourceExpr="User Defined 9" }

    { 34  ;2   ;Field     ;
                SourceExpr="User Defined 10" }

    { 35  ;2   ;Field     ;
                SourceExpr="User Defined 11" }

    { 36  ;2   ;Field     ;
                SourceExpr="User Defined 12" }

    { 37  ;2   ;Field     ;
                SourceExpr="User Defined 13" }

    { 38  ;2   ;Field     ;
                SourceExpr="User Defined 14" }

    { 39  ;2   ;Field     ;
                SourceExpr="User Defined 15" }

    { 40  ;2   ;Field     ;
                SourceExpr="Dimension 1 Value" }

    { 41  ;2   ;Field     ;
                SourceExpr="Dimension 1 Description" }

    { 42  ;2   ;Field     ;
                SourceExpr="Dimension 2 Value" }

    { 43  ;2   ;Field     ;
                SourceExpr="Dimension 2 Description" }

    { 44  ;2   ;Field     ;
                SourceExpr="Dimension 3 Value" }

    { 45  ;2   ;Field     ;
                SourceExpr="Dimension 3 Description" }

    { 46  ;2   ;Field     ;
                SourceExpr="Dimension 4 Value" }

    { 47  ;2   ;Field     ;
                SourceExpr="Dimension 4 Description" }

    { 48  ;2   ;Field     ;
                SourceExpr="Dimension 5 Value" }

    { 49  ;2   ;Field     ;
                SourceExpr="Dimension 5 Description" }

    { 50  ;2   ;Field     ;
                SourceExpr="Dimension 6 Value" }

    { 51  ;2   ;Field     ;
                SourceExpr="Dimension 6 Description" }

    { 52  ;2   ;Field     ;
                SourceExpr="Dimension 7 Value" }

    { 53  ;2   ;Field     ;
                SourceExpr="Dimension 7 Description" }

    { 54  ;2   ;Field     ;
                SourceExpr="Dimension 8 Value" }

    { 55  ;2   ;Field     ;
                SourceExpr="Dimension 8 Description" }

    { 56  ;2   ;Field     ;
                SourceExpr="Dimension 9 Value" }

    { 57  ;2   ;Field     ;
                SourceExpr="Dimension 9 Description" }

    { 58  ;2   ;Field     ;
                SourceExpr="Dimension 10 Value" }

    { 59  ;2   ;Field     ;
                SourceExpr="Dimension 10 Description" }

    { 60  ;2   ;Field     ;
                SourceExpr="Dimension 11 Value" }

    { 61  ;2   ;Field     ;
                SourceExpr="Dimension 11 Description" }

    { 62  ;2   ;Field     ;
                SourceExpr="Dimension 12 Value" }

    { 63  ;2   ;Field     ;
                SourceExpr="Dimension 12 Description" }

    { 64  ;2   ;Field     ;
                SourceExpr="Dimension 13 Value" }

    { 65  ;2   ;Field     ;
                SourceExpr="Dimension 13 Description" }

    { 66  ;2   ;Field     ;
                SourceExpr="Dimension 14 Value" }

    { 67  ;2   ;Field     ;
                SourceExpr="Dimension 14 Description" }

    { 68  ;2   ;Field     ;
                SourceExpr="Dimension 15 Value" }

    { 69  ;2   ;Field     ;
                SourceExpr="Dimension 15 Description" }

    { 70  ;2   ;Field     ;
                SourceExpr=ProductValue }

    { 71  ;2   ;Field     ;
                SourceExpr=ProductDesc }

    { 72  ;2   ;Field     ;
                SourceExpr=ProductDescriptionFree }

    { 1101103002;2;Field  ;
                SourceExpr=Received }

  }
  CODE
  {

    BEGIN
    {
      +---------------------------------------------+
      | SI-Data                                     |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 24.04.15 JAL
    }
    END.
  }
}

OBJECT Page 70019 Header and Line Relation
{
  OBJECT-PROPERTIES
  {
    Date=01.10.16;
    Time=11:00:00;
    Modified=Yes;
    Version List=CMP1.00;
  }
  PROPERTIES
  {
    CaptionML=ENU=Header and Line Relation;
    SourceTable=Table70013;
    DelayedInsert=Yes;
    PageType=List;
  }
  CONTROLS
  {
    { 1   ;0   ;Container ;
                ContainerType=ContentArea }

    { 2   ;1   ;Group     ;
                Name=Group;
                GroupType=Repeater }

    { 3   ;2   ;Field     ;
                SourceExpr="Table Code";
                Visible=FALSE;
                Editable=FALSE }

    { 4   ;2   ;Field     ;
                SourceExpr="Header Field No.";
                OnLookup=BEGIN
                           EXIT(TableFieldLookUp(Text, TRUE));
                         END;
                          }

    { 7   ;2   ;Field     ;
                SourceExpr="Header Field Caption" }

    { 5   ;2   ;Field     ;
                SourceExpr="Line Field No.";
                OnLookup=BEGIN
                           EXIT(TableFieldLookUp(Text, FALSE));
                         END;
                          }

    { 8   ;2   ;Field     ;
                SourceExpr="Line Field Caption" }

    { 6   ;2   ;Field     ;
                SourceExpr=Validate }

  }
  CODE
  {

    BEGIN
    {
      CMP001 1.00 2014-07-23 Integration with Compello Document Management
                               Object created
    }
    END.
  }
}

OBJECT Page 70020 Compello Change Log List Del
{
  OBJECT-PROPERTIES
  {
    Date=01.10.16;
    Time=11:00:00;
    Modified=Yes;
    Version List=CMP1.01;
  }
  PROPERTIES
  {
    Editable=Yes;
    CaptionML=ENU=Compello Change Log List;
    InsertAllowed=No;
    ModifyAllowed=No;
    SourceTable=Table70001;
    PageType=List;
    ActionList=ACTIONS
    {
      { 17      ;    ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 18      ;1   ;Action    ;
                      CaptionML=ENU=Send to Compello;
                      Image=Export;
                      OnAction=BEGIN
                                 IF "Table ID" <> 0 THEN BEGIN
                                   CASE STRMENU(Text001) OF
                                     1 : BEGIN
                                       IF CompelloExpMgt.SyncOneRec(Rec) THEN BEGIN
                                         MESSAGE(Text002);
                                       END ELSE BEGIN
                                         COMMIT;
                                         ERROR(Text003);
                                       END;
                                     END;
                                     2 : BEGIN
                                       IF CompelloExpMgt.SyncMultipleRecords(Rec, FALSE) THEN BEGIN
                                         MESSAGE(Text004);
                                       END ELSE BEGIN
                                         COMMIT;
                                         ERROR(Text003);
                                       END;
                                     END;
                                   END;
                                 END;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1   ;0   ;Container ;
                ContainerType=ContentArea }

    { 2   ;1   ;Group     ;
                Name=Group;
                GroupType=Repeater }

    { 3   ;2   ;Field     ;
                SourceExpr=GUID }

    { 4   ;2   ;Field     ;
                SourceExpr="Table ID" }

    { 5   ;2   ;Field     ;
                SourceExpr=FORMAT("Record ID") }

    { 6   ;2   ;Field     ;
                SourceExpr="User Action" }

    { 7   ;2   ;Field     ;
                SourceExpr=Date }

    { 8   ;2   ;Field     ;
                SourceExpr=DataType }

    { 9   ;2   ;Field     ;
                SourceExpr=Value }

    { 10  ;2   ;Field     ;
                SourceExpr=Description }

    { 11  ;2   ;Field     ;
                SourceExpr="Description 2" }

    { 12  ;2   ;Field     ;
                SourceExpr="Description 3" }

    { 13  ;2   ;Field     ;
                SourceExpr=Inactive }

    { 14  ;2   ;Field     ;
                SourceExpr=Status }

    { 15  ;2   ;Field     ;
                SourceExpr="Error Message" }

    { 16  ;2   ;Field     ;
                SourceExpr="No. of Tries" }

  }
  CODE
  {
    VAR
      CompelloExpMgt@1000 : Codeunit 70001;
      Text001@1001 : TextConst 'ENU=Send one record to Compello,Send all records to Compello';
      Text002@1002 : TextConst 'ENU=Record synchronized';
      Text003@1003 : TextConst 'ENU=Synchronization was unsuccessful';
      Text004@1004 : TextConst 'ENU=Records synchronized';

    BEGIN
    {
      CMP001 1.01 2014-08-22 Integration with Compello Document Management
                               Object created
    }
    END.
  }
}

