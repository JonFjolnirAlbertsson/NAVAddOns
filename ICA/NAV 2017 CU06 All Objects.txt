OBJECT Table 37 Sales Line
{
  OBJECT-PROPERTIES
  {
    Date=05.09.17;
    Time=15.50.08;
    Modified=Yes;
    Version List=NAVW110.00.00.15052,NAVNO10.00.00.15052,ICA2.01;
  }
  PROPERTIES
  {
    OnInsert=BEGIN
               TestStatusOpen;
               IF Quantity <> 0 THEN
                 ReserveSalesLine.VerifyQuantity(Rec,xRec);
               LOCKTABLE;
               SalesHeader."No." := '';
               IF Type = Type::Item THEN
                 IF SalesHeader.InventoryPickConflict("Document Type","Document No.",SalesHeader."Shipping Advice") THEN
                   ERROR(Text056,SalesHeader."Shipping Advice");
               IF ("Deferral Code" <> '') AND (GetDeferralAmount <> 0) THEN
                 UpdateDeferralAmounts;
             END;

    OnModify=BEGIN
               IF ("Document Type" = "Document Type"::"Blanket Order") AND
                  ((Type <> xRec.Type) OR ("No." <> xRec."No."))
               THEN BEGIN
                 SalesLine2.RESET;
                 SalesLine2.SETCURRENTKEY("Document Type","Blanket Order No.","Blanket Order Line No.");
                 SalesLine2.SETRANGE("Blanket Order No.","Document No.");
                 SalesLine2.SETRANGE("Blanket Order Line No.","Line No.");
                 IF SalesLine2.FINDSET THEN
                   REPEAT
                     SalesLine2.TESTFIELD(Type,Type);
                     SalesLine2.TESTFIELD("No.","No.");
                   UNTIL SalesLine2.NEXT = 0;
               END;

               IF ((Quantity <> 0) OR (xRec.Quantity <> 0)) AND ItemExists(xRec."No.") AND NOT FullReservedQtyIsForAsmToOrder THEN
                 ReserveSalesLine.VerifyChange(Rec,xRec);
             END;

    OnDelete=VAR
               SalesCommentLine@1001 : Record 44;
               CapableToPromise@1000 : Codeunit 99000886;
               JobCreateInvoice@1002 : Codeunit 1002;
             BEGIN
               TestStatusOpen;
               IF NOT StatusCheckSuspended AND (SalesHeader.Status = SalesHeader.Status::Released) AND
                  (Type IN [Type::"G/L Account",Type::"Charge (Item)",Type::Resource])
               THEN
                 VALIDATE(Quantity,0);

               IF (Quantity <> 0) AND ItemExists("No.") THEN BEGIN
                 ReserveSalesLine.DeleteLine(Rec);
                 CALCFIELDS("Reserved Qty. (Base)");
                 TESTFIELD("Reserved Qty. (Base)",0);
                 IF "Shipment No." = '' THEN
                   TESTFIELD("Qty. Shipped Not Invoiced",0);
                 IF "Return Receipt No." = '' THEN
                   TESTFIELD("Return Qty. Rcd. Not Invd.",0);
                 WhseValidateSourceLine.SalesLineDelete(Rec);
               END;

               IF ("Document Type" = "Document Type"::Order) AND (Quantity <> "Quantity Invoiced") THEN
                 TESTFIELD("Prepmt. Amt. Inv.","Prepmt Amt Deducted");

               CleanSpecialOrderFieldsAndCheckAssocPurchOrder;
               NonstockItemMgt.DelNonStockSales(Rec);

               IF "Document Type" = "Document Type"::"Blanket Order" THEN BEGIN
                 SalesLine2.RESET;
                 SalesLine2.SETCURRENTKEY("Document Type","Blanket Order No.","Blanket Order Line No.");
                 SalesLine2.SETRANGE("Blanket Order No.","Document No.");
                 SalesLine2.SETRANGE("Blanket Order Line No.","Line No.");
                 IF SalesLine2.FINDFIRST THEN
                   SalesLine2.TESTFIELD("Blanket Order Line No.",0);
               END;

               IF Type = Type::Item THEN BEGIN
                 ATOLink.DeleteAsmFromSalesLine(Rec);
                 DeleteItemChargeAssgnt("Document Type","Document No.","Line No.");
               END;

               IF Type = Type::"Charge (Item)" THEN
                 DeleteChargeChargeAssgnt("Document Type","Document No.","Line No.");

               CapableToPromise.RemoveReqLines("Document No.","Line No.",0,FALSE);

               IF "Line No." <> 0 THEN BEGIN
                 SalesLine2.RESET;
                 SalesLine2.SETRANGE("Document Type","Document Type");
                 SalesLine2.SETRANGE("Document No.","Document No.");
                 SalesLine2.SETRANGE("Attached to Line No.","Line No.");
                 SalesLine2.SETFILTER("Line No.",'<>%1',"Line No.");
                 SalesLine2.DELETEALL(TRUE);
               END;

               IF "Job Contract Entry No." <> 0 THEN
                 JobCreateInvoice.DeleteSalesLine(Rec);

               SalesCommentLine.SETRANGE("Document Type","Document Type");
               SalesCommentLine.SETRANGE("No.","Document No.");
               SalesCommentLine.SETRANGE("Document Line No.","Line No.");
               IF NOT SalesCommentLine.ISEMPTY THEN
                 SalesCommentLine.DELETEALL;

               IF ("Line No." <> 0) AND ("Attached to Line No." = 0) THEN BEGIN
                 SalesLine2.COPY(Rec);
                 IF SalesLine2.FIND('<>') THEN BEGIN
                   SalesLine2.VALIDATE("Recalculate Invoice Disc.",TRUE);
                   SalesLine2.MODIFY;
                 END;
               END;

               IF "Deferral Code" <> '' THEN
                 DeferralUtilities.DeferralCodeOnDelete(
                   DeferralUtilities.GetSalesDeferralDocType,'','',
                   "Document Type","Document No.","Line No.");
             END;

    OnRename=BEGIN
               ERROR(Text001,TABLECAPTION);
             END;

    CaptionML=[ENU=Sales Line;
               NOR=Salgslinje];
    LookupPageID=Page516;
    DrillDownPageID=Page516;
  }
  FIELDS
  {
    { 1   ;   ;Document Type       ;Option        ;CaptionML=[ENU=Document Type;
                                                              NOR=Bilagstype];
                                                   OptionCaptionML=[ENU=Quote,Order,Invoice,Credit Memo,Blanket Order,Return Order;
                                                                    NOR=Tilbud,Ordre,Faktura,Kreditnota,Rammeordre,Ordreretur];
                                                   OptionString=Quote,Order,Invoice,Credit Memo,Blanket Order,Return Order }
    { 2   ;   ;Sell-to Customer No.;Code20        ;TableRelation=Customer;
                                                   CaptionML=[ENU=Sell-to Customer No.;
                                                              NOR=Salg til-kundenr.];
                                                   Editable=No }
    { 3   ;   ;Document No.        ;Code20        ;TableRelation="Sales Header".No. WHERE (Document Type=FIELD(Document Type));
                                                   CaptionML=[ENU=Document No.;
                                                              NOR=Bilagsnr.] }
    { 4   ;   ;Line No.            ;Integer       ;CaptionML=[ENU=Line No.;
                                                              NOR=Linjenr.] }
    { 5   ;   ;Type                ;Option        ;OnValidate=VAR
                                                                TempSalesLine@1000 : TEMPORARY Record 37;
                                                              BEGIN
                                                                TestJobPlanningLine;
                                                                TestStatusOpen;
                                                                GetSalesHeader;

                                                                TESTFIELD("Qty. Shipped Not Invoiced",0);
                                                                TESTFIELD("Quantity Shipped",0);
                                                                TESTFIELD("Shipment No.",'');

                                                                TESTFIELD("Return Qty. Rcd. Not Invd.",0);
                                                                TESTFIELD("Return Qty. Received",0);
                                                                TESTFIELD("Return Receipt No.",'');

                                                                TESTFIELD("Prepmt. Amt. Inv.",0);

                                                                CheckAssocPurchOrder(FIELDCAPTION(Type));

                                                                IF Type <> xRec.Type THEN BEGIN
                                                                  CASE xRec.Type OF
                                                                    Type::Item:
                                                                      BEGIN
                                                                        ATOLink.DeleteAsmFromSalesLine(Rec);
                                                                        IF Quantity <> 0 THEN BEGIN
                                                                          SalesHeader.TESTFIELD(Status,SalesHeader.Status::Open);
                                                                          CALCFIELDS("Reserved Qty. (Base)");
                                                                          TESTFIELD("Reserved Qty. (Base)",0);
                                                                          ReserveSalesLine.VerifyChange(Rec,xRec);
                                                                          WhseValidateSourceLine.SalesLineVerifyChange(Rec,xRec);
                                                                        END;
                                                                      END;
                                                                    Type::"Fixed Asset":
                                                                      IF Quantity <> 0 THEN
                                                                        SalesHeader.TESTFIELD(Status,SalesHeader.Status::Open);
                                                                    Type::"Charge (Item)":
                                                                      DeleteChargeChargeAssgnt("Document Type","Document No.","Line No.");
                                                                  END;
                                                                  IF xRec."Deferral Code" <> '' THEN
                                                                    DeferralUtilities.RemoveOrSetDeferralSchedule('',
                                                                      DeferralUtilities.GetSalesDeferralDocType,'','',
                                                                      xRec."Document Type",xRec."Document No.",xRec."Line No.",
                                                                      xRec.GetDeferralAmount,xRec."Posting Date",'',xRec."Currency Code",TRUE);
                                                                END;
                                                                AddOnIntegrMgt.CheckReceiptOrderStatus(Rec);
                                                                TempSalesLine := Rec;
                                                                INIT;
                                                                IF xRec."Line Amount" <> 0 THEN
                                                                  "Recalculate Invoice Disc." := TRUE;

                                                                Type := TempSalesLine.Type;
                                                                "System-Created Entry" := TempSalesLine."System-Created Entry";
                                                                "Currency Code" := SalesHeader."Currency Code";

                                                                IF Type = Type::Item THEN
                                                                  "Allow Item Charge Assignment" := TRUE
                                                                ELSE
                                                                  "Allow Item Charge Assignment" := FALSE;
                                                                IF Type = Type::Item THEN BEGIN
                                                                  IF SalesHeader.InventoryPickConflict("Document Type","Document No.",SalesHeader."Shipping Advice") THEN
                                                                    ERROR(Text056,SalesHeader."Shipping Advice");
                                                                  IF SalesHeader.WhseShpmntConflict("Document Type","Document No.",SalesHeader."Shipping Advice") THEN
                                                                    ERROR(Text052,SalesHeader."Shipping Advice");
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Type;
                                                              NOR=Type];
                                                   OptionCaptionML=[ENU=" ,G/L Account,Item,Resource,Fixed Asset,Charge (Item)";
                                                                    NOR=" ,Finanskonto,Vare,Ressurs,Aktiva,Gebyr (vare)"];
                                                   OptionString=[ ,G/L Account,Item,Resource,Fixed Asset,Charge (Item)] }
    { 6   ;   ;No.                 ;Code20        ;TableRelation=IF (Type=CONST(" ")) "Standard Text"
                                                                 ELSE IF (Type=CONST(G/L Account),
                                                                          System-Created Entry=CONST(No)) "G/L Account" WHERE (Direct Posting=CONST(Yes),
                                                                                                                               Account Type=CONST(Posting),
                                                                                                                               Blocked=CONST(No))
                                                                                                                               ELSE IF (Type=CONST(G/L Account),
                                                                                                                                        System-Created Entry=CONST(Yes)) "G/L Account"
                                                                                                                                        ELSE IF (Type=CONST(Item)) Item
                                                                                                                                        ELSE IF (Type=CONST(Resource)) Resource
                                                                                                                                        ELSE IF (Type=CONST(Fixed Asset)) "Fixed Asset"
                                                                                                                                        ELSE IF (Type=CONST("Charge (Item)")) "Item Charge";
                                                   OnValidate=VAR
                                                                TempSalesLine@1003 : TEMPORARY Record 37;
                                                                StandardText@1000 : Record 7;
                                                                FixedAsset@1001 : Record 5600;
                                                                PrepaymentMgt@1002 : Codeunit 441;
                                                              BEGIN
                                                                "No." := FindNoFromTypedValue("No.");

                                                                TestJobPlanningLine;
                                                                TestStatusOpen;
                                                                CheckItemAvailable(FIELDNO("No."));

                                                                IF (xRec."No." <> "No.") AND (Quantity <> 0) THEN BEGIN
                                                                  TESTFIELD("Qty. to Asm. to Order (Base)",0);
                                                                  CALCFIELDS("Reserved Qty. (Base)");
                                                                  TESTFIELD("Reserved Qty. (Base)",0);
                                                                  IF Type = Type::Item THEN
                                                                    WhseValidateSourceLine.SalesLineVerifyChange(Rec,xRec);
                                                                END;

                                                                TESTFIELD("Qty. Shipped Not Invoiced",0);
                                                                TESTFIELD("Quantity Shipped",0);
                                                                TESTFIELD("Shipment No.",'');

                                                                TESTFIELD("Prepmt. Amt. Inv.",0);

                                                                TESTFIELD("Return Qty. Rcd. Not Invd.",0);
                                                                TESTFIELD("Return Qty. Received",0);
                                                                TESTFIELD("Return Receipt No.",'');

                                                                IF "No." = '' THEN
                                                                  ATOLink.DeleteAsmFromSalesLine(Rec);
                                                                CheckAssocPurchOrder(FIELDCAPTION("No."));
                                                                AddOnIntegrMgt.CheckReceiptOrderStatus(Rec);

                                                                TempSalesLine := Rec;
                                                                INIT;
                                                                IF xRec."Line Amount" <> 0 THEN
                                                                  "Recalculate Invoice Disc." := TRUE;
                                                                Type := TempSalesLine.Type;
                                                                "No." := TempSalesLine."No.";
                                                                IF "No." = '' THEN
                                                                  EXIT;
                                                                IF Type <> Type::" " THEN
                                                                  Quantity := TempSalesLine.Quantity;

                                                                "System-Created Entry" := TempSalesLine."System-Created Entry";
                                                                GetSalesHeader;
                                                                InitHeaderDefaults(SalesHeader);
                                                                CALCFIELDS("Substitution Available");

                                                                "Promised Delivery Date" := SalesHeader."Promised Delivery Date";
                                                                "Requested Delivery Date" := SalesHeader."Requested Delivery Date";
                                                                "Shipment Date" :=
                                                                  CalendarMgmt.CalcDateBOC(
                                                                    '',
                                                                    SalesHeader."Shipment Date",
                                                                    CalChange."Source Type"::Location,
                                                                    "Location Code",
                                                                    '',
                                                                    CalChange."Source Type"::"Shipping Agent",
                                                                    "Shipping Agent Code",
                                                                    "Shipping Agent Service Code",
                                                                    FALSE);
                                                                UpdateDates;

                                                                CASE Type OF
                                                                  Type::" ":
                                                                    BEGIN
                                                                      StandardText.GET("No.");
                                                                      Description := StandardText.Description;
                                                                      "Allow Item Charge Assignment" := FALSE;
                                                                    END;
                                                                  Type::"G/L Account":
                                                                    BEGIN
                                                                      GLAcc.GET("No.");
                                                                      GLAcc.CheckGLAcc;
                                                                      IF NOT "System-Created Entry" THEN
                                                                        GLAcc.TESTFIELD("Direct Posting",TRUE);
                                                                      Description := GLAcc.Name;
                                                                      "Gen. Prod. Posting Group" := GLAcc."Gen. Prod. Posting Group";
                                                                      "VAT Prod. Posting Group" := GLAcc."VAT Prod. Posting Group";
                                                                      "Tax Group Code" := GLAcc."Tax Group Code";
                                                                      "Allow Invoice Disc." := FALSE;
                                                                      "Allow Item Charge Assignment" := FALSE;
                                                                      InitDeferralCode;
                                                                    END;
                                                                  Type::Item:
                                                                    BEGIN
                                                                      GetItem;
                                                                      Item.TESTFIELD(Blocked,FALSE);
                                                                      Item.TESTFIELD("Gen. Prod. Posting Group");
                                                                      IF Item.Type = Item.Type::Inventory THEN BEGIN
                                                                        Item.TESTFIELD("Inventory Posting Group");
                                                                        "Posting Group" := Item."Inventory Posting Group";
                                                                      END;
                                                                      Description := Item.Description;
                                                                      "Description 2" := Item."Description 2";
                                                                      GetUnitCost;
                                                                      "Allow Invoice Disc." := Item."Allow Invoice Disc.";
                                                                      "Units per Parcel" := Item."Units per Parcel";
                                                                      "Gen. Prod. Posting Group" := Item."Gen. Prod. Posting Group";
                                                                      "VAT Prod. Posting Group" := Item."VAT Prod. Posting Group";
                                                                      "Tax Group Code" := Item."Tax Group Code";
                                                                      "Item Category Code" := Item."Item Category Code";
                                                                      "Product Group Code" := Item."Product Group Code";
                                                                      Nonstock := Item."Created From Nonstock Item";
                                                                      "Profit %" := Item."Profit %";
                                                                      "Allow Item Charge Assignment" := TRUE;
                                                                      PrepaymentMgt.SetSalesPrepaymentPct(Rec,SalesHeader."Posting Date");

                                                                      IF SalesHeader."Language Code" <> '' THEN
                                                                        GetItemTranslation;

                                                                      IF Item.Reserve = Item.Reserve::Optional THEN
                                                                        Reserve := SalesHeader.Reserve
                                                                      ELSE
                                                                        Reserve := Item.Reserve;

                                                                      "Unit of Measure Code" := Item."Sales Unit of Measure";
                                                                      InitDeferralCode;
                                                                      SetDefaultItemQuantity;
                                                                    END;
                                                                  Type::Resource:
                                                                    BEGIN
                                                                      Res.GET("No.");
                                                                      Res.TESTFIELD(Blocked,FALSE);
                                                                      Res.TESTFIELD("Gen. Prod. Posting Group");
                                                                      Description := Res.Name;
                                                                      "Description 2" := Res."Name 2";
                                                                      "Unit of Measure Code" := Res."Base Unit of Measure";
                                                                      "Unit Cost (LCY)" := Res."Unit Cost";
                                                                      "Gen. Prod. Posting Group" := Res."Gen. Prod. Posting Group";
                                                                      "VAT Prod. Posting Group" := Res."VAT Prod. Posting Group";
                                                                      "Tax Group Code" := Res."Tax Group Code";
                                                                      "Allow Item Charge Assignment" := FALSE;
                                                                      FindResUnitCost;
                                                                      InitDeferralCode;
                                                                    END;
                                                                  Type::"Fixed Asset":
                                                                    BEGIN
                                                                      FixedAsset.GET("No.");
                                                                      FixedAsset.TESTFIELD(Inactive,FALSE);
                                                                      FixedAsset.TESTFIELD(Blocked,FALSE);
                                                                      GetFAPostingGroup;
                                                                      Description := FixedAsset.Description;
                                                                      "Description 2" := FixedAsset."Description 2";
                                                                      "Allow Invoice Disc." := FALSE;
                                                                      "Allow Item Charge Assignment" := FALSE;
                                                                    END;
                                                                  Type::"Charge (Item)":
                                                                    BEGIN
                                                                      ItemCharge.GET("No.");
                                                                      Description := ItemCharge.Description;
                                                                      "Gen. Prod. Posting Group" := ItemCharge."Gen. Prod. Posting Group";
                                                                      "VAT Prod. Posting Group" := ItemCharge."VAT Prod. Posting Group";
                                                                      "Tax Group Code" := ItemCharge."Tax Group Code";
                                                                      "Allow Invoice Disc." := FALSE;
                                                                      "Allow Item Charge Assignment" := FALSE;
                                                                    END;
                                                                END;

                                                                IF NOT (Type IN [Type::" ",Type::"Fixed Asset"]) THEN
                                                                  VALIDATE("VAT Prod. Posting Group");

                                                                UpdatePrepmtSetupFields;

                                                                IF Type <> Type::" " THEN BEGIN
                                                                  VALIDATE("Unit of Measure Code");
                                                                  IF Quantity <> 0 THEN BEGIN
                                                                    InitOutstanding;
                                                                    IF "Document Type" IN ["Document Type"::"Return Order","Document Type"::"Credit Memo"] THEN
                                                                      InitQtyToReceive
                                                                    ELSE
                                                                      InitQtyToShip;
                                                                    InitQtyToAsm;
                                                                    UpdateWithWarehouseShip;
                                                                  END;
                                                                  UpdateUnitPrice(FIELDNO("No."));
                                                                END;

                                                                IF NOT ISTEMPORARY THEN
                                                                  CreateDim(
                                                                    DimMgt.TypeToTableID3(Type),"No.",
                                                                    DATABASE::Job,"Job No.",
                                                                    DATABASE::"Responsibility Center","Responsibility Center");

                                                                IF "No." <> xRec."No." THEN BEGIN
                                                                  IF Type = Type::Item THEN
                                                                    IF (Quantity <> 0) AND ItemExists(xRec."No.") THEN BEGIN
                                                                      ReserveSalesLine.VerifyChange(Rec,xRec);
                                                                      WhseValidateSourceLine.SalesLineVerifyChange(Rec,xRec);
                                                                    END;
                                                                  GetDefaultBin;
                                                                  AutoAsmToOrder;
                                                                  DeleteItemChargeAssgnt("Document Type","Document No.","Line No.");
                                                                  IF Type = Type::"Charge (Item)" THEN
                                                                    DeleteChargeChargeAssgnt("Document Type","Document No.","Line No.");
                                                                END;

                                                                UpdateItemCrossRef;
                                                              END;

                                                   ValidateTableRelation=No;
                                                   CaptionML=[ENU=No.;
                                                              NOR=Nr.];
                                                   CaptionClass=GetCaptionClass(FIELDNO("No.")) }
    { 7   ;   ;Location Code       ;Code10        ;TableRelation=Location WHERE (Use As In-Transit=CONST(No));
                                                   OnValidate=BEGIN
                                                                TestJobPlanningLine;
                                                                TestStatusOpen;
                                                                CheckAssocPurchOrder(FIELDCAPTION("Location Code"));
                                                                IF "Location Code" <> '' THEN
                                                                  IF IsServiceItem THEN
                                                                    Item.TESTFIELD(Type,Item.Type::Inventory);
                                                                IF xRec."Location Code" <> "Location Code" THEN BEGIN
                                                                  IF NOT FullQtyIsForAsmToOrder THEN BEGIN
                                                                    CALCFIELDS("Reserved Qty. (Base)");
                                                                    TESTFIELD("Reserved Qty. (Base)","Qty. to Asm. to Order (Base)");
                                                                  END;
                                                                  TESTFIELD("Qty. Shipped Not Invoiced",0);
                                                                  TESTFIELD("Shipment No.",'');
                                                                  TESTFIELD("Return Qty. Rcd. Not Invd.",0);
                                                                  TESTFIELD("Return Receipt No.",'');
                                                                END;

                                                                GetSalesHeader;
                                                                "Shipment Date" :=
                                                                  CalendarMgmt.CalcDateBOC(
                                                                    '',
                                                                    SalesHeader."Shipment Date",
                                                                    CalChange."Source Type"::Location,
                                                                    "Location Code",
                                                                    '',
                                                                    CalChange."Source Type"::"Shipping Agent",
                                                                    "Shipping Agent Code",
                                                                    "Shipping Agent Service Code",
                                                                    FALSE);

                                                                CheckItemAvailable(FIELDNO("Location Code"));

                                                                IF NOT "Drop Shipment" THEN BEGIN
                                                                  IF "Location Code" = '' THEN BEGIN
                                                                    IF InvtSetup.GET THEN
                                                                      "Outbound Whse. Handling Time" := InvtSetup."Outbound Whse. Handling Time";
                                                                  END ELSE
                                                                    IF Location.GET("Location Code") THEN
                                                                      "Outbound Whse. Handling Time" := Location."Outbound Whse. Handling Time";
                                                                END ELSE
                                                                  EVALUATE("Outbound Whse. Handling Time",'<0D>');

                                                                IF "Location Code" <> xRec."Location Code" THEN BEGIN
                                                                  InitItemAppl(TRUE);
                                                                  GetDefaultBin;
                                                                  InitQtyToAsm;
                                                                  AutoAsmToOrder;
                                                                  IF Quantity <> 0 THEN BEGIN
                                                                    IF NOT "Drop Shipment" THEN
                                                                      UpdateWithWarehouseShip;
                                                                    IF NOT FullReservedQtyIsForAsmToOrder THEN
                                                                      ReserveSalesLine.VerifyChange(Rec,xRec);
                                                                    WhseValidateSourceLine.SalesLineVerifyChange(Rec,xRec);
                                                                  END;
                                                                END;

                                                                UpdateDates;

                                                                IF (Type = Type::Item) AND ("No." <> '') THEN
                                                                  GetUnitCost;

                                                                CheckWMS;

                                                                IF "Document Type" = "Document Type"::"Return Order" THEN
                                                                  ValidateReturnReasonCode(FIELDNO("Location Code"));
                                                              END;

                                                   CaptionML=[ENU=Location Code;
                                                              NOR=Lokasjonskode] }
    { 8   ;   ;Posting Group       ;Code10        ;TableRelation=IF (Type=CONST(Item)) "Inventory Posting Group"
                                                                 ELSE IF (Type=CONST(Fixed Asset)) "FA Posting Group";
                                                   CaptionML=[ENU=Posting Group;
                                                              NOR=Bokf›ringsgruppe];
                                                   Editable=No }
    { 10  ;   ;Shipment Date       ;Date          ;OnValidate=VAR
                                                                CheckDateConflict@1000 : Codeunit 99000815;
                                                              BEGIN
                                                                TestStatusOpen;
                                                                WhseValidateSourceLine.SalesLineVerifyChange(Rec,xRec);
                                                                IF CurrFieldNo <> 0 THEN
                                                                  AddOnIntegrMgt.CheckReceiptOrderStatus(Rec);

                                                                IF "Shipment Date" <> 0D THEN BEGIN
                                                                  IF CurrFieldNo IN [
                                                                                     FIELDNO("Planned Shipment Date"),
                                                                                     FIELDNO("Planned Delivery Date"),
                                                                                     FIELDNO("Shipment Date"),
                                                                                     FIELDNO("Shipping Time"),
                                                                                     FIELDNO("Outbound Whse. Handling Time"),
                                                                                     FIELDNO("Requested Delivery Date")]
                                                                  THEN
                                                                    CheckItemAvailable(FIELDNO("Shipment Date"));

                                                                  IF ("Shipment Date" < WORKDATE) AND (Type <> Type::" ") THEN
                                                                    IF NOT (HideValidationDialog OR HasBeenShown) AND GUIALLOWED THEN BEGIN
                                                                      MESSAGE(
                                                                        Text014,
                                                                        FIELDCAPTION("Shipment Date"),"Shipment Date",WORKDATE);
                                                                      HasBeenShown := TRUE;
                                                                    END;
                                                                END;

                                                                AutoAsmToOrder;
                                                                IF (xRec."Shipment Date" <> "Shipment Date") AND
                                                                   (Quantity <> 0) AND
                                                                   NOT StatusCheckSuspended
                                                                THEN
                                                                  CheckDateConflict.SalesLineCheck(Rec,CurrFieldNo <> 0);

                                                                IF NOT PlannedShipmentDateCalculated THEN
                                                                  "Planned Shipment Date" := CalcPlannedShptDate(FIELDNO("Shipment Date"));
                                                                IF NOT PlannedDeliveryDateCalculated THEN
                                                                  "Planned Delivery Date" := CalcPlannedDeliveryDate(FIELDNO("Shipment Date"));
                                                              END;

                                                   AccessByPermission=TableData 110=R;
                                                   CaptionML=[ENU=Shipment Date;
                                                              NOR=Forsendelsesdato] }
    { 11  ;   ;Description         ;Text50        ;TableRelation=IF (Type=CONST(" ")) "Standard Text"
                                                                 ELSE IF (Type=CONST(G/L Account),
                                                                          System-Created Entry=CONST(No)) "G/L Account" WHERE (Direct Posting=CONST(Yes),
                                                                                                                               Account Type=CONST(Posting),
                                                                                                                               Blocked=CONST(No))
                                                                                                                               ELSE IF (Type=CONST(G/L Account),
                                                                                                                                        System-Created Entry=CONST(Yes)) "G/L Account"
                                                                                                                                        ELSE IF (Type=CONST(Item)) Item
                                                                                                                                        ELSE IF (Type=CONST(Resource)) Resource
                                                                                                                                        ELSE IF (Type=CONST(Fixed Asset)) "Fixed Asset"
                                                                                                                                        ELSE IF (Type=CONST("Charge (Item)")) "Item Charge";
                                                   OnValidate=VAR
                                                                Item@1000 : Record 27;
                                                                TypeHelper@1005 : Codeunit 10;
                                                                ReturnValue@1001 : Text[50];
                                                                ItemDescriptionIsNo@1002 : Boolean;
                                                                DefaultCreate@1003 : Boolean;
                                                              BEGIN
                                                                IF Type = Type::" " THEN
                                                                  EXIT;

                                                                CASE Type OF
                                                                  Type::Item:
                                                                    BEGIN
                                                                      IF (STRLEN(Description) <= MAXSTRLEN(Item."No.")) AND ("No." <> '') THEN
                                                                        ItemDescriptionIsNo := Item.GET(Description)
                                                                      ELSE
                                                                        ItemDescriptionIsNo := FALSE;

                                                                      IF ("No." <> '') AND (NOT ItemDescriptionIsNo) AND (Description <> '') THEN BEGIN
                                                                        Item.SETFILTER(Description,'''@' + CONVERTSTR(Description,'''','?') + '*''');
                                                                        IF NOT Item.FINDFIRST THEN
                                                                          EXIT;
                                                                        IF Item."No." = "No." THEN
                                                                          EXIT;
                                                                        IF CONFIRM(AnotherItemWithSameDescrQst,FALSE,Item."No.",Item.Description) THEN
                                                                          VALIDATE("No.",Item."No.");
                                                                        EXIT;
                                                                      END;

                                                                      GetSalesSetup;
                                                                      DefaultCreate := ("No." = '') AND SalesSetup."Create Item from Description";
                                                                      IF Item.TryGetItemNoOpenCard(ReturnValue,Description,DefaultCreate,NOT HideValidationDialog) THEN
                                                                        CASE ReturnValue OF
                                                                          '':
                                                                            BEGIN
                                                                              LookupRequested := TRUE;
                                                                              Description := xRec.Description;
                                                                            END;
                                                                          "No.":
                                                                            Description := xRec.Description;
                                                                          ELSE BEGIN
                                                                            CurrFieldNo := FIELDNO("No.");
                                                                            VALIDATE("No.",COPYSTR(ReturnValue,1,MAXSTRLEN(Item."No.")));
                                                                          END;
                                                                        END;
                                                                    END;
                                                                  ELSE
                                                                    IF "No." = '' THEN
                                                                      IF TypeHelper.FindRecordByDescription(ReturnValue,Type,Description) = 1 THEN BEGIN
                                                                        CurrFieldNo := FIELDNO("No.");
                                                                        VALIDATE("No.",COPYSTR(ReturnValue,1,MAXSTRLEN("No.")));
                                                                      END;
                                                                END;
                                                              END;

                                                   ValidateTableRelation=No;
                                                   CaptionML=[ENU=Description;
                                                              NOR=Beskrivelse] }
    { 12  ;   ;Description 2       ;Text50        ;CaptionML=[ENU=Description 2;
                                                              NOR=Beskrivelse 2] }
    { 13  ;   ;Unit of Measure     ;Text10        ;CaptionML=[ENU=Unit of Measure;
                                                              NOR=Enhet] }
    { 15  ;   ;Quantity            ;Decimal       ;OnValidate=VAR
                                                                ItemLedgEntry@1000 : Record 32;
                                                              BEGIN
                                                                TestJobPlanningLine;
                                                                TestStatusOpen;

                                                                CheckAssocPurchOrder(FIELDCAPTION(Quantity));

                                                                IF "Shipment No." <> '' THEN
                                                                  CheckShipmentRelation
                                                                ELSE
                                                                  IF "Return Receipt No." <> '' THEN
                                                                    CheckRetRcptRelation;

                                                                "Quantity (Base)" := CalcBaseQty(Quantity);

                                                                IF "Document Type" IN ["Document Type"::"Return Order","Document Type"::"Credit Memo"] THEN BEGIN
                                                                  IF (Quantity * "Return Qty. Received" < 0) OR
                                                                     ((ABS(Quantity) < ABS("Return Qty. Received")) AND ("Return Receipt No." = ''))
                                                                  THEN
                                                                    FIELDERROR(Quantity,STRSUBSTNO(Text003,FIELDCAPTION("Return Qty. Received")));
                                                                  IF ("Quantity (Base)" * "Return Qty. Received (Base)" < 0) OR
                                                                     ((ABS("Quantity (Base)") < ABS("Return Qty. Received (Base)")) AND ("Return Receipt No." = ''))
                                                                  THEN
                                                                    FIELDERROR("Quantity (Base)",STRSUBSTNO(Text003,FIELDCAPTION("Return Qty. Received (Base)")));
                                                                END ELSE BEGIN
                                                                  IF (Quantity * "Quantity Shipped" < 0) OR
                                                                     ((ABS(Quantity) < ABS("Quantity Shipped")) AND ("Shipment No." = ''))
                                                                  THEN
                                                                    FIELDERROR(Quantity,STRSUBSTNO(Text003,FIELDCAPTION("Quantity Shipped")));
                                                                  IF ("Quantity (Base)" * "Qty. Shipped (Base)" < 0) OR
                                                                     ((ABS("Quantity (Base)") < ABS("Qty. Shipped (Base)")) AND ("Shipment No." = ''))
                                                                  THEN
                                                                    FIELDERROR("Quantity (Base)",STRSUBSTNO(Text003,FIELDCAPTION("Qty. Shipped (Base)")));
                                                                END;

                                                                IF (Type = Type::"Charge (Item)") AND (CurrFieldNo <> 0) THEN BEGIN
                                                                  IF (Quantity = 0) AND ("Qty. to Assign" <> 0) THEN
                                                                    FIELDERROR("Qty. to Assign",STRSUBSTNO(Text009,FIELDCAPTION(Quantity),Quantity));
                                                                  IF (Quantity * "Qty. Assigned" < 0) OR (ABS(Quantity) < ABS("Qty. Assigned")) THEN
                                                                    FIELDERROR(Quantity,STRSUBSTNO(Text003,FIELDCAPTION("Qty. Assigned")));
                                                                END;

                                                                AddOnIntegrMgt.CheckReceiptOrderStatus(Rec);
                                                                IF (xRec.Quantity <> Quantity) OR (xRec."Quantity (Base)" <> "Quantity (Base)") THEN BEGIN
                                                                  InitOutstanding;
                                                                  IF "Document Type" IN ["Document Type"::"Return Order","Document Type"::"Credit Memo"] THEN
                                                                    InitQtyToReceive
                                                                  ELSE
                                                                    InitQtyToShip;
                                                                  InitQtyToAsm;
                                                                  SetDefaultQuantity;
                                                                END;

                                                                CheckItemAvailable(FIELDNO(Quantity));

                                                                IF (Quantity * xRec.Quantity < 0) OR (Quantity = 0) THEN
                                                                  InitItemAppl(FALSE);

                                                                IF Type = Type::Item THEN BEGIN
                                                                  UpdateUnitPrice(FIELDNO(Quantity));
                                                                  IF (xRec.Quantity <> Quantity) OR (xRec."Quantity (Base)" <> "Quantity (Base)") THEN BEGIN
                                                                    ReserveSalesLine.VerifyQuantity(Rec,xRec);
                                                                    IF NOT "Drop Shipment" THEN
                                                                      UpdateWithWarehouseShip;
                                                                    WhseValidateSourceLine.SalesLineVerifyChange(Rec,xRec);
                                                                    IF ("Quantity (Base)" * xRec."Quantity (Base)" <= 0) AND ("No." <> '') THEN BEGIN
                                                                      GetItem;
                                                                      IF (Item."Costing Method" = Item."Costing Method"::Standard) AND NOT IsShipment THEN
                                                                        GetUnitCost;
                                                                    END;
                                                                  END;
                                                                  VALIDATE("Qty. to Assemble to Order");
                                                                  IF (Quantity = "Quantity Invoiced") AND (CurrFieldNo <> 0) THEN
                                                                    CheckItemChargeAssgnt;
                                                                  CheckApplFromItemLedgEntry(ItemLedgEntry);
                                                                END ELSE
                                                                  VALIDATE("Line Discount %");

                                                                IF (xRec.Quantity <> Quantity) AND (Quantity = 0) AND
                                                                   ((Amount <> 0) OR ("Amount Including VAT" <> 0) OR ("VAT Base Amount" <> 0))
                                                                THEN BEGIN
                                                                  Amount := 0;
                                                                  "Amount Including VAT" := 0;
                                                                  "VAT Base Amount" := 0;
                                                                END;

                                                                UpdatePrePaymentAmounts;

                                                                CheckWMS;

                                                                UpdatePlanned;
                                                              END;

                                                   CaptionML=[ENU=Quantity;
                                                              NOR=Antall];
                                                   DecimalPlaces=0:5 }
    { 16  ;   ;Outstanding Quantity;Decimal       ;CaptionML=[ENU=Outstanding Quantity;
                                                              NOR=Restantall];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 17  ;   ;Qty. to Invoice     ;Decimal       ;OnValidate=BEGIN
                                                                IF "Qty. to Invoice" = MaxQtyToInvoice THEN
                                                                  InitQtyToInvoice
                                                                ELSE
                                                                  "Qty. to Invoice (Base)" := CalcBaseQty("Qty. to Invoice");
                                                                IF ("Qty. to Invoice" * Quantity < 0) OR
                                                                   (ABS("Qty. to Invoice") > ABS(MaxQtyToInvoice))
                                                                THEN
                                                                  ERROR(
                                                                    Text005,
                                                                    MaxQtyToInvoice);
                                                                IF ("Qty. to Invoice (Base)" * "Quantity (Base)" < 0) OR
                                                                   (ABS("Qty. to Invoice (Base)") > ABS(MaxQtyToInvoiceBase))
                                                                THEN
                                                                  ERROR(
                                                                    Text006,
                                                                    MaxQtyToInvoiceBase);
                                                                "VAT Difference" := 0;
                                                                CalcInvDiscToInvoice;
                                                                CalcPrepaymentToDeduct;
                                                              END;

                                                   CaptionML=[ENU=Qty. to Invoice;
                                                              NOR=Fakturer (antall)];
                                                   DecimalPlaces=0:5 }
    { 18  ;   ;Qty. to Ship        ;Decimal       ;OnValidate=VAR
                                                                ItemLedgEntry@1000 : Record 32;
                                                              BEGIN
                                                                GetLocation("Location Code");
                                                                IF (CurrFieldNo <> 0) AND
                                                                   (Type = Type::Item) AND
                                                                   (NOT "Drop Shipment")
                                                                THEN BEGIN
                                                                  IF Location."Require Shipment" AND
                                                                     ("Qty. to Ship" <> 0)
                                                                  THEN
                                                                    CheckWarehouse;
                                                                  WhseValidateSourceLine.SalesLineVerifyChange(Rec,xRec);
                                                                END;

                                                                IF "Qty. to Ship" = "Outstanding Quantity" THEN
                                                                  InitQtyToShip
                                                                ELSE BEGIN
                                                                  "Qty. to Ship (Base)" := CalcBaseQty("Qty. to Ship");
                                                                  CheckServItemCreation;
                                                                  InitQtyToInvoice;
                                                                END;
                                                                IF ((("Qty. to Ship" < 0) XOR (Quantity < 0)) AND (Quantity <> 0) AND ("Qty. to Ship" <> 0)) OR
                                                                   (ABS("Qty. to Ship") > ABS("Outstanding Quantity")) OR
                                                                   (((Quantity < 0) XOR ("Outstanding Quantity" < 0)) AND (Quantity <> 0) AND ("Outstanding Quantity" <> 0))
                                                                THEN
                                                                  ERROR(
                                                                    Text007,
                                                                    "Outstanding Quantity");
                                                                IF ((("Qty. to Ship (Base)" < 0) XOR ("Quantity (Base)" < 0)) AND ("Qty. to Ship (Base)" <> 0) AND ("Quantity (Base)" <> 0)) OR
                                                                   (ABS("Qty. to Ship (Base)") > ABS("Outstanding Qty. (Base)")) OR
                                                                   ((("Quantity (Base)" < 0) XOR ("Outstanding Qty. (Base)" < 0)) AND ("Quantity (Base)" <> 0) AND ("Outstanding Qty. (Base)" <> 0))
                                                                THEN
                                                                  ERROR(
                                                                    Text008,
                                                                    "Outstanding Qty. (Base)");

                                                                IF (CurrFieldNo <> 0) AND (Type = Type::Item) AND ("Qty. to Ship" < 0) THEN
                                                                  CheckApplFromItemLedgEntry(ItemLedgEntry);

                                                                ATOLink.UpdateQtyToAsmFromSalesLine(Rec);
                                                              END;

                                                   AccessByPermission=TableData 110=R;
                                                   CaptionML=[ENU=Qty. to Ship;
                                                              NOR=Levere (antall)];
                                                   DecimalPlaces=0:5 }
    { 22  ;   ;Unit Price          ;Decimal       ;OnValidate=BEGIN
                                                                TestJobPlanningLine;
                                                                TestStatusOpen;
                                                                VALIDATE("Line Discount %");
                                                              END;

                                                   CaptionML=[ENU=Unit Price;
                                                              NOR=Salgspris];
                                                   AutoFormatType=2;
                                                   AutoFormatExpr="Currency Code";
                                                   CaptionClass=GetCaptionClass(FIELDNO("Unit Price")) }
    { 23  ;   ;Unit Cost (LCY)     ;Decimal       ;OnValidate=BEGIN
                                                                IF (CurrFieldNo = FIELDNO("Unit Cost (LCY)")) AND
                                                                   ("Unit Cost (LCY)" <> xRec."Unit Cost (LCY)")
                                                                THEN
                                                                  CheckAssocPurchOrder(FIELDCAPTION("Unit Cost (LCY)"));

                                                                IF (CurrFieldNo = FIELDNO("Unit Cost (LCY)")) AND
                                                                   (Type = Type::Item) AND ("No." <> '') AND ("Quantity (Base)" <> 0)
                                                                THEN BEGIN
                                                                  TestJobPlanningLine;
                                                                  GetItem;
                                                                  IF (Item."Costing Method" = Item."Costing Method"::Standard) AND NOT IsShipment THEN BEGIN
                                                                    IF "Document Type" IN ["Document Type"::"Return Order","Document Type"::"Credit Memo"] THEN
                                                                      ERROR(
                                                                        Text037,
                                                                        FIELDCAPTION("Unit Cost (LCY)"),Item.FIELDCAPTION("Costing Method"),
                                                                        Item."Costing Method",FIELDCAPTION(Quantity));
                                                                    ERROR(
                                                                      Text038,
                                                                      FIELDCAPTION("Unit Cost (LCY)"),Item.FIELDCAPTION("Costing Method"),
                                                                      Item."Costing Method",FIELDCAPTION(Quantity));
                                                                  END;
                                                                END;

                                                                GetSalesHeader;
                                                                IF SalesHeader."Currency Code" <> '' THEN BEGIN
                                                                  Currency.TESTFIELD("Unit-Amount Rounding Precision");
                                                                  "Unit Cost" :=
                                                                    ROUND(
                                                                      CurrExchRate.ExchangeAmtLCYToFCY(
                                                                        GetDate,SalesHeader."Currency Code",
                                                                        "Unit Cost (LCY)",SalesHeader."Currency Factor"),
                                                                      Currency."Unit-Amount Rounding Precision")
                                                                END ELSE
                                                                  "Unit Cost" := "Unit Cost (LCY)";
                                                              END;

                                                   CaptionML=[ENU=Unit Cost (LCY);
                                                              NOR=Enhetskost (NOK)];
                                                   AutoFormatType=2 }
    { 25  ;   ;VAT %               ;Decimal       ;CaptionML=[ENU=VAT %;
                                                              NOR=Mva-%];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 27  ;   ;Line Discount %     ;Decimal       ;OnValidate=BEGIN
                                                                TestJobPlanningLine;
                                                                TestStatusOpen;
                                                                "Line Discount Amount" :=
                                                                  ROUND(
                                                                    ROUND(Quantity * "Unit Price",Currency."Amount Rounding Precision") *
                                                                    "Line Discount %" / 100,Currency."Amount Rounding Precision");
                                                                "Inv. Discount Amount" := 0;
                                                                "Inv. Disc. Amount to Invoice" := 0;
                                                                UpdateAmounts;
                                                              END;

                                                   CaptionML=[ENU=Line Discount %;
                                                              NOR=Linjerabatt-%];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0;
                                                   MaxValue=100 }
    { 28  ;   ;Line Discount Amount;Decimal       ;OnValidate=BEGIN
                                                                GetSalesHeader;
                                                                "Line Discount Amount" := ROUND("Line Discount Amount",Currency."Amount Rounding Precision");
                                                                TestJobPlanningLine;
                                                                TestStatusOpen;
                                                                TESTFIELD(Quantity);
                                                                IF xRec."Line Discount Amount" <> "Line Discount Amount" THEN
                                                                  IF ROUND(Quantity * "Unit Price",Currency."Amount Rounding Precision") <> 0 THEN
                                                                    "Line Discount %" :=
                                                                      ROUND(
                                                                        "Line Discount Amount" / ROUND(Quantity * "Unit Price",Currency."Amount Rounding Precision") * 100,
                                                                        0.00001)
                                                                  ELSE
                                                                    "Line Discount %" := 0;
                                                                "Inv. Discount Amount" := 0;
                                                                "Inv. Disc. Amount to Invoice" := 0;
                                                                UpdateAmounts;
                                                              END;

                                                   CaptionML=[ENU=Line Discount Amount;
                                                              NOR=Linjerabattbel›p];
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 29  ;   ;Amount              ;Decimal       ;OnValidate=BEGIN
                                                                Amount := ROUND(Amount,Currency."Amount Rounding Precision");
                                                                CASE "VAT Calculation Type" OF
                                                                  "VAT Calculation Type"::"Normal VAT",
                                                                  "VAT Calculation Type"::"Reverse Charge VAT":
                                                                    BEGIN
                                                                      "VAT Base Amount" :=
                                                                        ROUND(Amount * (1 - SalesHeader."VAT Base Discount %" / 100),Currency."Amount Rounding Precision");
                                                                      "Amount Including VAT" :=
                                                                        ROUND(Amount + "VAT Base Amount" * "VAT %" / 100,Currency."Amount Rounding Precision");
                                                                    END;
                                                                  "VAT Calculation Type"::"Full VAT":
                                                                    IF Amount <> 0 THEN
                                                                      FIELDERROR(Amount,
                                                                        STRSUBSTNO(
                                                                          Text009,FIELDCAPTION("VAT Calculation Type"),
                                                                          "VAT Calculation Type"));
                                                                  "VAT Calculation Type"::"Sales Tax":
                                                                    BEGIN
                                                                      SalesHeader.TESTFIELD("VAT Base Discount %",0);
                                                                      "VAT Base Amount" := ROUND(Amount,Currency."Amount Rounding Precision");
                                                                      "Amount Including VAT" :=
                                                                        Amount +
                                                                        SalesTaxCalculate.CalculateTax(
                                                                          "Tax Area Code","Tax Group Code","Tax Liable",SalesHeader."Posting Date",
                                                                          "VAT Base Amount","Quantity (Base)",SalesHeader."Currency Factor");
                                                                      IF "VAT Base Amount" <> 0 THEN
                                                                        "VAT %" :=
                                                                          ROUND(100 * ("Amount Including VAT" - "VAT Base Amount") / "VAT Base Amount",0.00001)
                                                                      ELSE
                                                                        "VAT %" := 0;
                                                                      "Amount Including VAT" := ROUND("Amount Including VAT",Currency."Amount Rounding Precision");
                                                                    END;
                                                                END;

                                                                InitOutstandingAmount;
                                                              END;

                                                   CaptionML=[ENU=Amount;
                                                              NOR=Bel›p];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 30  ;   ;Amount Including VAT;Decimal       ;OnValidate=BEGIN
                                                                "Amount Including VAT" := ROUND("Amount Including VAT",Currency."Amount Rounding Precision");
                                                                CASE "VAT Calculation Type" OF
                                                                  "VAT Calculation Type"::"Normal VAT",
                                                                  "VAT Calculation Type"::"Reverse Charge VAT":
                                                                    BEGIN
                                                                      Amount :=
                                                                        ROUND(
                                                                          "Amount Including VAT" /
                                                                          (1 + (1 - SalesHeader."VAT Base Discount %" / 100) * "VAT %" / 100),
                                                                          Currency."Amount Rounding Precision");
                                                                      "VAT Base Amount" :=
                                                                        ROUND(Amount * (1 - SalesHeader."VAT Base Discount %" / 100),Currency."Amount Rounding Precision");
                                                                    END;
                                                                  "VAT Calculation Type"::"Full VAT":
                                                                    BEGIN
                                                                      Amount := 0;
                                                                      "VAT Base Amount" := 0;
                                                                    END;
                                                                  "VAT Calculation Type"::"Sales Tax":
                                                                    BEGIN
                                                                      SalesHeader.TESTFIELD("VAT Base Discount %",0);
                                                                      Amount :=
                                                                        SalesTaxCalculate.ReverseCalculateTax(
                                                                          "Tax Area Code","Tax Group Code","Tax Liable",SalesHeader."Posting Date",
                                                                          "Amount Including VAT","Quantity (Base)",SalesHeader."Currency Factor");
                                                                      IF Amount <> 0 THEN
                                                                        "VAT %" :=
                                                                          ROUND(100 * ("Amount Including VAT" - Amount) / Amount,0.00001)
                                                                      ELSE
                                                                        "VAT %" := 0;
                                                                      Amount := ROUND(Amount,Currency."Amount Rounding Precision");
                                                                      "VAT Base Amount" := Amount;
                                                                    END;
                                                                END;

                                                                InitOutstandingAmount;
                                                              END;

                                                   CaptionML=[ENU=Amount Including VAT;
                                                              NOR=Bel›p inkl. mva.];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 32  ;   ;Allow Invoice Disc. ;Boolean       ;InitValue=Yes;
                                                   OnValidate=BEGIN
                                                                TestStatusOpen;
                                                                IF ("Allow Invoice Disc." <> xRec."Allow Invoice Disc.") AND
                                                                   (NOT "Allow Invoice Disc.")
                                                                THEN BEGIN
                                                                  "Inv. Discount Amount" := 0;
                                                                  "Inv. Disc. Amount to Invoice" := 0;
                                                                  UpdateAmounts;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Allow Invoice Disc.;
                                                              NOR=Tillat fakturarabatt] }
    { 34  ;   ;Gross Weight        ;Decimal       ;CaptionML=[ENU=Gross Weight;
                                                              NOR=Bruttovekt];
                                                   DecimalPlaces=0:5 }
    { 35  ;   ;Net Weight          ;Decimal       ;CaptionML=[ENU=Net Weight;
                                                              NOR=Nettovekt];
                                                   DecimalPlaces=0:5 }
    { 36  ;   ;Units per Parcel    ;Decimal       ;CaptionML=[ENU=Units per Parcel;
                                                              NOR=Antall per kolli];
                                                   DecimalPlaces=0:5 }
    { 37  ;   ;Unit Volume         ;Decimal       ;CaptionML=[ENU=Unit Volume;
                                                              NOR=Volum];
                                                   DecimalPlaces=0:5 }
    { 38  ;   ;Appl.-to Item Entry ;Integer       ;OnValidate=VAR
                                                                ItemLedgEntry@1000 : Record 32;
                                                                ItemTrackingLines@1001 : Page 6510;
                                                              BEGIN
                                                                IF "Appl.-to Item Entry" <> 0 THEN BEGIN
                                                                  AddOnIntegrMgt.CheckReceiptOrderStatus(Rec);

                                                                  TESTFIELD(Type,Type::Item);
                                                                  TESTFIELD(Quantity);
                                                                  IF "Document Type" IN ["Document Type"::"Return Order","Document Type"::"Credit Memo"] THEN BEGIN
                                                                    IF Quantity > 0 THEN
                                                                      FIELDERROR(Quantity,Text030);
                                                                  END ELSE BEGIN
                                                                    IF Quantity < 0 THEN
                                                                      FIELDERROR(Quantity,Text029);
                                                                  END;
                                                                  ItemLedgEntry.GET("Appl.-to Item Entry");
                                                                  ItemLedgEntry.TESTFIELD(Positive,TRUE);
                                                                  IF ItemLedgEntry.TrackingExists THEN
                                                                    ERROR(Text040,ItemTrackingLines.CAPTION,FIELDCAPTION("Appl.-to Item Entry"));
                                                                  IF ABS("Qty. to Ship (Base)") > ItemLedgEntry.Quantity THEN
                                                                    ERROR(ShippingMoreUnitsThanReceivedErr,ItemLedgEntry.Quantity,ItemLedgEntry."Document No.");

                                                                  VALIDATE("Unit Cost (LCY)",CalcUnitCost(ItemLedgEntry));

                                                                  "Location Code" := ItemLedgEntry."Location Code";
                                                                  IF NOT ItemLedgEntry.Open THEN
                                                                    MESSAGE(Text042,"Appl.-to Item Entry");
                                                                END;
                                                              END;

                                                   OnLookup=BEGIN
                                                              SelectItemEntry(FIELDNO("Appl.-to Item Entry"));
                                                            END;

                                                   AccessByPermission=TableData 27=R;
                                                   CaptionML=[ENU=Appl.-to Item Entry;
                                                              NOR=Utligningsvarepost] }
    { 40  ;   ;Shortcut Dimension 1 Code;Code20   ;TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(1));
                                                   OnValidate=BEGIN
                                                                ValidateShortcutDimCode(1,"Shortcut Dimension 1 Code");
                                                                ATOLink.UpdateAsmDimFromSalesLine(Rec);
                                                              END;

                                                   CaptionML=[ENU=Shortcut Dimension 1 Code;
                                                              NOR=Snarveisdimensjon 1 - kode];
                                                   CaptionClass='1,2,1' }
    { 41  ;   ;Shortcut Dimension 2 Code;Code20   ;TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(2));
                                                   OnValidate=BEGIN
                                                                ValidateShortcutDimCode(2,"Shortcut Dimension 2 Code");
                                                                ATOLink.UpdateAsmDimFromSalesLine(Rec);
                                                              END;

                                                   CaptionML=[ENU=Shortcut Dimension 2 Code;
                                                              NOR=Snarveisdimensjon 2 - kode];
                                                   CaptionClass='1,2,2' }
    { 42  ;   ;Customer Price Group;Code10        ;TableRelation="Customer Price Group";
                                                   OnValidate=BEGIN
                                                                IF Type = Type::Item THEN
                                                                  UpdateUnitPrice(FIELDNO("Customer Price Group"));
                                                              END;

                                                   CaptionML=[ENU=Customer Price Group;
                                                              NOR=Kundeprisgruppe];
                                                   Editable=No }
    { 45  ;   ;Job No.             ;Code20        ;TableRelation=Job;
                                                   CaptionML=[ENU=Job No.;
                                                              NOR=Prosjektnr.];
                                                   Editable=No }
    { 52  ;   ;Work Type Code      ;Code10        ;TableRelation="Work Type";
                                                   OnValidate=VAR
                                                                WorkType@1000 : Record 200;
                                                              BEGIN
                                                                IF Type = Type::Resource THEN BEGIN
                                                                  TestStatusOpen;
                                                                  IF WorkType.GET("Work Type Code") THEN
                                                                    VALIDATE("Unit of Measure Code",WorkType."Unit of Measure Code");
                                                                  UpdateUnitPrice(FIELDNO("Work Type Code"));
                                                                  VALIDATE("Unit Price");
                                                                  FindResUnitCost;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Work Type Code;
                                                              NOR=Arbeidstypekode] }
    { 56  ;   ;Recalculate Invoice Disc.;Boolean  ;CaptionML=[ENU=Recalculate Invoice Disc.;
                                                              NOR=Beregn fakturarabatt p† nytt];
                                                   Editable=No }
    { 57  ;   ;Outstanding Amount  ;Decimal       ;OnValidate=VAR
                                                                Currency2@1000 : Record 4;
                                                              BEGIN
                                                                GetSalesHeader;
                                                                Currency2.InitRoundingPrecision;
                                                                IF SalesHeader."Currency Code" <> '' THEN
                                                                  "Outstanding Amount (LCY)" :=
                                                                    ROUND(
                                                                      CurrExchRate.ExchangeAmtFCYToLCY(
                                                                        GetDate,"Currency Code",
                                                                        "Outstanding Amount",SalesHeader."Currency Factor"),
                                                                      Currency2."Amount Rounding Precision")
                                                                ELSE
                                                                  "Outstanding Amount (LCY)" :=
                                                                    ROUND("Outstanding Amount",Currency2."Amount Rounding Precision");
                                                              END;

                                                   CaptionML=[ENU=Outstanding Amount;
                                                              NOR=Utest†ende bel›p];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 58  ;   ;Qty. Shipped Not Invoiced;Decimal  ;CaptionML=[ENU=Qty. Shipped Not Invoiced;
                                                              NOR=Antall levert, ikke fakturert];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 59  ;   ;Shipped Not Invoiced;Decimal       ;OnValidate=VAR
                                                                Currency2@1000 : Record 4;
                                                              BEGIN
                                                                GetSalesHeader;
                                                                Currency2.InitRoundingPrecision;
                                                                IF SalesHeader."Currency Code" <> '' THEN
                                                                  "Shipped Not Invoiced (LCY)" :=
                                                                    ROUND(
                                                                      CurrExchRate.ExchangeAmtFCYToLCY(
                                                                        GetDate,"Currency Code",
                                                                        "Shipped Not Invoiced",SalesHeader."Currency Factor"),
                                                                      Currency2."Amount Rounding Precision")
                                                                ELSE
                                                                  "Shipped Not Invoiced (LCY)" :=
                                                                    ROUND("Shipped Not Invoiced",Currency2."Amount Rounding Precision");
                                                              END;

                                                   CaptionML=[ENU=Shipped Not Invoiced;
                                                              NOR=Levert, ikke fakturert];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 60  ;   ;Quantity Shipped    ;Decimal       ;AccessByPermission=TableData 110=R;
                                                   CaptionML=[ENU=Quantity Shipped;
                                                              NOR=Levert (antall)];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 61  ;   ;Quantity Invoiced   ;Decimal       ;CaptionML=[ENU=Quantity Invoiced;
                                                              NOR=Fakturert (antall)];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 63  ;   ;Shipment No.        ;Code20        ;CaptionML=[ENU=Shipment No.;
                                                              NOR=F›lgeseddelnr.];
                                                   Editable=No }
    { 64  ;   ;Shipment Line No.   ;Integer       ;CaptionML=[ENU=Shipment Line No.;
                                                              NOR=F›lges.linjenr.];
                                                   Editable=No }
    { 67  ;   ;Profit %            ;Decimal       ;CaptionML=[ENU=Profit %;
                                                              NOR=Bruttofortjeneste-%];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 68  ;   ;Bill-to Customer No.;Code20        ;TableRelation=Customer;
                                                   CaptionML=[ENU=Bill-to Customer No.;
                                                              NOR=Faktura til-kundenr.];
                                                   Editable=No }
    { 69  ;   ;Inv. Discount Amount;Decimal       ;OnValidate=BEGIN
                                                                CalcInvDiscToInvoice;
                                                                UpdateAmounts;
                                                              END;

                                                   CaptionML=[ENU=Inv. Discount Amount;
                                                              NOR=Fakturarabattbel›p];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code";
                                                   CaptionClass=GetCaptionClass(FIELDNO("Inv. Discount Amount")) }
    { 71  ;   ;Purchase Order No.  ;Code20        ;TableRelation=IF (Drop Shipment=CONST(Yes)) "Purchase Header".No. WHERE (Document Type=CONST(Order));
                                                   OnValidate=BEGIN
                                                                IF (xRec."Purchase Order No." <> "Purchase Order No.") AND (Quantity <> 0) THEN BEGIN
                                                                  ReserveSalesLine.VerifyChange(Rec,xRec);
                                                                  WhseValidateSourceLine.SalesLineVerifyChange(Rec,xRec);
                                                                END;
                                                              END;

                                                   AccessByPermission=TableData 110=R;
                                                   CaptionML=[ENU=Purchase Order No.;
                                                              NOR=Bestillingsnr.];
                                                   Editable=No }
    { 72  ;   ;Purch. Order Line No.;Integer      ;TableRelation=IF (Drop Shipment=CONST(Yes)) "Purchase Line"."Line No." WHERE (Document Type=CONST(Order),
                                                                                                                                 Document No.=FIELD(Purchase Order No.));
                                                   OnValidate=BEGIN
                                                                IF (xRec."Purch. Order Line No." <> "Purch. Order Line No.") AND (Quantity <> 0) THEN BEGIN
                                                                  ReserveSalesLine.VerifyChange(Rec,xRec);
                                                                  WhseValidateSourceLine.SalesLineVerifyChange(Rec,xRec);
                                                                END;
                                                              END;

                                                   AccessByPermission=TableData 110=R;
                                                   CaptionML=[ENU=Purch. Order Line No.;
                                                              NOR=Bestillingslinjenr.];
                                                   Editable=No }
    { 73  ;   ;Drop Shipment       ;Boolean       ;OnValidate=BEGIN
                                                                TESTFIELD("Document Type","Document Type"::Order);
                                                                TESTFIELD(Type,Type::Item);
                                                                TESTFIELD("Quantity Shipped",0);
                                                                TESTFIELD("Job No.",'');
                                                                TESTFIELD("Qty. to Asm. to Order (Base)",0);

                                                                IF "Drop Shipment" THEN
                                                                  TESTFIELD("Special Order",FALSE);

                                                                CheckAssocPurchOrder(FIELDCAPTION("Drop Shipment"));

                                                                IF "Special Order" THEN
                                                                  Reserve := Reserve::Never
                                                                ELSE
                                                                  IF "Drop Shipment" THEN BEGIN
                                                                    Reserve := Reserve::Never;
                                                                    VALIDATE(Quantity,Quantity);
                                                                    IF "Drop Shipment" THEN BEGIN
                                                                      EVALUATE("Outbound Whse. Handling Time",'<0D>');
                                                                      EVALUATE("Shipping Time",'<0D>');
                                                                      UpdateDates;
                                                                      "Bin Code" := '';
                                                                    END;
                                                                  END ELSE
                                                                    SetReserveWithoutPurchasingCode;

                                                                CheckItemAvailable(FIELDNO("Drop Shipment"));

                                                                AddOnIntegrMgt.CheckReceiptOrderStatus(Rec);
                                                                IF (xRec."Drop Shipment" <> "Drop Shipment") AND (Quantity <> 0) THEN BEGIN
                                                                  IF NOT "Drop Shipment" THEN BEGIN
                                                                    InitQtyToAsm;
                                                                    AutoAsmToOrder;
                                                                    UpdateWithWarehouseShip
                                                                  END ELSE
                                                                    InitQtyToShip;
                                                                  WhseValidateSourceLine.SalesLineVerifyChange(Rec,xRec);
                                                                  IF NOT FullReservedQtyIsForAsmToOrder THEN
                                                                    ReserveSalesLine.VerifyChange(Rec,xRec);
                                                                END;
                                                              END;

                                                   AccessByPermission=TableData 223=R;
                                                   CaptionML=[ENU=Drop Shipment;
                                                              NOR=Direkte levering];
                                                   Editable=Yes }
    { 74  ;   ;Gen. Bus. Posting Group;Code10     ;TableRelation="Gen. Business Posting Group";
                                                   OnValidate=BEGIN
                                                                IF xRec."Gen. Bus. Posting Group" <> "Gen. Bus. Posting Group" THEN
                                                                  IF GenBusPostingGrp.ValidateVatBusPostingGroup(GenBusPostingGrp,"Gen. Bus. Posting Group") THEN
                                                                    VALIDATE("VAT Bus. Posting Group",GenBusPostingGrp."Def. VAT Bus. Posting Group");
                                                              END;

                                                   CaptionML=[ENU=Gen. Bus. Posting Group;
                                                              NOR=Bokf›ringsgruppe - firma] }
    { 75  ;   ;Gen. Prod. Posting Group;Code10    ;TableRelation="Gen. Product Posting Group";
                                                   OnValidate=BEGIN
                                                                TestJobPlanningLine;
                                                                TestStatusOpen;
                                                                IF xRec."Gen. Prod. Posting Group" <> "Gen. Prod. Posting Group" THEN
                                                                  IF GenProdPostingGrp.ValidateVatProdPostingGroup(GenProdPostingGrp,"Gen. Prod. Posting Group") THEN
                                                                    VALIDATE("VAT Prod. Posting Group",GenProdPostingGrp."Def. VAT Prod. Posting Group");
                                                              END;

                                                   CaptionML=[ENU=Gen. Prod. Posting Group;
                                                              NOR=Bokf›ringsgruppe - vare] }
    { 77  ;   ;VAT Calculation Type;Option        ;CaptionML=[ENU=VAT Calculation Type;
                                                              NOR=Mva-beregningstype];
                                                   OptionCaptionML=[ENU=Normal VAT,Reverse Charge VAT,Full VAT,Sales Tax;
                                                                    NOR=Normal mva.,Snudd avregning,Full mva.,Salgsmva.];
                                                   OptionString=Normal VAT,Reverse Charge VAT,Full VAT,Sales Tax;
                                                   Editable=No }
    { 78  ;   ;Transaction Type    ;Code10        ;TableRelation="Transaction Type";
                                                   CaptionML=[ENU=Transaction Type;
                                                              NOR=Transaksjonsart] }
    { 79  ;   ;Transport Method    ;Code10        ;TableRelation="Transport Method";
                                                   CaptionML=[ENU=Transport Method;
                                                              NOR=Transportm†te] }
    { 80  ;   ;Attached to Line No.;Integer       ;TableRelation="Sales Line"."Line No." WHERE (Document Type=FIELD(Document Type),
                                                                                                Document No.=FIELD(Document No.));
                                                   CaptionML=[ENU=Attached to Line No.;
                                                              NOR=Knyttet til linjenr.];
                                                   Editable=No }
    { 81  ;   ;Exit Point          ;Code10        ;TableRelation="Entry/Exit Point";
                                                   CaptionML=[ENU=Exit Point;
                                                              NOR=Utpunkt] }
    { 82  ;   ;Area                ;Code10        ;TableRelation=Area;
                                                   CaptionML=[ENU=Area;
                                                              NOR=Omr†de] }
    { 83  ;   ;Transaction Specification;Code10   ;TableRelation="Transaction Specification";
                                                   CaptionML=[ENU=Transaction Specification;
                                                              NOR=Transaksjonsspesifikasjon] }
    { 84  ;   ;Tax Category        ;Code10        ;CaptionML=[ENU=Tax Category;
                                                              NOR=Avgiftskategori] }
    { 85  ;   ;Tax Area Code       ;Code20        ;TableRelation="Tax Area";
                                                   OnValidate=BEGIN
                                                                UpdateAmounts;
                                                              END;

                                                   CaptionML=[ENU=Tax Area Code;
                                                              NOR=Mva-omr†dekode] }
    { 86  ;   ;Tax Liable          ;Boolean       ;OnValidate=BEGIN
                                                                UpdateAmounts;
                                                              END;

                                                   CaptionML=[ENU=Tax Liable;
                                                              NOR=Skyldig mva.] }
    { 87  ;   ;Tax Group Code      ;Code10        ;TableRelation="Tax Group";
                                                   OnValidate=BEGIN
                                                                TestStatusOpen;
                                                                ValidateTaxGroupCode;
                                                                UpdateAmounts;
                                                              END;

                                                   ValidateTableRelation=No;
                                                   CaptionML=[ENU=Tax Group Code;
                                                              NOR=Mva-gruppekode] }
    { 88  ;   ;VAT Clause Code     ;Code10        ;TableRelation="VAT Clause";
                                                   CaptionML=[ENU=VAT Clause Code;
                                                              NOR=Mva-setningskode] }
    { 89  ;   ;VAT Bus. Posting Group;Code10      ;TableRelation="VAT Business Posting Group";
                                                   OnValidate=BEGIN
                                                                VALIDATE("VAT Prod. Posting Group");
                                                                NorwegianVATTools.InitVATCode_SalesLine(Rec);
                                                              END;

                                                   CaptionML=[ENU=VAT Bus. Posting Group;
                                                              NOR=Mva-bokf›ringsgruppe - firma] }
    { 90  ;   ;VAT Prod. Posting Group;Code10     ;TableRelation="VAT Product Posting Group";
                                                   OnValidate=BEGIN
                                                                TestStatusOpen;
                                                                VATPostingSetup.GET("VAT Bus. Posting Group","VAT Prod. Posting Group");
                                                                "VAT Difference" := 0;
                                                                "VAT %" := VATPostingSetup."VAT %";
                                                                "VAT Calculation Type" := VATPostingSetup."VAT Calculation Type";
                                                                "VAT Identifier" := VATPostingSetup."VAT Identifier";
                                                                "VAT Clause Code" := VATPostingSetup."VAT Clause Code";
                                                                CASE "VAT Calculation Type" OF
                                                                  "VAT Calculation Type"::"Reverse Charge VAT",
                                                                  "VAT Calculation Type"::"Sales Tax":
                                                                    "VAT %" := 0;
                                                                  "VAT Calculation Type"::"Full VAT":
                                                                    BEGIN
                                                                      TESTFIELD(Type,Type::"G/L Account");
                                                                      VATPostingSetup.TESTFIELD("Sales VAT Account");
                                                                      TESTFIELD("No.",VATPostingSetup."Sales VAT Account");
                                                                    END;
                                                                END;
                                                                IF SalesHeader."Prices Including VAT" AND (Type IN [Type::Item,Type::Resource]) THEN
                                                                  "Unit Price" :=
                                                                    ROUND(
                                                                      "Unit Price" * (100 + "VAT %") / (100 + xRec."VAT %"),
                                                                      Currency."Unit-Amount Rounding Precision");
                                                                UpdateAmounts;
                                                                NorwegianVATTools.InitVATCode_SalesLine(Rec);
                                                              END;

                                                   CaptionML=[ENU=VAT Prod. Posting Group;
                                                              NOR=Mva-bokf›ringsgruppe - vare] }
    { 91  ;   ;Currency Code       ;Code10        ;TableRelation=Currency;
                                                   CaptionML=[ENU=Currency Code;
                                                              NOR=Valutakode];
                                                   Editable=No }
    { 92  ;   ;Outstanding Amount (LCY);Decimal   ;CaptionML=[ENU=Outstanding Amount (LCY);
                                                              NOR=Utest†ende bel›p (NOK)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 93  ;   ;Shipped Not Invoiced (LCY);Decimal ;CaptionML=[ENU=Shipped Not Invoiced (LCY);
                                                              NOR=Levert, ikke fakturert (NOK)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 95  ;   ;Reserved Quantity   ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Reservation Entry".Quantity WHERE (Source ID=FIELD(Document No.),
                                                                                                        Source Ref. No.=FIELD(Line No.),
                                                                                                        Source Type=CONST(37),
                                                                                                        Source Subtype=FIELD(Document Type),
                                                                                                        Reservation Status=CONST(Reservation)));
                                                   AccessByPermission=TableData 110=R;
                                                   CaptionML=[ENU=Reserved Quantity;
                                                              NOR=Reservert antall];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 96  ;   ;Reserve             ;Option        ;OnValidate=BEGIN
                                                                IF Reserve <> Reserve::Never THEN BEGIN
                                                                  TESTFIELD(Type,Type::Item);
                                                                  TESTFIELD("No.");
                                                                END;
                                                                CALCFIELDS("Reserved Qty. (Base)");
                                                                IF (Reserve = Reserve::Never) AND ("Reserved Qty. (Base)" > 0) THEN
                                                                  TESTFIELD("Reserved Qty. (Base)",0);

                                                                IF "Drop Shipment" OR "Special Order" THEN
                                                                  TESTFIELD(Reserve,Reserve::Never);
                                                                IF xRec.Reserve = Reserve::Always THEN BEGIN
                                                                  GetItem;
                                                                  IF Item.Reserve = Item.Reserve::Always THEN
                                                                    TESTFIELD(Reserve,Reserve::Always);
                                                                END;
                                                              END;

                                                   AccessByPermission=TableData 27=R;
                                                   CaptionML=[ENU=Reserve;
                                                              NOR=Reserver];
                                                   OptionCaptionML=[ENU=Never,Optional,Always;
                                                                    NOR=Aldri,Alternativt,Alltid];
                                                   OptionString=Never,Optional,Always }
    { 97  ;   ;Blanket Order No.   ;Code20        ;TableRelation="Sales Header".No. WHERE (Document Type=CONST(Blanket Order));
                                                   OnValidate=BEGIN
                                                                TESTFIELD("Quantity Shipped",0);
                                                                IF "Blanket Order No." = '' THEN
                                                                  "Blanket Order Line No." := 0
                                                                ELSE
                                                                  VALIDATE("Blanket Order Line No.");
                                                              END;

                                                   OnLookup=BEGIN
                                                              BlanketOrderLookup;
                                                            END;

                                                   TestTableRelation=No;
                                                   AccessByPermission=TableData 110=R;
                                                   CaptionML=[ENU=Blanket Order No.;
                                                              NOR=Rammeordrenr.] }
    { 98  ;   ;Blanket Order Line No.;Integer     ;TableRelation="Sales Line"."Line No." WHERE (Document Type=CONST(Blanket Order),
                                                                                                Document No.=FIELD(Blanket Order No.));
                                                   OnValidate=BEGIN
                                                                TESTFIELD("Quantity Shipped",0);
                                                                IF "Blanket Order Line No." <> 0 THEN BEGIN
                                                                  SalesLine2.GET("Document Type"::"Blanket Order","Blanket Order No.","Blanket Order Line No.");
                                                                  SalesLine2.TESTFIELD(Type,Type);
                                                                  SalesLine2.TESTFIELD("No.","No.");
                                                                  SalesLine2.TESTFIELD("Bill-to Customer No.","Bill-to Customer No.");
                                                                  SalesLine2.TESTFIELD("Sell-to Customer No.","Sell-to Customer No.");
                                                                  VALIDATE("Variant Code",SalesLine2."Variant Code");
                                                                  VALIDATE("Location Code",SalesLine2."Location Code");
                                                                  VALIDATE("Unit of Measure Code",SalesLine2."Unit of Measure Code");
                                                                  VALIDATE("Unit Price",SalesLine2."Unit Price");
                                                                  VALIDATE("Line Discount %",SalesLine2."Line Discount %");
                                                                END;
                                                              END;

                                                   OnLookup=BEGIN
                                                              BlanketOrderLookup;
                                                            END;

                                                   TestTableRelation=No;
                                                   AccessByPermission=TableData 110=R;
                                                   CaptionML=[ENU=Blanket Order Line No.;
                                                              NOR=Rammeordrelinjenr.] }
    { 99  ;   ;VAT Base Amount     ;Decimal       ;CaptionML=[ENU=VAT Base Amount;
                                                              NOR=Mva-grunnlagsbel›p];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 100 ;   ;Unit Cost           ;Decimal       ;CaptionML=[ENU=Unit Cost;
                                                              NOR=Enhetskost];
                                                   Editable=No;
                                                   AutoFormatType=2;
                                                   AutoFormatExpr="Currency Code" }
    { 101 ;   ;System-Created Entry;Boolean       ;CaptionML=[ENU=System-Created Entry;
                                                              NOR=Opprettet automatisk];
                                                   Editable=No }
    { 103 ;   ;Line Amount         ;Decimal       ;OnValidate=BEGIN
                                                                TESTFIELD(Type);
                                                                TESTFIELD(Quantity);
                                                                TESTFIELD("Unit Price");
                                                                GetSalesHeader;
                                                                "Line Amount" := ROUND("Line Amount",Currency."Amount Rounding Precision");
                                                                VALIDATE(
                                                                  "Line Discount Amount",ROUND(Quantity * "Unit Price",Currency."Amount Rounding Precision") - "Line Amount");
                                                              END;

                                                   CaptionML=[ENU=Line Amount;
                                                              NOR=Linjebel›p];
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code";
                                                   CaptionClass=GetCaptionClass(FIELDNO("Line Amount")) }
    { 104 ;   ;VAT Difference      ;Decimal       ;CaptionML=[ENU=VAT Difference;
                                                              NOR=Mva-differanse];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 105 ;   ;Inv. Disc. Amount to Invoice;Decimal;
                                                   CaptionML=[ENU=Inv. Disc. Amount to Invoice;
                                                              NOR=F.rabt.bel som skal faktureres];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 106 ;   ;VAT Identifier      ;Code10        ;CaptionML=[ENU=VAT Identifier;
                                                              NOR=Mva-type];
                                                   Editable=No }
    { 107 ;   ;IC Partner Ref. Type;Option        ;OnValidate=BEGIN
                                                                IF "IC Partner Code" <> '' THEN
                                                                  "IC Partner Ref. Type" := "IC Partner Ref. Type"::"G/L Account";
                                                                IF "IC Partner Ref. Type" <> xRec."IC Partner Ref. Type" THEN
                                                                  "IC Partner Reference" := '';
                                                                IF "IC Partner Ref. Type" = "IC Partner Ref. Type"::"Common Item No." THEN BEGIN
                                                                  IF Item."No." <> "No." THEN
                                                                    Item.GET("No.");
                                                                  Item.TESTFIELD("Common Item No.");
                                                                  "IC Partner Reference" := Item."Common Item No.";
                                                                END;
                                                              END;

                                                   AccessByPermission=TableData 410=R;
                                                   CaptionML=[ENU=IC Partner Ref. Type;
                                                              NOR=Referansetype for KI-partner];
                                                   OptionCaptionML=[ENU=" ,G/L Account,Item,,,Charge (Item),Cross Reference,Common Item No.";
                                                                    NOR=" ,Finanskonto,Vare,,,Gebyr (vare),Kryssreferanse,Felles varenr."];
                                                   OptionString=[ ,G/L Account,Item,,,Charge (Item),Cross Reference,Common Item No.] }
    { 108 ;   ;IC Partner Reference;Code20        ;OnLookup=VAR
                                                              ICGLAccount@1000 : Record 410;
                                                              ItemCrossReference@1001 : Record 5717;
                                                            BEGIN
                                                              IF "No." <> '' THEN
                                                                CASE "IC Partner Ref. Type" OF
                                                                  "IC Partner Ref. Type"::"G/L Account":
                                                                    BEGIN
                                                                      IF ICGLAccount.GET("IC Partner Reference") THEN;
                                                                      IF PAGE.RUNMODAL(PAGE::"IC G/L Account List",ICGLAccount) = ACTION::LookupOK THEN
                                                                        VALIDATE("IC Partner Reference",ICGLAccount."No.");
                                                                    END;
                                                                  "IC Partner Ref. Type"::Item:
                                                                    BEGIN
                                                                      IF Item.GET("IC Partner Reference") THEN;
                                                                      IF PAGE.RUNMODAL(PAGE::"Item List",Item) = ACTION::LookupOK THEN
                                                                        VALIDATE("IC Partner Reference",Item."No.");
                                                                    END;
                                                                  "IC Partner Ref. Type"::"Cross Reference":
                                                                    BEGIN
                                                                      ItemCrossReference.RESET;
                                                                      ItemCrossReference.SETCURRENTKEY("Cross-Reference Type","Cross-Reference Type No.");
                                                                      ItemCrossReference.SETFILTER(
                                                                        "Cross-Reference Type",'%1|%2',
                                                                        ItemCrossReference."Cross-Reference Type"::Customer,
                                                                        ItemCrossReference."Cross-Reference Type"::" ");
                                                                      ItemCrossReference.SETFILTER("Cross-Reference Type No.",'%1|%2',"Sell-to Customer No.",'');
                                                                      IF PAGE.RUNMODAL(PAGE::"Cross Reference List",ItemCrossReference) = ACTION::LookupOK THEN
                                                                        VALIDATE("IC Partner Reference",ItemCrossReference."Cross-Reference No.");
                                                                    END;
                                                                END;
                                                            END;

                                                   AccessByPermission=TableData 410=R;
                                                   CaptionML=[ENU=IC Partner Reference;
                                                              NOR=Referanse for KI-partner] }
    { 109 ;   ;Prepayment %        ;Decimal       ;OnValidate=BEGIN
                                                                TestStatusOpen;
                                                                UpdatePrepmtSetupFields;

                                                                IF Type <> Type::" " THEN
                                                                  UpdateAmounts;
                                                              END;

                                                   CaptionML=[ENU=Prepayment %;
                                                              NOR=Forskuddsprosent];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0;
                                                   MaxValue=100 }
    { 110 ;   ;Prepmt. Line Amount ;Decimal       ;OnValidate=BEGIN
                                                                TestStatusOpen;
                                                                PrePaymentLineAmountEntered := TRUE;
                                                                TESTFIELD("Line Amount");
                                                                IF "Prepmt. Line Amount" < "Prepmt. Amt. Inv." THEN
                                                                  FIELDERROR("Prepmt. Line Amount",STRSUBSTNO(Text044,"Prepmt. Amt. Inv."));
                                                                IF "Prepmt. Line Amount" > "Line Amount" THEN
                                                                  FIELDERROR("Prepmt. Line Amount",STRSUBSTNO(Text045,"Line Amount"));
                                                                IF "System-Created Entry" THEN
                                                                  FIELDERROR("Prepmt. Line Amount",STRSUBSTNO(Text045,0));
                                                                VALIDATE("Prepayment %",ROUND("Prepmt. Line Amount" * 100 / "Line Amount",0.00001));
                                                              END;

                                                   CaptionML=[ENU=Prepmt. Line Amount;
                                                              NOR=Linjebel›p for forskudd];
                                                   MinValue=0;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code";
                                                   CaptionClass=GetCaptionClass(FIELDNO("Prepmt. Line Amount")) }
    { 111 ;   ;Prepmt. Amt. Inv.   ;Decimal       ;CaptionML=[ENU=Prepmt. Amt. Inv.;
                                                              NOR=Fakturert forskuddsbel›p];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code";
                                                   CaptionClass=GetCaptionClass(FIELDNO("Prepmt. Amt. Inv.")) }
    { 112 ;   ;Prepmt. Amt. Incl. VAT;Decimal     ;CaptionML=[ENU=Prepmt. Amt. Incl. VAT;
                                                              NOR=Forskuddsbel›p inkl. mva];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 113 ;   ;Prepayment Amount   ;Decimal       ;CaptionML=[ENU=Prepayment Amount;
                                                              NOR=Forskuddsbel›p];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 114 ;   ;Prepmt. VAT Base Amt.;Decimal      ;CaptionML=[ENU=Prepmt. VAT Base Amt.;
                                                              NOR=Mva-grunnlagsbel›p for forskudd];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 115 ;   ;Prepayment VAT %    ;Decimal       ;CaptionML=[ENU=Prepayment VAT %;
                                                              NOR=Mva-prosent for forskudd];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0;
                                                   Editable=No }
    { 116 ;   ;Prepmt. VAT Calc. Type;Option      ;CaptionML=[ENU=Prepmt. VAT Calc. Type;
                                                              NOR=Mva-beregningstype for forskudd];
                                                   OptionCaptionML=[ENU=Normal VAT,Reverse Charge VAT,Full VAT,Sales Tax;
                                                                    NOR=Normal mva.,Snudd avregning,Full mva.,Salgsmva.];
                                                   OptionString=Normal VAT,Reverse Charge VAT,Full VAT,Sales Tax;
                                                   Editable=No }
    { 117 ;   ;Prepayment VAT Identifier;Code10   ;CaptionML=[ENU=Prepayment VAT Identifier;
                                                              NOR=Mva-type for forskudd];
                                                   Editable=No }
    { 118 ;   ;Prepayment Tax Area Code;Code20    ;TableRelation="Tax Area";
                                                   OnValidate=BEGIN
                                                                UpdateAmounts;
                                                              END;

                                                   CaptionML=[ENU=Prepayment Tax Area Code;
                                                              NOR=Mva-omr†dekode for forskudd] }
    { 119 ;   ;Prepayment Tax Liable;Boolean      ;OnValidate=BEGIN
                                                                UpdateAmounts;
                                                              END;

                                                   CaptionML=[ENU=Prepayment Tax Liable;
                                                              NOR=Skyldig mva for forskudd] }
    { 120 ;   ;Prepayment Tax Group Code;Code10   ;TableRelation="Tax Group";
                                                   OnValidate=BEGIN
                                                                TestStatusOpen;
                                                                UpdateAmounts;
                                                              END;

                                                   CaptionML=[ENU=Prepayment Tax Group Code;
                                                              NOR=Mva-gruppekode for forskudd] }
    { 121 ;   ;Prepmt Amt to Deduct;Decimal       ;OnValidate=BEGIN
                                                                IF "Prepmt Amt to Deduct" > "Prepmt. Amt. Inv." - "Prepmt Amt Deducted" THEN
                                                                  FIELDERROR(
                                                                    "Prepmt Amt to Deduct",
                                                                    STRSUBSTNO(Text045,"Prepmt. Amt. Inv." - "Prepmt Amt Deducted"));

                                                                IF "Prepmt Amt to Deduct" > "Qty. to Invoice" * "Unit Price" THEN
                                                                  FIELDERROR(
                                                                    "Prepmt Amt to Deduct",
                                                                    STRSUBSTNO(Text045,"Qty. to Invoice" * "Unit Price"));

                                                                IF ("Prepmt. Amt. Inv." - "Prepmt Amt to Deduct" - "Prepmt Amt Deducted") >
                                                                   (Quantity - "Qty. to Invoice" - "Quantity Invoiced") * "Unit Price"
                                                                THEN
                                                                  FIELDERROR(
                                                                    "Prepmt Amt to Deduct",
                                                                    STRSUBSTNO(Text044,
                                                                      "Prepmt. Amt. Inv." - "Prepmt Amt Deducted" - (Quantity - "Qty. to Invoice" - "Quantity Invoiced") * "Unit Price"));
                                                              END;

                                                   CaptionML=[ENU=Prepmt Amt to Deduct;
                                                              NOR=Forskuddsbel›p til fradrag];
                                                   MinValue=0;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code";
                                                   CaptionClass=GetCaptionClass(FIELDNO("Prepmt Amt to Deduct")) }
    { 122 ;   ;Prepmt Amt Deducted ;Decimal       ;CaptionML=[ENU=Prepmt Amt Deducted;
                                                              NOR=Fratrukket forskuddsbel›p];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code";
                                                   CaptionClass=GetCaptionClass(FIELDNO("Prepmt Amt Deducted")) }
    { 123 ;   ;Prepayment Line     ;Boolean       ;CaptionML=[ENU=Prepayment Line;
                                                              NOR=Forskuddslinje];
                                                   Editable=No }
    { 124 ;   ;Prepmt. Amount Inv. Incl. VAT;Decimal;
                                                   CaptionML=[ENU=Prepmt. Amount Inv. Incl. VAT;
                                                              NOR=Fakturert forskuddsbel›p inkl. mva];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 129 ;   ;Prepmt. Amount Inv. (LCY);Decimal  ;CaptionML=[ENU=Prepmt. Amount Inv. (LCY);
                                                              NOR=Fakturert forskuddsbel›p (NOK)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 130 ;   ;IC Partner Code     ;Code20        ;TableRelation="IC Partner";
                                                   OnValidate=BEGIN
                                                                IF "IC Partner Code" <> '' THEN BEGIN
                                                                  TESTFIELD(Type,Type::"G/L Account");
                                                                  GetSalesHeader;
                                                                  SalesHeader.TESTFIELD("Sell-to IC Partner Code",'');
                                                                  SalesHeader.TESTFIELD("Bill-to IC Partner Code",'');
                                                                  VALIDATE("IC Partner Ref. Type","IC Partner Ref. Type"::"G/L Account");
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=IC Partner Code;
                                                              NOR=KI-partnerkode] }
    { 132 ;   ;Prepmt. VAT Amount Inv. (LCY);Decimal;
                                                   CaptionML=[ENU=Prepmt. VAT Amount Inv. (LCY);
                                                              NOR=Fakturert mva-forskuddsbel›p (NOK)];
                                                   Editable=No }
    { 135 ;   ;Prepayment VAT Difference;Decimal  ;CaptionML=[ENU=Prepayment VAT Difference;
                                                              NOR=Mva-differanse for forskudd];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 136 ;   ;Prepmt VAT Diff. to Deduct;Decimal ;CaptionML=[ENU=Prepmt VAT Diff. to Deduct;
                                                              NOR=Mva-diff. for forskudd til fradrag];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 137 ;   ;Prepmt VAT Diff. Deducted;Decimal  ;CaptionML=[ENU=Prepmt VAT Diff. Deducted;
                                                              NOR=Fratrukket mva-diff. for forskudd];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 480 ;   ;Dimension Set ID    ;Integer       ;TableRelation="Dimension Set Entry";
                                                   OnLookup=BEGIN
                                                              ShowDimensions;
                                                            END;

                                                   CaptionML=[ENU=Dimension Set ID;
                                                              NOR=Dimensjonssett-ID];
                                                   Editable=No }
    { 900 ;   ;Qty. to Assemble to Order;Decimal  ;OnValidate=VAR
                                                                SalesLineReserve@1000 : Codeunit 99000832;
                                                              BEGIN
                                                                WhseValidateSourceLine.SalesLineVerifyChange(Rec,xRec);

                                                                "Qty. to Asm. to Order (Base)" := CalcBaseQty("Qty. to Assemble to Order");

                                                                IF "Qty. to Asm. to Order (Base)" <> 0 THEN BEGIN
                                                                  TESTFIELD("Drop Shipment",FALSE);
                                                                  TESTFIELD("Special Order",FALSE);
                                                                  IF "Qty. to Asm. to Order (Base)" < 0 THEN
                                                                    FIELDERROR("Qty. to Assemble to Order",STRSUBSTNO(Text009,FIELDCAPTION("Quantity (Base)"),"Quantity (Base)"));
                                                                  TESTFIELD("Appl.-to Item Entry",0);

                                                                  CASE "Document Type" OF
                                                                    "Document Type"::"Blanket Order",
                                                                    "Document Type"::Quote:
                                                                      IF ("Quantity (Base)" = 0) OR ("Qty. to Asm. to Order (Base)" <= 0) OR SalesLineReserve.ReservEntryExist(Rec) THEN
                                                                        TESTFIELD("Qty. to Asm. to Order (Base)",0)
                                                                      ELSE
                                                                        IF "Quantity (Base)" <> "Qty. to Asm. to Order (Base)" THEN
                                                                          FIELDERROR("Qty. to Assemble to Order",STRSUBSTNO(Text031,0,"Quantity (Base)"));
                                                                    "Document Type"::Order:
                                                                      ;
                                                                    ELSE
                                                                      TESTFIELD("Qty. to Asm. to Order (Base)",0);
                                                                  END;
                                                                END;

                                                                CheckItemAvailable(FIELDNO("Qty. to Assemble to Order"));
                                                                IF NOT (CurrFieldNo IN [FIELDNO(Quantity),FIELDNO("Qty. to Assemble to Order")]) THEN
                                                                  GetDefaultBin;
                                                                AutoAsmToOrder;
                                                              END;

                                                   AccessByPermission=TableData 90=R;
                                                   CaptionML=[ENU=Qty. to Assemble to Order;
                                                              NOR=Ant. som skal monteres til ordre];
                                                   DecimalPlaces=0:5 }
    { 901 ;   ;Qty. to Asm. to Order (Base);Decimal;
                                                   OnValidate=BEGIN
                                                                TESTFIELD("Qty. per Unit of Measure",1);
                                                                VALIDATE("Qty. to Assemble to Order","Qty. to Asm. to Order (Base)");
                                                              END;

                                                   CaptionML=[ENU=Qty. to Asm. to Order (Base);
                                                              NOR=Ant. som skal monteres til ordre (lagerenhet)];
                                                   DecimalPlaces=0:5 }
    { 902 ;   ;ATO Whse. Outstanding Qty.;Decimal ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Warehouse Shipment Line"."Qty. Outstanding" WHERE (Source Type=CONST(37),
                                                                                                                       Source Subtype=FIELD(Document Type),
                                                                                                                       Source No.=FIELD(Document No.),
                                                                                                                       Source Line No.=FIELD(Line No.),
                                                                                                                       Assemble to Order=FILTER(Yes)));
                                                   AccessByPermission=TableData 90=R;
                                                   CaptionML=[ENU=ATO Whse. Outstanding Qty.;
                                                              NOR=Restantall for ATO-lager];
                                                   DecimalPlaces=0:5;
                                                   BlankZero=Yes;
                                                   Editable=No }
    { 903 ;   ;ATO Whse. Outstd. Qty. (Base);Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Warehouse Shipment Line"."Qty. Outstanding (Base)" WHERE (Source Type=CONST(37),
                                                                                                                              Source Subtype=FIELD(Document Type),
                                                                                                                              Source No.=FIELD(Document No.),
                                                                                                                              Source Line No.=FIELD(Line No.),
                                                                                                                              Assemble to Order=FILTER(Yes)));
                                                   AccessByPermission=TableData 90=R;
                                                   CaptionML=[ENU=ATO Whse. Outstd. Qty. (Base);
                                                              NOR=Restantall for ATO-lager (lagerenhet)];
                                                   DecimalPlaces=0:5;
                                                   BlankZero=Yes;
                                                   Editable=No }
    { 1001;   ;Job Task No.        ;Code20        ;TableRelation="Job Task"."Job Task No." WHERE (Job No.=FIELD(Job No.));
                                                   CaptionML=[ENU=Job Task No.;
                                                              NOR=Prosjektoppgavenr.];
                                                   Editable=No }
    { 1002;   ;Job Contract Entry No.;Integer     ;OnValidate=VAR
                                                                JobPlanningLine@1001 : Record 1003;
                                                              BEGIN
                                                                JobPlanningLine.SETCURRENTKEY("Job Contract Entry No.");
                                                                JobPlanningLine.SETRANGE("Job Contract Entry No.","Job Contract Entry No.");
                                                                JobPlanningLine.FINDFIRST;
                                                                CreateDim(
                                                                  DimMgt.TypeToTableID3(Type),"No.",
                                                                  DATABASE::Job,JobPlanningLine."Job No.",
                                                                  DATABASE::"Responsibility Center","Responsibility Center");
                                                              END;

                                                   AccessByPermission=TableData 167=R;
                                                   CaptionML=[ENU=Job Contract Entry No.;
                                                              NOR=L›penr. for prosjektkontrakt];
                                                   Editable=No }
    { 1300;   ;Posting Date        ;Date          ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Sales Header"."Posting Date" WHERE (Document Type=FIELD(Document Type),
                                                                                                           No.=FIELD(Document No.)));
                                                   CaptionML=[ENU=Posting Date;
                                                              NOR=Bokf›ringsdato] }
    { 1700;   ;Deferral Code       ;Code10        ;TableRelation="Deferral Template"."Deferral Code";
                                                   OnValidate=BEGIN
                                                                GetSalesHeader;
                                                                DeferralPostDate := SalesHeader."Posting Date";

                                                                DeferralUtilities.DeferralCodeOnValidate(
                                                                  "Deferral Code",DeferralUtilities.GetSalesDeferralDocType,'','',
                                                                  "Document Type","Document No.","Line No.",
                                                                  GetDeferralAmount,DeferralPostDate,
                                                                  Description,SalesHeader."Currency Code");

                                                                IF "Document Type" = "Document Type"::"Return Order" THEN
                                                                  "Returns Deferral Start Date" :=
                                                                    DeferralUtilities.GetDeferralStartDate(DeferralUtilities.GetSalesDeferralDocType,
                                                                      "Document Type","Document No.","Line No.","Deferral Code",SalesHeader."Posting Date");
                                                              END;

                                                   CaptionML=[ENU=Deferral Code;
                                                              NOR=Periodiseringskode] }
    { 1702;   ;Returns Deferral Start Date;Date   ;OnValidate=VAR
                                                                DeferralHeader@1000 : Record 1701;
                                                              BEGIN
                                                                GetSalesHeader;
                                                                IF DeferralHeader.GET(DeferralUtilities.GetSalesDeferralDocType,'','',"Document Type","Document No.","Line No.") THEN
                                                                  DeferralUtilities.CreateDeferralSchedule("Deferral Code",DeferralUtilities.GetSalesDeferralDocType,'','',
                                                                    "Document Type","Document No.","Line No.",GetDeferralAmount,
                                                                    DeferralHeader."Calc. Method","Returns Deferral Start Date",
                                                                    DeferralHeader."No. of Periods",TRUE,
                                                                    DeferralHeader."Schedule Description",FALSE,
                                                                    SalesHeader."Currency Code");
                                                              END;

                                                   CaptionML=[ENU=Returns Deferral Start Date;
                                                              NOR=Startdato for periodisering av returer] }
    { 5402;   ;Variant Code        ;Code10        ;TableRelation=IF (Type=CONST(Item)) "Item Variant".Code WHERE (Item No.=FIELD(No.));
                                                   OnValidate=BEGIN
                                                                TestJobPlanningLine;
                                                                IF "Variant Code" <> '' THEN
                                                                  TESTFIELD(Type,Type::Item);
                                                                TestStatusOpen;
                                                                CheckAssocPurchOrder(FIELDCAPTION("Variant Code"));

                                                                IF xRec."Variant Code" <> "Variant Code" THEN BEGIN
                                                                  TESTFIELD("Qty. Shipped Not Invoiced",0);
                                                                  TESTFIELD("Shipment No.",'');

                                                                  TESTFIELD("Return Qty. Rcd. Not Invd.",0);
                                                                  TESTFIELD("Return Receipt No.",'');
                                                                  InitItemAppl(FALSE);
                                                                END;

                                                                CheckItemAvailable(FIELDNO("Variant Code"));

                                                                IF Type = Type::Item THEN BEGIN
                                                                  GetUnitCost;
                                                                  UpdateUnitPrice(FIELDNO("Variant Code"));
                                                                END;

                                                                GetDefaultBin;
                                                                InitQtyToAsm;
                                                                AutoAsmToOrder;
                                                                IF (xRec."Variant Code" <> "Variant Code") AND (Quantity <> 0) THEN BEGIN
                                                                  IF NOT FullReservedQtyIsForAsmToOrder THEN
                                                                    ReserveSalesLine.VerifyChange(Rec,xRec);
                                                                  WhseValidateSourceLine.SalesLineVerifyChange(Rec,xRec);
                                                                END;

                                                                UpdateItemCrossRef;
                                                              END;

                                                   CaptionML=[ENU=Variant Code;
                                                              NOR=Variantkode] }
    { 5403;   ;Bin Code            ;Code20        ;TableRelation=IF (Document Type=FILTER(Order|Invoice),
                                                                     Quantity=FILTER(>=0),
                                                                     Qty. to Asm. to Order (Base)=CONST(0)) "Bin Content"."Bin Code" WHERE (Location Code=FIELD(Location Code),
                                                                                                                                            Item No.=FIELD(No.),
                                                                                                                                            Variant Code=FIELD(Variant Code))
                                                                                                                                            ELSE IF (Document Type=FILTER(Return Order|Credit Memo),
                                                                                                                                                     Quantity=FILTER(<0)) "Bin Content"."Bin Code" WHERE (Location Code=FIELD(Location Code),
                                                                                                                                                                                                          Item No.=FIELD(No.),
                                                                                                                                                                                                          Variant Code=FIELD(Variant Code))
                                                                                                                                                                                                          ELSE Bin.Code WHERE (Location Code=FIELD(Location Code));
                                                   OnValidate=VAR
                                                                WMSManagement@1001 : Codeunit 7302;
                                                              BEGIN
                                                                IF "Bin Code" <> '' THEN BEGIN
                                                                  IF NOT IsInbound AND ("Quantity (Base)" <> 0) AND ("Qty. to Asm. to Order (Base)" = 0) THEN
                                                                    WMSManagement.FindBinContent("Location Code","Bin Code","No.","Variant Code",'')
                                                                  ELSE
                                                                    WMSManagement.FindBin("Location Code","Bin Code",'');
                                                                END;

                                                                IF "Drop Shipment" THEN
                                                                  CheckAssocPurchOrder(FIELDCAPTION("Bin Code"));

                                                                TESTFIELD(Type,Type::Item);
                                                                TESTFIELD("Location Code");

                                                                IF (Type = Type::Item) AND ("Bin Code" <> '') THEN BEGIN
                                                                  TESTFIELD("Drop Shipment",FALSE);
                                                                  GetLocation("Location Code");
                                                                  Location.TESTFIELD("Bin Mandatory");
                                                                  CheckWarehouse;
                                                                END;
                                                                ATOLink.UpdateAsmBinCodeFromSalesLine(Rec);
                                                              END;

                                                   OnLookup=VAR
                                                              WMSManagement@1002 : Codeunit 7302;
                                                              BinCode@1000 : Code[20];
                                                            BEGIN
                                                              IF NOT IsInbound AND ("Quantity (Base)" <> 0) THEN
                                                                BinCode := WMSManagement.BinContentLookUp("Location Code","No.","Variant Code",'',"Bin Code")
                                                              ELSE
                                                                BinCode := WMSManagement.BinLookUp("Location Code","No.","Variant Code",'');

                                                              IF BinCode <> '' THEN
                                                                VALIDATE("Bin Code",BinCode);
                                                            END;

                                                   CaptionML=[ENU=Bin Code;
                                                              NOR=Hyllekode] }
    { 5404;   ;Qty. per Unit of Measure;Decimal   ;InitValue=1;
                                                   CaptionML=[ENU=Qty. per Unit of Measure;
                                                              NOR=Antall per enhet];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 5405;   ;Planned             ;Boolean       ;CaptionML=[ENU=Planned;
                                                              NOR=Planlagt];
                                                   Editable=No }
    { 5407;   ;Unit of Measure Code;Code10        ;OnValidate=VAR
                                                                UnitOfMeasureTranslation@1000 : Record 5402;
                                                                ResUnitofMeasure@1001 : Record 205;
                                                              BEGIN
                                                                TestJobPlanningLine;
                                                                TestStatusOpen;
                                                                TESTFIELD("Quantity Shipped",0);
                                                                TESTFIELD("Qty. Shipped (Base)",0);
                                                                TESTFIELD("Return Qty. Received",0);
                                                                TESTFIELD("Return Qty. Received (Base)",0);
                                                                IF "Unit of Measure Code" <> xRec."Unit of Measure Code" THEN BEGIN
                                                                  TESTFIELD("Shipment No.",'');
                                                                  TESTFIELD("Return Receipt No.",'');
                                                                END;

                                                                CheckAssocPurchOrder(FIELDCAPTION("Unit of Measure Code"));

                                                                IF "Unit of Measure Code" = '' THEN
                                                                  "Unit of Measure" := ''
                                                                ELSE BEGIN
                                                                  IF NOT UnitOfMeasure.GET("Unit of Measure Code") THEN
                                                                    UnitOfMeasure.INIT;
                                                                  "Unit of Measure" := UnitOfMeasure.Description;
                                                                  GetSalesHeader;
                                                                  IF SalesHeader."Language Code" <> '' THEN BEGIN
                                                                    UnitOfMeasureTranslation.SETRANGE(Code,"Unit of Measure Code");
                                                                    UnitOfMeasureTranslation.SETRANGE("Language Code",SalesHeader."Language Code");
                                                                    IF UnitOfMeasureTranslation.FINDFIRST THEN
                                                                      "Unit of Measure" := UnitOfMeasureTranslation.Description;
                                                                  END;
                                                                END;
                                                                DistIntegration.EnterSalesItemCrossRef(Rec);
                                                                CASE Type OF
                                                                  Type::Item:
                                                                    BEGIN
                                                                      GetItem;
                                                                      GetUnitCost;
                                                                      UpdateUnitPrice(FIELDNO("Unit of Measure Code"));
                                                                      CheckItemAvailable(FIELDNO("Unit of Measure Code"));
                                                                      "Gross Weight" := Item."Gross Weight" * "Qty. per Unit of Measure";
                                                                      "Net Weight" := Item."Net Weight" * "Qty. per Unit of Measure";
                                                                      "Unit Volume" := Item."Unit Volume" * "Qty. per Unit of Measure";
                                                                      "Units per Parcel" := ROUND(Item."Units per Parcel" / "Qty. per Unit of Measure",0.00001);
                                                                      IF (xRec."Unit of Measure Code" <> "Unit of Measure Code") AND (Quantity <> 0) THEN
                                                                        WhseValidateSourceLine.SalesLineVerifyChange(Rec,xRec);
                                                                      IF "Qty. per Unit of Measure" > xRec."Qty. per Unit of Measure" THEN
                                                                        InitItemAppl(FALSE);
                                                                    END;
                                                                  Type::Resource:
                                                                    BEGIN
                                                                      IF "Unit of Measure Code" = '' THEN BEGIN
                                                                        GetResource;
                                                                        "Unit of Measure Code" := Resource."Base Unit of Measure";
                                                                      END;
                                                                      ResUnitofMeasure.GET("No.","Unit of Measure Code");
                                                                      "Qty. per Unit of Measure" := ResUnitofMeasure."Qty. per Unit of Measure";
                                                                      UpdateUnitPrice(FIELDNO("Unit of Measure Code"));
                                                                      FindResUnitCost;
                                                                    END;
                                                                  Type::"G/L Account",Type::"Fixed Asset",Type::"Charge (Item)",Type::" ":
                                                                    "Qty. per Unit of Measure" := 1;
                                                                END;
                                                                VALIDATE(Quantity);
                                                              END;

                                                   OnLookup=BEGIN
                                                              LookupUnitOfMeasureCode;
                                                            END;

                                                   CaptionML=[ENU=Unit of Measure Code;
                                                              NOR=Enhetskode] }
    { 5415;   ;Quantity (Base)     ;Decimal       ;OnValidate=BEGIN
                                                                TestJobPlanningLine;
                                                                TESTFIELD("Qty. per Unit of Measure",1);
                                                                VALIDATE(Quantity,"Quantity (Base)");
                                                                UpdateUnitPrice(FIELDNO("Quantity (Base)"));
                                                              END;

                                                   CaptionML=[ENU=Quantity (Base);
                                                              NOR=Antall (lagerenhet)];
                                                   DecimalPlaces=0:5 }
    { 5416;   ;Outstanding Qty. (Base);Decimal    ;CaptionML=[ENU=Outstanding Qty. (Base);
                                                              NOR=Restantall (lagerenhet)];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 5417;   ;Qty. to Invoice (Base);Decimal     ;OnValidate=BEGIN
                                                                TESTFIELD("Qty. per Unit of Measure",1);
                                                                VALIDATE("Qty. to Invoice","Qty. to Invoice (Base)");
                                                              END;

                                                   CaptionML=[ENU=Qty. to Invoice (Base);
                                                              NOR=Ant. som skal fakt. (l.enh.)];
                                                   DecimalPlaces=0:5 }
    { 5418;   ;Qty. to Ship (Base) ;Decimal       ;OnValidate=BEGIN
                                                                TESTFIELD("Qty. per Unit of Measure",1);
                                                                VALIDATE("Qty. to Ship","Qty. to Ship (Base)");
                                                              END;

                                                   CaptionML=[ENU=Qty. to Ship (Base);
                                                              NOR=Antall som skal leveres (l.enh)];
                                                   DecimalPlaces=0:5 }
    { 5458;   ;Qty. Shipped Not Invd. (Base);Decimal;
                                                   CaptionML=[ENU=Qty. Shipped Not Invd. (Base);
                                                              NOR=Ant.levert ikke fakt. (lagenh)];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 5460;   ;Qty. Shipped (Base) ;Decimal       ;CaptionML=[ENU=Qty. Shipped (Base);
                                                              NOR=Antall levert (lagerenhet)];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 5461;   ;Qty. Invoiced (Base);Decimal       ;CaptionML=[ENU=Qty. Invoiced (Base);
                                                              NOR=Antall fakturert (lagerenhet)];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 5495;   ;Reserved Qty. (Base);Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Reservation Entry"."Quantity (Base)" WHERE (Source ID=FIELD(Document No.),
                                                                                                                 Source Ref. No.=FIELD(Line No.),
                                                                                                                 Source Type=CONST(37),
                                                                                                                 Source Subtype=FIELD(Document Type),
                                                                                                                 Reservation Status=CONST(Reservation)));
                                                   AccessByPermission=TableData 110=R;
                                                   CaptionML=[ENU=Reserved Qty. (Base);
                                                              NOR=Reservert antall (lagerenhet)];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 5600;   ;FA Posting Date     ;Date          ;AccessByPermission=TableData 5600=R;
                                                   CaptionML=[ENU=FA Posting Date;
                                                              NOR=Aktivabokf.dato] }
    { 5602;   ;Depreciation Book Code;Code10      ;TableRelation="Depreciation Book";
                                                   OnValidate=BEGIN
                                                                GetFAPostingGroup;
                                                              END;

                                                   CaptionML=[ENU=Depreciation Book Code;
                                                              NOR=Avskrivningstabl†kode] }
    { 5605;   ;Depr. until FA Posting Date;Boolean;AccessByPermission=TableData 5600=R;
                                                   CaptionML=[ENU=Depr. until FA Posting Date;
                                                              NOR=Avskr. frem til aktivabokf.dato] }
    { 5612;   ;Duplicate in Depreciation Book;Code10;
                                                   TableRelation="Depreciation Book";
                                                   OnValidate=BEGIN
                                                                "Use Duplication List" := FALSE;
                                                              END;

                                                   CaptionML=[ENU=Duplicate in Depreciation Book;
                                                              NOR=Duplikat i avskrivningstabl†] }
    { 5613;   ;Use Duplication List;Boolean       ;OnValidate=BEGIN
                                                                "Duplicate in Depreciation Book" := '';
                                                              END;

                                                   AccessByPermission=TableData 5600=R;
                                                   CaptionML=[ENU=Use Duplication List;
                                                              NOR=Bruk duplikatoversikt] }
    { 5700;   ;Responsibility Center;Code10       ;TableRelation="Responsibility Center";
                                                   OnValidate=BEGIN
                                                                CreateDim(
                                                                  DATABASE::"Responsibility Center","Responsibility Center",
                                                                  DimMgt.TypeToTableID3(Type),"No.",
                                                                  DATABASE::Job,"Job No.");
                                                              END;

                                                   CaptionML=[ENU=Responsibility Center;
                                                              NOR=Ansvarssenter];
                                                   Editable=No }
    { 5701;   ;Out-of-Stock Substitution;Boolean  ;CaptionML=[ENU=Out-of-Stock Substitution;
                                                              NOR=Tomt p† lager-erstatning];
                                                   Editable=No }
    { 5702;   ;Substitution Available;Boolean     ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Item Substitution" WHERE (Type=CONST(Item),
                                                                                                No.=FIELD(No.),
                                                                                                Substitute Type=CONST(Item)));
                                                   CaptionML=[ENU=Substitution Available;
                                                              NOR=Erstatning mulig];
                                                   Editable=No }
    { 5703;   ;Originally Ordered No.;Code20      ;TableRelation=IF (Type=CONST(Item)) Item;
                                                   AccessByPermission=TableData 5715=R;
                                                   CaptionML=[ENU=Originally Ordered No.;
                                                              NOR=Opprinnelig ordreant.] }
    { 5704;   ;Originally Ordered Var. Code;Code10;TableRelation=IF (Type=CONST(Item)) "Item Variant".Code WHERE (Item No.=FIELD(Originally Ordered No.));
                                                   AccessByPermission=TableData 5715=R;
                                                   CaptionML=[ENU=Originally Ordered Var. Code;
                                                              NOR=Opprin. best. variant - kode] }
    { 5705;   ;Cross-Reference No. ;Code20        ;OnValidate=VAR
                                                                ReturnedCrossRef@1000 : Record 5717;
                                                              BEGIN
                                                                GetSalesHeader;
                                                                "Sell-to Customer No." := SalesHeader."Sell-to Customer No.";
                                                                ReturnedCrossRef.INIT;
                                                                IF "Cross-Reference No." <> '' THEN BEGIN
                                                                  DistIntegration.ICRLookupSalesItem(Rec,ReturnedCrossRef);
                                                                  IF "No." <> ReturnedCrossRef."Item No." THEN
                                                                    VALIDATE("No.",ReturnedCrossRef."Item No.");
                                                                  IF ReturnedCrossRef."Variant Code" <> '' THEN
                                                                    VALIDATE("Variant Code",ReturnedCrossRef."Variant Code");

                                                                  IF ReturnedCrossRef."Unit of Measure" <> '' THEN
                                                                    VALIDATE("Unit of Measure Code",ReturnedCrossRef."Unit of Measure");
                                                                END;

                                                                "Unit of Measure (Cross Ref.)" := ReturnedCrossRef."Unit of Measure";
                                                                "Cross-Reference Type" := ReturnedCrossRef."Cross-Reference Type";
                                                                "Cross-Reference Type No." := ReturnedCrossRef."Cross-Reference Type No.";
                                                                "Cross-Reference No." := ReturnedCrossRef."Cross-Reference No.";

                                                                IF ReturnedCrossRef.Description <> '' THEN
                                                                  Description := ReturnedCrossRef.Description;

                                                                UpdateUnitPrice(FIELDNO("Cross-Reference No."));
                                                                UpdateICPartner;
                                                              END;

                                                   OnLookup=BEGIN
                                                              CrossReferenceNoLookUp;
                                                            END;

                                                   AccessByPermission=TableData 5717=R;
                                                   CaptionML=[ENU=Cross-Reference No.;
                                                              NOR=Kryssreferansenr.] }
    { 5706;   ;Unit of Measure (Cross Ref.);Code10;TableRelation=IF (Type=CONST(Item)) "Item Unit of Measure".Code WHERE (Item No.=FIELD(No.));
                                                   AccessByPermission=TableData 5717=R;
                                                   CaptionML=[ENU=Unit of Measure (Cross Ref.);
                                                              NOR=Enhet (kryssref.)] }
    { 5707;   ;Cross-Reference Type;Option        ;CaptionML=[ENU=Cross-Reference Type;
                                                              NOR=Kryssreferansetype];
                                                   OptionCaptionML=[ENU=" ,Customer,Vendor,Bar Code";
                                                                    NOR=" ,Kunde,Leverand›r,Strekkode"];
                                                   OptionString=[ ,Customer,Vendor,Bar Code] }
    { 5708;   ;Cross-Reference Type No.;Code30    ;CaptionML=[ENU=Cross-Reference Type No.;
                                                              NOR=Kryssreferansetypenr.] }
    { 5709;   ;Item Category Code  ;Code20        ;TableRelation="Item Category";
                                                   CaptionML=[ENU=Item Category Code;
                                                              NOR=Varekategorikode] }
    { 5710;   ;Nonstock            ;Boolean       ;AccessByPermission=TableData 5718=R;
                                                   CaptionML=[ENU=Nonstock;
                                                              NOR=Katalogvare];
                                                   Editable=No }
    { 5711;   ;Purchasing Code     ;Code10        ;TableRelation=Purchasing;
                                                   OnValidate=VAR
                                                                PurchasingCode@1000 : Record 5721;
                                                                ShippingAgentServices@1001 : Record 5790;
                                                              BEGIN
                                                                TestStatusOpen;
                                                                TESTFIELD(Type,Type::Item);
                                                                CheckAssocPurchOrder(FIELDCAPTION(Type));

                                                                IF PurchasingCode.GET("Purchasing Code") THEN BEGIN
                                                                  "Drop Shipment" := PurchasingCode."Drop Shipment";
                                                                  "Special Order" := PurchasingCode."Special Order";
                                                                  IF "Drop Shipment" OR "Special Order" THEN BEGIN
                                                                    TESTFIELD("Qty. to Asm. to Order (Base)",0);
                                                                    CALCFIELDS("Reserved Qty. (Base)");
                                                                    TESTFIELD("Reserved Qty. (Base)",0);
                                                                    IF (Quantity <> 0) AND (Quantity = "Quantity Shipped") THEN
                                                                      ERROR(SalesLineCompletelyShippedErr);
                                                                    Reserve := Reserve::Never;
                                                                    VALIDATE(Quantity,Quantity);
                                                                    IF "Drop Shipment" THEN BEGIN
                                                                      EVALUATE("Outbound Whse. Handling Time",'<0D>');
                                                                      EVALUATE("Shipping Time",'<0D>');
                                                                      UpdateDates;
                                                                      "Bin Code" := '';
                                                                    END;
                                                                  END ELSE
                                                                    SetReserveWithoutPurchasingCode;
                                                                END ELSE BEGIN
                                                                  "Drop Shipment" := FALSE;
                                                                  "Special Order" := FALSE;
                                                                  SetReserveWithoutPurchasingCode;
                                                                END;

                                                                IF ("Purchasing Code" <> xRec."Purchasing Code") AND
                                                                   (NOT "Drop Shipment") AND
                                                                   ("Drop Shipment" <> xRec."Drop Shipment")
                                                                THEN BEGIN
                                                                  IF "Location Code" = '' THEN BEGIN
                                                                    IF InvtSetup.GET THEN
                                                                      "Outbound Whse. Handling Time" := InvtSetup."Outbound Whse. Handling Time";
                                                                  END ELSE
                                                                    IF Location.GET("Location Code") THEN
                                                                      "Outbound Whse. Handling Time" := Location."Outbound Whse. Handling Time";
                                                                  IF ShippingAgentServices.GET("Shipping Agent Code","Shipping Agent Service Code") THEN
                                                                    "Shipping Time" := ShippingAgentServices."Shipping Time"
                                                                  ELSE BEGIN
                                                                    GetSalesHeader;
                                                                    "Shipping Time" := SalesHeader."Shipping Time";
                                                                  END;
                                                                  UpdateDates;
                                                                END;
                                                              END;

                                                   AccessByPermission=TableData 223=R;
                                                   CaptionML=[ENU=Purchasing Code;
                                                              NOR=Kj›pskode] }
    { 5712;   ;Product Group Code  ;Code10        ;TableRelation="Product Group".Code WHERE (Item Category Code=FIELD(Item Category Code));
                                                   ValidateTableRelation=No;
                                                   CaptionML=[ENU=Product Group Code;
                                                              NOR=Produktgruppekode] }
    { 5713;   ;Special Order       ;Boolean       ;AccessByPermission=TableData 223=R;
                                                   CaptionML=[ENU=Special Order;
                                                              NOR=Spesialbestilling];
                                                   Editable=No }
    { 5714;   ;Special Order Purchase No.;Code20  ;TableRelation=IF (Special Order=CONST(Yes)) "Purchase Header".No. WHERE (Document Type=CONST(Order));
                                                   AccessByPermission=TableData 223=R;
                                                   CaptionML=[ENU=Special Order Purchase No.;
                                                              NOR=Spesialbestillingsnr.] }
    { 5715;   ;Special Order Purch. Line No.;Integer;
                                                   TableRelation=IF (Special Order=CONST(Yes)) "Purchase Line"."Line No." WHERE (Document Type=CONST(Order),
                                                                                                                                 Document No.=FIELD(Special Order Purchase No.));
                                                   AccessByPermission=TableData 223=R;
                                                   CaptionML=[ENU=Special Order Purch. Line No.;
                                                              NOR=Spesialbestilling - bestillingslinjenr.] }
    { 5749;   ;Whse. Outstanding Qty.;Decimal     ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Warehouse Shipment Line"."Qty. Outstanding" WHERE (Source Type=CONST(37),
                                                                                                                       Source Subtype=FIELD(Document Type),
                                                                                                                       Source No.=FIELD(Document No.),
                                                                                                                       Source Line No.=FIELD(Line No.)));
                                                   AccessByPermission=TableData 14=R;
                                                   CaptionML=[ENU=Whse. Outstanding Qty.;
                                                              NOR=Restantall - lager];
                                                   DecimalPlaces=0:5;
                                                   BlankZero=Yes;
                                                   Editable=No }
    { 5750;   ;Whse. Outstanding Qty. (Base);Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Warehouse Shipment Line"."Qty. Outstanding (Base)" WHERE (Source Type=CONST(37),
                                                                                                                              Source Subtype=FIELD(Document Type),
                                                                                                                              Source No.=FIELD(Document No.),
                                                                                                                              Source Line No.=FIELD(Line No.)));
                                                   AccessByPermission=TableData 14=R;
                                                   CaptionML=[ENU=Whse. Outstanding Qty. (Base);
                                                              NOR=Restantall - lager (lag.enhet)];
                                                   DecimalPlaces=0:5;
                                                   BlankZero=Yes;
                                                   Editable=No }
    { 5752;   ;Completely Shipped  ;Boolean       ;CaptionML=[ENU=Completely Shipped;
                                                              NOR=Fullstendig levert];
                                                   Editable=No }
    { 5790;   ;Requested Delivery Date;Date       ;OnValidate=BEGIN
                                                                TestStatusOpen;
                                                                IF ("Requested Delivery Date" <> xRec."Requested Delivery Date") AND
                                                                   ("Promised Delivery Date" <> 0D)
                                                                THEN
                                                                  ERROR(
                                                                    Text028,
                                                                    FIELDCAPTION("Requested Delivery Date"),
                                                                    FIELDCAPTION("Promised Delivery Date"));

                                                                IF "Requested Delivery Date" <> 0D THEN
                                                                  VALIDATE("Planned Delivery Date","Requested Delivery Date")
                                                                ELSE BEGIN
                                                                  GetSalesHeader;
                                                                  VALIDATE("Shipment Date",SalesHeader."Shipment Date");
                                                                END;
                                                              END;

                                                   AccessByPermission=TableData 99000880=R;
                                                   CaptionML=[ENU=Requested Delivery Date;
                                                              NOR=nsket leveringsdato] }
    { 5791;   ;Promised Delivery Date;Date        ;OnValidate=BEGIN
                                                                TestStatusOpen;
                                                                IF "Promised Delivery Date" <> 0D THEN
                                                                  VALIDATE("Planned Delivery Date","Promised Delivery Date")
                                                                ELSE
                                                                  VALIDATE("Requested Delivery Date");
                                                              END;

                                                   AccessByPermission=TableData 99000880=R;
                                                   CaptionML=[ENU=Promised Delivery Date;
                                                              NOR=Lovet leveringsdato] }
    { 5792;   ;Shipping Time       ;DateFormula   ;OnValidate=BEGIN
                                                                TestStatusOpen;
                                                                IF "Drop Shipment" THEN
                                                                  DateFormularZero("Shipping Time",FIELDNO("Shipping Time"),FIELDCAPTION("Shipping Time"));
                                                                UpdateDates;
                                                              END;

                                                   AccessByPermission=TableData 99000880=R;
                                                   CaptionML=[ENU=Shipping Time;
                                                              NOR=Leveringstid] }
    { 5793;   ;Outbound Whse. Handling Time;DateFormula;
                                                   OnValidate=BEGIN
                                                                TestStatusOpen;
                                                                IF "Drop Shipment" THEN
                                                                  DateFormularZero("Outbound Whse. Handling Time",
                                                                    FIELDNO("Outbound Whse. Handling Time"),FIELDCAPTION("Outbound Whse. Handling Time"));
                                                                UpdateDates;
                                                              END;

                                                   AccessByPermission=TableData 14=R;
                                                   CaptionML=[ENU=Outbound Whse. Handling Time;
                                                              NOR=Utg†ende lagerh†ndteringstid] }
    { 5794;   ;Planned Delivery Date;Date         ;OnValidate=BEGIN
                                                                TestStatusOpen;
                                                                IF "Planned Delivery Date" <> 0D THEN BEGIN
                                                                  PlannedDeliveryDateCalculated := TRUE;

                                                                  IF FORMAT("Shipping Time") <> '' THEN
                                                                    VALIDATE("Planned Shipment Date",CalcPlannedDeliveryDate(FIELDNO("Planned Delivery Date")))
                                                                  ELSE
                                                                    VALIDATE("Planned Shipment Date",CalcPlannedShptDate(FIELDNO("Planned Delivery Date")));

                                                                  IF "Planned Shipment Date" > "Planned Delivery Date" THEN
                                                                    "Planned Delivery Date" := "Planned Shipment Date";
                                                                END;
                                                              END;

                                                   AccessByPermission=TableData 99000880=R;
                                                   CaptionML=[ENU=Planned Delivery Date;
                                                              NOR=Planlagt lev.dato] }
    { 5795;   ;Planned Shipment Date;Date         ;OnValidate=BEGIN
                                                                TestStatusOpen;
                                                                IF "Planned Shipment Date" <> 0D THEN BEGIN
                                                                  PlannedShipmentDateCalculated := TRUE;

                                                                  IF FORMAT("Outbound Whse. Handling Time") <> '' THEN
                                                                    VALIDATE(
                                                                      "Shipment Date",
                                                                      CalendarMgmt.CalcDateBOC2(
                                                                        FORMAT("Outbound Whse. Handling Time"),
                                                                        "Planned Shipment Date",
                                                                        CalChange."Source Type"::Location,
                                                                        "Location Code",
                                                                        '',
                                                                        CalChange."Source Type"::"Shipping Agent",
                                                                        "Shipping Agent Code",
                                                                        "Shipping Agent Service Code",
                                                                        FALSE))
                                                                  ELSE
                                                                    VALIDATE(
                                                                      "Shipment Date",
                                                                      CalendarMgmt.CalcDateBOC(
                                                                        FORMAT(FORMAT('')),
                                                                        "Planned Shipment Date",
                                                                        CalChange."Source Type"::"Shipping Agent",
                                                                        "Shipping Agent Code",
                                                                        "Shipping Agent Service Code",
                                                                        CalChange."Source Type"::Location,
                                                                        "Location Code",
                                                                        '',
                                                                        FALSE));
                                                                END;
                                                              END;

                                                   AccessByPermission=TableData 99000880=R;
                                                   CaptionML=[ENU=Planned Shipment Date;
                                                              NOR=Planlagt forsendelsesdato] }
    { 5796;   ;Shipping Agent Code ;Code10        ;TableRelation="Shipping Agent";
                                                   OnValidate=BEGIN
                                                                TestStatusOpen;
                                                                IF "Shipping Agent Code" <> xRec."Shipping Agent Code" THEN
                                                                  VALIDATE("Shipping Agent Service Code",'');
                                                              END;

                                                   AccessByPermission=TableData 5790=R;
                                                   CaptionML=[ENU=Shipping Agent Code;
                                                              NOR=Transport›rkode] }
    { 5797;   ;Shipping Agent Service Code;Code10 ;TableRelation="Shipping Agent Services".Code WHERE (Shipping Agent Code=FIELD(Shipping Agent Code));
                                                   OnValidate=VAR
                                                                ShippingAgentServices@1000 : Record 5790;
                                                              BEGIN
                                                                TestStatusOpen;
                                                                IF "Shipping Agent Service Code" <> xRec."Shipping Agent Service Code" THEN
                                                                  EVALUATE("Shipping Time",'<>');

                                                                IF "Drop Shipment" THEN BEGIN
                                                                  EVALUATE("Shipping Time",'<0D>');
                                                                  UpdateDates;
                                                                END ELSE
                                                                  IF ShippingAgentServices.GET("Shipping Agent Code","Shipping Agent Service Code") THEN
                                                                    "Shipping Time" := ShippingAgentServices."Shipping Time"
                                                                  ELSE BEGIN
                                                                    GetSalesHeader;
                                                                    "Shipping Time" := SalesHeader."Shipping Time";
                                                                  END;

                                                                IF ShippingAgentServices."Shipping Time" <> xRec."Shipping Time" THEN
                                                                  VALIDATE("Shipping Time","Shipping Time");
                                                              END;

                                                   AccessByPermission=TableData 5790=R;
                                                   CaptionML=[ENU=Shipping Agent Service Code;
                                                              NOR=Transport›rservicekode] }
    { 5800;   ;Allow Item Charge Assignment;Boolean;
                                                   InitValue=Yes;
                                                   OnValidate=BEGIN
                                                                CheckItemChargeAssgnt;
                                                              END;

                                                   AccessByPermission=TableData 5800=R;
                                                   CaptionML=[ENU=Allow Item Charge Assignment;
                                                              NOR=Tillat varegebyrtilordning] }
    { 5801;   ;Qty. to Assign      ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Item Charge Assignment (Sales)"."Qty. to Assign" WHERE (Document Type=FIELD(Document Type),
                                                                                                                            Document No.=FIELD(Document No.),
                                                                                                                            Document Line No.=FIELD(Line No.)));
                                                   CaptionML=[ENU=Qty. to Assign;
                                                              NOR=Ant. som skal tilordnes];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 5802;   ;Qty. Assigned       ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Item Charge Assignment (Sales)"."Qty. Assigned" WHERE (Document Type=FIELD(Document Type),
                                                                                                                           Document No.=FIELD(Document No.),
                                                                                                                           Document Line No.=FIELD(Line No.)));
                                                   CaptionML=[ENU=Qty. Assigned;
                                                              NOR=Ant. tilordnet];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 5803;   ;Return Qty. to Receive;Decimal     ;OnValidate=VAR
                                                                ItemLedgEntry@1000 : Record 32;
                                                              BEGIN
                                                                IF (CurrFieldNo <> 0) AND
                                                                   (Type = Type::Item) AND
                                                                   ("Return Qty. to Receive" <> 0) AND
                                                                   (NOT "Drop Shipment")
                                                                THEN
                                                                  CheckWarehouse;

                                                                IF "Return Qty. to Receive" = Quantity - "Return Qty. Received" THEN
                                                                  InitQtyToReceive
                                                                ELSE BEGIN
                                                                  "Return Qty. to Receive (Base)" := CalcBaseQty("Return Qty. to Receive");
                                                                  InitQtyToInvoice;
                                                                END;
                                                                IF ("Return Qty. to Receive" * Quantity < 0) OR
                                                                   (ABS("Return Qty. to Receive") > ABS("Outstanding Quantity")) OR
                                                                   (Quantity * "Outstanding Quantity" < 0)
                                                                THEN
                                                                  ERROR(
                                                                    Text020,
                                                                    "Outstanding Quantity");
                                                                IF ("Return Qty. to Receive (Base)" * "Quantity (Base)" < 0) OR
                                                                   (ABS("Return Qty. to Receive (Base)") > ABS("Outstanding Qty. (Base)")) OR
                                                                   ("Quantity (Base)" * "Outstanding Qty. (Base)" < 0)
                                                                THEN
                                                                  ERROR(
                                                                    Text021,
                                                                    "Outstanding Qty. (Base)");

                                                                IF (CurrFieldNo <> 0) AND (Type = Type::Item) AND ("Return Qty. to Receive" > 0) THEN
                                                                  CheckApplFromItemLedgEntry(ItemLedgEntry);
                                                              END;

                                                   AccessByPermission=TableData 6660=R;
                                                   CaptionML=[ENU=Return Qty. to Receive;
                                                              NOR=Returant. som skal mottas];
                                                   DecimalPlaces=0:5 }
    { 5804;   ;Return Qty. to Receive (Base);Decimal;
                                                   OnValidate=BEGIN
                                                                TESTFIELD("Qty. per Unit of Measure",1);
                                                                VALIDATE("Return Qty. to Receive","Return Qty. to Receive (Base)");
                                                              END;

                                                   CaptionML=[ENU=Return Qty. to Receive (Base);
                                                              NOR=Returant. som skal mottas (lag.enh)];
                                                   DecimalPlaces=0:5 }
    { 5805;   ;Return Qty. Rcd. Not Invd.;Decimal ;CaptionML=[ENU=Return Qty. Rcd. Not Invd.;
                                                              NOR=Returant. mottatt, ikke fakt.];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 5806;   ;Ret. Qty. Rcd. Not Invd.(Base);Decimal;
                                                   CaptionML=[ENU=Ret. Qty. Rcd. Not Invd.(Base);
                                                              NOR=Ret.ant. mott., ikke fakt. (l.enh)];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 5807;   ;Return Rcd. Not Invd.;Decimal      ;OnValidate=VAR
                                                                Currency2@1000 : Record 4;
                                                              BEGIN
                                                                GetSalesHeader;
                                                                Currency2.InitRoundingPrecision;
                                                                IF SalesHeader."Currency Code" <> '' THEN
                                                                  "Return Rcd. Not Invd. (LCY)" :=
                                                                    ROUND(
                                                                      CurrExchRate.ExchangeAmtFCYToLCY(
                                                                        GetDate,"Currency Code",
                                                                        "Return Rcd. Not Invd.",SalesHeader."Currency Factor"),
                                                                      Currency2."Amount Rounding Precision")
                                                                ELSE
                                                                  "Return Rcd. Not Invd. (LCY)" :=
                                                                    ROUND("Return Rcd. Not Invd.",Currency2."Amount Rounding Precision");
                                                              END;

                                                   CaptionML=[ENU=Return Rcd. Not Invd.;
                                                              NOR=Retur mott., ikke fakt.];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 5808;   ;Return Rcd. Not Invd. (LCY);Decimal;CaptionML=[ENU=Return Rcd. Not Invd. (LCY);
                                                              NOR=Retur mott., ikke fakt. (NOK)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 5809;   ;Return Qty. Received;Decimal       ;AccessByPermission=TableData 6660=R;
                                                   CaptionML=[ENU=Return Qty. Received;
                                                              NOR=Returant. mottatt];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 5810;   ;Return Qty. Received (Base);Decimal;CaptionML=[ENU=Return Qty. Received (Base);
                                                              NOR=Returant. mottatt (l.enh)];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 5811;   ;Appl.-from Item Entry;Integer      ;OnValidate=VAR
                                                                ItemLedgEntry@1000 : Record 32;
                                                              BEGIN
                                                                IF "Appl.-from Item Entry" <> 0 THEN BEGIN
                                                                  CheckApplFromItemLedgEntry(ItemLedgEntry);
                                                                  VALIDATE("Unit Cost (LCY)",CalcUnitCost(ItemLedgEntry));
                                                                END;
                                                              END;

                                                   OnLookup=BEGIN
                                                              SelectItemEntry(FIELDNO("Appl.-from Item Entry"));
                                                            END;

                                                   AccessByPermission=TableData 27=R;
                                                   CaptionML=[ENU=Appl.-from Item Entry;
                                                              NOR=Utlignet fra-varepost];
                                                   MinValue=0 }
    { 5909;   ;BOM Item No.        ;Code20        ;TableRelation=Item;
                                                   CaptionML=[ENU=BOM Item No.;
                                                              NOR=Stykklistevarenr.] }
    { 6600;   ;Return Receipt No.  ;Code20        ;CaptionML=[ENU=Return Receipt No.;
                                                              NOR=Returseddelnr.];
                                                   Editable=No }
    { 6601;   ;Return Receipt Line No.;Integer    ;CaptionML=[ENU=Return Receipt Line No.;
                                                              NOR=Returseddellinjenr.];
                                                   Editable=No }
    { 6608;   ;Return Reason Code  ;Code10        ;TableRelation="Return Reason";
                                                   OnValidate=BEGIN
                                                                ValidateReturnReasonCode(FIELDNO("Return Reason Code"));
                                                              END;

                                                   CaptionML=[ENU=Return Reason Code;
                                                              NOR=Retur†rsakskode] }
    { 7001;   ;Allow Line Disc.    ;Boolean       ;InitValue=Yes;
                                                   CaptionML=[ENU=Allow Line Disc.;
                                                              NOR=Tillat linjerabatt] }
    { 7002;   ;Customer Disc. Group;Code20        ;TableRelation="Customer Discount Group";
                                                   OnValidate=BEGIN
                                                                IF Type = Type::Item THEN
                                                                  UpdateUnitPrice(FIELDNO("Customer Disc. Group"))
                                                              END;

                                                   CaptionML=[ENU=Customer Disc. Group;
                                                              NOR=Kunderabattgruppe] }
    { 10604;  ;VAT Code            ;Code10        ;TableRelation="VAT Code".Code;
                                                   OnValidate=BEGIN
                                                                NorwegianVATTools.InitPostingGrps_SalesLine(Rec);
                                                              END;

                                                   CaptionML=[ENU=VAT Code;
                                                              NOR=Mva-kode] }
    { 10605;  ;Account Code        ;Text30        ;OnValidate=BEGIN
                                                                IF (Type = Type::" ") AND ("Account Code" <> '') THEN
                                                                  ERROR(Text10600,FIELDCAPTION("Account Code"),FIELDCAPTION(Type),Type);
                                                              END;

                                                   CaptionML=[ENU=Account Code;
                                                              NOR=Kontokode] }
    { 73050;  ;Calculation No.     ;Code20        ;TableRelation="Item Calc. Header".No. WHERE (Item No.=FIELD(No.));
                                                   CaptionML=[ENU=Calculation No.;
                                                              NOR=Kalkylenr.] }
  }
  KEYS
  {
    {    ;Document Type,Document No.,Line No.     ;SumIndexFields=Amount,Amount Including VAT,Outstanding Amount,Shipped Not Invoiced,Outstanding Amount (LCY),Shipped Not Invoiced (LCY);
                                                   Clustered=Yes }
    { No ;Document No.,Line No.,Document Type      }
    {    ;Document Type,Type,No.,Variant Code,Drop Shipment,Location Code,Shipment Date;
                                                   SumIndexFields=Outstanding Qty. (Base) }
    {    ;Document Type,Bill-to Customer No.,Currency Code;
                                                   SumIndexFields=Outstanding Amount,Shipped Not Invoiced,Outstanding Amount (LCY),Shipped Not Invoiced (LCY),Return Rcd. Not Invd. (LCY) }
    { No ;Document Type,Type,No.,Variant Code,Drop Shipment,Shortcut Dimension 1 Code,Shortcut Dimension 2 Code,Location Code,Shipment Date;
                                                   SumIndexFields=Outstanding Qty. (Base) }
    { No ;Document Type,Bill-to Customer No.,Shortcut Dimension 1 Code,Shortcut Dimension 2 Code,Currency Code;
                                                   SumIndexFields=Outstanding Amount,Shipped Not Invoiced,Outstanding Amount (LCY),Shipped Not Invoiced (LCY) }
    {    ;Document Type,Blanket Order No.,Blanket Order Line No. }
    { No ;Document Type,Document No.,Location Code }
    {    ;Document Type,Shipment No.,Shipment Line No. }
    {    ;Type,No.,Variant Code,Drop Shipment,Location Code,Document Type,Shipment Date;
                                                   MaintainSQLIndex=No }
    {    ;Document Type,Sell-to Customer No.,Shipment No.;
                                                   SumIndexFields=Outstanding Amount (LCY) }
    {    ;Job Contract Entry No.                   }
    { No ;Document Type,Document No.,Qty. Shipped Not Invoiced }
    { No ;Document Type,Document No.,Type,No.      }
  }
  FIELDGROUPS
  {
    { 1   ;Brick               ;Quantity,Description,Unit Price,Amount,Amount Including VAT }
  }
  CODE
  {
    VAR
      Text000@1000 : TextConst 'ENU=You cannot delete the order line because it is associated with purchase order %1 line %2.;NOR=Du kan ikke slette ordrelinjen fordi den er tilknyttet bestilling %1, linje %2.';
      Text001@1001 : TextConst 'ENU=You cannot rename a %1.;NOR=Du kan ikke gi nytt navn til en %1.';
      Text002@1002 : TextConst 'ENU=You cannot change %1 because the order line is associated with purchase order %2 line %3.;NOR=Du kan ikke endre %1 fordi ordrelinjen er tilknyttet bestilling %2, linje %3.';
      Text003@1003 : TextConst 'ENU=must not be less than %1;NOR=kan ikke v‘re mindre enn %1';
      Text005@1004 : TextConst 'ENU=You cannot invoice more than %1 units.;NOR=Du kan ikke fakturere mer enn %1 enheter.';
      Text006@1005 : TextConst 'ENU=You cannot invoice more than %1 base units.;NOR=Du kan ikke fakturere mer enn %1 lagerenheter.';
      Text007@1006 : TextConst 'ENU=You cannot ship more than %1 units.;NOR=Du kan ikke levere mer enn %1 enheter.';
      Text008@1007 : TextConst 'ENU=You cannot ship more than %1 base units.;NOR=Du kan ikke levere mer enn %1 lagerenheter.';
      Text009@1008 : TextConst 'ENU=" must be 0 when %1 is %2";NOR=" m† v‘re 0 n†r %1 er %2"';
      Text011@1010 : TextConst 'ENU=Automatic reservation is not possible.\Do you want to reserve items manually?;NOR=Det er ikke mulig † reservere automatisk.\Vil du reservere varene manuelt?';
      Text014@1013 : TextConst 'ENU=%1 %2 is before work date %3;NOR=%1 %2 er f›r arbeidsdatoen %3';
      Text016@1040 : TextConst 'ENU="%1 is required for %2 = %3.";NOR="%1 kreves for %2 = %3."';
      Text017@1044 : TextConst 'ENU=\The entered information may be disregarded by warehouse operations.;NOR=\Det kan v‘re at de angitte opplysningene ikke tas med i lageroperasjoner.';
      Text020@1019 : TextConst 'ENU=You cannot return more than %1 units.;NOR=Du kan ikke returnere mer enn %1 enheter.';
      Text021@1020 : TextConst 'ENU=You cannot return more than %1 base units.;NOR=Du kan ikke returnere mer enn %1 lagerenheter.';
      Text026@1025 : TextConst 'ENU=You cannot change %1 if the item charge has already been posted.;NOR=Du kan ikke endre %1 hvis varegebyret allerede er bokf›rt.';
      CurrExchRate@1030 : Record 330;
      SalesHeader@1031 : Record 36;
      SalesLine2@1032 : Record 37;
      GLAcc@1035 : Record 15;
      Item@1036 : Record 27;
      Resource@1400 : Record 156;
      Currency@1037 : Record 4;
      Res@1043 : Record 156;
      ResCost@1045 : Record 202;
      VATPostingSetup@1048 : Record 325;
      GenBusPostingGrp@1050 : Record 250;
      GenProdPostingGrp@1051 : Record 251;
      UnitOfMeasure@1054 : Record 204;
      NonstockItem@1058 : Record 5718;
      SKU@1060 : Record 5700;
      ItemCharge@1061 : Record 5800;
      InvtSetup@1063 : Record 313;
      Location@1064 : Record 14;
      ATOLink@1016 : Record 904;
      SalesSetup@1065 : Record 311;
      ApplicationAreaSetup@1038 : Record 9178;
      TempItemTemplate@1099 : TEMPORARY Record 1301;
      CalChange@1052 : Record 7602;
      ConfigTemplateHeader@1057 : Record 8618;
      PriceCalcMgt@1071 : Codeunit 7000;
      CustCheckCreditLimit@1074 : Codeunit 312;
      ItemCheckAvail@1075 : Codeunit 311;
      SalesTaxCalculate@1076 : Codeunit 398;
      ReserveSalesLine@1079 : Codeunit 99000832;
      UOMMgt@1080 : Codeunit 5402;
      AddOnIntegrMgt@1081 : Codeunit 5403;
      DimMgt@1082 : Codeunit 408;
      ItemSubstitutionMgt@1085 : Codeunit 5701;
      DistIntegration@1086 : Codeunit 5702;
      NonstockItemMgt@1087 : Codeunit 5703;
      WhseValidateSourceLine@1088 : Codeunit 5777;
      TransferExtendedText@1100 : Codeunit 378;
      NorwegianVATTools@1080000 : Codeunit 10600;
      DeferralUtilities@1026 : Codeunit 1720;
      CalendarMgmt@1056 : Codeunit 7600;
      FullAutoReservation@1092 : Boolean;
      StatusCheckSuspended@1094 : Boolean;
      HasBeenShown@1018 : Boolean;
      PlannedShipmentDateCalculated@1012 : Boolean;
      PlannedDeliveryDateCalculated@1070 : Boolean;
      Text028@1098 : TextConst 'ENU=You cannot change the %1 when the %2 has been filled in.;NOR=Du kan ikke endre %1 n†r %2 er fyllt ut.';
      Text029@1021 : TextConst 'ENU=must be positive;NOR=m† v‘re positiv';
      Text030@1042 : TextConst 'ENU=must be negative;NOR=m† v‘re negativ';
      Text031@1093 : TextConst 'ENU=You must either specify %1 or %2.;NOR=Du m† angi %1 eller %2.';
      Text034@1084 : TextConst 'ENU=The value of %1 field must be a whole number for the item included in the service item group if the %2 field in the Service Item Groups window contains a check mark.;NOR=Verdien i feltet %1 m† v‘re et helt tall for varen som er inkludert i servicevaregruppen, hvis det er et merke i feltet %2 i vinduet Servicevaregrupper.';
      Text035@1083 : TextConst 'ENU="Warehouse ";NOR="Lager "';
      Text036@1090 : TextConst 'ENU="Inventory ";NOR="Beholdning "';
      HideValidationDialog@1109 : Boolean;
      Text037@1009 : TextConst 'ENU=You cannot change %1 when %2 is %3 and %4 is positive.;NOR=Du kan ikke endre %1 n†r %2 er %3 og %4 er positiv.';
      Text038@1014 : TextConst 'ENU=You cannot change %1 when %2 is %3 and %4 is negative.;NOR=Du kan ikke endre %1 n†r %2 er %3 og %4 er negativ.';
      Text039@1034 : TextConst 'ENU=%1 units for %2 %3 have already been returned. Therefore, only %4 units can be returned.;NOR=%1 enheter for %2 %3 er allerede returnert. Derfor kan bare %4 enheter returneres.';
      Text040@1039 : TextConst 'ENU=You must use form %1 to enter %2, if item tracking is used.;NOR=Du m† bruke skjemaet %1 til † registrere %2 hvis varesporing brukes.';
      Text042@1055 : TextConst 'ENU=When posting the Applied to Ledger Entry %1 will be opened first;NOR=Ved bokf›ring av utligning †pnes posten %1 f›rst';
      ShippingMoreUnitsThanReceivedErr@1047 : TextConst 'ENU=You cannot ship more than the %1 units that you have received for document no. %2.;NOR=Du kan ikke levere mer enn de %1 enhetene som er mottatt for bilagsnummer %2.';
      Text044@1103 : TextConst 'ENU=cannot be less than %1;NOR=kan ikke v‘re mindre enn %1';
      Text045@1104 : TextConst 'ENU=cannot be more than %1;NOR=kan ikke v‘re mer enn %1';
      Text046@1105 : TextConst 'ENU=You cannot return more than the %1 units that you have shipped for %2 %3.;NOR=Du kan ikke returnere mer enn de %1 enhetene som er levert for %2 %3.';
      Text047@1106 : TextConst 'ENU=must be positive when %1 is not 0.;NOR=m† v‘re positiv n†r %1 ikke er 0.';
      Text048@1108 : TextConst 'ENU=You cannot use item tracking on a %1 created from a %2.;NOR=Du kan ikke bruke varesporing p† %1 som er opprettet fra %2.';
      Text049@1139 : TextConst 'ENU=cannot be %1.;NOR=kan ikke v‘re %1.';
      Text051@1141 : TextConst 'ENU=You cannot use %1 in a %2.;NOR=Du kan ikke bruke %1 i %2.';
      PrePaymentLineAmountEntered@1015 : Boolean;
      Text052@1022 : TextConst 'ENU=You cannot add an item line because an open warehouse shipment exists for the sales header and Shipping Advice is %1.\\You must add items as new lines to the existing warehouse shipment or change Shipping Advice to Partial.;NOR=Du kan ikke legge til en varelinje fordi det finnes en †pen lagerlevering for salgshodet og Leverings›nske er %1\.\Du m† legge til varer som nye linjer i den eksisterende lagerleveringen eller endre Leverings›nske til Delvis.';
      Text053@1017 : TextConst 'ENU=You have changed one or more dimensions on the %1, which is already shipped. When you post the line with the changed dimension to General Ledger, amounts on the Inventory Interim account will be out of balance when reported per dimension.\\Do you want to keep the changed dimension?;NOR=Du har endret ‚n eller flere dimensjoner p† %1, som allerede er levert. N†r du bokf›rer linjen med den endrede dimensjonen i Finans, vil bel›p p† den midlertidige lagerkontoen v‘re i ubalanse n†r de rapporteres per dimensjon.\\Vil du beholde den endrede dimensjonen?';
      Text054@1023 : TextConst 'ENU=Cancelled.;NOR=Avbrutt.';
      Text055@1024 : TextConst '@@@=Quantity Invoiced must not be greater than the sum of Qty. Assigned and Qty. to Assign.;ENU=%1 must not be greater than the sum of %2 and %3.;NOR=%1 m† ikke v‘re st›rre enn summen av %2 og %3.';
      Text056@1011 : TextConst 'ENU=You cannot add an item line because an open inventory pick exists for the Sales Header and because Shipping Advice is %1.\\You must first post or delete the inventory pick or change Shipping Advice to Partial.;NOR=Du kan ikke legge til en varelinje fordi det finnes et †pent lagerplukk for salgshodet og Leverings›nske er %1.\\Du m† f›rst bokf›re eller slette lagerplukket eller endre leverings›nske til Delvis.';
      Text057@1027 : TextConst 'ENU=must have the same sign as the shipment;NOR=m† ha samme fortegn som f›lgeseddelen';
      Text058@1028 : TextConst 'ENU=The quantity that you are trying to invoice is greater than the quantity in shipment %1.;NOR=Antallet du pr›ver † fakturere, er st›rre enn antallet i f›lgeseddel %1.';
      Text059@1029 : TextConst 'ENU=must have the same sign as the return receipt;NOR=m† ha samme fortegn som returseddelen';
      Text060@1041 : TextConst 'ENU=The quantity that you are trying to invoice is greater than the quantity in return receipt %1.;NOR=Antallet du pr›ver † fakturere, er st›rre enn antallet i returseddel %1.';
      AnotherItemWithSameDescrQst@1049 : TextConst '@@@="%1=Item no., %2=item description";ENU=We found an item with the description "%2" (No. %1).\Did you mean to change the current item to %1?;NOR=Vi fant en vare med beskrivelsen %2 (nr. %1).\Vil du endre gjeldende vare til %1?';
      SalesLineCompletelyShippedErr@1053 : TextConst 'ENU=You cannot change the purchasing code for a sales line that has been completely shipped.;NOR=Du kan ikke endre kj›pskoden for en salgslinje som er fullstendig levert.';
      Text10600@1080003 : TextConst 'ENU=You cannot enter %1 if %2 is "%3".;NOR=Du kan ikke angi %1 hvis %2 er %3.';
      SalesSetupRead@1067 : Boolean;
      LookupRequested@1059 : Boolean;
      DeferralPostDate@1069 : Date;
      ItemNoFieldCaptionTxt@1046 : TextConst 'ENU=Item;NOR=Vare';
      FreightLineDescriptionTxt@1033 : TextConst 'ENU=Freight Amount;NOR=Fraktbel›p';

    PROCEDURE InitOutstanding@16();
    BEGIN
      IF "Document Type" IN ["Document Type"::"Return Order","Document Type"::"Credit Memo"] THEN BEGIN
        "Outstanding Quantity" := Quantity - "Return Qty. Received";
        "Outstanding Qty. (Base)" := "Quantity (Base)" - "Return Qty. Received (Base)";
        "Return Qty. Rcd. Not Invd." := "Return Qty. Received" - "Quantity Invoiced";
        "Ret. Qty. Rcd. Not Invd.(Base)" := "Return Qty. Received (Base)" - "Qty. Invoiced (Base)";
      END ELSE BEGIN
        "Outstanding Quantity" := Quantity - "Quantity Shipped";
        "Outstanding Qty. (Base)" := "Quantity (Base)" - "Qty. Shipped (Base)";
        "Qty. Shipped Not Invoiced" := "Quantity Shipped" - "Quantity Invoiced";
        "Qty. Shipped Not Invd. (Base)" := "Qty. Shipped (Base)" - "Qty. Invoiced (Base)";
      END;
      UpdatePlanned;
      "Completely Shipped" := (Quantity <> 0) AND ("Outstanding Quantity" = 0);
      InitOutstandingAmount;
    END;

    PROCEDURE InitOutstandingAmount@17();
    VAR
      AmountInclVAT@1000 : Decimal;
    BEGIN
      IF Quantity = 0 THEN BEGIN
        "Outstanding Amount" := 0;
        "Outstanding Amount (LCY)" := 0;
        "Shipped Not Invoiced" := 0;
        "Shipped Not Invoiced (LCY)" := 0;
        "Return Rcd. Not Invd." := 0;
        "Return Rcd. Not Invd. (LCY)" := 0;
      END ELSE BEGIN
        GetSalesHeader;
        AmountInclVAT := "Amount Including VAT";
        VALIDATE(
          "Outstanding Amount",
          ROUND(
            AmountInclVAT * "Outstanding Quantity" / Quantity,
            Currency."Amount Rounding Precision"));
        IF "Document Type" IN ["Document Type"::"Return Order","Document Type"::"Credit Memo"] THEN
          VALIDATE(
            "Return Rcd. Not Invd.",
            ROUND(
              AmountInclVAT * "Return Qty. Rcd. Not Invd." / Quantity,
              Currency."Amount Rounding Precision"))
        ELSE
          VALIDATE(
            "Shipped Not Invoiced",
            ROUND(
              AmountInclVAT * "Qty. Shipped Not Invoiced" / Quantity,
              Currency."Amount Rounding Precision"));
      END;
    END;

    PROCEDURE InitQtyToShip@15();
    BEGIN
      GetSalesSetup;
      IF (SalesSetup."Default Quantity to Ship" = SalesSetup."Default Quantity to Ship"::Remainder) OR
         ("Document Type" = "Document Type"::Invoice)
      THEN BEGIN
        "Qty. to Ship" := "Outstanding Quantity";
        "Qty. to Ship (Base)" := "Outstanding Qty. (Base)";
      END ELSE
        IF "Qty. to Ship" <> 0 THEN
          "Qty. to Ship (Base)" := CalcBaseQty("Qty. to Ship");

      CheckServItemCreation;

      InitQtyToInvoice;
    END;

    PROCEDURE InitQtyToReceive@5803();
    BEGIN
      GetSalesSetup;
      IF (SalesSetup."Default Quantity to Ship" = SalesSetup."Default Quantity to Ship"::Remainder) OR
         ("Document Type" = "Document Type"::"Credit Memo")
      THEN BEGIN
        "Return Qty. to Receive" := "Outstanding Quantity";
        "Return Qty. to Receive (Base)" := "Outstanding Qty. (Base)";
      END ELSE
        IF "Return Qty. to Receive" <> 0 THEN
          "Return Qty. to Receive (Base)" := CalcBaseQty("Return Qty. to Receive");

      InitQtyToInvoice;
    END;

    PROCEDURE InitQtyToInvoice@13();
    BEGIN
      "Qty. to Invoice" := MaxQtyToInvoice;
      "Qty. to Invoice (Base)" := MaxQtyToInvoiceBase;
      "VAT Difference" := 0;
      CalcInvDiscToInvoice;
      IF SalesHeader."Document Type" <> SalesHeader."Document Type"::Invoice THEN
        CalcPrepaymentToDeduct;
    END;

    LOCAL PROCEDURE InitItemAppl@40(OnlyApplTo@1000 : Boolean);
    BEGIN
      "Appl.-to Item Entry" := 0;
      IF NOT OnlyApplTo THEN
        "Appl.-from Item Entry" := 0;
    END;

    PROCEDURE MaxQtyToInvoice@18() : Decimal;
    BEGIN
      IF "Prepayment Line" THEN
        EXIT(1);
      IF "Document Type" IN ["Document Type"::"Return Order","Document Type"::"Credit Memo"] THEN
        EXIT("Return Qty. Received" + "Return Qty. to Receive" - "Quantity Invoiced");

      EXIT("Quantity Shipped" + "Qty. to Ship" - "Quantity Invoiced");
    END;

    PROCEDURE MaxQtyToInvoiceBase@19() : Decimal;
    BEGIN
      IF "Document Type" IN ["Document Type"::"Return Order","Document Type"::"Credit Memo"] THEN
        EXIT("Return Qty. Received (Base)" + "Return Qty. to Receive (Base)" - "Qty. Invoiced (Base)");

      EXIT("Qty. Shipped (Base)" + "Qty. to Ship (Base)" - "Qty. Invoiced (Base)");
    END;

    LOCAL PROCEDURE CalcBaseQty@14(Qty@1000 : Decimal) : Decimal;
    BEGIN
      TESTFIELD("Qty. per Unit of Measure");
      EXIT(ROUND(Qty * "Qty. per Unit of Measure",0.00001));
    END;

    LOCAL PROCEDURE SelectItemEntry@8(CurrentFieldNo@1000 : Integer);
    VAR
      ItemLedgEntry@1001 : Record 32;
      SalesLine3@1002 : Record 37;
    BEGIN
      ItemLedgEntry.SETRANGE("Item No.","No.");
      IF "Location Code" <> '' THEN
        ItemLedgEntry.SETRANGE("Location Code","Location Code");
      ItemLedgEntry.SETRANGE("Variant Code","Variant Code");

      IF CurrentFieldNo = FIELDNO("Appl.-to Item Entry") THEN BEGIN
        ItemLedgEntry.SETCURRENTKEY("Item No.",Open);
        ItemLedgEntry.SETRANGE(Positive,TRUE);
        ItemLedgEntry.SETRANGE(Open,TRUE);
      END ELSE BEGIN
        ItemLedgEntry.SETCURRENTKEY("Item No.",Positive);
        ItemLedgEntry.SETRANGE(Positive,FALSE);
        ItemLedgEntry.SETFILTER("Shipped Qty. Not Returned",'<0');
      END;
      IF PAGE.RUNMODAL(PAGE::"Item Ledger Entries",ItemLedgEntry) = ACTION::LookupOK THEN BEGIN
        SalesLine3 := Rec;
        IF CurrentFieldNo = FIELDNO("Appl.-to Item Entry") THEN
          SalesLine3.VALIDATE("Appl.-to Item Entry",ItemLedgEntry."Entry No.")
        ELSE
          SalesLine3.VALIDATE("Appl.-from Item Entry",ItemLedgEntry."Entry No.");
        CheckItemAvailable(CurrentFieldNo);
        Rec := SalesLine3;
      END;
    END;

    PROCEDURE SetSalesHeader@24(NewSalesHeader@1000 : Record 36);
    BEGIN
      SalesHeader := NewSalesHeader;

      IF SalesHeader."Currency Code" = '' THEN
        Currency.InitRoundingPrecision
      ELSE BEGIN
        SalesHeader.TESTFIELD("Currency Factor");
        Currency.GET(SalesHeader."Currency Code");
        Currency.TESTFIELD("Amount Rounding Precision");
      END;
    END;

    LOCAL PROCEDURE GetSalesHeader@1();
    BEGIN
      TESTFIELD("Document No.");
      IF ("Document Type" <> SalesHeader."Document Type") OR ("Document No." <> SalesHeader."No.") THEN BEGIN
        SalesHeader.GET("Document Type","Document No.");
        IF SalesHeader."Currency Code" = '' THEN
          Currency.InitRoundingPrecision
        ELSE BEGIN
          SalesHeader.TESTFIELD("Currency Factor");
          Currency.GET(SalesHeader."Currency Code");
          Currency.TESTFIELD("Amount Rounding Precision");
        END;
      END;
    END;

    LOCAL PROCEDURE GetItem@9();
    BEGIN
      TESTFIELD("No.");
      IF "No." <> Item."No." THEN
        Item.GET("No.");
    END;

    LOCAL PROCEDURE GetResource@49();
    BEGIN
      TESTFIELD("No.");
      IF "No." <> Resource."No." THEN
        Resource.GET("No.");
    END;

    LOCAL PROCEDURE UpdateUnitPrice@2(CalledByFieldNo@1000 : Integer);
    BEGIN
      IF (CalledByFieldNo <> CurrFieldNo) AND (CurrFieldNo <> 0) THEN
        EXIT;

      GetSalesHeader;
      TESTFIELD("Qty. per Unit of Measure");

      CASE Type OF
        Type::Item,Type::Resource:
          BEGIN
            PriceCalcMgt.FindSalesLineLineDisc(SalesHeader,Rec);
            PriceCalcMgt.FindSalesLinePrice(SalesHeader,Rec,CalledByFieldNo);
          END;
      END;
      VALIDATE("Unit Price");
    END;

    LOCAL PROCEDURE FindResUnitCost@5();
    BEGIN
      ResCost.INIT;
      ResCost.Code := "No.";
      ResCost."Work Type Code" := "Work Type Code";
      CODEUNIT.RUN(CODEUNIT::"Resource-Find Cost",ResCost);
      VALIDATE("Unit Cost (LCY)",ResCost."Unit Cost" * "Qty. per Unit of Measure");
    END;

    PROCEDURE UpdatePrepmtSetupFields@102();
    VAR
      GenPostingSetup@1001 : Record 252;
      GLAcc@1000 : Record 15;
    BEGIN
      IF ("Prepayment %" <> 0) AND (Type <> Type::" ") THEN BEGIN
        TESTFIELD("Document Type","Document Type"::Order);
        TESTFIELD("No.");
        IF CurrFieldNo = FIELDNO("Prepayment %") THEN
          IF "System-Created Entry" THEN
            FIELDERROR("Prepmt. Line Amount",STRSUBSTNO(Text045,0));
        IF "System-Created Entry" THEN
          "Prepayment %" := 0;
        GenPostingSetup.GET("Gen. Bus. Posting Group","Gen. Prod. Posting Group");
        IF GenPostingSetup."Sales Prepayments Account" <> '' THEN BEGIN
          GLAcc.GET(GenPostingSetup."Sales Prepayments Account");
          VATPostingSetup.GET("VAT Bus. Posting Group",GLAcc."VAT Prod. Posting Group");
          VATPostingSetup.TESTFIELD("VAT Calculation Type","VAT Calculation Type");
        END ELSE
          CLEAR(VATPostingSetup);
        "Prepayment VAT %" := VATPostingSetup."VAT %";
        "Prepmt. VAT Calc. Type" := VATPostingSetup."VAT Calculation Type";
        "Prepayment VAT Identifier" := VATPostingSetup."VAT Identifier";
        IF "Prepmt. VAT Calc. Type" IN
           ["Prepmt. VAT Calc. Type"::"Reverse Charge VAT","Prepmt. VAT Calc. Type"::"Sales Tax"]
        THEN
          "Prepayment VAT %" := 0;
        "Prepayment Tax Group Code" := GLAcc."Tax Group Code";
      END;
    END;

    PROCEDURE UpdateAmounts@3();
    VAR
      RemLineAmountToInvoice@1000 : Decimal;
      VATBaseAmount@1003 : Decimal;
      LineAmountChanged@1002 : Boolean;
    BEGIN
      IF CurrFieldNo <> FIELDNO("Allow Invoice Disc.") THEN
        TESTFIELD(Type);
      GetSalesHeader;
      VATBaseAmount := "VAT Base Amount";
      "Recalculate Invoice Disc." := TRUE;

      IF "Line Amount" <> xRec."Line Amount" THEN BEGIN
        "VAT Difference" := 0;
        LineAmountChanged := TRUE;
      END;
      IF "Line Amount" <> ROUND(Quantity * "Unit Price",Currency."Amount Rounding Precision") - "Line Discount Amount" THEN BEGIN
        "Line Amount" := ROUND(Quantity * "Unit Price",Currency."Amount Rounding Precision") - "Line Discount Amount";
        "VAT Difference" := 0;
        LineAmountChanged := TRUE;
      END;
      UpdateVATAmounts;
      IF NOT "Prepayment Line" THEN BEGIN
        IF "Prepayment %" <> 0 THEN BEGIN
          IF Quantity < 0 THEN
            FIELDERROR(Quantity,STRSUBSTNO(Text047,FIELDCAPTION("Prepayment %")));
          IF "Unit Price" < 0 THEN
            FIELDERROR("Unit Price",STRSUBSTNO(Text047,FIELDCAPTION("Prepayment %")));
        END;
        IF SalesHeader."Document Type" <> SalesHeader."Document Type"::Invoice THEN BEGIN
          "Prepayment VAT Difference" := 0;
          IF NOT PrePaymentLineAmountEntered THEN
            "Prepmt. Line Amount" := ROUND("Line Amount" * "Prepayment %" / 100,Currency."Amount Rounding Precision");
          IF "Prepmt. Line Amount" < "Prepmt. Amt. Inv." THEN
            FIELDERROR("Prepmt. Line Amount",STRSUBSTNO(Text049,"Prepmt. Amt. Inv."));
          PrePaymentLineAmountEntered := FALSE;
          IF "Prepmt. Line Amount" <> 0 THEN BEGIN
            RemLineAmountToInvoice :=
              ROUND("Line Amount" * (Quantity - "Quantity Invoiced") / Quantity,Currency."Amount Rounding Precision");
            IF RemLineAmountToInvoice < ("Prepmt. Line Amount" - "Prepmt Amt Deducted") THEN
              FIELDERROR("Prepmt. Line Amount",STRSUBSTNO(Text045,RemLineAmountToInvoice + "Prepmt Amt Deducted"));
          END;
        END ELSE
          IF (CurrFieldNo <> 0) AND ("Line Amount" <> xRec."Line Amount") AND
             ("Prepmt. Amt. Inv." <> 0) AND ("Prepayment %" = 100)
          THEN BEGIN
            IF "Line Amount" < xRec."Line Amount" THEN
              FIELDERROR("Line Amount",STRSUBSTNO(Text044,xRec."Line Amount"));
            FIELDERROR("Line Amount",STRSUBSTNO(Text045,xRec."Line Amount"));
          END;
      END;
      InitOutstandingAmount;
      IF (CurrFieldNo <> 0) AND
         NOT ((Type = Type::Item) AND (CurrFieldNo = FIELDNO("No.")) AND (Quantity <> 0) AND
              // a write transaction may have been started
              ("Qty. per Unit of Measure" <> xRec."Qty. per Unit of Measure")) AND // ...continued condition
         ("Document Type" <= "Document Type"::Invoice) AND
         (("Outstanding Amount" + "Shipped Not Invoiced") > 0) AND
         (CurrFieldNo <> FIELDNO("Blanket Order No."))
      THEN
        CustCheckCreditLimit.SalesLineCheck(Rec);

      IF Type = Type::"Charge (Item)" THEN
        UpdateItemChargeAssgnt;

      CalcPrepaymentToDeduct;
      IF VATBaseAmount <> "VAT Base Amount" THEN
        LineAmountChanged := TRUE;

      IF LineAmountChanged THEN BEGIN
        UpdateDeferralAmounts;
        LineAmountChanged := FALSE;
      END;
    END;

    LOCAL PROCEDURE UpdateVATAmounts@38();
    VAR
      SalesLine2@1000 : Record 37;
      TotalLineAmount@1005 : Decimal;
      TotalInvDiscAmount@1004 : Decimal;
      TotalAmount@1001 : Decimal;
      TotalAmountInclVAT@1002 : Decimal;
      TotalQuantityBase@1003 : Decimal;
    BEGIN
      GetSalesHeader;
      SalesLine2.SETRANGE("Document Type","Document Type");
      SalesLine2.SETRANGE("Document No.","Document No.");
      SalesLine2.SETFILTER("Line No.",'<>%1',"Line No.");
      IF "Line Amount" = 0 THEN
        IF xRec."Line Amount" >= 0 THEN
          SalesLine2.SETFILTER(Amount,'>%1',0)
        ELSE
          SalesLine2.SETFILTER(Amount,'<%1',0)
      ELSE
        IF "Line Amount" > 0 THEN
          SalesLine2.SETFILTER(Amount,'>%1',0)
        ELSE
          SalesLine2.SETFILTER(Amount,'<%1',0);
      SalesLine2.SETRANGE("VAT Identifier","VAT Identifier");
      SalesLine2.SETRANGE("Tax Group Code","Tax Group Code");

      IF "Line Amount" = "Inv. Discount Amount" THEN BEGIN
        Amount := 0;
        "VAT Base Amount" := 0;
        "Amount Including VAT" := 0;
      END ELSE BEGIN
        TotalLineAmount := 0;
        TotalInvDiscAmount := 0;
        TotalAmount := 0;
        TotalAmountInclVAT := 0;
        TotalQuantityBase := 0;
        IF ("VAT Calculation Type" = "VAT Calculation Type"::"Sales Tax") OR
           (("VAT Calculation Type" IN
             ["VAT Calculation Type"::"Normal VAT","VAT Calculation Type"::"Reverse Charge VAT"]) AND ("VAT %" <> 0))
        THEN
          IF NOT SalesLine2.ISEMPTY THEN BEGIN
            SalesLine2.CALCSUMS("Line Amount","Inv. Discount Amount",Amount,"Amount Including VAT","Quantity (Base)");
            TotalLineAmount := SalesLine2."Line Amount";
            TotalInvDiscAmount := SalesLine2."Inv. Discount Amount";
            TotalAmount := SalesLine2.Amount;
            TotalAmountInclVAT := SalesLine2."Amount Including VAT";
            TotalQuantityBase := SalesLine2."Quantity (Base)";
          END;

        IF SalesHeader."Prices Including VAT" THEN
          CASE "VAT Calculation Type" OF
            "VAT Calculation Type"::"Normal VAT",
            "VAT Calculation Type"::"Reverse Charge VAT":
              BEGIN
                Amount :=
                  ROUND(
                    (TotalLineAmount - TotalInvDiscAmount + "Line Amount" - "Inv. Discount Amount") / (1 + "VAT %" / 100),
                    Currency."Amount Rounding Precision") -
                  TotalAmount;
                "VAT Base Amount" :=
                  ROUND(
                    Amount * (1 - SalesHeader."VAT Base Discount %" / 100),
                    Currency."Amount Rounding Precision");
                "Amount Including VAT" :=
                  TotalLineAmount + "Line Amount" -
                  ROUND(
                    (TotalAmount + Amount) * (SalesHeader."VAT Base Discount %" / 100) * "VAT %" / 100,
                    Currency."Amount Rounding Precision",Currency.VATRoundingDirection) -
                  TotalAmountInclVAT - TotalInvDiscAmount - "Inv. Discount Amount";
              END;
            "VAT Calculation Type"::"Full VAT":
              BEGIN
                Amount := 0;
                "VAT Base Amount" := 0;
              END;
            "VAT Calculation Type"::"Sales Tax":
              BEGIN
                SalesHeader.TESTFIELD("VAT Base Discount %",0);
                Amount :=
                  SalesTaxCalculate.ReverseCalculateTax(
                    "Tax Area Code","Tax Group Code","Tax Liable",SalesHeader."Posting Date",
                    TotalAmountInclVAT + "Amount Including VAT",TotalQuantityBase + "Quantity (Base)",
                    SalesHeader."Currency Factor") -
                  TotalAmount;
                IF Amount <> 0 THEN
                  "VAT %" :=
                    ROUND(100 * ("Amount Including VAT" - Amount) / Amount,0.00001)
                ELSE
                  "VAT %" := 0;
                Amount := ROUND(Amount,Currency."Amount Rounding Precision");
                "VAT Base Amount" := Amount;
              END;
          END
        ELSE
          CASE "VAT Calculation Type" OF
            "VAT Calculation Type"::"Normal VAT",
            "VAT Calculation Type"::"Reverse Charge VAT":
              BEGIN
                Amount := ROUND("Line Amount" - "Inv. Discount Amount",Currency."Amount Rounding Precision");
                "VAT Base Amount" :=
                  ROUND(Amount * (1 - SalesHeader."VAT Base Discount %" / 100),Currency."Amount Rounding Precision");
                "Amount Including VAT" :=
                  TotalAmount + Amount +
                  ROUND(
                    (TotalAmount + Amount) * (1 - SalesHeader."VAT Base Discount %" / 100) * "VAT %" / 100,
                    Currency."Amount Rounding Precision",Currency.VATRoundingDirection) -
                  TotalAmountInclVAT;
              END;
            "VAT Calculation Type"::"Full VAT":
              BEGIN
                Amount := 0;
                "VAT Base Amount" := 0;
                "Amount Including VAT" := "Line Amount" - "Inv. Discount Amount";
              END;
            "VAT Calculation Type"::"Sales Tax":
              BEGIN
                Amount := ROUND("Line Amount" - "Inv. Discount Amount",Currency."Amount Rounding Precision");
                "VAT Base Amount" := Amount;
                "Amount Including VAT" :=
                  TotalAmount + Amount +
                  ROUND(
                    SalesTaxCalculate.CalculateTax(
                      "Tax Area Code","Tax Group Code","Tax Liable",SalesHeader."Posting Date",
                      TotalAmount + Amount,TotalQuantityBase + "Quantity (Base)",
                      SalesHeader."Currency Factor"),Currency."Amount Rounding Precision") -
                  TotalAmountInclVAT;
                IF "VAT Base Amount" <> 0 THEN
                  "VAT %" :=
                    ROUND(100 * ("Amount Including VAT" - "VAT Base Amount") / "VAT Base Amount",0.00001)
                ELSE
                  "VAT %" := 0;
              END;
          END;
      END;
    END;

    LOCAL PROCEDURE CheckItemAvailable@4(CalledByFieldNo@1000 : Integer);
    BEGIN
      IF Reserve = Reserve::Always THEN
        EXIT;

      IF "Shipment Date" = 0D THEN BEGIN
        GetSalesHeader;
        IF SalesHeader."Shipment Date" <> 0D THEN
          VALIDATE("Shipment Date",SalesHeader."Shipment Date")
        ELSE
          VALIDATE("Shipment Date",WORKDATE);
      END;

      IF ((CalledByFieldNo = CurrFieldNo) OR (CalledByFieldNo = FIELDNO("Shipment Date"))) AND GUIALLOWED AND
         ("Document Type" IN ["Document Type"::Order,"Document Type"::Invoice]) AND
         (Type = Type::Item) AND ("No." <> '') AND
         ("Outstanding Quantity" > 0) AND
         ("Job Contract Entry No." = 0) AND
         NOT (Nonstock OR "Special Order")
      THEN BEGIN
        IF ItemCheckAvail.SalesLineCheck(Rec) THEN
          ItemCheckAvail.RaiseUpdateInterruptedError;
      END;
    END;

    PROCEDURE ShowReservation@10();
    VAR
      Reservation@1000 : Page 498;
    BEGIN
      TESTFIELD(Type,Type::Item);
      TESTFIELD("No.");
      TESTFIELD(Reserve);
      CLEAR(Reservation);
      Reservation.SetSalesLine(Rec);
      Reservation.RUNMODAL;
      UpdatePlanned;
    END;

    PROCEDURE ShowReservationEntries@21(Modal@1000 : Boolean);
    VAR
      ReservEntry@1001 : Record 337;
      ReservEngineMgt@1002 : Codeunit 99000831;
    BEGIN
      TESTFIELD(Type,Type::Item);
      TESTFIELD("No.");
      ReservEngineMgt.InitFilterAndSortingLookupFor(ReservEntry,TRUE);
      ReserveSalesLine.FilterReservFor(ReservEntry,Rec);
      IF Modal THEN
        PAGE.RUNMODAL(PAGE::"Reservation Entries",ReservEntry)
      ELSE
        PAGE.RUN(PAGE::"Reservation Entries",ReservEntry);
    END;

    PROCEDURE AutoReserve@11();
    VAR
      ReservMgt@1002 : Codeunit 99000845;
      QtyToReserve@1000 : Decimal;
      QtyToReserveBase@1001 : Decimal;
    BEGIN
      TESTFIELD(Type,Type::Item);
      TESTFIELD("No.");

      ReserveSalesLine.ReservQuantity(Rec,QtyToReserve,QtyToReserveBase);
      IF QtyToReserveBase <> 0 THEN BEGIN
        ReservMgt.SetSalesLine(Rec);
        TESTFIELD("Shipment Date");
        ReservMgt.AutoReserve(FullAutoReservation,'',"Shipment Date",QtyToReserve,QtyToReserveBase);
        FIND;
        IF NOT FullAutoReservation THEN BEGIN
          COMMIT;
          IF CONFIRM(Text011,TRUE) THEN BEGIN
            ShowReservation;
            FIND;
          END;
        END;
      END;
    END;

    PROCEDURE AutoAsmToOrder@82();
    BEGIN
      ATOLink.UpdateAsmFromSalesLine(Rec);
    END;

    LOCAL PROCEDURE GetDate@22() : Date;
    BEGIN
      IF SalesHeader."Posting Date" <> 0D THEN
        EXIT(SalesHeader."Posting Date");
      EXIT(WORKDATE);
    END;

    PROCEDURE CalcPlannedDeliveryDate@92(CurrFieldNo@1000 : Integer) : Date;
    BEGIN
      IF "Shipment Date" = 0D THEN
        EXIT("Planned Delivery Date");

      CASE CurrFieldNo OF
        FIELDNO("Shipment Date"):
          EXIT(CalendarMgmt.CalcDateBOC(
              FORMAT("Shipping Time"),
              "Planned Shipment Date",
              CalChange."Source Type"::"Shipping Agent",
              "Shipping Agent Code",
              "Shipping Agent Service Code",
              CalChange."Source Type"::Customer,
              "Sell-to Customer No.",
              '',
              TRUE));
        FIELDNO("Planned Delivery Date"):
          EXIT(CalendarMgmt.CalcDateBOC2(
              FORMAT("Shipping Time"),
              "Planned Delivery Date",
              CalChange."Source Type"::Customer,
              "Sell-to Customer No.",
              '',
              CalChange."Source Type"::"Shipping Agent",
              "Shipping Agent Code",
              "Shipping Agent Service Code",
              TRUE))
      END;
    END;

    PROCEDURE CalcPlannedShptDate@93(CurrFieldNo@1000 : Integer) : Date;
    BEGIN
      IF "Shipment Date" = 0D THEN
        EXIT("Planned Shipment Date");

      CASE CurrFieldNo OF
        FIELDNO("Shipment Date"):
          EXIT(CalendarMgmt.CalcDateBOC(
              FORMAT("Outbound Whse. Handling Time"),
              "Shipment Date",
              CalChange."Source Type"::Location,
              "Location Code",
              '',
              CalChange."Source Type"::"Shipping Agent",
              "Shipping Agent Code",
              "Shipping Agent Service Code",
              TRUE));
        FIELDNO("Planned Delivery Date"):
          EXIT(CalendarMgmt.CalcDateBOC(
              FORMAT(''),
              "Planned Delivery Date",
              CalChange."Source Type"::Customer,
              "Sell-to Customer No.",
              '',
              CalChange."Source Type"::"Shipping Agent",
              "Shipping Agent Code",
              "Shipping Agent Service Code",
              TRUE));
      END;
    END;

    PROCEDURE CalcShipmentDate@111() : Date;
    BEGIN
      IF "Planned Shipment Date" = 0D THEN
        EXIT("Shipment Date");

      IF FORMAT("Outbound Whse. Handling Time") <> '' THEN
        EXIT(
          CalendarMgmt.CalcDateBOC2(
            FORMAT("Outbound Whse. Handling Time"),
            "Planned Shipment Date",
            CalChange."Source Type"::Location,
            "Location Code",
            '',
            CalChange."Source Type"::"Shipping Agent",
            "Shipping Agent Code",
            "Shipping Agent Service Code",
            FALSE));

      EXIT(
        CalendarMgmt.CalcDateBOC(
          FORMAT(FORMAT('')),
          "Planned Shipment Date",
          CalChange."Source Type"::"Shipping Agent",
          "Shipping Agent Code",
          "Shipping Agent Service Code",
          CalChange."Source Type"::Location,
          "Location Code",
          '',
          FALSE));
    END;

    PROCEDURE SignedXX@20(Value@1000 : Decimal) : Decimal;
    BEGIN
      CASE "Document Type" OF
        "Document Type"::Quote,
        "Document Type"::Order,
        "Document Type"::Invoice,
        "Document Type"::"Blanket Order":
          EXIT(-Value);
        "Document Type"::"Return Order",
        "Document Type"::"Credit Memo":
          EXIT(Value);
      END;
    END;

    LOCAL PROCEDURE BlanketOrderLookup@23();
    BEGIN
      SalesLine2.RESET;
      SalesLine2.SETCURRENTKEY("Document Type",Type,"No.");
      SalesLine2.SETRANGE("Document Type","Document Type"::"Blanket Order");
      SalesLine2.SETRANGE(Type,Type);
      SalesLine2.SETRANGE("No.","No.");
      SalesLine2.SETRANGE("Bill-to Customer No.","Bill-to Customer No.");
      SalesLine2.SETRANGE("Sell-to Customer No.","Sell-to Customer No.");
      IF PAGE.RUNMODAL(PAGE::"Sales Lines",SalesLine2) = ACTION::LookupOK THEN BEGIN
        SalesLine2.TESTFIELD("Document Type","Document Type"::"Blanket Order");
        "Blanket Order No." := SalesLine2."Document No.";
        VALIDATE("Blanket Order Line No.",SalesLine2."Line No.");
      END;
    END;

    PROCEDURE ShowDimensions@25();
    BEGIN
      "Dimension Set ID" :=
        DimMgt.EditDimensionSet("Dimension Set ID",STRSUBSTNO('%1 %2 %3',"Document Type","Document No.","Line No."));
      VerifyItemLineDim;
      DimMgt.UpdateGlobalDimFromDimSetID("Dimension Set ID","Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
      ATOLink.UpdateAsmDimFromSalesLine(Rec);
    END;

    PROCEDURE OpenItemTrackingLines@6500();
    VAR
      Job@1000 : Record 167;
    BEGIN
      TESTFIELD(Type,Type::Item);
      TESTFIELD("No.");
      TESTFIELD("Quantity (Base)");
      IF "Job Contract Entry No." <> 0 THEN
        ERROR(Text048,TABLECAPTION,Job.TABLECAPTION);
      ReserveSalesLine.CallItemTracking(Rec);
    END;

    PROCEDURE CreateDim@26(Type1@1000 : Integer;No1@1001 : Code[20];Type2@1002 : Integer;No2@1003 : Code[20];Type3@1004 : Integer;No3@1005 : Code[20]);
    VAR
      SourceCodeSetup@1006 : Record 242;
      TableID@1007 : ARRAY [10] OF Integer;
      No@1008 : ARRAY [10] OF Code[20];
    BEGIN
      SourceCodeSetup.GET;
      TableID[1] := Type1;
      No[1] := No1;
      TableID[2] := Type2;
      No[2] := No2;
      TableID[3] := Type3;
      No[3] := No3;
      "Shortcut Dimension 1 Code" := '';
      "Shortcut Dimension 2 Code" := '';
      GetSalesHeader;
      "Dimension Set ID" :=
        DimMgt.GetDefaultDimID(
          TableID,No,SourceCodeSetup.Sales,
          "Shortcut Dimension 1 Code","Shortcut Dimension 2 Code",
          SalesHeader."Dimension Set ID",DATABASE::Customer);
      DimMgt.UpdateGlobalDimFromDimSetID("Dimension Set ID","Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
      ATOLink.UpdateAsmDimFromSalesLine(Rec);
    END;

    PROCEDURE ValidateShortcutDimCode@29(FieldNumber@1000 : Integer;VAR ShortcutDimCode@1001 : Code[20]);
    BEGIN
      DimMgt.ValidateShortcutDimValues(FieldNumber,ShortcutDimCode,"Dimension Set ID");
      VerifyItemLineDim;
    END;

    PROCEDURE LookupShortcutDimCode@28(FieldNumber@1000 : Integer;VAR ShortcutDimCode@1001 : Code[20]);
    BEGIN
      DimMgt.LookupDimValueCode(FieldNumber,ShortcutDimCode);
      ValidateShortcutDimCode(FieldNumber,ShortcutDimCode);
    END;

    PROCEDURE ShowShortcutDimCode@27(VAR ShortcutDimCode@1000 : ARRAY [8] OF Code[20]);
    BEGIN
      DimMgt.GetShortcutDimensions("Dimension Set ID",ShortcutDimCode);
    END;

    PROCEDURE ShowItemSub@30();
    BEGIN
      CLEAR(SalesHeader);
      TestStatusOpen;
      ItemSubstitutionMgt.ItemSubstGet(Rec);
      IF TransferExtendedText.SalesCheckIfAnyExtText(Rec,TRUE) THEN
        TransferExtendedText.InsertSalesExtText(Rec);
    END;

    PROCEDURE ShowNonstock@32();
    BEGIN
      TESTFIELD(Type,Type::Item);
      TESTFIELD("No.",'');
      IF PAGE.RUNMODAL(PAGE::"Nonstock Item List",NonstockItem) = ACTION::LookupOK THEN BEGIN
        NonstockItem.TESTFIELD("Item Template Code");
        ConfigTemplateHeader.SETRANGE(Code,NonstockItem."Item Template Code");
        ConfigTemplateHeader.FINDFIRST;
        TempItemTemplate.InitializeTempRecordFromConfigTemplate(TempItemTemplate,ConfigTemplateHeader);
        TempItemTemplate.TESTFIELD("Gen. Prod. Posting Group");
        TempItemTemplate.TESTFIELD("Inventory Posting Group");

        "No." := NonstockItem."Entry No.";
        NonstockItemMgt.NonStockSales(Rec);
        VALIDATE("No.","No.");
        VALIDATE("Unit Price",NonstockItem."Unit Price");
      END;
    END;

    LOCAL PROCEDURE GetSalesSetup@100();
    BEGIN
      IF NOT SalesSetupRead THEN
        SalesSetup.GET;
      SalesSetupRead := TRUE;
    END;

    LOCAL PROCEDURE GetFAPostingGroup@6();
    VAR
      LocalGLAcc@1000 : Record 15;
      FASetup@1001 : Record 5603;
      FAPostingGr@1002 : Record 5606;
      FADeprBook@1003 : Record 5612;
    BEGIN
      IF (Type <> Type::"Fixed Asset") OR ("No." = '') THEN
        EXIT;
      IF "Depreciation Book Code" = '' THEN BEGIN
        FASetup.GET;
        "Depreciation Book Code" := FASetup."Default Depr. Book";
        IF NOT FADeprBook.GET("No.","Depreciation Book Code") THEN
          "Depreciation Book Code" := '';
        IF "Depreciation Book Code" = '' THEN
          EXIT;
      END;
      FADeprBook.GET("No.","Depreciation Book Code");
      FADeprBook.TESTFIELD("FA Posting Group");
      FAPostingGr.GET(FADeprBook."FA Posting Group");
      FAPostingGr.TESTFIELD("Acq. Cost Acc. on Disposal");
      LocalGLAcc.GET(FAPostingGr."Acq. Cost Acc. on Disposal");
      LocalGLAcc.CheckGLAcc;
      LocalGLAcc.TESTFIELD("Gen. Prod. Posting Group");
      "Posting Group" := FADeprBook."FA Posting Group";
      "Gen. Prod. Posting Group" := LocalGLAcc."Gen. Prod. Posting Group";
      "Tax Group Code" := LocalGLAcc."Tax Group Code";
      VALIDATE("VAT Prod. Posting Group",LocalGLAcc."VAT Prod. Posting Group");
    END;

    LOCAL PROCEDURE GetFieldCaption@31(FieldNumber@1000 : Integer) : Text[100];
    VAR
      Field@1001 : Record 2000000041;
    BEGIN
      Field.GET(DATABASE::"Sales Line",FieldNumber);
      EXIT(Field."Field Caption");
    END;

    LOCAL PROCEDURE GetCaptionClass@34(FieldNumber@1000 : Integer) : Text[80];
    VAR
      SalesHeader2@1102601000 : Record 36;
    BEGIN
      IF SalesHeader2.GET("Document Type","Document No.") THEN;
      CASE FieldNumber OF
        FIELDNO("No."):
          BEGIN
            IF ApplicationAreaSetup.IsFoundationEnabled THEN
              EXIT(STRSUBSTNO('3,%1',ItemNoFieldCaptionTxt));
            EXIT(STRSUBSTNO('3,%1',GetFieldCaption(FieldNumber)));
          END;
        ELSE BEGIN
          IF SalesHeader2."Prices Including VAT" THEN
            EXIT('2,1,' + GetFieldCaption(FieldNumber));
          EXIT('2,0,' + GetFieldCaption(FieldNumber));
        END;
      END;
    END;

    LOCAL PROCEDURE GetSKU@5806() : Boolean;
    BEGIN
      IF (SKU."Location Code" = "Location Code") AND
         (SKU."Item No." = "No.") AND
         (SKU."Variant Code" = "Variant Code")
      THEN
        EXIT(TRUE);
      IF SKU.GET("Location Code","No.","Variant Code") THEN
        EXIT(TRUE);

      EXIT(FALSE);
    END;

    PROCEDURE GetUnitCost@5808();
    BEGIN
      TESTFIELD(Type,Type::Item);
      TESTFIELD("No.");
      GetItem;
      "Qty. per Unit of Measure" := UOMMgt.GetQtyPerUnitOfMeasure(Item,"Unit of Measure Code");
      IF GetSKU THEN
        VALIDATE("Unit Cost (LCY)",SKU."Unit Cost" * "Qty. per Unit of Measure")
      ELSE
        VALIDATE("Unit Cost (LCY)",Item."Unit Cost" * "Qty. per Unit of Measure");
    END;

    LOCAL PROCEDURE CalcUnitCost@5809(ItemLedgEntry@1000 : Record 32) : Decimal;
    VAR
      ValueEntry@1001 : Record 5802;
      UnitCost@1004 : Decimal;
    BEGIN
      WITH ValueEntry DO BEGIN
        SETCURRENTKEY("Item Ledger Entry No.");
        SETRANGE("Item Ledger Entry No.",ItemLedgEntry."Entry No.");
        IF IsServiceItem THEN BEGIN
          CALCSUMS("Cost Amount (Non-Invtbl.)");
          UnitCost := "Cost Amount (Non-Invtbl.)" / ItemLedgEntry.Quantity;
        END ELSE BEGIN
          CALCSUMS("Cost Amount (Actual)","Cost Amount (Expected)");
          UnitCost :=
            ("Cost Amount (Expected)" + "Cost Amount (Actual)") / ItemLedgEntry.Quantity;
        END;
      END;

      EXIT(ABS(UnitCost * "Qty. per Unit of Measure"));
    END;

    PROCEDURE ShowItemChargeAssgnt@5801();
    VAR
      ItemChargeAssgntSales@1003 : Record 5809;
      AssignItemChargeSales@1001 : Codeunit 5807;
      ItemChargeAssgnts@1000 : Page 5814;
      ItemChargeAssgntLineAmt@1002 : Decimal;
    BEGIN
      GET("Document Type","Document No.","Line No.");
      TESTFIELD(Type,Type::"Charge (Item)");
      TESTFIELD("No.");
      TESTFIELD(Quantity);

      GetSalesHeader;
      IF SalesHeader."Currency Code" = '' THEN
        Currency.InitRoundingPrecision
      ELSE
        Currency.GET(SalesHeader."Currency Code");
      IF ("Inv. Discount Amount" = 0) AND
         ("Line Discount Amount" = 0) AND
         (NOT SalesHeader."Prices Including VAT")
      THEN
        ItemChargeAssgntLineAmt := "Line Amount"
      ELSE
        IF SalesHeader."Prices Including VAT" THEN
          ItemChargeAssgntLineAmt :=
            ROUND(("Line Amount" - "Inv. Discount Amount") / (1 + "VAT %" / 100),
              Currency."Amount Rounding Precision")
        ELSE
          ItemChargeAssgntLineAmt := "Line Amount" - "Inv. Discount Amount";

      ItemChargeAssgntSales.RESET;
      ItemChargeAssgntSales.SETRANGE("Document Type","Document Type");
      ItemChargeAssgntSales.SETRANGE("Document No.","Document No.");
      ItemChargeAssgntSales.SETRANGE("Document Line No.","Line No.");
      ItemChargeAssgntSales.SETRANGE("Item Charge No.","No.");
      IF NOT ItemChargeAssgntSales.FINDLAST THEN BEGIN
        ItemChargeAssgntSales."Document Type" := "Document Type";
        ItemChargeAssgntSales."Document No." := "Document No.";
        ItemChargeAssgntSales."Document Line No." := "Line No.";
        ItemChargeAssgntSales."Item Charge No." := "No.";
        ItemChargeAssgntSales."Unit Cost" :=
          ROUND(ItemChargeAssgntLineAmt / Quantity,
            Currency."Unit-Amount Rounding Precision");
      END;

      ItemChargeAssgntLineAmt :=
        ROUND(
          ItemChargeAssgntLineAmt * ("Qty. to Invoice" / Quantity),
          Currency."Amount Rounding Precision");

      IF "Document Type" IN ["Document Type"::"Return Order","Document Type"::"Credit Memo"] THEN
        AssignItemChargeSales.CreateDocChargeAssgn(ItemChargeAssgntSales,"Return Receipt No.")
      ELSE
        AssignItemChargeSales.CreateDocChargeAssgn(ItemChargeAssgntSales,"Shipment No.");
      CLEAR(AssignItemChargeSales);
      COMMIT;

      ItemChargeAssgnts.Initialize(Rec,ItemChargeAssgntLineAmt);
      ItemChargeAssgnts.RUNMODAL;
      CALCFIELDS("Qty. to Assign");
    END;

    PROCEDURE UpdateItemChargeAssgnt@5807();
    VAR
      ItemChargeAssgntSales@1003 : Record 5809;
      ShareOfVAT@1000 : Decimal;
      TotalQtyToAssign@1001 : Decimal;
      TotalAmtToAssign@1002 : Decimal;
    BEGIN
      IF "Document Type" = "Document Type"::"Blanket Order" THEN
        EXIT;

      CALCFIELDS("Qty. Assigned","Qty. to Assign");
      IF ABS("Quantity Invoiced") > ABS(("Qty. Assigned" + "Qty. to Assign")) THEN
        ERROR(Text055,FIELDCAPTION("Quantity Invoiced"),FIELDCAPTION("Qty. Assigned"),FIELDCAPTION("Qty. to Assign"));

      ItemChargeAssgntSales.RESET;
      ItemChargeAssgntSales.SETRANGE("Document Type","Document Type");
      ItemChargeAssgntSales.SETRANGE("Document No.","Document No.");
      ItemChargeAssgntSales.SETRANGE("Document Line No.","Line No.");
      ItemChargeAssgntSales.CALCSUMS("Qty. to Assign");
      TotalQtyToAssign := ItemChargeAssgntSales."Qty. to Assign";
      IF (CurrFieldNo <> 0) AND (Amount <> xRec.Amount) AND
         NOT ((Quantity <> xRec.Quantity) AND (TotalQtyToAssign = 0))
      THEN BEGIN
        ItemChargeAssgntSales.SETFILTER("Qty. Assigned",'<>0');
        IF NOT ItemChargeAssgntSales.ISEMPTY THEN
          ERROR(Text026,
            FIELDCAPTION(Amount));
        ItemChargeAssgntSales.SETRANGE("Qty. Assigned");
      END;

      IF ItemChargeAssgntSales.FINDSET THEN BEGIN
        GetSalesHeader;
        IF SalesHeader."Prices Including VAT" THEN
          TotalAmtToAssign :=
            ROUND(("Line Amount" - "Inv. Discount Amount") / (1 + "VAT %" / 100) - "VAT Difference",
              Currency."Amount Rounding Precision")
        ELSE
          TotalAmtToAssign := "Line Amount" - "Inv. Discount Amount";
        REPEAT
          ShareOfVAT := 1;
          IF SalesHeader."Prices Including VAT" THEN
            ShareOfVAT := 1 + "VAT %" / 100;
          IF Quantity <> 0 THEN
            IF ItemChargeAssgntSales."Unit Cost" <> ROUND(
                 ("Line Amount" - "Inv. Discount Amount") / Quantity / ShareOfVAT,
                 Currency."Unit-Amount Rounding Precision")
            THEN
              ItemChargeAssgntSales."Unit Cost" :=
                ROUND(("Line Amount" - "Inv. Discount Amount") / Quantity / ShareOfVAT,
                  Currency."Unit-Amount Rounding Precision");
          IF TotalQtyToAssign <> 0 THEN BEGIN
            ItemChargeAssgntSales."Amount to Assign" :=
              ROUND(ItemChargeAssgntSales."Qty. to Assign" / TotalQtyToAssign * TotalAmtToAssign,
                Currency."Amount Rounding Precision");
            TotalQtyToAssign -= ItemChargeAssgntSales."Qty. to Assign";
            TotalAmtToAssign -= ItemChargeAssgntSales."Amount to Assign";
          END;
          ItemChargeAssgntSales.MODIFY;
        UNTIL ItemChargeAssgntSales.NEXT = 0;
        CALCFIELDS("Qty. to Assign");
      END;
    END;

    LOCAL PROCEDURE DeleteItemChargeAssgnt@5802(DocType@1000 : Option;DocNo@1001 : Code[20];DocLineNo@1002 : Integer);
    VAR
      ItemChargeAssgntSales@1003 : Record 5809;
    BEGIN
      ItemChargeAssgntSales.SETRANGE("Applies-to Doc. Type",DocType);
      ItemChargeAssgntSales.SETRANGE("Applies-to Doc. No.",DocNo);
      ItemChargeAssgntSales.SETRANGE("Applies-to Doc. Line No.",DocLineNo);
      IF NOT ItemChargeAssgntSales.ISEMPTY THEN
        ItemChargeAssgntSales.DELETEALL(TRUE);
    END;

    LOCAL PROCEDURE DeleteChargeChargeAssgnt@5804(DocType@1000 : Option;DocNo@1001 : Code[20];DocLineNo@1002 : Integer);
    VAR
      ItemChargeAssgntSales@1003 : Record 5809;
    BEGIN
      IF DocType <> "Document Type"::"Blanket Order" THEN
        IF "Quantity Invoiced" <> 0 THEN BEGIN
          CALCFIELDS("Qty. Assigned");
          TESTFIELD("Qty. Assigned","Quantity Invoiced");
        END;

      ItemChargeAssgntSales.RESET;
      ItemChargeAssgntSales.SETRANGE("Document Type",DocType);
      ItemChargeAssgntSales.SETRANGE("Document No.",DocNo);
      ItemChargeAssgntSales.SETRANGE("Document Line No.",DocLineNo);
      IF NOT ItemChargeAssgntSales.ISEMPTY THEN
        ItemChargeAssgntSales.DELETEALL;
    END;

    LOCAL PROCEDURE CheckItemChargeAssgnt@5800();
    VAR
      ItemChargeAssgntSales@1000 : Record 5809;
    BEGIN
      ItemChargeAssgntSales.SETRANGE("Applies-to Doc. Type","Document Type");
      ItemChargeAssgntSales.SETRANGE("Applies-to Doc. No.","Document No.");
      ItemChargeAssgntSales.SETRANGE("Applies-to Doc. Line No.","Line No.");
      ItemChargeAssgntSales.SETRANGE("Document Type","Document Type");
      ItemChargeAssgntSales.SETRANGE("Document No.","Document No.");
      IF ItemChargeAssgntSales.FINDSET THEN BEGIN
        TESTFIELD("Allow Item Charge Assignment");
        REPEAT
          ItemChargeAssgntSales.TESTFIELD("Qty. to Assign",0);
        UNTIL ItemChargeAssgntSales.NEXT = 0;
      END;
    END;

    LOCAL PROCEDURE TestStatusOpen@33();
    BEGIN
      IF StatusCheckSuspended THEN
        EXIT;
      GetSalesHeader;
      IF NOT "System-Created Entry" THEN
        IF Type <> Type::" " THEN
          SalesHeader.TESTFIELD(Status,SalesHeader.Status::Open);
    END;

    PROCEDURE SuspendStatusCheck@39(Suspend@1000 : Boolean);
    BEGIN
      StatusCheckSuspended := Suspend;
    END;

    PROCEDURE UpdateVATOnLines@36(QtyType@1000 : 'General,Invoicing,Shipping';VAR SalesHeader@1001 : Record 36;VAR SalesLine@1002 : Record 37;VAR VATAmountLine@1003 : Record 290) LineWasModified : Boolean;
    VAR
      TempVATAmountLineRemainder@1004 : TEMPORARY Record 290;
      Currency@1005 : Record 4;
      NewAmount@1006 : Decimal;
      NewAmountIncludingVAT@1007 : Decimal;
      NewVATBaseAmount@1008 : Decimal;
      VATAmount@1009 : Decimal;
      VATDifference@1010 : Decimal;
      InvDiscAmount@1011 : Decimal;
      LineAmountToInvoice@1012 : Decimal;
      LineAmountToInvoiceDiscounted@1013 : Decimal;
      DeferralAmount@1014 : Decimal;
    BEGIN
      LineWasModified := FALSE;
      IF QtyType = QtyType::Shipping THEN
        EXIT;
      IF SalesHeader."Currency Code" = '' THEN
        Currency.InitRoundingPrecision
      ELSE
        Currency.GET(SalesHeader."Currency Code");

      TempVATAmountLineRemainder.DELETEALL;
      WITH SalesLine DO BEGIN
        SETRANGE("Document Type",SalesHeader."Document Type");
        SETRANGE("Document No.",SalesHeader."No.");
        LOCKTABLE;
        IF FINDSET THEN
          REPEAT
            IF NOT ZeroAmountLine(QtyType) THEN BEGIN
              DeferralAmount := GetDeferralAmount;
              VATAmountLine.GET("VAT Identifier","VAT Calculation Type","Tax Group Code",FALSE,"Line Amount" >= 0);
              IF VATAmountLine.Modified THEN BEGIN
                IF NOT TempVATAmountLineRemainder.GET(
                     "VAT Identifier","VAT Calculation Type","Tax Group Code",FALSE,"Line Amount" >= 0)
                THEN BEGIN
                  TempVATAmountLineRemainder := VATAmountLine;
                  TempVATAmountLineRemainder.INIT;
                  TempVATAmountLineRemainder.INSERT;
                END;

                IF QtyType = QtyType::General THEN
                  LineAmountToInvoice := "Line Amount"
                ELSE
                  LineAmountToInvoice :=
                    ROUND("Line Amount" * "Qty. to Invoice" / Quantity,Currency."Amount Rounding Precision");

                IF "Allow Invoice Disc." THEN BEGIN
                  IF (VATAmountLine."Inv. Disc. Base Amount" = 0) OR (LineAmountToInvoice = 0) THEN
                    InvDiscAmount := 0
                  ELSE BEGIN
                    LineAmountToInvoiceDiscounted :=
                      VATAmountLine."Invoice Discount Amount" * LineAmountToInvoice /
                      VATAmountLine."Inv. Disc. Base Amount";
                    TempVATAmountLineRemainder."Invoice Discount Amount" :=
                      TempVATAmountLineRemainder."Invoice Discount Amount" + LineAmountToInvoiceDiscounted;
                    InvDiscAmount :=
                      ROUND(
                        TempVATAmountLineRemainder."Invoice Discount Amount",Currency."Amount Rounding Precision");
                    TempVATAmountLineRemainder."Invoice Discount Amount" :=
                      TempVATAmountLineRemainder."Invoice Discount Amount" - InvDiscAmount;
                  END;
                  IF QtyType = QtyType::General THEN BEGIN
                    "Inv. Discount Amount" := InvDiscAmount;
                    CalcInvDiscToInvoice;
                  END ELSE
                    "Inv. Disc. Amount to Invoice" := InvDiscAmount;
                END ELSE
                  InvDiscAmount := 0;

                IF QtyType = QtyType::General THEN
                  IF SalesHeader."Prices Including VAT" THEN BEGIN
                    IF (VATAmountLine."Line Amount" - VATAmountLine."Invoice Discount Amount" = 0) OR
                       ("Line Amount" = 0)
                    THEN BEGIN
                      VATAmount := 0;
                      NewAmountIncludingVAT := 0;
                    END ELSE BEGIN
                      VATAmount :=
                        TempVATAmountLineRemainder."VAT Amount" +
                        VATAmountLine."VAT Amount" *
                        ("Line Amount" - "Inv. Discount Amount") /
                        (VATAmountLine."Line Amount" - VATAmountLine."Invoice Discount Amount");
                      NewAmountIncludingVAT :=
                        TempVATAmountLineRemainder."Amount Including VAT" +
                        VATAmountLine."Amount Including VAT" *
                        ("Line Amount" - "Inv. Discount Amount") /
                        (VATAmountLine."Line Amount" - VATAmountLine."Invoice Discount Amount");
                    END;
                    NewAmount :=
                      ROUND(NewAmountIncludingVAT,Currency."Amount Rounding Precision") -
                      ROUND(VATAmount,Currency."Amount Rounding Precision");
                    NewVATBaseAmount :=
                      ROUND(
                        NewAmount * (1 - SalesHeader."VAT Base Discount %" / 100),
                        Currency."Amount Rounding Precision");
                  END ELSE BEGIN
                    IF "VAT Calculation Type" = "VAT Calculation Type"::"Full VAT" THEN BEGIN
                      VATAmount := "Line Amount" - "Inv. Discount Amount";
                      NewAmount := 0;
                      NewVATBaseAmount := 0;
                    END ELSE BEGIN
                      NewAmount := "Line Amount" - "Inv. Discount Amount";
                      NewVATBaseAmount :=
                        ROUND(
                          NewAmount * (1 - SalesHeader."VAT Base Discount %" / 100),
                          Currency."Amount Rounding Precision");
                      IF VATAmountLine."VAT Base" = 0 THEN
                        VATAmount := 0
                      ELSE
                        VATAmount :=
                          TempVATAmountLineRemainder."VAT Amount" +
                          VATAmountLine."VAT Amount" * NewAmount / VATAmountLine."VAT Base";
                    END;
                    NewAmountIncludingVAT := NewAmount + ROUND(VATAmount,Currency."Amount Rounding Precision");
                  END
                ELSE BEGIN
                  IF (VATAmountLine."Line Amount" - VATAmountLine."Invoice Discount Amount") = 0 THEN
                    VATDifference := 0
                  ELSE
                    VATDifference :=
                      TempVATAmountLineRemainder."VAT Difference" +
                      VATAmountLine."VAT Difference" * (LineAmountToInvoice - InvDiscAmount) /
                      (VATAmountLine."Line Amount" - VATAmountLine."Invoice Discount Amount");
                  IF LineAmountToInvoice = 0 THEN
                    "VAT Difference" := 0
                  ELSE
                    "VAT Difference" := ROUND(VATDifference,Currency."Amount Rounding Precision");
                END;
                IF QtyType = QtyType::General THEN BEGIN
                  Amount := NewAmount;
                  "Amount Including VAT" := ROUND(NewAmountIncludingVAT,Currency."Amount Rounding Precision");
                  "VAT Base Amount" := NewVATBaseAmount;
                END;
                InitOutstanding;
                IF Type = Type::"Charge (Item)" THEN
                  UpdateItemChargeAssgnt;
                MODIFY;
                LineWasModified := TRUE;

                IF ("Deferral Code" <> '') AND (DeferralAmount <> GetDeferralAmount) THEN
                  UpdateDeferralAmounts;

                TempVATAmountLineRemainder."Amount Including VAT" :=
                  NewAmountIncludingVAT - ROUND(NewAmountIncludingVAT,Currency."Amount Rounding Precision");
                TempVATAmountLineRemainder."VAT Amount" := VATAmount - NewAmountIncludingVAT + NewAmount;
                TempVATAmountLineRemainder."VAT Difference" := VATDifference - "VAT Difference";
                TempVATAmountLineRemainder.MODIFY;
              END;
            END;
          UNTIL NEXT = 0;
      END;
    END;

    PROCEDURE CalcVATAmountLines@35(QtyType@1000 : 'General,Invoicing,Shipping';VAR SalesHeader@1001 : Record 36;VAR SalesLine@1002 : Record 37;VAR VATAmountLine@1003 : Record 290);
    VAR
      TotalVATAmount@1011 : Decimal;
      QtyToHandle@1006 : Decimal;
      AmtToHandle@1015 : Decimal;
      RoundingLineInserted@1010 : Boolean;
    BEGIN
      Currency.Initialize(SalesHeader."Currency Code");

      VATAmountLine.DELETEALL;

      WITH SalesLine DO BEGIN
        SETRANGE("Document Type",SalesHeader."Document Type");
        SETRANGE("Document No.",SalesHeader."No.");
        IF FINDSET THEN
          REPEAT
            IF NOT ZeroAmountLine(QtyType) THEN BEGIN
              IF (Type = Type::"G/L Account") AND NOT "Prepayment Line" THEN
                RoundingLineInserted := ("No." = GetCPGInvRoundAcc(SalesHeader)) OR RoundingLineInserted;
              IF "VAT Calculation Type" IN
                 ["VAT Calculation Type"::"Reverse Charge VAT","VAT Calculation Type"::"Sales Tax"]
              THEN
                "VAT %" := 0;
              IF NOT VATAmountLine.GET(
                   "VAT Identifier","VAT Calculation Type","Tax Group Code",FALSE,"Line Amount" >= 0)
              THEN
                VATAmountLine.InsertNewLine(
                  "VAT Identifier","VAT Calculation Type","Tax Group Code",FALSE,"VAT %","Line Amount" >= 0,FALSE);

              CASE QtyType OF
                QtyType::General:
                  BEGIN
                    VATAmountLine.Quantity += "Quantity (Base)";
                    VATAmountLine.SumLine(
                      "Line Amount","Inv. Discount Amount","VAT Difference","Allow Invoice Disc.","Prepayment Line");
                  END;
                QtyType::Invoicing:
                  BEGIN
                    CASE TRUE OF
                      ("Document Type" IN ["Document Type"::Order,"Document Type"::Invoice]) AND
                      (NOT SalesHeader.Ship) AND SalesHeader.Invoice AND (NOT "Prepayment Line"):
                        IF "Shipment No." = '' THEN BEGIN
                          QtyToHandle := GetAbsMin("Qty. to Invoice","Qty. Shipped Not Invoiced");
                          VATAmountLine.Quantity += GetAbsMin("Qty. to Invoice (Base)","Qty. Shipped Not Invd. (Base)");
                        END ELSE BEGIN
                          QtyToHandle := "Qty. to Invoice";
                          VATAmountLine.Quantity += "Qty. to Invoice (Base)";
                        END;
                      ("Document Type" IN ["Document Type"::"Return Order","Document Type"::"Credit Memo"]) AND
                      (NOT SalesHeader.Receive) AND SalesHeader.Invoice:
                        IF "Return Receipt No." = '' THEN BEGIN
                          QtyToHandle := GetAbsMin("Qty. to Invoice","Return Qty. Rcd. Not Invd.");
                          VATAmountLine.Quantity += GetAbsMin("Qty. to Invoice (Base)","Ret. Qty. Rcd. Not Invd.(Base)");
                        END ELSE BEGIN
                          QtyToHandle := "Qty. to Invoice";
                          VATAmountLine.Quantity += "Qty. to Invoice (Base)";
                        END;
                      ELSE
                        BEGIN
                        QtyToHandle := "Qty. to Invoice";
                        VATAmountLine.Quantity += "Qty. to Invoice (Base)";
                      END;
                    END;
                    AmtToHandle := GetLineAmountToHandle(QtyToHandle);
                    IF SalesHeader."Invoice Discount Calculation" <> SalesHeader."Invoice Discount Calculation"::Amount THEN
                      VATAmountLine.SumLine(
                        AmtToHandle,ROUND("Inv. Discount Amount" * QtyToHandle / Quantity,Currency."Amount Rounding Precision"),
                        "VAT Difference","Allow Invoice Disc.","Prepayment Line")
                    ELSE
                      VATAmountLine.SumLine(
                        AmtToHandle,"Inv. Disc. Amount to Invoice","VAT Difference","Allow Invoice Disc.","Prepayment Line");
                  END;
                QtyType::Shipping:
                  BEGIN
                    IF "Document Type" IN
                       ["Document Type"::"Return Order","Document Type"::"Credit Memo"]
                    THEN BEGIN
                      QtyToHandle := "Return Qty. to Receive";
                      VATAmountLine.Quantity += "Return Qty. to Receive (Base)";
                    END ELSE BEGIN
                      QtyToHandle := "Qty. to Ship";
                      VATAmountLine.Quantity += "Qty. to Ship (Base)";
                    END;
                    AmtToHandle := GetLineAmountToHandle(QtyToHandle);
                    VATAmountLine.SumLine(
                      AmtToHandle,ROUND("Inv. Discount Amount" * QtyToHandle / Quantity,Currency."Amount Rounding Precision"),
                      "VAT Difference","Allow Invoice Disc.","Prepayment Line");
                  END;
              END;
              TotalVATAmount += "Amount Including VAT" - Amount;
            END;
          UNTIL NEXT = 0;
      END;

      VATAmountLine.UpdateLines(
        TotalVATAmount,Currency,SalesHeader."Currency Factor",SalesHeader."Prices Including VAT",
        SalesHeader."VAT Base Discount %",SalesHeader."Tax Area Code",SalesHeader."Tax Liable",SalesHeader."Posting Date");

      IF RoundingLineInserted AND (TotalVATAmount <> 0) THEN
        IF VATAmountLine.GET(SalesLine."VAT Identifier",SalesLine."VAT Calculation Type",
             SalesLine."Tax Group Code",FALSE,SalesLine."Line Amount" >= 0)
        THEN BEGIN
          VATAmountLine."VAT Amount" += TotalVATAmount;
          VATAmountLine."Amount Including VAT" += TotalVATAmount;
          VATAmountLine."Calculated VAT Amount" += TotalVATAmount;
          VATAmountLine.MODIFY;
        END;
    END;

    PROCEDURE GetCPGInvRoundAcc@71(VAR SalesHeader@1000 : Record 36) : Code[20];
    VAR
      Cust@1002 : Record 18;
      CustTemplate@1003 : Record 5105;
      CustPostingGroup@1004 : Record 92;
    BEGIN
      GetSalesSetup;
      IF SalesSetup."Invoice Rounding" THEN
        IF Cust.GET(SalesHeader."Bill-to Customer No.") THEN
          CustPostingGroup.GET(Cust."Customer Posting Group")
        ELSE
          IF CustTemplate.GET(SalesHeader."Sell-to Customer Template Code") THEN
            CustPostingGroup.GET(CustTemplate."Customer Posting Group");

      EXIT(CustPostingGroup."Invoice Rounding Account");
    END;

    LOCAL PROCEDURE CalcInvDiscToInvoice@37();
    VAR
      OldInvDiscAmtToInv@1000 : Decimal;
    BEGIN
      GetSalesHeader;
      OldInvDiscAmtToInv := "Inv. Disc. Amount to Invoice";
      IF Quantity = 0 THEN
        VALIDATE("Inv. Disc. Amount to Invoice",0)
      ELSE
        VALIDATE(
          "Inv. Disc. Amount to Invoice",
          ROUND(
            "Inv. Discount Amount" * "Qty. to Invoice" / Quantity,
            Currency."Amount Rounding Precision"));

      IF OldInvDiscAmtToInv <> "Inv. Disc. Amount to Invoice" THEN BEGIN
        "Amount Including VAT" := "Amount Including VAT" - "VAT Difference";
        "VAT Difference" := 0;
      END;
    END;

    PROCEDURE UpdateWithWarehouseShip@41();
    BEGIN
      IF Type = Type::Item THEN
        CASE TRUE OF
          ("Document Type" IN ["Document Type"::Quote,"Document Type"::Order]) AND (Quantity >= 0):
            IF Location.RequireShipment("Location Code") THEN
              VALIDATE("Qty. to Ship",0)
            ELSE
              VALIDATE("Qty. to Ship","Outstanding Quantity");
          ("Document Type" IN ["Document Type"::Quote,"Document Type"::Order]) AND (Quantity < 0):
            IF Location.RequireReceive("Location Code") THEN
              VALIDATE("Qty. to Ship",0)
            ELSE
              VALIDATE("Qty. to Ship","Outstanding Quantity");
          ("Document Type" = "Document Type"::"Return Order") AND (Quantity >= 0):
            IF Location.RequireReceive("Location Code") THEN
              VALIDATE("Return Qty. to Receive",0)
            ELSE
              VALIDATE("Return Qty. to Receive","Outstanding Quantity");
          ("Document Type" = "Document Type"::"Return Order") AND (Quantity < 0):
            IF Location.RequireShipment("Location Code") THEN
              VALIDATE("Return Qty. to Receive",0)
            ELSE
              VALIDATE("Return Qty. to Receive","Outstanding Quantity");
        END;
      SetDefaultQuantity;
    END;

    LOCAL PROCEDURE CheckWarehouse@46();
    VAR
      Location2@1002 : Record 14;
      WhseSetup@1000 : Record 5769;
      ShowDialog@1001 : ' ,Message,Error';
      DialogText@1003 : Text[50];
    BEGIN
      GetLocation("Location Code");
      IF "Location Code" = '' THEN BEGIN
        WhseSetup.GET;
        Location2."Require Shipment" := WhseSetup."Require Shipment";
        Location2."Require Pick" := WhseSetup."Require Pick";
        Location2."Require Receive" := WhseSetup."Require Receive";
        Location2."Require Put-away" := WhseSetup."Require Put-away";
      END ELSE
        Location2 := Location;

      DialogText := Text035;
      IF ("Document Type" IN ["Document Type"::Order,"Document Type"::"Return Order"]) AND
         Location2."Directed Put-away and Pick"
      THEN BEGIN
        ShowDialog := ShowDialog::Error;
        IF (("Document Type" = "Document Type"::Order) AND (Quantity >= 0)) OR
           (("Document Type" = "Document Type"::"Return Order") AND (Quantity < 0))
        THEN
          DialogText :=
            DialogText + Location2.GetRequirementText(Location2.FIELDNO("Require Shipment"))
        ELSE
          DialogText :=
            DialogText + Location2.GetRequirementText(Location2.FIELDNO("Require Receive"));
      END ELSE BEGIN
        IF (("Document Type" = "Document Type"::Order) AND (Quantity >= 0) AND
            (Location2."Require Shipment" OR Location2."Require Pick")) OR
           (("Document Type" = "Document Type"::"Return Order") AND (Quantity < 0) AND
            (Location2."Require Shipment" OR Location2."Require Pick"))
        THEN BEGIN
          IF WhseValidateSourceLine.WhseLinesExist(
               DATABASE::"Sales Line",
               "Document Type",
               "Document No.",
               "Line No.",
               0,
               Quantity)
          THEN
            ShowDialog := ShowDialog::Error
          ELSE
            IF Location2."Require Shipment" THEN
              ShowDialog := ShowDialog::Message;
          IF Location2."Require Shipment" THEN
            DialogText :=
              DialogText + Location2.GetRequirementText(Location2.FIELDNO("Require Shipment"))
          ELSE BEGIN
            DialogText := Text036;
            DialogText :=
              DialogText + Location2.GetRequirementText(Location2.FIELDNO("Require Pick"));
          END;
        END;

        IF (("Document Type" = "Document Type"::Order) AND (Quantity < 0) AND
            (Location2."Require Receive" OR Location2."Require Put-away")) OR
           (("Document Type" = "Document Type"::"Return Order") AND (Quantity >= 0) AND
            (Location2."Require Receive" OR Location2."Require Put-away"))
        THEN BEGIN
          IF WhseValidateSourceLine.WhseLinesExist(
               DATABASE::"Sales Line",
               "Document Type",
               "Document No.",
               "Line No.",
               0,
               Quantity)
          THEN
            ShowDialog := ShowDialog::Error
          ELSE
            IF Location2."Require Receive" THEN
              ShowDialog := ShowDialog::Message;
          IF Location2."Require Receive" THEN
            DialogText :=
              DialogText + Location2.GetRequirementText(Location2.FIELDNO("Require Receive"))
          ELSE BEGIN
            DialogText := Text036;
            DialogText :=
              DialogText + Location2.GetRequirementText(Location2.FIELDNO("Require Put-away"));
          END;
        END;
      END;

      CASE ShowDialog OF
        ShowDialog::Message:
          MESSAGE(Text016 + Text017,DialogText,FIELDCAPTION("Line No."),"Line No.");
        ShowDialog::Error:
          ERROR(Text016,DialogText,FIELDCAPTION("Line No."),"Line No.");
      END;

      HandleDedicatedBin(TRUE);
    END;

    LOCAL PROCEDURE UpdateDates@43();
    BEGIN
      IF CurrFieldNo = 0 THEN BEGIN
        PlannedShipmentDateCalculated := FALSE;
        PlannedDeliveryDateCalculated := FALSE;
      END;
      IF "Promised Delivery Date" <> 0D THEN
        VALIDATE("Promised Delivery Date")
      ELSE
        IF "Requested Delivery Date" <> 0D THEN
          VALIDATE("Requested Delivery Date")
        ELSE
          VALIDATE("Shipment Date");
    END;

    PROCEDURE GetItemTranslation@42();
    VAR
      ItemTranslation@1000 : Record 30;
    BEGIN
      GetSalesHeader;
      IF ItemTranslation.GET("No.","Variant Code",SalesHeader."Language Code") THEN BEGIN
        Description := ItemTranslation.Description;
        "Description 2" := ItemTranslation."Description 2";
      END;
    END;

    LOCAL PROCEDURE GetLocation@7300(LocationCode@1000 : Code[10]);
    BEGIN
      IF LocationCode = '' THEN
        CLEAR(Location)
      ELSE
        IF Location.Code <> LocationCode THEN
          Location.GET(LocationCode);
    END;

    PROCEDURE PriceExists@44() : Boolean;
    BEGIN
      IF "Document No." <> '' THEN BEGIN
        GetSalesHeader;
        EXIT(PriceCalcMgt.SalesLinePriceExists(SalesHeader,Rec,TRUE));
      END;
      EXIT(FALSE);
    END;

    PROCEDURE LineDiscExists@45() : Boolean;
    BEGIN
      IF "Document No." <> '' THEN BEGIN
        GetSalesHeader;
        EXIT(PriceCalcMgt.SalesLineLineDiscExists(SalesHeader,Rec,TRUE));
      END;
      EXIT(FALSE);
    END;

    PROCEDURE RowID1@47() : Text[250];
    VAR
      ItemTrackingMgt@1000 : Codeunit 6500;
    BEGIN
      EXIT(ItemTrackingMgt.ComposeRowID(DATABASE::"Sales Line","Document Type",
          "Document No.",'',0,"Line No."));
    END;

    LOCAL PROCEDURE UpdateItemCrossRef@48();
    BEGIN
      DistIntegration.EnterSalesItemCrossRef(Rec);
      UpdateICPartner;
    END;

    LOCAL PROCEDURE GetDefaultBin@50();
    VAR
      WMSManagement@1000 : Codeunit 7302;
    BEGIN
      IF Type <> Type::Item THEN
        EXIT;

      "Bin Code" := '';
      IF "Drop Shipment" THEN
        EXIT;

      IF ("Location Code" <> '') AND ("No." <> '') THEN BEGIN
        GetLocation("Location Code");
        IF Location."Bin Mandatory" AND NOT Location."Directed Put-away and Pick" THEN BEGIN
          IF ("Qty. to Assemble to Order" > 0) OR IsAsmToOrderRequired THEN
            IF GetATOBin(Location,"Bin Code") THEN
              EXIT;

          WMSManagement.GetDefaultBin("No.","Variant Code","Location Code","Bin Code");
          HandleDedicatedBin(FALSE);
        END;
      END;
    END;

    PROCEDURE GetATOBin@89(Location@1001 : Record 14;VAR BinCode@1002 : Code[20]) : Boolean;
    VAR
      AsmHeader@1000 : Record 900;
    BEGIN
      IF NOT Location."Require Shipment" THEN
        BinCode := Location."Asm.-to-Order Shpt. Bin Code";
      IF BinCode <> '' THEN
        EXIT(TRUE);

      IF AsmHeader.GetFromAssemblyBin(Location,BinCode) THEN
        EXIT(TRUE);

      EXIT(FALSE);
    END;

    PROCEDURE IsInbound@97() : Boolean;
    BEGIN
      CASE "Document Type" OF
        "Document Type"::Order,"Document Type"::Invoice,"Document Type"::Quote,"Document Type"::"Blanket Order":
          EXIT("Quantity (Base)" < 0);
        "Document Type"::"Return Order","Document Type"::"Credit Memo":
          EXIT("Quantity (Base)" > 0);
      END;

      EXIT(FALSE);
    END;

    LOCAL PROCEDURE HandleDedicatedBin@70(IssueWarning@1001 : Boolean);
    VAR
      WhseIntegrationMgt@1002 : Codeunit 7317;
    BEGIN
      IF NOT IsInbound AND ("Quantity (Base)" <> 0) THEN
        WhseIntegrationMgt.CheckIfBinDedicatedOnSrcDoc("Location Code","Bin Code",IssueWarning);
    END;

    LOCAL PROCEDURE CheckAssocPurchOrder@51(TheFieldCaption@1000 : Text[250]);
    BEGIN
      IF TheFieldCaption = '' THEN BEGIN // If sales line is being deleted
        IF "Purch. Order Line No." <> 0 THEN
          ERROR(
            Text000,
            "Purchase Order No.",
            "Purch. Order Line No.");
        IF "Special Order Purch. Line No." <> 0 THEN
          ERROR(
            Text000,
            "Special Order Purchase No.",
            "Special Order Purch. Line No.");
      END;
      IF "Purch. Order Line No." <> 0 THEN
        ERROR(
          Text002,
          TheFieldCaption,
          "Purchase Order No.",
          "Purch. Order Line No.");
      IF "Special Order Purch. Line No." <> 0 THEN
        ERROR(
          Text002,
          TheFieldCaption,
          "Special Order Purchase No.",
          "Special Order Purch. Line No.");
    END;

    PROCEDURE CrossReferenceNoLookUp@53();
    VAR
      ItemCrossReference@1000 : Record 5717;
      ICGLAcc@1001 : Record 410;
    BEGIN
      CASE Type OF
        Type::Item:
          BEGIN
            GetSalesHeader;
            ItemCrossReference.RESET;
            ItemCrossReference.SETCURRENTKEY("Cross-Reference Type","Cross-Reference Type No.");
            ItemCrossReference.SETFILTER(
              "Cross-Reference Type",'%1|%2',
              ItemCrossReference."Cross-Reference Type"::Customer,
              ItemCrossReference."Cross-Reference Type"::" ");
            ItemCrossReference.SETFILTER("Cross-Reference Type No.",'%1|%2',SalesHeader."Sell-to Customer No.",'');
            IF PAGE.RUNMODAL(PAGE::"Cross Reference List",ItemCrossReference) = ACTION::LookupOK THEN BEGIN
              VALIDATE("Cross-Reference No.",ItemCrossReference."Cross-Reference No.");
              PriceCalcMgt.FindSalesLineLineDisc(SalesHeader,Rec);
              PriceCalcMgt.FindSalesLinePrice(SalesHeader,Rec,FIELDNO("Cross-Reference No."));
              VALIDATE("Unit Price");
            END;
          END;
        Type::"G/L Account",Type::Resource:
          BEGIN
            GetSalesHeader;
            SalesHeader.TESTFIELD("Sell-to IC Partner Code");
            IF PAGE.RUNMODAL(PAGE::"IC G/L Account List",ICGLAcc) = ACTION::LookupOK THEN
              "Cross-Reference No." := ICGLAcc."No.";
          END;
      END;
    END;

    LOCAL PROCEDURE CheckServItemCreation@52();
    VAR
      ServItemGroup@1000 : Record 5904;
    BEGIN
      IF CurrFieldNo = 0 THEN
        EXIT;
      IF Type <> Type::Item THEN
        EXIT;
      Item.GET("No.");
      IF Item."Service Item Group" = '' THEN
        EXIT;
      IF ServItemGroup.GET(Item."Service Item Group") THEN
        IF ServItemGroup."Create Service Item" THEN
          IF "Qty. to Ship (Base)" <> ROUND("Qty. to Ship (Base)",1) THEN
            ERROR(
              Text034,
              FIELDCAPTION("Qty. to Ship (Base)"),
              ServItemGroup.FIELDCAPTION("Create Service Item"));
    END;

    PROCEDURE ItemExists@54(ItemNo@1000 : Code[20]) : Boolean;
    VAR
      Item2@1001 : Record 27;
    BEGIN
      IF Type = Type::Item THEN
        IF NOT Item2.GET(ItemNo) THEN
          EXIT(FALSE);
      EXIT(TRUE);
    END;

    PROCEDURE IsShipment@55() : Boolean;
    BEGIN
      EXIT(SignedXX("Quantity (Base)") < 0);
    END;

    LOCAL PROCEDURE GetAbsMin@56(QtyToHandle@1000 : Decimal;QtyHandled@1001 : Decimal) : Decimal;
    BEGIN
      IF ABS(QtyHandled) < ABS(QtyToHandle) THEN
        EXIT(QtyHandled);

      EXIT(QtyToHandle);
    END;

    PROCEDURE SetHideValidationDialog@57(NewHideValidationDialog@1000 : Boolean);
    BEGIN
      HideValidationDialog := NewHideValidationDialog;
    END;

    LOCAL PROCEDURE CheckApplFromItemLedgEntry@157(VAR ItemLedgEntry@1000 : Record 32);
    VAR
      ItemTrackingLines@1003 : Page 6510;
      QtyNotReturned@1002 : Decimal;
      QtyReturned@1004 : Decimal;
    BEGIN
      IF "Appl.-from Item Entry" = 0 THEN
        EXIT;

      IF "Shipment No." <> '' THEN
        EXIT;

      TESTFIELD(Type,Type::Item);
      TESTFIELD(Quantity);
      IF "Document Type" IN ["Document Type"::"Return Order","Document Type"::"Credit Memo"] THEN BEGIN
        IF Quantity < 0 THEN
          FIELDERROR(Quantity,Text029);
      END ELSE BEGIN
        IF Quantity > 0 THEN
          FIELDERROR(Quantity,Text030);
      END;

      ItemLedgEntry.GET("Appl.-from Item Entry");
      ItemLedgEntry.TESTFIELD(Positive,FALSE);
      ItemLedgEntry.TESTFIELD("Item No.","No.");
      ItemLedgEntry.TESTFIELD("Variant Code","Variant Code");
      IF ItemLedgEntry.TrackingExists THEN
        ERROR(Text040,ItemTrackingLines.CAPTION,FIELDCAPTION("Appl.-from Item Entry"));

      IF ABS("Quantity (Base)") > -ItemLedgEntry.Quantity THEN
        ERROR(
          Text046,
          -ItemLedgEntry.Quantity,ItemLedgEntry.FIELDCAPTION("Document No."),
          ItemLedgEntry."Document No.");

      IF "Document Type" IN ["Document Type"::"Return Order","Document Type"::"Credit Memo"] THEN
        IF ABS("Outstanding Qty. (Base)") > -ItemLedgEntry."Shipped Qty. Not Returned" THEN BEGIN
          QtyNotReturned := ItemLedgEntry."Shipped Qty. Not Returned";
          QtyReturned := ItemLedgEntry.Quantity - ItemLedgEntry."Shipped Qty. Not Returned";
          IF "Qty. per Unit of Measure" <> 0 THEN BEGIN
            QtyNotReturned :=
              ROUND(ItemLedgEntry."Shipped Qty. Not Returned" / "Qty. per Unit of Measure",0.00001);
            QtyReturned :=
              ROUND(
                (ItemLedgEntry.Quantity - ItemLedgEntry."Shipped Qty. Not Returned") /
                "Qty. per Unit of Measure",0.00001);
          END;
          ERROR(
            Text039,
            -QtyReturned,ItemLedgEntry.FIELDCAPTION("Document No."),
            ItemLedgEntry."Document No.",-QtyNotReturned);
        END;
    END;

    PROCEDURE CalcPrepaymentToDeduct@63();
    BEGIN
      IF ("Qty. to Invoice" <> 0) AND ("Prepmt. Amt. Inv." <> 0) THEN BEGIN
        GetSalesHeader;
        IF ("Prepayment %" = 100) AND NOT IsFinalInvoice THEN
          "Prepmt Amt to Deduct" := GetLineAmountToHandle("Qty. to Invoice")
        ELSE
          "Prepmt Amt to Deduct" :=
            ROUND(
              ("Prepmt. Amt. Inv." - "Prepmt Amt Deducted") *
              "Qty. to Invoice" / (Quantity - "Quantity Invoiced"),Currency."Amount Rounding Precision")
      END ELSE
        "Prepmt Amt to Deduct" := 0
    END;

    PROCEDURE IsFinalInvoice@116() : Boolean;
    BEGIN
      EXIT("Qty. to Invoice" = Quantity - "Quantity Invoiced");
    END;

    PROCEDURE GetLineAmountToHandle@117(QtyToHandle@1002 : Decimal) : Decimal;
    VAR
      LineAmount@1001 : Decimal;
      LineDiscAmount@1000 : Decimal;
    BEGIN
      IF "Line Discount %" = 100 THEN
        EXIT(0);

      GetSalesHeader;
      LineAmount := ROUND(QtyToHandle * "Unit Price",Currency."Amount Rounding Precision");
      LineDiscAmount := ROUND("Line Discount Amount" * QtyToHandle / Quantity,Currency."Amount Rounding Precision");
      EXIT(LineAmount - LineDiscAmount);
    END;

    PROCEDURE SetHasBeenShown@59();
    BEGIN
      HasBeenShown := TRUE;
    END;

    LOCAL PROCEDURE TestJobPlanningLine@60();
    VAR
      JobPostLine@1000 : Codeunit 1001;
    BEGIN
      IF "Job Contract Entry No." = 0 THEN
        EXIT;

      JobPostLine.TestSalesLine(Rec);
    END;

    PROCEDURE BlockDynamicTracking@58(SetBlock@1000 : Boolean);
    BEGIN
      ReserveSalesLine.Block(SetBlock);
    END;

    PROCEDURE InitQtyToShip2@7();
    BEGIN
      "Qty. to Ship" := "Outstanding Quantity";
      "Qty. to Ship (Base)" := "Outstanding Qty. (Base)";

      ATOLink.UpdateQtyToAsmFromSalesLine(Rec);

      CheckServItemCreation;

      "Qty. to Invoice" := MaxQtyToInvoice;
      "Qty. to Invoice (Base)" := MaxQtyToInvoiceBase;
      "VAT Difference" := 0;

      CalcInvDiscToInvoice;

      CalcPrepaymentToDeduct;
    END;

    PROCEDURE ShowLineComments@61();
    VAR
      SalesCommentLine@1000 : Record 44;
      SalesCommentSheet@1001 : Page 67;
    BEGIN
      TESTFIELD("Document No.");
      TESTFIELD("Line No.");
      SalesCommentLine.SETRANGE("Document Type","Document Type");
      SalesCommentLine.SETRANGE("No.","Document No.");
      SalesCommentLine.SETRANGE("Document Line No.","Line No.");
      SalesCommentSheet.SETTABLEVIEW(SalesCommentLine);
      SalesCommentSheet.RUNMODAL;
    END;

    PROCEDURE SetDefaultQuantity@62();
    BEGIN
      GetSalesSetup;
      IF SalesSetup."Default Quantity to Ship" = SalesSetup."Default Quantity to Ship"::Blank THEN BEGIN
        IF ("Document Type" = "Document Type"::Order) OR ("Document Type" = "Document Type"::Quote) THEN BEGIN
          "Qty. to Ship" := 0;
          "Qty. to Ship (Base)" := 0;
          "Qty. to Invoice" := 0;
          "Qty. to Invoice (Base)" := 0;
        END;
        IF "Document Type" = "Document Type"::"Return Order" THEN BEGIN
          "Return Qty. to Receive" := 0;
          "Return Qty. to Receive (Base)" := 0;
          "Qty. to Invoice" := 0;
          "Qty. to Invoice (Base)" := 0;
        END;
      END;
    END;

    LOCAL PROCEDURE SetReserveWithoutPurchasingCode@198();
    BEGIN
      GetItem;
      IF Item.Reserve = Item.Reserve::Optional THEN BEGIN
        GetSalesHeader;
        Reserve := SalesHeader.Reserve;
      END ELSE
        Reserve := Item.Reserve;
    END;

    LOCAL PROCEDURE SetDefaultItemQuantity@122();
    BEGIN
      GetSalesSetup;
      IF SalesSetup."Default Item Quantity" THEN BEGIN
        VALIDATE(Quantity,1);
        CheckItemAvailable(CurrFieldNo);
      END;
    END;

    PROCEDURE UpdatePrePaymentAmounts@64();
    VAR
      ShipmentLine@1000 : Record 111;
      SalesOrderLine@1001 : Record 37;
      SalesOrderHeader@1002 : Record 36;
    BEGIN
      IF ("Document Type" <> "Document Type"::Invoice) OR ("Prepayment %" = 0) THEN
        EXIT;

      IF NOT ShipmentLine.GET("Shipment No.","Shipment Line No.") THEN BEGIN
        "Prepmt Amt to Deduct" := 0;
        "Prepmt VAT Diff. to Deduct" := 0;
      END ELSE
        IF SalesOrderLine.GET(SalesOrderLine."Document Type"::Order,ShipmentLine."Order No.",ShipmentLine."Order Line No.") THEN BEGIN
          IF ("Prepayment %" = 100) AND (Quantity <> SalesOrderLine.Quantity - SalesOrderLine."Quantity Invoiced") THEN
            "Prepmt Amt to Deduct" := "Line Amount"
          ELSE
            "Prepmt Amt to Deduct" :=
              ROUND((SalesOrderLine."Prepmt. Amt. Inv." - SalesOrderLine."Prepmt Amt Deducted") *
                Quantity / (SalesOrderLine.Quantity - SalesOrderLine."Quantity Invoiced"),Currency."Amount Rounding Precision");
          "Prepmt VAT Diff. to Deduct" := "Prepayment VAT Difference" - "Prepmt VAT Diff. Deducted";
          SalesOrderHeader.GET(SalesOrderHeader."Document Type"::Order,SalesOrderLine."Document No.");
        END ELSE BEGIN
          "Prepmt Amt to Deduct" := 0;
          "Prepmt VAT Diff. to Deduct" := 0;
        END;

      GetSalesHeader;
      SalesHeader.TESTFIELD("Prices Including VAT",SalesOrderHeader."Prices Including VAT");
      IF SalesHeader."Prices Including VAT" THEN BEGIN
        "Prepmt. Amt. Incl. VAT" := "Prepmt Amt to Deduct";
        "Prepayment Amount" :=
          ROUND(
            "Prepmt Amt to Deduct" / (1 + ("Prepayment VAT %" / 100)),
            Currency."Amount Rounding Precision");
      END ELSE BEGIN
        "Prepmt. Amt. Incl. VAT" :=
          ROUND(
            "Prepmt Amt to Deduct" * (1 + ("Prepayment VAT %" / 100)),
            Currency."Amount Rounding Precision");
        "Prepayment Amount" := "Prepmt Amt to Deduct";
      END;
      "Prepmt. Line Amount" := "Prepmt Amt to Deduct";
      "Prepmt. Amt. Inv." := "Prepmt. Line Amount";
      "Prepmt. VAT Base Amt." := "Prepayment Amount";
      "Prepmt. Amount Inv. Incl. VAT" := "Prepmt. Amt. Incl. VAT";
      "Prepmt Amt Deducted" := 0;
    END;

    PROCEDURE ZeroAmountLine@65(QtyType@1000 : 'General,Invoicing,Shipping') : Boolean;
    BEGIN
      IF Type = Type::" " THEN
        EXIT(TRUE);
      IF Quantity = 0 THEN
        EXIT(TRUE);
      IF "Unit Price" = 0 THEN
        EXIT(TRUE);
      IF QtyType = QtyType::Invoicing THEN
        IF "Qty. to Invoice" = 0 THEN
          EXIT(TRUE);
      EXIT(FALSE);
    END;

    PROCEDURE FilterLinesWithItemToPlan@69(VAR Item@1000 : Record 27;DocumentType@1001 : Option);
    BEGIN
      RESET;
      SETCURRENTKEY("Document Type",Type,"No.","Variant Code","Drop Shipment","Location Code","Shipment Date");
      SETRANGE("Document Type",DocumentType);
      SETRANGE(Type,Type::Item);
      SETRANGE("No.",Item."No.");
      SETFILTER("Variant Code",Item.GETFILTER("Variant Filter"));
      SETFILTER("Location Code",Item.GETFILTER("Location Filter"));
      SETFILTER("Drop Shipment",Item.GETFILTER("Drop Shipment Filter"));
      SETFILTER("Shortcut Dimension 1 Code",Item.GETFILTER("Global Dimension 1 Filter"));
      SETFILTER("Shortcut Dimension 2 Code",Item.GETFILTER("Global Dimension 2 Filter"));
      SETFILTER("Shipment Date",Item.GETFILTER("Date Filter"));
      SETFILTER("Outstanding Qty. (Base)",'<>0');
    END;

    PROCEDURE FindLinesWithItemToPlan@66(VAR Item@1000 : Record 27;DocumentType@1001 : Option) : Boolean;
    BEGIN
      FilterLinesWithItemToPlan(Item,DocumentType);
      EXIT(FIND('-'));
    END;

    PROCEDURE LinesWithItemToPlanExist@67(VAR Item@1000 : Record 27;DocumentType@1001 : Option) : Boolean;
    BEGIN
      FilterLinesWithItemToPlan(Item,DocumentType);
      EXIT(NOT ISEMPTY);
    END;

    LOCAL PROCEDURE DateFormularZero@73(VAR DateFormularValue@1001 : DateFormula;CalledByFieldNo@1002 : Integer;CalledByFieldCaption@1003 : Text[250]);
    VAR
      DateFormularZero@1000 : DateFormula;
    BEGIN
      EVALUATE(DateFormularZero,'<0D>');
      IF (DateFormularValue <> DateFormularZero) AND (CalledByFieldNo = CurrFieldNo) THEN
        ERROR(Text051,CalledByFieldCaption,FIELDCAPTION("Drop Shipment"));
      EVALUATE(DateFormularValue,'<0D>');
    END;

    LOCAL PROCEDURE InitQtyToAsm@76();
    BEGIN
      IF NOT IsAsmToOrderAllowed THEN BEGIN
        "Qty. to Assemble to Order" := 0;
        "Qty. to Asm. to Order (Base)" := 0;
        EXIT;
      END;

      IF ((xRec."Qty. to Asm. to Order (Base)" = 0) AND IsAsmToOrderRequired AND ("Qty. Shipped (Base)" = 0)) OR
         ((xRec."Qty. to Asm. to Order (Base)" <> 0) AND
          (xRec."Qty. to Asm. to Order (Base)" = xRec."Quantity (Base)")) OR
         ("Qty. to Asm. to Order (Base)" > "Quantity (Base)")
      THEN BEGIN
        "Qty. to Assemble to Order" := Quantity;
        "Qty. to Asm. to Order (Base)" := "Quantity (Base)";
      END;
    END;

    PROCEDURE AsmToOrderExists@72(VAR AsmHeader@1000 : Record 900) : Boolean;
    VAR
      ATOLink@1001 : Record 904;
    BEGIN
      IF NOT ATOLink.AsmExistsForSalesLine(Rec) THEN
        EXIT(FALSE);
      EXIT(AsmHeader.GET(ATOLink."Assembly Document Type",ATOLink."Assembly Document No."));
    END;

    PROCEDURE FullQtyIsForAsmToOrder@74() : Boolean;
    BEGIN
      IF "Qty. to Asm. to Order (Base)" = 0 THEN
        EXIT(FALSE);
      EXIT("Quantity (Base)" = "Qty. to Asm. to Order (Base)");
    END;

    LOCAL PROCEDURE FullReservedQtyIsForAsmToOrder@75() : Boolean;
    BEGIN
      IF "Qty. to Asm. to Order (Base)" = 0 THEN
        EXIT(FALSE);
      CALCFIELDS("Reserved Qty. (Base)");
      EXIT("Reserved Qty. (Base)" = "Qty. to Asm. to Order (Base)");
    END;

    PROCEDURE QtyBaseOnATO@86() : Decimal;
    VAR
      AsmHeader@1000 : Record 900;
    BEGIN
      IF AsmToOrderExists(AsmHeader) THEN
        EXIT(AsmHeader."Quantity (Base)");
      EXIT(0);
    END;

    PROCEDURE QtyAsmRemainingBaseOnATO@90() : Decimal;
    VAR
      AsmHeader@1000 : Record 900;
    BEGIN
      IF AsmToOrderExists(AsmHeader) THEN
        EXIT(AsmHeader."Remaining Quantity (Base)");
      EXIT(0);
    END;

    PROCEDURE QtyToAsmBaseOnATO@88() : Decimal;
    VAR
      AsmHeader@1000 : Record 900;
    BEGIN
      IF AsmToOrderExists(AsmHeader) THEN
        EXIT(AsmHeader."Quantity to Assemble (Base)");
      EXIT(0);
    END;

    PROCEDURE IsAsmToOrderAllowed@77() : Boolean;
    BEGIN
      IF NOT ("Document Type" IN ["Document Type"::Quote,"Document Type"::"Blanket Order","Document Type"::Order]) THEN
        EXIT(FALSE);
      IF Quantity < 0 THEN
        EXIT(FALSE);
      IF Type <> Type::Item THEN
        EXIT(FALSE);
      IF "No." = '' THEN
        EXIT(FALSE);
      IF "Drop Shipment" OR "Special Order" THEN
        EXIT(FALSE);
      EXIT(TRUE)
    END;

    PROCEDURE IsAsmToOrderRequired@81() : Boolean;
    BEGIN
      IF (Type <> Type::Item) OR ("No." = '') THEN
        EXIT(FALSE);
      GetItem;
      IF GetSKU THEN
        EXIT(SKU."Assembly Policy" = SKU."Assembly Policy"::"Assemble-to-Order");
      EXIT(Item."Assembly Policy" = Item."Assembly Policy"::"Assemble-to-Order");
    END;

    PROCEDURE CheckAsmToOrder@85(AsmHeader@1001 : Record 900);
    BEGIN
      TESTFIELD("Qty. to Assemble to Order",AsmHeader.Quantity);
      TESTFIELD("Document Type",AsmHeader."Document Type");
      TESTFIELD(Type,Type::Item);
      TESTFIELD("No.",AsmHeader."Item No.");
      TESTFIELD("Location Code",AsmHeader."Location Code");
      TESTFIELD("Unit of Measure Code",AsmHeader."Unit of Measure Code");
      TESTFIELD("Variant Code",AsmHeader."Variant Code");
      TESTFIELD("Shipment Date",AsmHeader."Due Date");
      IF "Document Type" = "Document Type"::Order THEN BEGIN
        AsmHeader.CALCFIELDS("Reserved Qty. (Base)");
        AsmHeader.TESTFIELD("Reserved Qty. (Base)",AsmHeader."Remaining Quantity (Base)");
      END;
      TESTFIELD("Qty. to Asm. to Order (Base)",AsmHeader."Quantity (Base)");
      IF "Outstanding Qty. (Base)" < AsmHeader."Remaining Quantity (Base)" THEN
        AsmHeader.FIELDERROR("Remaining Quantity (Base)",STRSUBSTNO(Text045,AsmHeader."Remaining Quantity (Base)"));
    END;

    PROCEDURE ShowAsmToOrderLines@80();
    VAR
      ATOLink@1000 : Record 904;
    BEGIN
      ATOLink.ShowAsmToOrderLines(Rec);
    END;

    PROCEDURE FindOpenATOEntry@96(LotNo@1003 : Code[20];SerialNo@1004 : Code[20]) : Integer;
    VAR
      PostedATOLink@1002 : Record 914;
      ItemLedgEntry@1001 : Record 32;
    BEGIN
      TESTFIELD("Document Type","Document Type"::Order);
      IF PostedATOLink.FindLinksFromSalesLine(Rec) THEN
        REPEAT
          ItemLedgEntry.SETRANGE("Document Type",ItemLedgEntry."Document Type"::"Posted Assembly");
          ItemLedgEntry.SETRANGE("Document No.",PostedATOLink."Assembly Document No.");
          ItemLedgEntry.SETRANGE("Document Line No.",0);
          ItemLedgEntry.SETRANGE("Serial No.",SerialNo);
          ItemLedgEntry.SETRANGE("Lot No.",LotNo);
          ItemLedgEntry.SETRANGE(Open,TRUE);
          IF ItemLedgEntry.FINDFIRST THEN
            EXIT(ItemLedgEntry."Entry No.");
        UNTIL PostedATOLink.NEXT = 0;
    END;

    PROCEDURE RollUpAsmCost@83();
    BEGIN
      ATOLink.RollUpCost(Rec);
    END;

    PROCEDURE RollupAsmPrice@84();
    BEGIN
      GetSalesHeader;
      ATOLink.RollUpPrice(SalesHeader,Rec);
    END;

    LOCAL PROCEDURE UpdateICPartner@78();
    VAR
      ICPartner@1000 : Record 413;
      ItemCrossReference@1001 : Record 5717;
    BEGIN
      IF SalesHeader."Send IC Document" AND
         (SalesHeader."IC Direction" = SalesHeader."IC Direction"::Outgoing) AND
         (SalesHeader."Bill-to IC Partner Code" <> '')
      THEN
        CASE Type OF
          Type::" ",Type::"Charge (Item)":
            BEGIN
              "IC Partner Ref. Type" := Type;
              "IC Partner Reference" := "No.";
            END;
          Type::"G/L Account":
            BEGIN
              "IC Partner Ref. Type" := Type;
              "IC Partner Reference" := GLAcc."Default IC Partner G/L Acc. No";
            END;
          Type::Item:
            BEGIN
              IF SalesHeader."Sell-to IC Partner Code" <> '' THEN
                ICPartner.GET(SalesHeader."Sell-to IC Partner Code")
              ELSE
                ICPartner.GET(SalesHeader."Bill-to IC Partner Code");
              CASE ICPartner."Outbound Sales Item No. Type" OF
                ICPartner."Outbound Sales Item No. Type"::"Common Item No.":
                  VALIDATE("IC Partner Ref. Type","IC Partner Ref. Type"::"Common Item No.");
                ICPartner."Outbound Sales Item No. Type"::"Internal No.",
                ICPartner."Outbound Sales Item No. Type"::"Cross Reference":
                  BEGIN
                    IF ICPartner."Outbound Sales Item No. Type" = ICPartner."Outbound Sales Item No. Type"::"Internal No." THEN
                      VALIDATE("IC Partner Ref. Type","IC Partner Ref. Type"::Item)
                    ELSE
                      VALIDATE("IC Partner Ref. Type","IC Partner Ref. Type"::"Cross Reference");
                    ItemCrossReference.SETRANGE("Cross-Reference Type",ItemCrossReference."Cross-Reference Type"::Customer);
                    ItemCrossReference.SETRANGE("Cross-Reference Type No.","Sell-to Customer No.");
                    ItemCrossReference.SETRANGE("Item No.","No.");
                    ItemCrossReference.SETRANGE("Variant Code","Variant Code");
                    ItemCrossReference.SETRANGE("Unit of Measure","Unit of Measure Code");
                    IF ItemCrossReference.FINDFIRST THEN
                      "IC Partner Reference" := ItemCrossReference."Cross-Reference No."
                    ELSE
                      "IC Partner Reference" := "No.";
                  END;
              END;
            END;
          Type::"Fixed Asset":
            BEGIN
              "IC Partner Ref. Type" := "IC Partner Ref. Type"::" ";
              "IC Partner Reference" := '';
            END;
          Type::Resource:
            BEGIN
              Resource.GET("No.");
              "IC Partner Ref. Type" := "IC Partner Ref. Type"::"G/L Account";
              "IC Partner Reference" := Resource."IC Partner Purch. G/L Acc. No.";
            END;
        END;
    END;

    PROCEDURE OutstandingInvoiceAmountFromShipment@12(SellToCustomerNo@1000 : Code[20]) : Decimal;
    VAR
      SalesLine@1001 : Record 37;
    BEGIN
      SalesLine.SETCURRENTKEY("Document Type","Sell-to Customer No.","Shipment No.");
      SalesLine.SETRANGE("Document Type",SalesLine."Document Type"::Invoice);
      SalesLine.SETRANGE("Sell-to Customer No.",SellToCustomerNo);
      SalesLine.SETFILTER("Shipment No.",'<>%1','');
      SalesLine.CALCSUMS("Outstanding Amount (LCY)");
      EXIT(SalesLine."Outstanding Amount (LCY)");
    END;

    LOCAL PROCEDURE CheckShipmentRelation@94();
    VAR
      SalesShptLine@1001 : Record 111;
    BEGIN
      SalesShptLine.GET("Shipment No.","Shipment Line No.");
      IF (Quantity * SalesShptLine."Qty. Shipped Not Invoiced") < 0 THEN
        FIELDERROR("Qty. to Invoice",Text057);
      IF ABS(Quantity) > ABS(SalesShptLine."Qty. Shipped Not Invoiced") THEN
        ERROR(Text058,SalesShptLine."Document No.");
    END;

    LOCAL PROCEDURE CheckRetRcptRelation@95();
    VAR
      ReturnRcptLine@1000 : Record 6661;
    BEGIN
      ReturnRcptLine.GET("Return Receipt No.","Return Receipt Line No.");
      IF (Quantity * (ReturnRcptLine.Quantity - ReturnRcptLine."Quantity Invoiced")) < 0 THEN
        FIELDERROR("Qty. to Invoice",Text059);
      IF ABS(Quantity) > ABS(ReturnRcptLine.Quantity - ReturnRcptLine."Quantity Invoiced") THEN
        ERROR(Text060,ReturnRcptLine."Document No.");
    END;

    LOCAL PROCEDURE VerifyItemLineDim@87();
    BEGIN
      IF IsShippedReceivedItemDimChanged THEN
        ConfirmShippedReceivedItemDimChange;
    END;

    PROCEDURE IsShippedReceivedItemDimChanged@113() : Boolean;
    BEGIN
      EXIT(("Dimension Set ID" <> xRec."Dimension Set ID") AND (Type = Type::Item) AND
        (("Qty. Shipped Not Invoiced" <> 0) OR ("Return Rcd. Not Invd." <> 0)));
    END;

    PROCEDURE ConfirmShippedReceivedItemDimChange@114() : Boolean;
    BEGIN
      IF NOT CONFIRM(Text053,TRUE,TABLECAPTION) THEN
        ERROR(Text054);

      EXIT(TRUE);
    END;

    PROCEDURE InitType@91();
    BEGIN
      IF "Document No." <> '' THEN BEGIN
        SalesHeader.GET("Document Type","Document No.");
        IF (SalesHeader.Status = SalesHeader.Status::Released) AND
           (xRec.Type IN [xRec.Type::Item,xRec.Type::"Fixed Asset"])
        THEN
          Type := Type::" "
        ELSE
          Type := xRec.Type;
      END;
    END;

    LOCAL PROCEDURE CheckWMS@98();
    BEGIN
      IF CurrFieldNo <> 0 THEN
        CheckLocationOnWMS;
    END;

    PROCEDURE CheckLocationOnWMS@101();
    VAR
      DialogText@1001 : Text;
    BEGIN
      IF Type = Type::Item THEN BEGIN
        DialogText := Text035;
        IF "Quantity (Base)" <> 0 THEN
          CASE "Document Type" OF
            "Document Type"::Invoice:
              IF "Shipment No." = '' THEN
                IF Location.GET("Location Code") AND Location."Directed Put-away and Pick" THEN BEGIN
                  DialogText += Location.GetRequirementText(Location.FIELDNO("Require Shipment"));
                  ERROR(Text016,DialogText,FIELDCAPTION("Line No."),"Line No.");
                END;
            "Document Type"::"Credit Memo":
              IF "Return Receipt No." = '' THEN
                IF Location.GET("Location Code") AND Location."Directed Put-away and Pick" THEN BEGIN
                  DialogText += Location.GetRequirementText(Location.FIELDNO("Require Receive"));
                  ERROR(Text016,DialogText,FIELDCAPTION("Line No."),"Line No.");
                END;
          END;
      END;
    END;

    PROCEDURE IsServiceItem@68() : Boolean;
    BEGIN
      IF Type <> Type::Item THEN
        EXIT(FALSE);
      IF "No." = '' THEN
        EXIT(FALSE);
      GetItem;
      EXIT(Item.Type = Item.Type::Service);
    END;

    LOCAL PROCEDURE ValidateReturnReasonCode@99(CallingFieldNo@1000 : Integer);
    VAR
      ReturnReason@1001 : Record 6635;
    BEGIN
      IF CallingFieldNo = 0 THEN
        EXIT;
      IF "Return Reason Code" = '' THEN
        UpdateUnitPrice(CallingFieldNo);

      IF ReturnReason.GET("Return Reason Code") THEN BEGIN
        IF (CallingFieldNo <> FIELDNO("Location Code")) AND (ReturnReason."Default Location Code" <> '') THEN
          VALIDATE("Location Code",ReturnReason."Default Location Code");
        IF ReturnReason."Inventory Value Zero" THEN
          VALIDATE("Unit Cost (LCY)",0)
        ELSE
          IF "Unit Price" = 0 THEN
            UpdateUnitPrice(CallingFieldNo);
      END;
    END;

    PROCEDURE HasTypeToFillMandatotyFields@103() : Boolean;
    BEGIN
      EXIT(Type <> Type::" ");
    END;

    PROCEDURE GetDeferralAmount@104() DeferralAmount : Decimal;
    BEGIN
      IF "VAT Base Amount" <> 0 THEN
        DeferralAmount := "VAT Base Amount"
      ELSE
        DeferralAmount := "Line Amount" - "Inv. Discount Amount";
    END;

    LOCAL PROCEDURE UpdateDeferralAmounts@105();
    VAR
      AdjustStartDate@1000 : Boolean;
    BEGIN
      GetSalesHeader;
      DeferralPostDate := SalesHeader."Posting Date";
      AdjustStartDate := TRUE;
      IF "Document Type" = "Document Type"::"Return Order" THEN BEGIN
        IF "Returns Deferral Start Date" = 0D THEN
          "Returns Deferral Start Date" := SalesHeader."Posting Date";
        DeferralPostDate := "Returns Deferral Start Date";
        AdjustStartDate := FALSE;
      END;

      DeferralUtilities.RemoveOrSetDeferralSchedule(
        "Deferral Code",DeferralUtilities.GetSalesDeferralDocType,'','',
        "Document Type","Document No.","Line No.",
        GetDeferralAmount,DeferralPostDate,Description,SalesHeader."Currency Code",AdjustStartDate);
    END;

    PROCEDURE ShowDeferrals@106(PostingDate@1000 : Date;CurrencyCode@1001 : Code[10]) : Boolean;
    BEGIN
      EXIT(DeferralUtilities.OpenLineScheduleEdit(
          "Deferral Code",DeferralUtilities.GetSalesDeferralDocType,'','',
          "Document Type","Document No.","Line No.",
          GetDeferralAmount,PostingDate,Description,CurrencyCode));
    END;

    LOCAL PROCEDURE InitHeaderDefaults@107(SalesHeader@1000 : Record 36);
    BEGIN
      IF SalesHeader."Document Type" = SalesHeader."Document Type"::Quote THEN BEGIN
        IF (SalesHeader."Sell-to Customer No." = '') AND
           (SalesHeader."Sell-to Customer Template Code" = '')
        THEN
          ERROR(
            Text031,
            SalesHeader.FIELDCAPTION("Sell-to Customer No."),
            SalesHeader.FIELDCAPTION("Sell-to Customer Template Code"));
        IF (SalesHeader."Bill-to Customer No." = '') AND
           (SalesHeader."Bill-to Customer Template Code" = '')
        THEN
          ERROR(
            Text031,
            SalesHeader.FIELDCAPTION("Bill-to Customer No."),
            SalesHeader.FIELDCAPTION("Bill-to Customer Template Code"));
      END ELSE
        SalesHeader.TESTFIELD("Sell-to Customer No.");

      "Sell-to Customer No." := SalesHeader."Sell-to Customer No.";
      "Currency Code" := SalesHeader."Currency Code";
      IF NOT IsServiceItem THEN
        "Location Code" := SalesHeader."Location Code";
      "Customer Price Group" := SalesHeader."Customer Price Group";
      "Customer Disc. Group" := SalesHeader."Customer Disc. Group";
      "Allow Line Disc." := SalesHeader."Allow Line Disc.";
      "Transaction Type" := SalesHeader."Transaction Type";
      "Transport Method" := SalesHeader."Transport Method";
      "Bill-to Customer No." := SalesHeader."Bill-to Customer No.";
      "Gen. Bus. Posting Group" := SalesHeader."Gen. Bus. Posting Group";
      "VAT Bus. Posting Group" := SalesHeader."VAT Bus. Posting Group";
      "Exit Point" := SalesHeader."Exit Point";
      Area := SalesHeader.Area;
      "Transaction Specification" := SalesHeader."Transaction Specification";
      "Tax Area Code" := SalesHeader."Tax Area Code";
      "Tax Liable" := SalesHeader."Tax Liable";
      IF NOT "System-Created Entry" AND ("Document Type" = "Document Type"::Order) AND (Type <> Type::" ") THEN
        "Prepayment %" := SalesHeader."Prepayment %";
      "Prepayment Tax Area Code" := SalesHeader."Tax Area Code";
      "Prepayment Tax Liable" := SalesHeader."Tax Liable";
      "Responsibility Center" := SalesHeader."Responsibility Center";

      "Account Code" := SalesHeader."Account Code";
      "Shipping Agent Code" := SalesHeader."Shipping Agent Code";
      "Shipping Agent Service Code" := SalesHeader."Shipping Agent Service Code";
      "Outbound Whse. Handling Time" := SalesHeader."Outbound Whse. Handling Time";
      "Shipping Time" := SalesHeader."Shipping Time";
    END;

    LOCAL PROCEDURE InitDeferralCode@108();
    BEGIN
      IF "Document Type" IN
         ["Document Type"::Order,"Document Type"::Invoice,"Document Type"::"Credit Memo","Document Type"::"Return Order"]
      THEN
        CASE Type OF
          Type::"G/L Account":
            VALIDATE("Deferral Code",GLAcc."Default Deferral Template Code");
          Type::Item:
            VALIDATE("Deferral Code",Item."Default Deferral Template Code");
          Type::Resource:
            VALIDATE("Deferral Code",Res."Default Deferral Template Code");
        END;
    END;

    PROCEDURE DefaultDeferralCode@109();
    BEGIN
      CASE Type OF
        Type::"G/L Account":
          BEGIN
            GLAcc.GET("No.");
            InitDeferralCode;
          END;
        Type::Item:
          BEGIN
            GetItem;
            InitDeferralCode;
          END;
        Type::Resource:
          BEGIN
            Res.GET("No.");
            InitDeferralCode;
          END;
      END;
    END;

    PROCEDURE IsCreditDocType@110() : Boolean;
    BEGIN
      EXIT("Document Type" IN ["Document Type"::"Return Order","Document Type"::"Credit Memo"]);
    END;

    LOCAL PROCEDURE IsFullyInvoiced@224() : Boolean;
    BEGIN
      EXIT(("Qty. Shipped Not Invd. (Base)" = 0) AND ("Qty. Shipped (Base)" = "Quantity (Base)"))
    END;

    LOCAL PROCEDURE CleanSpecialOrderFieldsAndCheckAssocPurchOrder@125();
    BEGIN
      IF ("Special Order Purch. Line No." <> 0) AND IsFullyInvoiced THEN
        IF CleanPurchaseLineSpecialOrderFields THEN BEGIN
          "Special Order Purchase No." := '';
          "Special Order Purch. Line No." := 0;
        END;
      CheckAssocPurchOrder('');
    END;

    LOCAL PROCEDURE CleanPurchaseLineSpecialOrderFields@219() : Boolean;
    VAR
      PurchaseLine@1000 : Record 39;
    BEGIN
      IF PurchaseLine.GET(PurchaseLine."Document Type"::Order,"Special Order Purchase No.","Special Order Purch. Line No.") THEN BEGIN
        IF PurchaseLine."Qty. Received (Base)" < "Qty. Shipped (Base)" THEN
          EXIT(FALSE);

        PurchaseLine."Special Order" := FALSE;
        PurchaseLine."Special Order Sales No." := '';
        PurchaseLine."Special Order Sales Line No." := 0;
        PurchaseLine.MODIFY;
      END;

      EXIT(TRUE);
    END;

    LOCAL PROCEDURE FindNoFromTypedValue@112(Value@1000 : Code[20]) : Code[20];
    BEGIN
      CASE Type OF
        Type::Item:
          EXIT(Item.GetItemNo(Value));
        ELSE
          EXIT("No.");
      END;
    END;

    PROCEDURE CanEditUnitOfMeasureCode@115() : Boolean;
    VAR
      ItemUnitOfMeasure@1000 : Record 5404;
    BEGIN
      IF (Type = Type::Item) AND ("No." <> '') THEN BEGIN
        ItemUnitOfMeasure.SETRANGE("Item No.","No.");
        EXIT(ItemUnitOfMeasure.COUNT > 1);
      END;
      EXIT(TRUE);
    END;

    PROCEDURE LookupUnitOfMeasureCode@118();
    VAR
      ItemUnitOfMeasure@1002 : Record 5404;
      ResourceUnitOfMeasure@1001 : Record 205;
      UnitOfMeasure@1000 : Record 204;
    BEGIN
      IF NOT CanEditUnitOfMeasureCode THEN
        EXIT;

      CASE TRUE OF
        (Type = Type::Item) AND ("No." <> ''):
          BEGIN
            ItemUnitOfMeasure.SETRANGE("Item No.","No.");
            IF PAGE.RUNMODAL(0,ItemUnitOfMeasure) = ACTION::LookupOK THEN
              VALIDATE("Unit of Measure Code",ItemUnitOfMeasure.Code);
          END;
        (Type = Type::Resource) AND ("No." <> ''):
          BEGIN
            ResourceUnitOfMeasure.SETRANGE("Resource No.","No.");
            IF PAGE.RUNMODAL(0,ResourceUnitOfMeasure) = ACTION::LookupOK THEN
              VALIDATE("Unit of Measure Code",ResourceUnitOfMeasure.Code);
          END;
        ELSE
          IF PAGE.RUNMODAL(0,UnitOfMeasure) = ACTION::LookupOK THEN
            VALIDATE("Unit of Measure Code",UnitOfMeasure.Code);
      END;
    END;

    LOCAL PROCEDURE ValidateTaxGroupCode@79();
    VAR
      TaxGroup@1000 : Record 321;
      TaxDetail@1001 : Record 322;
    BEGIN
      IF "Tax Group Code" = '' THEN
        EXIT;
      IF NOT TaxGroup.GET("Tax Group Code") THEN BEGIN
        TaxGroup.SETFILTER(Code,"Tax Group Code" + '*');
        IF TaxGroup.FINDFIRST THEN
          "Tax Group Code" := TaxGroup.Code
        ELSE
          TaxGroup.CreateTaxGroup("Tax Group Code");
      END;
      IF "Tax Area Code" <> '' THEN
        TaxDetail.ValidateTaxSetup("Tax Area Code","Tax Group Code");
    END;

    PROCEDURE InsertFreightLine@121(VAR FreightAmount@1000 : Decimal);
    VAR
      SalesLine@1001 : Record 37;
    BEGIN
      IF FreightAmount <= 0 THEN BEGIN
        FreightAmount := 0;
        EXIT;
      END;

      SalesSetup.GET;
      SalesSetup.TESTFIELD("Freight G/L Acc. No.");

      TESTFIELD("Document Type");
      TESTFIELD("Document No.");

      SalesLine.SETRANGE("Document Type","Document Type");
      SalesLine.SETRANGE("Document No.","Document No.");

      SalesLine.SETRANGE(Type,SalesLine.Type::"G/L Account");
      SalesLine.SETRANGE("No.",SalesSetup."Freight G/L Acc. No.");
      IF SalesLine.FINDFIRST THEN BEGIN
        SalesLine.VALIDATE(Quantity,1);
        SalesLine.VALIDATE("Unit Price",FreightAmount);
        SalesLine.MODIFY;
      END ELSE BEGIN
        SalesLine.SETRANGE(Type);
        SalesLine.SETRANGE("No.");
        SalesLine.FINDLAST;
        SalesLine."Line No." += 10000;

        SalesLine.INIT;
        SalesLine.VALIDATE(Type,SalesLine.Type::"G/L Account");
        SalesLine.VALIDATE("No.",SalesSetup."Freight G/L Acc. No.");
        SalesLine.VALIDATE(Description,FreightLineDescriptionTxt);
        SalesLine.VALIDATE(Quantity,1);
        SalesLine.VALIDATE("Unit Price",FreightAmount);
        SalesLine.INSERT;
      END;
    END;

    PROCEDURE IsLookupRequested@119() Result : Boolean;
    BEGIN
      Result := LookupRequested;
      LookupRequested := FALSE;
    END;

    PROCEDURE ClearSalesHeader@120();
    BEGIN
      CLEAR(SalesHeader);
    END;

    PROCEDURE RenameNo@123(LineType@1002 : Option;OriginalNo@1003 : Code[20];NewNo@1004 : Code[20]);
    BEGIN
      RESET;
      SETRANGE(Type,LineType);
      SETRANGE("No.",OriginalNo);
      MODIFYALL("No.",NewNo);
    END;

    PROCEDURE UpdatePlanned@124() : Boolean;
    BEGIN
      TESTFIELD("Qty. per Unit of Measure");
      CALCFIELDS("Reserved Quantity");
      IF Planned = ("Reserved Quantity" = "Outstanding Quantity") THEN
        EXIT(FALSE);
      Planned := NOT Planned;
      EXIT(TRUE);
    END;

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 01.09.17 JAL Item Calculation (Kalkyle)
                       New field "Calulation No."
    }
    END.
  }
}

OBJECT Table 97 Comment Line
{
  OBJECT-PROPERTIES
  {
    Date=01.09.17;
    Time=13.46.52;
    Modified=Yes;
    Version List=NAVW17.001,ICA2.01;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Comment Line;
               NOR=Merknadslinje];
    LookupPageID=Page125;
    DrillDownPageID=Page125;
  }
  FIELDS
  {
    { 1   ;   ;Table Name          ;Option        ;CaptionML=[ENU=Table Name;
                                                              NOR=Tabellnavn];
                                                   OptionCaptionML=[ENU=G/L Account,Customer,Vendor,Item,Resource,Job,,Resource Group,Bank Account,Campaign,Fixed Asset,Insurance,Nonstock Item,IC Partner,Project;
                                                                    NOR=Finanskonto,Kunde,Leverand›r,Vare,Ressurs,Prosjekt,,Ressursgruppe,Bankkonto,Kampanje,Aktiva,Forsikring,Katalogvare,KI-partner,Project];
                                                   OptionString=G/L Account,Customer,Vendor,Item,Resource,Job,,Resource Group,Bank Account,Campaign,Fixed Asset,Insurance,Nonstock Item,IC Partner,Project }
    { 2   ;   ;No.                 ;Code20        ;TableRelation=IF (Table Name=CONST(G/L Account)) "G/L Account"
                                                                 ELSE IF (Table Name=CONST(Customer)) Customer
                                                                 ELSE IF (Table Name=CONST(Vendor)) Vendor
                                                                 ELSE IF (Table Name=CONST(Item)) Item
                                                                 ELSE IF (Table Name=CONST(Resource)) Resource
                                                                 ELSE IF (Table Name=CONST(Job)) Job
                                                                 ELSE IF (Table Name=CONST(Resource Group)) "Resource Group"
                                                                 ELSE IF (Table Name=CONST(Bank Account)) "Bank Account"
                                                                 ELSE IF (Table Name=CONST(Campaign)) Campaign
                                                                 ELSE IF (Table Name=CONST(Fixed Asset)) "Fixed Asset"
                                                                 ELSE IF (Table Name=CONST(Insurance)) Insurance
                                                                 ELSE IF (Table Name=CONST(IC Partner)) "IC Partner";
                                                   CaptionML=[ENU=No.;
                                                              NOR=Nr.] }
    { 3   ;   ;Line No.            ;Integer       ;CaptionML=[ENU=Line No.;
                                                              NOR=Linjenr.] }
    { 4   ;   ;Date                ;Date          ;CaptionML=[ENU=Date;
                                                              NOR=Dato] }
    { 5   ;   ;Code                ;Code10        ;CaptionML=[ENU=Code;
                                                              NOR=Kode] }
    { 6   ;   ;Comment             ;Text80        ;CaptionML=[ENU=Comment;
                                                              NOR=Merknad] }
  }
  KEYS
  {
    {    ;Table Name,No.,Line No.                 ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    PROCEDURE SetUpNewLine@1();
    VAR
      CommentLine@1000 : Record 97;
    BEGIN
      CommentLine.SETRANGE("Table Name","Table Name");
      CommentLine.SETRANGE("No.","No.");
      CommentLine.SETRANGE(Date,WORKDATE);
      IF NOT CommentLine.FINDFIRST THEN
        Date := WORKDATE;
    END;

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 01.09.17 JAL Item Calculation (Kalkyle)
                       New "Table Name" option "Project"
    }
    END.
  }
}

OBJECT Table 111 Sales Shipment Line
{
  OBJECT-PROPERTIES
  {
    Date=08.09.17;
    Time=13.08.14;
    Modified=Yes;
    Version List=NAVW110.00.00.16585,NAVNO10.00.00.16585,ICA2.01;
  }
  PROPERTIES
  {
    Permissions=TableData 32=r,
                TableData 5802=r;
    OnDelete=VAR
               ServItem@1000 : Record 5940;
               SalesDocLineComments@1001 : Record 44;
             BEGIN
               ServItem.RESET;
               ServItem.SETCURRENTKEY("Sales/Serv. Shpt. Document No.","Sales/Serv. Shpt. Line No.");
               ServItem.SETRANGE("Sales/Serv. Shpt. Document No.","Document No.");
               ServItem.SETRANGE("Sales/Serv. Shpt. Line No.","Line No.");
               ServItem.SETRANGE("Shipment Type",ServItem."Shipment Type"::Sales);
               IF ServItem.FIND('-') THEN
                 REPEAT
                   ServItem.VALIDATE("Sales/Serv. Shpt. Document No.",'');
                   ServItem.VALIDATE("Sales/Serv. Shpt. Line No.",0);
                   ServItem.MODIFY(TRUE);
                 UNTIL ServItem.NEXT = 0;

               SalesDocLineComments.SETRANGE("Document Type",SalesDocLineComments."Document Type"::Shipment);
               SalesDocLineComments.SETRANGE("No.","Document No.");
               SalesDocLineComments.SETRANGE("Document Line No.","Line No.");
               IF NOT SalesDocLineComments.ISEMPTY THEN
                 SalesDocLineComments.DELETEALL;

               PostedATOLink.DeleteAsmFromSalesShptLine(Rec);
             END;

    CaptionML=[ENU=Sales Shipment Line;
               NOR=F›lgeseddellinje];
    LookupPageID=Page525;
    DrillDownPageID=Page525;
  }
  FIELDS
  {
    { 2   ;   ;Sell-to Customer No.;Code20        ;TableRelation=Customer;
                                                   CaptionML=[ENU=Sell-to Customer No.;
                                                              NOR=Salg til-kundenr.];
                                                   Editable=No }
    { 3   ;   ;Document No.        ;Code20        ;TableRelation="Sales Shipment Header";
                                                   CaptionML=[ENU=Document No.;
                                                              NOR=Bilagsnr.] }
    { 4   ;   ;Line No.            ;Integer       ;CaptionML=[ENU=Line No.;
                                                              NOR=Linjenr.] }
    { 5   ;   ;Type                ;Option        ;CaptionML=[ENU=Type;
                                                              NOR=Type];
                                                   OptionCaptionML=[ENU=" ,G/L Account,Item,Resource,Fixed Asset,Charge (Item)";
                                                                    NOR=" ,Finanskonto,Vare,Ressurs,Aktiva,Gebyr (vare)"];
                                                   OptionString=[ ,G/L Account,Item,Resource,Fixed Asset,Charge (Item)] }
    { 6   ;   ;No.                 ;Code20        ;TableRelation=IF (Type=CONST(G/L Account)) "G/L Account"
                                                                 ELSE IF (Type=CONST(Item)) Item
                                                                 ELSE IF (Type=CONST(Resource)) Resource
                                                                 ELSE IF (Type=CONST(Fixed Asset)) "Fixed Asset"
                                                                 ELSE IF (Type=CONST("Charge (Item)")) "Item Charge";
                                                   CaptionML=[ENU=No.;
                                                              NOR=Nr.];
                                                   CaptionClass=GetCaptionClass(FIELDNO("No.")) }
    { 7   ;   ;Location Code       ;Code10        ;TableRelation=Location WHERE (Use As In-Transit=CONST(No));
                                                   CaptionML=[ENU=Location Code;
                                                              NOR=Lokasjonskode] }
    { 8   ;   ;Posting Group       ;Code10        ;TableRelation=IF (Type=CONST(Item)) "Inventory Posting Group"
                                                                 ELSE IF (Type=CONST(Fixed Asset)) "FA Posting Group";
                                                   CaptionML=[ENU=Posting Group;
                                                              NOR=Bokf›ringsgruppe];
                                                   Editable=No }
    { 10  ;   ;Shipment Date       ;Date          ;CaptionML=[ENU=Shipment Date;
                                                              NOR=Forsendelsesdato] }
    { 11  ;   ;Description         ;Text50        ;CaptionML=[ENU=Description;
                                                              NOR=Beskrivelse] }
    { 12  ;   ;Description 2       ;Text50        ;CaptionML=[ENU=Description 2;
                                                              NOR=Beskrivelse 2] }
    { 13  ;   ;Unit of Measure     ;Text10        ;CaptionML=[ENU=Unit of Measure;
                                                              NOR=Enhet] }
    { 15  ;   ;Quantity            ;Decimal       ;CaptionML=[ENU=Quantity;
                                                              NOR=Antall];
                                                   DecimalPlaces=0:5 }
    { 22  ;   ;Unit Price          ;Decimal       ;CaptionML=[ENU=Unit Price;
                                                              NOR=Salgspris];
                                                   AutoFormatType=2;
                                                   AutoFormatExpr=GetCurrencyCode }
    { 23  ;   ;Unit Cost (LCY)     ;Decimal       ;CaptionML=[ENU=Unit Cost (LCY);
                                                              NOR=Enhetskost (NOK)];
                                                   AutoFormatType=2 }
    { 25  ;   ;VAT %               ;Decimal       ;CaptionML=[ENU=VAT %;
                                                              NOR=Mva-%];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 27  ;   ;Line Discount %     ;Decimal       ;CaptionML=[ENU=Line Discount %;
                                                              NOR=Linjerabatt-%];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0;
                                                   MaxValue=100 }
    { 32  ;   ;Allow Invoice Disc. ;Boolean       ;InitValue=Yes;
                                                   CaptionML=[ENU=Allow Invoice Disc.;
                                                              NOR=Tillat fakturarabatt] }
    { 34  ;   ;Gross Weight        ;Decimal       ;CaptionML=[ENU=Gross Weight;
                                                              NOR=Bruttovekt];
                                                   DecimalPlaces=0:5 }
    { 35  ;   ;Net Weight          ;Decimal       ;CaptionML=[ENU=Net Weight;
                                                              NOR=Nettovekt];
                                                   DecimalPlaces=0:5 }
    { 36  ;   ;Units per Parcel    ;Decimal       ;CaptionML=[ENU=Units per Parcel;
                                                              NOR=Antall per kolli];
                                                   DecimalPlaces=0:5 }
    { 37  ;   ;Unit Volume         ;Decimal       ;CaptionML=[ENU=Unit Volume;
                                                              NOR=Volum];
                                                   DecimalPlaces=0:5 }
    { 38  ;   ;Appl.-to Item Entry ;Integer       ;AccessByPermission=TableData 27=R;
                                                   CaptionML=[ENU=Appl.-to Item Entry;
                                                              NOR=Utligningsvarepost] }
    { 39  ;   ;Item Shpt. Entry No.;Integer       ;CaptionML=[ENU=Item Shpt. Entry No.;
                                                              NOR=Varelev.l›penr.] }
    { 40  ;   ;Shortcut Dimension 1 Code;Code20   ;TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(1));
                                                   CaptionML=[ENU=Shortcut Dimension 1 Code;
                                                              NOR=Snarveisdimensjon 1 - kode];
                                                   CaptionClass='1,2,1' }
    { 41  ;   ;Shortcut Dimension 2 Code;Code20   ;TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(2));
                                                   CaptionML=[ENU=Shortcut Dimension 2 Code;
                                                              NOR=Snarveisdimensjon 2 - kode];
                                                   CaptionClass='1,2,2' }
    { 42  ;   ;Customer Price Group;Code10        ;TableRelation="Customer Price Group";
                                                   CaptionML=[ENU=Customer Price Group;
                                                              NOR=Kundeprisgruppe] }
    { 45  ;   ;Job No.             ;Code20        ;TableRelation=Job;
                                                   CaptionML=[ENU=Job No.;
                                                              NOR=Prosjektnr.] }
    { 52  ;   ;Work Type Code      ;Code10        ;TableRelation="Work Type";
                                                   CaptionML=[ENU=Work Type Code;
                                                              NOR=Arbeidstypekode] }
    { 58  ;   ;Qty. Shipped Not Invoiced;Decimal  ;AccessByPermission=TableData 110=R;
                                                   CaptionML=[ENU=Qty. Shipped Not Invoiced;
                                                              NOR=Antall levert, ikke fakturert];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 61  ;   ;Quantity Invoiced   ;Decimal       ;CaptionML=[ENU=Quantity Invoiced;
                                                              NOR=Fakturert (antall)];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 65  ;   ;Order No.           ;Code20        ;CaptionML=[ENU=Order No.;
                                                              NOR=Ordrenr.] }
    { 66  ;   ;Order Line No.      ;Integer       ;CaptionML=[ENU=Order Line No.;
                                                              NOR=Ordrelinjenr.] }
    { 68  ;   ;Bill-to Customer No.;Code20        ;TableRelation=Customer;
                                                   CaptionML=[ENU=Bill-to Customer No.;
                                                              NOR=Faktura til-kundenr.];
                                                   Editable=No }
    { 71  ;   ;Purchase Order No.  ;Code20        ;CaptionML=[ENU=Purchase Order No.;
                                                              NOR=Bestillingsnr.] }
    { 72  ;   ;Purch. Order Line No.;Integer      ;CaptionML=[ENU=Purch. Order Line No.;
                                                              NOR=Bestillingslinjenr.] }
    { 73  ;   ;Drop Shipment       ;Boolean       ;AccessByPermission=TableData 223=R;
                                                   CaptionML=[ENU=Drop Shipment;
                                                              NOR=Direkte levering] }
    { 74  ;   ;Gen. Bus. Posting Group;Code10     ;TableRelation="Gen. Business Posting Group";
                                                   CaptionML=[ENU=Gen. Bus. Posting Group;
                                                              NOR=Bokf›ringsgruppe - firma] }
    { 75  ;   ;Gen. Prod. Posting Group;Code10    ;TableRelation="Gen. Product Posting Group";
                                                   CaptionML=[ENU=Gen. Prod. Posting Group;
                                                              NOR=Bokf›ringsgruppe - vare] }
    { 77  ;   ;VAT Calculation Type;Option        ;CaptionML=[ENU=VAT Calculation Type;
                                                              NOR=Mva-beregningstype];
                                                   OptionCaptionML=[ENU=Normal VAT,Reverse Charge VAT,Full VAT,Sales Tax;
                                                                    NOR=Normal mva.,Snudd avregning,Full mva.,Salgsmva.];
                                                   OptionString=Normal VAT,Reverse Charge VAT,Full VAT,Sales Tax }
    { 78  ;   ;Transaction Type    ;Code10        ;TableRelation="Transaction Type";
                                                   CaptionML=[ENU=Transaction Type;
                                                              NOR=Transaksjonsart] }
    { 79  ;   ;Transport Method    ;Code10        ;TableRelation="Transport Method";
                                                   CaptionML=[ENU=Transport Method;
                                                              NOR=Transportm†te] }
    { 80  ;   ;Attached to Line No.;Integer       ;TableRelation="Sales Shipment Line"."Line No." WHERE (Document No.=FIELD(Document No.));
                                                   CaptionML=[ENU=Attached to Line No.;
                                                              NOR=Knyttet til linjenr.] }
    { 81  ;   ;Exit Point          ;Code10        ;TableRelation="Entry/Exit Point";
                                                   CaptionML=[ENU=Exit Point;
                                                              NOR=Utpunkt] }
    { 82  ;   ;Area                ;Code10        ;TableRelation=Area;
                                                   CaptionML=[ENU=Area;
                                                              NOR=Omr†de] }
    { 83  ;   ;Transaction Specification;Code10   ;TableRelation="Transaction Specification";
                                                   CaptionML=[ENU=Transaction Specification;
                                                              NOR=Transaksjonsspesifikasjon] }
    { 85  ;   ;Tax Area Code       ;Code20        ;TableRelation="Tax Area";
                                                   CaptionML=[ENU=Tax Area Code;
                                                              NOR=Mva-omr†dekode] }
    { 86  ;   ;Tax Liable          ;Boolean       ;CaptionML=[ENU=Tax Liable;
                                                              NOR=Skyldig mva.] }
    { 87  ;   ;Tax Group Code      ;Code10        ;TableRelation="Tax Group";
                                                   CaptionML=[ENU=Tax Group Code;
                                                              NOR=Mva-gruppekode] }
    { 89  ;   ;VAT Bus. Posting Group;Code10      ;TableRelation="VAT Business Posting Group";
                                                   CaptionML=[ENU=VAT Bus. Posting Group;
                                                              NOR=Mva-bokf›ringsgruppe - firma] }
    { 90  ;   ;VAT Prod. Posting Group;Code10     ;TableRelation="VAT Product Posting Group";
                                                   CaptionML=[ENU=VAT Prod. Posting Group;
                                                              NOR=Mva-bokf›ringsgruppe - vare] }
    { 91  ;   ;Currency Code       ;Code10        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Sales Shipment Header"."Currency Code" WHERE (No.=FIELD(Document No.)));
                                                   CaptionML=[ENU=Currency Code;
                                                              NOR=Valutakode];
                                                   Editable=No }
    { 97  ;   ;Blanket Order No.   ;Code20        ;TableRelation="Sales Header".No. WHERE (Document Type=CONST(Blanket Order));
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Blanket Order No.;
                                                              NOR=Rammeordrenr.] }
    { 98  ;   ;Blanket Order Line No.;Integer     ;TableRelation="Sales Line"."Line No." WHERE (Document Type=CONST(Blanket Order),
                                                                                                Document No.=FIELD(Blanket Order No.));
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Blanket Order Line No.;
                                                              NOR=Rammeordrelinjenr.] }
    { 99  ;   ;VAT Base Amount     ;Decimal       ;CaptionML=[ENU=VAT Base Amount;
                                                              NOR=Mva-grunnlagsbel›p];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr=GetCurrencyCode }
    { 100 ;   ;Unit Cost           ;Decimal       ;CaptionML=[ENU=Unit Cost;
                                                              NOR=Enhetskost];
                                                   Editable=No;
                                                   AutoFormatType=2;
                                                   AutoFormatExpr=GetCurrencyCode }
    { 131 ;   ;Posting Date        ;Date          ;CaptionML=[ENU=Posting Date;
                                                              NOR=Bokf›ringsdato] }
    { 480 ;   ;Dimension Set ID    ;Integer       ;TableRelation="Dimension Set Entry";
                                                   OnLookup=BEGIN
                                                              ShowDimensions;
                                                            END;

                                                   CaptionML=[ENU=Dimension Set ID;
                                                              NOR=Dimensjonssett-ID];
                                                   Editable=No }
    { 826 ;   ;Authorized for Credit Card;Boolean ;CaptionML=[ENU=Authorized for Credit Card;
                                                              NOR=Godkjent for kredittkort] }
    { 1001;   ;Job Task No.        ;Code20        ;TableRelation="Job Task"."Job Task No." WHERE (Job No.=FIELD(Job No.));
                                                   CaptionML=[ENU=Job Task No.;
                                                              NOR=Prosjektoppgavenr.];
                                                   Editable=No }
    { 1002;   ;Job Contract Entry No.;Integer     ;CaptionML=[ENU=Job Contract Entry No.;
                                                              NOR=L›penr. for prosjektkontrakt];
                                                   Editable=No }
    { 5402;   ;Variant Code        ;Code10        ;TableRelation=IF (Type=CONST(Item)) "Item Variant".Code WHERE (Item No.=FIELD(No.));
                                                   CaptionML=[ENU=Variant Code;
                                                              NOR=Variantkode] }
    { 5403;   ;Bin Code            ;Code20        ;TableRelation=Bin.Code WHERE (Location Code=FIELD(Location Code),
                                                                                 Item Filter=FIELD(No.),
                                                                                 Variant Filter=FIELD(Variant Code));
                                                   CaptionML=[ENU=Bin Code;
                                                              NOR=Hyllekode] }
    { 5404;   ;Qty. per Unit of Measure;Decimal   ;CaptionML=[ENU=Qty. per Unit of Measure;
                                                              NOR=Antall per enhet];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 5407;   ;Unit of Measure Code;Code10        ;TableRelation=IF (Type=CONST(Item)) "Item Unit of Measure".Code WHERE (Item No.=FIELD(No.))
                                                                 ELSE "Unit of Measure";
                                                   CaptionML=[ENU=Unit of Measure Code;
                                                              NOR=Enhetskode] }
    { 5415;   ;Quantity (Base)     ;Decimal       ;CaptionML=[ENU=Quantity (Base);
                                                              NOR=Antall (lagerenhet)];
                                                   DecimalPlaces=0:5 }
    { 5461;   ;Qty. Invoiced (Base);Decimal       ;CaptionML=[ENU=Qty. Invoiced (Base);
                                                              NOR=Antall fakturert (lagerenhet)];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 5600;   ;FA Posting Date     ;Date          ;CaptionML=[ENU=FA Posting Date;
                                                              NOR=Aktivabokf.dato] }
    { 5602;   ;Depreciation Book Code;Code10      ;TableRelation="Depreciation Book";
                                                   CaptionML=[ENU=Depreciation Book Code;
                                                              NOR=Avskrivningstabl†kode] }
    { 5605;   ;Depr. until FA Posting Date;Boolean;CaptionML=[ENU=Depr. until FA Posting Date;
                                                              NOR=Avskr. frem til aktivabokf.dato] }
    { 5612;   ;Duplicate in Depreciation Book;Code10;
                                                   TableRelation="Depreciation Book";
                                                   CaptionML=[ENU=Duplicate in Depreciation Book;
                                                              NOR=Duplikat i avskrivningstabl†] }
    { 5613;   ;Use Duplication List;Boolean       ;CaptionML=[ENU=Use Duplication List;
                                                              NOR=Bruk duplikatoversikt] }
    { 5700;   ;Responsibility Center;Code10       ;TableRelation="Responsibility Center";
                                                   CaptionML=[ENU=Responsibility Center;
                                                              NOR=Ansvarssenter] }
    { 5705;   ;Cross-Reference No. ;Code20        ;AccessByPermission=TableData 5717=R;
                                                   CaptionML=[ENU=Cross-Reference No.;
                                                              NOR=Kryssreferansenr.] }
    { 5706;   ;Unit of Measure (Cross Ref.);Code10;TableRelation=IF (Type=CONST(Item)) "Item Unit of Measure".Code WHERE (Item No.=FIELD(No.));
                                                   CaptionML=[ENU=Unit of Measure (Cross Ref.);
                                                              NOR=Enhet (kryssref.)] }
    { 5707;   ;Cross-Reference Type;Option        ;CaptionML=[ENU=Cross-Reference Type;
                                                              NOR=Kryssreferansetype];
                                                   OptionCaptionML=[ENU=" ,Customer,Vendor,Bar Code";
                                                                    NOR=" ,Kunde,Leverand›r,Strekkode"];
                                                   OptionString=[ ,Customer,Vendor,Bar Code] }
    { 5708;   ;Cross-Reference Type No.;Code30    ;CaptionML=[ENU=Cross-Reference Type No.;
                                                              NOR=Kryssreferansetypenr.] }
    { 5709;   ;Item Category Code  ;Code20        ;TableRelation=IF (Type=CONST(Item)) "Item Category";
                                                   CaptionML=[ENU=Item Category Code;
                                                              NOR=Varekategorikode] }
    { 5710;   ;Nonstock            ;Boolean       ;CaptionML=[ENU=Nonstock;
                                                              NOR=Katalogvare] }
    { 5711;   ;Purchasing Code     ;Code10        ;TableRelation=Purchasing;
                                                   CaptionML=[ENU=Purchasing Code;
                                                              NOR=Kj›pskode] }
    { 5712;   ;Product Group Code  ;Code10        ;TableRelation="Product Group".Code WHERE (Item Category Code=FIELD(Item Category Code));
                                                   ValidateTableRelation=No;
                                                   CaptionML=[ENU=Product Group Code;
                                                              NOR=Produktgruppekode] }
    { 5790;   ;Requested Delivery Date;Date       ;AccessByPermission=TableData 99000880=R;
                                                   CaptionML=[ENU=Requested Delivery Date;
                                                              NOR=nsket leveringsdato];
                                                   Editable=No }
    { 5791;   ;Promised Delivery Date;Date        ;CaptionML=[ENU=Promised Delivery Date;
                                                              NOR=Lovet leveringsdato];
                                                   Editable=No }
    { 5792;   ;Shipping Time       ;DateFormula   ;AccessByPermission=TableData 5790=R;
                                                   CaptionML=[ENU=Shipping Time;
                                                              NOR=Leveringstid] }
    { 5793;   ;Outbound Whse. Handling Time;DateFormula;
                                                   AccessByPermission=TableData 14=R;
                                                   CaptionML=[ENU=Outbound Whse. Handling Time;
                                                              NOR=Utg†ende lagerh†ndteringstid] }
    { 5794;   ;Planned Delivery Date;Date         ;CaptionML=[ENU=Planned Delivery Date;
                                                              NOR=Planlagt lev.dato];
                                                   Editable=No }
    { 5795;   ;Planned Shipment Date;Date         ;CaptionML=[ENU=Planned Shipment Date;
                                                              NOR=Planlagt forsendelsesdato];
                                                   Editable=No }
    { 5811;   ;Appl.-from Item Entry;Integer      ;AccessByPermission=TableData 27=R;
                                                   CaptionML=[ENU=Appl.-from Item Entry;
                                                              NOR=Utlignet fra-varepost];
                                                   MinValue=0 }
    { 5812;   ;Item Charge Base Amount;Decimal    ;CaptionML=[ENU=Item Charge Base Amount;
                                                              NOR=Varegebyrgrunnlag];
                                                   AutoFormatType=1;
                                                   AutoFormatExpr=GetCurrencyCode }
    { 5817;   ;Correction          ;Boolean       ;CaptionML=[ENU=Correction;
                                                              NOR=Korreksjon];
                                                   Editable=No }
    { 6608;   ;Return Reason Code  ;Code10        ;TableRelation="Return Reason";
                                                   CaptionML=[ENU=Return Reason Code;
                                                              NOR=Retur†rsakskode] }
    { 7001;   ;Allow Line Disc.    ;Boolean       ;InitValue=Yes;
                                                   CaptionML=[ENU=Allow Line Disc.;
                                                              NOR=Tillat linjerabatt] }
    { 7002;   ;Customer Disc. Group;Code20        ;TableRelation="Customer Discount Group";
                                                   CaptionML=[ENU=Customer Disc. Group;
                                                              NOR=Kunderabattgruppe] }
    { 10601;  ;Qty. Remaining      ;Decimal       ;CaptionML=[ENU=Qty. Remaining;
                                                              NOR=Restantall];
                                                   DecimalPlaces=0:5 }
    { 73050;  ;Calculation No.     ;Code20        ;TableRelation="Item Calc. Header".No. WHERE (Item No.=FIELD(No.));
                                                   CaptionML=[ENU=Calculation No.;
                                                              NOR=Kalkylenr.];
                                                   Editable=No }
  }
  KEYS
  {
    {    ;Document No.,Line No.                   ;Clustered=Yes }
    {    ;Order No.,Order Line No.                 }
    {    ;Blanket Order No.,Blanket Order Line No. }
    {    ;Item Shpt. Entry No.                     }
    {    ;Sell-to Customer No.                     }
    {    ;Bill-to Customer No.                     }
  }
  FIELDGROUPS
  {
    { 1   ;DropDown            ;Document No.,Line No.,Sell-to Customer No.,Type,No.,Shipment Date }
  }
  CODE
  {
    VAR
      Text000@1000 : TextConst 'ENU=Shipment No. %1:;NOR=F›lgeseddelnr. %1:';
      Text001@1001 : TextConst 'ENU=The program cannot find this Sales line.;NOR=Programmet finner ikke denne salgslinjen.';
      Currency@1002 : Record 4;
      SalesShptHeader@1005 : Record 110;
      PostedATOLink@1006 : Record 914;
      ApplicationAreaSetup@1008 : Record 9178;
      DimMgt@1003 : Codeunit 408;
      CurrencyRead@1004 : Boolean;
      ItemNoFieldCaptionTxt@1007 : TextConst 'ENU=Item No.;NOR=Varenr.';

    PROCEDURE GetCurrencyCode@1() : Code[10];
    BEGIN
      IF "Document No." = SalesShptHeader."No." THEN
        EXIT(SalesShptHeader."Currency Code");
      IF SalesShptHeader.GET("Document No.") THEN
        EXIT(SalesShptHeader."Currency Code");
      EXIT('');
    END;

    PROCEDURE ShowDimensions@25();
    BEGIN
      DimMgt.ShowDimensionSet("Dimension Set ID",STRSUBSTNO('%1 %2 %3',TABLECAPTION,"Document No.","Line No."));
    END;

    PROCEDURE ShowItemTrackingLines@6500();
    VAR
      ItemTrackingDocMgt@1000 : Codeunit 6503;
    BEGIN
      ItemTrackingDocMgt.ShowItemTrackingForShptRcptLine(DATABASE::"Sales Shipment Line",0,"Document No.",'',0,"Line No.");
    END;

    PROCEDURE InsertInvLineFromShptLine@2(VAR SalesLine@1000 : Record 37);
    VAR
      SalesInvHeader@1011 : Record 36;
      SalesOrderHeader@1008 : Record 36;
      SalesOrderLine@1005 : Record 37;
      TempSalesLine@1002 : TEMPORARY Record 37;
      TransferOldExtLines@1007 : Codeunit 379;
      ItemTrackingMgt@1009 : Codeunit 6500;
      LanguageManagement@1010 : Codeunit 43;
      ExtTextLine@1006 : Boolean;
      NextLineNo@1001 : Integer;
    BEGIN
      SETRANGE("Document No.","Document No.");

      TempSalesLine := SalesLine;
      IF SalesLine.FIND('+') THEN
        NextLineNo := SalesLine."Line No." + 10000
      ELSE
        NextLineNo := 10000;

      IF SalesInvHeader."No." <> TempSalesLine."Document No." THEN
        SalesInvHeader.GET(TempSalesLine."Document Type",TempSalesLine."Document No.");

      IF SalesLine."Shipment No." <> "Document No." THEN BEGIN
        SalesLine.INIT;
        SalesLine."Line No." := NextLineNo;
        SalesLine."Document Type" := TempSalesLine."Document Type";
        SalesLine."Document No." := TempSalesLine."Document No.";
        LanguageManagement.SetGlobalLanguageByCode(SalesInvHeader."Language Code");
        SalesLine.Description := STRSUBSTNO(Text000,"Document No.");
        LanguageManagement.RestoreGlobalLanguage;
        SalesLine.INSERT;
        NextLineNo := NextLineNo + 10000;
      END;

      TransferOldExtLines.ClearLineNumbers;

      REPEAT
        ExtTextLine := (TransferOldExtLines.GetNewLineNumber("Attached to Line No.") <> 0);

        IF (Type <> Type::" ") AND SalesOrderLine.GET(SalesOrderLine."Document Type"::Order,"Order No.","Order Line No.")
        THEN BEGIN
          IF (SalesOrderHeader."Document Type" <> SalesOrderLine."Document Type"::Order) OR
             (SalesOrderHeader."No." <> SalesOrderLine."Document No.")
          THEN
            SalesOrderHeader.GET(SalesOrderLine."Document Type"::Order,"Order No.");

          InitCurrency("Currency Code");

          IF SalesInvHeader."Prices Including VAT" THEN BEGIN
            IF NOT SalesOrderHeader."Prices Including VAT" THEN
              SalesOrderLine."Unit Price" :=
                ROUND(
                  SalesOrderLine."Unit Price" * (1 + SalesOrderLine."VAT %" / 100),
                  Currency."Unit-Amount Rounding Precision");
          END ELSE BEGIN
            IF SalesOrderHeader."Prices Including VAT" THEN
              SalesOrderLine."Unit Price" :=
                ROUND(
                  SalesOrderLine."Unit Price" / (1 + SalesOrderLine."VAT %" / 100),
                  Currency."Unit-Amount Rounding Precision");
          END;
        END ELSE BEGIN
          SalesOrderHeader.INIT;
          IF ExtTextLine OR (Type = Type::" ") THEN BEGIN
            SalesOrderLine.INIT;
            SalesOrderLine."Line No." := "Order Line No.";
            SalesOrderLine.Description := Description;
            SalesOrderLine."Description 2" := "Description 2";
          END ELSE
            ERROR(Text001);
        END;

        SalesLine := SalesOrderLine;
        SalesLine."Line No." := NextLineNo;
        SalesLine."Document Type" := TempSalesLine."Document Type";
        SalesLine."Document No." := TempSalesLine."Document No.";
        SalesLine."Variant Code" := "Variant Code";
        SalesLine."Location Code" := "Location Code";
        SalesLine."Quantity (Base)" := 0;
        SalesLine.Quantity := 0;
        SalesLine."Outstanding Qty. (Base)" := 0;
        SalesLine."Outstanding Quantity" := 0;
        SalesLine."Quantity Shipped" := 0;
        SalesLine."Qty. Shipped (Base)" := 0;
        SalesLine."Quantity Invoiced" := 0;
        SalesLine."Qty. Invoiced (Base)" := 0;
        SalesLine.Amount := 0;
        SalesLine."Amount Including VAT" := 0;
        SalesLine."Purchase Order No." := '';
        SalesLine."Purch. Order Line No." := 0;
        SalesLine."Drop Shipment" := "Drop Shipment";
        SalesLine."Special Order Purchase No." := '';
        SalesLine."Special Order Purch. Line No." := 0;
        SalesLine."Special Order" := FALSE;
        SalesLine."Shipment No." := "Document No.";
        SalesLine."Shipment Line No." := "Line No.";
        SalesLine."Appl.-to Item Entry" := 0;
        SalesLine."Appl.-from Item Entry" := 0;
        IF NOT ExtTextLine AND (SalesLine.Type <> 0) THEN BEGIN
          SalesLine.VALIDATE(Quantity,Quantity - "Quantity Invoiced");
          CalcBaseQuantities(SalesLine,"Quantity (Base)" / Quantity);
          SalesLine.VALIDATE("Unit Price",SalesOrderLine."Unit Price");
          SalesLine."Allow Line Disc." := SalesOrderLine."Allow Line Disc.";
          SalesLine."Allow Invoice Disc." := SalesOrderLine."Allow Invoice Disc.";
          SalesOrderLine."Line Discount Amount" :=
            ROUND(
              SalesOrderLine."Line Discount Amount" * SalesLine.Quantity / SalesOrderLine.Quantity,
              Currency."Amount Rounding Precision");
          IF SalesInvHeader."Prices Including VAT" THEN BEGIN
            IF NOT SalesOrderHeader."Prices Including VAT" THEN
              SalesOrderLine."Line Discount Amount" :=
                ROUND(
                  SalesOrderLine."Line Discount Amount" *
                  (1 + SalesOrderLine."VAT %" / 100),Currency."Amount Rounding Precision");
          END ELSE BEGIN
            IF SalesOrderHeader."Prices Including VAT" THEN
              SalesOrderLine."Line Discount Amount" :=
                ROUND(
                  SalesOrderLine."Line Discount Amount" /
                  (1 + SalesOrderLine."VAT %" / 100),Currency."Amount Rounding Precision");
          END;
          SalesLine.VALIDATE("Line Discount Amount",SalesOrderLine."Line Discount Amount");
          SalesLine."Line Discount %" := SalesOrderLine."Line Discount %";
          SalesLine.UpdatePrePaymentAmounts;
          IF SalesOrderLine.Quantity = 0 THEN
            SalesLine.VALIDATE("Inv. Discount Amount",0)
          ELSE
            SalesLine.VALIDATE(
              "Inv. Discount Amount",
              ROUND(
                SalesOrderLine."Inv. Discount Amount" * SalesLine.Quantity / SalesOrderLine.Quantity,
                Currency."Amount Rounding Precision"));
        END;

        SalesLine."Attached to Line No." :=
          TransferOldExtLines.TransferExtendedText(
            SalesOrderLine."Line No.",
            NextLineNo,
            "Attached to Line No.");
        SalesLine."Shortcut Dimension 1 Code" := "Shortcut Dimension 1 Code";
        SalesLine."Shortcut Dimension 2 Code" := "Shortcut Dimension 2 Code";
        SalesLine."Dimension Set ID" := "Dimension Set ID";
        SalesLine.INSERT;

        ItemTrackingMgt.CopyHandledItemTrkgToInvLine(SalesOrderLine,SalesLine);

        NextLineNo := NextLineNo + 10000;
        IF "Attached to Line No." = 0 THEN
          SETRANGE("Attached to Line No.","Line No.");
      UNTIL (NEXT = 0) OR ("Attached to Line No." = 0);

      IF SalesOrderHeader.GET(SalesOrderHeader."Document Type"::Order,"Order No.") THEN BEGIN
        SalesOrderHeader."Get Shipment Used" := TRUE;
        SalesOrderHeader.MODIFY;
      END;
    END;

    LOCAL PROCEDURE GetSalesInvLines@4(VAR TempSalesInvLine@1000 : TEMPORARY Record 113);
    VAR
      SalesInvLine@1003 : Record 113;
      ItemLedgEntry@1002 : Record 32;
      ValueEntry@1001 : Record 5802;
    BEGIN
      TempSalesInvLine.RESET;
      TempSalesInvLine.DELETEALL;

      IF Type <> Type::Item THEN
        EXIT;

      FilterPstdDocLnItemLedgEntries(ItemLedgEntry);
      ItemLedgEntry.SETFILTER("Invoiced Quantity",'<>0');
      IF ItemLedgEntry.FINDSET THEN BEGIN
        ValueEntry.SETCURRENTKEY("Item Ledger Entry No.","Entry Type");
        ValueEntry.SETRANGE("Entry Type",ValueEntry."Entry Type"::"Direct Cost");
        ValueEntry.SETFILTER("Invoiced Quantity",'<>0');
        REPEAT
          ValueEntry.SETRANGE("Item Ledger Entry No.",ItemLedgEntry."Entry No.");
          IF ValueEntry.FINDSET THEN
            REPEAT
              IF ValueEntry."Document Type" = ValueEntry."Document Type"::"Sales Invoice" THEN
                IF SalesInvLine.GET(ValueEntry."Document No.",ValueEntry."Document Line No.") THEN BEGIN
                  TempSalesInvLine.INIT;
                  TempSalesInvLine := SalesInvLine;
                  IF TempSalesInvLine.INSERT THEN;
                END;
            UNTIL ValueEntry.NEXT = 0;
        UNTIL ItemLedgEntry.NEXT = 0;
      END;
    END;

    PROCEDURE CalcShippedSaleNotReturned@3(VAR ShippedQtyNotReturned@1003 : Decimal;VAR RevUnitCostLCY@1005 : Decimal;ExactCostReverse@1006 : Boolean);
    VAR
      ItemLedgEntry@1000 : Record 32;
      TotalCostLCY@1007 : Decimal;
      TotalQtyBase@1002 : Decimal;
    BEGIN
      ShippedQtyNotReturned := 0;
      IF (Type <> Type::Item) OR (Quantity <= 0) THEN BEGIN
        RevUnitCostLCY := "Unit Cost (LCY)";
        EXIT;
      END;

      RevUnitCostLCY := 0;
      FilterPstdDocLnItemLedgEntries(ItemLedgEntry);
      IF ItemLedgEntry.FINDSET THEN
        REPEAT
          ShippedQtyNotReturned := ShippedQtyNotReturned - ItemLedgEntry."Shipped Qty. Not Returned";
          IF ExactCostReverse THEN BEGIN
            ItemLedgEntry.CALCFIELDS("Cost Amount (Expected)","Cost Amount (Actual)");
            TotalCostLCY :=
              TotalCostLCY + ItemLedgEntry."Cost Amount (Expected)" + ItemLedgEntry."Cost Amount (Actual)";
            TotalQtyBase := TotalQtyBase + ItemLedgEntry.Quantity;
          END;
        UNTIL ItemLedgEntry.NEXT = 0;

      IF ExactCostReverse AND (ShippedQtyNotReturned <> 0) AND (TotalQtyBase <> 0) THEN
        RevUnitCostLCY := ABS(TotalCostLCY / TotalQtyBase) * "Qty. per Unit of Measure"
      ELSE
        RevUnitCostLCY := "Unit Cost (LCY)";

      ShippedQtyNotReturned := CalcQty(ShippedQtyNotReturned);
    END;

    LOCAL PROCEDURE CalcQty@9(QtyBase@1000 : Decimal) : Decimal;
    BEGIN
      IF "Qty. per Unit of Measure" = 0 THEN
        EXIT(QtyBase);
      EXIT(ROUND(QtyBase / "Qty. per Unit of Measure",0.00001));
    END;

    PROCEDURE FilterPstdDocLnItemLedgEntries@5(VAR ItemLedgEntry@1000 : Record 32);
    BEGIN
      ItemLedgEntry.RESET;
      ItemLedgEntry.SETCURRENTKEY("Document No.");
      ItemLedgEntry.SETRANGE("Document No.","Document No.");
      ItemLedgEntry.SETRANGE("Document Type",ItemLedgEntry."Document Type"::"Sales Shipment");
      ItemLedgEntry.SETRANGE("Document Line No.","Line No.");
    END;

    PROCEDURE ShowItemSalesInvLines@8();
    VAR
      TempSalesInvLine@1001 : TEMPORARY Record 113;
    BEGIN
      IF Type = Type::Item THEN BEGIN
        GetSalesInvLines(TempSalesInvLine);
        PAGE.RUNMODAL(PAGE::"Posted Sales Invoice Lines",TempSalesInvLine);
      END;
    END;

    LOCAL PROCEDURE InitCurrency@6(CurrencyCode@1001 : Code[10]);
    BEGIN
      IF (Currency.Code = CurrencyCode) AND CurrencyRead THEN
        EXIT;

      IF CurrencyCode <> '' THEN
        Currency.GET(CurrencyCode)
      ELSE
        Currency.InitRoundingPrecision;
      CurrencyRead := TRUE;
    END;

    PROCEDURE ShowLineComments@10();
    VAR
      SalesDocLineComments@1000 : Record 44;
      SalesDocCommentSheet@1001 : Page 67;
    BEGIN
      SalesDocLineComments.SETRANGE("Document Type",SalesDocLineComments."Document Type"::Shipment);
      SalesDocLineComments.SETRANGE("No.","Document No.");
      SalesDocLineComments.SETRANGE("Document Line No.","Line No.");
      SalesDocCommentSheet.SETTABLEVIEW(SalesDocLineComments);
      SalesDocCommentSheet.RUNMODAL;
    END;

    PROCEDURE ShowAsmToOrder@11();
    BEGIN
      PostedATOLink.ShowPostedAsm(Rec);
    END;

    PROCEDURE AsmToShipmentExists@72(VAR PostedAsmHeader@1000 : Record 910) : Boolean;
    VAR
      PostedAssembleToOrderLink@1001 : Record 914;
    BEGIN
      IF NOT PostedAssembleToOrderLink.AsmExistsForPostedShipmentLine(Rec) THEN
        EXIT(FALSE);
      EXIT(PostedAsmHeader.GET(PostedAssembleToOrderLink."Assembly Document No."));
    END;

    PROCEDURE InitFromSalesLine@12(SalesShptHeader@1001 : Record 110;SalesLine@1002 : Record 37);
    BEGIN
      INIT;
      TRANSFERFIELDS(SalesLine);
      IF ("No." = '') AND (Type IN [Type::"G/L Account"..Type::"Charge (Item)"]) THEN
        Type := Type::" ";
      "Posting Date" := SalesShptHeader."Posting Date";
      "Document No." := SalesShptHeader."No.";
      Quantity := SalesLine."Qty. to Ship";
      "Quantity (Base)" := SalesLine."Qty. to Ship (Base)";
      IF ABS(SalesLine."Qty. to Invoice") > ABS(SalesLine."Qty. to Ship") THEN BEGIN
        "Quantity Invoiced" := SalesLine."Qty. to Ship";
        "Qty. Invoiced (Base)" := SalesLine."Qty. to Ship (Base)";
      END ELSE BEGIN
        "Quantity Invoiced" := SalesLine."Qty. to Invoice";
        "Qty. Invoiced (Base)" := SalesLine."Qty. to Invoice (Base)";
      END;
      "Qty. Shipped Not Invoiced" := Quantity - "Quantity Invoiced";
      IF SalesLine."Document Type" = SalesLine."Document Type"::Order THEN BEGIN
        "Order No." := SalesLine."Document No.";
        "Order Line No." := SalesLine."Line No.";
      END;
    END;

    LOCAL PROCEDURE CalcBaseQuantities@13(VAR SalesLine@1000 : Record 37;QtyFactor@1001 : Decimal);
    BEGIN
      SalesLine."Quantity (Base)" := ROUND(SalesLine.Quantity * QtyFactor,0.00001);
      SalesLine."Qty. to Asm. to Order (Base)" := ROUND(SalesLine."Qty. to Assemble to Order" * QtyFactor,0.00001);
      SalesLine."Outstanding Qty. (Base)" := ROUND(SalesLine."Outstanding Quantity" * QtyFactor,0.00001);
      SalesLine."Qty. to Ship (Base)" := ROUND(SalesLine."Qty. to Ship" * QtyFactor,0.00001);
      SalesLine."Qty. Shipped (Base)" := ROUND(SalesLine."Quantity Shipped" * QtyFactor,0.00001);
      SalesLine."Qty. Shipped Not Invd. (Base)" := ROUND(SalesLine."Qty. Shipped Not Invoiced" * QtyFactor,0.00001);
      SalesLine."Qty. to Invoice (Base)" := ROUND(SalesLine."Qty. to Invoice" * QtyFactor,0.00001);
      SalesLine."Qty. Invoiced (Base)" := ROUND(SalesLine."Quantity Invoiced" * QtyFactor,0.00001);
      SalesLine."Return Qty. to Receive (Base)" := ROUND(SalesLine."Return Qty. to Receive" * QtyFactor,0.00001);
      SalesLine."Return Qty. Received (Base)" := ROUND(SalesLine."Return Qty. Received" * QtyFactor,0.00001);
      SalesLine."Ret. Qty. Rcd. Not Invd.(Base)" := ROUND(SalesLine."Return Qty. Rcd. Not Invd." * QtyFactor,0.00001);
    END;

    LOCAL PROCEDURE GetFieldCaption@31(FieldNumber@1000 : Integer) : Text[100];
    VAR
      Field@1001 : Record 2000000041;
    BEGIN
      Field.GET(DATABASE::"Sales Shipment Line",FieldNumber);
      EXIT(Field."Field Caption");
    END;

    LOCAL PROCEDURE GetCaptionClass@34(FieldNumber@1000 : Integer) : Text[80];
    BEGIN
      CASE FieldNumber OF
        FIELDNO("No."):
          BEGIN
            IF ApplicationAreaSetup.IsFoundationEnabled THEN
              EXIT(STRSUBSTNO('3,%1',ItemNoFieldCaptionTxt));
            EXIT(STRSUBSTNO('3,%1',GetFieldCaption(FieldNumber)));
          END;
      END;
    END;

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 08.09.17 JAL Item Calculation (Kalkyle)
                       New field "Calulation No."
    }
    END.
  }
}

OBJECT Table 113 Sales Invoice Line
{
  OBJECT-PROPERTIES
  {
    Date=08.09.17;
    Time=13.07.58;
    Modified=Yes;
    Version List=NAVW110.00.00.16585,NAVNO10.00.00.16585,ICA2.01;
  }
  PROPERTIES
  {
    Permissions=TableData 32=r,
                TableData 5802=r;
    OnDelete=VAR
               SalesDocLineComments@1000 : Record 44;
               PostedDeferralHeader@1001 : Record 1704;
             BEGIN
               SalesDocLineComments.SETRANGE("Document Type",SalesDocLineComments."Document Type"::"Posted Invoice");
               SalesDocLineComments.SETRANGE("No.","Document No.");
               SalesDocLineComments.SETRANGE("Document Line No.","Line No.");
               IF NOT SalesDocLineComments.ISEMPTY THEN
                 SalesDocLineComments.DELETEALL;

               PostedDeferralHeader.DeleteHeader(DeferralUtilities.GetSalesDeferralDocType,'','',
                 SalesDocLineComments."Document Type"::"Posted Invoice","Document No.","Line No.");
             END;

    CaptionML=[ENU=Sales Invoice Line;
               NOR=Salgsfakturalinje];
    LookupPageID=Page526;
    DrillDownPageID=Page526;
  }
  FIELDS
  {
    { 2   ;   ;Sell-to Customer No.;Code20        ;TableRelation=Customer;
                                                   CaptionML=[ENU=Sell-to Customer No.;
                                                              NOR=Salg til-kundenr.];
                                                   Editable=No }
    { 3   ;   ;Document No.        ;Code20        ;TableRelation="Sales Invoice Header";
                                                   CaptionML=[ENU=Document No.;
                                                              NOR=Bilagsnr.] }
    { 4   ;   ;Line No.            ;Integer       ;CaptionML=[ENU=Line No.;
                                                              NOR=Linjenr.] }
    { 5   ;   ;Type                ;Option        ;CaptionML=[ENU=Type;
                                                              NOR=Type];
                                                   OptionCaptionML=[ENU=" ,G/L Account,Item,Resource,Fixed Asset,Charge (Item)";
                                                                    NOR=" ,Finanskonto,Vare,Ressurs,Aktiva,Gebyr (vare)"];
                                                   OptionString=[ ,G/L Account,Item,Resource,Fixed Asset,Charge (Item)] }
    { 6   ;   ;No.                 ;Code20        ;TableRelation=IF (Type=CONST(G/L Account)) "G/L Account"
                                                                 ELSE IF (Type=CONST(Item)) Item
                                                                 ELSE IF (Type=CONST(Resource)) Resource
                                                                 ELSE IF (Type=CONST(Fixed Asset)) "Fixed Asset"
                                                                 ELSE IF (Type=CONST("Charge (Item)")) "Item Charge";
                                                   CaptionML=[ENU=No.;
                                                              NOR=Nr.];
                                                   CaptionClass=GetCaptionClass(FIELDNO("No.")) }
    { 7   ;   ;Location Code       ;Code10        ;TableRelation=Location WHERE (Use As In-Transit=CONST(No));
                                                   CaptionML=[ENU=Location Code;
                                                              NOR=Lokasjonskode] }
    { 8   ;   ;Posting Group       ;Code10        ;TableRelation=IF (Type=CONST(Item)) "Inventory Posting Group"
                                                                 ELSE IF (Type=CONST(Fixed Asset)) "FA Posting Group";
                                                   CaptionML=[ENU=Posting Group;
                                                              NOR=Bokf›ringsgruppe];
                                                   Editable=No }
    { 10  ;   ;Shipment Date       ;Date          ;CaptionML=[ENU=Shipment Date;
                                                              NOR=Forsendelsesdato] }
    { 11  ;   ;Description         ;Text50        ;CaptionML=[ENU=Description;
                                                              NOR=Beskrivelse] }
    { 12  ;   ;Description 2       ;Text50        ;CaptionML=[ENU=Description 2;
                                                              NOR=Beskrivelse 2] }
    { 13  ;   ;Unit of Measure     ;Text10        ;CaptionML=[ENU=Unit of Measure;
                                                              NOR=Enhet] }
    { 15  ;   ;Quantity            ;Decimal       ;CaptionML=[ENU=Quantity;
                                                              NOR=Antall];
                                                   DecimalPlaces=0:5 }
    { 22  ;   ;Unit Price          ;Decimal       ;CaptionML=[ENU=Unit Price;
                                                              NOR=Salgspris];
                                                   AutoFormatType=2;
                                                   AutoFormatExpr=GetCurrencyCode;
                                                   CaptionClass=GetCaptionClass(FIELDNO("Unit Price")) }
    { 23  ;   ;Unit Cost (LCY)     ;Decimal       ;CaptionML=[ENU=Unit Cost (LCY);
                                                              NOR=Enhetskost (NOK)];
                                                   AutoFormatType=2 }
    { 25  ;   ;VAT %               ;Decimal       ;CaptionML=[ENU=VAT %;
                                                              NOR=Mva-%];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 27  ;   ;Line Discount %     ;Decimal       ;CaptionML=[ENU=Line Discount %;
                                                              NOR=Linjerabatt-%];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0;
                                                   MaxValue=100 }
    { 28  ;   ;Line Discount Amount;Decimal       ;CaptionML=[ENU=Line Discount Amount;
                                                              NOR=Linjerabattbel›p];
                                                   AutoFormatType=1;
                                                   AutoFormatExpr=GetCurrencyCode }
    { 29  ;   ;Amount              ;Decimal       ;CaptionML=[ENU=Amount;
                                                              NOR=Bel›p];
                                                   AutoFormatType=1;
                                                   AutoFormatExpr=GetCurrencyCode }
    { 30  ;   ;Amount Including VAT;Decimal       ;CaptionML=[ENU=Amount Including VAT;
                                                              NOR=Bel›p inkl. mva.];
                                                   AutoFormatType=1;
                                                   AutoFormatExpr=GetCurrencyCode }
    { 32  ;   ;Allow Invoice Disc. ;Boolean       ;InitValue=Yes;
                                                   CaptionML=[ENU=Allow Invoice Disc.;
                                                              NOR=Tillat fakturarabatt] }
    { 34  ;   ;Gross Weight        ;Decimal       ;CaptionML=[ENU=Gross Weight;
                                                              NOR=Bruttovekt];
                                                   DecimalPlaces=0:5 }
    { 35  ;   ;Net Weight          ;Decimal       ;CaptionML=[ENU=Net Weight;
                                                              NOR=Nettovekt];
                                                   DecimalPlaces=0:5 }
    { 36  ;   ;Units per Parcel    ;Decimal       ;CaptionML=[ENU=Units per Parcel;
                                                              NOR=Antall per kolli];
                                                   DecimalPlaces=0:5 }
    { 37  ;   ;Unit Volume         ;Decimal       ;CaptionML=[ENU=Unit Volume;
                                                              NOR=Volum];
                                                   DecimalPlaces=0:5 }
    { 38  ;   ;Appl.-to Item Entry ;Integer       ;AccessByPermission=TableData 27=R;
                                                   CaptionML=[ENU=Appl.-to Item Entry;
                                                              NOR=Utligningsvarepost] }
    { 40  ;   ;Shortcut Dimension 1 Code;Code20   ;TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(1));
                                                   CaptionML=[ENU=Shortcut Dimension 1 Code;
                                                              NOR=Snarveisdimensjon 1 - kode];
                                                   CaptionClass='1,2,1' }
    { 41  ;   ;Shortcut Dimension 2 Code;Code20   ;TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(2));
                                                   CaptionML=[ENU=Shortcut Dimension 2 Code;
                                                              NOR=Snarveisdimensjon 2 - kode];
                                                   CaptionClass='1,2,2' }
    { 42  ;   ;Customer Price Group;Code10        ;TableRelation="Customer Price Group";
                                                   CaptionML=[ENU=Customer Price Group;
                                                              NOR=Kundeprisgruppe] }
    { 45  ;   ;Job No.             ;Code20        ;TableRelation=Job;
                                                   CaptionML=[ENU=Job No.;
                                                              NOR=Prosjektnr.] }
    { 52  ;   ;Work Type Code      ;Code10        ;TableRelation="Work Type";
                                                   CaptionML=[ENU=Work Type Code;
                                                              NOR=Arbeidstypekode] }
    { 63  ;   ;Shipment No.        ;Code20        ;CaptionML=[ENU=Shipment No.;
                                                              NOR=F›lgeseddelnr.];
                                                   Editable=No }
    { 64  ;   ;Shipment Line No.   ;Integer       ;CaptionML=[ENU=Shipment Line No.;
                                                              NOR=F›lgeseddellinjenr.];
                                                   Editable=No }
    { 68  ;   ;Bill-to Customer No.;Code20        ;TableRelation=Customer;
                                                   CaptionML=[ENU=Bill-to Customer No.;
                                                              NOR=Faktura til-kundenr.];
                                                   Editable=No }
    { 69  ;   ;Inv. Discount Amount;Decimal       ;CaptionML=[ENU=Inv. Discount Amount;
                                                              NOR=Fakturarabattbel›p];
                                                   AutoFormatType=1;
                                                   AutoFormatExpr=GetCurrencyCode }
    { 73  ;   ;Drop Shipment       ;Boolean       ;AccessByPermission=TableData 223=R;
                                                   CaptionML=[ENU=Drop Shipment;
                                                              NOR=Direkte levering] }
    { 74  ;   ;Gen. Bus. Posting Group;Code10     ;TableRelation="Gen. Business Posting Group";
                                                   CaptionML=[ENU=Gen. Bus. Posting Group;
                                                              NOR=Bokf›ringsgruppe - firma] }
    { 75  ;   ;Gen. Prod. Posting Group;Code10    ;TableRelation="Gen. Product Posting Group";
                                                   CaptionML=[ENU=Gen. Prod. Posting Group;
                                                              NOR=Bokf›ringsgruppe - vare] }
    { 77  ;   ;VAT Calculation Type;Option        ;CaptionML=[ENU=VAT Calculation Type;
                                                              NOR=Mva-beregningstype];
                                                   OptionCaptionML=[ENU=Normal VAT,Reverse Charge VAT,Full VAT,Sales Tax;
                                                                    NOR=Normal mva.,Snudd avregning,Full mva.,Salgsmva.];
                                                   OptionString=Normal VAT,Reverse Charge VAT,Full VAT,Sales Tax }
    { 78  ;   ;Transaction Type    ;Code10        ;TableRelation="Transaction Type";
                                                   CaptionML=[ENU=Transaction Type;
                                                              NOR=Transaksjonsart] }
    { 79  ;   ;Transport Method    ;Code10        ;TableRelation="Transport Method";
                                                   CaptionML=[ENU=Transport Method;
                                                              NOR=Transportm†te] }
    { 80  ;   ;Attached to Line No.;Integer       ;TableRelation="Sales Invoice Line"."Line No." WHERE (Document No.=FIELD(Document No.));
                                                   CaptionML=[ENU=Attached to Line No.;
                                                              NOR=Knyttet til linjenr.] }
    { 81  ;   ;Exit Point          ;Code10        ;TableRelation="Entry/Exit Point";
                                                   CaptionML=[ENU=Exit Point;
                                                              NOR=Utpunkt] }
    { 82  ;   ;Area                ;Code10        ;TableRelation=Area;
                                                   CaptionML=[ENU=Area;
                                                              NOR=Omr†de] }
    { 83  ;   ;Transaction Specification;Code10   ;TableRelation="Transaction Specification";
                                                   CaptionML=[ENU=Transaction Specification;
                                                              NOR=Transaksjonsspesifikasjon] }
    { 84  ;   ;Tax Category        ;Code10        ;CaptionML=[ENU=Tax Category;
                                                              NOR=Avgiftskategori] }
    { 85  ;   ;Tax Area Code       ;Code20        ;TableRelation="Tax Area";
                                                   CaptionML=[ENU=Tax Area Code;
                                                              NOR=Mva-omr†dekode] }
    { 86  ;   ;Tax Liable          ;Boolean       ;CaptionML=[ENU=Tax Liable;
                                                              NOR=Skyldig mva.] }
    { 87  ;   ;Tax Group Code      ;Code10        ;TableRelation="Tax Group";
                                                   CaptionML=[ENU=Tax Group Code;
                                                              NOR=Mva-gruppekode] }
    { 88  ;   ;VAT Clause Code     ;Code10        ;TableRelation="VAT Clause";
                                                   CaptionML=[ENU=VAT Clause Code;
                                                              NOR=Mva-setningskode] }
    { 89  ;   ;VAT Bus. Posting Group;Code10      ;TableRelation="VAT Business Posting Group";
                                                   CaptionML=[ENU=VAT Bus. Posting Group;
                                                              NOR=Mva-bokf›ringsgruppe - firma] }
    { 90  ;   ;VAT Prod. Posting Group;Code10     ;TableRelation="VAT Product Posting Group";
                                                   CaptionML=[ENU=VAT Prod. Posting Group;
                                                              NOR=Mva-bokf›ringsgruppe - vare] }
    { 97  ;   ;Blanket Order No.   ;Code20        ;TableRelation="Sales Header".No. WHERE (Document Type=CONST(Blanket Order));
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Blanket Order No.;
                                                              NOR=Rammeordrenr.] }
    { 98  ;   ;Blanket Order Line No.;Integer     ;TableRelation="Sales Line"."Line No." WHERE (Document Type=CONST(Blanket Order),
                                                                                                Document No.=FIELD(Blanket Order No.));
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Blanket Order Line No.;
                                                              NOR=Rammeordrelinjenr.] }
    { 99  ;   ;VAT Base Amount     ;Decimal       ;CaptionML=[ENU=VAT Base Amount;
                                                              NOR=Mva-grunnlagsbel›p];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr=GetCurrencyCode }
    { 100 ;   ;Unit Cost           ;Decimal       ;CaptionML=[ENU=Unit Cost;
                                                              NOR=Enhetskost];
                                                   Editable=No;
                                                   AutoFormatType=2;
                                                   AutoFormatExpr=GetCurrencyCode }
    { 101 ;   ;System-Created Entry;Boolean       ;CaptionML=[ENU=System-Created Entry;
                                                              NOR=Opprettet automatisk];
                                                   Editable=No }
    { 103 ;   ;Line Amount         ;Decimal       ;CaptionML=[ENU=Line Amount;
                                                              NOR=Linjebel›p];
                                                   AutoFormatType=1;
                                                   AutoFormatExpr=GetCurrencyCode;
                                                   CaptionClass=GetCaptionClass(FIELDNO("Line Amount")) }
    { 104 ;   ;VAT Difference      ;Decimal       ;CaptionML=[ENU=VAT Difference;
                                                              NOR=Mva-differanse];
                                                   AutoFormatType=1;
                                                   AutoFormatExpr=GetCurrencyCode }
    { 106 ;   ;VAT Identifier      ;Code10        ;CaptionML=[ENU=VAT Identifier;
                                                              NOR=Mva-type];
                                                   Editable=No }
    { 107 ;   ;IC Partner Ref. Type;Option        ;CaptionML=[ENU=IC Partner Ref. Type;
                                                              NOR=Referansetype for KI-partner];
                                                   OptionCaptionML=[ENU=" ,G/L Account,Item,,,Charge (Item),Cross reference,Common Item No.";
                                                                    NOR=" ,Finanskonto,Vare,,,Gebyr (vare),Kryssreferanse,Felles varenr."];
                                                   OptionString=[ ,G/L Account,Item,,,Charge (Item),Cross reference,Common Item No.] }
    { 108 ;   ;IC Partner Reference;Code20        ;CaptionML=[ENU=IC Partner Reference;
                                                              NOR=Referanse for KI-partner] }
    { 123 ;   ;Prepayment Line     ;Boolean       ;CaptionML=[ENU=Prepayment Line;
                                                              NOR=Forskuddslinje];
                                                   Editable=No }
    { 130 ;   ;IC Partner Code     ;Code20        ;TableRelation="IC Partner";
                                                   CaptionML=[ENU=IC Partner Code;
                                                              NOR=KI-partnerkode] }
    { 131 ;   ;Posting Date        ;Date          ;CaptionML=[ENU=Posting Date;
                                                              NOR=Bokf›ringsdato] }
    { 480 ;   ;Dimension Set ID    ;Integer       ;TableRelation="Dimension Set Entry";
                                                   OnLookup=BEGIN
                                                              ShowDimensions;
                                                            END;

                                                   CaptionML=[ENU=Dimension Set ID;
                                                              NOR=Dimensjonssett-ID];
                                                   Editable=No }
    { 1001;   ;Job Task No.        ;Code20        ;TableRelation="Job Task"."Job Task No." WHERE (Job No.=FIELD(Job No.));
                                                   CaptionML=[ENU=Job Task No.;
                                                              NOR=Prosjektoppgavenr.];
                                                   Editable=No }
    { 1002;   ;Job Contract Entry No.;Integer     ;CaptionML=[ENU=Job Contract Entry No.;
                                                              NOR=L›penr. for prosjektkontrakt];
                                                   Editable=No }
    { 1700;   ;Deferral Code       ;Code10        ;TableRelation="Deferral Template"."Deferral Code";
                                                   CaptionML=[ENU=Deferral Code;
                                                              NOR=Periodiseringskode] }
    { 5402;   ;Variant Code        ;Code10        ;TableRelation=IF (Type=CONST(Item)) "Item Variant".Code WHERE (Item No.=FIELD(No.));
                                                   CaptionML=[ENU=Variant Code;
                                                              NOR=Variantkode] }
    { 5403;   ;Bin Code            ;Code20        ;TableRelation=Bin.Code WHERE (Location Code=FIELD(Location Code),
                                                                                 Item Filter=FIELD(No.),
                                                                                 Variant Filter=FIELD(Variant Code));
                                                   CaptionML=[ENU=Bin Code;
                                                              NOR=Hyllekode] }
    { 5404;   ;Qty. per Unit of Measure;Decimal   ;CaptionML=[ENU=Qty. per Unit of Measure;
                                                              NOR=Antall per enhet];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 5407;   ;Unit of Measure Code;Code10        ;TableRelation=IF (Type=CONST(Item)) "Item Unit of Measure".Code WHERE (Item No.=FIELD(No.))
                                                                 ELSE "Unit of Measure";
                                                   CaptionML=[ENU=Unit of Measure Code;
                                                              NOR=Enhetskode] }
    { 5415;   ;Quantity (Base)     ;Decimal       ;CaptionML=[ENU=Quantity (Base);
                                                              NOR=Antall (lagerenhet)];
                                                   DecimalPlaces=0:5 }
    { 5600;   ;FA Posting Date     ;Date          ;CaptionML=[ENU=FA Posting Date;
                                                              NOR=Aktivabokf.dato] }
    { 5602;   ;Depreciation Book Code;Code10      ;TableRelation="Depreciation Book";
                                                   CaptionML=[ENU=Depreciation Book Code;
                                                              NOR=Avskrivningstabl†kode] }
    { 5605;   ;Depr. until FA Posting Date;Boolean;CaptionML=[ENU=Depr. until FA Posting Date;
                                                              NOR=Avskr. frem til aktivabokf.dato] }
    { 5612;   ;Duplicate in Depreciation Book;Code10;
                                                   TableRelation="Depreciation Book";
                                                   CaptionML=[ENU=Duplicate in Depreciation Book;
                                                              NOR=Duplikat i avskrivningstabl†] }
    { 5613;   ;Use Duplication List;Boolean       ;CaptionML=[ENU=Use Duplication List;
                                                              NOR=Bruk duplikatoversikt] }
    { 5700;   ;Responsibility Center;Code10       ;TableRelation="Responsibility Center";
                                                   CaptionML=[ENU=Responsibility Center;
                                                              NOR=Ansvarssenter] }
    { 5705;   ;Cross-Reference No. ;Code20        ;AccessByPermission=TableData 5717=R;
                                                   CaptionML=[ENU=Cross-Reference No.;
                                                              NOR=Kryssreferansenr.] }
    { 5706;   ;Unit of Measure (Cross Ref.);Code10;TableRelation=IF (Type=CONST(Item)) "Item Unit of Measure".Code WHERE (Item No.=FIELD(No.));
                                                   CaptionML=[ENU=Unit of Measure (Cross Ref.);
                                                              NOR=Enhet (kryssref.)] }
    { 5707;   ;Cross-Reference Type;Option        ;CaptionML=[ENU=Cross-Reference Type;
                                                              NOR=Kryssreferansetype];
                                                   OptionCaptionML=[ENU=" ,Customer,Vendor,Bar Code";
                                                                    NOR=" ,Kunde,Leverand›r,Strekkode"];
                                                   OptionString=[ ,Customer,Vendor,Bar Code] }
    { 5708;   ;Cross-Reference Type No.;Code30    ;CaptionML=[ENU=Cross-Reference Type No.;
                                                              NOR=Kryssreferansetypenr.] }
    { 5709;   ;Item Category Code  ;Code20        ;TableRelation=IF (Type=CONST(Item)) "Item Category";
                                                   CaptionML=[ENU=Item Category Code;
                                                              NOR=Varekategorikode] }
    { 5710;   ;Nonstock            ;Boolean       ;CaptionML=[ENU=Nonstock;
                                                              NOR=Katalogvare] }
    { 5711;   ;Purchasing Code     ;Code10        ;TableRelation=Purchasing;
                                                   CaptionML=[ENU=Purchasing Code;
                                                              NOR=Kj›pskode] }
    { 5712;   ;Product Group Code  ;Code10        ;TableRelation="Product Group".Code WHERE (Item Category Code=FIELD(Item Category Code));
                                                   ValidateTableRelation=No;
                                                   CaptionML=[ENU=Product Group Code;
                                                              NOR=Produktgruppekode] }
    { 5811;   ;Appl.-from Item Entry;Integer      ;AccessByPermission=TableData 27=R;
                                                   CaptionML=[ENU=Appl.-from Item Entry;
                                                              NOR=Utlignet fra-varepost];
                                                   MinValue=0 }
    { 6608;   ;Return Reason Code  ;Code10        ;TableRelation="Return Reason";
                                                   CaptionML=[ENU=Return Reason Code;
                                                              NOR=Retur†rsakskode] }
    { 7001;   ;Allow Line Disc.    ;Boolean       ;InitValue=Yes;
                                                   CaptionML=[ENU=Allow Line Disc.;
                                                              NOR=Tillat linjerabatt] }
    { 7002;   ;Customer Disc. Group;Code20        ;TableRelation="Customer Discount Group";
                                                   CaptionML=[ENU=Customer Disc. Group;
                                                              NOR=Kunderabattgruppe] }
    { 10604;  ;VAT Code            ;Code10        ;TableRelation="VAT Code".Code;
                                                   CaptionML=[ENU=VAT Code;
                                                              NOR=Mva-kode] }
    { 10605;  ;Account Code        ;Text30        ;CaptionML=[ENU=Account Code;
                                                              NOR=Kontokode] }
    { 73050;  ;Calculation No.     ;Code20        ;TableRelation="Item Calc. Header".No. WHERE (Item No.=FIELD(No.));
                                                   CaptionML=[ENU=Calculation No.;
                                                              NOR=Kalkylenr.];
                                                   Editable=No }
  }
  KEYS
  {
    {    ;Document No.,Line No.                   ;SumIndexFields=Amount,Amount Including VAT;
                                                   MaintainSIFTIndex=No;
                                                   Clustered=Yes }
    {    ;Blanket Order No.,Blanket Order Line No. }
    {    ;Sell-to Customer No.                     }
    { No ;Sell-to Customer No.,Type,Document No.  ;MaintainSQLIndex=No }
    {    ;Shipment No.,Shipment Line No.           }
    {    ;Job Contract Entry No.                   }
    {    ;Bill-to Customer No.                     }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      ApplicationAreaSetup@1003 : Record 9178;
      DimMgt@1001 : Codeunit 408;
      DeferralUtilities@1000 : Codeunit 1720;
      ItemNoFieldCaptionTxt@1002 : TextConst 'ENU=Item No.;NOR=Varenr.';

    PROCEDURE GetCurrencyCode@1() : Code[10];
    VAR
      SalesInvHeader@1000 : Record 112;
    BEGIN
      IF "Document No." = SalesInvHeader."No." THEN
        EXIT(SalesInvHeader."Currency Code");
      IF SalesInvHeader.GET("Document No.") THEN
        EXIT(SalesInvHeader."Currency Code");
      EXIT('');
    END;

    PROCEDURE ShowDimensions@25();
    BEGIN
      DimMgt.ShowDimensionSet("Dimension Set ID",STRSUBSTNO('%1 %2 %3',TABLECAPTION,"Document No.","Line No."));
    END;

    PROCEDURE ShowItemTrackingLines@3();
    VAR
      ItemTrackingDocMgt@1000 : Codeunit 6503;
    BEGIN
      ItemTrackingDocMgt.ShowItemTrackingForInvoiceLine(RowID1);
    END;

    PROCEDURE CalcVATAmountLines@2(SalesInvHeader@1000 : Record 112;VAR TempVATAmountLine@1001 : TEMPORARY Record 290);
    BEGIN
      TempVATAmountLine.DELETEALL;
      SETRANGE("Document No.",SalesInvHeader."No.");
      IF FIND('-') THEN
        REPEAT
          TempVATAmountLine.INIT;
          TempVATAmountLine.CopyFromSalesInvLine(Rec);
          TempVATAmountLine.InsertLine;
        UNTIL NEXT = 0;
    END;

    LOCAL PROCEDURE GetFieldCaption@31(FieldNumber@1000 : Integer) : Text[100];
    VAR
      Field@1001 : Record 2000000041;
    BEGIN
      Field.GET(DATABASE::"Sales Invoice Line",FieldNumber);
      EXIT(Field."Field Caption");
    END;

    LOCAL PROCEDURE GetCaptionClass@34(FieldNumber@1000 : Integer) : Text[80];
    VAR
      SalesInvHeader@1001 : Record 112;
    BEGIN
      IF NOT SalesInvHeader.GET("Document No.") THEN
        SalesInvHeader.INIT;
      CASE FieldNumber OF
        FIELDNO("No."):
          BEGIN
            IF ApplicationAreaSetup.IsFoundationEnabled THEN
              EXIT(STRSUBSTNO('3,%1',ItemNoFieldCaptionTxt));
            EXIT(STRSUBSTNO('3,%1',GetFieldCaption(FieldNumber)));
          END;
        ELSE BEGIN
          IF SalesInvHeader."Prices Including VAT" THEN
            EXIT('2,1,' + GetFieldCaption(FieldNumber));
          EXIT('2,0,' + GetFieldCaption(FieldNumber));
        END
      END;
    END;

    PROCEDURE RowID1@44() : Text[250];
    VAR
      ItemTrackingMgt@1000 : Codeunit 6500;
    BEGIN
      EXIT(ItemTrackingMgt.ComposeRowID(DATABASE::"Sales Invoice Line",
          0,"Document No.",'',0,"Line No."));
    END;

    LOCAL PROCEDURE GetSalesShptLines@4(VAR TempSalesShptLine@1000 : TEMPORARY Record 111);
    VAR
      SalesShptLine@1003 : Record 111;
      ItemLedgEntry@1002 : Record 32;
      ValueEntry@1001 : Record 5802;
    BEGIN
      TempSalesShptLine.RESET;
      TempSalesShptLine.DELETEALL;

      IF Type <> Type::Item THEN
        EXIT;

      FilterPstdDocLineValueEntries(ValueEntry);
      IF ValueEntry.FINDSET THEN
        REPEAT
          ItemLedgEntry.GET(ValueEntry."Item Ledger Entry No.");
          IF ItemLedgEntry."Document Type" = ItemLedgEntry."Document Type"::"Sales Shipment" THEN
            IF SalesShptLine.GET(ItemLedgEntry."Document No.",ItemLedgEntry."Document Line No.") THEN BEGIN
              TempSalesShptLine.INIT;
              TempSalesShptLine := SalesShptLine;
              IF TempSalesShptLine.INSERT THEN;
            END;
        UNTIL ValueEntry.NEXT = 0;
    END;

    PROCEDURE CalcShippedSaleNotReturned@5(VAR ShippedQtyNotReturned@1006 : Decimal;VAR RevUnitCostLCY@1004 : Decimal;ExactCostReverse@1003 : Boolean);
    VAR
      TempItemLedgEntry@1002 : TEMPORARY Record 32;
      TotalCostLCY@1009 : Decimal;
      TotalQtyBase@1007 : Decimal;
    BEGIN
      ShippedQtyNotReturned := 0;
      IF (Type <> Type::Item) OR (Quantity <= 0) THEN BEGIN
        RevUnitCostLCY := "Unit Cost (LCY)";
        EXIT;
      END;

      RevUnitCostLCY := 0;
      GetItemLedgEntries(TempItemLedgEntry,FALSE);
      IF TempItemLedgEntry.FINDSET THEN
        REPEAT
          ShippedQtyNotReturned := ShippedQtyNotReturned - TempItemLedgEntry."Shipped Qty. Not Returned";
          IF ExactCostReverse THEN BEGIN
            TempItemLedgEntry.CALCFIELDS("Cost Amount (Expected)","Cost Amount (Actual)");
            TotalCostLCY :=
              TotalCostLCY + TempItemLedgEntry."Cost Amount (Expected)" + TempItemLedgEntry."Cost Amount (Actual)";
            TotalQtyBase := TotalQtyBase + TempItemLedgEntry.Quantity;
          END;
        UNTIL TempItemLedgEntry.NEXT = 0;

      IF ExactCostReverse AND (ShippedQtyNotReturned <> 0) AND (TotalQtyBase <> 0) THEN
        RevUnitCostLCY := ABS(TotalCostLCY / TotalQtyBase) * "Qty. per Unit of Measure"
      ELSE
        RevUnitCostLCY := "Unit Cost (LCY)";
      ShippedQtyNotReturned := CalcQty(ShippedQtyNotReturned);

      IF ShippedQtyNotReturned > Quantity THEN
        ShippedQtyNotReturned := Quantity;
    END;

    LOCAL PROCEDURE CalcQty@11(QtyBase@1000 : Decimal) : Decimal;
    BEGIN
      IF "Qty. per Unit of Measure" = 0 THEN
        EXIT(QtyBase);
      EXIT(ROUND(QtyBase / "Qty. per Unit of Measure",0.00001));
    END;

    PROCEDURE GetItemLedgEntries@6(VAR TempItemLedgEntry@1000 : TEMPORARY Record 32;SetQuantity@1003 : Boolean);
    VAR
      ItemLedgEntry@1002 : Record 32;
      ValueEntry@1001 : Record 5802;
    BEGIN
      IF SetQuantity THEN BEGIN
        TempItemLedgEntry.RESET;
        TempItemLedgEntry.DELETEALL;

        IF Type <> Type::Item THEN
          EXIT;
      END;

      FilterPstdDocLineValueEntries(ValueEntry);
      ValueEntry.SETFILTER("Invoiced Quantity",'<>0');
      IF ValueEntry.FINDSET THEN
        REPEAT
          ItemLedgEntry.GET(ValueEntry."Item Ledger Entry No.");
          TempItemLedgEntry := ItemLedgEntry;
          IF SetQuantity THEN BEGIN
            TempItemLedgEntry.Quantity := ValueEntry."Invoiced Quantity";
            IF ABS(TempItemLedgEntry."Shipped Qty. Not Returned") > ABS(TempItemLedgEntry.Quantity) THEN
              TempItemLedgEntry."Shipped Qty. Not Returned" := TempItemLedgEntry.Quantity;
          END;
          IF TempItemLedgEntry.INSERT THEN;
        UNTIL ValueEntry.NEXT = 0;
    END;

    PROCEDURE FilterPstdDocLineValueEntries@7(VAR ValueEntry@1000 : Record 5802);
    BEGIN
      ValueEntry.RESET;
      ValueEntry.SETCURRENTKEY("Document No.");
      ValueEntry.SETRANGE("Document No.","Document No.");
      ValueEntry.SETRANGE("Document Type",ValueEntry."Document Type"::"Sales Invoice");
      ValueEntry.SETRANGE("Document Line No.","Line No.");
    END;

    PROCEDURE ShowItemShipmentLines@9();
    VAR
      TempSalesShptLine@1000 : TEMPORARY Record 111;
    BEGIN
      IF Type = Type::Item THEN BEGIN
        GetSalesShptLines(TempSalesShptLine);
        PAGE.RUNMODAL(0,TempSalesShptLine);
      END;
    END;

    PROCEDURE ShowLineComments@8();
    VAR
      SalesDocLineComments@1000 : Record 44;
      SalesDocCommentSheet@1001 : Page 67;
    BEGIN
      SalesDocLineComments.SETRANGE("Document Type",SalesDocLineComments."Document Type"::"Posted Invoice");
      SalesDocLineComments.SETRANGE("No.","Document No.");
      SalesDocLineComments.SETRANGE("Document Line No.","Line No.");
      SalesDocCommentSheet.SETTABLEVIEW(SalesDocLineComments);
      SalesDocCommentSheet.RUNMODAL;
    END;

    PROCEDURE InitFromSalesLine@12(SalesInvHeader@1002 : Record 112;SalesLine@1001 : Record 37);
    BEGIN
      INIT;
      TRANSFERFIELDS(SalesLine);
      IF ("No." = '') AND (Type IN [Type::"G/L Account"..Type::"Charge (Item)"]) THEN
        Type := Type::" ";
      "Posting Date" := SalesInvHeader."Posting Date";
      "Document No." := SalesInvHeader."No.";
      Quantity := SalesLine."Qty. to Invoice";
      "Quantity (Base)" := SalesLine."Qty. to Invoice (Base)";
    END;

    PROCEDURE ShowDeferrals@13();
    BEGIN
      DeferralUtilities.OpenLineScheduleView(
        "Deferral Code",DeferralUtilities.GetSalesDeferralDocType,'','',
        GetDocumentType,"Document No.","Line No.");
    END;

    PROCEDURE GetDocumentType@14() : Integer;
    VAR
      SalesCommentLine@1000 : Record 44;
    BEGIN
      EXIT(SalesCommentLine."Document Type"::"Posted Invoice")
    END;

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 08.09.17 JAL Item Calculation (Kalkyle)
                       New field "Calulation No."
    }
    END.
  }
}

OBJECT Table 313 Inventory Setup
{
  OBJECT-PROPERTIES
  {
    Date=08.09.17;
    Time=14.02.41;
    Modified=Yes;
    Version List=NAVW19.00,ICA2.01;
  }
  PROPERTIES
  {
    Permissions=TableData 5896=m;
    CaptionML=[ENU=Inventory Setup;
               NOR=Lageroppsett];
  }
  FIELDS
  {
    { 1   ;   ;Primary Key         ;Code10        ;CaptionML=[ENU=Primary Key;
                                                              NOR=Prim‘rn›kkel] }
    { 2   ;   ;Automatic Cost Posting;Boolean     ;OnValidate=VAR
                                                                GLSetup@1000 : Record 98;
                                                              BEGIN
                                                                IF "Automatic Cost Posting" THEN BEGIN
                                                                  IF GLSetup.GET THEN
                                                                    IF NOT GLSetup."Use Legacy G/L Entry Locking" THEN
                                                                      MESSAGE(Text006,
                                                                        FIELDCAPTION("Automatic Cost Posting"),
                                                                        "Automatic Cost Posting",
                                                                        GLSetup.FIELDCAPTION("Use Legacy G/L Entry Locking"),
                                                                        GLSetup.TABLECAPTION,
                                                                        GLSetup."Use Legacy G/L Entry Locking");
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Automatic Cost Posting;
                                                              NOR=Automatisk kostbokf›ring] }
    { 3   ;   ;Location Mandatory  ;Boolean       ;AccessByPermission=TableData 14=R;
                                                   CaptionML=[ENU=Location Mandatory;
                                                              NOR=Lokasjon obligatorisk] }
    { 4   ;   ;Item Nos.           ;Code10        ;TableRelation="No. Series";
                                                   CaptionML=[ENU=Item Nos.;
                                                              NOR=Varenr.] }
    { 30  ;   ;Automatic Cost Adjustment;Option   ;OnValidate=BEGIN
                                                                IF "Automatic Cost Adjustment" <> "Automatic Cost Adjustment"::Never THEN BEGIN
                                                                  Item.SETCURRENTKEY("Cost is Adjusted","Allow Online Adjustment");
                                                                  Item.SETRANGE("Cost is Adjusted",FALSE);
                                                                  Item.SETRANGE("Allow Online Adjustment",FALSE);

                                                                  UpdateInvtAdjmtEntryOrder;

                                                                  InvtAdjmtEntryOrder.SETCURRENTKEY("Cost is Adjusted","Allow Online Adjustment");
                                                                  InvtAdjmtEntryOrder.SETRANGE("Cost is Adjusted",FALSE);
                                                                  InvtAdjmtEntryOrder.SETRANGE("Allow Online Adjustment",FALSE);
                                                                  InvtAdjmtEntryOrder.SETRANGE("Is Finished",TRUE);

                                                                  IF NOT (Item.ISEMPTY AND InvtAdjmtEntryOrder.ISEMPTY) THEN
                                                                    MESSAGE(Text000);
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Automatic Cost Adjustment;
                                                              NOR=Automatisk kostjustering];
                                                   OptionCaptionML=[ENU=Never,Day,Week,Month,Quarter,Year,Always;
                                                                    NOR=Aldri,Dag,Uke,M†ned,Kvartal,r,Alltid];
                                                   OptionString=Never,Day,Week,Month,Quarter,Year,Always }
    { 40  ;   ;Prevent Negative Inventory;Boolean ;CaptionML=[ENU=Prevent Negative Inventory;
                                                              NOR=Forhindre negativ beholdning] }
    { 5700;   ;Transfer Order Nos. ;Code10        ;TableRelation="No. Series";
                                                   AccessByPermission=TableData 5740=R;
                                                   CaptionML=[ENU=Transfer Order Nos.;
                                                              NOR=Overf›ringsordrenr.] }
    { 5701;   ;Posted Transfer Shpt. Nos.;Code10  ;TableRelation="No. Series";
                                                   AccessByPermission=TableData 5740=R;
                                                   CaptionML=[ENU=Posted Transfer Shpt. Nos.;
                                                              NOR=Bokf›rte overf›ringsseddelnr.] }
    { 5702;   ;Posted Transfer Rcpt. Nos.;Code10  ;TableRelation="No. Series";
                                                   AccessByPermission=TableData 5740=R;
                                                   CaptionML=[ENU=Posted Transfer Rcpt. Nos.;
                                                              NOR=Bokf›rte overf.mottaksnr.] }
    { 5703;   ;Copy Comments Order to Shpt.;Boolean;
                                                   InitValue=Yes;
                                                   AccessByPermission=TableData 5740=R;
                                                   CaptionML=[ENU=Copy Comments Order to Shpt.;
                                                              NOR=Kopier ordremerk. til f›lges.] }
    { 5704;   ;Copy Comments Order to Rcpt.;Boolean;
                                                   InitValue=Yes;
                                                   AccessByPermission=TableData 5740=R;
                                                   CaptionML=[ENU=Copy Comments Order to Rcpt.;
                                                              NOR=Kopier merk. fra ordre til mott.] }
    { 5718;   ;Nonstock Item Nos.  ;Code10        ;TableRelation="No. Series";
                                                   AccessByPermission=TableData 5718=R;
                                                   CaptionML=[ENU=Nonstock Item Nos.;
                                                              NOR=Katalogvarenr.] }
    { 5790;   ;Outbound Whse. Handling Time;DateFormula;
                                                   AccessByPermission=TableData 14=R;
                                                   CaptionML=[ENU=Outbound Whse. Handling Time;
                                                              NOR=Utg†ende lagerh†ndteringstid] }
    { 5791;   ;Inbound Whse. Handling Time;DateFormula;
                                                   AccessByPermission=TableData 14=R;
                                                   CaptionML=[ENU=Inbound Whse. Handling Time;
                                                              NOR=Inng†ende lagerh†ndteringstid] }
    { 5800;   ;Expected Cost Posting to G/L;Boolean;
                                                   OnValidate=VAR
                                                                ChangeExpCostPostToGL@1000 : Codeunit 5811;
                                                              BEGIN
                                                                IF "Expected Cost Posting to G/L" <> xRec."Expected Cost Posting to G/L" THEN
                                                                  IF ItemLedgEntry.FINDFIRST THEN BEGIN
                                                                    ChangeExpCostPostToGL.ChangeExpCostPostingToGL(Rec,"Expected Cost Posting to G/L");
                                                                    FIND;
                                                                  END;
                                                              END;

                                                   CaptionML=[ENU=Expected Cost Posting to G/L;
                                                              NOR=Bokf. av forventet kost i Finans] }
    { 5804;   ;Average Cost Calc. Type;Option     ;InitValue=Item;
                                                   OnValidate=BEGIN
                                                                TESTFIELD("Average Cost Calc. Type");
                                                                IF "Average Cost Calc. Type" <> xRec."Average Cost Calc. Type" THEN
                                                                  UpdateAvgCostItemSettings(FIELDCAPTION("Average Cost Calc. Type"),FORMAT("Average Cost Calc. Type"));
                                                              END;

                                                   CaptionML=[ENU=Average Cost Calc. Type;
                                                              NOR=Beregn.type for gj.snittskost];
                                                   OptionCaptionML=[ENU=" ,Item,Item & Location & Variant";
                                                                    NOR=" ,Vare,Vare og lokasjon og variant"];
                                                   OptionString=[ ,Item,Item & Location & Variant];
                                                   NotBlank=Yes }
    { 5805;   ;Average Cost Period ;Option        ;InitValue=Day;
                                                   OnValidate=BEGIN
                                                                TESTFIELD("Average Cost Period");
                                                                IF "Average Cost Period" <> xRec."Average Cost Period" THEN
                                                                  UpdateAvgCostItemSettings(FIELDCAPTION("Average Cost Period"),FORMAT("Average Cost Period"));
                                                              END;

                                                   CaptionML=[ENU=Average Cost Period;
                                                              NOR=Gjennomsnittskostperiode];
                                                   OptionCaptionML=[ENU=" ,Day,Week,Month,Quarter,Year,Accounting Period";
                                                                    NOR=" ,Dag,Uke,M†ned,Kvartal,r,Regnskapsperiode"];
                                                   OptionString=[ ,Day,Week,Month,Quarter,Year,Accounting Period];
                                                   NotBlank=Yes }
    { 7101;   ;Item Group Dimension Code;Code20   ;TableRelation=Dimension;
                                                   CaptionML=[ENU=Item Group Dimension Code;
                                                              NOR=Dimensjonskode for varegruppe] }
    { 7300;   ;Inventory Put-away Nos.;Code10     ;TableRelation="No. Series";
                                                   AccessByPermission=TableData 7340=R;
                                                   CaptionML=[ENU=Inventory Put-away Nos.;
                                                              NOR=Lagerplasseringsnr.] }
    { 7301;   ;Inventory Pick Nos. ;Code10        ;TableRelation="No. Series";
                                                   AccessByPermission=TableData 7342=R;
                                                   CaptionML=[ENU=Inventory Pick Nos.;
                                                              NOR=Lagerplukknr.] }
    { 7302;   ;Posted Invt. Put-away Nos.;Code10  ;TableRelation="No. Series";
                                                   AccessByPermission=TableData 7340=R;
                                                   CaptionML=[ENU=Posted Invt. Put-away Nos.;
                                                              NOR=Bokf›rte lagerplasseringsnr.] }
    { 7303;   ;Posted Invt. Pick Nos.;Code10      ;TableRelation="No. Series";
                                                   AccessByPermission=TableData 7342=R;
                                                   CaptionML=[ENU=Posted Invt. Pick Nos.;
                                                              NOR=Bokf›rte lagerplukknr.] }
    { 7304;   ;Inventory Movement Nos.;Code10     ;TableRelation="No. Series";
                                                   AccessByPermission=TableData 7331=R;
                                                   CaptionML=[ENU=Inventory Movement Nos.;
                                                              NOR=Lagerflyttingsnr.] }
    { 7305;   ;Registered Invt. Movement Nos.;Code10;
                                                   TableRelation="No. Series";
                                                   AccessByPermission=TableData 7331=R;
                                                   CaptionML=[ENU=Registered Invt. Movement Nos.;
                                                              NOR=Registrert lagerflyttingsnr.] }
    { 7306;   ;Internal Movement Nos.;Code10      ;TableRelation="No. Series";
                                                   AccessByPermission=TableData 7331=R;
                                                   CaptionML=[ENU=Internal Movement Nos.;
                                                              NOR=Nr. for intern flytting] }
    { 73050;  ;Item Calculation Nos.;Code20       ;TableRelation="No. Series".Code;
                                                   CaptionML=[ENU=Item Calculation Nos.;
                                                              NOR=Kalkylenr.] }
  }
  KEYS
  {
    {    ;Primary Key                             ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      ItemLedgEntry@1000 : Record 32;
      Text000@1001 : TextConst 'ENU=Some unadjusted value entries will not be covered with the new setting. You must run the Adjust Cost - Item Entries batch job once to adjust these.;NOR=Enkelte ikke justerte verdioppf›ringer vil ikke bli dekket med den nye innstillingen. Du m† sette i gang kj›rselen Juster kostverdi - vareposter ‚n gang for † justere disse.';
      Item@1002 : Record 27;
      InvtAdjmtEntryOrder@1003 : Record 5896;
      Text001@1005 : TextConst 'ENU=If you change the %1, the program must adjust all item entries.;NOR=Hvis du endrer p† %1, m† programmet justere alle varepostene.';
      Text002@1006 : TextConst 'ENU=The adjustment of all entries can take several hours.\;NOR=Justeringen av alle postene kan ta flere timer.\';
      Text003@1007 : TextConst 'ENU=Do you really want to change the %1?;NOR=Er du sikker p† at du vil endre p† %1?';
      Text004@1008 : TextConst 'ENU=The program has cancelled the change that would have caused an adjustment of all items.;NOR=Programmet har avbrutt endringen som ville ha for†rsaket justering av alle varene.';
      Text005@1009 : TextConst 'ENU=%1 has been changed to %2. You should now run %3.;NOR=%1 er endret til %2. Du m† starte %3.';
      ObjTransl@1011 : Record 377;
      Text006@1004 : TextConst 'ENU=The field %1 should not be set to %2 if field %3 in %4 table is set to %5 because of possibility of deadlocks.;NOR=Feltet %1 m† ikke settes til %2 hvis feltet %3 i %4-tabellen er satt til %5 p† grunn av muligheten for l†sing (deadlock).';

    LOCAL PROCEDURE UpdateInvtAdjmtEntryOrder@2();
    VAR
      InvtAdjmtEntryOrder@1000 : Record 5896;
    BEGIN
      InvtAdjmtEntryOrder.SETCURRENTKEY("Cost is Adjusted","Allow Online Adjustment");
      InvtAdjmtEntryOrder.SETRANGE("Cost is Adjusted",FALSE);
      InvtAdjmtEntryOrder.SETRANGE("Allow Online Adjustment",FALSE);
      InvtAdjmtEntryOrder.SETRANGE("Is Finished",FALSE);
      InvtAdjmtEntryOrder.SETRANGE("Order Type",InvtAdjmtEntryOrder."Order Type"::Production);
      InvtAdjmtEntryOrder.MODIFYALL("Allow Online Adjustment",TRUE);
    END;

    LOCAL PROCEDURE UpdateAvgCostItemSettings@1(FieldCaption@1000 : Text[80];FieldValue@1001 : Text[80]);
    BEGIN
      IF NOT
         CONFIRM(
           STRSUBSTNO(
             Text001 +
             Text002 +
             Text003,FieldCaption),FALSE)
      THEN
        ERROR(Text004);

      CODEUNIT.RUN(CODEUNIT::"Change Average Cost Setting",Rec);

      MESSAGE(
        Text005,FieldCaption,FieldValue,
        ObjTransl.TranslateObject(ObjTransl."Object Type"::Report,REPORT::"Adjust Cost - Item Entries"));
    END;

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 01.09.17 JAL Item Calculation (Kalkyle)
                       New field "Price Calculation Nos."
    }
    END.
  }
}

OBJECT Table 5406 Prod. Order Line
{
  OBJECT-PROPERTIES
  {
    Date=05.09.17;
    Time=15.50.39;
    Modified=Yes;
    Version List=NAVW110.00.00.16585,ICA2.01;
  }
  PROPERTIES
  {
    DataCaptionFields=Prod. Order No.;
    OnInsert=BEGIN
               IF Status = Status::Finished THEN
                 ERROR(Text000,Status,TABLECAPTION);

               ReserveProdOrderLine.VerifyQuantity(Rec,xRec);
               IF "Routing Reference No." < 0 THEN
                 "Routing Reference No." := "Line No.";
             END;

    OnModify=BEGIN
               IF Status = Status::Finished THEN
                 ERROR(Text000,Status,TABLECAPTION);

               ReserveProdOrderLine.VerifyChange(Rec,xRec);
             END;

    OnDelete=VAR
               ItemLedgEntry@1000 : Record 32;
               CapLedgEntry@1001 : Record 5832;
               PurchLine@1002 : Record 39;
             BEGIN
               IF Status = Status::Finished THEN
                 ERROR(Text000,Status,TABLECAPTION);

               IF Status = Status::Released THEN BEGIN
                 ItemLedgEntry.SETRANGE("Order Type",ItemLedgEntry."Order Type"::Production);
                 ItemLedgEntry.SETRANGE("Order No.","Prod. Order No.");
                 ItemLedgEntry.SETRANGE("Order Line No.","Line No.");
                 IF NOT ItemLedgEntry.ISEMPTY THEN
                   ERROR(
                     Text99000000,
                     TABLECAPTION,"Line No.",ItemLedgEntry.TABLECAPTION);

                 IF CheckCapLedgEntry THEN
                   ERROR(
                     Text99000000,
                     TABLECAPTION,"Line No.",CapLedgEntry.TABLECAPTION);

                 IF CheckSubcontractPurchOrder THEN
                   ERROR(
                     Text99000000,
                     TABLECAPTION,"Line No.",PurchLine.TABLECAPTION);
               END;

               ReserveProdOrderLine.DeleteLine(Rec);

               CALCFIELDS("Reserved Qty. (Base)");
               TESTFIELD("Reserved Qty. (Base)",0);
               WhseValidateSourceLine.ProdOrderLineDelete(Rec);

               DeleteRelations;
             END;

    OnRename=BEGIN
               ERROR(Text99000001,TABLECAPTION);
             END;

    CaptionML=[ENU=Prod. Order Line;
               NOR=Prod.ordrelinje];
    LookupPageID=Page5406;
    DrillDownPageID=Page5406;
  }
  FIELDS
  {
    { 1   ;   ;Status              ;Option        ;CaptionML=[ENU=Status;
                                                              NOR=Status];
                                                   OptionCaptionML=[ENU=Simulated,Planned,Firm Planned,Released,Finished;
                                                                    NOR=Simulert,Planlagt,Fast planlagt,Frigitt,Ferdig];
                                                   OptionString=Simulated,Planned,Firm Planned,Released,Finished }
    { 2   ;   ;Prod. Order No.     ;Code20        ;TableRelation="Production Order".No. WHERE (Status=FIELD(Status));
                                                   CaptionML=[ENU=Prod. Order No.;
                                                              NOR=Prod.ordrenr.] }
    { 3   ;   ;Line No.            ;Integer       ;CaptionML=[ENU=Line No.;
                                                              NOR=Linjenr.] }
    { 11  ;   ;Item No.            ;Code20        ;TableRelation=Item WHERE (Type=CONST(Inventory));
                                                   OnValidate=BEGIN
                                                                ReserveProdOrderLine.VerifyChange(Rec,xRec);
                                                                TESTFIELD("Finished Quantity",0);
                                                                CALCFIELDS("Reserved Quantity");
                                                                TESTFIELD("Reserved Quantity",0);
                                                                WhseValidateSourceLine.ProdOrderLineVerifyChange(Rec,xRec);
                                                                IF "Item No." <> xRec."Item No." THEN BEGIN
                                                                  DeleteRelations;
                                                                  "Variant Code" := '';
                                                                END;
                                                                IF "Item No." = '' THEN
                                                                  INIT
                                                                ELSE BEGIN
                                                                  ProdOrder.GET(Status,"Prod. Order No.");
                                                                  "Starting Date" := ProdOrder."Starting Date";
                                                                  "Starting Time" := ProdOrder."Starting Time";
                                                                  "Ending Date" := ProdOrder."Ending Date";
                                                                  "Ending Time" := ProdOrder."Ending Time";
                                                                  "Due Date" := ProdOrder."Due Date";
                                                                  "Location Code" := ProdOrder."Location Code";
                                                                  "Bin Code" := ProdOrder."Bin Code";
                                                                  IF "Bin Code" = '' THEN
                                                                    GetDefaultBin;

                                                                  GetItem;
                                                                  Item.TESTFIELD("Inventory Posting Group");
                                                                  "Inventory Posting Group" := Item."Inventory Posting Group";

                                                                  Description := Item.Description;
                                                                  "Description 2" := Item."Description 2";
                                                                  "Production BOM No." := Item."Production BOM No.";
                                                                  "Routing No." := Item."Routing No.";

                                                                  "Scrap %" := Item."Scrap %";
                                                                  "Unit Cost" := Item."Unit Cost";
                                                                  "Indirect Cost %" := Item."Indirect Cost %";
                                                                  "Overhead Rate" := Item."Overhead Rate";
                                                                  IF "Item No." <> xRec."Item No." THEN BEGIN
                                                                    VALIDATE("Production BOM No.",Item."Production BOM No.");
                                                                    VALIDATE("Routing No.",Item."Routing No.");
                                                                    VALIDATE("Unit of Measure Code",Item."Base Unit of Measure");
                                                                  END;
                                                                  IF ProdOrder."Source Type" = ProdOrder."Source Type"::Family THEN
                                                                    "Routing Reference No." := 0
                                                                  ELSE
                                                                    IF "Line No." = 0 THEN
                                                                      "Routing Reference No." := -10000
                                                                    ELSE
                                                                      "Routing Reference No." := "Line No.";
                                                                END;
                                                                IF "Item No." <> xRec."Item No." THEN
                                                                  VALIDATE(Quantity);
                                                                GetUpdateFromSKU;

                                                                CreateDim(DATABASE::Item,"Item No.");
                                                                DimMgt.UpdateGlobalDimFromDimSetID("Dimension Set ID","Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
                                                              END;

                                                   CaptionML=[ENU=Item No.;
                                                              NOR=Varenr.] }
    { 12  ;   ;Variant Code        ;Code10        ;TableRelation="Item Variant".Code WHERE (Item No.=FIELD(Item No.),
                                                                                            Code=FIELD(Variant Code));
                                                   OnValidate=BEGIN
                                                                ReserveProdOrderLine.VerifyChange(Rec,xRec);
                                                                TESTFIELD("Finished Quantity",0);
                                                                CALCFIELDS("Reserved Quantity");
                                                                TESTFIELD("Reserved Quantity",0);
                                                                WhseValidateSourceLine.ProdOrderLineVerifyChange(Rec,xRec);

                                                                IF "Variant Code" = '' THEN BEGIN
                                                                  VALIDATE("Item No.");
                                                                  EXIT;
                                                                END;
                                                                ItemVariant.GET("Item No.","Variant Code");
                                                                Description := ItemVariant.Description;
                                                                "Description 2" := ItemVariant."Description 2";
                                                                GetUpdateFromSKU;
                                                                GetDefaultBin;
                                                              END;

                                                   CaptionML=[ENU=Variant Code;
                                                              NOR=Variantkode] }
    { 13  ;   ;Description         ;Text50        ;CaptionML=[ENU=Description;
                                                              NOR=Beskrivelse] }
    { 14  ;   ;Description 2       ;Text50        ;CaptionML=[ENU=Description 2;
                                                              NOR=Beskrivelse 2] }
    { 20  ;   ;Location Code       ;Code10        ;TableRelation=Location WHERE (Use As In-Transit=CONST(No));
                                                   OnValidate=BEGIN
                                                                ReserveProdOrderLine.VerifyChange(Rec,xRec);
                                                                WhseValidateSourceLine.ProdOrderLineVerifyChange(Rec,xRec);
                                                                GetUpdateFromSKU;
                                                                GetDefaultBin;
                                                              END;

                                                   CaptionML=[ENU=Location Code;
                                                              NOR=Lokasjonskode] }
    { 21  ;   ;Shortcut Dimension 1 Code;Code20   ;TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(1));
                                                   OnValidate=BEGIN
                                                                ValidateShortcutDimCode(1,"Shortcut Dimension 1 Code");
                                                              END;

                                                   CaptionML=[ENU=Shortcut Dimension 1 Code;
                                                              NOR=Snarveisdimensjon 1 - kode];
                                                   CaptionClass='1,2,1' }
    { 22  ;   ;Shortcut Dimension 2 Code;Code20   ;TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(2));
                                                   OnValidate=BEGIN
                                                                ValidateShortcutDimCode(2,"Shortcut Dimension 2 Code");
                                                              END;

                                                   CaptionML=[ENU=Shortcut Dimension 2 Code;
                                                              NOR=Snarveisdimensjon 2 - kode];
                                                   CaptionClass='1,2,2' }
    { 23  ;   ;Bin Code            ;Code20        ;TableRelation=IF (Quantity=FILTER(<0)) "Bin Content"."Bin Code" WHERE (Location Code=FIELD(Location Code),
                                                                                                                          Item No.=FIELD(Item No.),
                                                                                                                          Variant Code=FIELD(Variant Code))
                                                                                                                          ELSE Bin.Code WHERE (Location Code=FIELD(Location Code));
                                                   OnValidate=VAR
                                                                WMSManagement@1000 : Codeunit 7302;
                                                                WhseIntegrationMgt@1001 : Codeunit 7317;
                                                              BEGIN
                                                                IF "Bin Code" <> '' THEN BEGIN
                                                                  IF Quantity < 0 THEN
                                                                    WMSManagement.FindBinContent("Location Code","Bin Code","Item No.","Variant Code",'')
                                                                  ELSE
                                                                    WMSManagement.FindBin("Location Code","Bin Code",'');
                                                                  WhseIntegrationMgt.CheckBinTypeCode(DATABASE::"Prod. Order Line",
                                                                    FIELDCAPTION("Bin Code"),
                                                                    "Location Code",
                                                                    "Bin Code",0);
                                                                  CheckBin;
                                                                END;
                                                              END;

                                                   OnLookup=VAR
                                                              WMSManagement@1000 : Codeunit 7302;
                                                              BinCode@1001 : Code[20];
                                                            BEGIN
                                                              IF Quantity < 0 THEN
                                                                BinCode := WMSManagement.BinContentLookUp("Location Code","Item No.","Variant Code",'',"Bin Code")
                                                              ELSE
                                                                BinCode := WMSManagement.BinLookUp("Location Code","Item No.","Variant Code",'');

                                                              IF BinCode <> '' THEN
                                                                VALIDATE("Bin Code",BinCode);
                                                            END;

                                                   CaptionML=[ENU=Bin Code;
                                                              NOR=Hyllekode] }
    { 40  ;   ;Quantity            ;Decimal       ;OnValidate=BEGIN
                                                                "Quantity (Base)" := Quantity * "Qty. per Unit of Measure";
                                                                "Remaining Quantity" := Quantity - "Finished Quantity";
                                                                IF "Remaining Quantity" < 0 THEN
                                                                  "Remaining Quantity" := 0;
                                                                "Remaining Qty. (Base)" := "Remaining Quantity" * "Qty. per Unit of Measure";
                                                                ReserveProdOrderLine.VerifyQuantity(Rec,xRec);
                                                                WhseValidateSourceLine.ProdOrderLineVerifyChange(Rec,xRec);

                                                                UpdateProdOrderComp(xRec."Qty. per Unit of Measure");

                                                                IF CurrFieldNo <> 0 THEN
                                                                  VALIDATE("Ending Time");
                                                                "Cost Amount" := ROUND(Quantity * "Unit Cost");
                                                              END;

                                                   CaptionML=[ENU=Quantity;
                                                              NOR=Antall];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
    { 41  ;   ;Finished Quantity   ;Decimal       ;CaptionML=[ENU=Finished Quantity;
                                                              NOR=Ferdig antall];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0;
                                                   Editable=No }
    { 42  ;   ;Remaining Quantity  ;Decimal       ;CaptionML=[ENU=Remaining Quantity;
                                                              NOR=Restantall];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0;
                                                   Editable=No }
    { 45  ;   ;Scrap %             ;Decimal       ;CaptionML=[ENU=Scrap %;
                                                              NOR=Vrak-%];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
    { 47  ;   ;Due Date            ;Date          ;OnValidate=BEGIN
                                                                CheckEndingDate(CurrFieldNo <> 0);
                                                              END;

                                                   CaptionML=[ENU=Due Date;
                                                              NOR=Forfallsdato];
                                                   Editable=No }
    { 48  ;   ;Starting Date       ;Date          ;OnValidate=BEGIN
                                                                IF "Ending Date" < "Starting Date" THEN
                                                                  "Ending Date" := "Starting Date";

                                                                VALIDATE("Starting Time");
                                                              END;

                                                   CaptionML=[ENU=Starting Date;
                                                              NOR=Startdato] }
    { 49  ;   ;Starting Time       ;Time          ;OnValidate=BEGIN
                                                                IF ProdOrderLine.GET(Status,"Prod. Order No.","Line No.") THEN BEGIN
                                                                  MODIFY;

                                                                  CalcProdOrder.Recalculate(Rec,0,TRUE);

                                                                  GET(Status,"Prod. Order No.","Line No.");
                                                                END;
                                                                IF CurrFieldNo <> 0 THEN
                                                                  VALIDATE("Due Date");

                                                                UpdateDatetime;
                                                              END;

                                                   CaptionML=[ENU=Starting Time;
                                                              NOR=Starttidspunkt] }
    { 50  ;   ;Ending Date         ;Date          ;OnValidate=BEGIN
                                                                VALIDATE("Ending Time");
                                                              END;

                                                   CaptionML=[ENU=Ending Date;
                                                              NOR=Sluttdato] }
    { 51  ;   ;Ending Time         ;Time          ;OnValidate=BEGIN
                                                                IF ProdOrderLine.GET(Status,"Prod. Order No.","Line No.") THEN BEGIN
                                                                  MODIFY;

                                                                  CalcProdOrder.Recalculate(Rec,1,TRUE);

                                                                  GET(Status,"Prod. Order No.","Line No.");
                                                                END;
                                                                IF CurrFieldNo <> 0 THEN
                                                                  VALIDATE("Due Date");

                                                                UpdateDatetime;
                                                              END;

                                                   CaptionML=[ENU=Ending Time;
                                                              NOR=Sluttidspunkt] }
    { 52  ;   ;Planning Level Code ;Integer       ;CaptionML=[ENU=Planning Level Code;
                                                              NOR=Planl.niv† - kode];
                                                   Editable=No }
    { 53  ;   ;Priority            ;Integer       ;CaptionML=[ENU=Priority;
                                                              NOR=Prioritet] }
    { 60  ;   ;Production BOM No.  ;Code20        ;TableRelation="Production BOM Header".No.;
                                                   OnValidate=BEGIN
                                                                "Production BOM Version Code" := '';
                                                                IF "Production BOM No." = '' THEN
                                                                  EXIT;

                                                                VALIDATE("Production BOM Version Code",VersionMgt.GetBOMVersion("Production BOM No.","Due Date",TRUE));
                                                                IF "Production BOM Version Code" = '' THEN BEGIN
                                                                  ProdBOMHeader.GET("Production BOM No.");
                                                                  ProdBOMHeader.TESTFIELD(Status,ProdBOMHeader.Status::Certified);
                                                                  VALIDATE("Unit of Measure Code",ProdBOMHeader."Unit of Measure Code");
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Production BOM No.;
                                                              NOR=Produksjonsstykklistenr.] }
    { 61  ;   ;Routing No.         ;Code20        ;TableRelation="Routing Header".No.;
                                                   OnValidate=VAR
                                                                CapLedgEntry@1001 : Record 5832;
                                                                PurchLine@1000 : Record 39;
                                                              BEGIN
                                                                "Routing Version Code" := '';

                                                                IF "Routing No." <> xRec."Routing No." THEN BEGIN
                                                                  IF Status = Status::Released THEN BEGIN
                                                                    IF CheckCapLedgEntry THEN
                                                                      ERROR(
                                                                        Text99000004Err,
                                                                        FIELDCAPTION("Routing No."),xRec."Routing No.",CapLedgEntry.TABLECAPTION);

                                                                    IF CheckSubcontractPurchOrder THEN
                                                                      ERROR(
                                                                        Text99000004Err,
                                                                        FIELDCAPTION("Routing No."),xRec."Routing No.",PurchLine.TABLECAPTION);
                                                                  END;

                                                                  ProdOrderRtngLine.SETRANGE(Status,Status);
                                                                  ProdOrderRtngLine.SETRANGE("Prod. Order No.","Prod. Order No.");
                                                                  ProdOrderRtngLine.SETRANGE("Routing No.",xRec."Routing No.");
                                                                  ProdOrderRtngLine.SETRANGE("Routing Reference No.","Line No.");
                                                                  ProdOrderRtngLine.DELETEALL(TRUE);
                                                                END;
                                                                IF "Routing No." = '' THEN
                                                                  EXIT;

                                                                VALIDATE("Routing Version Code",VersionMgt.GetRtngVersion("Routing No.","Due Date",TRUE));
                                                                IF "Routing Version Code" = '' THEN BEGIN
                                                                  RtngHeader.GET("Routing No.");
                                                                  RtngHeader.TESTFIELD(Status,RtngHeader.Status::Certified);
                                                                  "Routing Type" := RtngHeader.Type;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Routing No.;
                                                              NOR=Rutenr.] }
    { 62  ;   ;Inventory Posting Group;Code10     ;TableRelation="Inventory Posting Group";
                                                   CaptionML=[ENU=Inventory Posting Group;
                                                              NOR=Bokf›ringsgruppe - lager] }
    { 63  ;   ;Routing Reference No.;Integer      ;CaptionML=[ENU=Routing Reference No.;
                                                              NOR=Rutereferansenr.];
                                                   Editable=No }
    { 65  ;   ;Unit Cost           ;Decimal       ;OnValidate=BEGIN
                                                                TESTFIELD("Item No.");
                                                                GetItem;
                                                                Item.TESTFIELD("Inventory Value Zero",FALSE);
                                                                IF Item."Costing Method" = Item."Costing Method"::Standard THEN BEGIN
                                                                  IF CurrFieldNo = FIELDNO("Unit Cost") THEN
                                                                    ERROR(
                                                                      Text99000002,
                                                                      FIELDCAPTION("Unit Cost"),Item.FIELDCAPTION("Costing Method"),Item."Costing Method");

                                                                  IF GetSKU THEN
                                                                    "Unit Cost" := SKU."Unit Cost" * "Qty. per Unit of Measure"
                                                                  ELSE
                                                                    "Unit Cost" := Item."Unit Cost" * "Qty. per Unit of Measure";
                                                                END;

                                                                "Cost Amount" := ROUND(Quantity * "Unit Cost");
                                                              END;

                                                   CaptionML=[ENU=Unit Cost;
                                                              NOR=Enhetskost];
                                                   AutoFormatType=2 }
    { 67  ;   ;Cost Amount         ;Decimal       ;CaptionML=[ENU=Cost Amount;
                                                              NOR=Kostbel›p];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 68  ;   ;Reserved Quantity   ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Reservation Entry".Quantity WHERE (Source ID=FIELD(Prod. Order No.),
                                                                                                       Source Ref. No.=CONST(0),
                                                                                                       Source Type=CONST(5406),
                                                                                                       Source Subtype=FIELD(Status),
                                                                                                       Source Batch Name=CONST(),
                                                                                                       Source Prod. Order Line=FIELD(Line No.),
                                                                                                       Reservation Status=CONST(Reservation)));
                                                   CaptionML=[ENU=Reserved Quantity;
                                                              NOR=Reservert antall];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 70  ;   ;Capacity Type Filter;Option        ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Capacity Type Filter;
                                                              NOR=Kapasitetstypefilter];
                                                   OptionCaptionML=[ENU=Work Center,Machine Center;
                                                                    NOR=Arbeidssenter,Maskinsenter];
                                                   OptionString=Work Center,Machine Center }
    { 71  ;   ;Capacity No. Filter ;Code20        ;FieldClass=FlowFilter;
                                                   TableRelation=IF (Capacity Type Filter=CONST(Work Center)) "Work Center"
                                                                 ELSE IF (Capacity Type Filter=CONST(Machine Center)) "Machine Center";
                                                   CaptionML=[ENU=Capacity No. Filter;
                                                              NOR=Kapasitetsnr.filter] }
    { 72  ;   ;Date Filter         ;Date          ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Date Filter;
                                                              NOR=Datofilter] }
    { 80  ;   ;Unit of Measure Code;Code10        ;TableRelation="Item Unit of Measure".Code WHERE (Item No.=FIELD(Item No.));
                                                   OnValidate=BEGIN
                                                                GetItem;
                                                                GetGLSetup;
                                                                WhseValidateSourceLine.ProdOrderLineVerifyChange(Rec,xRec);
                                                                "Unit Cost" := Item."Unit Cost";

                                                                "Qty. per Unit of Measure" := UOMMgt.GetQtyPerUnitOfMeasure(Item,"Unit of Measure Code");

                                                                "Unit Cost" :=
                                                                  ROUND(Item."Unit Cost" * "Qty. per Unit of Measure",
                                                                    GLSetup."Unit-Amount Rounding Precision");
                                                                "Overhead Rate" :=
                                                                  ROUND(
                                                                    Item."Overhead Rate" * "Qty. per Unit of Measure",
                                                                    GLSetup."Unit-Amount Rounding Precision");

                                                                VALIDATE(Quantity);
                                                              END;

                                                   CaptionML=[ENU=Unit of Measure Code;
                                                              NOR=Enhetskode] }
    { 81  ;   ;Quantity (Base)     ;Decimal       ;OnValidate=BEGIN
                                                                TESTFIELD("Qty. per Unit of Measure",1);
                                                                VALIDATE(Quantity,"Quantity (Base)");
                                                                "Remaining Quantity" := Quantity - "Finished Quantity";

                                                                VALIDATE("Ending Time");

                                                                "Cost Amount" := ROUND(Quantity * "Unit Cost");
                                                              END;

                                                   CaptionML=[ENU=Quantity (Base);
                                                              NOR=Antall (lagerenhet)];
                                                   DecimalPlaces=0:5 }
    { 82  ;   ;Finished Qty. (Base);Decimal       ;CaptionML=[ENU=Finished Qty. (Base);
                                                              NOR=Ferdig antall (lagerenhet)];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 83  ;   ;Remaining Qty. (Base);Decimal      ;CaptionML=[ENU=Remaining Qty. (Base);
                                                              NOR=Restlager (ant.)];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 84  ;   ;Reserved Qty. (Base);Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Reservation Entry"."Quantity (Base)" WHERE (Source ID=FIELD(Prod. Order No.),
                                                                                                                Source Ref. No.=CONST(0),
                                                                                                                Source Type=CONST(5406),
                                                                                                                Source Subtype=FIELD(Status),
                                                                                                                Source Batch Name=CONST(),
                                                                                                                Source Prod. Order Line=FIELD(Line No.),
                                                                                                                Reservation Status=CONST(Reservation)));
                                                   CaptionML=[ENU=Reserved Qty. (Base);
                                                              NOR=Reservert antall (lagerenhet)];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 90  ;   ;Expected Operation Cost Amt.;Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Prod. Order Routing Line"."Expected Operation Cost Amt." WHERE (Status=FIELD(Status),
                                                                                                                                    Prod. Order No.=FIELD(Prod. Order No.),
                                                                                                                                    Routing No.=FIELD(Routing No.),
                                                                                                                                    Routing Reference No.=FIELD(Routing Reference No.)));
                                                   CaptionML=[ENU=Expected Operation Cost Amt.;
                                                              NOR=Forventet operasjonskostbel›p];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 91  ;   ;Total Exp. Oper. Output (Qty.);Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Prod. Order Line".Quantity WHERE (Status=FIELD(Status),
                                                                                                      Prod. Order No.=FIELD(Prod. Order No.),
                                                                                                      Routing No.=FIELD(Routing No.),
                                                                                                      Routing Reference No.=FIELD(Routing Reference No.),
                                                                                                      Ending Date=FIELD(Date Filter)));
                                                   CaptionML=[ENU=Total Exp. Oper. Output (Qty.);
                                                              NOR=Total forv.oper.avgang (ant.)];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 94  ;   ;Expected Component Cost Amt.;Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Prod. Order Component"."Cost Amount" WHERE (Status=FIELD(Status),
                                                                                                                Prod. Order No.=FIELD(Prod. Order No.),
                                                                                                                Prod. Order Line No.=FIELD(Line No.),
                                                                                                                Due Date=FIELD(Date Filter)));
                                                   CaptionML=[ENU=Expected Component Cost Amt.;
                                                              NOR=Forventet komponentkostbel›p];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 198 ;   ;Starting Date-Time  ;DateTime      ;OnValidate=BEGIN
                                                                "Starting Date" := DT2DATE("Starting Date-Time");
                                                                "Starting Time" := DT2TIME("Starting Date-Time");
                                                                VALIDATE("Starting Time");
                                                              END;

                                                   CaptionML=[ENU=Starting Date-Time;
                                                              NOR=Startdato-tidsp.] }
    { 199 ;   ;Ending Date-Time    ;DateTime      ;OnValidate=BEGIN
                                                                "Ending Date" := DT2DATE("Ending Date-Time");
                                                                "Ending Time" := DT2TIME("Ending Date-Time");
                                                                VALIDATE("Ending Time");
                                                              END;

                                                   CaptionML=[ENU=Ending Date-Time;
                                                              NOR=Sluttdato-tidsp.] }
    { 480 ;   ;Dimension Set ID    ;Integer       ;TableRelation="Dimension Set Entry";
                                                   OnLookup=BEGIN
                                                              ShowDimensions;
                                                            END;

                                                   CaptionML=[ENU=Dimension Set ID;
                                                              NOR=Dimensjonssett-ID];
                                                   Editable=No }
    { 5831;   ;Cost Amount (ACY)   ;Decimal       ;CaptionML=[ENU=Cost Amount (ACY);
                                                              NOR=Kostbel›p (t.val)];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr=GetCurrencyCode }
    { 5832;   ;Unit Cost (ACY)     ;Decimal       ;CaptionML=[ENU=Unit Cost (ACY);
                                                              NOR=Enhetskost (t.val)];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr=GetCurrencyCode }
    { 73050;  ;Calculation No.     ;Code20        ;TableRelation="Item Calc. Header".No. WHERE (Item No.=FIELD(Item No.));
                                                   CaptionML=[ENU=Calculation No.;
                                                              NOR=Kalkylenr.] }
    { 99000750;;Production BOM Version Code;Code20;TableRelation="Production BOM Version"."Version Code" WHERE (Production BOM No.=FIELD(Production BOM No.));
                                                   OnValidate=BEGIN
                                                                IF "Production BOM Version Code" = '' THEN
                                                                  EXIT;

                                                                ProdBOMVersion.GET("Production BOM No.","Production BOM Version Code");
                                                                ProdBOMVersion.TESTFIELD(Status,ProdBOMVersion.Status::Certified);
                                                                VALIDATE("Unit of Measure Code",ProdBOMVersion."Unit of Measure Code");
                                                              END;

                                                   CaptionML=[ENU=Production BOM Version Code;
                                                              NOR=Prod.stykklisteversjon - kode] }
    { 99000751;;Routing Version Code;Code20       ;TableRelation="Routing Version"."Version Code" WHERE (Routing No.=FIELD(Routing No.));
                                                   OnValidate=BEGIN
                                                                IF "Routing Version Code" = '' THEN
                                                                  EXIT;

                                                                RtngVersion.GET("Routing No.","Routing Version Code");
                                                                RtngVersion.TESTFIELD(Status,RtngVersion.Status::Certified);
                                                                "Routing Type" := RtngVersion.Type;
                                                              END;

                                                   CaptionML=[ENU=Routing Version Code;
                                                              NOR=Ruteversjonskode] }
    { 99000752;;Routing Type       ;Option        ;CaptionML=[ENU=Routing Type;
                                                              NOR=Rutetype];
                                                   OptionCaptionML=[ENU=Serial,Parallel;
                                                                    NOR=Seriell,Parallell];
                                                   OptionString=Serial,Parallel }
    { 99000753;;Qty. per Unit of Measure;Decimal  ;CaptionML=[ENU=Qty. per Unit of Measure;
                                                              NOR=Antall per enhet];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 99000754;;MPS Order          ;Boolean       ;CaptionML=[ENU=MPS Order;
                                                              NOR=MPS-ordre] }
    { 99000755;;Planning Flexibility;Option       ;OnValidate=BEGIN
                                                                IF "Planning Flexibility" <> xRec."Planning Flexibility" THEN
                                                                  ReserveProdOrderLine.UpdatePlanningFlexibility(Rec);
                                                              END;

                                                   CaptionML=[ENU=Planning Flexibility;
                                                              NOR=Planleggingsfleksibilitet];
                                                   OptionCaptionML=[ENU=Unlimited,None;
                                                                    NOR=Ubegrenset,Ingen];
                                                   OptionString=Unlimited,None }
    { 99000764;;Indirect Cost %    ;Decimal       ;CaptionML=[ENU=Indirect Cost %;
                                                              NOR=Indirekte kost-%];
                                                   DecimalPlaces=0:5 }
    { 99000765;;Overhead Rate      ;Decimal       ;CaptionML=[ENU=Overhead Rate;
                                                              NOR=Sats for indirekte kostnader];
                                                   AutoFormatType=2 }
  }
  KEYS
  {
    {    ;Status,Prod. Order No.,Line No.         ;Clustered=Yes }
    {    ;Prod. Order No.,Line No.,Status          }
    {    ;Status,Item No.,Variant Code,Location Code,Ending Date;
                                                   SumIndexFields=Remaining Qty. (Base),Cost Amount }
    {    ;Status,Item No.,Variant Code,Location Code,Starting Date;
                                                   SumIndexFields=Remaining Qty. (Base);
                                                   MaintainSIFTIndex=No }
    {    ;Status,Item No.,Variant Code,Location Code,Due Date;
                                                   SumIndexFields=Remaining Qty. (Base);
                                                   MaintainSIFTIndex=No }
    { No ;Status,Item No.,Variant Code,Shortcut Dimension 1 Code,Shortcut Dimension 2 Code,Location Code,Due Date;
                                                   SumIndexFields=Remaining Qty. (Base);
                                                   MaintainSIFTIndex=No }
    {    ;Status,Prod. Order No.,Item No.          }
    {    ;Status,Prod. Order No.,Routing No.,Routing Reference No.;
                                                   SumIndexFields=Quantity,Finished Quantity;
                                                   MaintainSIFTIndex=No }
    {    ;Status,Prod. Order No.,Planning Level Code }
    { No ;Planning Level Code,Priority             }
    {    ;Item No.,Variant Code,Location Code,Status,Ending Date;
                                                   SumIndexFields=Remaining Qty. (Base);
                                                   MaintainSIFTIndex=No }
    {    ;Item No.,Variant Code,Location Code,Status,Due Date;
                                                   SumIndexFields=Remaining Qty. (Base);
                                                   MaintainSIFTIndex=No }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      Text000@1034 : TextConst 'ENU=A %1 %2 cannot be inserted, modified, or deleted.;NOR=%1 %2 kan ikke settes inn, endres eller slettes.';
      Text99000000@1000 : TextConst '@@@="%1 = Table Caption; %2 = Field Value; %3 = Table Caption";ENU=You cannot delete %1 %2 because there is at least one %3 associated with it.;NOR=Du kan ikke slette %1 %2 fordi det finnes minst ‚n %3 tilknyttet.';
      Text99000001@1001 : TextConst 'ENU=You cannot rename a %1.;NOR=Du kan ikke gi nytt navn til en %1.';
      Text99000002@1002 : TextConst 'ENU=You cannot change %1 when %2 is %3.;NOR=Du kan ikke endre %1 n†r %2 er %3.';
      Text99000004Err@1003 : TextConst '@@@="%1 = Field Caption; %2 = Field Value; %3 = Table Caption";ENU=You cannot modify %1 %2 because there is at least one %3 associated with it.;NOR=Du kan ikke endre %1 %2 fordi det finnes minst ‚n %3 tilknyttet.';
      Item@1004 : Record 27;
      SKU@1021 : Record 5700;
      ItemVariant@1005 : Record 5401;
      ReservEntry@1006 : Record 337;
      ProdBOMHeader@1007 : Record 99000771;
      ProdBOMVersion@1008 : Record 99000779;
      RtngHeader@1009 : Record 99000763;
      RtngVersion@1010 : Record 99000786;
      ProdOrder@1011 : Record 5405;
      ProdOrderLine@1012 : Record 5406;
      ProdOrderComp@1013 : Record 5407;
      ProdOrderRtngLine@1014 : Record 5409;
      GLSetup@1031 : Record 98;
      Location@1022 : Record 14;
      ReservEngineMgt@1016 : Codeunit 99000831;
      ReserveProdOrderLine@1017 : Codeunit 99000837;
      WhseValidateSourceLine@1030 : Codeunit 5777;
      UOMMgt@1018 : Codeunit 5402;
      VersionMgt@1019 : Codeunit 99000756;
      CalcProdOrder@1020 : Codeunit 99000773;
      DimMgt@1023 : Codeunit 408;
      Reservation@1026 : Page 498;
      Blocked@1032 : Boolean;
      GLSetupRead@1033 : Boolean;
      IgnoreErrors@1015 : Boolean;
      ErrorOccured@1024 : Boolean;
      CalledFromComponent@1025 : Boolean;

    PROCEDURE DeleteRelations@1();
    VAR
      WhseOutputProdRelease@1000 : Codeunit 7325;
    BEGIN
      ProdOrderLine.SETRANGE(Status,Status);
      ProdOrderLine.SETRANGE("Prod. Order No.","Prod. Order No.");
      ProdOrderLine.SETRANGE("Routing No.","Routing No.");
      ProdOrderLine.SETFILTER("Line No.",'<>%1',"Line No.");
      ProdOrderLine.SETRANGE("Routing Reference No.","Routing Reference No.");
      IF NOT ProdOrderLine.FINDFIRST THEN BEGIN
        ProdOrderRtngLine.SETRANGE(Status,Status);
        ProdOrderRtngLine.SETRANGE("Prod. Order No.","Prod. Order No.");
        ProdOrderRtngLine.SETRANGE("Routing No.","Routing No.");
        ProdOrderRtngLine.SETRANGE("Routing Reference No.","Routing Reference No.");
        IF ProdOrderRtngLine.FINDSET(TRUE) THEN
          REPEAT
            ProdOrderRtngLine.SetSkipUpdateOfCompBinCodes(TRUE);
            ProdOrderRtngLine.DELETE(TRUE);
          UNTIL ProdOrderRtngLine.NEXT = 0;
      END;

      ProdOrderComp.RESET;
      ProdOrderComp.SETRANGE(Status,Status);
      ProdOrderComp.SETRANGE("Prod. Order No.","Prod. Order No.");
      ProdOrderComp.SETRANGE("Prod. Order Line No.","Line No.");
      ProdOrderComp.DELETEALL(TRUE);

      IF NOT CalledFromComponent THEN BEGIN
        ProdOrderComp.SETRANGE("Prod. Order Line No.");
        ProdOrderComp.SETRANGE("Supplied-by Line No.","Line No.");
        IF ProdOrderComp.FIND('-') THEN
          REPEAT
            ProdOrderComp."Supplied-by Line No." := 0;
            ProdOrderComp."Planning Level Code" -= 1;
            ProdOrderComp.MODIFY;
          UNTIL ProdOrderComp.NEXT = 0;
      END;

      WhseOutputProdRelease.DeleteLine(Rec);
    END;

    PROCEDURE ShowReservation@8();
    BEGIN
      TESTFIELD("Item No.");
      CLEAR(Reservation);
      Reservation.SetProdOrderLine(Rec);
      Reservation.RUNMODAL;
    END;

    PROCEDURE ShowReservationEntries@21(Modal@1000 : Boolean);
    BEGIN
      TESTFIELD("Item No.");
      ReservEngineMgt.InitFilterAndSortingLookupFor(ReservEntry,TRUE);
      ReserveProdOrderLine.FilterReservFor(ReservEntry,Rec);
      IF Modal THEN
        PAGE.RUNMODAL(PAGE::"Reservation Entries",ReservEntry)
      ELSE
        PAGE.RUN(PAGE::"Reservation Entries",ReservEntry);
    END;

    PROCEDURE CheckEndingDate@4(ShowWarning@1000 : Boolean);
    VAR
      CheckDateConflict@1001 : Codeunit 99000815;
    BEGIN
      IF NOT Blocked THEN BEGIN
        CheckDateConflict.ProdOrderLineCheck(Rec,ShowWarning);
        ReserveProdOrderLine.AssignForPlanning(Rec);
      END;
    END;

    PROCEDURE BlockDynamicTracking@17(SetBlock@1000 : Boolean);
    BEGIN
      Blocked := SetBlock;
      ReserveProdOrderLine.Block(Blocked);
      CalcProdOrder.BlockDynamicTracking(Blocked);
    END;

    LOCAL PROCEDURE CreateDim@6(Type1@1000 : Integer;No1@1001 : Code[20]);
    VAR
      TableID@1002 : ARRAY [10] OF Integer;
      No@1003 : ARRAY [10] OF Code[20];
    BEGIN
      TableID[1] := Type1;
      No[1] := No1;
      "Shortcut Dimension 1 Code" := '';
      "Shortcut Dimension 2 Code" := '';
      "Dimension Set ID" :=
        DimMgt.GetDefaultDimID(
          TableID,No,'',"Shortcut Dimension 1 Code","Shortcut Dimension 2 Code",ProdOrder."Dimension Set ID",DATABASE::Item);
    END;

    PROCEDURE IsInbound@15() : Boolean;
    BEGIN
      EXIT("Quantity (Base)" > 0);
    END;

    PROCEDURE OpenItemTrackingLines@6500();
    BEGIN
      ReserveProdOrderLine.CallItemTracking(Rec);
    END;

    PROCEDURE ValidateShortcutDimCode@7(FieldNumber@1000 : Integer;VAR ShortcutDimCode@1001 : Code[20]);
    VAR
      OldDimSetID@1002 : Integer;
    BEGIN
      OldDimSetID := "Dimension Set ID";
      DimMgt.ValidateShortcutDimValues(FieldNumber,ShortcutDimCode,"Dimension Set ID");
      IF OldDimSetID <> "Dimension Set ID" THEN BEGIN
        MODIFY;
        IF ProdOrderCompExist THEN
          UpdateProdOrderCompDim("Dimension Set ID",OldDimSetID);
      END;
    END;

    PROCEDURE LookupShortcutDimCode@9(FieldNumber@1000 : Integer;VAR ShortcutDimCode@1001 : Code[20]);
    BEGIN
      DimMgt.LookupDimValueCode(FieldNumber,ShortcutDimCode);
      DimMgt.ValidateShortcutDimValues(FieldNumber,ShortcutDimCode,"Dimension Set ID");
    END;

    PROCEDURE ShowShortcutDimCode@10(VAR ShortcutDimCode@1000 : ARRAY [8] OF Code[20]);
    BEGIN
      DimMgt.GetShortcutDimensions("Dimension Set ID",ShortcutDimCode);
    END;

    LOCAL PROCEDURE GetItem@5();
    BEGIN
      IF Item."No." <> "Item No." THEN
        Item.GET("Item No.");
    END;

    LOCAL PROCEDURE GetSKU@5802() : Boolean;
    BEGIN
      IF (SKU."Location Code" = "Location Code") AND
         (SKU."Item No." = "Item No.") AND
         (SKU."Variant Code" = "Variant Code")
      THEN
        EXIT(TRUE);
      EXIT(SKU.GET("Location Code","Item No.","Variant Code"));
    END;

    LOCAL PROCEDURE GetUpdateFromSKU@12();
    BEGIN
      GetItem;
      IF GetSKU THEN
        "Unit Cost" := SKU."Unit Cost"
      ELSE
        "Unit Cost" := Item."Unit Cost";
    END;

    PROCEDURE UpdateDatetime@11();
    BEGIN
      IF ("Starting Date" <> 0D) AND ("Starting Time" <> 0T) THEN
        "Starting Date-Time" := CREATEDATETIME("Starting Date","Starting Time")
      ELSE
        "Starting Date-Time" := 0DT;

      IF ("Ending Date" <> 0D) AND ("Ending Time" <> 0T) THEN
        "Ending Date-Time" := CREATEDATETIME("Ending Date","Ending Time")
      ELSE
        "Ending Date-Time" := 0DT;
    END;

    PROCEDURE ShowDimensions@25();
    VAR
      OldDimSetID@1000 : Integer;
    BEGIN
      OldDimSetID := "Dimension Set ID";
      "Dimension Set ID" :=
        DimMgt.EditDimensionSet2(
          "Dimension Set ID",STRSUBSTNO('%1 %2 %3',Status,"Prod. Order No.","Line No."),
          "Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
      IF OldDimSetID <> "Dimension Set ID" THEN BEGIN
        MODIFY;
        IF ProdOrderCompExist THEN
          UpdateProdOrderCompDim("Dimension Set ID",OldDimSetID);
      END;
    END;

    LOCAL PROCEDURE GetGLSetup@14();
    BEGIN
      IF NOT GLSetupRead THEN
        GLSetup.GET;
      GLSetupRead := TRUE;
    END;

    LOCAL PROCEDURE GetCurrencyCode@13() : Code[10];
    BEGIN
      IF NOT GLSetupRead THEN BEGIN
        GLSetup.GET;
        GLSetupRead := TRUE;
      END;
      EXIT(GLSetup."Additional Reporting Currency");
    END;

    PROCEDURE RowID1@44() : Text[250];
    VAR
      ItemTrackingMgt@1000 : Codeunit 6500;
    BEGIN
      EXIT(
        ItemTrackingMgt.ComposeRowID(DATABASE::"Prod. Order Line",Status,
          "Prod. Order No.",'',"Line No.",0));
    END;

    LOCAL PROCEDURE GetLocation@7300(LocationCode@1000 : Code[10]);
    BEGIN
      IF LocationCode = '' THEN
        CLEAR(Location)
      ELSE
        IF Location.Code <> LocationCode THEN
          Location.GET(LocationCode);
    END;

    LOCAL PROCEDURE GetDefaultBin@50();
    VAR
      WMSManagement@1000 : Codeunit 7302;
    BEGIN
      IF (Quantity * xRec.Quantity > 0) AND
         ("Item No." = xRec."Item No.") AND
         ("Location Code" = xRec."Location Code") AND
         ("Variant Code" = xRec."Variant Code")
      THEN
        EXIT;

      "Bin Code" := '';
      IF ("Location Code" <> '') AND ("Item No." <> '') THEN BEGIN
        "Bin Code" := WMSManagement.GetLastOperationFromBinCode("Routing No.","Routing Version Code","Location Code",FALSE,0);
        GetLocation("Location Code");
        IF "Bin Code" = '' THEN
          "Bin Code" := Location.GetBinCode(FALSE,0);
        IF ("Bin Code" = '') AND Location."Bin Mandatory" AND NOT Location."Directed Put-away and Pick" THEN
          WMSManagement.GetDefaultBin("Item No.","Variant Code","Location Code","Bin Code");
      END;
      VALIDATE("Bin Code");
    END;

    LOCAL PROCEDURE CheckBin@3();
    VAR
      BinContent@1000 : Record 7302;
      Bin@1001 : Record 7354;
    BEGIN
      IF "Bin Code" <> '' THEN BEGIN
        GetLocation("Location Code");
        IF NOT Location."Directed Put-away and Pick" THEN
          EXIT;

        IF BinContent.GET(
             "Location Code","Bin Code",
             "Item No.","Variant Code","Unit of Measure Code")
        THEN BEGIN
          IF NOT BinContent.CheckWhseClass(IgnoreErrors) THEN
            ErrorOccured := TRUE;
        END ELSE BEGIN
          Bin.GET("Location Code","Bin Code");
          IF NOT Bin.CheckWhseClass("Item No.",IgnoreErrors) THEN
            ErrorOccured := TRUE;
        END;
      END;
      IF ErrorOccured THEN
        "Bin Code" := '';
    END;

    PROCEDURE FilterLinesWithItemToPlan@70(VAR Item@1000 : Record 27;IncludeFirmPlanned@1001 : Boolean);
    BEGIN
      RESET;
      SETCURRENTKEY("Item No.","Variant Code","Location Code",Status,"Due Date");
      IF IncludeFirmPlanned THEN
        SETRANGE(Status,Status::Planned,Status::Released)
      ELSE
        SETFILTER(Status,'%1|%2',Status::Planned,Status::Released);
      SETRANGE("Item No.",Item."No.");
      SETFILTER("Variant Code",Item.GETFILTER("Variant Filter"));
      SETFILTER("Location Code",Item.GETFILTER("Location Filter"));
      SETFILTER("Due Date",Item.GETFILTER("Date Filter"));
      SETFILTER("Shortcut Dimension 1 Code",Item.GETFILTER("Global Dimension 1 Filter"));
      SETFILTER("Shortcut Dimension 2 Code",Item.GETFILTER("Global Dimension 2 Filter"));
      SETFILTER("Remaining Qty. (Base)",'<>0');
    END;

    PROCEDURE FindLinesWithItemToPlan@68(VAR Item@1000 : Record 27;IncludeFirmPlanned@1001 : Boolean) : Boolean;
    BEGIN
      FilterLinesWithItemToPlan(Item,IncludeFirmPlanned);
      EXIT(FIND('-'));
    END;

    PROCEDURE LinesWithItemToPlanExist@67(VAR Item@1000 : Record 27;IncludeFirmPlanned@1001 : Boolean) : Boolean;
    BEGIN
      FilterLinesWithItemToPlan(Item,IncludeFirmPlanned);
      EXIT(NOT ISEMPTY);
    END;

    PROCEDURE SetIgnoreErrors@16();
    BEGIN
      IgnoreErrors := TRUE;
    END;

    PROCEDURE SetCalledFromComponent@2(NewCalledFromComponent@1000 : Boolean);
    BEGIN
      CalledFromComponent := NewCalledFromComponent;
    END;

    PROCEDURE HasErrorOccured@18() : Boolean;
    BEGIN
      EXIT(ErrorOccured);
    END;

    PROCEDURE UpdateProdOrderComp@19(QtyPerUnitOfMeasure@1000 : Decimal);
    VAR
      ProdOrderComp@1001 : Record 5407;
    BEGIN
      ProdOrderComp.SETRANGE(Status,Status);
      ProdOrderComp.SETRANGE("Prod. Order No.","Prod. Order No.");
      ProdOrderComp.SETRANGE("Prod. Order Line No.","Line No.");
      IF ProdOrderComp.FIND('-') THEN
        REPEAT
          IF QtyPerUnitOfMeasure <> 0 THEN
            ProdOrderComp.VALIDATE(
              "Quantity per",
              ProdOrderComp."Quantity per" * "Qty. per Unit of Measure" /
              QtyPerUnitOfMeasure)
          ELSE
            ProdOrderComp.VALIDATE("Quantity per","Qty. per Unit of Measure" );
          ProdOrderComp.MODIFY;
        UNTIL ProdOrderComp.NEXT = 0;
    END;

    LOCAL PROCEDURE CheckCapLedgEntry@1002() : Boolean;
    VAR
      CapLedgEntry@1001 : Record 5832;
    BEGIN
      CapLedgEntry.SETCURRENTKEY("Order Type","Order No.","Order Line No.");
      CapLedgEntry.SETRANGE("Order Type",CapLedgEntry."Order Type"::Production);
      CapLedgEntry.SETRANGE("Order No.","Prod. Order No.");
      CapLedgEntry.SETRANGE("Order Line No.","Line No.");

      EXIT(NOT CapLedgEntry.ISEMPTY);
    END;

    LOCAL PROCEDURE CheckSubcontractPurchOrder@1003() : Boolean;
    VAR
      PurchLine@1001 : Record 39;
    BEGIN
      PurchLine.SETCURRENTKEY(
        "Document Type",Type,"Prod. Order No.","Prod. Order Line No.","Routing No.","Operation No.");
      PurchLine.SETRANGE("Document Type",PurchLine."Document Type"::Order);
      PurchLine.SETRANGE(Type,PurchLine.Type::Item);
      PurchLine.SETRANGE("Prod. Order No.","Prod. Order No.");
      PurchLine.SETRANGE("Prod. Order Line No.","Line No.");

      EXIT(NOT PurchLine.ISEMPTY);
    END;

    LOCAL PROCEDURE ProdOrderCompExist@22() : Boolean;
    VAR
      ProdOrderComp@1000 : Record 5407;
    BEGIN
      ProdOrderComp.SETRANGE(Status,Status);
      ProdOrderComp.SETRANGE("Prod. Order No.","Prod. Order No.");
      ProdOrderComp.SETRANGE("Prod. Order Line No.","Line No.");
      EXIT(NOT ProdOrderComp.ISEMPTY);
    END;

    PROCEDURE UpdateProdOrderCompDim@26(NewDimSetID@1000 : Integer;OldDimSetID@1001 : Integer);
    VAR
      NewCompDimSetID@1002 : Integer;
    BEGIN
      IF NewDimSetID = OldDimSetID THEN
        EXIT;

      ProdOrderComp.RESET;
      ProdOrderComp.SETRANGE(Status,Status);
      ProdOrderComp.SETRANGE("Prod. Order No.","Prod. Order No.");
      ProdOrderComp.SETRANGE("Prod. Order Line No.","Line No.");
      ProdOrderComp.LOCKTABLE;
      IF ProdOrderComp.FINDSET THEN
        REPEAT
          NewCompDimSetID := DimMgt.GetDeltaDimSetID(ProdOrderComp."Dimension Set ID",NewDimSetID,OldDimSetID);
          IF ProdOrderComp."Dimension Set ID" <> NewCompDimSetID THEN BEGIN
            ProdOrderComp."Dimension Set ID" := NewCompDimSetID;
            DimMgt.UpdateGlobalDimFromDimSetID(
              ProdOrderComp."Dimension Set ID",ProdOrderComp."Shortcut Dimension 1 Code",ProdOrderComp."Shortcut Dimension 2 Code");
            ProdOrderComp.MODIFY;
          END;
        UNTIL ProdOrderComp.NEXT = 0;
    END;

    PROCEDURE ShowRouting@20();
    VAR
      ProdOrderRtngLine@1000 : Record 5409;
    BEGIN
      ProdOrderRtngLine.SETRANGE(Status,Status);
      ProdOrderRtngLine.SETRANGE("Prod. Order No.","Prod. Order No.");
      ProdOrderRtngLine.SETRANGE("Routing Reference No.","Routing Reference No.");
      ProdOrderRtngLine.SETRANGE("Routing No.","Routing No.");

      PAGE.RUNMODAL(PAGE::"Prod. Order Routing",ProdOrderRtngLine);
      CalcProdOrder.FindAndSetProdOrderLineBinCodeFromProdRtngLines(Status,"Prod. Order No.","Line No.");
    END;

    PROCEDURE SetFilterByReleasedOrderNo@27(OrderNo@1000 : Code[20]);
    BEGIN
      RESET;
      SETCURRENTKEY(Status,"Prod. Order No.","Line No.","Item No.");
      SETRANGE(Status,Status::Released);
      SETRANGE("Prod. Order No.",OrderNo);
    END;

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 05.09.17 JAL Item Calculation (Kalkyle)
                       New field "Calulation No."
    }
    END.
  }
}

OBJECT Table 73051 Item Calc. Header
{
  OBJECT-PROPERTIES
  {
    Date=08.09.17;
    Time=15.15.37;
    Modified=Yes;
    Version List=ICA2.01;
  }
  PROPERTIES
  {
    DataCaptionFields=No.,Item No.,Item Description,Calc. Date,Sales Price;
    OnInsert=VAR
               NoSeries@1101103000 : Record 308;
             BEGIN
               SelectNoSeriesAllowedG := FALSE;
               InventorySetupG.GET();
                IF "No." = '' THEN BEGIN
                 TestNoSeries;
                  NoSeries.GET(NoSeriesMgtG.GetNoSeriesWithCheck(InventorySetupG."Item Calculation Nos.", SelectNoSeriesAllowedG, "No. Series"));
                 IF (NOT NoSeries."Default Nos.") AND SelectNoSeriesAllowedG AND NoSeriesMgtG.IsSeriesSelected THEN
                   "No." := NoSeriesMgtG.GetNextNo(NoSeries.Code, "Calc. Date",TRUE)
                 ELSE
                   NoSeriesMgtG.InitSeries(NoSeries.Code,xRec."No. Series","Calc. Date","No.","No. Series");
                END;
               VALIDATE("Calc. Date", WORKDATE);
               VALIDATE("Calc. by", USERID);
             END;

    OnDelete=BEGIN
               CalcLinesG.RESET;
               CalcLinesG.SETRANGE("Calc. No.", "No.");
               IF CalcLinesG.FINDFIRST THEN
                 CalcLinesG.DELETEALL(TRUE);
             END;

    CaptionML=[ENU=Item Calc. Header;
               NOR=Kalkylehode];
    LookupPageID=Page73053;
    DrillDownPageID=Page73053;
  }
  FIELDS
  {
    { 1   ;   ;No.                 ;Code20        ;OnValidate=BEGIN
                                                                IF Rec."No." <> xRec."No." THEN
                                                                  ERROR(TXT01);
                                                              END;

                                                   CaptionML=[ENU=No.;
                                                              NOR=Kalkylenr.] }
    { 2   ;   ;Item No.            ;Code20        ;TableRelation=Item.No.;
                                                   OnValidate=VAR
                                                                ItemL@1101103000 : Record 27;
                                                              BEGIN
                                                                IF "Order Quantity" = 0 THEN
                                                                  ERROR(TXT02);

                                                                IF ItemL.GET("Item No.") THEN BEGIN
                                                                  "Item Description" := ItemL.Description;
                                                                  Calculate(Rec."Calc. Date");
                                                                END;

                                                                IsLocked();
                                                              END;

                                                   CaptionML=[ENU=Item No.;
                                                              NOR=Varenr.] }
    { 3   ;   ;Item Description    ;Text80        ;CaptionML=[ENU=Item Description;
                                                              NOR=Varebeskrivelse] }
    { 4   ;   ;Calc. Date          ;Date          ;OnValidate=BEGIN
                                                                IsLocked();
                                                              END;

                                                   CaptionML=[ENU=Calc. Date;
                                                              NOR=Kalkyledato] }
    { 5   ;   ;Calc. by            ;Code50        ;OnValidate=BEGIN
                                                                IsLocked();
                                                              END;

                                                   CaptionML=[ENU=Calc. By;
                                                              NOR=Kalkulert av] }
    { 6   ;   ;Tot. Material Cost  ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Item Calc. Line"."Line Amount" WHERE (Type=CONST(Material),
                                                                                                          Calc. No.=FIELD(No.)));
                                                   OnValidate=BEGIN
                                                                IsLocked();
                                                              END;

                                                   CaptionML=[ENU=Tot. Material Cost;
                                                              NOR=Tot. materialkost] }
    { 7   ;   ;Tot. Capacity Cost  ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Item Calc. Line"."Line Amount" WHERE (Type=CONST(Capacity),
                                                                                                          Calc. No.=FIELD(No.)));
                                                   OnValidate=BEGIN
                                                                IsLocked();
                                                              END;

                                                   CaptionML=[ENU=Tot. Capacity Cost;
                                                              NOR=Tot. arbeidskost] }
    { 8   ;   ;Tot. Additional Cost;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Item Calc. Line"."Line Amount" WHERE (Type=CONST(Additional),
                                                                                                          Calc. No.=FIELD(No.)));
                                                   OnValidate=BEGIN
                                                                IsLocked();
                                                              END;

                                                   CaptionML=[ENU=Tot. Additional Cost;
                                                              NOR=Tot. tilleggskost] }
    { 9   ;   ;Sales Price         ;Decimal       ;OnValidate=BEGIN
                                                                IsLocked();

                                                                IF "Sales Price" <> 0 THEN BEGIN
                                                                  CALCFIELDS("Tot. Cost");
                                                                  "Calc. Factor" := ("Sales Price")/("Tot. Cost");
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Sales Price;
                                                              NOR=Salgspris] }
    { 10  ;   ;Calc. Factor        ;Decimal       ;OnValidate=BEGIN
                                                                IsLocked();

                                                                IF "Calc. Factor" <> 0 THEN BEGIN
                                                                  CALCFIELDS("Tot. Cost");
                                                                  "Sales Price" := ROUND(("Tot. Cost" * ("Calc. Factor")),0.01);
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Calc. Factor;
                                                              NOR=Kalkylefaktor] }
    { 11  ;   ;Tot. Cost           ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Item Calc. Line"."Line Amount" WHERE (Calc. No.=FIELD(No.)));
                                                   OnValidate=BEGIN
                                                                IsLocked();
                                                              END;

                                                   CaptionML=[ENU=Tot. Cost;
                                                              NOR=Tot. kost] }
    { 50  ;   ;Lot Size (No. of PCS);Text15       ;OnValidate=BEGIN
                                                                IsLocked();
                                                              END;

                                                   CaptionML=[ENU=Lot Size (No. of PCS);
                                                              NOR=Seriest›rrelse(antall stk)] }
    { 51  ;   ;Calculation Method  ;Option        ;OnValidate=BEGIN
                                                                IsLocked();

                                                                IF "Calculation Method" = 0 THEN BEGIN    // Salgspris = Kost * kalkylefaktor
                                                                  IF "Calc. Factor" <> 0 THEN BEGIN
                                                                    CALCFIELDS("Tot. Cost");
                                                                    "Sales Price" :=
                                                                    ROUND(("Tot. Cost" * "Calc. Factor"),0.01);
                                                                  END;
                                                                END;
                                                                IF "Calculation Method" = 1 THEN BEGIN      // Kalkylefaktor = Salgspris/Kost
                                                                  IF "Sales Price" <> 0 THEN BEGIN
                                                                    CALCFIELDS("Tot. Cost");
                                                                    "Calc. Factor" :=
                                                                    ("Sales Price"/"Tot. Cost");
                                                                  END;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Calculation Method;
                                                              NOR=Kalkylemetode];
                                                   OptionCaptionML=[ENU="Sales Price = Cost + CalcFactor,CalcFactor = SalesPrice - Cost";
                                                                    NOR="Salgspris = Kost + Kalkylefaktor,Kalkylefaktor = Salgspris - Kost"];
                                                   OptionString=Sales Price = Cost + CalcFactor,CalcFactor = SalesPrice - Cost }
    { 60  ;   ;Order Quantity      ;Integer       ;InitValue=0;
                                                   CaptionML=[ENU=Order Quantity;
                                                              NOR=Ordreantall];
                                                   MinValue=0;
                                                   MaxValue=200 }
    { 70  ;   ;Locked              ;Boolean       ;CaptionML=[ENU=Locked;
                                                              NOR=L†st] }
    { 71  ;   ;Project Code        ;Code20        ;CaptionML=[ENU=Project Code;
                                                              NOR=Prosjekt] }
    { 80  ;   ;Variant Code        ;Code10        ;TableRelation="Item Variant".Code;
                                                   CaptionML=[ENU=Variant Code;
                                                              NOR=Variant] }
    { 107 ;   ;No. Series          ;Code10        ;TableRelation="No. Series";
                                                   CaptionML=[ENU=No. Series;
                                                              NOR=Nr.serie];
                                                   Editable=No }
  }
  KEYS
  {
    {    ;No.                                     ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      InventorySetupG@1101103012 : Record 313;
      NoSeriesMgtG@1101103011 : Codeunit 396;
      CalcLinesG@1101103005 : Record 73052;
      SelgerG@1101103000 : Record 13;
      TXT01@1101103013 : TextConst 'ENU=You cannot change the Calc. No.;NOR=Du kan ikke endre kalkylenummer.';
      TXT02@1101103014 : TextConst 'ENU=You must enter a Order Quantity before you enter the Item No.;NOR=Du m† angi et Ordreantall f›r du legger til Varenr.';
      TXT03@1101103015 : TextConst 'ENU=You cannot change Price Calculation which is locked.;NOR="Du kan ikke endre en kalkyle som er l†st = Ja."';
      SelectNoSeriesAllowedG@1101103001 : Boolean;

    PROCEDURE Calculate@1000000000(VAR CalcDate@1000000003 : Date);
    VAR
      CalcLinesL@1101103000 : Record 73052;
      BOMHeaderL@1101103002 : Record 99000771;
      BOMLineL@1101103001 : Record 99000772;
      ItemL@1101103006 : Record 27;
      Item2L@1101103007 : Record 27;
      RoutingHeaderL@1101103005 : Record 99000763;
      RoutingLineL@1101103004 : Record 99000764;
      WorkCenterL@1101103003 : Record 99000754;
      MaterialLineNoL@1000000001 : Integer;
      ProductionLineNoL@1000000002 : Integer;
      NewRoutingNoL@1000000006 : Code[20];
    BEGIN
      IsLocked();
      ItemL.GET(Rec."Item No.");
      // Sletter gamle kalkyle Hvis den finnes fra f›r
      CalcLinesL.RESET;
      CalcLinesL.SETRANGE("Calc. No.", "No.");
      CalcLinesL.SETRANGE("System Created", TRUE);
      IF CalcLinesL.FINDFIRST THEN
        CalcLinesL.DELETEALL(TRUE);

      // Starter ny kalkyle
      CalcLinesL.RESET;
      CalcLinesL.SETRANGE("Calc. No.", "No.");
      CalcLinesL.SETRANGE(Type, CalcLinesL.Type::Material);
      IF CalcLinesL.FINDLAST THEN
        MaterialLineNoL := CalcLinesL."Sequence No.";
      CalcLinesL.RESET;
      CalcLinesL.SETRANGE("Calc. No.", "No.");
      CalcLinesL.SETRANGE(Type, CalcLinesL.Type::Capacity);
      IF CalcLinesL.FINDLAST THEN
        ProductionLineNoL := CalcLinesL."Sequence No.";

      CalcDate := WORKDATE;
      BOMHeaderL.RESET;
      BOMHeaderL.SETRANGE("No.", ItemL."Production BOM No.");      //finner stk.liste fra varekortet
      IF BOMHeaderL.FINDFIRST THEN BEGIN
        BOMHeaderL.TESTFIELD(Status);
        BOMLineL.RESET;
        BOMLineL.SETRANGE("Production BOM No.",BOMHeaderL."No.");
        IF BOMLineL.FINDFIRST THEN
        REPEAT
          MaterialLineNoL := MaterialLineNoL + 10;
          CalcLinesL.INIT;
          CalcLinesL."Calc. No." := "No.";
          CalcLinesL.Type := CalcLinesL.Type::Material;
          CalcLinesL."Sequence No." := MaterialLineNoL;
          IF Item2L.GET(BOMLineL."No.") THEN BEGIN
            CalcLinesL.VALIDATE("No.", Item2L."No.");
            CalcLinesL.VALIDATE(Description, Item2L.Description);
            CalcLinesL.VALIDATE(Quantity, BOMLineL."Quantity per");
            CalcLinesL.VALIDATE("Unit of Measure", BOMLineL."Unit of Measure Code");
            CalcLinesL.VALIDATE("Unit Cost", Item2L."Unit Cost");
            CalcLinesL."Vendor No." := Item2L."Vendor No.";
          END;
          CalcLinesL."Line Amount" := CalcLinesL.Quantity * CalcLinesL."Unit Cost";
          CalcLinesL."System Created" := TRUE;
          CalcLinesL.INSERT(TRUE);
        UNTIL BOMLineL.NEXT=0;
      END;

      NewRoutingNoL := '';

      IF NewRoutingNoL = '' THEN
        NewRoutingNoL := ItemL."Routing No.";
      RoutingHeaderL.RESET;
      RoutingHeaderL.SETRANGE("No.", NewRoutingNoL);    //f›r:Item."Routing No."
      IF RoutingHeaderL.FINDFIRST THEN BEGIN
        RoutingHeaderL.TESTFIELD(Status);
        RoutingLineL.RESET;
        RoutingLineL.SETRANGE("Routing No.", NewRoutingNoL);  //f›r:Item."Routing No."
        IF RoutingLineL.FINDFIRST THEN
        REPEAT
          ProductionLineNoL := ProductionLineNoL + 10;
          IF WorkCenterL.GET(RoutingLineL."No.") THEN BEGIN
            CalcLinesL.INIT;
            CalcLinesL.VALIDATE("Calc. No.", "No.");
            CalcLinesL.VALIDATE(Type, CalcLinesL.Type::Capacity);
            CalcLinesL.VALIDATE("Sequence No.", ProductionLineNoL);
            CalcLinesL.VALIDATE("No.", RoutingLineL."Operation No.");
            CalcLinesL.VALIDATE(Description, RoutingLineL.Description);
            CalcLinesL."Work Center" := RoutingLineL."No.";
            IF WorkCenterL."Specific Unit Cost" THEN BEGIN
              CalcLinesL.VALIDATE(Quantity, 1);
              CalcLinesL.VALIDATE("Unit of Measure", ItemL."Base Unit of Measure");
              CalcLinesL.VALIDATE("Unit Cost", RoutingLineL."Unit Cost per");
              CalcLinesL.VALIDATE("Vendor No.", WorkCenterL."Subcontractor No.");
            END ELSE BEGIN
              CalcLinesL.VALIDATE(Quantity, RoutingLineL."Run Time");
              CalcLinesL.VALIDATE("Unit of Measure", RoutingLineL."Run Time Unit of Meas. Code");
              CalcLinesL.VALIDATE("Unit Cost", WorkCenterL."Unit Cost");
            END;
            CalcLinesL."Line Amount" := CalcLinesL.Quantity * CalcLinesL."Unit Cost";
            CalcLinesL."System Created" := TRUE;
            CalcLinesL.INSERT(TRUE);
          END;
        UNTIL RoutingLineL.NEXT=0;
      END;
      CLEAR(CalcLinesL);
      IF NOT CalcLinesL.GET("No.",CalcLinesL.Type::Additional,10) THEN BEGIN
        CalcLinesL.INIT;
        CalcLinesL."Calc. No." := "No.";
        CalcLinesL.Type      := CalcLinesL.Type::Additional;
        CalcLinesL."Sequence No." := 10;
        CalcLinesL.INSERT(TRUE);
      END;
      IF "Calculation Method" = 0 THEN BEGIN          // Salgspris = Kost * kalkylefaktor
        IF "Calc. Factor" <> 0 THEN BEGIN
          CALCFIELDS("Tot. Cost");
          "Sales Price" := ROUND(("Tot. Cost")*("Calc. Factor"),0.01);
        END;
      END;
      IF "Calculation Method" = 1 THEN BEGIN          // Kalkylefaktor = Salgspris/Kost
        IF "Sales Price" <> 0 THEN BEGIN
          CALCFIELDS("Tot. Cost");
          "Calc. Factor" := ("Sales Price")/("Tot. Cost");
        END;
      END;
    END;

    PROCEDURE CopyCalculation@1000000001("NewCalcNo."@1000000000 : Code[20];FromCalcNo@1000000001 : Code[20]);
    VAR
      CalcLinesL@1101103000 : Record 73052;
      FromCalcHeaderL@1101103002 : Record 73051;
      FromCalcLineL@1101103001 : Record 73052;
    BEGIN
      IF FromCalcHeaderL.GET(FromCalcNo) THEN BEGIN
        "Item No." := FromCalcHeaderL."Item No.";
        "Item Description" := FromCalcHeaderL."Item Description";
        "Calc. Date" := FromCalcHeaderL."Calc. Date";
        "Calc. by" := FromCalcHeaderL."Calc. by";
        "Calculation Method" := FromCalcHeaderL."Calculation Method";
        "Sales Price" := FromCalcHeaderL."Sales Price";
        "Calc. Factor" := FromCalcHeaderL."Calc. Factor";
        "Lot Size (No. of PCS)" := FromCalcHeaderL."Lot Size (No. of PCS)";
        Rec.MODIFY;
        FromCalcLineL.RESET;
        FromCalcLineL.SETRANGE("Calc. No.", FromCalcHeaderL."No.");
        IF FromCalcLineL.FINDFIRST THEN
        REPEAT
          CalcLinesL.INIT;
          CalcLinesL."Calc. No." := "NewCalcNo.";
          CalcLinesL.Type  := FromCalcLineL.Type;
          CalcLinesL."Sequence No." := FromCalcLineL."Sequence No.";
          CalcLinesL."No." := FromCalcLineL."No.";
          CalcLinesL.Description := FromCalcLineL.Description;
          CalcLinesL.Quantity := FromCalcLineL.Quantity;
          CalcLinesL."Unit of Measure" :=FromCalcLineL."Unit of Measure";
          CalcLinesL."Unit Cost" := FromCalcLineL."Unit Cost";
          CalcLinesL."Line Amount" := FromCalcLineL."Line Amount";
          CalcLinesL."Vendor No." := FromCalcLineL."Vendor No.";
          CalcLinesL."System Created" := FromCalcLineL."System Created";
          CalcLinesL.INSERT;
        UNTIL FromCalcLineL.NEXT=0;
      END;
    END;

    PROCEDURE UpdateCalulation@1000000002();
    VAR
      CalcLinesL@1000000000 : Record 73052;
      TotalCostL@1101103000 : Decimal;
    BEGIN
      IsLocked();

      TotalCostL := 0;
      CalcLinesL.RESET;
      CalcLinesL.SETRANGE("Calc. No.", "No.");
      IF CalcLinesL.FINDFIRST THEN
      REPEAT
        TotalCostL := TotalCostL + CalcLinesL."Line Amount";
      UNTIL CalcLinesL.NEXT=0;
      IF "Calculation Method" = 0 THEN BEGIN               // Salgspris = Kost * kalkylefaktor
        IF "Calc. Factor" <> 0 THEN BEGIN
          "Sales Price" := ROUND(TotalCostL * ("Calc. Factor"),0.01);
        END;
      END;
      IF "Calculation Method" = 1 THEN BEGIN              // Kalkylefaktor = Salgspris - Kost
        IF "Sales Price" <> 0 THEN BEGIN
          "Calc. Factor" := ("Sales Price" / TotalCostL);
        END;
      END;
      Rec.MODIFY;
    END;

    PROCEDURE IsLocked@1101103000();
    BEGIN
      IF Locked THEN
        ERROR(TXT03);
    END;

    LOCAL PROCEDURE TestNoSeries@6();
    VAR
      InventorySetupG@1101103000 : Record 313;
    BEGIN
      InventorySetupG.GET;
      InventorySetupG.TESTFIELD("Item Calculation Nos.");
    END;

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 01.09.17 JAL Item Calculation (Kalkyle)
    }
    END.
  }
}

OBJECT Table 73052 Item Calc. Line
{
  OBJECT-PROPERTIES
  {
    Date=08.09.17;
    Time=15.09.43;
    Modified=Yes;
    Version List=ICA2.01;
  }
  PROPERTIES
  {
    OnInsert=BEGIN
               IF CalcHeaderG.GET("Calc. No.") THEN
                 CalcHeaderG.IsLocked();
             END;

    CaptionML=[ENU=Item Calc. Line;
               NOR=Kalkylelinjer];
  }
  FIELDS
  {
    { 1   ;   ;Calc. No.           ;Code20        ;CaptionML=[ENU=Calc. No.;
                                                              NOR=Kalkyle nr.] }
    { 2   ;   ;Type                ;Option        ;CaptionML=[ENU=Type;
                                                              NOR=Type];
                                                   OptionCaptionML=[ENU=" ,Material,Capacity,Additional";
                                                                    NOR=" ,Material,Rutelinjer,Diverse"];
                                                   OptionString=[ ,Material,Capacity,Additional] }
    { 3   ;   ;Sequence No.        ;Integer       ;CaptionML=[ENU=Sequence No.;
                                                              NOR=Sekvens nr.] }
    { 4   ;   ;No.                 ;Code20        ;TableRelation=IF (Type=CONST(Material)) Item.No.;
                                                   OnValidate=BEGIN
                                                                IF Type = Type::Material THEN
                                                                  IF ItemG.GET("No.") THEN BEGIN
                                                                    Description := ItemG.Description;
                                                                    "Vendor No." := ItemG."Vendor No.";
                                                                    "Unit of Measure" := ItemG."Base Unit of Measure";
                                                                    "Unit Cost" := ItemG."Unit Cost";
                                                                  END;
                                                              END;

                                                   CaptionML=[ENU=No.;
                                                              NOR=Nr.] }
    { 5   ;   ;Description         ;Text50        ;CaptionML=[ENU=Description;
                                                              NOR=Beskrivelse] }
    { 6   ;   ;Quantity            ;Decimal       ;OnValidate=BEGIN
                                                                ReCalculate();
                                                              END;

                                                   CaptionML=[ENU=Quantity;
                                                              NOR=Antall] }
    { 7   ;   ;Unit of Measure     ;Code20        ;CaptionML=[ENU=Unit of Measure;
                                                              NOR=Enhetskode] }
    { 8   ;   ;Unit Cost           ;Decimal       ;OnValidate=BEGIN
                                                                ReCalculate();
                                                              END;

                                                   CaptionML=[ENU=Unit Cost;
                                                              NOR=Enhetskost] }
    { 9   ;   ;Line Amount         ;Decimal       ;CaptionML=[ENU=Line Amount;
                                                              NOR=Linje Bel›p] }
    { 71  ;   ;Project Code        ;Code20        ;CaptionML=[ENU=Project Code;
                                                              NOR=Prosjektkode] }
    { 80  ;   ;Variant Code        ;Code10        ;TableRelation="Item Variant".Code WHERE (Item No.=FIELD(No.));
                                                   CaptionML=[ENU=Variant code;
                                                              NOR=Variant] }
    { 100 ;   ;Vendor No.          ;Code20        ;TableRelation=Vendor;
                                                   CaptionML=[ENU=Vendor No.;
                                                              NOR=Leverand›r Nr.] }
    { 101 ;   ;System Created      ;Boolean       ;CaptionML=[ENU=System Created;
                                                              NOR=System opprettet] }
    { 102 ;   ;Work Center         ;Code20        ;TableRelation="Work Center".No.;
                                                   OnValidate=BEGIN
                                                                 CLEAR(WorkCenter);
                                                                   IF WorkCenter.GET("Work Center") THEN BEGIN
                                                                     Description := WorkCenter.Name;
                                                                     "Unit of Measure" := WorkCenter."Unit of Measure Code";
                                                                     "Unit Cost" := WorkCenter."Unit Cost";
                                                                   END;
                                                              END;

                                                   CaptionML=[ENU=Work Center;
                                                              NOR=Arbeidssenter] }
    { 103 ;   ;Activity Type       ;Option        ;CaptionML=[ENU=Activity Type;
                                                              NOR=Aktivitetstype];
                                                   OptionString=[ ,Maskinering,Ultralyd,MPI/ MT,LPI/ PT,PMI,PTFE Coating,Pickling] }
    { 5000;   ;Purchase Status     ;Option        ;OnValidate=BEGIN
                                                                IF xRec."Purchase Status" > "Purchase Status"::"Req. to purch.dpt" THEN
                                                                  ERROR(TEXT50001);

                                                                IF xRec."Purchase Status" <> "Purchase Status" THEN
                                                                  IF "Purchase Status" = "Purchase Status"::"Req. to purch.dpt" THEN
                                                                    SendNotification(Rec);
                                                              END;

                                                   CaptionML=[ENU=Purchase Status;
                                                              NOR=Bestillingsstatus];
                                                   OptionCaptionML=[ENU=Inventory,Req. to purch.dpt,Req. created,Req. confirmed;
                                                                    NOR=Tas fra lager,Foresp›r innkj.avd.,Foresp›rsel opprettet,Foresp›rsel besvart];
                                                   OptionString=Inventory,Req. to purch.dpt,Req. created,Req. confirmed }
    { 5001;   ;Purchase Document No.;Code20       ;TableRelation="Purchase Header".No.;
                                                   CaptionML=[ENU=Purchase Document No.;
                                                              NOR=Bestillingsdokumentnr.] }
    { 5002;   ;Purchase Line No.   ;Integer       ;CaptionML=[ENU=Purchase Line No.;
                                                              NOR=Bestillingslinjenr.] }
    { 5003;   ;Purchase Price      ;Decimal       ;CaptionML=[ENU=Purchase Price;
                                                              NOR=Bestillingspris] }
  }
  KEYS
  {
    {    ;Calc. No.,Type,Sequence No.             ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      CalcHeaderG@1101103005 : Record 73051;
      ItemG@1101103004 : Record 27;
      TotalCost@1101103003 : Decimal;
      WorkCenter@1101103002 : Record 99000754;
      KalkHode@1101103001 : Record 73051;
      Ordersize@1101103000 : Text[10];
      Text001@1101103007 : TextConst 'ENU=New cost is %1;NOR="Ny kost er "';
      TEXT50001@1101103006 : TextConst 'ENU=You can not change from this status.;NOR=Du kan ikke endre etter fra gjeldene status.';

    LOCAL PROCEDURE ReCalculate@1101103001();
    BEGIN
      "Line Amount" := Quantity * "Unit Cost";
      UpdateCalulation("Line Amount" - xRec."Line Amount");
    END;

    PROCEDURE UpdateCalulation@1000000002(NetChangeP@1000000001 : Decimal);
    VAR
      CalcLinesL@1000000000 : Record 73052;
    BEGIN
      IF CalcHeaderG.GET("Calc. No.") THEN BEGIN
        CalcHeaderG.IsLocked();

        TotalCost := 0;
        CalcLinesL.RESET;
        CalcLinesL.SETRANGE("Calc. No.", "Calc. No.");
        IF CalcLinesL.FINDFIRST THEN
        REPEAT
          TotalCost := TotalCost + CalcLinesL."Line Amount";
        UNTIL CalcLinesL.NEXT = 0;
        TotalCost := TotalCost + NetChangeP;

        //MESSAGE(Text001,TotalCost);   //10.01.12 skrevet om til Text Constant grunnet VUS-demo
        IF CalcHeaderG."Calculation Method" = 0 THEN BEGIN    // Salgspris = Kost * kalkylefaktor
          IF CalcHeaderG."Calc. Factor" <> 0 THEN BEGIN
            CalcHeaderG."Sales Price" := ROUND((TotalCost * CalcHeaderG."Calc. Factor"),0.01);
          END;
        END;
        IF CalcHeaderG."Calculation Method" = 1 THEN BEGIN    // Kalkylefaktor= Salgspris/Kost
          IF CalcHeaderG."Sales Price" <> 0 THEN BEGIN
            CalcHeaderG."Calc. Factor" := (CalcHeaderG."Sales Price" / TotalCost);
          END;
        END;
        CalcHeaderG.MODIFY;
      END;
    END;

    PROCEDURE SendNotification@1101103000(CalcLine@1000000000 : Record 73052);
    VAR
      SMTPMail@1000000002 : Codeunit 400;
      Emne@1000000003 : Text[100];
      Beskrivelse@1000000004 : Text[100];
      SMTPSetup@1000000005 : Record 409;
      salesperson@1000000006 : Record 13;
      VarselSendtAv@1000000007 : Text[100];
      Beskrivelse2@1000000008 : Text[100];
      Beskrivelse3@1000000009 : Text[100];
      Calculation@1101103000 : Record 73051;
      TilbudtPris@1101103001 : Text[30];
      VarselSendtAvEpost@1101103002 : Text[100];
      Ordreant@1101103003 : Text[5];
    BEGIN
      //SMTPMail.CreateMessage(SenderName,SenderAddress,Recipients,Subject,Body,HtmlFormatted)
      //HHE 08.02.17 MTPSetup.GET;
      //hhe 21.11.12->
      KalkHode.GET("Calc. No.");
      Ordersize:= FORMAT(KalkHode."Order Quantity");
      //hhe 21.11.12<-
      IF salesperson.GET(USERID) THEN BEGIN
        VarselSendtAv       := salesperson.Name;
        VarselSendtAvEpost :=  salesperson."E-Mail";
      END ELSE BEGIN
        VarselSendtAv := USERID;
      END;

      SMTPMail.CreateMessage
        (VarselSendtAv,
        VarselSendtAvEpost,'Purchasing.VNO@vectortg.com',  "Calc. No."+ ' '+
        'Foresp›rsel om pris p† ' +Ordersize+ ' ',"No."+' '+Description,TRUE);
        SMTPMail.Send;

      MESSAGE('Varsel er sendt ut p† e-post til innkj›per.');
    END;

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 01.09.17 JAL Item Calculation (Kalkyle)
    }
    END.
  }
}

OBJECT Table 73053 Project Account
{
  OBJECT-PROPERTIES
  {
    Date=01.09.17;
    Time=16.25.53;
    Modified=Yes;
    Version List=ICA2.01;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Project Account;
               NOR=Prosjektkonto];
  }
  FIELDS
  {
    { 1   ;   ;Project No.         ;Code20        ;CaptionML=[ENU=Project No.;
                                                              NOR=Prosjektnr.] }
    { 2   ;   ;Project Name        ;Text50        ;OnValidate=BEGIN
                                                                  CLEAR(DimensionValueG);
                                                                  IF DimensionValueG.GET('Prosjekt',"Project No.") THEN BEGIN
                                                                    DimensionValueG.Name := Rec."Project Name";
                                                                    DimensionValueG.MODIFY;
                                                                  END;
                                                              END;

                                                   CaptionML=[ENU=Project name;
                                                              NOR=Prosjektnavn] }
    { 3   ;   ;Project Manager     ;Code10        ;TableRelation=Salesperson/Purchaser.Code;
                                                   CaptionML=[ENU=Project manager;
                                                              NOR=Prosjektleder] }
    { 4   ;   ;Created Date        ;Date          ;CaptionML=[ENU=Created Date;
                                                              NOR=Opprettet dato] }
    { 5   ;   ;Last Changed Date   ;Date          ;CaptionML=[ENU=Last Changed Date;
                                                              NOR=Sist endret dato] }
    { 6   ;   ;Customer No.        ;Code20        ;TableRelation=Customer.No.;
                                                   OnValidate=BEGIN
                                                                //hhe 02.02.07->
                                                                IF CustomerG.GET("Customer No.") THEN BEGIN
                                                                  "Customer Name" := CustomerG.Name;
                                                                  "Customer Name 2" := CustomerG."Name 2";
                                                                  "Customer Address" := CustomerG.Address;
                                                                  "Customer Address 2" := CustomerG."Address 2";
                                                                  City := CustomerG.City;
                                                                  "Post Code" := CustomerG."Post Code";
                                                                  "Country Code" := CustomerG."Country/Region Code";
                                                                  "VAT Registration No." := CustomerG."VAT Registration No.";
                                                                END;
                                                                //hhe 02.02.07<-
                                                              END;

                                                   CaptionML=[ENU=Custumer No.;
                                                              NOR=Kundenr.] }
    { 7   ;   ;Comment             ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Comment Line" WHERE (Table Name=CONST(Project),
                                                                                           No.=FIELD(Project No.)));
                                                   CaptionML=[ENU=Comment;
                                                              NOR=Merknad];
                                                   Editable=No }
    { 8   ;   ;Calculation No.     ;Code20        ;TableRelation="Item Calc. Line"."Calc. No.";
                                                   CaptionML=[ENU=Calculation No.;
                                                              NOR=Kalkylenr.] }
    { 9   ;   ;Expect Sales Amount 1;Decimal      ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Sales Line".Amount WHERE (Shortcut Dimension 2 Code=FIELD(Project No.)));
                                                   CaptionML=[ENU=Expect Sales Amount 1;
                                                              NOR=Forventet salgsbel›p 1] }
    { 10  ;   ;Expect Sales Amount 2;Decimal      ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Sales Line Archive".Amount WHERE (Shortcut Dimension 2 Code=FIELD(Project No.)));
                                                   CaptionML=[ENU=Expect Sales Amount 2;
                                                              NOR=Forventet salgsbel›p 2] }
    { 11  ;   ;Actual Sales Amount ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Value Entry"."Sales Amount (Actual)" WHERE (Global Dimension 2 Code=FIELD(Project No.)));
                                                   CaptionML=[ENU=Actual Sales Amount;
                                                              NOR=Faktisk salgsbel›p] }
    { 12  ;   ;Expected Material Cost;Decimal     ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Prod. Order Component"."Cost Amount");
                                                   CaptionML=[ENU=Expected Material Cost;
                                                              NOR=Forventet materialkost] }
    { 13  ;   ;Actual Material Cost;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Value Entry"."Cost Amount (Actual)" WHERE (Global Dimension 2 Code=FIELD(Project No.),
                                                                                                                Item Ledger Entry Type=FILTER(Consumption)));
                                                   CaptionML=[ENU=Actual Material Cost;
                                                              NOR=Faktisk materialkost] }
    { 14  ;   ;Expected Capacity Cost;Decimal     ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Prod. Order Routing Line"."Expected Operation Cost Amt.");
                                                   CaptionML=[ENU=Expected Capacity Cost;
                                                              NOR=Forventet kapasitetskost] }
    { 15  ;   ;Actual Capacity Cost;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Value Entry"."Cost Amount (Actual)" WHERE (Capacity Ledger Entry No.=FILTER(>0),
                                                                                                               Entry Type=CONST(Direct Cost),
                                                                                                               Global Dimension 2 Code=FIELD(Project No.)));
                                                   CaptionML=[ENU=Actual Capacity Cost;
                                                              NOR=Faktisk kapasitetskost] }
    { 16  ;   ;Customer Name 2     ;Text50        ;CaptionML=[ENU=Customer Name 2;
                                                              NOR=Kundenavn 2] }
    { 17  ;   ;Customer Address    ;Text50        ;CaptionML=[ENU=Customer Address;
                                                              NOR=Kundeadresse] }
    { 18  ;   ;Customer Address 2  ;Text50        ;CaptionML=[ENU=Customer Address 2;
                                                              NOR=Kundeadresse 2] }
    { 19  ;   ;City                ;Text30        ;OnValidate=BEGIN
                                                                //PostCode.ValidateCity(City,"Post Code");
                                                              END;

                                                   OnLookup=BEGIN
                                                              //PostCode.LookUpCity(City,"Post Code",TRUE);
                                                            END;

                                                   CaptionML=[ENU=City;
                                                              NOR=Sted] }
    { 20  ;   ;VAT Registration No.;Text20        ;OnValidate=VAR
                                                                VATRegNoFormat@1000 : Record 381;
                                                              BEGIN
                                                              END;

                                                   CaptionML=[ENU=VAT Registration No.;
                                                              NOR=Organisasjonsnr.] }
    { 21  ;   ;Actual Direct G/L Cost;Decimal     ;FieldClass=FlowField;
                                                   CalcFormula=Sum("G/L Entry".Amount);
                                                   CaptionML=NOR=Faktisk kost - direkte p† finanskonto }
    { 35  ;   ;Country Code        ;Code10        ;TableRelation=Country/Region;
                                                   CaptionML=[ENU=Country Code;
                                                              NOR=Landskode] }
    { 91  ;   ;Post Code           ;Code20        ;TableRelation="Post Code";
                                                   OnValidate=VAR
                                                                CountyL@1101103000 : Text[30];
                                                              BEGIN
                                                                PostCodeG.ValidatePostCode(City, "Post Code", CountyL, "Country Code", TRUE);
                                                              END;

                                                   OnLookup=BEGIN
                                                              //PostCodeg.LookUpPostCode(City,"Post Code",TRUE);
                                                            END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Post Code;
                                                              NOR=Postnr.] }
    { 92  ;   ;Project Name 2      ;Text30        ;CaptionML=[ENU=Project name 2;
                                                              NOR=Prosjektnavn 2] }
    { 93  ;   ;Customer Name       ;Text50        ;CaptionML=[ENU=Customer name;
                                                              NOR=Kundenavn] }
    { 94  ;   ;Project start date  ;Date          ;CaptionML=[ENU=Project start date;
                                                              NOR=Prosjekt startdato] }
    { 95  ;   ;Project end date    ;Date          ;CaptionML=[ENU=Project end date;
                                                              NOR=Prosjekt sluttdato] }
    { 96  ;   ;Type of project     ;Text80        ;CaptionML=[ENU=Type of project;
                                                              NOR=Oppdragets art] }
  }
  KEYS
  {
    {    ;Project No.                             ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      DimensionValueG@1101103002 : Record 349;
      PostCodeG@1101103001 : Record 225;
      CustomerG@1101103000 : Record 18;

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 01.09.17 JAL Item Calculation (Kalkyle)
    }
    END.
  }
}

OBJECT Table 73054 Routing Control by Order Qty.
{
  OBJECT-PROPERTIES
  {
    Date=01.09.17;
    Time=16.11.16;
    Modified=Yes;
    Version List=ICA2.01;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Routing Control by Order Qty.;
               NOR=Rutestyring e. ordreantall];
  }
  FIELDS
  {
    { 1   ;   ;Routing group code  ;Code20        ;TableRelation="Route Group"."Routing group code";
                                                   CaptionML=[ENU=Routing group code;
                                                              NOR=Rutegruppekode] }
    { 2   ;   ;Routing No.         ;Code20        ;TableRelation="Routing Header".No.;
                                                   CaptionML=NOR=Rutenr. }
    { 3   ;   ;Minimum orderqty.   ;Integer       ;CaptionML=NOR=Minste ordreantall }
  }
  KEYS
  {
    {    ;Routing group code                      ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 01.09.17 JAL Item Calculation (Kalkyle)
    }
    END.
  }
}

OBJECT Table 73055 Route Group
{
  OBJECT-PROPERTIES
  {
    Date=01.09.17;
    Time=16.11.16;
    Modified=Yes;
    Version List=ICA2.01;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Route Group;
               NOR=Rutegruppe];
  }
  FIELDS
  {
    { 1   ;   ;Routing group code  ;Code20        ;CaptionML=[ENU=Routing group code;
                                                              NOR=Rutegruppekode] }
    { 2   ;   ;Description         ;Text50        ;CaptionML=[ENU=Description;
                                                              NOR=Beskrivelse] }
  }
  KEYS
  {
    {    ;Routing group code                      ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 01.09.17 JAL Item Calculation (Kalkyle)
    }
    END.
  }
}

OBJECT Table 73056 Notification Types Address
{
  OBJECT-PROPERTIES
  {
    Date=01.09.17;
    Time=16.11.16;
    Modified=Yes;
    Version List=ICA2.01;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Notification Types Address;
               NOR=Varseltyper Adresse];
  }
  FIELDS
  {
    { 1   ;   ;Notification Type   ;Option        ;CaptionML=NOR=Varslingstype;
                                                   OptionCaptionML=NOR=Gjenbestill,Endring salgsordre-›k,Endring salgsordre-prod,Endring salgsordre-tekn,Endring salgsordre-innkj›p,Endring salgsordre-Adm.dir,Endring salgsordre-kval.leder,Bekreft bestilling,Tilbud utl›p;
                                                   OptionString=Reorder,Sales Order Change-Finance,Sales Order Change-Prod,Sales Order Change-Tech,Sales Order Change-Purch,Sales Order Change-MD,Sales Order Change-QA,Purch Order Confirm, Sales Quote Expire }
    { 2   ;   ;Send notification to ID;Code20     ;CaptionML=NOR=Send varsel til ID }
    { 3   ;   ;Send notific. to E-mailaddr.;Text80;CaptionML=NOR=Send varsel til e-postadresse;
                                                   Description=5.10.10: 30->80 tegn }
  }
  KEYS
  {
    {    ;Notification Type                       ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 01.09.17 JAL Item Calculation (Kalkyle)
    }
    END.
  }
}

OBJECT Report 73050 Item Calculation
{
  OBJECT-PROPERTIES
  {
    Date=08.09.17;
    Time=14.49.08;
    Modified=Yes;
    Version List=ICA2.01;
  }
  PROPERTIES
  {
  }
  DATASET
  {
    { 1101103000;;DataItem;                  ;
               DataItemTable=Table73051 }

    { 1101103001;1;Column;CalcNo_PriceCalcHead;
               IncludeCaption=Yes;
               SourceExpr="Item Calc. Header"."No." }

    { 1101103002;1;Column;ItemNo_PriceCalcHead;
               IncludeCaption=Yes;
               SourceExpr="Item Calc. Header"."Item No." }

    { 1101103003;1;Column;ItemDescription_PriceCalcHead;
               IncludeCaption=Yes;
               SourceExpr="Item Calc. Header"."Item Description" }

    { 1101103004;1;Column;CalcDate_PriceCalcHead;
               IncludeCaption=Yes;
               SourceExpr="Item Calc. Header"."Calc. Date" }

    { 1101103005;1;Column;Calcby_PriceCalcHead;
               IncludeCaption=Yes;
               SourceExpr="Item Calc. Header"."Calc. by" }

    { 1101103006;1;Column;TotMaterialcost_PriceCalcHead;
               IncludeCaption=Yes;
               SourceExpr="Item Calc. Header"."Tot. Material Cost" }

    { 1101103007;1;Column;TotCapacitycost_PriceCalcHead;
               IncludeCaption=Yes;
               SourceExpr="Item Calc. Header"."Tot. Capacity Cost" }

    { 1101103008;1;Column;TotAdditionalCost_PriceCalcHead;
               IncludeCaption=Yes;
               SourceExpr="Item Calc. Header"."Tot. Additional Cost" }

    { 1101103009;1;Column;Salesprice_PriceCalcHead;
               IncludeCaption=Yes;
               SourceExpr="Item Calc. Header"."Sales Price" }

    { 1101103010;1;Column;CalcFactor_PriceCalcHead;
               IncludeCaption=Yes;
               SourceExpr="Item Calc. Header"."Calc. Factor" }

    { 1101103011;1;Column;TotCost_PriceCalcHead;
               IncludeCaption=Yes;
               SourceExpr="Item Calc. Header"."Tot. Cost" }

    { 1101103012;1;Column;Lotsizenoofpcs_PriceCalcHead;
               IncludeCaption=Yes;
               SourceExpr="Item Calc. Header"."Lot Size (No. of PCS)" }

    { 1101103013;1;Column;CalculationMethod_PriceCalcHead;
               IncludeCaption=Yes;
               SourceExpr="Item Calc. Header"."Calculation Method" }

    { 1101103014;1;Column;Orderquantity_PriceCalcHead;
               IncludeCaption=Yes;
               SourceExpr="Item Calc. Header"."Order Quantity" }

    { 1101103015;1;Column;Locked_PriceCalcHead;
               IncludeCaption=Yes;
               SourceExpr="Item Calc. Header".Locked }

    { 1101103016;1;Column;Projectcode_PriceCalcHead;
               IncludeCaption=Yes;
               SourceExpr="Item Calc. Header"."Project Code" }

    { 1101103017;1;Column;Variantcode_PriceCalcHead;
               IncludeCaption=Yes;
               SourceExpr="Item Calc. Header"."Variant Code" }

    { 1101103040;1;Column;WorkDate           ;
               SourceExpr=WORKDATE }

    { 1101103018;1;DataItem;                 ;
               DataItemTable=Table73052;
               DataItemTableView=SORTING(Calc. No.,Type,Sequence No.);
               DataItemLink=Calc. No.=FIELD(No.) }

    { 1101103019;2;Column;CalcNo_PriceCalcLines;
               IncludeCaption=Yes;
               SourceExpr="Item Calc. Line"."Calc. No." }

    { 1101103020;2;Column;Type_PriceCalcLines;
               IncludeCaption=Yes;
               SourceExpr="Item Calc. Line".Type }

    { 1101103021;2;Column;SequenceNo_PriceCalcLines;
               IncludeCaption=Yes;
               SourceExpr="Item Calc. Line"."Sequence No." }

    { 1101103022;2;Column;No_PriceCalcLines  ;
               IncludeCaption=Yes;
               SourceExpr="Item Calc. Line"."No." }

    { 1101103023;2;Column;Description_PriceCalcLines;
               IncludeCaption=Yes;
               SourceExpr="Item Calc. Line".Description }

    { 1101103024;2;Column;Quantity_PriceCalcLines;
               IncludeCaption=Yes;
               SourceExpr="Item Calc. Line".Quantity }

    { 1101103025;2;Column;UnitofMeasure_PriceCalcLines;
               IncludeCaption=Yes;
               SourceExpr="Item Calc. Line"."Unit of Measure" }

    { 1101103026;2;Column;UnitCost_PriceCalcLines;
               IncludeCaption=Yes;
               SourceExpr="Item Calc. Line"."Unit Cost" }

    { 1101103027;2;Column;LineAmount_PriceCalcLines;
               IncludeCaption=Yes;
               SourceExpr="Item Calc. Line"."Line Amount" }

    { 1101103028;2;Column;Projectcode_PriceCalcLines;
               IncludeCaption=Yes;
               SourceExpr="Item Calc. Line"."Project Code" }

    { 1101103029;2;Column;Variantcode_PriceCalcLines;
               IncludeCaption=Yes;
               SourceExpr="Item Calc. Line"."Variant Code" }

    { 1101103030;2;Column;VendorNo_PriceCalcLines;
               IncludeCaption=Yes;
               SourceExpr="Item Calc. Line"."Vendor No." }

    { 1101103031;2;Column;SystemCreated_PriceCalcLines;
               IncludeCaption=Yes;
               SourceExpr="Item Calc. Line"."System Created" }

    { 1101103032;2;Column;WorkCenter_PriceCalcLines;
               IncludeCaption=Yes;
               SourceExpr="Item Calc. Line"."Work Center" }

    { 1101103033;2;Column;Activitytype_PriceCalcLines;
               IncludeCaption=Yes;
               SourceExpr="Item Calc. Line"."Activity Type" }

    { 1101103034;2;Column;Purchasestatus_PriceCalcLines;
               IncludeCaption=Yes;
               SourceExpr="Item Calc. Line"."Purchase Status" }

    { 1101103035;2;Column;PurchaseDocumentNo_PriceCalcLines;
               IncludeCaption=Yes;
               SourceExpr="Item Calc. Line"."Purchase Document No." }

    { 1101103036;2;Column;Purchaselineno_PriceCalcLines;
               IncludeCaption=Yes;
               SourceExpr="Item Calc. Line"."Purchase Line No." }

    { 1101103037;2;Column;Purchaseprice_PriceCalcLines;
               IncludeCaption=Yes;
               SourceExpr="Item Calc. Line"."Purchase Price" }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  LABELS
  {
    { 1101103038;ItemPriceEstimate;
                                CaptionML=[ENU=Item Price Calculation;
                                           NOR=Kalkyleutskrift] }
    { 1101103039;PageCaption   ;CaptionML=[ENU=Page %1 of %2;
                                           NOR=Side %1 av %2] }
  }
  CODE
  {

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 01.09.17 JAL Item Calculation (Kalkyle)
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner" xmlns:cl="http://schemas.microsoft.com/sqlserver/reporting/2010/01/componentdefinition" xmlns="http://schemas.microsoft.com/sqlserver/reporting/2010/01/reportdefinition">
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:DataSourceID>65825d07-0492-4ebd-b1f4-f099e41f9e32</rd:DataSourceID>
    </DataSource>
  </DataSources>
  <DataSets>
    <DataSet Name="DataSet_Result">
      <Query>
        <DataSourceName>DataSource</DataSourceName>
        <CommandText />
      </Query>
      <Fields>
        <Field Name="CalcNo_PriceCalcHead">
          <DataField>CalcNo_PriceCalcHead</DataField>
        </Field>
        <Field Name="ItemNo_PriceCalcHead">
          <DataField>ItemNo_PriceCalcHead</DataField>
        </Field>
        <Field Name="ItemDescription_PriceCalcHead">
          <DataField>ItemDescription_PriceCalcHead</DataField>
        </Field>
        <Field Name="CalcDate_PriceCalcHead">
          <DataField>CalcDate_PriceCalcHead</DataField>
        </Field>
        <Field Name="Calcby_PriceCalcHead">
          <DataField>Calcby_PriceCalcHead</DataField>
        </Field>
        <Field Name="TotMaterialcost_PriceCalcHead">
          <DataField>TotMaterialcost_PriceCalcHead</DataField>
        </Field>
        <Field Name="TotMaterialcost_PriceCalcHeadFormat">
          <DataField>TotMaterialcost_PriceCalcHeadFormat</DataField>
        </Field>
        <Field Name="TotCapacitycost_PriceCalcHead">
          <DataField>TotCapacitycost_PriceCalcHead</DataField>
        </Field>
        <Field Name="TotCapacitycost_PriceCalcHeadFormat">
          <DataField>TotCapacitycost_PriceCalcHeadFormat</DataField>
        </Field>
        <Field Name="TotAdditionalCost_PriceCalcHead">
          <DataField>TotAdditionalCost_PriceCalcHead</DataField>
        </Field>
        <Field Name="TotAdditionalCost_PriceCalcHeadFormat">
          <DataField>TotAdditionalCost_PriceCalcHeadFormat</DataField>
        </Field>
        <Field Name="Salesprice_PriceCalcHead">
          <DataField>Salesprice_PriceCalcHead</DataField>
        </Field>
        <Field Name="Salesprice_PriceCalcHeadFormat">
          <DataField>Salesprice_PriceCalcHeadFormat</DataField>
        </Field>
        <Field Name="CalcFactor_PriceCalcHead">
          <DataField>CalcFactor_PriceCalcHead</DataField>
        </Field>
        <Field Name="CalcFactor_PriceCalcHeadFormat">
          <DataField>CalcFactor_PriceCalcHeadFormat</DataField>
        </Field>
        <Field Name="TotCost_PriceCalcHead">
          <DataField>TotCost_PriceCalcHead</DataField>
        </Field>
        <Field Name="TotCost_PriceCalcHeadFormat">
          <DataField>TotCost_PriceCalcHeadFormat</DataField>
        </Field>
        <Field Name="Lotsizenoofpcs_PriceCalcHead">
          <DataField>Lotsizenoofpcs_PriceCalcHead</DataField>
        </Field>
        <Field Name="CalculationMethod_PriceCalcHead">
          <DataField>CalculationMethod_PriceCalcHead</DataField>
        </Field>
        <Field Name="Orderquantity_PriceCalcHead">
          <DataField>Orderquantity_PriceCalcHead</DataField>
        </Field>
        <Field Name="Locked_PriceCalcHead">
          <DataField>Locked_PriceCalcHead</DataField>
        </Field>
        <Field Name="Projectcode_PriceCalcHead">
          <DataField>Projectcode_PriceCalcHead</DataField>
        </Field>
        <Field Name="Variantcode_PriceCalcHead">
          <DataField>Variantcode_PriceCalcHead</DataField>
        </Field>
        <Field Name="WorkDate">
          <DataField>WorkDate</DataField>
        </Field>
        <Field Name="CalcNo_PriceCalcLines">
          <DataField>CalcNo_PriceCalcLines</DataField>
        </Field>
        <Field Name="Type_PriceCalcLines">
          <DataField>Type_PriceCalcLines</DataField>
        </Field>
        <Field Name="SequenceNo_PriceCalcLines">
          <DataField>SequenceNo_PriceCalcLines</DataField>
        </Field>
        <Field Name="No_PriceCalcLines">
          <DataField>No_PriceCalcLines</DataField>
        </Field>
        <Field Name="Description_PriceCalcLines">
          <DataField>Description_PriceCalcLines</DataField>
        </Field>
        <Field Name="Quantity_PriceCalcLines">
          <DataField>Quantity_PriceCalcLines</DataField>
        </Field>
        <Field Name="Quantity_PriceCalcLinesFormat">
          <DataField>Quantity_PriceCalcLinesFormat</DataField>
        </Field>
        <Field Name="UnitofMeasure_PriceCalcLines">
          <DataField>UnitofMeasure_PriceCalcLines</DataField>
        </Field>
        <Field Name="UnitCost_PriceCalcLines">
          <DataField>UnitCost_PriceCalcLines</DataField>
        </Field>
        <Field Name="UnitCost_PriceCalcLinesFormat">
          <DataField>UnitCost_PriceCalcLinesFormat</DataField>
        </Field>
        <Field Name="LineAmount_PriceCalcLines">
          <DataField>LineAmount_PriceCalcLines</DataField>
        </Field>
        <Field Name="LineAmount_PriceCalcLinesFormat">
          <DataField>LineAmount_PriceCalcLinesFormat</DataField>
        </Field>
        <Field Name="Projectcode_PriceCalcLines">
          <DataField>Projectcode_PriceCalcLines</DataField>
        </Field>
        <Field Name="Variantcode_PriceCalcLines">
          <DataField>Variantcode_PriceCalcLines</DataField>
        </Field>
        <Field Name="VendorNo_PriceCalcLines">
          <DataField>VendorNo_PriceCalcLines</DataField>
        </Field>
        <Field Name="SystemCreated_PriceCalcLines">
          <DataField>SystemCreated_PriceCalcLines</DataField>
        </Field>
        <Field Name="WorkCenter_PriceCalcLines">
          <DataField>WorkCenter_PriceCalcLines</DataField>
        </Field>
        <Field Name="Activitytype_PriceCalcLines">
          <DataField>Activitytype_PriceCalcLines</DataField>
        </Field>
        <Field Name="Purchasestatus_PriceCalcLines">
          <DataField>Purchasestatus_PriceCalcLines</DataField>
        </Field>
        <Field Name="PurchaseDocumentNo_PriceCalcLines">
          <DataField>PurchaseDocumentNo_PriceCalcLines</DataField>
        </Field>
        <Field Name="Purchaselineno_PriceCalcLines">
          <DataField>Purchaselineno_PriceCalcLines</DataField>
        </Field>
        <Field Name="Purchaseprice_PriceCalcLines">
          <DataField>Purchaseprice_PriceCalcLines</DataField>
        </Field>
        <Field Name="Purchaseprice_PriceCalcLinesFormat">
          <DataField>Purchaseprice_PriceCalcLinesFormat</DataField>
        </Field>
      </Fields>
      <rd:DataSetInfo>
        <rd:DataSetName>DataSet</rd:DataSetName>
        <rd:SchemaPath>Report.xsd</rd:SchemaPath>
        <rd:TableName>Result</rd:TableName>
      </rd:DataSetInfo>
    </DataSet>
  </DataSets>
  <ReportSections>
    <ReportSection>
      <Body>
        <ReportItems>
          <Tablix Name="list1">
            <TablixBody>
              <TablixColumns>
                <TablixColumn>
                  <Width>19.4cm</Width>
                </TablixColumn>
              </TablixColumns>
              <TablixRows>
                <TablixRow>
                  <Height>11.19711cm</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Rectangle Name="list1_Contents">
                          <ReportItems>
                            <Tablix Name="Line">
                              <TablixBody>
                                <TablixColumns>
                                  <TablixColumn>
                                    <Width>1.5cm</Width>
                                  </TablixColumn>
                                  <TablixColumn>
                                    <Width>2.25cm</Width>
                                  </TablixColumn>
                                  <TablixColumn>
                                    <Width>5.85cm</Width>
                                  </TablixColumn>
                                  <TablixColumn>
                                    <Width>1.2cm</Width>
                                  </TablixColumn>
                                  <TablixColumn>
                                    <Width>1.2cm</Width>
                                  </TablixColumn>
                                  <TablixColumn>
                                    <Width>1.2cm</Width>
                                  </TablixColumn>
                                  <TablixColumn>
                                    <Width>1.8cm</Width>
                                  </TablixColumn>
                                  <TablixColumn>
                                    <Width>1.8cm</Width>
                                  </TablixColumn>
                                  <TablixColumn>
                                    <Width>1.3cm</Width>
                                  </TablixColumn>
                                  <TablixColumn>
                                    <Width>1.3cm</Width>
                                  </TablixColumn>
                                </TablixColumns>
                                <TablixRows>
                                  <TablixRow>
                                    <Height>0.35278cm</Height>
                                    <TablixCells>
                                      <TablixCell>
                                        <CellContents>
                                          <Textbox Name="Type_PriceCalcLinesCaption">
                                            <CanGrow>true</CanGrow>
                                            <KeepTogether>true</KeepTogether>
                                            <Paragraphs>
                                              <Paragraph>
                                                <TextRuns>
                                                  <TextRun>
                                                    <Value EvaluationMode="Auto">=Parameters!Type_PriceCalcLinesCaption.Value</Value>
                                                    <Style>
                                                      <FontStyle>Normal</FontStyle>
                                                      <FontFamily>Segoe UI</FontFamily>
                                                      <FontSize>8pt</FontSize>
                                                      <FontWeight>Bold</FontWeight>
                                                    </Style>
                                                  </TextRun>
                                                </TextRuns>
                                                <Style>
                                                  <TextAlign>Left</TextAlign>
                                                </Style>
                                              </Paragraph>
                                            </Paragraphs>
                                            <ZIndex>67</ZIndex>
                                            <Style>
                                              <Border>
                                                <Style>None</Style>
                                              </Border>
                                              <VerticalAlign>Bottom</VerticalAlign>
                                              <PaddingRight>5pt</PaddingRight>
                                            </Style>
                                          </Textbox>
                                        </CellContents>
                                      </TablixCell>
                                      <TablixCell>
                                        <CellContents>
                                          <Textbox Name="CalcNo_PriceCalcLinesCaption">
                                            <CanGrow>true</CanGrow>
                                            <KeepTogether>true</KeepTogether>
                                            <Paragraphs>
                                              <Paragraph>
                                                <TextRuns>
                                                  <TextRun>
                                                    <Value EvaluationMode="Auto">=Parameters!CalcNo_PriceCalcLinesCaption.Value</Value>
                                                    <Style>
                                                      <FontStyle>Normal</FontStyle>
                                                      <FontFamily>Segoe UI</FontFamily>
                                                      <FontSize>8pt</FontSize>
                                                      <FontWeight>Bold</FontWeight>
                                                    </Style>
                                                  </TextRun>
                                                </TextRuns>
                                                <Style>
                                                  <TextAlign>Left</TextAlign>
                                                </Style>
                                              </Paragraph>
                                            </Paragraphs>
                                            <Style>
                                              <Border>
                                                <Style>None</Style>
                                              </Border>
                                              <VerticalAlign>Bottom</VerticalAlign>
                                              <PaddingLeft>5pt</PaddingLeft>
                                              <PaddingRight>5pt</PaddingRight>
                                            </Style>
                                          </Textbox>
                                        </CellContents>
                                      </TablixCell>
                                      <TablixCell>
                                        <CellContents>
                                          <Textbox Name="Description_PriceCalcLinesCaption">
                                            <CanGrow>true</CanGrow>
                                            <KeepTogether>true</KeepTogether>
                                            <Paragraphs>
                                              <Paragraph>
                                                <TextRuns>
                                                  <TextRun>
                                                    <Value EvaluationMode="Auto">=Parameters!Description_PriceCalcLinesCaption.Value</Value>
                                                    <Style>
                                                      <FontStyle>Normal</FontStyle>
                                                      <FontFamily>Segoe UI</FontFamily>
                                                      <FontSize>8pt</FontSize>
                                                      <FontWeight>Bold</FontWeight>
                                                    </Style>
                                                  </TextRun>
                                                </TextRuns>
                                                <Style>
                                                  <TextAlign>Left</TextAlign>
                                                </Style>
                                              </Paragraph>
                                            </Paragraphs>
                                            <Style>
                                              <Border>
                                                <Style>None</Style>
                                              </Border>
                                              <VerticalAlign>Bottom</VerticalAlign>
                                              <PaddingLeft>5pt</PaddingLeft>
                                              <PaddingRight>5pt</PaddingRight>
                                            </Style>
                                          </Textbox>
                                        </CellContents>
                                      </TablixCell>
                                      <TablixCell>
                                        <CellContents>
                                          <Textbox Name="Quantity_PriceCalcLinesCaption">
                                            <CanGrow>true</CanGrow>
                                            <KeepTogether>true</KeepTogether>
                                            <Paragraphs>
                                              <Paragraph>
                                                <TextRuns>
                                                  <TextRun>
                                                    <Value EvaluationMode="Auto">=Parameters!Quantity_PriceCalcLinesCaption.Value</Value>
                                                    <Style>
                                                      <FontStyle>Normal</FontStyle>
                                                      <FontFamily>Segoe UI</FontFamily>
                                                      <FontSize>8pt</FontSize>
                                                      <FontWeight>Bold</FontWeight>
                                                    </Style>
                                                  </TextRun>
                                                </TextRuns>
                                                <Style>
                                                  <TextAlign>Right</TextAlign>
                                                </Style>
                                              </Paragraph>
                                            </Paragraphs>
                                            <Style>
                                              <Border>
                                                <Style>None</Style>
                                              </Border>
                                              <VerticalAlign>Bottom</VerticalAlign>
                                              <PaddingLeft>5pt</PaddingLeft>
                                              <PaddingRight>5pt</PaddingRight>
                                            </Style>
                                          </Textbox>
                                        </CellContents>
                                      </TablixCell>
                                      <TablixCell>
                                        <CellContents>
                                          <Textbox Name="UnitofMeasure_PriceCalcLinesCaption">
                                            <CanGrow>true</CanGrow>
                                            <KeepTogether>true</KeepTogether>
                                            <Paragraphs>
                                              <Paragraph>
                                                <TextRuns>
                                                  <TextRun>
                                                    <Value EvaluationMode="Auto">=Parameters!UnitofMeasure_PriceCalcLinesCaption.Value</Value>
                                                    <Style>
                                                      <FontStyle>Normal</FontStyle>
                                                      <FontFamily>Segoe UI</FontFamily>
                                                      <FontSize>8pt</FontSize>
                                                      <FontWeight>Bold</FontWeight>
                                                    </Style>
                                                  </TextRun>
                                                </TextRuns>
                                                <Style>
                                                  <TextAlign>Left</TextAlign>
                                                </Style>
                                              </Paragraph>
                                            </Paragraphs>
                                            <Style>
                                              <Border>
                                                <Style>None</Style>
                                              </Border>
                                              <VerticalAlign>Bottom</VerticalAlign>
                                              <PaddingLeft>5pt</PaddingLeft>
                                            </Style>
                                          </Textbox>
                                        </CellContents>
                                      </TablixCell>
                                      <TablixCell>
                                        <CellContents>
                                          <Textbox Name="UnitCost_PriceCalcLinesCaption">
                                            <CanGrow>true</CanGrow>
                                            <KeepTogether>true</KeepTogether>
                                            <Paragraphs>
                                              <Paragraph>
                                                <TextRuns>
                                                  <TextRun>
                                                    <Value EvaluationMode="Auto">=Parameters!UnitCost_PriceCalcLinesCaption.Value</Value>
                                                    <Style>
                                                      <FontStyle>Normal</FontStyle>
                                                      <FontFamily>Segoe UI</FontFamily>
                                                      <FontSize>8pt</FontSize>
                                                      <FontWeight>Bold</FontWeight>
                                                    </Style>
                                                  </TextRun>
                                                </TextRuns>
                                                <Style>
                                                  <TextAlign>Right</TextAlign>
                                                </Style>
                                              </Paragraph>
                                            </Paragraphs>
                                            <Style>
                                              <Border>
                                                <Style>None</Style>
                                              </Border>
                                              <VerticalAlign>Bottom</VerticalAlign>
                                              <PaddingLeft>5pt</PaddingLeft>
                                            </Style>
                                          </Textbox>
                                        </CellContents>
                                      </TablixCell>
                                      <TablixCell>
                                        <CellContents>
                                          <Textbox Name="LineAmount_PriceCalcLinesCaption">
                                            <CanGrow>true</CanGrow>
                                            <KeepTogether>true</KeepTogether>
                                            <Paragraphs>
                                              <Paragraph>
                                                <TextRuns>
                                                  <TextRun>
                                                    <Value EvaluationMode="Auto">=Parameters!LineAmount_PriceCalcLinesCaption.Value</Value>
                                                    <Style>
                                                      <FontStyle>Normal</FontStyle>
                                                      <FontFamily>Segoe UI</FontFamily>
                                                      <FontSize>8pt</FontSize>
                                                      <FontWeight>Bold</FontWeight>
                                                    </Style>
                                                  </TextRun>
                                                </TextRuns>
                                                <Style>
                                                  <TextAlign>Right</TextAlign>
                                                </Style>
                                              </Paragraph>
                                            </Paragraphs>
                                            <Style>
                                              <Border>
                                                <Style>None</Style>
                                              </Border>
                                              <VerticalAlign>Bottom</VerticalAlign>
                                              <PaddingLeft>5pt</PaddingLeft>
                                            </Style>
                                          </Textbox>
                                        </CellContents>
                                      </TablixCell>
                                      <TablixCell>
                                        <CellContents>
                                          <Textbox Name="VendorNo_PriceCalcLinesCaption">
                                            <CanGrow>true</CanGrow>
                                            <KeepTogether>true</KeepTogether>
                                            <Paragraphs>
                                              <Paragraph>
                                                <TextRuns>
                                                  <TextRun>
                                                    <Value EvaluationMode="Auto">=Parameters!VendorNo_PriceCalcLinesCaption.Value</Value>
                                                    <Style>
                                                      <FontStyle>Normal</FontStyle>
                                                      <FontFamily>Segoe UI</FontFamily>
                                                      <FontSize>8pt</FontSize>
                                                      <FontWeight>Bold</FontWeight>
                                                    </Style>
                                                  </TextRun>
                                                </TextRuns>
                                                <Style>
                                                  <TextAlign>Right</TextAlign>
                                                </Style>
                                              </Paragraph>
                                            </Paragraphs>
                                            <Style>
                                              <Border>
                                                <Style>None</Style>
                                              </Border>
                                              <VerticalAlign>Bottom</VerticalAlign>
                                              <PaddingLeft>5pt</PaddingLeft>
                                            </Style>
                                          </Textbox>
                                        </CellContents>
                                      </TablixCell>
                                      <TablixCell>
                                        <CellContents>
                                          <Textbox Name="SystemCreated_PriceCalcLinesCaption">
                                            <CanGrow>true</CanGrow>
                                            <KeepTogether>true</KeepTogether>
                                            <Paragraphs>
                                              <Paragraph>
                                                <TextRuns>
                                                  <TextRun>
                                                    <Value EvaluationMode="Auto">=Parameters!SystemCreated_PriceCalcLinesCaption.Value</Value>
                                                    <Style>
                                                      <FontStyle>Normal</FontStyle>
                                                      <FontFamily>Segoe UI</FontFamily>
                                                      <FontSize>8pt</FontSize>
                                                      <FontWeight>Bold</FontWeight>
                                                    </Style>
                                                  </TextRun>
                                                </TextRuns>
                                                <Style>
                                                  <TextAlign>Left</TextAlign>
                                                </Style>
                                              </Paragraph>
                                            </Paragraphs>
                                            <Style>
                                              <Border>
                                                <Style>None</Style>
                                              </Border>
                                              <VerticalAlign>Bottom</VerticalAlign>
                                              <PaddingLeft>5pt</PaddingLeft>
                                            </Style>
                                          </Textbox>
                                        </CellContents>
                                      </TablixCell>
                                      <TablixCell>
                                        <CellContents>
                                          <Textbox Name="WorkCenter_PriceCalcLinesCaption">
                                            <CanGrow>true</CanGrow>
                                            <KeepTogether>true</KeepTogether>
                                            <Paragraphs>
                                              <Paragraph>
                                                <TextRuns>
                                                  <TextRun>
                                                    <Value EvaluationMode="Auto">=Parameters!WorkCenter_PriceCalcLinesCaption.Value</Value>
                                                    <Style>
                                                      <FontStyle>Normal</FontStyle>
                                                      <FontFamily>Segoe UI</FontFamily>
                                                      <FontSize>8pt</FontSize>
                                                      <FontWeight>Bold</FontWeight>
                                                    </Style>
                                                  </TextRun>
                                                </TextRuns>
                                                <Style>
                                                  <TextAlign>Left</TextAlign>
                                                </Style>
                                              </Paragraph>
                                            </Paragraphs>
                                            <Style>
                                              <Border>
                                                <Style>None</Style>
                                              </Border>
                                              <VerticalAlign>Bottom</VerticalAlign>
                                              <PaddingLeft>5pt</PaddingLeft>
                                            </Style>
                                          </Textbox>
                                        </CellContents>
                                      </TablixCell>
                                    </TablixCells>
                                  </TablixRow>
                                  <TablixRow>
                                    <Height>0.17638cm</Height>
                                    <TablixCells>
                                      <TablixCell>
                                        <CellContents>
                                          <Textbox Name="EmptyRow">
                                            <CanGrow>true</CanGrow>
                                            <KeepTogether>true</KeepTogether>
                                            <Paragraphs>
                                              <Paragraph>
                                                <TextRuns>
                                                  <TextRun>
                                                    <Value EvaluationMode="Auto" />
                                                    <Style>
                                                      <FontStyle>Normal</FontStyle>
                                                      <FontFamily>Segoe UI</FontFamily>
                                                      <FontSize>8pt</FontSize>
                                                      <FontWeight>Bold</FontWeight>
                                                    </Style>
                                                  </TextRun>
                                                </TextRuns>
                                                <Style>
                                                  <TextAlign>Right</TextAlign>
                                                </Style>
                                              </Paragraph>
                                            </Paragraphs>
                                            <Style>
                                              <Border>
                                                <Style>None</Style>
                                              </Border>
                                              <BottomBorder>
                                                <Style>Solid</Style>
                                              </BottomBorder>
                                              <VerticalAlign>Bottom</VerticalAlign>
                                              <PaddingRight>5pt</PaddingRight>
                                            </Style>
                                          </Textbox>
                                          <ColSpan>10</ColSpan>
                                        </CellContents>
                                      </TablixCell>
                                      <TablixCell />
                                      <TablixCell />
                                      <TablixCell />
                                      <TablixCell />
                                      <TablixCell />
                                      <TablixCell />
                                      <TablixCell />
                                      <TablixCell />
                                      <TablixCell />
                                    </TablixCells>
                                  </TablixRow>
                                  <TablixRow>
                                    <Height>0.35278cm</Height>
                                    <TablixCells>
                                      <TablixCell>
                                        <CellContents>
                                          <Textbox Name="Type_PriceCalcLines">
                                            <CanGrow>true</CanGrow>
                                            <KeepTogether>true</KeepTogether>
                                            <Paragraphs>
                                              <Paragraph>
                                                <TextRuns>
                                                  <TextRun>
                                                    <Value EvaluationMode="Auto">=Fields!Type_PriceCalcLines.Value</Value>
                                                    <Style>
                                                      <FontStyle>Normal</FontStyle>
                                                      <FontFamily>Segoe UI</FontFamily>
                                                      <FontSize>8pt</FontSize>
                                                    </Style>
                                                  </TextRun>
                                                </TextRuns>
                                                <Style>
                                                  <TextAlign>Left</TextAlign>
                                                </Style>
                                              </Paragraph>
                                            </Paragraphs>
                                            <ZIndex>15</ZIndex>
                                            <DataElementOutput>NoOutput</DataElementOutput>
                                            <Style>
                                              <Border>
                                                <Style>None</Style>
                                              </Border>
                                              <VerticalAlign>Top</VerticalAlign>
                                              <PaddingRight>5pt</PaddingRight>
                                            </Style>
                                          </Textbox>
                                        </CellContents>
                                      </TablixCell>
                                      <TablixCell>
                                        <CellContents>
                                          <Textbox Name="CalcNo_PriceCalcLines">
                                            <KeepTogether>true</KeepTogether>
                                            <Paragraphs>
                                              <Paragraph>
                                                <TextRuns>
                                                  <TextRun>
                                                    <Value EvaluationMode="Auto">=Fields!CalcNo_PriceCalcLines.Value</Value>
                                                    <Style>
                                                      <FontStyle>Normal</FontStyle>
                                                      <FontFamily>Segoe UI</FontFamily>
                                                      <FontSize>8pt</FontSize>
                                                    </Style>
                                                  </TextRun>
                                                </TextRuns>
                                                <Style>
                                                  <TextAlign>Left</TextAlign>
                                                </Style>
                                              </Paragraph>
                                            </Paragraphs>
                                            <rd:DefaultName>CalcNo_PriceCalcLines</rd:DefaultName>
                                            <ZIndex>14</ZIndex>
                                            <Style>
                                              <Border>
                                                <Style>None</Style>
                                              </Border>
                                              <VerticalAlign>Top</VerticalAlign>
                                              <PaddingLeft>5pt</PaddingLeft>
                                              <PaddingRight>5pt</PaddingRight>
                                            </Style>
                                          </Textbox>
                                        </CellContents>
                                      </TablixCell>
                                      <TablixCell>
                                        <CellContents>
                                          <Textbox Name="Description_PriceCalcLines">
                                            <CanGrow>true</CanGrow>
                                            <KeepTogether>true</KeepTogether>
                                            <Paragraphs>
                                              <Paragraph>
                                                <TextRuns>
                                                  <TextRun>
                                                    <Value EvaluationMode="Auto">=Fields!Description_PriceCalcLines.Value</Value>
                                                    <Style>
                                                      <FontStyle>Normal</FontStyle>
                                                      <FontFamily>Segoe UI</FontFamily>
                                                      <FontSize>8pt</FontSize>
                                                    </Style>
                                                  </TextRun>
                                                </TextRuns>
                                                <Style>
                                                  <TextAlign>Left</TextAlign>
                                                </Style>
                                              </Paragraph>
                                            </Paragraphs>
                                            <Style>
                                              <Border>
                                                <Style>None</Style>
                                              </Border>
                                              <VerticalAlign>Top</VerticalAlign>
                                              <PaddingLeft>5pt</PaddingLeft>
                                              <PaddingRight>5pt</PaddingRight>
                                            </Style>
                                          </Textbox>
                                        </CellContents>
                                      </TablixCell>
                                      <TablixCell>
                                        <CellContents>
                                          <Textbox Name="Quantity_PriceCalcLines">
                                            <CanGrow>true</CanGrow>
                                            <KeepTogether>true</KeepTogether>
                                            <Paragraphs>
                                              <Paragraph>
                                                <TextRuns>
                                                  <TextRun>
                                                    <Value EvaluationMode="Auto">=Fields!Quantity_PriceCalcLines.Value</Value>
                                                    <Style>
                                                      <FontStyle>Normal</FontStyle>
                                                      <FontFamily>Segoe UI</FontFamily>
                                                      <FontSize>8pt</FontSize>
                                                      <Format>=Fields!Quantity_PriceCalcLinesFormat.Value</Format>
                                                    </Style>
                                                  </TextRun>
                                                </TextRuns>
                                                <Style>
                                                  <TextAlign>Right</TextAlign>
                                                </Style>
                                              </Paragraph>
                                            </Paragraphs>
                                            <Style>
                                              <Border>
                                                <Style>None</Style>
                                              </Border>
                                              <VerticalAlign>Top</VerticalAlign>
                                              <PaddingLeft>5pt</PaddingLeft>
                                              <PaddingRight>5pt</PaddingRight>
                                            </Style>
                                          </Textbox>
                                        </CellContents>
                                      </TablixCell>
                                      <TablixCell>
                                        <CellContents>
                                          <Textbox Name="UnitofMeasure_PriceCalcLines">
                                            <CanGrow>true</CanGrow>
                                            <KeepTogether>true</KeepTogether>
                                            <Paragraphs>
                                              <Paragraph>
                                                <TextRuns>
                                                  <TextRun>
                                                    <Value EvaluationMode="Auto">=Fields!UnitofMeasure_PriceCalcLines.Value</Value>
                                                    <Style>
                                                      <FontStyle>Normal</FontStyle>
                                                      <FontFamily>Segoe UI</FontFamily>
                                                      <FontSize>8pt</FontSize>
                                                    </Style>
                                                  </TextRun>
                                                </TextRuns>
                                                <Style>
                                                  <TextAlign>Left</TextAlign>
                                                </Style>
                                              </Paragraph>
                                            </Paragraphs>
                                            <Style>
                                              <Border>
                                                <Style>None</Style>
                                              </Border>
                                              <VerticalAlign>Top</VerticalAlign>
                                              <PaddingLeft>5pt</PaddingLeft>
                                              <PaddingRight>5pt</PaddingRight>
                                            </Style>
                                          </Textbox>
                                        </CellContents>
                                      </TablixCell>
                                      <TablixCell>
                                        <CellContents>
                                          <Textbox Name="UnitCost_PriceCalcLines">
                                            <CanGrow>true</CanGrow>
                                            <KeepTogether>true</KeepTogether>
                                            <Paragraphs>
                                              <Paragraph>
                                                <TextRuns>
                                                  <TextRun>
                                                    <Value EvaluationMode="Auto">=Fields!UnitCost_PriceCalcLines.Value</Value>
                                                    <Style>
                                                      <FontStyle>Normal</FontStyle>
                                                      <FontFamily>Segoe UI</FontFamily>
                                                      <FontSize>8pt</FontSize>
                                                      <Format>=Fields!UnitCost_PriceCalcLinesFormat.Value</Format>
                                                    </Style>
                                                  </TextRun>
                                                </TextRuns>
                                                <Style>
                                                  <TextAlign>Right</TextAlign>
                                                </Style>
                                              </Paragraph>
                                            </Paragraphs>
                                            <Style>
                                              <Border>
                                                <Style>None</Style>
                                              </Border>
                                              <VerticalAlign>Top</VerticalAlign>
                                              <PaddingLeft>5pt</PaddingLeft>
                                              <PaddingRight>5pt</PaddingRight>
                                            </Style>
                                          </Textbox>
                                        </CellContents>
                                      </TablixCell>
                                      <TablixCell>
                                        <CellContents>
                                          <Textbox Name="LineAmount_PriceCalcLines">
                                            <CanGrow>true</CanGrow>
                                            <KeepTogether>true</KeepTogether>
                                            <Paragraphs>
                                              <Paragraph>
                                                <TextRuns>
                                                  <TextRun>
                                                    <Value EvaluationMode="Auto">=Fields!LineAmount_PriceCalcLines.Value</Value>
                                                    <Style>
                                                      <FontStyle>Normal</FontStyle>
                                                      <FontFamily>Segoe UI</FontFamily>
                                                      <FontSize>8pt</FontSize>
                                                      <Format>=Fields!LineAmount_PriceCalcLinesFormat.Value</Format>
                                                    </Style>
                                                  </TextRun>
                                                </TextRuns>
                                                <Style>
                                                  <TextAlign>Right</TextAlign>
                                                </Style>
                                              </Paragraph>
                                            </Paragraphs>
                                            <Style>
                                              <Border>
                                                <Style>None</Style>
                                              </Border>
                                              <VerticalAlign>Top</VerticalAlign>
                                              <PaddingLeft>5pt</PaddingLeft>
                                              <PaddingRight>5pt</PaddingRight>
                                            </Style>
                                          </Textbox>
                                        </CellContents>
                                      </TablixCell>
                                      <TablixCell>
                                        <CellContents>
                                          <Textbox Name="VendorNo_PriceCalcLines">
                                            <CanGrow>true</CanGrow>
                                            <KeepTogether>true</KeepTogether>
                                            <Paragraphs>
                                              <Paragraph>
                                                <TextRuns>
                                                  <TextRun>
                                                    <Value EvaluationMode="Auto">=Fields!VendorNo_PriceCalcLines.Value</Value>
                                                    <Style>
                                                      <FontStyle>Normal</FontStyle>
                                                      <FontFamily>Segoe UI</FontFamily>
                                                      <FontSize>8pt</FontSize>
                                                    </Style>
                                                  </TextRun>
                                                </TextRuns>
                                                <Style>
                                                  <TextAlign>Right</TextAlign>
                                                </Style>
                                              </Paragraph>
                                            </Paragraphs>
                                            <Style>
                                              <Border>
                                                <Style>None</Style>
                                              </Border>
                                              <VerticalAlign>Top</VerticalAlign>
                                              <PaddingLeft>5pt</PaddingLeft>
                                              <PaddingRight>5pt</PaddingRight>
                                            </Style>
                                          </Textbox>
                                        </CellContents>
                                      </TablixCell>
                                      <TablixCell>
                                        <CellContents>
                                          <Textbox Name="SystemCreated_PriceCalcLines">
                                            <CanGrow>true</CanGrow>
                                            <KeepTogether>true</KeepTogether>
                                            <Paragraphs>
                                              <Paragraph>
                                                <TextRuns>
                                                  <TextRun>
                                                    <Value EvaluationMode="Auto">=IIF(Fields!SystemCreated_PriceCalcLines.Value,Chr(254),Chr(168)) ''
'',"a","r")</Value>
                                                    <Style>
                                                      <FontStyle>Normal</FontStyle>
                                                      <FontFamily>Wingdings</FontFamily>
                                                      <FontSize>8pt</FontSize>
                                                    </Style>
                                                  </TextRun>
                                                </TextRuns>
                                                <Style>
                                                  <TextAlign>Left</TextAlign>
                                                </Style>
                                              </Paragraph>
                                            </Paragraphs>
                                            <Style>
                                              <Border>
                                                <Style>None</Style>
                                              </Border>
                                              <VerticalAlign>Top</VerticalAlign>
                                              <PaddingLeft>5pt</PaddingLeft>
                                              <PaddingRight>5pt</PaddingRight>
                                            </Style>
                                          </Textbox>
                                        </CellContents>
                                      </TablixCell>
                                      <TablixCell>
                                        <CellContents>
                                          <Textbox Name="WorkCenter_PriceCalcLines">
                                            <CanGrow>true</CanGrow>
                                            <KeepTogether>true</KeepTogether>
                                            <Paragraphs>
                                              <Paragraph>
                                                <TextRuns>
                                                  <TextRun>
                                                    <Value EvaluationMode="Auto">=Fields!WorkCenter_PriceCalcLines.Value</Value>
                                                    <Style>
                                                      <FontStyle>Normal</FontStyle>
                                                      <FontFamily>Segoe UI</FontFamily>
                                                      <FontSize>8pt</FontSize>
                                                    </Style>
                                                  </TextRun>
                                                </TextRuns>
                                                <Style>
                                                  <TextAlign>Right</TextAlign>
                                                </Style>
                                              </Paragraph>
                                            </Paragraphs>
                                            <Style>
                                              <Border>
                                                <Style>None</Style>
                                              </Border>
                                              <VerticalAlign>Top</VerticalAlign>
                                              <PaddingLeft>5pt</PaddingLeft>
                                              <PaddingRight>5pt</PaddingRight>
                                            </Style>
                                          </Textbox>
                                        </CellContents>
                                      </TablixCell>
                                    </TablixCells>
                                  </TablixRow>
                                </TablixRows>
                              </TablixBody>
                              <TablixColumnHierarchy>
                                <TablixMembers>
                                  <TablixMember />
                                  <TablixMember />
                                  <TablixMember />
                                  <TablixMember />
                                  <TablixMember />
                                  <TablixMember />
                                  <TablixMember />
                                  <TablixMember />
                                  <TablixMember />
                                  <TablixMember />
                                </TablixMembers>
                              </TablixColumnHierarchy>
                              <TablixRowHierarchy>
                                <TablixMembers>
                                  <TablixMember>
                                    <KeepWithGroup>After</KeepWithGroup>
                                    <RepeatOnNewPage>true</RepeatOnNewPage>
                                    <KeepTogether>true</KeepTogether>
                                  </TablixMember>
                                  <TablixMember>
                                    <KeepWithGroup>After</KeepWithGroup>
                                    <RepeatOnNewPage>true</RepeatOnNewPage>
                                  </TablixMember>
                                  <TablixMember>
                                    <Group Name="table2_Group1">
                                      <GroupExpressions>
                                        <GroupExpression>=Fields!CalcNo_PriceCalcLines.Value</GroupExpression>
                                        <GroupExpression>=Fields!SequenceNo_PriceCalcLines.Value</GroupExpression>
                                      </GroupExpressions>
                                    </Group>
                                    <TablixMembers>
                                      <TablixMember>
                                        <Group Name="table2_Details_Group">
                                          <DataElementName>Detail</DataElementName>
                                        </Group>
                                        <DataElementName>Detail_Collection</DataElementName>
                                        <DataElementOutput>Output</DataElementOutput>
                                        <KeepTogether>true</KeepTogether>
                                      </TablixMember>
                                    </TablixMembers>
                                  </TablixMember>
                                </TablixMembers>
                              </TablixRowHierarchy>
                              <KeepTogether>true</KeepTogether>
                              <DataSetName>DataSet_Result</DataSetName>
                              <Top>0.03167cm</Top>
                              <Height>0.88194cm</Height>
                              <Width>19.4cm</Width>
                              <DataElementOutput>NoOutput</DataElementOutput>
                              <Style />
                            </Tablix>
                            <Tablix Name="SetDataTable">
                              <TablixBody>
                                <TablixColumns>
                                  <TablixColumn>
                                    <Width>1.31708cm</Width>
                                  </TablixColumn>
                                </TablixColumns>
                                <TablixRows>
                                  <TablixRow>
                                    <Height>0.4064cm</Height>
                                    <TablixCells>
                                      <TablixCell>
                                        <CellContents>
                                          <Textbox Name="SetDataTextBox">
                                            <CanGrow>true</CanGrow>
                                            <KeepTogether>true</KeepTogether>
                                            <Paragraphs>
                                              <Paragraph>
                                                <TextRuns>
                                                  <TextRun>
                                                    <Value EvaluationMode="Auto" />
                                                    <Style>
                                                      <Color>Red</Color>
                                                    </Style>
                                                  </TextRun>
                                                </TextRuns>
                                                <Style />
                                              </Paragraph>
                                            </Paragraphs>
                                            <ZIndex>6</ZIndex>
                                            <Visibility>
                                              <Hidden>=Code.SetData(Cstr(Fields!CalcNo_PriceCalcHead.Value) + Chr(177) + 
Cstr(Parameters!PageCaption.Value) + Chr(177) + 
Cstr(Fields!WorkDate.Value) + Chr(177) + 
Cstr(Fields!ItemNo_PriceCalcHead.Value) + Chr(177) + 
Cstr(Fields!ItemDescription_PriceCalcHead.Value) + Chr(177) + 
Cstr(Fields!Orderquantity_PriceCalcHead.Value) + Chr(177) + 
Cstr(Fields!TotMaterialcost_PriceCalcHead.Value) + Chr(177) + 
Cstr(Fields!TotCapacitycost_PriceCalcHead.Value) + Chr(177) + 
Cstr(Fields!TotAdditionalCost_PriceCalcHead.Value) + Chr(177) + 
Cstr(Fields!TotCost_PriceCalcHead.Value) + Chr(177) + 
Cstr(Fields!CalcFactor_PriceCalcHead.Value) + Chr(177) + 
Cstr(Fields!Salesprice_PriceCalcHead.Value) + Chr(177) + 
Cstr(Fields!Lotsizenoofpcs_PriceCalcHead.Value) + Chr(177) + 
Cstr(Fields!Calcby_PriceCalcHead.Value) + Chr(177) + 
Cstr(Fields!CalcDate_PriceCalcHead.Value) + Chr(177) + 
Cstr(Fields!Locked_PriceCalcHead.Value)
, 1)</Hidden>
                                            </Visibility>
                                            <Style>
                                              <Border>
                                                <Style>None</Style>
                                              </Border>
                                            </Style>
                                          </Textbox>
                                        </CellContents>
                                      </TablixCell>
                                    </TablixCells>
                                  </TablixRow>
                                </TablixRows>
                              </TablixBody>
                              <TablixColumnHierarchy>
                                <TablixMembers>
                                  <TablixMember />
                                </TablixMembers>
                              </TablixColumnHierarchy>
                              <TablixRowHierarchy>
                                <TablixMembers>
                                  <TablixMember>
                                    <KeepTogether>true</KeepTogether>
                                  </TablixMember>
                                </TablixMembers>
                              </TablixRowHierarchy>
                              <DataSetName>DataSet_Result</DataSetName>
                              <Left>6.63976in</Left>
                              <Height>0.4064cm</Height>
                              <Width>1.31708cm</Width>
                              <ZIndex>1</ZIndex>
                              <Style />
                            </Tablix>
                          </ReportItems>
                          <KeepTogether>true</KeepTogether>
                          <Style />
                        </Rectangle>
                      </CellContents>
                    </TablixCell>
                  </TablixCells>
                </TablixRow>
              </TablixRows>
            </TablixBody>
            <TablixColumnHierarchy>
              <TablixMembers>
                <TablixMember />
              </TablixMembers>
            </TablixColumnHierarchy>
            <TablixRowHierarchy>
              <TablixMembers>
                <TablixMember>
                  <Group Name="list1_Details_Group">
                    <GroupExpressions>
                      <GroupExpression>=Fields!CalcNo_PriceCalcHead.Value</GroupExpression>
                    </GroupExpressions>
                    <PageBreak>
                      <BreakLocation>Between</BreakLocation>
                      <ResetPageNumber>true</ResetPageNumber>
                    </PageBreak>
                  </Group>
                  <DataElementOutput>Output</DataElementOutput>
                  <KeepTogether>true</KeepTogether>
                </TablixMember>
              </TablixMembers>
            </TablixRowHierarchy>
            <KeepTogether>true</KeepTogether>
            <DataSetName>DataSet_Result</DataSetName>
            <Left>0.02272cm</Left>
            <Height>11.19711cm</Height>
            <Width>19.4cm</Width>
            <Style />
          </Tablix>
        </ReportItems>
        <Height>11.19711cm</Height>
        <Style />
      </Body>
      <Width>19.4453cm</Width>
      <Page>
        <PageHeader>
          <Height>5.64258cm</Height>
          <PrintOnFirstPage>true</PrintOnFirstPage>
          <PrintOnLastPage>true</PrintOnLastPage>
          <ReportItems>
            <Textbox Name="TotAdditionalCost_PriceCalcHeadCaption">
              <KeepTogether>true</KeepTogether>
              <Paragraphs>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Value EvaluationMode="Auto">=Parameters!TotAdditionalCost_PriceCalcHeadCaption.Value ''</Value>
                      <Style>
                        <FontStyle>Normal</FontStyle>
                        <FontFamily>Segoe UI</FontFamily>
                        <FontSize>8pt</FontSize>
                      </Style>
                    </TextRun>
                  </TextRuns>
                  <Style />
                </Paragraph>
              </Paragraphs>
              <Top>3.05304cm</Top>
              <Height>11pt</Height>
              <Width>3.62272cm</Width>
              <Style>
                <Border>
                  <Style>None</Style>
                </Border>
                <VerticalAlign>Middle</VerticalAlign>
              </Style>
            </Textbox>
            <Textbox Name="TotCapacitycost_PriceCalcHeadCaption">
              <KeepTogether>true</KeepTogether>
              <Paragraphs>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Value EvaluationMode="Auto">=Parameters!TotCapacitycost_PriceCalcHeadCaption.Value ''</Value>
                      <Style>
                        <FontStyle>Normal</FontStyle>
                        <FontFamily>Segoe UI</FontFamily>
                        <FontSize>8pt</FontSize>
                      </Style>
                    </TextRun>
                  </TextRuns>
                  <Style />
                </Paragraph>
              </Paragraphs>
              <Top>2.66498cm</Top>
              <Height>11pt</Height>
              <Width>3.62272cm</Width>
              <ZIndex>1</ZIndex>
              <Style>
                <Border>
                  <Style>None</Style>
                </Border>
                <VerticalAlign>Middle</VerticalAlign>
              </Style>
            </Textbox>
            <Textbox Name="TotCost_PriceCalcHeadCaption">
              <KeepTogether>true</KeepTogether>
              <Paragraphs>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Value EvaluationMode="Auto">=Parameters!TotCost_PriceCalcHeadCaption.Value ''</Value>
                      <Style>
                        <FontStyle>Normal</FontStyle>
                        <FontFamily>Segoe UI</FontFamily>
                        <FontSize>8pt</FontSize>
                      </Style>
                    </TextRun>
                  </TextRuns>
                  <Style />
                </Paragraph>
              </Paragraphs>
              <Top>3.44109cm</Top>
              <Height>11pt</Height>
              <Width>3.62272cm</Width>
              <ZIndex>2</ZIndex>
              <Style>
                <Border>
                  <Style>None</Style>
                </Border>
                <VerticalAlign>Middle</VerticalAlign>
              </Style>
            </Textbox>
            <Textbox Name="TotMaterialcost_PriceCalcHeadCaption">
              <KeepTogether>true</KeepTogether>
              <Paragraphs>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Value EvaluationMode="Auto">=Parameters!TotMaterialcost_PriceCalcHeadCaption.Value ''</Value>
                      <Style>
                        <FontStyle>Normal</FontStyle>
                        <FontFamily>Segoe UI</FontFamily>
                        <FontSize>8pt</FontSize>
                      </Style>
                    </TextRun>
                  </TextRuns>
                  <Style />
                </Paragraph>
              </Paragraphs>
              <Top>2.27693cm</Top>
              <Height>11pt</Height>
              <Width>3.62271cm</Width>
              <ZIndex>3</ZIndex>
              <Style>
                <Border>
                  <Style>None</Style>
                </Border>
                <VerticalAlign>Middle</VerticalAlign>
              </Style>
            </Textbox>
            <Textbox Name="Orderquantity_PriceCalcHeadCaption">
              <KeepTogether>true</KeepTogether>
              <Paragraphs>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Value EvaluationMode="Auto">=Parameters!Orderquantity_PriceCalcHeadCaption.Value ''</Value>
                      <Style>
                        <FontStyle>Normal</FontStyle>
                        <FontFamily>Segoe UI</FontFamily>
                        <FontSize>8pt</FontSize>
                      </Style>
                    </TextRun>
                  </TextRuns>
                  <Style />
                </Paragraph>
              </Paragraphs>
              <Top>1.88887cm</Top>
              <Height>11pt</Height>
              <Width>3.62272cm</Width>
              <ZIndex>4</ZIndex>
              <Style>
                <Border>
                  <Style>None</Style>
                </Border>
                <VerticalAlign>Middle</VerticalAlign>
              </Style>
            </Textbox>
            <Textbox Name="ItemDescription_PriceCalcHeadCaption">
              <KeepTogether>true</KeepTogether>
              <Paragraphs>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Value EvaluationMode="Auto">=Parameters!ItemDescription_PriceCalcHeadCaption.Value ''</Value>
                      <Style>
                        <FontStyle>Normal</FontStyle>
                        <FontFamily>Segoe UI</FontFamily>
                        <FontSize>8pt</FontSize>
                      </Style>
                    </TextRun>
                  </TextRuns>
                  <Style />
                </Paragraph>
              </Paragraphs>
              <Top>1.50082cm</Top>
              <Height>11pt</Height>
              <Width>3.62272cm</Width>
              <ZIndex>5</ZIndex>
              <Style>
                <Border>
                  <Style>None</Style>
                </Border>
                <VerticalAlign>Middle</VerticalAlign>
              </Style>
            </Textbox>
            <Textbox Name="ItemNo_PriceCalcHeadCaption">
              <KeepTogether>true</KeepTogether>
              <Paragraphs>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Value EvaluationMode="Auto">=Parameters!ItemNo_PriceCalcHeadCaption.Value ''</Value>
                      <Style>
                        <FontStyle>Normal</FontStyle>
                        <FontFamily>Segoe UI</FontFamily>
                        <FontSize>8pt</FontSize>
                      </Style>
                    </TextRun>
                  </TextRuns>
                  <Style />
                </Paragraph>
              </Paragraphs>
              <Top>1.11276cm</Top>
              <Height>11pt</Height>
              <Width>3.62272cm</Width>
              <ZIndex>6</ZIndex>
              <Style>
                <Border>
                  <Style>None</Style>
                </Border>
                <VerticalAlign>Middle</VerticalAlign>
              </Style>
            </Textbox>
            <Textbox Name="CalcNo_PriceCalcHeadCaption">
              <KeepTogether>true</KeepTogether>
              <Paragraphs>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Value EvaluationMode="Auto">=Parameters!CalcNo_PriceCalcHeadCaption.Value ''</Value>
                      <Style>
                        <FontStyle>Normal</FontStyle>
                        <FontFamily>Segoe UI</FontFamily>
                        <FontSize>8pt</FontSize>
                      </Style>
                    </TextRun>
                  </TextRuns>
                  <Style />
                </Paragraph>
              </Paragraphs>
              <Top>0.72471cm</Top>
              <Height>11pt</Height>
              <Width>3.62272cm</Width>
              <ZIndex>7</ZIndex>
              <Style>
                <Border>
                  <Style>None</Style>
                </Border>
                <VerticalAlign>Middle</VerticalAlign>
              </Style>
            </Textbox>
            <Textbox Name="Calcby_PriceCalcHeadCaption">
              <KeepTogether>true</KeepTogether>
              <Paragraphs>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Value EvaluationMode="Auto">=Parameters!Calcby_PriceCalcHeadCaption.Value ''</Value>
                      <Style>
                        <FontStyle>Normal</FontStyle>
                        <FontFamily>Segoe UI</FontFamily>
                        <FontSize>8pt</FontSize>
                      </Style>
                    </TextRun>
                  </TextRuns>
                  <Style>
                    <TextAlign>Right</TextAlign>
                  </Style>
                </Paragraph>
              </Paragraphs>
              <Top>3.05304cm</Top>
              <Left>13.58771cm</Left>
              <Height>11pt</Height>
              <Width>3.26472cm</Width>
              <ZIndex>8</ZIndex>
              <Style>
                <Border>
                  <Style>None</Style>
                </Border>
                <VerticalAlign>Middle</VerticalAlign>
              </Style>
            </Textbox>
            <Textbox Name="Locked_PriceCalcHead">
              <KeepTogether>true</KeepTogether>
              <Paragraphs>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Value EvaluationMode="Auto">=Code.GetData(16,1)</Value>
                      <Style>
                        <FontStyle>Normal</FontStyle>
                        <FontFamily>Segoe UI</FontFamily>
                        <FontSize>8pt</FontSize>
                      </Style>
                    </TextRun>
                  </TextRuns>
                  <Style>
                    <TextAlign>Right</TextAlign>
                  </Style>
                </Paragraph>
              </Paragraphs>
              <Top>3.82916cm</Top>
              <Left>16.88771cm</Left>
              <Height>11pt</Height>
              <Width>2.51359cm</Width>
              <ZIndex>9</ZIndex>
              <Style>
                <Border>
                  <Style>None</Style>
                </Border>
                <VerticalAlign>Middle</VerticalAlign>
              </Style>
            </Textbox>
            <Textbox Name="CalcDate_PriceCalcHead">
              <KeepTogether>true</KeepTogether>
              <Paragraphs>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Value EvaluationMode="Auto">=Code.GetData(15,1)</Value>
                      <Style>
                        <FontStyle>Normal</FontStyle>
                        <FontFamily>Segoe UI</FontFamily>
                        <FontSize>8pt</FontSize>
                      </Style>
                    </TextRun>
                  </TextRuns>
                  <Style>
                    <TextAlign>Right</TextAlign>
                  </Style>
                </Paragraph>
              </Paragraphs>
              <Top>3.4411cm</Top>
              <Left>16.88771cm</Left>
              <Height>11pt</Height>
              <Width>2.51359cm</Width>
              <ZIndex>10</ZIndex>
              <Style>
                <Border>
                  <Style>None</Style>
                </Border>
                <VerticalAlign>Middle</VerticalAlign>
              </Style>
            </Textbox>
            <Textbox Name="Calcby_PriceCalcHead">
              <KeepTogether>true</KeepTogether>
              <Paragraphs>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Value EvaluationMode="Auto">=Code.GetData(14,1)</Value>
                      <Style>
                        <FontStyle>Normal</FontStyle>
                        <FontFamily>Segoe UI</FontFamily>
                        <FontSize>8pt</FontSize>
                      </Style>
                    </TextRun>
                  </TextRuns>
                  <Style>
                    <TextAlign>Right</TextAlign>
                  </Style>
                </Paragraph>
              </Paragraphs>
              <Top>3.05304cm</Top>
              <Left>16.88771cm</Left>
              <Height>11pt</Height>
              <Width>2.51359cm</Width>
              <ZIndex>11</ZIndex>
              <Style>
                <Border>
                  <Style>None</Style>
                </Border>
                <VerticalAlign>Middle</VerticalAlign>
              </Style>
            </Textbox>
            <Textbox Name="ExecutionTime">
              <KeepTogether>true</KeepTogether>
              <Paragraphs>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Value EvaluationMode="Auto">=Globals!ExecutionTime</Value>
                      <Style>
                        <FontStyle>Normal</FontStyle>
                        <FontFamily>Segoe UI</FontFamily>
                        <FontSize>8pt</FontSize>
                      </Style>
                    </TextRun>
                  </TextRuns>
                  <Style>
                    <TextAlign>Right</TextAlign>
                  </Style>
                </Paragraph>
              </Paragraphs>
              <Top>1.46555cm</Top>
              <Left>13.58771cm</Left>
              <Height>11pt</Height>
              <Width>5.81359cm</Width>
              <ZIndex>12</ZIndex>
              <Style>
                <Border>
                  <Style>None</Style>
                </Border>
              </Style>
            </Textbox>
            <Textbox Name="PageNumber">
              <KeepTogether>true</KeepTogether>
              <Paragraphs>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Value EvaluationMode="Auto">=Replace(Replace(Code.GetData(2,1), "%1", Globals!PageNumber), "%2", Globals!TotalPages)</Value>
                      <Style>
                        <FontStyle>Normal</FontStyle>
                        <FontFamily>Segoe UI</FontFamily>
                        <FontSize>8pt</FontSize>
                      </Style>
                    </TextRun>
                  </TextRuns>
                  <Style>
                    <TextAlign>Right</TextAlign>
                  </Style>
                </Paragraph>
              </Paragraphs>
              <Top>0.72472cm</Top>
              <Left>13.58771cm</Left>
              <Height>11pt</Height>
              <Width>5.81359cm</Width>
              <ZIndex>13</ZIndex>
              <Style />
            </Textbox>
            <Textbox Name="ItemPriceEstimateCaption">
              <KeepTogether>true</KeepTogether>
              <Paragraphs>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Value EvaluationMode="Auto">=Parameters!ItemPriceEstimate.Value</Value>
                      <Style>
                        <FontStyle>Normal</FontStyle>
                        <FontFamily>Segoe UI</FontFamily>
                        <FontSize>14pt</FontSize>
                        <FontWeight>Bold</FontWeight>
                      </Style>
                    </TextRun>
                  </TextRuns>
                  <Style>
                    <TextAlign>Left</TextAlign>
                  </Style>
                </Paragraph>
              </Paragraphs>
              <Top>0.01915cm</Top>
              <Height>20pt</Height>
              <Width>19.42272cm</Width>
              <ZIndex>14</ZIndex>
              <Style>
                <Border>
                  <Style>None</Style>
                </Border>
                <VerticalAlign>Middle</VerticalAlign>
              </Style>
            </Textbox>
            <Textbox Name="UserId">
              <CanGrow>true</CanGrow>
              <KeepTogether>true</KeepTogether>
              <Paragraphs>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Value EvaluationMode="Auto">=User!UserID</Value>
                      <Style>
                        <FontFamily>Segoe UI</FontFamily>
                        <FontSize>8pt</FontSize>
                      </Style>
                    </TextRun>
                  </TextRuns>
                  <Style>
                    <TextAlign>Right</TextAlign>
                  </Style>
                </Paragraph>
              </Paragraphs>
              <Top>1.11277cm</Top>
              <Left>13.58771cm</Left>
              <Height>10pt</Height>
              <Width>5.85759cm</Width>
              <ZIndex>15</ZIndex>
              <Style>
                <Border>
                  <Style>None</Style>
                </Border>
              </Style>
            </Textbox>
            <Textbox Name="CalcDate_PriceCalcHeadCaption">
              <KeepTogether>true</KeepTogether>
              <Paragraphs>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Value EvaluationMode="Auto">=Parameters!CalcDate_PriceCalcHeadCaption.Value ''</Value>
                      <Style>
                        <FontStyle>Normal</FontStyle>
                        <FontFamily>Segoe UI</FontFamily>
                        <FontSize>8pt</FontSize>
                      </Style>
                    </TextRun>
                  </TextRuns>
                  <Style>
                    <TextAlign>Right</TextAlign>
                  </Style>
                </Paragraph>
              </Paragraphs>
              <Top>3.4411cm</Top>
              <Left>13.58771cm</Left>
              <Height>11pt</Height>
              <Width>3.26472cm</Width>
              <ZIndex>16</ZIndex>
              <Style>
                <Border>
                  <Style>None</Style>
                </Border>
                <VerticalAlign>Middle</VerticalAlign>
              </Style>
            </Textbox>
            <Textbox Name="Locked_PriceCalcHeadCaption">
              <KeepTogether>true</KeepTogether>
              <Paragraphs>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Value EvaluationMode="Auto">=Parameters!Locked_PriceCalcHeadCaption.Value ''</Value>
                      <Style>
                        <FontStyle>Normal</FontStyle>
                        <FontFamily>Segoe UI</FontFamily>
                        <FontSize>8pt</FontSize>
                      </Style>
                    </TextRun>
                  </TextRuns>
                  <Style>
                    <TextAlign>Right</TextAlign>
                  </Style>
                </Paragraph>
              </Paragraphs>
              <Top>3.82916cm</Top>
              <Left>13.58771cm</Left>
              <Height>11pt</Height>
              <Width>3.26472cm</Width>
              <ZIndex>17</ZIndex>
              <Style>
                <Border>
                  <Style>None</Style>
                </Border>
                <VerticalAlign>Middle</VerticalAlign>
              </Style>
            </Textbox>
            <Textbox Name="TotAdditionalCost_PriceCalcHead">
              <KeepTogether>true</KeepTogether>
              <Paragraphs>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Value EvaluationMode="Auto">=Code.GetData(9,1) ''</Value>
                      <Style>
                        <FontStyle>Normal</FontStyle>
                        <FontFamily>Segoe UI</FontFamily>
                        <FontSize>8pt</FontSize>
                        <Format>=First(Fields!TotAdditionalCost_PriceCalcHeadFormat.Value, "DataSet_Result")</Format>
                      </Style>
                    </TextRun>
                  </TextRuns>
                  <Style />
                </Paragraph>
              </Paragraphs>
              <Top>3.05304cm</Top>
              <Left>3.62272cm</Left>
              <Height>11pt</Height>
              <Width>3.62272cm</Width>
              <ZIndex>18</ZIndex>
              <Style>
                <Border>
                  <Style>None</Style>
                </Border>
                <VerticalAlign>Middle</VerticalAlign>
              </Style>
            </Textbox>
            <Textbox Name="TotCapacitycost_PriceCalcHead">
              <KeepTogether>true</KeepTogether>
              <Paragraphs>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Value EvaluationMode="Auto">=Code.GetData(8,1) ''</Value>
                      <Style>
                        <FontStyle>Normal</FontStyle>
                        <FontFamily>Segoe UI</FontFamily>
                        <FontSize>8pt</FontSize>
                        <Format>=First(Fields!TotCapacitycost_PriceCalcHeadFormat.Value, "DataSet_Result")</Format>
                      </Style>
                    </TextRun>
                  </TextRuns>
                  <Style />
                </Paragraph>
              </Paragraphs>
              <Top>2.66498cm</Top>
              <Left>3.62272cm</Left>
              <Height>11pt</Height>
              <Width>3.62272cm</Width>
              <ZIndex>19</ZIndex>
              <Style>
                <Border>
                  <Style>None</Style>
                </Border>
                <VerticalAlign>Middle</VerticalAlign>
              </Style>
            </Textbox>
            <Textbox Name="TotCost_PriceCalcHead">
              <KeepTogether>true</KeepTogether>
              <Paragraphs>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Value EvaluationMode="Auto">=Code.GetData(19,1) ''</Value>
                      <Style>
                        <FontStyle>Normal</FontStyle>
                        <FontFamily>Segoe UI</FontFamily>
                        <FontSize>8pt</FontSize>
                        <Format>=First(Fields!TotCost_PriceCalcHeadFormat.Value, "DataSet_Result")</Format>
                      </Style>
                    </TextRun>
                  </TextRuns>
                  <Style />
                </Paragraph>
              </Paragraphs>
              <Top>3.44109cm</Top>
              <Left>3.62272cm</Left>
              <Height>11pt</Height>
              <Width>3.62272cm</Width>
              <ZIndex>20</ZIndex>
              <Style>
                <Border>
                  <Style>None</Style>
                </Border>
                <VerticalAlign>Middle</VerticalAlign>
              </Style>
            </Textbox>
            <Textbox Name="TotMaterialcost_PriceCalcHead">
              <KeepTogether>true</KeepTogether>
              <Paragraphs>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Value EvaluationMode="Auto">=Code.GetData(7,1) ''</Value>
                      <Style>
                        <FontStyle>Normal</FontStyle>
                        <FontFamily>Segoe UI</FontFamily>
                        <FontSize>8pt</FontSize>
                        <Format>=First(Fields!TotMaterialcost_PriceCalcHeadFormat.Value, "DataSet_Result")</Format>
                      </Style>
                    </TextRun>
                  </TextRuns>
                  <Style />
                </Paragraph>
              </Paragraphs>
              <Top>2.27693cm</Top>
              <Left>3.62272cm</Left>
              <Height>11pt</Height>
              <Width>3.62271cm</Width>
              <ZIndex>21</ZIndex>
              <Style>
                <Border>
                  <Style>None</Style>
                </Border>
                <VerticalAlign>Middle</VerticalAlign>
              </Style>
            </Textbox>
            <Textbox Name="Orderquantity_PriceCalcHead">
              <KeepTogether>true</KeepTogether>
              <Paragraphs>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Value EvaluationMode="Auto">=Code.GetData(6,1) ''</Value>
                      <Style>
                        <FontStyle>Normal</FontStyle>
                        <FontFamily>Segoe UI</FontFamily>
                        <FontSize>8pt</FontSize>
                        <Format>0.00;(0.00)</Format>
                      </Style>
                    </TextRun>
                  </TextRuns>
                  <Style />
                </Paragraph>
              </Paragraphs>
              <Top>1.88887cm</Top>
              <Left>3.62272cm</Left>
              <Height>11pt</Height>
              <Width>3.62272cm</Width>
              <ZIndex>22</ZIndex>
              <Style>
                <Border>
                  <Style>None</Style>
                </Border>
                <VerticalAlign>Middle</VerticalAlign>
              </Style>
            </Textbox>
            <Textbox Name="ItemDescription_PriceCalcHead">
              <KeepTogether>true</KeepTogether>
              <Paragraphs>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Value EvaluationMode="Auto">=Code.GetData(5,1) ''</Value>
                      <Style>
                        <FontStyle>Normal</FontStyle>
                        <FontFamily>Segoe UI</FontFamily>
                        <FontSize>8pt</FontSize>
                      </Style>
                    </TextRun>
                  </TextRuns>
                  <Style />
                </Paragraph>
              </Paragraphs>
              <Top>1.50082cm</Top>
              <Left>3.62272cm</Left>
              <Height>11pt</Height>
              <Width>3.62272cm</Width>
              <ZIndex>23</ZIndex>
              <Style>
                <Border>
                  <Style>None</Style>
                </Border>
                <VerticalAlign>Middle</VerticalAlign>
              </Style>
            </Textbox>
            <Textbox Name="ItemNo_PriceCalcHead">
              <KeepTogether>true</KeepTogether>
              <Paragraphs>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Value EvaluationMode="Auto">=Code.GetData(4,1) ''</Value>
                      <Style>
                        <FontStyle>Normal</FontStyle>
                        <FontFamily>Segoe UI</FontFamily>
                        <FontSize>8pt</FontSize>
                      </Style>
                    </TextRun>
                  </TextRuns>
                  <Style />
                </Paragraph>
              </Paragraphs>
              <Top>1.11276cm</Top>
              <Left>3.62272cm</Left>
              <Height>11pt</Height>
              <Width>3.62272cm</Width>
              <ZIndex>24</ZIndex>
              <Style>
                <Border>
                  <Style>None</Style>
                </Border>
                <VerticalAlign>Middle</VerticalAlign>
              </Style>
            </Textbox>
            <Textbox Name="CalcNo_PriceCalcHead">
              <KeepTogether>true</KeepTogether>
              <Paragraphs>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Value EvaluationMode="Auto">=Code.GetData(1,1) ''</Value>
                      <Style>
                        <FontStyle>Normal</FontStyle>
                        <FontFamily>Segoe UI</FontFamily>
                        <FontSize>8pt</FontSize>
                      </Style>
                    </TextRun>
                  </TextRuns>
                  <Style />
                </Paragraph>
              </Paragraphs>
              <Top>0.72471cm</Top>
              <Left>3.62272cm</Left>
              <Height>11pt</Height>
              <Width>3.62272cm</Width>
              <ZIndex>25</ZIndex>
              <Style>
                <Border>
                  <Style>None</Style>
                </Border>
                <VerticalAlign>Middle</VerticalAlign>
              </Style>
            </Textbox>
            <Textbox Name="ExecutionTime2">
              <KeepTogether>true</KeepTogether>
              <Paragraphs>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Value EvaluationMode="Auto">=Code.GetData(3,1)</Value>
                      <Style>
                        <FontStyle>Normal</FontStyle>
                        <FontFamily>Segoe UI</FontFamily>
                        <FontSize>8pt</FontSize>
                      </Style>
                    </TextRun>
                  </TextRuns>
                  <Style>
                    <TextAlign>Right</TextAlign>
                  </Style>
                </Paragraph>
              </Paragraphs>
              <Top>1.88888cm</Top>
              <Left>13.58771cm</Left>
              <Height>11pt</Height>
              <Width>5.81359cm</Width>
              <ZIndex>26</ZIndex>
              <Style>
                <Border>
                  <Style>None</Style>
                </Border>
                <VerticalAlign>Middle</VerticalAlign>
              </Style>
            </Textbox>
            <Textbox Name="CalcFactor_PriceCalcHeadCaption">
              <KeepTogether>true</KeepTogether>
              <Paragraphs>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Value EvaluationMode="Auto">=Parameters!CalcFactor_PriceCalcHeadCaption.Value ''</Value>
                      <Style>
                        <FontStyle>Normal</FontStyle>
                        <FontFamily>Segoe UI</FontFamily>
                        <FontSize>8pt</FontSize>
                      </Style>
                    </TextRun>
                  </TextRuns>
                  <Style />
                </Paragraph>
              </Paragraphs>
              <Top>3.86442cm</Top>
              <Left>0cm</Left>
              <Height>11pt</Height>
              <Width>3.62272cm</Width>
              <ZIndex>27</ZIndex>
              <Style>
                <Border>
                  <Style>None</Style>
                </Border>
                <VerticalAlign>Middle</VerticalAlign>
              </Style>
            </Textbox>
            <Textbox Name="Salesprice_PriceCalcHeadCaption">
              <KeepTogether>true</KeepTogether>
              <Paragraphs>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Value EvaluationMode="Auto">=Parameters!Salesprice_PriceCalcHeadCaption.Value ''</Value>
                      <Style>
                        <FontStyle>Normal</FontStyle>
                        <FontFamily>Segoe UI</FontFamily>
                        <FontSize>8pt</FontSize>
                      </Style>
                    </TextRun>
                  </TextRuns>
                  <Style />
                </Paragraph>
              </Paragraphs>
              <Top>4.25247cm</Top>
              <Left>0cm</Left>
              <Height>11pt</Height>
              <Width>3.62272cm</Width>
              <ZIndex>28</ZIndex>
              <Style>
                <Border>
                  <Style>None</Style>
                </Border>
                <VerticalAlign>Middle</VerticalAlign>
              </Style>
            </Textbox>
            <Textbox Name="CalcFactor_PriceCalcHead">
              <KeepTogether>true</KeepTogether>
              <Paragraphs>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Value EvaluationMode="Auto">=Code.GetData(11,1) ''</Value>
                      <Style>
                        <FontStyle>Normal</FontStyle>
                        <FontFamily>Segoe UI</FontFamily>
                        <FontSize>8pt</FontSize>
                      </Style>
                    </TextRun>
                  </TextRuns>
                  <Style />
                </Paragraph>
              </Paragraphs>
              <Top>3.86442cm</Top>
              <Left>3.62272cm</Left>
              <Height>11pt</Height>
              <Width>3.62272cm</Width>
              <ZIndex>29</ZIndex>
              <Style>
                <Border>
                  <Style>None</Style>
                </Border>
                <VerticalAlign>Middle</VerticalAlign>
              </Style>
            </Textbox>
            <Textbox Name="Salesprice_PriceCalcHead">
              <KeepTogether>true</KeepTogether>
              <Paragraphs>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Value EvaluationMode="Auto">=Code.GetData(12,1) ''</Value>
                      <Style>
                        <FontStyle>Normal</FontStyle>
                        <FontFamily>Segoe UI</FontFamily>
                        <FontSize>8pt</FontSize>
                        <Format>=First(Fields!Salesprice_PriceCalcHeadFormat.Value, "DataSet_Result")</Format>
                      </Style>
                    </TextRun>
                  </TextRuns>
                  <Style />
                </Paragraph>
              </Paragraphs>
              <Top>4.25247cm</Top>
              <Left>3.62272cm</Left>
              <Height>11pt</Height>
              <Width>3.62272cm</Width>
              <ZIndex>30</ZIndex>
              <Style>
                <Border>
                  <Style>None</Style>
                </Border>
                <VerticalAlign>Middle</VerticalAlign>
              </Style>
            </Textbox>
            <Textbox Name="Lotsizenoofpcs_PriceCalcHeadCaption">
              <KeepTogether>true</KeepTogether>
              <Paragraphs>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Value EvaluationMode="Auto">=Parameters!Lotsizenoofpcs_PriceCalcHeadCaption.Value ''</Value>
                      <Style>
                        <FontStyle>Normal</FontStyle>
                        <FontFamily>Segoe UI</FontFamily>
                        <FontSize>8pt</FontSize>
                      </Style>
                    </TextRun>
                  </TextRuns>
                  <Style />
                </Paragraph>
              </Paragraphs>
              <Top>4.67581cm</Top>
              <Left>0cm</Left>
              <Height>11pt</Height>
              <Width>3.62272cm</Width>
              <ZIndex>31</ZIndex>
              <Style>
                <Border>
                  <Style>None</Style>
                </Border>
                <VerticalAlign>Middle</VerticalAlign>
              </Style>
            </Textbox>
            <Textbox Name="Lotsizenoofpcs_PriceCalcHead">
              <KeepTogether>true</KeepTogether>
              <Paragraphs>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Value EvaluationMode="Auto">=Code.GetData(13,1) ''</Value>
                      <Style>
                        <FontStyle>Normal</FontStyle>
                        <FontFamily>Segoe UI</FontFamily>
                        <FontSize>8pt</FontSize>
                      </Style>
                    </TextRun>
                  </TextRuns>
                  <Style />
                </Paragraph>
              </Paragraphs>
              <Top>4.67581cm</Top>
              <Left>3.62272cm</Left>
              <Height>11pt</Height>
              <Width>3.62272cm</Width>
              <ZIndex>32</ZIndex>
              <Style>
                <Border>
                  <Style>None</Style>
                </Border>
                <VerticalAlign>Middle</VerticalAlign>
              </Style>
            </Textbox>
          </ReportItems>
          <Style>
            <Border>
              <Style>None</Style>
            </Border>
          </Style>
        </PageHeader>
        <PageHeight>29.7cm</PageHeight>
        <PageWidth>21cm</PageWidth>
        <LeftMargin>0cm</LeftMargin>
        <RightMargin>0cm</RightMargin>
        <TopMargin>0cm</TopMargin>
        <BottomMargin>0cm</BottomMargin>
        <ColumnSpacing>1.27cm</ColumnSpacing>
        <Style />
      </Page>
    </ReportSection>
  </ReportSections>
  <ReportParameters>
    <ReportParameter Name="CalcNo_PriceCalcHeadCaption">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>CalcNo_PriceCalcHeadCaption</Value>
        </Values>
      </DefaultValue>
      <Prompt>CalcNo_PriceCalcHeadCaption</Prompt>
    </ReportParameter>
    <ReportParameter Name="ItemNo_PriceCalcHeadCaption">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>ItemNo_PriceCalcHeadCaption</Value>
        </Values>
      </DefaultValue>
      <Prompt>ItemNo_PriceCalcHeadCaption</Prompt>
    </ReportParameter>
    <ReportParameter Name="ItemDescription_PriceCalcHeadCaption">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>ItemDescription_PriceCalcHeadCaption</Value>
        </Values>
      </DefaultValue>
      <Prompt>ItemDescription_PriceCalcHeadCaption</Prompt>
    </ReportParameter>
    <ReportParameter Name="CalcDate_PriceCalcHeadCaption">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>CalcDate_PriceCalcHeadCaption</Value>
        </Values>
      </DefaultValue>
      <Prompt>CalcDate_PriceCalcHeadCaption</Prompt>
    </ReportParameter>
    <ReportParameter Name="Calcby_PriceCalcHeadCaption">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>Calcby_PriceCalcHeadCaption</Value>
        </Values>
      </DefaultValue>
      <Prompt>Calcby_PriceCalcHeadCaption</Prompt>
    </ReportParameter>
    <ReportParameter Name="TotMaterialcost_PriceCalcHeadCaption">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>TotMaterialcost_PriceCalcHeadCaption</Value>
        </Values>
      </DefaultValue>
      <Prompt>TotMaterialcost_PriceCalcHeadCaption</Prompt>
    </ReportParameter>
    <ReportParameter Name="TotCapacitycost_PriceCalcHeadCaption">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>TotCapacitycost_PriceCalcHeadCaption</Value>
        </Values>
      </DefaultValue>
      <Prompt>TotCapacitycost_PriceCalcHeadCaption</Prompt>
    </ReportParameter>
    <ReportParameter Name="TotAdditionalCost_PriceCalcHeadCaption">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>TotAdditionalCost_PriceCalcHeadCaption</Value>
        </Values>
      </DefaultValue>
      <Prompt>TotAdditionalCost_PriceCalcHeadCaption</Prompt>
    </ReportParameter>
    <ReportParameter Name="Salesprice_PriceCalcHeadCaption">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>Salesprice_PriceCalcHeadCaption</Value>
        </Values>
      </DefaultValue>
      <Prompt>Salesprice_PriceCalcHeadCaption</Prompt>
    </ReportParameter>
    <ReportParameter Name="CalcFactor_PriceCalcHeadCaption">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>CalcFactor_PriceCalcHeadCaption</Value>
        </Values>
      </DefaultValue>
      <Prompt>CalcFactor_PriceCalcHeadCaption</Prompt>
    </ReportParameter>
    <ReportParameter Name="TotCost_PriceCalcHeadCaption">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>TotCost_PriceCalcHeadCaption</Value>
        </Values>
      </DefaultValue>
      <Prompt>TotCost_PriceCalcHeadCaption</Prompt>
    </ReportParameter>
    <ReportParameter Name="Lotsizenoofpcs_PriceCalcHeadCaption">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>Lotsizenoofpcs_PriceCalcHeadCaption</Value>
        </Values>
      </DefaultValue>
      <Prompt>Lotsizenoofpcs_PriceCalcHeadCaption</Prompt>
    </ReportParameter>
    <ReportParameter Name="CalculationMethod_PriceCalcHeadCaption">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>CalculationMethod_PriceCalcHeadCaption</Value>
        </Values>
      </DefaultValue>
      <Prompt>CalculationMethod_PriceCalcHeadCaption</Prompt>
    </ReportParameter>
    <ReportParameter Name="Orderquantity_PriceCalcHeadCaption">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>Orderquantity_PriceCalcHeadCaption</Value>
        </Values>
      </DefaultValue>
      <Prompt>Orderquantity_PriceCalcHeadCaption</Prompt>
    </ReportParameter>
    <ReportParameter Name="Locked_PriceCalcHeadCaption">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>Locked_PriceCalcHeadCaption</Value>
        </Values>
      </DefaultValue>
      <Prompt>Locked_PriceCalcHeadCaption</Prompt>
    </ReportParameter>
    <ReportParameter Name="Projectcode_PriceCalcHeadCaption">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>Projectcode_PriceCalcHeadCaption</Value>
        </Values>
      </DefaultValue>
      <Prompt>Projectcode_PriceCalcHeadCaption</Prompt>
    </ReportParameter>
    <ReportParameter Name="Variantcode_PriceCalcHeadCaption">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>Variantcode_PriceCalcHeadCaption</Value>
        </Values>
      </DefaultValue>
      <Prompt>Variantcode_PriceCalcHeadCaption</Prompt>
    </ReportParameter>
    <ReportParameter Name="CalcNo_PriceCalcLinesCaption">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>CalcNo_PriceCalcLinesCaption</Value>
        </Values>
      </DefaultValue>
      <Prompt>CalcNo_PriceCalcLinesCaption</Prompt>
    </ReportParameter>
    <ReportParameter Name="Type_PriceCalcLinesCaption">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>Type_PriceCalcLinesCaption</Value>
        </Values>
      </DefaultValue>
      <Prompt>Type_PriceCalcLinesCaption</Prompt>
    </ReportParameter>
    <ReportParameter Name="SequenceNo_PriceCalcLinesCaption">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>SequenceNo_PriceCalcLinesCaption</Value>
        </Values>
      </DefaultValue>
      <Prompt>SequenceNo_PriceCalcLinesCaption</Prompt>
    </ReportParameter>
    <ReportParameter Name="No_PriceCalcLinesCaption">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>No_PriceCalcLinesCaption</Value>
        </Values>
      </DefaultValue>
      <Prompt>No_PriceCalcLinesCaption</Prompt>
    </ReportParameter>
    <ReportParameter Name="Description_PriceCalcLinesCaption">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>Description_PriceCalcLinesCaption</Value>
        </Values>
      </DefaultValue>
      <Prompt>Description_PriceCalcLinesCaption</Prompt>
    </ReportParameter>
    <ReportParameter Name="Quantity_PriceCalcLinesCaption">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>Quantity_PriceCalcLinesCaption</Value>
        </Values>
      </DefaultValue>
      <Prompt>Quantity_PriceCalcLinesCaption</Prompt>
    </ReportParameter>
    <ReportParameter Name="UnitofMeasure_PriceCalcLinesCaption">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>UnitofMeasure_PriceCalcLinesCaption</Value>
        </Values>
      </DefaultValue>
      <Prompt>UnitofMeasure_PriceCalcLinesCaption</Prompt>
    </ReportParameter>
    <ReportParameter Name="UnitCost_PriceCalcLinesCaption">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>UnitCost_PriceCalcLinesCaption</Value>
        </Values>
      </DefaultValue>
      <Prompt>UnitCost_PriceCalcLinesCaption</Prompt>
    </ReportParameter>
    <ReportParameter Name="LineAmount_PriceCalcLinesCaption">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>LineAmount_PriceCalcLinesCaption</Value>
        </Values>
      </DefaultValue>
      <Prompt>LineAmount_PriceCalcLinesCaption</Prompt>
    </ReportParameter>
    <ReportParameter Name="Projectcode_PriceCalcLinesCaption">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>Projectcode_PriceCalcLinesCaption</Value>
        </Values>
      </DefaultValue>
      <Prompt>Projectcode_PriceCalcLinesCaption</Prompt>
    </ReportParameter>
    <ReportParameter Name="Variantcode_PriceCalcLinesCaption">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>Variantcode_PriceCalcLinesCaption</Value>
        </Values>
      </DefaultValue>
      <Prompt>Variantcode_PriceCalcLinesCaption</Prompt>
    </ReportParameter>
    <ReportParameter Name="VendorNo_PriceCalcLinesCaption">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>VendorNo_PriceCalcLinesCaption</Value>
        </Values>
      </DefaultValue>
      <Prompt>VendorNo_PriceCalcLinesCaption</Prompt>
    </ReportParameter>
    <ReportParameter Name="SystemCreated_PriceCalcLinesCaption">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>SystemCreated_PriceCalcLinesCaption</Value>
        </Values>
      </DefaultValue>
      <Prompt>SystemCreated_PriceCalcLinesCaption</Prompt>
    </ReportParameter>
    <ReportParameter Name="WorkCenter_PriceCalcLinesCaption">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>WorkCenter_PriceCalcLinesCaption</Value>
        </Values>
      </DefaultValue>
      <Prompt>WorkCenter_PriceCalcLinesCaption</Prompt>
    </ReportParameter>
    <ReportParameter Name="Activitytype_PriceCalcLinesCaption">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>Activitytype_PriceCalcLinesCaption</Value>
        </Values>
      </DefaultValue>
      <Prompt>Activitytype_PriceCalcLinesCaption</Prompt>
    </ReportParameter>
    <ReportParameter Name="Purchasestatus_PriceCalcLinesCaption">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>Purchasestatus_PriceCalcLinesCaption</Value>
        </Values>
      </DefaultValue>
      <Prompt>Purchasestatus_PriceCalcLinesCaption</Prompt>
    </ReportParameter>
    <ReportParameter Name="PurchaseDocumentNo_PriceCalcLinesCaption">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>PurchaseDocumentNo_PriceCalcLinesCaption</Value>
        </Values>
      </DefaultValue>
      <Prompt>PurchaseDocumentNo_PriceCalcLinesCaption</Prompt>
    </ReportParameter>
    <ReportParameter Name="Purchaselineno_PriceCalcLinesCaption">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>Purchaselineno_PriceCalcLinesCaption</Value>
        </Values>
      </DefaultValue>
      <Prompt>Purchaselineno_PriceCalcLinesCaption</Prompt>
    </ReportParameter>
    <ReportParameter Name="Purchaseprice_PriceCalcLinesCaption">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>Purchaseprice_PriceCalcLinesCaption</Value>
        </Values>
      </DefaultValue>
      <Prompt>Purchaseprice_PriceCalcLinesCaption</Prompt>
    </ReportParameter>
    <ReportParameter Name="ItemPriceEstimate">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>ItemPriceEstimate</Value>
        </Values>
      </DefaultValue>
      <Prompt>ItemPriceEstimate</Prompt>
    </ReportParameter>
    <ReportParameter Name="PageCaption">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>PageCaption</Value>
        </Values>
      </DefaultValue>
      <Prompt>PageCaption</Prompt>
    </ReportParameter>
  </ReportParameters>
  <Code>Public Function BlankZero(ByVal Value As Decimal)
    if Value = 0 then
        Return ""
    end if
    Return Value
End Function

Public Function BlankPos(ByVal Value As Decimal)
    if Value &gt; 0 then
        Return ""
    end if
    Return Value
End Function

Public Function BlankZeroAndPos(ByVal Value As Decimal)
    if Value &gt;= 0 then
        Return ""
    end if
    Return Value
End Function

Public Function BlankNeg(ByVal Value As Decimal)
    if Value &lt; 0 then
        Return ""
    end if
    Return Value
End Function

Public Function BlankNegAndZero(ByVal Value As Decimal)
    if Value &lt;= 0 then
        Return ""
    end if
    Return Value
End Function
Shared Data1 as Object
Shared Data2 as Object
Shared Data3 as Object
Shared Data4 as Object
Shared Data5 as Object
Shared Data6 as Object
Shared Data7 as Object

Public Function GetData(Num as Integer, Group as integer) as Object
if Group = 1 then
   Return Cstr(Choose(Num, Split(Cstr(Data1),Chr(177))))
End If

if Group = 2 then
   Return Cstr(Choose(Num, Split(Cstr(Data2),Chr(177))))
End If

if Group = 3 then
   Return Cstr(Choose(Num, Split(Cstr(Data3),Chr(177))))
End If
if Group = 4 then
   Return Cstr(Choose(Num, Split(Cstr(Data4),Chr(177))))
End If

if Group = 5 then
   Return Cstr(Choose(Num, Split(Cstr(Data5),Chr(177))))
End If
if Group = 6 then
   Return Cstr(Choose(Num, Split(Cstr(Data6),Chr(177))))
End If

if Group = 7 then
   Return Cstr(Choose(Num, Split(Cstr(Data7),Chr(177))))
End If
End Function

Public Function SetData(NewData as Object,Group as integer)
  If Group = 1 and NewData &gt; "" Then
      Data1 = NewData
  End If

  If Group = 2 and NewData &gt; "" Then
      Data2 = NewData
  End If

  If Group = 3 and NewData &gt; "" Then
      Data3 = NewData
End If

  If Group = 4 and NewData &gt; "" Then
      Data4 = NewData
  End If

If Group = 5 and NewData &gt; "" Then
      Data5 = NewData
  End If

If Group = 6 and NewData &gt; "" Then
      Data6 = NewData
  End If

If Group = 7 and NewData &gt; "" Then
      Data7 = NewData
  End If
End Function

</Code>
  <Language>=User!Language</Language>
  <ConsumeContainerWhitespace>true</ConsumeContainerWhitespace>
  <rd:ReportUnitType>Cm</rd:ReportUnitType>
  <rd:ReportID>0eeb6585-38ae-40f1-885b-8d50088d51b4</rd:ReportID>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Codeunit 73050 Item Calculation
{
  OBJECT-PROPERTIES
  {
    Date=08.09.17;
    Time=14.48.47;
    Modified=Yes;
    Version List=ICA2.01;
  }
  PROPERTIES
  {
    OnRun=VAR
            Salgslinjen@1101103000 : Record 37;
          BEGIN
          END;

  }
  CODE
  {

    LOCAL PROCEDURE GetSalesHeader@1(VAR SalesLineP@1101103001 : Record 37;VAR SalesHeaderP@1101103000 : Record 36);
    BEGIN
      //Function is copied from TAB37.
      SalesLineP.TESTFIELD("Document No.");
      IF (SalesLineP ."Document Type" <> SalesHeaderP."Document Type") OR (SalesLineP."Document No." <> SalesHeaderP."No.") THEN BEGIN
        SalesHeaderP.GET(SalesLineP."Document Type",SalesLineP."Document No.");
        IF SalesHeaderP."Currency Code" <> '' THEN
          SalesHeaderP.TESTFIELD("Currency Factor");
      END;
    END;

    LOCAL PROCEDURE RunPriceCalculationPage@1101103006(VAR SalesLineP@1101103000 : Record 37);
    VAR
      PriceCalcHeadL@1101103002 : Record 73051;
      PageManagementL@1101103001 : Codeunit 700;
    BEGIN
      IF SalesLineP.Type = SalesLineP.Type::Item THEN BEGIN
        //PriceCalcHeadL.SETRANGE("Item No.", Rec."No.");
        PAGE.RUN(PageManagementL.GetDefaultLookupPageID(DATABASE::"Item Calc. Header"), PriceCalcHeadL) ;
      END;
    END;

    LOCAL PROCEDURE TransferRoutingCalc@1000000001(VAR CalculateProdOrderP@1101103003 : Codeunit 99000773;VAR ProdOrderLineP@1101103000 : Record 5406);
    VAR
      RtngHeader@1000 : Record 99000763;
      ProdOrderRtngLine@1002 : Record 5409;
      WorkCenter@1003 : Record 99000754;
      MachineCenter@1004 : Record 99000758;
      CalcLines@1000000000 : Record 73052;
      CostCalcMgtL@1101103002 : Codeunit 5836;
      OperationNoL@1101103001 : Integer;
    BEGIN
      IF ProdOrderLineP."Routing No." = '' THEN
        EXIT;

      RtngHeader.GET(ProdOrderLineP."Routing No.");

      ProdOrderRtngLine.SETRANGE(Status, ProdOrderLineP.Status);
      ProdOrderRtngLine.SETRANGE("Prod. Order No.", ProdOrderLineP."Prod. Order No.");
      ProdOrderRtngLine.SETRANGE("Routing Reference No.", ProdOrderLineP."Routing Reference No.");
      ProdOrderRtngLine.SETRANGE("Routing No.", ProdOrderLineP."Routing No.");
      IF ProdOrderRtngLine.FIND('-') THEN
        EXIT;

      OperationNoL := 0;

      CalcLines.SETRANGE("Calc. No.", ProdOrderLineP."Calculation No.");
      CalcLines.SETRANGE(Type, CalcLines.Type::Capacity);
      IF CalcLines.FIND('-') THEN
        REPEAT
          OperationNoL += 10;

          CalcLines.TESTFIELD("Work Center");
          CalcLines.TESTFIELD("Unit Cost");
          WorkCenter.GET(CalcLines."Work Center");

          ProdOrderRtngLine.INIT;
          ProdOrderRtngLine.Status := ProdOrderLineP.Status;
          ProdOrderRtngLine."Prod. Order No." := ProdOrderLineP."Prod. Order No.";
          ProdOrderRtngLine."Routing Reference No." := ProdOrderLineP."Routing Reference No.";
          ProdOrderRtngLine."Routing No." := ProdOrderLineP."Routing No.";
          ProdOrderRtngLine."Operation No." := FORMAT(OperationNoL);
          ProdOrderRtngLine."Next Operation No." := FORMAT(OperationNoL + 10);
          ProdOrderRtngLine."Previous Operation No." := FORMAT(OperationNoL - 10);
          //Sid.ojo 290507 --------->
          //JAL 05.09.17 ProdOrderRtngLine."Activity type" := CalcLines."Activity type";
          //<-------- Sid.ojo 290507
          ProdOrderRtngLine.Type := ProdOrderRtngLine.Type::"Work Center"; // ??
          ProdOrderRtngLine."No." := CalcLines."Work Center";
          ProdOrderRtngLine."Work Center No." := CalcLines."Work Center";
          ProdOrderRtngLine."Work Center Group Code" := WorkCenter."Work Center Group Code";
          ProdOrderRtngLine.Description := CalcLines.Description;

          //hhe 4.2.13 -> IF (CalcLines."Work Center" = 'VIAS 1') OR (CalcLines."Work Center" = 'VIAS 2') THEN
          IF WorkCenter."Subcontractor No." = '' THEN
          //hhe 4.2.13<-
            ProdOrderRtngLine."Setup Time" := CalcLines.Quantity
          ELSE
            ProdOrderRtngLine."Setup Time" := 0;

          ProdOrderRtngLine."Run Time" := 0;
          ProdOrderRtngLine."Wait Time" := 0;
          ProdOrderRtngLine."Move Time" := 0;
          ProdOrderRtngLine."Fixed Scrap Quantity" := 0;
          ProdOrderRtngLine."Lot Size" :=  0;
          ProdOrderRtngLine."Scrap Factor %" := 0;
          ProdOrderRtngLine."Minimum Process Time" := 0;
          ProdOrderRtngLine."Maximum Process Time" := 0;
          ProdOrderRtngLine."Concurrent Capacities" := 0;
          IF ProdOrderRtngLine."Concurrent Capacities" = 0 THEN
            ProdOrderRtngLine."Concurrent Capacities" := 1;
          ProdOrderRtngLine."Send-Ahead Quantity" := 0;
          ProdOrderRtngLine."Setup Time Unit of Meas. Code" := CalcLines."Unit of Measure";
          ProdOrderRtngLine."Run Time Unit of Meas. Code" := CalcLines."Unit of Measure";
          ProdOrderRtngLine."Wait Time Unit of Meas. Code" := CalcLines."Unit of Measure";
          ProdOrderRtngLine."Move Time Unit of Meas. Code" := CalcLines."Unit of Measure";
          ProdOrderRtngLine."Routing Link Code" := '';
          ProdOrderRtngLine."Standard Task Code" := '';
          ProdOrderRtngLine."Sequence No. (Forward)" := 0;
          ProdOrderRtngLine."Sequence No. (Backward)" := 0;
          ProdOrderRtngLine."Fixed Scrap Qty. (Accum.)" := 0;
          ProdOrderRtngLine."Scrap Factor % (Accumulated)" := 0;
          ProdOrderRtngLine."Unit Cost per" := CalcLines."Unit Cost";

          CostCalcMgtL.RoutingCostPerUnit(
            ProdOrderRtngLine.Type,
            ProdOrderRtngLine."No.",
            ProdOrderRtngLine."Direct Unit Cost",
            ProdOrderRtngLine."Indirect Cost %",
            ProdOrderRtngLine."Overhead Rate",
            ProdOrderRtngLine."Unit Cost per",
            ProdOrderRtngLine."Unit Cost Calculation");
          CASE ProdOrderRtngLine.Type OF
            ProdOrderRtngLine.Type::"Work Center":
              BEGIN
                  WorkCenter.GET(CalcLines."Work Center");
                  ProdOrderRtngLine."Flushing Method" := WorkCenter."Flushing Method";
               END;
            ProdOrderRtngLine.Type::"Machine Center":
              BEGIN
                MachineCenter.GET(ProdOrderRtngLine."No.");
                ProdOrderRtngLine."Flushing Method" := MachineCenter."Flushing Method";
              END;
          END;
          ProdOrderRtngLine.VALIDATE("Direct Unit Cost");
          ProdOrderRtngLine."Starting Time" := ProdOrderLineP."Starting Time";
          ProdOrderRtngLine."Starting Date" := ProdOrderLineP."Starting Date";
          ProdOrderRtngLine."Ending Time" := ProdOrderLineP."Ending Time";
          ProdOrderRtngLine."Ending Date" := ProdOrderLineP."Ending Date";
          ProdOrderRtngLine.UpdateDatetime;
          ProdOrderRtngLine.INSERT;
        UNTIL CalcLines.NEXT = 0;
      CalculateProdOrderP.TransferTaskInfo(ProdOrderRtngLine, ProdOrderLineP."Routing Version Code");
    END;

    [EventSubscriber(Table,37,OnAfterValidateEvent,"Calculation No.")]
    LOCAL PROCEDURE TAB37OnAfterValidateEventCalculationNo@1101103000(VAR Rec@1101103000 : Record 37;VAR xRec@1101103001 : Record 37;CurrFieldNo@1101103002 : Integer);
    VAR
      TXT001L@1101103003 : TextConst 'ENU=Transfer calculation price to sales line?;NOR=Vil du overf›re kalkylepris til salgslinje?';
      SalesHeaderL@1101103004 : Record 36;
      PriceCalcHeadL@1101103005 : Record 73051;
    BEGIN
      IF (Rec."Calculation No." <> '') THEN BEGIN
        IF CONFIRM(TXT001L) THEN BEGIN
          GetSalesHeader(Rec, SalesHeaderL);
          IF PriceCalcHeadL.GET(Rec."Calculation No.") THEN BEGIN
            IF SalesHeaderL."Currency Factor" = 0 THEN
              Rec.VALIDATE("Unit Price", PriceCalcHeadL."Sales Price")
            ELSE
              Rec.VALIDATE("Unit Price", ROUND((PriceCalcHeadL."Sales Price" * SalesHeaderL."Currency Factor"),1));
          END;
        END;
      END;
    END;

    [EventSubscriber(Page,46,OnAfterActionEvent,"Item Calculation")]
    LOCAL PROCEDURE PAG46OnAfterActionEventItemCalculation@1101103001(VAR Rec@1101103000 : Record 37);
    BEGIN
      RunPriceCalculationPage(Rec);
    END;

    [EventSubscriber(Page,95,OnAfterActionEvent,"Item Calculation")]
    LOCAL PROCEDURE PAG95OnAfterActionEventItemCalculation@1101103003(VAR Rec@1101103000 : Record 37);
    BEGIN
      RunPriceCalculationPage(Rec);
    END;

    [EventSubscriber(Codeunit,99000773,OnTransferRoutingCalc)]
    LOCAL PROCEDURE COD99000773OnTransferRoutingCalc@1101103002(VAR Sender@1101103000 : Codeunit 99000773;VAR ProdOrderLineP@1101103001 : Record 5406);
    BEGIN
      TransferRoutingCalc(Sender, ProdOrderLineP);
    END;

    [EventSubscriber(Codeunit,99000787,OnBeforeUpdateDatetime)]
    LOCAL PROCEDURE COD99000787OnBeforeUpdateDatetime@1101103004(VAR ProdOrderLineP@1101103000 : Record 5406;VAR SalesLineP@1101103001 : Record 37);
    BEGIN
      //hhe 23.06.05->
      IF SalesLineP."Calculation No." <>'' THEN
        ProdOrderLineP."Calculation No." := SalesLineP."Calculation No.";
      //hhe 23.06.05<-
    END;

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 08.02.17 JAL Events for Price Calculation
    }
    END.
  }
}

OBJECT Codeunit 91073 ICA Testing
{
  OBJECT-PROPERTIES
  {
    Date=08.09.17;
    Time=15.55.42;
    Modified=Yes;
    Version List=TST1.01,ICA2.01;
  }
  PROPERTIES
  {
    Subtype=Test;
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      LibraryUtilityG@1101103000 : Codeunit 131000;
      LibraryVariableStorageG@1101103003 : Codeunit 131004;
      LibrarySetupStorageG@1101103005 : Codeunit 131009;
      LibraryPlanningG@1101103009 : Codeunit 132203;
      LibraryRandomG@1101103011 : Codeunit 130440;
      AssertG@1101103002 : Codeunit 130000;
      LibraryUtilityIncG@1101103001 : Codeunit 91001;
      LibrarySalesIncG@1101103006 : Codeunit 91010;
      LibraryProductionIncG@1101103010 : Codeunit 91062;
      IsInitializedG@1101103004 : Boolean;
      DummyMessage@1101103007 : TextConst 'ENU=Message?';
      FirmPlannedProdOrderCreatedTxt@1101103008 : TextConst 'ENU=Firm Planned Prod. Order';

    LOCAL PROCEDURE Initialize@6();
    VAR
      LibraryERMCountryData@1000 : Codeunit 131305;
    BEGIN
      LibraryVariableStorageG.Clear;
      LibrarySetupStorageG.Restore;
      IF IsInitializedG THEN
        EXIT;
      InventorySetup();
      LibrarySetupStorageG.Save(DATABASE::"Inventory Setup");
      IsInitializedG := TRUE;
      COMMIT;
    END;

    [ConfirmHandler]
    PROCEDURE ConfirmHandler@19(Question@1000 : Text[1024];VAR Reply@1001 : Boolean);
    BEGIN
      Reply := TRUE;
    END;

    [MessageHandler]
    PROCEDURE MessageHandler@10(Message@1000 : Text[1024]);
    BEGIN
    END;

    LOCAL PROCEDURE ExecuteUIHandlers@1101103002();
    BEGIN
      MESSAGE('');
      IF CONFIRM(DummyMessage) THEN ;
    END;

    PROCEDURE InventorySetup@74();
    VAR
      InventorySetupL@1002 : Record 313;
    BEGIN
      IF NOT InventorySetupL.GET THEN
        InventorySetupL.INSERT;
      InventorySetupL.VALIDATE("Item Calculation Nos.",  LibraryUtilityIncG.GetNoSeriesCode('ICA'));
      InventorySetupL.MODIFY(TRUE);
    END;

    PROCEDURE CreateSalesOrderWithProdItems@12(VAR SalesHeaderP@1101103001 : Record 36;VAR SalesLineP@1101103000 : Record 37);
    BEGIN
      // Sales Order creation.
      // Create Sales Order.
      LibrarySalesIncG.CreateSalesOrderWithProdItems(SalesHeaderP, SalesLineP);
    END;

    [ModalPageHandler]
    PROCEDURE SalesOrderPlanningPageHandler@1101103008(VAR SalesOrderPlanningP@1000 : TestPage 99000883);
    VAR
      SalesPlanningLineL@1101103000 : TEMPORARY Record 99000800;
      NoL@1101103001 : Code[20];
    BEGIN
      SalesOrderPlanningP.Action25.INVOKE();
    END;

    [ModalPageHandler]
    PROCEDURE CreateOrderFromSalesModalPageHandler@182(VAR CreateOrderFromSales@1000 : Page 99000884;VAR Response@1001 : Action);
    BEGIN
      Response := ACTION::Yes;
    END;

    PROCEDURE CreateCalculationNoForSalesLine@1101103001(VAR SalesLineP@1101103000 : Record 37);
    VAR
      SalesLineL@1101103001 : Record 37;
    BEGIN
      SalesLineL.RESET;
      SalesLineL.SETRANGE("Document Type", SalesLineP."Document Type");
      SalesLineL.SETRANGE("Document No.", SalesLineP."Document No.");
      SalesLineL.FINDFIRST();
      REPEAT
        //GetRandomItemCalculationNoForSalesLine(SalesLineL);
        SalesLineL.VALIDATE("Calculation No.", CreateItemCalculationNo(SalesLineL."No."));
        SalesLineL.MODIFY(TRUE);
      UNTIL SalesLineL.NEXT = 0;
    END;

    PROCEDURE CreateItemCalculationNo@1101103005(ItemNoP@1101103000 : Code[20]) : Code[20];
    VAR
      PriceCalcHeadL@1101103001 : Record 73051;
    BEGIN
      PriceCalcHeadL.INIT();
      PriceCalcHeadL.VALIDATE("Order Quantity", LibraryRandomG.RandInt(200));
      PriceCalcHeadL.VALIDATE("Item No.", ItemNoP);
      PriceCalcHeadL.VALIDATE("Calc. Factor", LibraryRandomG.RandDecInRange(1, 2, 2));
      PriceCalcHeadL.INSERT(TRUE);
      EXIT(PriceCalcHeadL."No.");
    END;

    PROCEDURE GetRandomItemCalculationNoForSalesLine@1101103021(VAR SalesLineP@1101103000 : Record 37);
    VAR
      PriceCalcHeadL@1101103001 : Record 73051;
    BEGIN
      PriceCalcHeadL.SETRANGE("Item No.", SalesLineP."No.");
      PriceCalcHeadL.FINDSET;
      PriceCalcHeadL.NEXT(LibraryRandomG.RandIntInRange(0, (PriceCalcHeadL.COUNT - 1)));
      SalesLineP.VALIDATE("Calculation No.", PriceCalcHeadL."No.");
    END;

    PROCEDURE VerifyProductionOrderLine@78(Status@1001 : Option;ProductionOrderNo@1002 : Code[20];ItemNo@1003 : Code[20];Quantity@1004 : Decimal;LocationCode@1005 : Code[10];CalculationNoP@1101103000 : Code[20]);
    VAR
      ProdOrderLine@1000 : Record 5406;
    BEGIN
      LibraryProductionIncG.FindProductionOrderLine(ProdOrderLine,Status,ProductionOrderNo);
      ProdOrderLine.TESTFIELD("Item No.",ItemNo);
      ProdOrderLine.TESTFIELD(Quantity,Quantity);
      ProdOrderLine.TESTFIELD("Location Code",LocationCode);
      ProdOrderLine.TESTFIELD("Calculation No.", CalculationNoP);
    END;

    PROCEDURE VerifyProdOrderLineFromSalesLine@208(SalesLine@1000 : Record 37);
    VAR
      ProdOrder@1001 : Record 5405;
    BEGIN
      LibraryProductionIncG.FindProdOrderBySourceNo(ProdOrder,SalesLine."No.");
      VerifyProductionOrderLine(
        ProdOrder.Status,ProdOrder."No.",SalesLine."No.",SalesLine.Quantity,SalesLine."Location Code", SalesLine."Calculation No.");
    END;

    [Test]
    PROCEDURE TestInventorySetup@1101103003();
    VAR
      InventorySetupL@1101103000 : Record 313;
    BEGIN
      // [FEATURE] [Production] [Item Calculation]
      // [SCENARIO 1] Test Case Inventory Setup

      // [GIVEN] Stored test values are cleared.
      // [GIVEN] Inventory Setup exists
      Initialize();
      // [THEN] : the "Item Calculation Nos." has been defined
      InventorySetupL.GET();
      AssertG.AreNotEqual(InventorySetupL."Item Calculation Nos.", '', '');
    END;

    [Test]
    [HandlerFunctions(MessageHandler,ConfirmHandler,SalesOrderPlanningPageHandler,CreateOrderFromSalesModalPageHandler)]
    PROCEDURE UI_CreateSalesOrderWithProdItems@1101103000();
    VAR
      SalesOrderL@1101103000 : TestPage 42;
      SalesOrderPlanningL@1101103004 : TestPage 99000883;
      CreateOrderFromSalesL@1101103006 : TestPage 99000884;
      SalesHeaderL@1101103002 : Record 36;
      SalesLineL@1101103001 : Record 37;
      SalesLine2L@1101103003 : Record 37;
      ProductionOrderL@1101103005 : Record 5405;
    BEGIN
      // [FEATURE] [UI] [Sales Order] [Production] [Item Calculation]
      // [SCENARIO 382062] It is possible to get Posted Sales Credit Memo with item to reverse from new Sales Credit Memo

      // [GIVEN] Stored test values are cleared.
      Initialize();
      // [GIVEN] Sales Order exists
      CreateSalesOrderWithProdItems(SalesHeaderL, SalesLineL);
      // [GIVEN] Sales Order Line have "Calculation No." defined for item
      CreateCalculationNoForSalesLine(SalesLineL);
      // [GIVEN] Sales Order page is open
      SalesOrderL.OPENVIEW;
      // [GIVEN] The created Sales Order is selected.
      SalesOrderL.GOTORECORD(SalesHeaderL);
      AssertG.AreEqual(SalesOrderL."No.".VALUE, SalesHeaderL."No.",'');
      // [WHEN] "Sales Order Planning" is opened from "Sales Order" page
      SalesOrderL.Action121.INVOKE(); // Message handlers will control the flow
      // [THEN] Production Order is created.
      SalesLineL.RESET;
      SalesLineL.SETRANGE("Document Type", SalesLineL."Document Type"::Order);
      SalesLineL.SETRANGE("Document No.", SalesHeaderL."No.");
      SalesLineL.FINDFIRST;
      REPEAT
        // Verify: Calculation No." is not empty on the Sales Line
        AssertG.AreNotEqual(SalesLineL."Calculation No.", '', '');
        // Verify: Verify Created new Firm Planned Production Order.
        VerifyProdOrderLineFromSalesLine(SalesLineL);
      UNTIL SalesLineL.NEXT = 0;
      SalesOrderL.CLOSE();
    END;

    [Test]
    PROCEDURE TestCreateWorkCenterGroup@1101103004();
    VAR
      InventorySetupL@1101103000 : Record 313;
    BEGIN
      // [FEATURE] [Production] [Item Calculation]
      // [SCENARIO 2] Create Work Center Group

      // [GIVEN] Work Center is Created

      // [THEN] : the "Item Calculation Nos." has been defined
      InventorySetupL.GET();
      AssertG.AreNotEqual(InventorySetupL."Item Calculation Nos.", '', '');
    END;

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 18.08.17 JAL Common Incadea functions for testing
    }
    END.
  }
}

OBJECT Codeunit 99000773 Calculate Prod. Order
{
  OBJECT-PROPERTIES
  {
    Date=05.09.17;
    Time=15.58.29;
    Modified=Yes;
    Version List=NAVW110.00,ICA2.01;
  }
  PROPERTIES
  {
    Permissions=TableData 27=r,
                TableData 5406=rimd,
                TableData 5407=rimd,
                TableData 99000765=r,
                TableData 99000772=rimd,
                TableData 99000776=rimd,
                TableData 5405=rimd,
                TableData 5416=rimd;
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      Text000@1000 : TextConst 'ENU=BOM phantom structure for %1 is higher than 50 levels.;NOR=Stykklistefantomstruktur for %1 er h›yere enn 50 niv†er.';
      Text001@1001 : TextConst 'ENU=%1 %2 %3 can not be calculated, if at least one %4 has been posted.;NOR=%1 %2 %3 kan ikke beregnes hvis minst ‚n %4 er bokf›rt.';
      Text002@1002 : TextConst 'ENU=Operation No. %1 cannot follow another operation in the routing of this Prod. Order Line;NOR=Operasjon nr. %1 kan ikke komme etter en annen operasjon i ruten p† denne prod.ordrelinjen';
      Text003@1003 : TextConst 'ENU=Operation No. %1 cannot precede another operation in the routing of this Prod. Order Line;NOR=Operasjon nr. %1 kan ikke g† foran en annen operasjon i ruten for denne produksjonsordrelinjen';
      Item@1004 : Record 27;
      Location@1006 : Record 14;
      SKU@1005 : Record 5700;
      ProdOrder@1007 : Record 5405;
      ProdOrderLine@1008 : Record 5406;
      ProdOrderComp@1009 : Record 5407;
      ProdOrderRtngLine2@1010 : Record 5409;
      ProdOrderBOMCompComment@1011 : Record 5416;
      BomComponent@1012 : ARRAY [99] OF Record 99000772;
      ProdBOMCompComment@1013 : Record 99000776;
      UOMMgt@1014 : Codeunit 5402;
      CostCalcMgt@1015 : Codeunit 5836;
      VersionMgt@1016 : Codeunit 99000756;
      ProdOrderRouteMgt@1017 : Codeunit 99000772;
      GetPlanningParameters@1018 : Codeunit 99000855;
      LeadTimeMgt@1019 : Codeunit 5404;
      CalendarMgt@1023 : Codeunit 99000755;
      WMSManagement@1024 : Codeunit 7302;
      NextProdOrderCompLineNo@1020 : Integer;
      Blocked@1021 : Boolean;
      ProdOrderModify@1022 : Boolean;

    LOCAL PROCEDURE TransferRouting@5();
    VAR
      RtngHeader@1000 : Record 99000763;
      RtngLine@1001 : Record 99000764;
      ProdOrderRtngLine@1002 : Record 5409;
      WorkCenter@1003 : Record 99000754;
      MachineCenter@1004 : Record 99000758;
    BEGIN
      IF ProdOrderLine."Routing No." = '' THEN
        EXIT;

      RtngHeader.GET(ProdOrderLine."Routing No.");

      ProdOrderRtngLine.SETRANGE(Status,ProdOrderLine.Status);
      ProdOrderRtngLine.SETRANGE("Prod. Order No.",ProdOrderLine."Prod. Order No.");
      ProdOrderRtngLine.SETRANGE("Routing Reference No.",ProdOrderLine."Routing Reference No.");
      ProdOrderRtngLine.SETRANGE("Routing No.",ProdOrderLine."Routing No.");
      IF NOT ProdOrderRtngLine.ISEMPTY THEN
        EXIT;

      RtngLine.SETRANGE("Routing No.",ProdOrderLine."Routing No.");
      RtngLine.SETRANGE("Version Code",ProdOrderLine."Routing Version Code");
      IF RtngLine.FIND('-') THEN
        REPEAT
          RtngLine.TESTFIELD(Recalculate,FALSE);
          ProdOrderRtngLine.INIT;
          ProdOrderRtngLine.Status := ProdOrderLine.Status;
          ProdOrderRtngLine."Prod. Order No." := ProdOrderLine."Prod. Order No.";
          ProdOrderRtngLine."Routing Reference No." := ProdOrderLine."Routing Reference No.";
          ProdOrderRtngLine."Routing No." := ProdOrderLine."Routing No.";
          ProdOrderRtngLine."Operation No." := RtngLine."Operation No.";
          ProdOrderRtngLine."Next Operation No." := RtngLine."Next Operation No.";
          ProdOrderRtngLine."Previous Operation No." := RtngLine."Previous Operation No.";
          ProdOrderRtngLine.Type := RtngLine.Type;
          ProdOrderRtngLine."No." := RtngLine."No.";
          ProdOrderRtngLine.FillDefaultLocationAndBins;
          ProdOrderRtngLine."Work Center No." := RtngLine."Work Center No.";
          ProdOrderRtngLine."Work Center Group Code" := RtngLine."Work Center Group Code";
          ProdOrderRtngLine.Description := RtngLine.Description;
          ProdOrderRtngLine."Setup Time" := RtngLine."Setup Time";
          ProdOrderRtngLine."Run Time" := RtngLine."Run Time";
          ProdOrderRtngLine."Wait Time" := RtngLine."Wait Time";
          ProdOrderRtngLine."Move Time" := RtngLine."Move Time";
          ProdOrderRtngLine."Fixed Scrap Quantity" := RtngLine."Fixed Scrap Quantity";
          ProdOrderRtngLine."Lot Size" := RtngLine."Lot Size";
          ProdOrderRtngLine."Scrap Factor %" := RtngLine."Scrap Factor %";
          ProdOrderRtngLine."Minimum Process Time" := RtngLine."Minimum Process Time";
          ProdOrderRtngLine."Maximum Process Time" := RtngLine."Maximum Process Time";
          ProdOrderRtngLine."Concurrent Capacities" := RtngLine."Concurrent Capacities";
          IF ProdOrderRtngLine."Concurrent Capacities" = 0 THEN
            ProdOrderRtngLine."Concurrent Capacities" := 1;
          ProdOrderRtngLine."Send-Ahead Quantity" := RtngLine."Send-Ahead Quantity";
          ProdOrderRtngLine."Setup Time Unit of Meas. Code" := RtngLine."Setup Time Unit of Meas. Code";
          ProdOrderRtngLine."Run Time Unit of Meas. Code" := RtngLine."Run Time Unit of Meas. Code";
          ProdOrderRtngLine."Wait Time Unit of Meas. Code" := RtngLine."Wait Time Unit of Meas. Code";
          ProdOrderRtngLine."Move Time Unit of Meas. Code" := RtngLine."Move Time Unit of Meas. Code";
          ProdOrderRtngLine."Routing Link Code" := RtngLine."Routing Link Code";
          ProdOrderRtngLine."Standard Task Code" := RtngLine."Standard Task Code";
          ProdOrderRtngLine."Sequence No. (Forward)" := RtngLine."Sequence No. (Forward)";
          ProdOrderRtngLine."Sequence No. (Backward)" := RtngLine."Sequence No. (Backward)";
          ProdOrderRtngLine."Fixed Scrap Qty. (Accum.)" := RtngLine."Fixed Scrap Qty. (Accum.)";
          ProdOrderRtngLine."Scrap Factor % (Accumulated)" := RtngLine."Scrap Factor % (Accumulated)";
          ProdOrderRtngLine."Unit Cost per" := RtngLine."Unit Cost per";
          CostCalcMgt.RoutingCostPerUnit(
            ProdOrderRtngLine.Type,
            ProdOrderRtngLine."No.",
            ProdOrderRtngLine."Direct Unit Cost",
            ProdOrderRtngLine."Indirect Cost %",
            ProdOrderRtngLine."Overhead Rate",
            ProdOrderRtngLine."Unit Cost per",
            ProdOrderRtngLine."Unit Cost Calculation");
          CASE ProdOrderRtngLine.Type OF
            ProdOrderRtngLine.Type::"Work Center":
              BEGIN
                WorkCenter.GET(RtngLine."Work Center No.");
                ProdOrderRtngLine."Flushing Method" := WorkCenter."Flushing Method";
              END;
            ProdOrderRtngLine.Type::"Machine Center":
              BEGIN
                MachineCenter.GET(ProdOrderRtngLine."No.");
                ProdOrderRtngLine."Flushing Method" := MachineCenter."Flushing Method";
              END;
          END;
          ProdOrderRtngLine.VALIDATE("Direct Unit Cost");
          ProdOrderRtngLine."Starting Time" := ProdOrderLine."Starting Time";
          ProdOrderRtngLine."Starting Date" := ProdOrderLine."Starting Date";
          ProdOrderRtngLine."Ending Time" := ProdOrderLine."Ending Time";
          ProdOrderRtngLine."Ending Date" := ProdOrderLine."Ending Date";
          ProdOrderRtngLine.UpdateDatetime;
          ProdOrderRtngLine.INSERT;
          TransferTaskInfo(ProdOrderRtngLine,ProdOrderLine."Routing Version Code");
        UNTIL RtngLine.NEXT = 0;
    END;

    PROCEDURE TransferTaskInfo@3(VAR FromProdOrderRtngLine@1000 : Record 5409;VersionCode@1009 : Code[20]);
    VAR
      RtngLineTool@1001 : Record 99000802;
      RtngLinePersonnel@1002 : Record 99000803;
      RtngLineQltyMeas@1003 : Record 99000805;
      RtngComment@1004 : Record 99000775;
      ProdOrderRoutTool@1005 : Record 5411;
      ProdOrderRtngPersonnel@1006 : Record 5412;
      ProdOrderRtngQltyMeas@1007 : Record 5413;
      ProdOrderRtngComment@1008 : Record 5415;
    BEGIN
      RtngLineTool.SETRANGE("Routing No.",FromProdOrderRtngLine."Routing No.");
      RtngLineTool.SETRANGE("Operation No.",FromProdOrderRtngLine."Operation No.");
      RtngLineTool.SETRANGE("Version Code",VersionCode);
      IF RtngLineTool.FIND('-') THEN
        REPEAT
          ProdOrderRoutTool.TRANSFERFIELDS(RtngLineTool);
          ProdOrderRoutTool.Status := FromProdOrderRtngLine.Status;
          ProdOrderRoutTool."Prod. Order No." := FromProdOrderRtngLine."Prod. Order No.";
          ProdOrderRoutTool."Routing Reference No." := FromProdOrderRtngLine."Routing Reference No.";
          ProdOrderRoutTool.INSERT;
        UNTIL RtngLineTool.NEXT = 0;

      RtngLinePersonnel.SETRANGE("Routing No.",FromProdOrderRtngLine."Routing No.");
      RtngLinePersonnel.SETRANGE("Operation No.",FromProdOrderRtngLine."Operation No.");
      RtngLinePersonnel.SETRANGE("Version Code",VersionCode);
      IF RtngLinePersonnel.FIND('-') THEN
        REPEAT
          ProdOrderRtngPersonnel.TRANSFERFIELDS(RtngLinePersonnel);
          ProdOrderRtngPersonnel.Status := FromProdOrderRtngLine.Status;
          ProdOrderRtngPersonnel."Prod. Order No." := FromProdOrderRtngLine."Prod. Order No.";
          ProdOrderRtngPersonnel."Routing Reference No." := FromProdOrderRtngLine."Routing Reference No.";
          ProdOrderRtngPersonnel.INSERT;
        UNTIL RtngLinePersonnel.NEXT = 0;

      RtngLineQltyMeas.SETRANGE("Routing No.",FromProdOrderRtngLine."Routing No.");
      RtngLineQltyMeas.SETRANGE("Operation No.",FromProdOrderRtngLine."Operation No.");
      RtngLineQltyMeas.SETRANGE("Version Code",VersionCode);
      IF RtngLineQltyMeas.FIND('-') THEN
        REPEAT
          ProdOrderRtngQltyMeas.TRANSFERFIELDS(RtngLineQltyMeas);
          ProdOrderRtngQltyMeas.Status := FromProdOrderRtngLine.Status;
          ProdOrderRtngQltyMeas."Prod. Order No." := FromProdOrderRtngLine."Prod. Order No.";
          ProdOrderRtngQltyMeas."Routing Reference No." := FromProdOrderRtngLine."Routing Reference No.";
          ProdOrderRtngQltyMeas.INSERT;
        UNTIL RtngLineQltyMeas.NEXT = 0;

      RtngComment.SETRANGE("Routing No.",FromProdOrderRtngLine."Routing No.");
      RtngComment.SETRANGE("Operation No.",FromProdOrderRtngLine."Operation No.");
      RtngComment.SETRANGE("Version Code",VersionCode);
      IF RtngComment.FIND('-') THEN
        REPEAT
          ProdOrderRtngComment.TRANSFERFIELDS(RtngComment);
          ProdOrderRtngComment.Status := FromProdOrderRtngLine.Status;
          ProdOrderRtngComment."Prod. Order No." := FromProdOrderRtngLine."Prod. Order No.";
          ProdOrderRtngComment."Routing Reference No." := FromProdOrderRtngLine."Routing Reference No.";
          ProdOrderRtngComment.INSERT;
        UNTIL RtngComment.NEXT = 0;
    END;

    LOCAL PROCEDURE TransferBOM@4(ProdBOMNo@1000 : Code[20];Level@1001 : Integer;LineQtyPerUOM@1002 : Decimal;ItemQtyPerUOM@1010 : Decimal) : Boolean;
    VAR
      BOMHeader@1003 : Record 99000771;
      ComponentSKU@1004 : Record 5700;
      Item2@1007 : Record 27;
      ProductionBOMVersion@1009 : Record 99000779;
      ReqQty@1006 : Decimal;
      ErrorOccured@1005 : Boolean;
      VersionCode@1008 : Code[20];
    BEGIN
      IF ProdBOMNo = '' THEN
        EXIT;

      ProdOrderComp.LOCKTABLE;

      IF Level > 50 THEN
        ERROR(
          Text000,
          ProdBOMNo);

      BOMHeader.GET(ProdBOMNo);

      IF Level > 1 THEN
        VersionCode := VersionMgt.GetBOMVersion(ProdBOMNo,ProdOrderLine."Starting Date",TRUE)
      ELSE
        VersionCode := ProdOrderLine."Production BOM Version Code";

      IF VersionCode <> '' THEN BEGIN
        ProductionBOMVersion.GET(ProdBOMNo,VersionCode);
        ProductionBOMVersion.TESTFIELD(Status,ProductionBOMVersion.Status::Certified);
      END ELSE
        BOMHeader.TESTFIELD(Status,BOMHeader.Status::Certified);

      BomComponent[Level].SETRANGE("Production BOM No.",ProdBOMNo);
      BomComponent[Level].SETRANGE("Version Code",VersionCode);
      BomComponent[Level].SETFILTER("Starting Date",'%1|..%2',0D,ProdOrderLine."Starting Date");
      BomComponent[Level].SETFILTER("Ending Date",'%1|%2..',0D,ProdOrderLine."Starting Date");
      IF BomComponent[Level].FIND('-') THEN
        REPEAT
          IF BomComponent[Level]."Routing Link Code" <> '' THEN BEGIN
            ProdOrderRtngLine2.SETRANGE(Status,ProdOrderLine.Status);
            ProdOrderRtngLine2.SETRANGE("Prod. Order No.",ProdOrderLine."Prod. Order No.");
            ProdOrderRtngLine2.SETRANGE("Routing Link Code",BomComponent[Level]."Routing Link Code");
            ProdOrderRtngLine2.FINDFIRST;
            ReqQty :=
              BomComponent[Level].Quantity *
              (1 + BomComponent[Level]."Scrap %" / 100) *
              (1 + ProdOrderRtngLine2."Scrap Factor % (Accumulated)") *
              (1 + ProdOrderLine."Scrap %" / 100) *
              LineQtyPerUOM /
              ItemQtyPerUOM +
              ProdOrderRtngLine2."Fixed Scrap Qty. (Accum.)";
          END ELSE
            ReqQty :=
              BomComponent[Level].Quantity *
              (1 + BomComponent[Level]."Scrap %" / 100) *
              (1 + ProdOrderLine."Scrap %" / 100) *
              LineQtyPerUOM /
              ItemQtyPerUOM;

          CASE BomComponent[Level].Type OF
            BomComponent[Level].Type::Item:
              BEGIN
                IF ReqQty <> 0 THEN BEGIN
                  ProdOrderComp.SETCURRENTKEY(Status,"Prod. Order No.","Prod. Order Line No.","Item No.");
                  ProdOrderComp.SETRANGE(Status,ProdOrderLine.Status);
                  ProdOrderComp.SETRANGE("Prod. Order No.",ProdOrderLine."Prod. Order No.");
                  ProdOrderComp.SETRANGE("Prod. Order Line No.",ProdOrderLine."Line No.");
                  ProdOrderComp.SETRANGE("Item No.",BomComponent[Level]."No.");
                  ProdOrderComp.SETRANGE("Variant Code",BomComponent[Level]."Variant Code");
                  ProdOrderComp.SETRANGE("Routing Link Code",BomComponent[Level]."Routing Link Code");
                  ProdOrderComp.SETRANGE(Position,BomComponent[Level].Position);
                  ProdOrderComp.SETRANGE("Position 2",BomComponent[Level]."Position 2");
                  ProdOrderComp.SETRANGE("Position 3",BomComponent[Level]."Position 3");
                  ProdOrderComp.SETRANGE(Length,BomComponent[Level].Length);
                  ProdOrderComp.SETRANGE(Width,BomComponent[Level].Width);
                  ProdOrderComp.SETRANGE(Weight,BomComponent[Level].Weight);
                  ProdOrderComp.SETRANGE(Depth,BomComponent[Level].Depth);
                  ProdOrderComp.SETRANGE("Unit of Measure Code",BomComponent[Level]."Unit of Measure Code");
                  IF NOT ProdOrderComp.FINDFIRST THEN BEGIN
                    ProdOrderComp.RESET;
                    ProdOrderComp.SETRANGE(Status,ProdOrderLine.Status);
                    ProdOrderComp.SETRANGE("Prod. Order No.",ProdOrderLine."Prod. Order No.");
                    ProdOrderComp.SETRANGE("Prod. Order Line No.",ProdOrderLine."Line No.");
                    IF ProdOrderComp.FINDLAST THEN
                      NextProdOrderCompLineNo := ProdOrderComp."Line No." + 10000
                    ELSE
                      NextProdOrderCompLineNo := 10000;
                    ProdOrderComp.INIT;
                    ProdOrderComp.SetIgnoreErrors;
                    ProdOrderComp.BlockDynamicTracking(Blocked);
                    ProdOrderComp.Status := ProdOrderLine.Status;
                    ProdOrderComp."Prod. Order No." := ProdOrderLine."Prod. Order No.";
                    ProdOrderComp."Prod. Order Line No." := ProdOrderLine."Line No.";
                    ProdOrderComp."Line No." := NextProdOrderCompLineNo;
                    ProdOrderComp.VALIDATE("Item No.",BomComponent[Level]."No.");
                    ProdOrderComp."Variant Code" := BomComponent[Level]."Variant Code";
                    ProdOrderComp."Location Code" := SKU."Components at Location";
                    ProdOrderComp."Bin Code" := GetDefaultBin;
                    ProdOrderComp.Description := BomComponent[Level].Description;
                    ProdOrderComp.VALIDATE("Unit of Measure Code",BomComponent[Level]."Unit of Measure Code");
                    ProdOrderComp."Quantity per" :=
                      BomComponent[Level]."Quantity per" * LineQtyPerUOM / ItemQtyPerUOM;
                    ProdOrderComp.Length := BomComponent[Level].Length;
                    ProdOrderComp.Width := BomComponent[Level].Width;
                    ProdOrderComp.Weight := BomComponent[Level].Weight;
                    ProdOrderComp.Depth := BomComponent[Level].Depth;
                    ProdOrderComp.Position := BomComponent[Level].Position;
                    ProdOrderComp."Position 2" := BomComponent[Level]."Position 2";
                    ProdOrderComp."Position 3" := BomComponent[Level]."Position 3";
                    ProdOrderComp."Lead-Time Offset" := BomComponent[Level]."Lead-Time Offset";
                    ProdOrderComp.VALIDATE("Routing Link Code",BomComponent[Level]."Routing Link Code");
                    ProdOrderComp.VALIDATE("Scrap %",BomComponent[Level]."Scrap %");
                    ProdOrderComp.VALIDATE("Calculation Formula",BomComponent[Level]."Calculation Formula");

                    GetPlanningParameters.AtSKU(
                      ComponentSKU,ProdOrderComp."Item No.",
                      ProdOrderComp."Variant Code",
                      ProdOrderComp."Location Code");

                    ProdOrderComp."Flushing Method" := ComponentSKU."Flushing Method";
                    IF (SKU."Manufacturing Policy" = SKU."Manufacturing Policy"::"Make-to-Order") AND
                       (ComponentSKU."Manufacturing Policy" = ComponentSKU."Manufacturing Policy"::"Make-to-Order") AND
                       (ComponentSKU."Replenishment System" = ComponentSKU."Replenishment System"::"Prod. Order")
                    THEN BEGIN
                      ProdOrderComp."Planning Level Code" := ProdOrderLine."Planning Level Code" + 1;
                      Item2.GET(ProdOrderComp."Item No.");
                      ProdOrderComp."Item Low-Level Code" := Item2."Low-Level Code";
                    END;
                    ProdOrderComp.GetDefaultBin;
                    ProdOrderComp.INSERT(TRUE);
                  END ELSE BEGIN
                    ProdOrderComp.SetIgnoreErrors;
                    ProdOrderComp.SETCURRENTKEY(Status,"Prod. Order No."); // Reset key
                    ProdOrderComp.BlockDynamicTracking(Blocked);
                    ProdOrderComp.VALIDATE(
                      "Quantity per",
                      ProdOrderComp."Quantity per" + BomComponent[Level]."Quantity per" * LineQtyPerUOM / ItemQtyPerUOM);
                    ProdOrderComp.VALIDATE("Routing Link Code",BomComponent[Level]."Routing Link Code");
                    ProdOrderComp.MODIFY;
                  END;
                  IF ProdOrderComp.HasErrorOccured THEN
                    ErrorOccured := TRUE;
                  ProdOrderComp.AutoReserve;

                  ProdBOMCompComment.SETRANGE("Production BOM No.",BomComponent[Level]."Production BOM No.");
                  ProdBOMCompComment.SETRANGE("BOM Line No.",BomComponent[Level]."Line No.");
                  ProdBOMCompComment.SETRANGE("Version Code",BomComponent[Level]."Version Code");
                  IF ProdBOMCompComment.FIND('-') THEN
                    REPEAT
                      ProdOrderBOMCompComment.TRANSFERFIELDS(ProdBOMCompComment);
                      ProdOrderBOMCompComment.Status := ProdOrderComp.Status;
                      ProdOrderBOMCompComment."Prod. Order No." := ProdOrderComp."Prod. Order No.";
                      ProdOrderBOMCompComment."Prod. Order Line No." := ProdOrderComp."Prod. Order Line No.";
                      ProdOrderBOMCompComment."Prod. Order BOM Line No." := ProdOrderComp."Line No.";
                      IF NOT ProdOrderBOMCompComment.INSERT THEN
                        ProdOrderBOMCompComment.MODIFY;
                    UNTIL ProdBOMCompComment.NEXT = 0;
                END;
              END;
            BomComponent[Level].Type::"Production BOM":
              BEGIN
                TransferBOM(
                  BomComponent[Level]."No.",
                  Level + 1,
                  ReqQty,
                  1);
                BomComponent[Level].SETRANGE("Production BOM No.",ProdBOMNo);
                IF Level > 1 THEN
                  BomComponent[Level].SETRANGE("Version Code",VersionMgt.GetBOMVersion(ProdBOMNo,ProdOrderLine."Starting Date",TRUE))
                ELSE
                  BomComponent[Level].SETRANGE("Version Code",ProdOrderLine."Production BOM Version Code");
                BomComponent[Level].SETFILTER("Starting Date",'%1|..%2',0D,ProdOrderLine."Starting Date");
                BomComponent[Level].SETFILTER("Ending Date",'%1|%2..',0D,ProdOrderLine."Starting Date");
              END;
          END;
        UNTIL BomComponent[Level].NEXT = 0;
      EXIT(NOT ErrorOccured);
    END;

    PROCEDURE CalculateComponents@7();
    VAR
      ProdOrderComp@1000 : Record 5407;
    BEGIN
      ProdOrderComp.SETRANGE(Status,ProdOrderLine.Status);
      ProdOrderComp.SETRANGE("Prod. Order No.",ProdOrderLine."Prod. Order No.");
      ProdOrderComp.SETRANGE("Prod. Order Line No.",ProdOrderLine."Line No.");
      IF ProdOrderComp.FIND('-') THEN
        REPEAT
          ProdOrderComp.BlockDynamicTracking(Blocked);
          ProdOrderComp.VALIDATE("Routing Link Code");
          ProdOrderComp.MODIFY;
          ProdOrderComp.AutoReserve;
        UNTIL ProdOrderComp.NEXT = 0;
    END;

    PROCEDURE CalculateRoutingFromActual@11(ProdOrderRtngLine@1000 : Record 5409;Direction@1001 : 'Forward,Backward';CalcStartEndDate@1002 : Boolean);
    VAR
      CalcProdOrderRtngLine@1003 : Codeunit 99000774;
    BEGIN
      IF ProdOrderRouteMgt.NeedsCalculation(
           ProdOrderRtngLine.Status,
           ProdOrderRtngLine."Prod. Order No.",
           ProdOrderRtngLine."Routing Reference No.",
           ProdOrderRtngLine."Routing No.")
      THEN BEGIN
        ProdOrderLine.SETRANGE(Status,ProdOrderRtngLine.Status);
        ProdOrderLine.SETRANGE("Prod. Order No.",ProdOrderRtngLine."Prod. Order No.");
        ProdOrderLine.SETRANGE("Routing Reference No.",ProdOrderRtngLine."Routing Reference No.");
        ProdOrderLine.SETRANGE("Routing No.",ProdOrderRtngLine."Routing No.");
        ProdOrderLine.FINDFIRST;
        ProdOrderRouteMgt.Calculate(ProdOrderLine);
        ProdOrderRtngLine.GET(
          ProdOrderRtngLine.Status,
          ProdOrderRtngLine."Prod. Order No.",
          ProdOrderRtngLine."Routing Reference No.",
          ProdOrderRtngLine."Routing No.",
          ProdOrderRtngLine."Operation No.");
      END;
      IF Direction = Direction::Forward THEN
        ProdOrderRtngLine.SETCURRENTKEY(Status,"Prod. Order No.","Routing Reference No.",
          "Routing No.","Sequence No. (Forward)")
      ELSE
        ProdOrderRtngLine.SETCURRENTKEY(Status,"Prod. Order No.","Routing Reference No.",
          "Routing No.","Sequence No. (Backward)");

      ProdOrderRtngLine.SETRANGE(Status,ProdOrderRtngLine.Status);
      ProdOrderRtngLine.SETRANGE("Prod. Order No.",ProdOrderRtngLine."Prod. Order No.");
      ProdOrderRtngLine.SETRANGE("Routing Reference No.",ProdOrderRtngLine."Routing Reference No.");
      ProdOrderRtngLine.SETRANGE("Routing No.",ProdOrderRtngLine."Routing No.");
      ProdOrderRtngLine.SETFILTER("Routing Status",'<>%1',ProdOrderRtngLine."Routing Status"::Finished);
      REPEAT
        IF CalcStartEndDate AND NOT ProdOrderRtngLine."Schedule Manually" THEN BEGIN
          IF ((Direction = Direction::Forward) AND (ProdOrderRtngLine."Previous Operation No." <> '')) OR
             ((Direction = Direction::Backward) AND (ProdOrderRtngLine."Next Operation No." <> ''))
          THEN BEGIN
            ProdOrderRtngLine."Starting Time" := 0T;
            ProdOrderRtngLine."Starting Date" := 0D;
            ProdOrderRtngLine."Ending Time" := 235959T;
            ProdOrderRtngLine."Ending Date" := CalendarMgt.GetMaxDate;
          END;
        END;
        CalcProdOrderRtngLine.CalculateRoutingLine(
          ProdOrderRtngLine,
          Direction,CalcStartEndDate);
        CalcStartEndDate := TRUE;
      UNTIL ProdOrderRtngLine.NEXT = 0;
    END;

    LOCAL PROCEDURE CalculateRouting@6(Direction@1000 : 'Forward,Backward';LetDueDateDecrease@1003 : Boolean);
    VAR
      ProdOrderRtngLine@1001 : Record 5409;
      LeadTime@1002 : Code[20];
    BEGIN
      IF ProdOrderRouteMgt.NeedsCalculation(
           ProdOrderLine.Status,
           ProdOrderLine."Prod. Order No.",
           ProdOrderLine."Routing Reference No.",
           ProdOrderLine."Routing No.")
      THEN
        ProdOrderRouteMgt.Calculate(ProdOrderLine);

      IF Direction = Direction::Forward THEN
        ProdOrderRtngLine.SETCURRENTKEY(Status,"Prod. Order No.","Routing Reference No.","Routing No.",
          "Sequence No. (Forward)")
      ELSE
        ProdOrderRtngLine.SETCURRENTKEY(Status,"Prod. Order No.","Routing Reference No.","Routing No.",
          "Sequence No. (Backward)");

      ProdOrderRtngLine.SETRANGE(Status,ProdOrderLine.Status);
      ProdOrderRtngLine.SETRANGE("Prod. Order No.",ProdOrderLine."Prod. Order No.");
      ProdOrderRtngLine.SETRANGE("Routing Reference No.",ProdOrderLine."Routing Reference No.");
      ProdOrderRtngLine.SETRANGE("Routing No.",ProdOrderLine."Routing No.");
      ProdOrderRtngLine.SETFILTER("Routing Status",'<>%1',ProdOrderRtngLine."Routing Status"::Finished);
      IF NOT ProdOrderRtngLine.FINDFIRST THEN BEGIN
        LeadTime :=
          LeadTimeMgt.ManufacturingLeadTime(
            ProdOrderLine."Item No.",
            ProdOrderLine."Location Code",
            ProdOrderLine."Variant Code");
        IF Direction = Direction::Forward THEN
          // Ending Date calculated forward from Starting Date
          ProdOrderLine."Ending Date" :=
            LeadTimeMgt.PlannedEndingDate2(
              ProdOrderLine."Item No.",
              ProdOrderLine."Location Code",
              ProdOrderLine."Variant Code",
              '',
              LeadTime,
              2,
              ProdOrderLine."Starting Date")
        ELSE
          // Starting Date calculated backward from Ending Date
          ProdOrderLine."Starting Date" :=
            LeadTimeMgt.PlannedStartingDate(
              ProdOrderLine."Item No.",
              ProdOrderLine."Location Code",
              ProdOrderLine."Variant Code",
              '',
              LeadTime,
              2,
              ProdOrderLine."Ending Date");

        CalculateProdOrderDates(ProdOrderLine,LetDueDateDecrease);
        EXIT;
      END;

      IF Direction = Direction::Forward THEN BEGIN
        ProdOrderRtngLine."Starting Date" := ProdOrderLine."Starting Date";
        ProdOrderRtngLine."Starting Time" := ProdOrderLine."Starting Time";
      END ELSE BEGIN
        ProdOrderRtngLine."Ending Date" := ProdOrderLine."Ending Date";
        ProdOrderRtngLine."Ending Time" := ProdOrderLine."Ending Time";
      END;
      ProdOrderRtngLine.UpdateDatetime;
      CalculateRoutingFromActual(ProdOrderRtngLine,Direction,FALSE);

      CalculateProdOrderDates(ProdOrderLine,LetDueDateDecrease);
    END;

    PROCEDURE CalculateProdOrderDates@12(VAR ProdOrderLine@1000 : Record 5406;LetDueDateDecrease@1003 : Boolean);
    VAR
      ProdOrderLine2@1001 : Record 5406;
      ProdOrderRtngLine@1002 : Record 5409;
      NewDueDate@1004 : Date;
    BEGIN
      ProdOrder.GET(ProdOrderLine.Status,ProdOrderLine."Prod. Order No.");

      ProdOrderRtngLine.SETRANGE(Status,ProdOrderLine.Status);
      ProdOrderRtngLine.SETRANGE("Prod. Order No.",ProdOrderLine."Prod. Order No.");
      ProdOrderRtngLine.SETRANGE("Routing No.",ProdOrderLine."Routing No.");
      IF ProdOrder."Source Type" <> ProdOrder."Source Type"::Family THEN
        ProdOrderRtngLine.SETRANGE("Routing Reference No.",ProdOrderLine."Line No.")
      ELSE
        ProdOrderRtngLine.SETRANGE("Routing Reference No.",0);
      ProdOrderRtngLine.SETFILTER("Routing Status",'<>%1',ProdOrderRtngLine."Routing Status"::Finished);
      ProdOrderRtngLine.SETFILTER("Next Operation No.",'%1','');

      IF ProdOrderRtngLine.FINDFIRST THEN BEGIN
        ProdOrderLine."Ending Date" := ProdOrderRtngLine."Ending Date";
        ProdOrderLine."Ending Time" := ProdOrderRtngLine."Ending Time";
      END;

      ProdOrderRtngLine.SETRANGE("Next Operation No.");
      ProdOrderRtngLine.SETFILTER("Previous Operation No.",'%1','');

      IF ProdOrderRtngLine.FINDFIRST THEN BEGIN
        ProdOrderLine."Starting Date" := ProdOrderRtngLine."Starting Date";
        ProdOrderLine."Starting Time" := ProdOrderRtngLine."Starting Time";
      END;

      IF ProdOrderLine."Planning Level Code" = 0 THEN
        NewDueDate :=
          LeadTimeMgt.PlannedDueDate(
            ProdOrderLine."Item No.",
            ProdOrderLine."Location Code",
            ProdOrderLine."Variant Code",
            ProdOrderLine."Ending Date",
            '',
            2)
      ELSE
        NewDueDate := ProdOrderLine."Ending Date";

      IF LetDueDateDecrease OR (NewDueDate > ProdOrderLine."Due Date") THEN
        ProdOrderLine."Due Date" := NewDueDate;

      ProdOrderLine.UpdateDatetime;

      ProdOrderLine.MODIFY;

      ProdOrder."Due Date" := 0D;
      ProdOrder."Ending Date" := 0D;
      ProdOrder."Ending Time" := 0T;
      ProdOrder."Starting Date" := CalendarMgt.GetMaxDate;
      ProdOrder."Starting Time" := 235959T;

      ProdOrderLine2.SETRANGE(Status,ProdOrderLine.Status);
      ProdOrderLine2.SETRANGE("Prod. Order No.",ProdOrderLine."Prod. Order No.");
      IF ProdOrderLine2.FIND('-') THEN
        REPEAT
          IF (ProdOrderLine2."Ending Date" > ProdOrder."Ending Date") OR
             ((ProdOrderLine2."Ending Date" = ProdOrder."Ending Date") AND
              (ProdOrderLine2."Ending Time" > ProdOrder."Ending Time"))
          THEN BEGIN
            ProdOrder."Ending Date" := ProdOrderLine2."Ending Date";
            ProdOrder."Ending Time" := ProdOrderLine2."Ending Time";
          END;
          IF (ProdOrderLine2."Starting Date" < ProdOrder."Starting Date") OR
             ((ProdOrderLine2."Starting Date" = ProdOrder."Starting Date") AND
              (ProdOrderLine2."Starting Time" < ProdOrder."Starting Time"))
          THEN BEGIN
            ProdOrder."Starting Date" := ProdOrderLine2."Starting Date";
            ProdOrder."Starting Time" := ProdOrderLine2."Starting Time";
          END;

          IF ProdOrderLine2."Due Date" > ProdOrder."Due Date" THEN
            ProdOrder."Due Date" := ProdOrderLine2."Due Date";
        UNTIL ProdOrderLine2.NEXT = 0;

      ProdOrder.UpdateDatetime;

      IF NOT ProdOrderModify THEN
        ProdOrder.MODIFY;
    END;

    PROCEDURE Calculate@1(ProdOrderLine2@1000 : Record 5406;Direction@1001 : 'Forward,Backward';CalcRouting@1002 : Boolean;CalcComponents@1003 : Boolean;DeleteRelations@1004 : Boolean;LetDueDateDecrease@1012 : Boolean) : Boolean;
    VAR
      CapLedgEntry@1005 : Record 5832;
      ItemLedgEntry@1009 : Record 32;
      ProdOrderRtngLine3@1006 : Record 5409;
      ProdOrderRtngLine4@1007 : Record 5409;
      Routing@1008 : Record 99000763;
      ProdOrderRtngLine@1010 : Record 5409;
      ErrorOccured@1011 : Boolean;
    BEGIN
      ProdOrderLine := ProdOrderLine2;

      IF ProdOrderLine.Status = ProdOrderLine.Status::Released THEN BEGIN
        ItemLedgEntry.SETCURRENTKEY("Order Type","Order No.");
        ItemLedgEntry.SETRANGE("Order Type",ItemLedgEntry."Order Type"::Production);
        ItemLedgEntry.SETRANGE("Order No.",ProdOrderLine."Prod. Order No.");
        IF NOT ItemLedgEntry.ISEMPTY THEN
          ERROR(
            Text001,
            ProdOrderLine.Status,ProdOrderLine.TABLECAPTION,ProdOrderLine."Prod. Order No.",
            ItemLedgEntry.TABLECAPTION);

        CapLedgEntry.SETCURRENTKEY("Order Type","Order No.");
        CapLedgEntry.SETRANGE("Order Type",CapLedgEntry."Order Type"::Production);
        CapLedgEntry.SETRANGE("Order No.",ProdOrderLine."Prod. Order No.");
        IF NOT CapLedgEntry.ISEMPTY THEN
          ERROR(
            Text001,
            ProdOrderLine.Status,ProdOrderLine.TABLECAPTION,ProdOrderLine."Prod. Order No.",
            CapLedgEntry.TABLECAPTION);
      END;

      ProdOrderLine.TESTFIELD(Quantity);
      IF Direction = Direction::Backward THEN
        ProdOrderLine.TESTFIELD("Ending Date")
      ELSE
        ProdOrderLine.TESTFIELD("Starting Date");

      IF DeleteRelations THEN
        ProdOrderLine.DeleteRelations;

      IF CalcRouting THEN BEGIN
        //01. 05.09.17 JAL -->
        IF ProdOrderLine."Calculation No." = '' THEN
        //TransferRouting;
          TransferRouting()
        ELSE
          OnTransferRoutingCalc(ProdOrderLine);
        //01. 05.09.17 JAL <--
        IF NOT CalcComponents THEN BEGIN // components will not be calculated later- update bin code
          ProdOrderRtngLine.SETRANGE(Status,ProdOrderLine.Status);
          ProdOrderRtngLine.SETRANGE("Prod. Order No.",ProdOrderLine."Prod. Order No.");
          ProdOrderRtngLine.SETRANGE("Routing Reference No.",ProdOrderLine."Routing Reference No.");
          ProdOrderRtngLine.SETRANGE("Routing No.",ProdOrderLine."Routing No.");
          IF NOT ProdOrderRouteMgt.UpdateComponentsBin(ProdOrderRtngLine,TRUE) THEN
            ErrorOccured := TRUE;
        END;
      END ELSE BEGIN
        IF Routing.GET(ProdOrderLine2."Routing No.") OR (ProdOrderLine2."Routing No." = '') THEN
          IF Routing.Type <> Routing.Type::Parallel THEN BEGIN
            ProdOrderRtngLine3.SETRANGE(Status,ProdOrderLine2.Status);
            ProdOrderRtngLine3.SETRANGE("Prod. Order No.",ProdOrderLine2."Prod. Order No.");
            ProdOrderRtngLine3.SETRANGE("Routing Reference No.",ProdOrderLine2."Routing Reference No.");
            ProdOrderRtngLine3.SETRANGE("Routing No.",ProdOrderLine2."Routing No.");
            ProdOrderRtngLine3.SETFILTER("Routing Status",'<>%1',ProdOrderRtngLine3."Routing Status"::Finished);
            ProdOrderRtngLine4.COPYFILTERS(ProdOrderRtngLine3);
            IF ProdOrderRtngLine3.FIND('-') THEN
              REPEAT
                IF ProdOrderRtngLine3."Next Operation No." <> '' THEN BEGIN
                  ProdOrderRtngLine4.SETRANGE("Operation No.",ProdOrderRtngLine3."Next Operation No.");
                  IF ProdOrderRtngLine4.ISEMPTY THEN
                    ERROR(
                      Text002,
                      ProdOrderRtngLine3."Next Operation No.");
                END;
                IF ProdOrderRtngLine3."Previous Operation No." <> '' THEN BEGIN
                  ProdOrderRtngLine4.SETRANGE("Operation No.",ProdOrderRtngLine3."Previous Operation No.");
                  IF ProdOrderRtngLine4.ISEMPTY THEN
                    ERROR(
                      Text003,
                      ProdOrderRtngLine3."Previous Operation No.");
                END;
              UNTIL ProdOrderRtngLine3.NEXT = 0;
          END;
      END;

      IF CalcComponents THEN BEGIN
        IF ProdOrderLine."Production BOM No." <> '' THEN BEGIN
          Item.GET(ProdOrderLine."Item No.");
          GetPlanningParameters.AtSKU(
            SKU,
            ProdOrderLine."Item No.",
            ProdOrderLine."Variant Code",
            ProdOrderLine."Location Code");

          IF NOT TransferBOM(
               ProdOrderLine."Production BOM No.",
               1,
               ProdOrderLine."Qty. per Unit of Measure",
               UOMMgt.GetQtyPerUnitOfMeasure(
                 Item,
                 VersionMgt.GetBOMUnitOfMeasure(
                   ProdOrderLine."Production BOM No.",
                   ProdOrderLine."Production BOM Version Code")))
          THEN
            ErrorOccured := TRUE;
        END;
      END;
      Recalculate(ProdOrderLine,Direction,LetDueDateDecrease);
      EXIT(NOT ErrorOccured);
    END;

    PROCEDURE Recalculate@2(VAR ProdOrderLine2@1000 : Record 5406;Direction@1001 : 'Forward,Backward';LetDueDateDecrease@1002 : Boolean);
    BEGIN
      ProdOrderLine := ProdOrderLine2;
      ProdOrderLine.BlockDynamicTracking(Blocked);

      CalculateRouting(Direction,LetDueDateDecrease);
      CalculateComponents;
      ProdOrderLine2 := ProdOrderLine;
    END;

    PROCEDURE BlockDynamicTracking@17(SetBlock@1000 : Boolean);
    BEGIN
      Blocked := SetBlock;
    END;

    PROCEDURE SetParameter@8(NewProdOrderModify@1000 : Boolean);
    BEGIN
      ProdOrderModify := NewProdOrderModify;
    END;

    LOCAL PROCEDURE GetDefaultBin@9() BinCode : Code[20];
    VAR
      WMSMgt@1000 : Codeunit 7302;
    BEGIN
      WITH ProdOrderComp DO
        IF "Location Code" <> '' THEN BEGIN
          IF Location.Code <> "Location Code" THEN
            Location.GET("Location Code");
          IF Location."Bin Mandatory" AND (NOT Location."Directed Put-away and Pick") THEN
            WMSMgt.GetDefaultBin("Item No.","Variant Code","Location Code",BinCode);
        END;
    END;

    PROCEDURE SetProdOrderLineBinCodeFromRoute@35(VAR ProdOrderLine@1000 : Record 5406;ParentLocationCode@1001 : Code[10];RoutingNo@1003 : Code[20]);
    VAR
      RouteBinCode@1005 : Code[20];
    BEGIN
      RouteBinCode :=
        WMSManagement.GetLastOperationFromBinCode(
          RoutingNo,
          ProdOrderLine."Routing Version Code",
          ProdOrderLine."Location Code",
          FALSE,
          0);
      SetProdOrderLineBinCode(ProdOrderLine,RouteBinCode,ParentLocationCode);
    END;

    PROCEDURE SetProdOrderLineBinCodeFromProdRtngLines@10(VAR ProdOrderLine@1000 : Record 5406);
    VAR
      ProdOrderRtngLinesBinCode@1005 : Code[20];
    BEGIN
      IF ProdOrderLine."Planning Level Code" > 0 THEN
        EXIT;

      ProdOrderRtngLinesBinCode :=
        WMSManagement.GetProdRtngLastOperationFromBinCode(
          ProdOrderLine.Status,
          ProdOrderLine."Prod. Order No.",
          ProdOrderLine."Line No.",
          ProdOrderLine."Routing No.",
          ProdOrderLine."Location Code");
      SetProdOrderLineBinCode(ProdOrderLine,ProdOrderRtngLinesBinCode,ProdOrderLine."Location Code");
    END;

    PROCEDURE SetProdOrderLineBinCodeFromPlanningRtngLines@19(VAR ProdOrderLine@1000 : Record 5406;ReqLine@1003 : Record 246);
    VAR
      PlanningLinesBinCode@1005 : Code[20];
    BEGIN
      PlanningLinesBinCode :=
        WMSManagement.GetPlanningRtngLastOperationFromBinCode(
          ReqLine."Worksheet Template Name",
          ReqLine."Journal Batch Name",
          ReqLine."Line No.",
          ReqLine."Location Code");
      SetProdOrderLineBinCode(ProdOrderLine,PlanningLinesBinCode,ReqLine."Location Code");
    END;

    LOCAL PROCEDURE SetProdOrderLineBinCode@20(VAR ProdOrderLine@1001 : Record 5406;ParentBinCode@1000 : Code[20];ParentLocationCode@1003 : Code[10]);
    VAR
      Location@1002 : Record 14;
      FromProdBinCode@1004 : Code[20];
    BEGIN
      IF ParentBinCode <> '' THEN
        ProdOrderLine.VALIDATE("Bin Code",ParentBinCode)
      ELSE BEGIN
        FromProdBinCode := '';
        IF Location.GET(ParentLocationCode) THEN
          FromProdBinCode := Location."From-Production Bin Code";
        IF FromProdBinCode <> '' THEN
          ProdOrderLine.VALIDATE("Bin Code",FromProdBinCode)
        ELSE
          ProdOrderLine.VALIDATE("Location Code");
      END;
    END;

    PROCEDURE FindAndSetProdOrderLineBinCodeFromProdRtngLines@13(ProdOrderStatus@1002 : Option;ProdOrderNo@1001 : Code[20];ProdOrderLineNo@1000 : Integer);
    BEGIN
      IF ProdOrderLine.GET(ProdOrderStatus,ProdOrderNo,ProdOrderLineNo) THEN BEGIN
        SetProdOrderLineBinCodeFromProdRtngLines(ProdOrderLine);
        ProdOrderLine.MODIFY;
      END;
    END;

    PROCEDURE AssignProdOrderLineBinCodeFromProdRtngLineMachineCenter@14(VAR ProdOrderRtngLine@1001 : Record 5409);
    VAR
      MachineCenter@1000 : Record 99000758;
    BEGIN
      MachineCenter.SETRANGE("Work Center No.",ProdOrderRtngLine."Work Center No.");
      IF PAGE.RUNMODAL(PAGE::"Machine Center List",MachineCenter) = ACTION::LookupOK THEN
        IF (ProdOrderRtngLine."No." <> MachineCenter."No.") OR
           (ProdOrderRtngLine.Type = ProdOrderRtngLine.Type::"Work Center")
        THEN BEGIN
          ProdOrderRtngLine.Type := ProdOrderRtngLine.Type::"Machine Center";
          ProdOrderRtngLine.VALIDATE("No.",MachineCenter."No.");
          FindAndSetProdOrderLineBinCodeFromProdRtngLines(
            ProdOrderRtngLine.Status,ProdOrderRtngLine."Prod. Order No.",ProdOrderRtngLine."Routing Reference No.");
        END;
    END;

    LOCAL PROCEDURE __INC__@1101103000();
    BEGIN
    END;

    [Integration(TRUE,TRUE)]
    LOCAL PROCEDURE OnTransferRoutingCalc@1101103001(VAR ProdOrderLineP@1101103000 : Record 5406);
    BEGIN
    END;

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 05.09.17 JAL Item Calculation (Kalkyle)
                       Transfering BOM list from Price Calculation
    }
    END.
  }
}

OBJECT Codeunit 99000787 Create Prod. Order Lines
{
  OBJECT-PROPERTIES
  {
    Date=07.09.17;
    Time=16.17.44;
    Modified=Yes;
    Version List=NAVW110.00.00.15601,ICA2.01;
  }
  PROPERTIES
  {
    Permissions=TableData 27=r,
                TableData 36=r,
                TableData 37=r,
                TableData 5406=rimd,
                TableData 5407=rimd,
                TableData 5408=r,
                TableData 99000765=rim,
                TableData 99000774=r,
                TableData 5405=r;
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      SalesHeader@1002 : Record 36;
      SalesLine@1003 : Record 37;
      FamilyLine@1004 : Record 99000774;
      MfgSetup@1005 : Record 99000765;
      ProdOrder@1006 : Record 5405;
      ProdOrderLine@1007 : Record 5406;
      ProdOrderLine2@1008 : Record 5406;
      ProdOrderComp@1009 : Record 5407;
      TempOldProdOrderComp@1011 : TEMPORARY Record 5407;
      SalesLineReserve@1012 : Codeunit 99000832;
      ReserveProdOrderComp@1013 : Codeunit 99000838;
      CalcProdOrder@1014 : Codeunit 99000773;
      NextProdOrderLineNo@1015 : Integer;
      InsertNew@1016 : Boolean;
      SalesLineIsSet@1001 : Boolean;

    PROCEDURE CheckStructure@8(Status@1000 : Option;ProdOrderNo@1001 : Code[20];Direction@1002 : 'Forward,Backward';MultiLevel@1003 : Boolean;LetDueDateDecrease@1004 : Boolean);
    BEGIN
      ProdOrder.GET(Status,ProdOrderNo);
      ProdOrderLine.SETRANGE(Status,Status);
      ProdOrderLine.SETRANGE("Prod. Order No.",ProdOrderNo);
      IF ProdOrderLine.FIND('+') THEN
        NextProdOrderLineNo := ProdOrderLine."Line No." + 10000
      ELSE
        NextProdOrderLineNo := 10000;

      CheckMultiLevelStructure(Direction,MultiLevel,LetDueDateDecrease);
    END;

    PROCEDURE Copy@5(ProdOrder2@1000 : Record 5405;Direction@1001 : 'Forward,Backward';VariantCode@1002 : Code[10];LetDueDateDecrease@1004 : Boolean) : Boolean;
    VAR
      ErrorOccured@1003 : Boolean;
    BEGIN
      MfgSetup.GET;

      ProdOrder2.TESTFIELD("Source No.");
      ProdOrder2.TESTFIELD("Starting Time");
      ProdOrder2.TESTFIELD("Starting Date");
      ProdOrder2.TESTFIELD("Ending Time");
      ProdOrder2.TESTFIELD("Ending Date");
      IF Direction = Direction::Backward THEN
        ProdOrder2.TESTFIELD("Due Date");

      ProdOrder := ProdOrder2;

      ProdOrderLine.LOCKTABLE;
      ProdOrderLine.SETRANGE(Status,ProdOrder.Status);
      ProdOrderLine.SETRANGE("Prod. Order No.",ProdOrder."No.");
      ProdOrderLine.DELETEALL(TRUE);

      NextProdOrderLineNo := 10000;

      InsertNew := FALSE;
      CASE ProdOrder."Source Type" OF
        ProdOrder."Source Type"::Item:
          BEGIN
            InitProdOrderLine(ProdOrder."Source No.",VariantCode,ProdOrder."Location Code");
            ProdOrderLine.Description := ProdOrder.Description;
            ProdOrderLine."Description 2" := ProdOrder."Description 2";
            ProdOrderLine.VALIDATE(Quantity,ProdOrder.Quantity);
            OnBeforeUpdateDatetime(ProdOrderLine, SalesLine);//01. 07.09.17 JAL
            ProdOrderLine.UpdateDatetime;
            IF SalesLineIsSet THEN
              CopyDimFromSalesLine(SalesLine,ProdOrderLine);
            ProdOrderLine.INSERT;
            IF ProdOrderLine.HasErrorOccured THEN
              ErrorOccured := TRUE;
          END;
        ProdOrder."Source Type"::Family:
          IF NOT CopyFromFamily THEN
            ErrorOccured := TRUE;
        ProdOrder."Source Type"::"Sales Header":
          BEGIN
            InsertNew := TRUE;
            IF ProdOrder.Status <> ProdOrder.Status::Simulated THEN
              SalesHeader.GET(SalesHeader."Document Type"::Order,ProdOrder."Source No.")
            ELSE
              SalesHeader.GET(SalesHeader."Document Type"::Quote,ProdOrder."Source No.");
            IF NOT CopyFromSalesOrder THEN
              ErrorOccured := TRUE;
          END;
      END;

      IF NOT ProcessProdOrderLines(Direction,LetDueDateDecrease) THEN
        ErrorOccured := TRUE;
      CheckMultiLevelStructure(Direction,TRUE,LetDueDateDecrease);
      EXIT(NOT ErrorOccured);
    END;

    LOCAL PROCEDURE CopyFromFamily@3() : Boolean;
    VAR
      Family@1000 : Record 99000773;
      ErrorOccured@1001 : Boolean;
    BEGIN
      Family.GET(ProdOrder."Source No.");
      FamilyLine.SETCURRENTKEY("Low-Level Code");
      FamilyLine.SETRANGE("Family No.",ProdOrder."Source No.");

      IF FamilyLine.FINDSET THEN
        REPEAT
          IF FamilyLine."Item No." <> '' THEN BEGIN
            InitProdOrderLine(FamilyLine."Item No.",'',ProdOrder."Location Code");
            ProdOrderLine.Description := FamilyLine.Description;
            ProdOrderLine."Description 2" := FamilyLine."Description 2";
            ProdOrderLine.VALIDATE("Unit of Measure Code",FamilyLine."Unit of Measure Code");
            ProdOrderLine.VALIDATE(Quantity,FamilyLine.Quantity * ProdOrder.Quantity);
            ProdOrderLine."Routing No." := Family."Routing No.";
            ProdOrderLine."Routing Reference No." := 0;
            ProdOrderLine.UpdateDatetime;
            InsertProdOrderLine;
            IF ProdOrderLine.HasErrorOccured THEN
              ErrorOccured := TRUE;
          END;
        UNTIL FamilyLine.NEXT = 0;
      EXIT(NOT ErrorOccured);
    END;

    LOCAL PROCEDURE CopyFromSalesOrder@1() : Boolean;
    VAR
      SalesPlanLine@1000 : TEMPORARY Record 99000800;
      Location@1006 : Record 14;
      LeadTimeMgt@1001 : Codeunit 5404;
      ItemTrackingMgt@1002 : Codeunit 6500;
      ErrorOccured@1003 : Boolean;
    BEGIN
      SalesLine.SETRANGE("Document Type",SalesHeader."Document Type");
      SalesLine.SETRANGE("Document No.",SalesHeader."No.");
      IF SalesLine.FINDSET THEN
        REPEAT
          SalesLine.CALCFIELDS("Reserved Quantity");
          IF (SalesLine.Type = SalesLine.Type::Item) AND
             (SalesLine."No." <> '') AND
             ((SalesLine."Outstanding Quantity" - SalesLine."Reserved Quantity") <> 0)
          THEN
            IF IsReplSystemProdOrder(SalesLine."No.",SalesLine."Variant Code",SalesLine."Location Code") THEN BEGIN
              SalesPlanLine.INIT;
              SalesPlanLine."Sales Order No." := SalesLine."Document No.";
              SalesPlanLine."Sales Order Line No." := SalesLine."Line No.";
              SalesPlanLine.VALIDATE("Item No.",SalesLine."No.");
              SalesPlanLine.INSERT;
            END;
        UNTIL SalesLine.NEXT = 0;

      SalesPlanLine.SETCURRENTKEY("Low-Level Code");
      IF SalesPlanLine.FINDSET THEN
        REPEAT
          SalesLine.GET(
            SalesHeader."Document Type",
            SalesPlanLine."Sales Order No.",
            SalesPlanLine."Sales Order Line No.");
          SalesLine.CALCFIELDS("Reserved Quantity");

          InitProdOrderLine(SalesLine."No.",SalesLine."Variant Code",SalesLine."Location Code");
          ProdOrderLine.Description := SalesLine.Description;
          ProdOrderLine."Description 2" := SalesLine."Description 2";
          SalesLine.CALCFIELDS("Reserved Qty. (Base)");
          ProdOrderLine.VALIDATE("Quantity (Base)",SalesLine."Outstanding Qty. (Base)" - SalesLine."Reserved Qty. (Base)");

          IF Location.GET(ProdOrderLine."Location Code") AND NOT Location."Require Pick" AND (SalesLine."Bin Code" <> '') THEN
            ProdOrderLine."Bin Code" := SalesLine."Bin Code";

          ProdOrderLine."Due Date" := SalesLine."Shipment Date";
          ProdOrderLine."Ending Date" :=
            LeadTimeMgt.PlannedEndingDate(
              ProdOrderLine."Item No.",
              ProdOrderLine."Location Code",
              '',
              ProdOrderLine."Due Date",
              '',
              2);
          ProdOrderLine.VALIDATE("Ending Date");

          InsertProdOrderLine;
          IF ProdOrderLine.HasErrorOccured THEN
            ErrorOccured := TRUE;
          ItemTrackingMgt.CopyItemTracking2(SalesLine.RowID1,ProdOrderLine.RowID1,TRUE,TRUE);

          IF SalesLine."Document Type" = SalesLine."Document Type"::Order THEN BEGIN // Not simulated
            ProdOrderLine.CALCFIELDS("Reserved Quantity","Reserved Qty. (Base)");
            SalesLineReserve.BindToProdOrder(SalesLine,ProdOrderLine,
              ProdOrderLine."Remaining Quantity" - ProdOrderLine."Reserved Quantity",
              ProdOrderLine."Remaining Qty. (Base)" - ProdOrderLine."Reserved Qty. (Base)");
          END;
          CopyDimFromSalesLine(SalesLine,ProdOrderLine);
          ProdOrderLine.MODIFY;
        UNTIL (SalesPlanLine.NEXT = 0);
      EXIT(NOT ErrorOccured);
    END;

    LOCAL PROCEDURE InitProdOrderLine@2(ItemNo@1000 : Code[20];VariantCode@1001 : Code[10];LocationCode@1002 : Code[10]);
    VAR
      Item@1003 : Record 27;
    BEGIN
      ProdOrderLine.INIT;
      ProdOrderLine.SetIgnoreErrors;
      ProdOrderLine.Status := ProdOrder.Status;
      ProdOrderLine."Prod. Order No." := ProdOrder."No.";
      ProdOrderLine."Line No." := NextProdOrderLineNo;
      ProdOrderLine."Routing Reference No." := ProdOrderLine."Line No.";
      ProdOrderLine.VALIDATE("Item No.",ItemNo);
      ProdOrderLine."Location Code" := LocationCode;
      ProdOrderLine."Variant Code" := VariantCode;
      IF ProdOrder."Bin Code" <> '' THEN
        ProdOrderLine.VALIDATE("Bin Code",ProdOrder."Bin Code")
      ELSE
        CalcProdOrder.SetProdOrderLineBinCodeFromRoute(ProdOrderLine,ProdOrderLine."Location Code",ProdOrderLine."Routing No.");

      Item.GET(ItemNo);
      ProdOrderLine."Scrap %" := Item."Scrap %";
      ProdOrderLine."Due Date" := ProdOrder."Due Date";
      ProdOrderLine."Starting Date" := ProdOrder."Starting Date";
      ProdOrderLine."Starting Time" := ProdOrder."Starting Time";
      ProdOrderLine."Ending Date" := ProdOrder."Ending Date";
      ProdOrderLine."Ending Time" := ProdOrder."Ending Time";
      ProdOrderLine."Planning Level Code" := 0;
      ProdOrderLine."Inventory Posting Group" := Item."Inventory Posting Group";
      ProdOrderLine.UpdateDatetime;
      ProdOrderLine.VALIDATE("Unit Cost");

      NextProdOrderLineNo := NextProdOrderLineNo + 10000;
    END;

    LOCAL PROCEDURE InsertProdOrderLine@4() : Boolean;
    VAR
      ProdOrderLine3@1000 : Record 5406;
    BEGIN
      ProdOrderLine3 := ProdOrderLine;
      ProdOrderLine3.SETRANGE(Status,ProdOrderLine.Status);
      ProdOrderLine3.SETRANGE("Prod. Order No.",ProdOrderLine."Prod. Order No.");
      ProdOrderLine3.SETRANGE("Item No.",ProdOrderLine."Item No.");
      ProdOrderLine3.SETRANGE("Variant Code",ProdOrderLine."Variant Code");

      IF (NOT InsertNew) AND ProdOrderLine3.FINDFIRST THEN BEGIN
        CopyProdOrderCompToTemp(ProdOrderLine3);
        ProdOrderLine3.VALIDATE(Quantity,ProdOrderLine3.Quantity + ProdOrderLine.Quantity);
        AdjustDateAndTime(ProdOrderLine3,ProdOrderLine."Due Date",ProdOrderLine."Ending Date",ProdOrderLine."Ending Time");

        IF ProdOrderLine3."Planning Level Code" < ProdOrderLine."Planning Level Code" THEN BEGIN
          ProdOrderLine3."Planning Level Code" := ProdOrderLine."Planning Level Code";
          UpdateCompPlanningLevel(ProdOrderLine3);
        END;

        ProdOrderLine3.MODIFY;
        ProdOrderLine := ProdOrderLine3;
        EXIT(FALSE);
      END;
      ProdOrderLine.INSERT;
      EXIT(TRUE);
    END;

    LOCAL PROCEDURE ProcessProdOrderLines@7(Direction@1000 : 'Forward,Backward';LetDueDateDecrease@1002 : Boolean) : Boolean;
    VAR
      ErrorOccured@1001 : Boolean;
    BEGIN
      ProdOrderLine.SETRANGE(Status,ProdOrder.Status);
      ProdOrderLine.SETRANGE("Prod. Order No.",ProdOrder."No.");

      IF ProdOrderLine.FINDSET(TRUE) THEN
        REPEAT
          IF NOT CalcProdOrder.Calculate(ProdOrderLine,Direction,TRUE,TRUE,TRUE,LetDueDateDecrease) THEN
            ErrorOccured := TRUE;
        UNTIL ProdOrderLine.NEXT = 0;

      EXIT(NOT ErrorOccured);
    END;

    LOCAL PROCEDURE CheckMultiLevelStructure@6(Direction@1000 : 'Forward,Backward';MultiLevel@1001 : Boolean;LetDueDateDecrease@1003 : Boolean);
    VAR
      MultiLevelStructureCreated@1002 : Boolean;
    BEGIN
      ProdOrderComp.SETCURRENTKEY(Status,"Prod. Order No.","Prod. Order Line No.","Item Low-Level Code");
      ProdOrderComp.SETRANGE(Status,ProdOrder.Status);
      ProdOrderComp.SETRANGE("Prod. Order No.",ProdOrder."No.");
      ProdOrderComp.SETFILTER("Planning Level Code",'>0');
      ProdOrderComp.SETFILTER("Item No.",'<>%1','');
      IF ProdOrderComp.FINDSET(TRUE) THEN
        REPEAT
          MultiLevelStructureCreated :=
            MultiLevelStructureCreated OR
            CheckMakeOrderLine(ProdOrderComp,ProdOrderLine,Direction,MultiLevel,LetDueDateDecrease);
        UNTIL ProdOrderComp.NEXT = 0;
      IF MultiLevelStructureCreated THEN
        ReserveMultiLevelStructure(ProdOrderComp);
    END;

    LOCAL PROCEDURE CheckMakeOrderLine@15(VAR ProdOrderComp@1000 : Record 5407;VAR ProdOrderLine@1001 : Record 5406;Direction@1002 : 'Forward,Backward';MultiLevel@1003 : Boolean;LetDueDateDecrease@1010 : Boolean) : Boolean;
    VAR
      Item@1011 : Record 27;
      ParentItem@1004 : Record 27;
      ParentSKU@1005 : Record 5700;
      SKU@1007 : Record 5700;
      MakeProdOrder@1008 : Boolean;
      Description2@1009 : Text[50];
      Inserted@1006 : Boolean;
    BEGIN
      ProdOrderLine2.GET(ProdOrderComp.Status,ProdOrderComp."Prod. Order No.",ProdOrderComp."Prod. Order Line No.");
      IF ParentSKU.GET(ProdOrderLine2."Location Code",ProdOrderLine2."Item No.",ProdOrderLine2."Variant Code") THEN
        MakeProdOrder := ParentSKU."Manufacturing Policy" = ParentSKU."Manufacturing Policy"::"Make-to-Order"
      ELSE BEGIN
        ParentItem.GET(ProdOrderLine2."Item No.");
        MakeProdOrder := ParentItem."Manufacturing Policy" = ParentItem."Manufacturing Policy"::"Make-to-Order";
      END;

      IF NOT MakeProdOrder THEN
        EXIT(FALSE);

      Item.GET(ProdOrderComp."Item No.");

      IF SKU.GET(ProdOrderComp."Location Code",ProdOrderComp."Item No.",ProdOrderComp."Variant Code") THEN BEGIN
        Description2 := SKU."Description 2";
        MakeProdOrder :=
          (SKU."Replenishment System" = SKU."Replenishment System"::"Prod. Order") AND
          (SKU."Manufacturing Policy" = SKU."Manufacturing Policy"::"Make-to-Order");
      END ELSE BEGIN
        Description2 := Item."Description 2";
        MakeProdOrder :=
          (Item."Replenishment System" = Item."Replenishment System"::"Prod. Order") AND
          (Item."Manufacturing Policy" = Item."Manufacturing Policy"::"Make-to-Order");
      END;

      IF NOT MakeProdOrder THEN
        EXIT(FALSE);

      InitProdOrderLine(ProdOrderComp."Item No.",ProdOrderComp."Variant Code",ProdOrderComp."Location Code");
      ProdOrderLine.VALIDATE("Unit of Measure Code",ProdOrderComp."Unit of Measure Code");
      ProdOrderLine."Qty. per Unit of Measure" := ProdOrderComp."Qty. per Unit of Measure";
      ProdOrderLine."Bin Code" := ProdOrderComp."Bin Code";
      ProdOrderLine.Description := ProdOrderComp.Description;
      ProdOrderLine."Description 2" := Description2;
      ProdOrderComp.CALCFIELDS("Reserved Quantity");
      ProdOrderLine.VALIDATE(Quantity,ProdOrderComp."Expected Quantity" - ProdOrderComp."Reserved Quantity");
      IF ProdOrderLine."Quantity (Base)" = 0 THEN
        EXIT(FALSE);
      ProdOrderLine."Planning Level Code" := ProdOrderComp."Planning Level Code";
      ProdOrderLine."Due Date" := ProdOrderComp."Due Date";
      ProdOrderLine."Ending Date" := ProdOrderComp."Due Date";
      ProdOrderLine."Ending Time" := ProdOrderComp."Due Time";
      ProdOrderLine.UpdateDatetime;
      // this InsertNew is responsible for controlling if same POLine is added up or new POLine is created
      InsertNew := InsertNew AND (ProdOrderComp."Planning Level Code" > 1);

      InsertNew :=
        InsertNew OR
        (ProdOrder."Source Type" = ProdOrder."Source Type"::"Sales Header") AND
        (SalesLine."Location Code" <> ProdOrderLine."Location Code");

      Inserted := InsertProdOrderLine;
      IF MultiLevel THEN
        IF Inserted THEN
          CalcProdOrder.Calculate(ProdOrderLine,Direction::Backward,TRUE,TRUE,TRUE,LetDueDateDecrease)
        ELSE BEGIN
          CalcProdOrder.Recalculate(ProdOrderLine,Direction::Backward,LetDueDateDecrease);
          IF ProdOrderLine."Line No." < ProdOrderComp."Prod. Order Line No." THEN
            UpdateProdOrderLine(ProdOrderLine,Direction,LetDueDateDecrease);
        END
      ELSE
        EXIT(FALSE);
      ProdOrderComp."Supplied-by Line No." := ProdOrderLine."Line No.";
      ProdOrderComp.MODIFY;
      EXIT(TRUE);
    END;

    LOCAL PROCEDURE ReserveMultiLevelStructure@9(VAR ProdOrderComp2@1000 : Record 5407);
    VAR
      ProdOrderComp3@1001 : Record 5407;
      ProdOrderLine3@1002 : Record 5406;
    BEGIN
      ProdOrderComp3.COPY(ProdOrderComp2);
      ProdOrderComp3.SETCURRENTKEY(Status,"Prod. Order No.","Prod. Order Line No.","Due Date");
      ProdOrderComp3.SETFILTER("Supplied-by Line No.",'<>0');
      IF ProdOrderComp3.FIND('+') THEN
        REPEAT
          IF ProdOrderLine3.GET(
               ProdOrderComp3.Status,ProdOrderComp3."Prod. Order No.",ProdOrderComp3."Supplied-by Line No.")
          THEN BEGIN
            ProdOrderComp3.CALCFIELDS("Reserved Quantity","Reserved Qty. (Base)");
            ReserveProdOrderComp.BindToProdOrder(ProdOrderComp3,ProdOrderLine3,
              ProdOrderComp3."Remaining Quantity" - ProdOrderComp3."Reserved Quantity",
              ProdOrderComp3."Remaining Qty. (Base)" - ProdOrderComp3."Reserved Qty. (Base)");
          END;
        UNTIL ProdOrderComp3.NEXT(-1) = 0;
    END;

    PROCEDURE CopyDimFromSalesLine@10(SalesLine@1000 : Record 37;VAR ProdOrderLine@1001 : Record 5406);
    BEGIN
      ProdOrderLine."Shortcut Dimension 1 Code" := SalesLine."Shortcut Dimension 1 Code";
      ProdOrderLine."Shortcut Dimension 2 Code" := SalesLine."Shortcut Dimension 2 Code";
      ProdOrderLine."Dimension Set ID" := SalesLine."Dimension Set ID";
    END;

    PROCEDURE SetSalesLine@11(SalesLine2@1000 : Record 37);
    BEGIN
      SalesLine := SalesLine2;
      SalesLineIsSet := TRUE;
    END;

    LOCAL PROCEDURE AdjustDateAndTime@12(VAR ProdOrderLine3@1000 : Record 5406;DueDate@1001 : Date;EndingDate@1002 : Date;EndingTime@1003 : Time);
    BEGIN
      IF ProdOrderLine3."Due Date" > DueDate THEN
        ProdOrderLine3."Due Date" := DueDate;

      IF ProdOrderLine3."Ending Date" > EndingDate THEN BEGIN
        ProdOrderLine3."Ending Date" := EndingDate;
        ProdOrderLine3."Ending Time" := EndingTime;
      END ELSE
        IF (ProdOrderLine3."Ending Date" = EndingDate) AND
           (ProdOrderLine3."Ending Time" > EndingTime)
        THEN
          ProdOrderLine3."Ending Time" := EndingTime;
      ProdOrderLine3.UpdateDatetime;
    END;

    LOCAL PROCEDURE UpdateCompPlanningLevel@17(ProdOrderLine3@1000 : Record 5406);
    VAR
      ProdOrderComp3@1001 : Record 5407;
    BEGIN
      // update planning level code of component
      ProdOrderComp3.SETRANGE(Status,ProdOrderLine3.Status);
      ProdOrderComp3.SETRANGE("Prod. Order No.",ProdOrderLine3."Prod. Order No.");
      ProdOrderComp3.SETRANGE("Prod. Order Line No.",ProdOrderLine3."Line No.");
      ProdOrderComp3.SETFILTER("Planning Level Code",'>0');
      IF ProdOrderComp3.FINDSET(TRUE) THEN
        REPEAT
          ProdOrderComp3."Planning Level Code" := ProdOrderLine3."Planning Level Code" + 1;
          ProdOrderComp3.MODIFY;
        UNTIL ProdOrderComp3.NEXT = 0;
    END;

    LOCAL PROCEDURE UpdateProdOrderLine@13(VAR ProdOrderLine@1000 : Record 5406;Direction@1003 : 'Forward,Backward';LetDueDateDecrease@1004 : Boolean);
    VAR
      ProdOrderLine3@1002 : Record 5406;
      ProdOrderComp3@1001 : Record 5407;
    BEGIN
      ProdOrderComp3.SETRANGE(Status,ProdOrderLine.Status);
      ProdOrderComp3.SETRANGE("Prod. Order No.",ProdOrderLine."Prod. Order No.");
      ProdOrderComp3.SETRANGE("Prod. Order Line No.",ProdOrderLine."Line No.");
      IF ProdOrderComp3.FINDSET THEN
        REPEAT
          ProdOrderLine3.COPYFILTERS(ProdOrderLine);
          ProdOrderLine3.SETRANGE("Item No.",ProdOrderComp3."Item No.");
          ProdOrderLine3.SETRANGE("Variant Code",ProdOrderComp3."Variant Code");
          IF ProdOrderLine3.FINDFIRST THEN BEGIN
            ProdOrderComp3.CALCFIELDS("Reserved Quantity");
            TempOldProdOrderComp.GET(ProdOrderComp3.Status,ProdOrderComp3."Prod. Order No.",
              ProdOrderComp3."Prod. Order Line No.",ProdOrderComp3."Line No.");
            ProdOrderLine3.VALIDATE(Quantity,
              ProdOrderLine3.Quantity - TempOldProdOrderComp."Expected Quantity" +
              ProdOrderComp3."Expected Quantity" - ProdOrderComp3."Reserved Quantity");
            IF ProdOrderLine3."Planning Level Code" < ProdOrderComp3."Planning Level Code" THEN
              ProdOrderLine3."Planning Level Code" := ProdOrderComp3."Planning Level Code";
            AdjustDateAndTime(ProdOrderLine3,ProdOrderComp3."Due Date",ProdOrderComp3."Due Date",ProdOrderComp3."Due Time");
            UpdateCompPlanningLevel(ProdOrderLine3);
            CalcProdOrder.Recalculate(ProdOrderLine3,Direction::Backward,LetDueDateDecrease);
            ProdOrderLine3.MODIFY;
          END;
        UNTIL ProdOrderComp3.NEXT = 0;
      TempOldProdOrderComp.DELETEALL;
    END;

    LOCAL PROCEDURE CopyProdOrderCompToTemp@14(ProdOrderLine3@1000 : Record 5406);
    VAR
      ProdOrderComp2@1001 : Record 5407;
    BEGIN
      TempOldProdOrderComp.DELETEALL;
      ProdOrderComp2.SETRANGE(Status,ProdOrderLine3.Status);
      ProdOrderComp2.SETRANGE("Prod. Order No.",ProdOrderLine3."Prod. Order No.");
      ProdOrderComp2.SETRANGE("Prod. Order Line No.",ProdOrderLine3."Line No.");
      IF ProdOrderComp2.FINDSET THEN
        REPEAT
          TempOldProdOrderComp := ProdOrderComp2;
          TempOldProdOrderComp.INSERT;
        UNTIL ProdOrderComp2.NEXT = 0;
    END;

    LOCAL PROCEDURE IsReplSystemProdOrder@16(ItemNo@1001 : Code[20];VariantCode@1003 : Code[10];LocationCode@1004 : Code[10]) : Boolean;
    VAR
      SKU@1000 : Record 5700;
      Item@1002 : Record 27;
    BEGIN
      IF SKU.GET(LocationCode,ItemNo,VariantCode) THEN
        EXIT(SKU."Replenishment System" = SKU."Replenishment System"::"Prod. Order");

      Item.GET(ItemNo);
      EXIT(Item."Replenishment System" = Item."Replenishment System"::"Prod. Order");
    END;

    LOCAL PROCEDURE __INC__@1101103000();
    BEGIN
    END;

    [Integration(FALSE,FALSE)]
    LOCAL PROCEDURE OnBeforeUpdateDatetime@1101103001(VAR ProdOrderLineP@1101103000 : Record 5406;VAR SalesLineP@1101103001 : Record 37);
    BEGIN
    END;

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 07.09.17 JAL Item Calculation (Kalkyle)
                       Transfering "Calclation No."
    }
    END.
  }
}

OBJECT MenuSuite 1053 Dept - ICA
{
  OBJECT-PROPERTIES
  {
    Date=08.09.17;
    Time=08.28.18;
    Modified=Yes;
    Version List=ICA2.01;
  }
  PROPERTIES
  {
  }
  MENUNODES
  {
    {                ;[{8B53F309-FB1D-47BA-A2FE-1460E0D5ECDB}] ;NextNodeID=[{7D84E2C7-9D7A-4DA2-87C1-DDBB9435B63C}] }
    { MenuItem       ;[{7D84E2C7-9D7A-4DA2-87C1-DDBB9435B63C}] ;Name=Item Tracking Codes;
                                                                CaptionML=[ENU=Item Tracking Codes;
                                                                           NOR=Varesporingskoder];
                                                                RunObjectType=Page;
                                                                RunObjectID=6502;
                                                                Visible=Yes;
                                                                DepartmentCategory=Lists }
    { MenuItem       ;[{49448471-4DCE-4BAC-B6A9-BD8614D01A48}] ;Name=Transfer Routes;
                                                                CaptionML=[ENU=Transfer Routes;
                                                                           NOR=Overf›ringsruter];
                                                                RunObjectType=Page;
                                                                RunObjectID=5747;
                                                                Visible=Yes;
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{81D2CE2C-6499-43ED-9A0B-398248B6B87B}] ;Name=Item Journal Templates;
                                                                CaptionML=[ENU=Item Journal Templates;
                                                                           NOR=Varekladdemaler];
                                                                RunObjectType=Page;
                                                                RunObjectID=102;
                                                                Visible=Yes;
                                                                DepartmentCategory=Lists }
    { MenuItem       ;[{7CEA59FF-A695-44FD-A274-BF6178760FD7}] ;Name=Report Selections Inventory;
                                                                CaptionML=[ENU=Report Selections Inventory;
                                                                           NOR=Rapportvalg - beholdning];
                                                                RunObjectType=Page;
                                                                RunObjectID=5754;
                                                                Visible=Yes;
                                                                NextNodeID=[{00000000-0000-0000-0000-000000000000}];
                                                                DepartmentCategory=Tasks }
    {                ;[{502E3FFC-A7CC-48F7-88A4-89A841F0C628}] ;NextNodeID=[{F17F96B7-D5DF-4C82-B90E-D172A36E4942}] }
    { MenuItem       ;[{F17F96B7-D5DF-4C82-B90E-D172A36E4942}] ;Name=Incoming Documents Setup;
                                                                CaptionML=[ENU=Incoming Documents Setup;
                                                                           NOR=Oppsett for inng†ende dokumenter];
                                                                ApplicationArea=#Suite;
                                                                RunObjectType=Page;
                                                                RunObjectID=191;
                                                                Visible=Yes;
                                                                DepartmentCategory=Tasks }
    {                ;[{BAD8AF38-254A-4266-AF07-EDC55674B5FA}] ;NextNodeID=[{A2E2F2F9-5AB0-4C65-9A60-F9BAE2B24023}] }
    { MenuItem       ;[{A2E2F2F9-5AB0-4C65-9A60-F9BAE2B24023}] ;Name=VAT Clauses;
                                                                CaptionML=[ENU=VAT Clauses;
                                                                           NOR=Mva-setninger];
                                                                ApplicationArea=#Basic,#Suite;
                                                                RunObjectType=Page;
                                                                RunObjectID=747;
                                                                Visible=Yes;
                                                                DepartmentCategory=Administration }
    {                ;[{9474DF8C-B0E7-4FED-AF54-367E0639F7B0}] ;NextNodeID=[{C68C0462-288A-42CC-8BC7-6F224D8846CE}] }
    { MenuItem       ;[{C68C0462-288A-42CC-8BC7-6F224D8846CE}] ;Name=VAT Clauses;
                                                                CaptionML=[ENU=VAT Clauses;
                                                                           NOR=Mva-setninger];
                                                                ApplicationArea=#Basic,#Suite;
                                                                RunObjectType=Page;
                                                                RunObjectID=747;
                                                                Visible=Yes;
                                                                DepartmentCategory=Tasks }
    {                ;[{44DC36A4-3D38-427C-B37D-02811193E52A}] ;NextNodeID=[{E0433AFB-5B38-4E2F-ADE7-0317B7ADE93D}] }
    { MenuItem       ;[{E0433AFB-5B38-4E2F-ADE7-0317B7ADE93D}] ;Name=Application Area;
                                                                CaptionML=[ENU=Application Area;
                                                                           NOR=Modul];
                                                                ApplicationArea=#All;
                                                                RunObjectType=Page;
                                                                RunObjectID=9179;
                                                                Visible=Yes;
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{9CBA63AC-73D3-438F-818D-476B76D5DB75}] ;Name=Data Exchange Definition;
                                                                CaptionML=[ENU=Data Exchange Definitions;
                                                                           NOR=Datautvekslingsdefinisjoner];
                                                                ApplicationArea=#Basic,#Suite;
                                                                RunObjectType=Page;
                                                                RunObjectID=1211;
                                                                Visible=Yes;
                                                                DepartmentCategory=Lists }
    { MenuItem       ;[{BB2D12FC-2EEB-4165-869B-098BBB42C6F6}] ;Name=Bank Export/Import Setup;
                                                                CaptionML=[ENU=Bank Export/Import Setup;
                                                                           NOR=Konfigurasjon av bankeksport/-import];
                                                                ApplicationArea=#Basic,#Suite;
                                                                RunObjectType=Page;
                                                                RunObjectID=1200;
                                                                Visible=Yes;
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{C0BECAC0-F100-4C39-BBCA-714333A54406}] ;Name=SEPA Schema Viewer;
                                                                CaptionML=[ENU=SEPA Schema Viewer;
                                                                           NOR=Visningsprogram for SEPA-skjema];
                                                                ApplicationArea=#Basic,#Suite;
                                                                RunObjectType=Page;
                                                                RunObjectID=9610;
                                                                Visible=Yes;
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{7FD6154D-F047-4A31-B857-0DA1E0BA97D8}] ;Name=XML Schemas;
                                                                CaptionML=[ENU=XML Schemas;
                                                                           NOR=XML-skjemaer];
                                                                ApplicationArea=#Basic,#Suite;
                                                                RunObjectType=Page;
                                                                RunObjectID=9600;
                                                                Visible=Yes;
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{E55ED739-BBB9-4063-AF58-225E99C5FE72}] ;Name=Document Sending Profiles;
                                                                CaptionML=[ENU=Document Sending Profiles;
                                                                           NOR=Profiler for dokumentsending];
                                                                ApplicationArea=#Basic,#Suite;
                                                                RunObjectType=Page;
                                                                RunObjectID=359;
                                                                Visible=Yes;
                                                                DepartmentCategory=Lists }
    { MenuItem       ;[{379BBC3B-5EBB-4617-8419-8D76352F8337}] ;Name=Electronic Document Formats;
                                                                CaptionML=[ENU=Electronic Document Formats;
                                                                           NOR=Elektroniske dokumentformater];
                                                                ApplicationArea=#Suite;
                                                                RunObjectType=Page;
                                                                RunObjectID=363;
                                                                Visible=Yes;
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{8A3934DD-BE0A-4851-B8E0-50A64106B98A}] ;Name=Data Exchange Types;
                                                                CaptionML=[ENU=Data Exchange Types;
                                                                           NOR=Datautvekslingstyper];
                                                                ApplicationArea=#Basic,#Suite;
                                                                RunObjectType=Page;
                                                                RunObjectID=1213;
                                                                Visible=Yes;
                                                                DepartmentCategory=Administration }
    { MenuItem       ;[{0D3D0EB4-59D7-4D3E-95AC-49CD269C6C04}] ;Name=Data Migration Settings;
                                                                AccessByPermission=TableData 1806=R;
                                                                CaptionML=[ENU=Data Migration Settings;
                                                                           NOR=Innstillinger for datamigrering];
                                                                ApplicationArea=#Basic,#Suite;
                                                                RunObjectType=Page;
                                                                RunObjectID=1807;
                                                                Visible=Yes;
                                                                DepartmentCategory=Administration }
    { MenuItem       ;[{00646221-3EEF-4883-8640-FECFD9BEC705}] ;Name=Report Configuration;
                                                                AccessByPermission=TableData 2000000196=IMD;
                                                                CaptionML=[ENU=Report Settings;
                                                                           NOR=Rapportinnstillinger];
                                                                ApplicationArea=#Basic,#Suite;
                                                                RunObjectType=Page;
                                                                RunObjectID=1560;
                                                                Visible=Yes;
                                                                DepartmentCategory=Administration }
    { MenuItem       ;[{A1E3A413-B0C4-4D20-8B1F-AFF7DFFDB43C}] ;Name=Setup and Help Resources;
                                                                CaptionML=[ENU=Setup and Help Resources;
                                                                           NOR=Ressurser for oppsett og hjelp];
                                                                ApplicationArea=#Basic,#Suite;
                                                                RunObjectType=Page;
                                                                RunObjectID=1822;
                                                                Visible=Yes;
                                                                NextNodeID=[{4D3D68E9-6A4A-4F4A-8D33-747D76821EC8}];
                                                                DepartmentCategory=Administration }
    {                ;[{387B2D8D-4249-4D63-BE9C-850416EA6E81}] ;NextNodeID=[{34E4BEA4-29EB-4579-8568-973A8449A4A1}] }
    { MenuItem       ;[{34E4BEA4-29EB-4579-8568-973A8449A4A1}] ;Name=Certificates of Supply;
                                                                CaptionML=[ENU=Certificates of Supply;
                                                                           NOR=Mottaksdeklarasjoner];
                                                                RunObjectType=Page;
                                                                RunObjectID=780;
                                                                Visible=Yes;
                                                                NextNodeID=[{3E2FEC16-BE73-41A6-94E5-BAFFDE0CFB12}];
                                                                DepartmentCategory=Lists }
    {                ;[{A07A2127-D15F-4AF6-8301-EC0DA819FAE6}] ;NextNodeID=[{B0697E0F-6AD6-425A-9E5C-F0BD41F9BC72}] }
    { MenuGroup      ;[{B0697E0F-6AD6-425A-9E5C-F0BD41F9BC72}] ;Name=New Group;
                                                                CaptionML=[ENU=Employee Portal;
                                                                           NOR=Employee Portal];
                                                                Visible=Yes }
    { MenuItem       ;[{A02D2F44-548D-425D-9FAD-D71147A50DF8}] ;Name=Price Calculation List;
                                                                CaptionML=[ENU=Item Calculation List;
                                                                           NOR=Kalkyle oversikt];
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{2DC8C4FE-7346-4124-8C20-383346384C03}];
                                                                RunObjectType=Page;
                                                                RunObjectID=73053;
                                                                ParentNodeID=[{0DD141CC-3311-4CB7-BE8C-9E20E331DF60}];
                                                                Visible=Yes;
                                                                NextNodeID=[{3F737A35-4EB3-4547-AB7E-9A56C495CD6E}];
                                                                DepartmentCategory=Lists }
    {                ;[{3F539A17-15A5-4AB8-A7C1-81C41EEC08DB}] ;NextNodeID=[{A02D2F44-548D-425D-9FAD-D71147A50DF8}] }
  }
}
OBJECT Page 46 Sales Order Subform
{
  OBJECT-PROPERTIES
  {
    Date=08.09.17;
    Time=09.36.35;
    Modified=Yes;
    Version List=NAVW110.00.00.16585,NAVNO10.00.00.16585,ICA2.01;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Lines;
               NOR=Linjer];
    MultipleNewLines=Yes;
    LinksAllowed=No;
    SourceTable=Table37;
    DelayedInsert=Yes;
    SourceTableView=WHERE(Document Type=FILTER(Order));
    PageType=ListPart;
    AutoSplitKey=Yes;
    OnInit=BEGIN
             SalesSetup.GET;
             Currency.InitRoundingPrecision;
           END;

    OnOpenPage=VAR
                 Location@1000 : Record 14;
               BEGIN
                 IF Location.READPERMISSION THEN
                   LocationCodeVisible := NOT Location.ISEMPTY;
               END;

    OnAfterGetRecord=BEGIN
                       ShowShortcutDimCode(ShortcutDimCode);
                     END;

    OnNewRecord=BEGIN
                  IF ApplicationAreaSetup.IsFoundationEnabled THEN
                    Type := Type::Item
                  ELSE
                    InitType;
                  CLEAR(ShortcutDimCode);
                END;

    OnInsertRecord=BEGIN
                     IF ApplicationAreaSetup.IsFoundationEnabled THEN
                       Type := Type::Item;
                   END;

    OnDeleteRecord=VAR
                     ReserveSalesLine@1000 : Codeunit 99000832;
                   BEGIN
                     IF (Quantity <> 0) AND ItemExists("No.") THEN BEGIN
                       COMMIT;
                       IF NOT ReserveSalesLine.DeleteLineConfirm(Rec) THEN
                         EXIT(FALSE);
                       ReserveSalesLine.DeleteLine(Rec);
                     END;
                   END;

    OnAfterGetCurrRecord=BEGIN
                           CalculateTotals;
                           SetLocationCodeMandatory;
                           UpdateEditableOnRow;
                         END;

    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1907935204;1 ;ActionGroup;
                      CaptionML=[ENU=&Line;
                                 NOR=&Linje];
                      Image=Line }
      { 1906587504;2 ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 NOR=F&unksjoner];
                      Image=Action }
      { 1905623604;3 ;Action    ;
                      Name=GetPrice;
                      AccessByPermission=TableData 7002=R;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Get Price;
                                 NOR=Hent pris];
                      Image=Price;
                      OnAction=BEGIN
                                 ShowPrices;
                               END;
                                }
      { 1901770504;3 ;Action    ;
                      AccessByPermission=TableData 7004=R;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Get Li&ne Discount;
                                 NOR=Hent li&njerabatt];
                      Image=LineDiscount;
                      OnAction=BEGIN
                                 ShowLineDisc
                               END;
                                }
      { 1901741804;3 ;Action    ;
                      Name=ExplodeBOM_Functions;
                      AccessByPermission=TableData 90=R;
                      CaptionML=[ENU=E&xplode BOM;
                                 NOR=U&tfold stykkliste];
                      Image=ExplodeBOM;
                      OnAction=BEGIN
                                 ExplodeBOM;
                               END;
                                }
      { 1903099004;3 ;Action    ;
                      Name=Insert Ext. Texts;
                      AccessByPermission=TableData 279=R;
                      CaptionML=[ENU=Insert &Ext. Texts;
                                 NOR=Sett inn &utv. tekster];
                      ToolTipML=[ENU=Insert the extended item description that is set up for the item on the sales document line.;
                                 NOR=Sett inn den utvidede varebeskrivelsen som er definert for varen p† salgsdokumentlinjen.];
                      ApplicationArea=#Basic,#Suite;
                      Image=Text;
                      OnAction=BEGIN
                                 InsertExtendedText(TRUE);
                               END;
                                }
      { 1905427504;3 ;Action    ;
                      Name=Reserve;
                      Ellipsis=Yes;
                      CaptionML=[ENU=&Reserve;
                                 NOR=Re&server];
                      Image=Reserve;
                      OnAction=BEGIN
                                 FIND;
                                 ShowReservation;
                               END;
                                }
      { 1903502504;3 ;Action    ;
                      Name=OrderTracking;
                      CaptionML=[ENU=Order &Tracking;
                                 NOR=&Ordresporing];
                      Image=OrderTracking;
                      OnAction=BEGIN
                                 ShowTracking;
                               END;
                                }
      { 1905968604;3 ;Action    ;
                      AccessByPermission=TableData 5718=R;
                      CaptionML=[ENU=Nonstoc&k Items;
                                 NOR=&Katalogvarer];
                      ApplicationArea=#Basic,#Suite;
                      Image=NonStockItem;
                      OnAction=BEGIN
                                 ShowNonstockItems;
                               END;
                                }
      { 1101103001;3 ;Action    ;
                      Name=Item Calculation;
                      CaptionML=[ENU=Item Calculation;
                                 NOR=Kalkyle];
                      Promoted=Yes;
                      Image=PriceAdjustment;
                      PromotedCategory=Process }
      { 1900580804;2 ;ActionGroup;
                      CaptionML=[ENU=Item Availability by;
                                 NOR=Varetilgjengelighet per];
                      Image=ItemAvailability }
      { 5       ;3   ;Action    ;
                      Name=<Action3>;
                      CaptionML=[ENU=Event;
                                 NOR=Hendelse];
                      Image=Event;
                      OnAction=BEGIN
                                 ItemAvailFormsMgt.ShowItemAvailFromSalesLine(Rec,ItemAvailFormsMgt.ByEvent)
                               END;
                                }
      { 1904522204;3 ;Action    ;
                      CaptionML=[ENU=Period;
                                 NOR=Periode];
                      Image=Period;
                      OnAction=BEGIN
                                 ItemAvailFormsMgt.ShowItemAvailFromSalesLine(Rec,ItemAvailFormsMgt.ByPeriod)
                               END;
                                }
      { 1902056104;3 ;Action    ;
                      CaptionML=[ENU=Variant;
                                 NOR=Variant];
                      Image=ItemVariant;
                      OnAction=BEGIN
                                 ItemAvailFormsMgt.ShowItemAvailFromSalesLine(Rec,ItemAvailFormsMgt.ByVariant)
                               END;
                                }
      { 1900639404;3 ;Action    ;
                      AccessByPermission=TableData 14=R;
                      CaptionML=[ENU=Location;
                                 NOR=Lokasjon];
                      Image=Warehouse;
                      OnAction=BEGIN
                                 ItemAvailFormsMgt.ShowItemAvailFromSalesLine(Rec,ItemAvailFormsMgt.ByLocation)
                               END;
                                }
      { 15      ;3   ;Action    ;
                      CaptionML=[ENU=BOM Level;
                                 NOR=Stykklisteniv†];
                      Image=BOMLevel;
                      OnAction=BEGIN
                                 ItemAvailFormsMgt.ShowItemAvailFromSalesLine(Rec,ItemAvailFormsMgt.ByBOM)
                               END;
                                }
      { 33      ;2   ;ActionGroup;
                      CaptionML=[ENU=Related Information;
                                 NOR=Relatert informasjon] }
      { 1900186704;3 ;Action    ;
                      AccessByPermission=TableData 27=R;
                      CaptionML=[ENU=Reservation Entries;
                                 NOR=Reservasjonsposter];
                      Image=ReservationLedger;
                      OnAction=BEGIN
                                 ShowReservationEntries(TRUE);
                               END;
                                }
      { 1905987604;3 ;Action    ;
                      Name=ItemTrackingLines;
                      ShortCutKey=Shift+Ctrl+I;
                      CaptionML=[ENU=Item &Tracking Lines;
                                 NOR=Vare&sporingslinjer];
                      Image=ItemTrackingLines;
                      OnAction=BEGIN
                                 OpenItemTrackingLines;
                               END;
                                }
      { 1901633104;3 ;Action    ;
                      Name=SelectItemSubstitution;
                      AccessByPermission=TableData 5715=R;
                      CaptionML=[ENU=Select Item Substitution;
                                 NOR=Velg vareerstatning];
                      ToolTipML=[ENU=Select another item that has been set up to be sold instead of the original item if it is unavailable.;
                                 NOR=Velg en annen vare som har blitt definert til † bli solgt i stedet for den opprinnelige varen, hvis den er utilgjengelig.];
                      ApplicationArea=#Suite;
                      Image=SelectItemSubstitution;
                      OnAction=BEGIN
                                 CurrPage.SAVERECORD;
                                 ShowItemSub;
                                 CurrPage.UPDATE(TRUE);
                                 AutoReserve;
                               END;
                                }
      { 1902085804;3 ;Action    ;
                      Name=Dimensions;
                      AccessByPermission=TableData 348=R;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 NOR=Dimensjoner];
                      Image=Dimensions;
                      OnAction=BEGIN
                                 ShowDimensions;
                               END;
                                }
      { 1903418704;3 ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 NOR=&Merknader];
                      Image=ViewComments;
                      OnAction=BEGIN
                                 ShowLineComments;
                               END;
                                }
      { 1907184504;3 ;Action    ;
                      AccessByPermission=TableData 5800=R;
                      CaptionML=[ENU=Item Charge &Assignment;
                                 NOR=V&aregebyrtilordning];
                      Image=ItemCosts;
                      OnAction=BEGIN
                                 ItemChargeAssgnt;
                               END;
                                }
      { 1905403704;3 ;Action    ;
                      Name=OrderPromising;
                      AccessByPermission=TableData 99000880=R;
                      CaptionML=[ENU=Order &Promising;
                                 NOR=Ordr&ebekreftelse];
                      Image=OrderPromising;
                      OnAction=BEGIN
                                 OrderPromisingLine;
                               END;
                                }
      { 7       ;3   ;ActionGroup;
                      CaptionML=[ENU=Assemble to Order;
                                 NOR=Monter til ordre];
                      ActionContainerType=NewDocumentItems;
                      Image=AssemblyBOM }
      { 9       ;4   ;Action    ;
                      Name=AssembleToOrderLines;
                      AccessByPermission=TableData 90=R;
                      CaptionML=[ENU=Assemble-to-Order Lines;
                                 NOR=Montere til ordre - linjer];
                      OnAction=BEGIN
                                 ShowAsmToOrderLines;
                               END;
                                }
      { 11      ;4   ;Action    ;
                      AccessByPermission=TableData 90=R;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Roll Up &Price;
                                 NOR=Oppruller &pris];
                      OnAction=BEGIN
                                 RollupAsmPrice;
                               END;
                                }
      { 13      ;4   ;Action    ;
                      AccessByPermission=TableData 90=R;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Roll Up &Cost;
                                 NOR=Oppruller &kost];
                      OnAction=BEGIN
                                 RollUpAsmCost;
                               END;
                                }
      { 31      ;3   ;Action    ;
                      Name=DeferralSchedule;
                      CaptionML=[ENU=Deferral Schedule;
                                 NOR=Tidsplan for periodisering];
                      ToolTipML=[ENU=View or edit the deferral schedule that governs how revenue made with this sales document is deferred to different accounting periods when the document is posted.;
                                 NOR=Vis eller rediger tidsplanen for periodisering som styrer hvordan inntekter fra dette salgsdokumentet periodiseres til ulike regnskapsperioder n†r dokumentet bokf›res.];
                      ApplicationArea=#Suite;
                      Enabled="Deferral Code" <> '';
                      Image=PaymentPeriod;
                      OnAction=BEGIN
                                 SalesHeader.GET("Document Type","Document No.");
                                 ShowDeferrals(SalesHeader."Posting Date",SalesHeader."Currency Code");
                               END;
                                }
      { 1905926804;1 ;ActionGroup;
                      CaptionML=[ENU=O&rder;
                                 NOR=&Ordre];
                      Image=Order }
      { 1903645604;2 ;ActionGroup;
                      CaptionML=[ENU=Dr&op Shipment;
                                 NOR=Dire&kte levering];
                      Image=Delivery }
      { 1907981104;3 ;Action    ;
                      AccessByPermission=TableData 120=R;
                      CaptionML=[ENU=Purchase &Order;
                                 NOR=&Bestilling];
                      ToolTipML=[ENU=View the purchase order that is linked to the sales order, for drop shipment.;
                                 NOR=Vis bestillingen som er knyttet til ordren, for direktelevering.];
                      ApplicationArea=#Suite;
                      Image=Document;
                      OnAction=BEGIN
                                 OpenPurchOrderForm;
                               END;
                                }
      { 1903587004;2 ;ActionGroup;
                      CaptionML=[ENU=Speci&al Order;
                                 NOR=Spesi&albestilling];
                      Image=SpecialOrder }
      { 1903192904;3 ;Action    ;
                      Name=OpenSpecialPurchaseOrder;
                      AccessByPermission=TableData 120=R;
                      CaptionML=[ENU=Purchase &Order;
                                 NOR=&Bestilling];
                      Image=Document;
                      OnAction=BEGIN
                                 OpenSpecialPurchOrderForm;
                               END;
                                }
      { 666     ;2   ;Action    ;
                      Name=BlanketOrder;
                      CaptionML=[ENU=Blanket Order;
                                 NOR=Rammebestilling];
                      ToolTipML=[ENU=View the blanket sales order.;
                                 NOR=Vis rammeordren.];
                      Image=BlanketOrder;
                      OnAction=VAR
                                 SalesHeader@1000 : Record 36;
                                 BlanketSalesOrder@1001 : Page 507;
                               BEGIN
                                 TESTFIELD("Blanket Order No.");
                                 SalesHeader.SETRANGE("No.","Blanket Order No.");
                                 IF NOT SalesHeader.ISEMPTY THEN BEGIN
                                   BlanketSalesOrder.SETTABLEVIEW(SalesHeader);
                                   BlanketSalesOrder.EDITABLE := FALSE;
                                   BlanketSalesOrder.RUN;
                                 END;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the type of entity that will be posted for this sales line, such as Item, Resource, or G/L Account.;
                           NOR=Angir enhetstypen som skal bokf›res for denne salgslinjen, for eksempel vare, ressurs eller finanskonto.];
                SourceExpr=Type;
                OnValidate=BEGIN
                             NoOnAfterValidate;
                             SetLocationCodeMandatory;

                             IF xRec."No." <> '' THEN
                               RedistributeTotalsOnAfterValidate;
                           END;
                            }

    { 4   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of a general ledger account, item, resource, additional cost, or fixed asset, depending on the contents of the Type field.;
                           NOR=Angir nummeret til en finanskonto, en vare, en ressurs, en tilleggskostnad eller aktiva, avhengig av innholdet i feltet Type.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="No.";
                OnValidate=BEGIN
                             NoOnAfterValidate;
                             UpdateEditableOnRow;
                             ShowShortcutDimCode(ShortcutDimCode);

                             QuantityOnAfterValidate;
                             IF xRec."No." <> '' THEN
                               RedistributeTotalsOnAfterValidate;
                           END;
                            }

    { 1101103000;2;Field  ;
                SourceExpr="Calculation No." }

    { 68  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the cross-referenced item number. If you enter a cross reference between yours and your vendor's or customer's item number, then this number will override the standard item number when you enter the cross-reference number on a sales or purchase document.;
                           NOR=Angir varens kryssreferansenummer. Hvis du oppgir en kryssreferanse mellom ditt og leverand›rens eller kundens varenummer, vil dette nummeret overstyre standardvarenummeret n†r du oppgir kryssreferansenummeret i et salgs- eller kj›psdokument.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Cross-Reference No.";
                Visible=FALSE;
                OnValidate=BEGIN
                             NoOnAfterValidate;
                           END;

                OnLookup=BEGIN
                           CrossReferenceNoLookUp;
                           NoOnAfterValidate;
                         END;
                          }

    { 1136;2   ;Field     ;
                ToolTipML=[ENU=Specifies the IC partner code of the partner to whom you want to distribute the revenue of the sales line.;
                           NOR=Angi KI-partnerkoden for partneren som du vil distribuere inntektene for salgslinjen til.];
                SourceExpr="IC Partner Code";
                Visible=FALSE }

    { 130 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the item or account in your IC partner's company that corresponds to the item or account on the line.;
                           NOR=Angir varen eller kontoen i KI-partnerselskapet som tilsvarer varen eller kontoen p† linjen.];
                SourceExpr="IC Partner Ref. Type";
                Visible=FALSE }

    { 132 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the item or account in your IC partner's company that corresponds to the item or account on the line.;
                           NOR=Angir varen eller kontoen i KI-partnerselskapet som tilsvarer varen eller kontoen p† linjen.];
                SourceExpr="IC Partner Reference";
                Visible=FALSE }

    { 30  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a variant code for the item.;
                           NOR=Angir en variantkode for varen.];
                SourceExpr="Variant Code";
                Visible=FALSE;
                OnValidate=BEGIN
                             VariantCodeOnAfterValidate;
                           END;
                            }

    { 104 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies that a substitute is available for the item on the sales line.;
                           NOR=Angir at en erstatning er tilgjengelig for varen p† salgslinjen.];
                ApplicationArea=#Suite;
                SourceExpr="Substitution Available";
                Visible=FALSE }

    { 74  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the purchasing code for the item.;
                           NOR=Angir kj›pskoden for varen.];
                SourceExpr="Purchasing Code";
                Visible=FALSE }

    { 70  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies that this item is a nonstock item.;
                           NOR=Angir at denne varen er en katalogvare.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Nonstock;
                Visible=FALSE }

    { 78  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for the VAT product posting group of the item, resource, or general ledger account on this line.;
                           NOR=Angir koden for mva.-varebokf›ringsgruppen som gjelder for varen, ressursen eller finanskontoen p† linjen.];
                SourceExpr="VAT Prod. Posting Group";
                Visible=FALSE;
                OnValidate=BEGIN
                             RedistributeTotalsOnAfterValidate;
                           END;
                            }

    { 6   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a description of the entry, which is based on the contents of the Type and No. fields.;
                           NOR=Angir en beskrivelse av posten, som er basert p† innholdet i feltene Type og Nr.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Description;
                OnValidate=BEGIN
                             UpdateEditableOnRow;

                             IF "No." = xRec."No." THEN
                               EXIT;

                             NoOnAfterValidate;
                             ShowShortcutDimCode(ShortcutDimCode);
                             IF xRec."No." <> '' THEN
                               RedistributeTotalsOnAfterValidate;
                           END;

                ShowMandatory=TRUE;
                QuickEntry=FALSE }

    { 26  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies if your vendor will ship the items on the line directly to your customer.;
                           NOR=Angir om varene p† linjen skal leveres direkte fra leverand›ren til kunden.];
                ApplicationArea=#Suite;
                SourceExpr="Drop Shipment";
                Visible=FALSE }

    { 106 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies that the item on the sales line is a special-order item.;
                           NOR=Angir at varen p† salgslinjen er en vare som m† spesialbestilles.];
                SourceExpr="Special Order";
                Visible=FALSE }

    { 110 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a code that explains why the item is returned.;
                           NOR=Angir en kode som forklarer hvorfor varen ble returnert.];
                SourceExpr="Return Reason Code";
                Visible=FALSE }

    { 42  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the inventory location from which the items sold should be picked and where the inventory decrease is registered.;
                           NOR=Angir lagerlokasjonen som de solgte varene skal plukkes fra, og hvor lagerreduksjonen registreres.];
                SourceExpr="Location Code";
                Visible=LocationCodeVisible;
                OnValidate=BEGIN
                             LocationCodeOnAfterValidate;
                           END;

                ShowMandatory=LocationCodeMandatory;
                QuickEntry=FALSE }

    { 114 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the bin from where items on the sales order line are taken from when they are shipped.;
                           NOR=Angir hvilken hylle varene p† salgsordrelinjen skal hentes fra n†r de leveres.];
                SourceExpr="Bin Code";
                Visible=FALSE }

    { 50  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies whether a reservation can be made for items on this line.;
                           NOR=Angir om en reservasjon kan gj›res for varene p† denne linjen.];
                SourceExpr=Reserve;
                Visible=FALSE;
                OnValidate=BEGIN
                             ReserveOnAfterValidate;
                           END;
                            }

    { 8   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies how many units are being sold.;
                           NOR=Angir hvor mange enheter som selges.];
                ApplicationArea=#Basic,#Suite;
                BlankZero=Yes;
                SourceExpr=Quantity;
                Enabled=RowIsNotText;
                Editable=RowIsNotText;
                OnValidate=BEGIN
                             QuantityOnAfterValidate;
                             RedistributeTotalsOnAfterValidate;
                           END;

                ShowMandatory="No." <> '' }

    { 3   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies how many units of the sales line quantity that you want to supply by assembly.;
                           NOR=Angir hvor mange enheter av salgslinjeantallet som du vil forsyne gjennom montering.];
                BlankZero=Yes;
                SourceExpr="Qty. to Assemble to Order";
                Visible=FALSE;
                OnValidate=BEGIN
                             QtyToAsmToOrderOnAfterValidate;
                           END;

                OnDrillDown=BEGIN
                              ShowAsmToOrderLines;
                            END;
                             }

    { 48  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies how many units of the item on the line have been reserved.;
                           NOR=Angir hvor mange enheter av varen som er reservert p† linjen.];
                BlankZero=Yes;
                SourceExpr="Reserved Quantity";
                QuickEntry=FALSE }

    { 44  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the unit of measure that is used to determine the value in the Unit Price field on the sales line.;
                           NOR=Angir enheten som brukes til † fastsl† verdien i feltet Salgspris p† salgslinjen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Unit of Measure Code";
                Enabled=UnitofMeasureCodeIsChangeable;
                Editable=UnitofMeasureCodeIsChangeable;
                OnValidate=BEGIN
                             UnitofMeasureCodeOnAfterValida;
                             RedistributeTotalsOnAfterValidate;
                           END;

                QuickEntry=FALSE }

    { 10  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the unit of measure for the item or resource on the sales line.;
                           NOR=Angir enheten for varen eller ressursen p† salgslinjen.];
                SourceExpr="Unit of Measure";
                Visible=FALSE }

    { 38  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the unit cost of the item on the line.;
                           NOR=Angir enhetskosten for varen p† linjen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Unit Cost (LCY)";
                Visible=FALSE }

    { 112 ;2   ;Field     ;
                Name=SalesPriceExist;
                CaptionML=[ENU=Sales Price Exists;
                           NOR=Salgspris finnes];
                ToolTipML=[ENU=Specifies that there is a specific price for this customer.;
                           NOR=Angir at det finnes en bestemt pris for denne kunden.];
                SourceExpr=PriceExists;
                Visible=FALSE;
                Editable=FALSE }

    { 12  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the price for one unit on the sales line.;
                           NOR=Angir salgsprisen for ‚n enhet p† salgslinjen.];
                ApplicationArea=#Basic,#Suite;
                BlankZero=Yes;
                SourceExpr="Unit Price";
                Enabled=RowIsNotText;
                Editable=RowIsNotText;
                OnValidate=BEGIN
                             RedistributeTotalsOnAfterValidate;
                           END;

                ShowMandatory="No." <> '' }

    { 76  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the net amount (before subtracting the invoice discount amount) that must be paid for the items on the line.;
                           NOR=Angir nettobel›pet (f›r fakturarabattbel›pet trekkes fra) som skal betales for varene p† linjen.];
                ApplicationArea=#Basic,#Suite;
                BlankZero=Yes;
                SourceExpr="Line Amount";
                Enabled=RowIsNotText;
                Editable=RowIsNotText;
                OnValidate=BEGIN
                             RedistributeTotalsOnAfterValidate;
                           END;
                            }

    { 116 ;2   ;Field     ;
                Name=SalesLineDiscExists;
                CaptionML=[ENU=Sales Line Disc. Exists;
                           NOR=Salgslinjerab. finnes];
                ToolTipML=[ENU=Specifies that there is a specific discount for this customer.;
                           NOR=Angir at det finnes en bestemt rabatt for denne kunden.];
                SourceExpr=LineDiscExists;
                Visible=FALSE;
                Editable=FALSE }

    { 16  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the line discount percentage that is valid for the item quantity on the line.;
                           NOR=Angir linjerabattprosenten som blir gitt for vareantallet p† linjen.];
                ApplicationArea=#Basic,#Suite;
                BlankZero=Yes;
                SourceExpr="Line Discount %";
                Enabled=RowIsNotText;
                Editable=RowIsNotText;
                OnValidate=BEGIN
                             RedistributeTotalsOnAfterValidate;
                           END;
                            }

    { 52  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the amount of the discount that will be given on the invoice line.;
                           NOR=Angir rabattbel›pet som gis p† fakturalinjen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Line Discount Amount";
                Visible=FALSE;
                OnValidate=BEGIN
                             RedistributeTotalsOnAfterValidate;
                           END;
                            }

    { 136 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the prepayment percentage if a prepayment should apply to the sales line.;
                           NOR=Angir forskuddsprosenten hvis et forskudd skal gjelde for salgslinjen.];
                SourceExpr="Prepayment %";
                Visible=FALSE;
                OnValidate=BEGIN
                             RedistributeTotalsOnAfterValidate;
                           END;
                            }

    { 138 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the prepayment amount of the line in the currency of the sales document if a prepayment percentage is specified for the sales line.;
                           NOR=Angir forskuddsbel›pet for linjen i valutaen som gjelder for salgsdokumentet hvis det er angitt en forskuddsprosent for salgslinjen.];
                SourceExpr="Prepmt. Line Amount";
                Visible=FALSE;
                OnValidate=BEGIN
                             RedistributeTotalsOnAfterValidate;
                           END;
                            }

    { 140 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the prepayment amount that has already been invoiced to the customer for this sales line.;
                           NOR=Angir forskuddsbel›pet som allerede er fakturert til kunden for denne salgslinjen.];
                SourceExpr="Prepmt. Amt. Inv.";
                Visible=FALSE;
                OnValidate=BEGIN
                             RedistributeTotalsOnAfterValidate;
                           END;
                            }

    { 54  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies whether the invoice line is included when the invoice discount is calculated.;
                           NOR=Angir om fakturalinjen er inkludert n†r fakturarabatten beregnes.];
                SourceExpr="Allow Invoice Disc.";
                Visible=FALSE }

    { 90  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the invoice discount amount for the line.;
                           NOR=Angir fakturarabattbel›pet for linjen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Inv. Discount Amount";
                Visible=FALSE }

    { 18  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies how many units of the item are to be shipped when the sales order is posted.;
                           NOR=Angir hvor mange enheter av varen som skal leveres n†r ordren bokf›res.];
                ApplicationArea=#Basic,#Suite;
                BlankZero=Yes;
                SourceExpr="Qty. to Ship";
                OnValidate=BEGIN
                             IF "Qty. to Asm. to Order (Base)" <> 0 THEN BEGIN
                               CurrPage.SAVERECORD;
                               CurrPage.UPDATE(FALSE);
                             END;
                           END;
                            }

    { 20  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of units of the ordered item that have been shipped.;
                           NOR=Angir hvor mange enheter av den bestilte varen som er levert.];
                ApplicationArea=#Basic,#Suite;
                BlankZero=Yes;
                SourceExpr="Quantity Shipped";
                QuickEntry=FALSE }

    { 22  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies how much of the line should be invoiced.;
                           NOR=Angir hvor mye av linjen som skal faktureres.];
                ApplicationArea=#Basic,#Suite;
                BlankZero=Yes;
                SourceExpr="Qty. to Invoice" }

    { 24  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies how many units of the item on the line have already been invoiced.;
                           NOR=Angir hvor mange enheter av varen som allerede er fakturert p† linjen.];
                ApplicationArea=#Basic,#Suite;
                BlankZero=Yes;
                SourceExpr="Quantity Invoiced" }

    { 142 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the prepayment amount that will be deducted from the next ordinary invoice for this line.;
                           NOR=Angir forskuddsbel›pet som blir trukket fra den neste ordin‘re fakturaen for denne linjen.];
                SourceExpr="Prepmt Amt to Deduct";
                Visible=FALSE }

    { 144 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the prepayment amount that has already been deducted from ordinary invoices posted for this sales order line.;
                           NOR=Angir forskuddsbel›pet som allerede er trukket fra ordin‘re fakturaer som er bokf›rt for denne ordrelinjen.];
                SourceExpr="Prepmt Amt Deducted";
                Visible=FALSE }

    { 46  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies that you can assign item charges to this line.;
                           NOR=Angir at du kan tilordne varegebyr til denne linjen.];
                SourceExpr="Allow Item Charge Assignment";
                Visible=FALSE }

    { 5800;2   ;Field     ;
                ToolTipML=[ENU=Specifies the quantity of the item charge that will be assigned to a specified item when you post this sales line. You fill this field through the Qty. to Assign field in the Item Charge Assignment (Sales) window that you open with the Item Charge Assignment action on the Lines FastTab.;
                           NOR=Angir antallet for varegebyret som blir tilordnet til en angitt vare n†r du bokf›rer denne salgslinjen. Du fyller ut dette feltet via feltet Ant. som skal tilordnes i vinduet Varegebyrtilordning (salg), som du †pner med handlingen Varegebyrtilordning i hurtigfanen Linjer.];
                BlankZero=Yes;
                SourceExpr="Qty. to Assign";
                OnDrillDown=BEGIN
                              CurrPage.SAVERECORD;
                              ShowItemChargeAssgnt;
                              UpdateForm(FALSE);
                            END;

                QuickEntry=FALSE }

    { 102 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the quantity of the item charge that was assigned to a specified item when you posted this sales line.;
                           NOR=Angir antallet av varegebyret som ble tilordnet til en bestemt vare da du bokf›rte salgslinjen.];
                BlankZero=Yes;
                SourceExpr="Qty. Assigned";
                OnDrillDown=BEGIN
                              CurrPage.SAVERECORD;
                              ShowItemChargeAssgnt;
                              CurrPage.UPDATE(FALSE);
                            END;

                QuickEntry=FALSE }

    { 82  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date that the customer has asked for the order to be delivered.;
                           NOR=Angir p† hvilken dato kunden har bedt om at ordren skal leveres.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Requested Delivery Date";
                Visible=FALSE;
                OnValidate=BEGIN
                             UpdateForm(TRUE);
                           END;
                            }

    { 84  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date that you have promised to deliver the order, as a result of the Order Promising function.;
                           NOR=Angir datoen da du har lovet † levere ordren som et resultat av funksjonen Ordrebekreftelse.];
                SourceExpr="Promised Delivery Date";
                Visible=FALSE;
                OnValidate=BEGIN
                             UpdateForm(TRUE);
                           END;
                            }

    { 86  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the planned date that the shipment will be delivered at the customer's address.;
                           NOR=Angir planlagt dato for n†r leveringen skal leveres til kundens adresse.];
                SourceExpr="Planned Delivery Date";
                OnValidate=BEGIN
                             UpdateForm(TRUE);
                           END;

                QuickEntry=FALSE }

    { 88  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date that the shipment should ship from the warehouse.;
                           NOR=Angir datoen for n†r leveringen skal sendes fra lageret.];
                SourceExpr="Planned Shipment Date";
                OnValidate=BEGIN
                             UpdateForm(TRUE);
                           END;
                            }

    { 100 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date that the items on the line are in inventory and available to be picked.;
                           NOR=Angir datoen for n†r varene p† linjen finnes p† lager og er tilgjengelig for plukking.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Shipment Date";
                OnValidate=BEGIN
                             ShipmentDateOnAfterValidate;
                           END;

                QuickEntry=FALSE }

    { 92  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code that represents the shipping agent.;
                           NOR=Angir koden som representerer transport›ren.];
                ApplicationArea=#Suite;
                SourceExpr="Shipping Agent Code";
                Visible=FALSE }

    { 94  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code that represents a shipping agent service.;
                           NOR=Angir koden som representerer en transport›rtjeneste.];
                ApplicationArea=#Suite;
                SourceExpr="Shipping Agent Service Code";
                Visible=FALSE }

    { 96  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies how long it takes from when the sales order line is shipped from the warehouse to when the order is delivered.;
                           NOR=Angir hvor lang tid det tar fra ordren leveres fra lageret til ordrelinjen er levert til kundens adresse.];
                SourceExpr="Shipping Time";
                Visible=FALSE }

    { 134 ;2   ;Field     ;
                ToolTipML=[ENU=Belongs to the Job application area.;
                           NOR=H›rer til modulen Prosjekt.];
                SourceExpr="Work Type Code";
                Visible=FALSE }

    { 17  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies how many units on the sales order line remain to be handled in warehouse documents.;
                           NOR=Angir hvor mange enheter p† ordrelinjen som fremdeles m† h†ndteres i lagerdokumenter.];
                SourceExpr="Whse. Outstanding Qty.";
                Visible=FALSE }

    { 58  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies how many units on the sales order line remain to be handled in warehouse documents.;
                           NOR=Angir hvor mange enheter p† ordrelinjen som fremdeles m† h†ndteres i lagerdokumenter.];
                SourceExpr="Whse. Outstanding Qty. (Base)";
                Visible=FALSE }

    { 19  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies how many assemble-to-order units on the sales order line need to be assembled and handled in warehouse documents.;
                           NOR=Angir hvor mange monter-til-ordre-enheter p† salgsordrelinjen som m† monteres og h†ndteres i lagerdokumenter.];
                SourceExpr="ATO Whse. Outstanding Qty.";
                Visible=FALSE }

    { 21  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies how many assemble-to-order units on the sales order line remain to be assembled and handled in warehouse documents.;
                           NOR=Angir hvor mange monter-til-ordre-enheter p† ordrelinjen som m† monteres og h†ndteres i lagerdokumenter.];
                SourceExpr="ATO Whse. Outstd. Qty. (Base)";
                Visible=FALSE }

    { 98  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the outbound warehouse handling time.;
                           NOR=Angir utg†ende lagerbehandlingstid.];
                SourceExpr="Outbound Whse. Handling Time";
                Visible=FALSE }

    { 62  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the document number of the blanket order from which this sales line originates.;
                           NOR=Angir dokumentnummeret til rammeordren som denne ordrelinjen stammer fra.];
                SourceExpr="Blanket Order No.";
                Visible=FALSE }

    { 66  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the line number of the blanket order line from which this sales line originates.;
                           NOR=Angir linjenummeret til rammebestillingslinjen som denne salgslinjen stammer fra.];
                SourceExpr="Blanket Order Line No.";
                Visible=FALSE }

    { 14  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date that will be used as the FA posting date on FA ledger entries.;
                           NOR=Angir datoen som skal brukes som aktivabokf›ringsdatoen i aktivaposter.];
                SourceExpr="FA Posting Date";
                Visible=FALSE }

    { 40  ;2   ;Field     ;
                ToolTipML=[ENU=You can use this field if you have selected Fixed Asset in the Type field for this line.;
                           NOR=Du kan bruke dette feltet hvis du har valgt Aktiva i feltet Type for denne linjen.];
                SourceExpr="Depr. until FA Posting Date";
                Visible=FALSE }

    { 36  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for the depreciation book to which the line will be posted if you have selected Fixed Asset in the Type field for this line.;
                           NOR=Angir koden for avskrivningstabl†et som linjen skal bokf›res i hvis du har valgt Aktiva i feltet Type for denne linjen.];
                SourceExpr="Depreciation Book Code";
                Visible=FALSE }

    { 80  ;2   ;Field     ;
                ToolTipML=[ENU=You can use this field if you have selected Fixed Asset in the Type field for this line.;
                           NOR=Du kan bruke dette feltet hvis du har valgt Aktiva i feltet Type for denne linjen.];
                SourceExpr="Use Duplication List";
                Visible=FALSE }

    { 56  ;2   ;Field     ;
                ToolTipML=[ENU=You can use this field if you have selected Fixed Asset in the Type field for this line.;
                           NOR=Du kan bruke dette feltet hvis du har valgt Aktiva i feltet Type for denne linjen.];
                SourceExpr="Duplicate in Depreciation Book";
                Visible=FALSE }

    { 108 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the item ledger entry that the sales credit memo line is applied from.;
                           NOR=Angir nummeret p† vareposten som salgskreditnotalinjen er utlignet fra.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Appl.-from Item Entry";
                Visible=FALSE }

    { 60  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the item ledger entry number the line should be applied to.;
                           NOR=Angir varepostnummeret som linjen skal utlignes mot.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Appl.-to Item Entry";
                Visible=FALSE }

    { 29  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the deferral template that governs how revenue earned with this sales document is deferred to the different accounting periods when the good or service was delivered.;
                           NOR=Angir periodiseringsmalen som styrer hvordan inntekter fra dette salgsdokumentet periodiseres til de ulike regnskapsperiodene n†r varen eller servicen ble levert.];
                ApplicationArea=#Suite;
                SourceExpr="Deferral Code";
                TableRelation="Deferral Template"."Deferral Code";
                Visible=FALSE;
                Enabled=(Type <> Type::"Fixed Asset") AND (Type <> Type::" ") }

    { 32  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for Shortcut Dimension 1.;
                           NOR=Angir koden for Snarveisdimensjon 1.];
                ApplicationArea=#Suite;
                SourceExpr="Shortcut Dimension 1 Code";
                Visible=FALSE }

    { 34  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for Shortcut Dimension 2.;
                           NOR=Angir koden for Snarveisdimensjon 2.];
                ApplicationArea=#Suite;
                SourceExpr="Shortcut Dimension 2 Code";
                Visible=FALSE }

    { 300 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[3];
                CaptionClass='1,2,3';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(3),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(3,ShortcutDimCode[3]);
                           END;
                            }

    { 302 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[4];
                CaptionClass='1,2,4';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(4),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(4,ShortcutDimCode[4]);
                           END;
                            }

    { 304 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[5];
                CaptionClass='1,2,5';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(5),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateSaveShortcutDimCode(5,ShortcutDimCode[5]);
                           END;
                            }

    { 306 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[6];
                CaptionClass='1,2,6';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(6),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateSaveShortcutDimCode(6,ShortcutDimCode[6]);
                           END;
                            }

    { 308 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[7];
                CaptionClass='1,2,7';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(7),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateSaveShortcutDimCode(7,ShortcutDimCode[7]);
                           END;
                            }

    { 310 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[8];
                CaptionClass='1,2,8';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(8),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateSaveShortcutDimCode(8,ShortcutDimCode[8]);
                           END;
                            }

    { 146 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the document number.;
                           NOR=Angir dokumentnummeret.];
                SourceExpr="Document No.";
                Visible=FALSE;
                Editable=FALSE }

    { 148 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the line number.;
                           NOR=Angir linjenummeret.];
                SourceExpr="Line No.";
                Visible=FALSE;
                Editable=FALSE }

    { 1080002;2;Field     ;
                ToolTipML=[ENU=Specifies the account code of the customer.;
                           NOR=Angir kontokoden for kunden.];
                SourceExpr="Account Code";
                Visible=FALSE }

    { 51  ;1   ;Group     ;
                GroupType=Group }

    { 45  ;2   ;Group     ;
                GroupType=Group }

    { 35  ;3   ;Field     ;
                CaptionML=[ENU=Subtotal Excl. VAT;
                           NOR=Delsum ekskl. mva];
                ToolTipML=[ENU=Specifies the sum of the value in the Line Amount Excl. VAT field on all lines in the document.;
                           NOR=Angir summen av verdien i feltet Linjebel›p ekskl. mva p† alle linjer i dokumentet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=TotalSalesLine."Line Amount";
                AutoFormatType=1;
                AutoFormatExpr=Currency.Code;
                CaptionClass=DocumentTotals.GetTotalLineAmountWithVATAndCurrencyCaption(Currency.Code,TotalSalesHeader."Prices Including VAT");
                Editable=FALSE }

    { 43  ;3   ;Field     ;
                Name=Invoice Discount Amount;
                CaptionML=[ENU=Invoice Discount Amount;
                           NOR=Fakturarabattbel›p];
                ToolTipML=[ENU=Specifies a discount amount that is deducted from the value in the Total Incl. VAT field. You can enter or change the amount manually.;
                           NOR=Angir et rabattbel›p som blir trukket fra verdien i feltet Totalt inkl. mva. Du kan oppgi eller endre bel›pet manuelt.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=InvoiceDiscountAmount;
                AutoFormatType=1;
                AutoFormatExpr=Currency.Code;
                CaptionClass=DocumentTotals.GetInvoiceDiscAmountWithVATAndCurrencyCaption(FIELDCAPTION("Inv. Discount Amount"),Currency.Code);
                Editable=InvDiscAmountEditable;
                OnValidate=BEGIN
                             ValidateInvoiceDiscountAmount;
                           END;
                            }

    { 41  ;3   ;Field     ;
                Name=Invoice Disc. Pct.;
                CaptionML=[ENU=Invoice Discount %;
                           NOR=Fakturarabatt %];
                ToolTipML=[ENU=Specifies a discount percentage that is granted if criteria that you have set up for the customer are met.;
                           NOR=Angir en rabattprosent som gis hvis kriteriene du har definert for kunden, oppfylles.];
                ApplicationArea=#Basic,#Suite;
                DecimalPlaces=0:2;
                SourceExpr=InvoiceDiscountPct;
                Editable=InvDiscAmountEditable;
                OnValidate=BEGIN
                             InvoiceDiscountAmount := ROUND(TotalSalesLine."Line Amount" * InvoiceDiscountPct / 100,Currency."Amount Rounding Precision");
                             ValidateInvoiceDiscountAmount;
                           END;
                            }

    { 28  ;2   ;Group     ;
                GroupType=Group }

    { 27  ;3   ;Field     ;
                Name=Total Amount Excl. VAT;
                DrillDown=No;
                CaptionML=[ENU=Total Amount Excl. VAT;
                           NOR=Totalbel›p ekskl. mva];
                ToolTipML=[ENU=Specifies the sum of the value in the Line Amount Excl. VAT field on all lines in the document minus any discount amount in the Invoice Discount Amount field.;
                           NOR=Angir summen av verdien i feltet Linjebel›p ekskl. MVA p† alle linjer i dokumentet, minus eventuelle rabattbel›p i feltet Fakturarabattbel›p.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=TotalSalesLine.Amount;
                AutoFormatType=1;
                AutoFormatExpr=Currency.Code;
                CaptionClass=DocumentTotals.GetTotalExclVATCaption(Currency.Code);
                Editable=FALSE }

    { 25  ;3   ;Field     ;
                Name=Total VAT Amount;
                CaptionML=[ENU=Total VAT;
                           NOR=Total mva];
                ToolTipML=[ENU=Specifies the sum of VAT amounts on all lines in the document.;
                           NOR=Angir summen av mva-bel›pene p† alle linjene i dokumentet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=VATAmount;
                AutoFormatType=1;
                AutoFormatExpr=Currency.Code;
                CaptionClass=DocumentTotals.GetTotalVATCaption(Currency.Code);
                Editable=FALSE }

    { 23  ;3   ;Field     ;
                Name=Total Amount Incl. VAT;
                CaptionML=[ENU=Total Amount Incl. VAT;
                           NOR=Totalbel›p inkl. mva];
                ToolTipML=[ENU=Specifies the sum of the value in the Line Amount Incl. VAT field on all lines in the document minus any discount amount in the Invoice Discount Amount field.;
                           NOR=Angir summen av verdien i feltet Linjebel›p inkl. MVA p† alle linjer i dokumentet, minus eventuelle rabattbel›p i feltet Fakturarabattbel›p.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=TotalSalesLine."Amount Including VAT";
                AutoFormatType=1;
                AutoFormatExpr=Currency.Code;
                CaptionClass=DocumentTotals.GetTotalInclVATCaption(Currency.Code);
                Editable=FALSE }

  }
  CODE
  {
    VAR
      Currency@1021 : Record 4;
      TotalSalesHeader@1016 : Record 36;
      TotalSalesLine@1009 : Record 37;
      SalesHeader@1000 : Record 36;
      ApplicationAreaSetup@1010 : Record 9178;
      SalesSetup@1015 : Record 311;
      SalesPriceCalcMgt@1006 : Codeunit 7000;
      TransferExtendedText@1002 : Codeunit 378;
      ItemAvailFormsMgt@1001 : Codeunit 353;
      SalesCalcDiscountByType@1008 : Codeunit 56;
      DocumentTotals@1007 : Codeunit 57;
      VATAmount@1005 : Decimal;
      ShortcutDimCode@1003 : ARRAY [8] OF Code[20];
      Text001@1004 : TextConst 'ENU=You cannot use the Explode BOM function because a prepayment of the sales order has been invoiced.;NOR=Du kan ikke bruke funksjonen Utfold stykkliste fordi det er fakturert et forskudd p† ordren.';
      LocationCodeMandatory@1017 : Boolean;
      InvDiscAmountEditable@1014 : Boolean;
      RowIsNotText@1019 : Boolean;
      UnitofMeasureCodeIsChangeable@1011 : Boolean;
      LocationCodeVisible@1020 : Boolean;
      InvoiceDiscountAmount@1022 : Decimal;
      InvoiceDiscountPct@1023 : Decimal;
      UpdateInvDiscountQst@1024 : TextConst 'ENU=One or more lines have been invoiced. The discount distributed to invoiced lines will not be taken into account.\\Do you want to update the invoice discount?;NOR=n eller flere linjer er fakturert. Det tas ikke hensyn til rabatt som er fordelt p† fakturerte linjer.\\Vil du oppdatere fakturarabatten?';

    PROCEDURE ApproveCalcInvDisc@1();
    BEGIN
      CODEUNIT.RUN(CODEUNIT::"Sales-Disc. (Yes/No)",Rec);
    END;

    LOCAL PROCEDURE ValidateInvoiceDiscountAmount@30();
    VAR
      SalesHeader@1000 : Record 36;
    BEGIN
      SalesHeader.GET("Document Type","Document No.");
      IF SalesHeader.InvoicedLineExists THEN
        IF NOT CONFIRM(UpdateInvDiscountQst,FALSE) THEN
          EXIT;

      SalesCalcDiscountByType.ApplyInvDiscBasedOnAmt(InvoiceDiscountAmount,SalesHeader);
      CurrPage.UPDATE(FALSE);
    END;

    PROCEDURE CalcInvDisc@6();
    BEGIN
      CODEUNIT.RUN(CODEUNIT::"Sales-Calc. Discount",Rec);
    END;

    PROCEDURE ExplodeBOM@3();
    BEGIN
      IF "Prepmt. Amt. Inv." <> 0 THEN
        ERROR(Text001);
      CODEUNIT.RUN(CODEUNIT::"Sales-Explode BOM",Rec);
    END;

    PROCEDURE OpenPurchOrderForm@4();
    VAR
      PurchHeader@1000 : Record 38;
      PurchOrder@1001 : Page 50;
    BEGIN
      TESTFIELD("Purchase Order No.");
      PurchHeader.SETRANGE("No.","Purchase Order No.");
      PurchOrder.SETTABLEVIEW(PurchHeader);
      PurchOrder.EDITABLE := FALSE;
      PurchOrder.RUN;
    END;

    PROCEDURE OpenSpecialPurchOrderForm@14();
    VAR
      PurchHeader@1001 : Record 38;
      PurchRcptHeader@1002 : Record 120;
      PurchOrder@1000 : Page 50;
    BEGIN
      TESTFIELD("Special Order Purchase No.");
      PurchHeader.SETRANGE("No.","Special Order Purchase No.");
      IF NOT PurchHeader.ISEMPTY THEN BEGIN
        PurchOrder.SETTABLEVIEW(PurchHeader);
        PurchOrder.EDITABLE := FALSE;
        PurchOrder.RUN;
      END ELSE BEGIN
        PurchRcptHeader.SETRANGE("Order No.","Special Order Purchase No.");
        IF PurchRcptHeader.COUNT = 1 THEN
          PAGE.RUN(PAGE::"Posted Purchase Receipt",PurchRcptHeader)
        ELSE
          PAGE.RUN(PAGE::"Posted Purchase Receipts",PurchRcptHeader);
      END;
    END;

    PROCEDURE InsertExtendedText@5(Unconditionally@1000 : Boolean);
    BEGIN
      IF TransferExtendedText.SalesCheckIfAnyExtText(Rec,Unconditionally) THEN BEGIN
        CurrPage.SAVERECORD;
        COMMIT;
        TransferExtendedText.InsertSalesExtText(Rec);
      END;
      IF TransferExtendedText.MakeUpdate THEN
        UpdateForm(TRUE);
    END;

    PROCEDURE ShowNonstockItems@11();
    BEGIN
      ShowNonstock;
    END;

    PROCEDURE ShowTracking@13();
    VAR
      TrackingForm@1000 : Page 99000822;
    BEGIN
      TrackingForm.SetSalesLine(Rec);
      TrackingForm.RUNMODAL;
    END;

    PROCEDURE ItemChargeAssgnt@5800();
    BEGIN
      ShowItemChargeAssgnt;
    END;

    PROCEDURE UpdateForm@12(SetSaveRecord@1000 : Boolean);
    BEGIN
      CurrPage.UPDATE(SetSaveRecord);
    END;

    PROCEDURE ShowPrices@15();
    BEGIN
      SalesHeader.GET("Document Type","Document No.");
      CLEAR(SalesPriceCalcMgt);
      SalesPriceCalcMgt.GetSalesLinePrice(SalesHeader,Rec);
    END;

    PROCEDURE ShowLineDisc@16();
    BEGIN
      SalesHeader.GET("Document Type","Document No.");
      CLEAR(SalesPriceCalcMgt);
      SalesPriceCalcMgt.GetSalesLineLineDisc(SalesHeader,Rec);
    END;

    PROCEDURE OrderPromisingLine@17();
    VAR
      OrderPromisingLine@1000 : TEMPORARY Record 99000880;
      OrderPromisingLines@1001 : Page 99000959;
    BEGIN
      OrderPromisingLine.SETRANGE("Source Type","Document Type");
      OrderPromisingLine.SETRANGE("Source ID","Document No.");
      OrderPromisingLine.SETRANGE("Source Line No.","Line No.");

      OrderPromisingLines.SetSourceType(OrderPromisingLine."Source Type"::Sales);
      OrderPromisingLines.SETTABLEVIEW(OrderPromisingLine);
      OrderPromisingLines.RUNMODAL;
    END;

    LOCAL PROCEDURE NoOnAfterValidate@19066594();
    BEGIN
      IF ApplicationAreaSetup.IsFoundationEnabled THEN
        TESTFIELD(Type,Type::Item);

      InsertExtendedText(FALSE);
      IF (Type = Type::"Charge (Item)") AND ("No." <> xRec."No.") AND
         (xRec."No." <> '')
      THEN
        CurrPage.SAVERECORD;

      SaveAndAutoAsmToOrder;

      IF Reserve = Reserve::Always THEN BEGIN
        CurrPage.SAVERECORD;
        IF ("Outstanding Qty. (Base)" <> 0) AND ("No." <> xRec."No.") THEN BEGIN
          AutoReserve;
          CurrPage.UPDATE(FALSE);
        END;
      END;
    END;

    LOCAL PROCEDURE VariantCodeOnAfterValidate@21();
    BEGIN
      SaveAndAutoAsmToOrder;
    END;

    LOCAL PROCEDURE LocationCodeOnAfterValidate@19034787();
    BEGIN
      SaveAndAutoAsmToOrder;

      IF (Reserve = Reserve::Always) AND
         ("Outstanding Qty. (Base)" <> 0) AND
         ("Location Code" <> xRec."Location Code")
      THEN BEGIN
        CurrPage.SAVERECORD;
        AutoReserve;
        CurrPage.UPDATE(FALSE);
      END;
    END;

    LOCAL PROCEDURE ReserveOnAfterValidate@19004502();
    BEGIN
      IF (Reserve = Reserve::Always) AND ("Outstanding Qty. (Base)" <> 0) THEN BEGIN
        CurrPage.SAVERECORD;
        AutoReserve;
        CurrPage.UPDATE(FALSE);
      END;
    END;

    LOCAL PROCEDURE QuantityOnAfterValidate@19032465();
    VAR
      UpdateIsDone@1001 : Boolean;
    BEGIN
      IF Type = Type::Item THEN
        CASE Reserve OF
          Reserve::Always:
            BEGIN
              CurrPage.SAVERECORD;
              AutoReserve;
              CurrPage.UPDATE(FALSE);
              UpdateIsDone := TRUE;
            END;
          Reserve::Optional:
            IF (Quantity < xRec.Quantity) AND (xRec.Quantity > 0) THEN BEGIN
              CurrPage.SAVERECORD;
              CurrPage.UPDATE(FALSE);
              UpdateIsDone := TRUE;
            END;
        END;

      IF (Type = Type::Item) AND
         (Quantity <> xRec.Quantity) AND
         NOT UpdateIsDone
      THEN
        CurrPage.UPDATE(TRUE);
    END;

    LOCAL PROCEDURE QtyToAsmToOrderOnAfterValidate@19();
    BEGIN
      CurrPage.SAVERECORD;
      IF Reserve = Reserve::Always THEN
        AutoReserve;
      CurrPage.UPDATE(TRUE);
    END;

    LOCAL PROCEDURE UnitofMeasureCodeOnAfterValida@19057939();
    BEGIN
      IF Reserve = Reserve::Always THEN BEGIN
        CurrPage.SAVERECORD;
        AutoReserve;
        CurrPage.UPDATE(FALSE);
      END;
    END;

    LOCAL PROCEDURE ShipmentDateOnAfterValidate@19068710();
    BEGIN
      IF (Reserve = Reserve::Always) AND
         ("Outstanding Qty. (Base)" <> 0) AND
         ("Shipment Date" <> xRec."Shipment Date")
      THEN BEGIN
        CurrPage.SAVERECORD;
        AutoReserve;
        CurrPage.UPDATE(FALSE);
      END ELSE
        CurrPage.UPDATE(TRUE);
    END;

    LOCAL PROCEDURE SaveAndAutoAsmToOrder@20();
    BEGIN
      IF (Type = Type::Item) AND IsAsmToOrderRequired THEN BEGIN
        CurrPage.SAVERECORD;
        AutoAsmToOrder;
        CurrPage.UPDATE(FALSE);
      END;
    END;

    LOCAL PROCEDURE SetLocationCodeMandatory@22();
    VAR
      InventorySetup@1000 : Record 313;
    BEGIN
      InventorySetup.GET;
      LocationCodeMandatory := InventorySetup."Location Mandatory" AND (Type = Type::Item);
    END;

    LOCAL PROCEDURE GetTotalSalesHeader@9();
    BEGIN
      IF NOT TotalSalesHeader.GET("Document Type","Document No.") THEN
        CLEAR(TotalSalesHeader);
      IF Currency.Code <> TotalSalesHeader."Currency Code" THEN
        IF NOT Currency.GET(TotalSalesHeader."Currency Code") THEN
          Currency.InitRoundingPrecision;
    END;

    LOCAL PROCEDURE CalculateTotals@8();
    BEGIN
      GetTotalSalesHeader;
      TotalSalesHeader.CALCFIELDS("Recalculate Invoice Disc.");

      IF SalesSetup."Calc. Inv. Discount" AND ("Document No." <> '') AND (TotalSalesHeader."Customer Posting Group" <> '') AND
         TotalSalesHeader."Recalculate Invoice Disc."
      THEN
        IF FIND THEN
          CalcInvDisc;

      DocumentTotals.CalculateSalesTotals(TotalSalesLine,VATAmount,Rec);
      InvoiceDiscountAmount := TotalSalesLine."Inv. Discount Amount";
      InvoiceDiscountPct := SalesCalcDiscountByType.GetCustInvoiceDiscountPct(Rec);
    END;

    LOCAL PROCEDURE RedistributeTotalsOnAfterValidate@2();
    BEGIN
      CurrPage.SAVERECORD;

      SalesHeader.GET("Document Type","Document No.");
      DocumentTotals.SalesRedistributeInvoiceDiscountAmounts(Rec,VATAmount,TotalSalesLine);
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE ValidateSaveShortcutDimCode@7(FieldNumber@1001 : Integer;VAR ShortcutDimCode@1000 : Code[20]);
    BEGIN
      ValidateShortcutDimCode(FieldNumber,ShortcutDimCode);
      CurrPage.SAVERECORD;
    END;

    LOCAL PROCEDURE UpdateEditableOnRow@18();
    VAR
      SalesLine@1000 : Record 37;
    BEGIN
      RowIsNotText := NOT (("No." = '') AND (Description <> ''));
      IF RowIsNotText THEN
        UnitofMeasureCodeIsChangeable := CanEditUnitOfMeasureCode
      ELSE
        UnitofMeasureCodeIsChangeable := FALSE;

      IF TotalSalesHeader."No." <> '' THEN BEGIN
        SalesLine.SETRANGE("Document No.",TotalSalesHeader."No.");
        SalesLine.SETRANGE("Document Type",TotalSalesHeader."Document Type");
        IF NOT SalesLine.ISEMPTY THEN
          InvDiscAmountEditable :=
            SalesCalcDiscountByType.InvoiceDiscIsAllowed(TotalSalesHeader."Invoice Disc. Code") AND CurrPage.EDITABLE;
      END;
    END;

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 01.09.17 JAL Item Calculation (Kalkyle)
                       New field "Calulation No."
                       New Action "Price Calculation"
    }
    END.
  }
}

OBJECT Page 47 Sales Invoice Subform
{
  OBJECT-PROPERTIES
  {
    Date=08.09.17;
    Time=13.01.40;
    Modified=Yes;
    Version List=NAVW110.00.00.15140,NAVNO10.00.00.15140,ICA2.01;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Lines;
               NOR=Linjer];
    MultipleNewLines=Yes;
    LinksAllowed=No;
    SourceTable=Table37;
    DelayedInsert=Yes;
    SourceTableView=WHERE(Document Type=FILTER(Invoice));
    PageType=ListPart;
    AutoSplitKey=Yes;
    OnInit=BEGIN
             SalesSetup.GET;
             Currency.InitRoundingPrecision;
           END;

    OnOpenPage=VAR
                 Location@1000 : Record 14;
               BEGIN
                 IF Location.READPERMISSION THEN
                   LocationCodeVisible := NOT Location.ISEMPTY;
               END;

    OnAfterGetRecord=BEGIN
                       ShowShortcutDimCode(ShortcutDimCode);
                     END;

    OnNewRecord=BEGIN
                  IF ApplicationAreaSetup.IsFoundationEnabled THEN
                    Type := Type::Item
                  ELSE
                    InitType;
                  CLEAR(ShortcutDimCode);
                END;

    OnInsertRecord=BEGIN
                     IF ApplicationAreaSetup.IsFoundationEnabled THEN
                       Type := Type::Item;
                   END;

    OnDeleteRecord=VAR
                     ReserveSalesLine@1000 : Codeunit 99000832;
                   BEGIN
                     IF (Quantity <> 0) AND ItemExists("No.") THEN BEGIN
                       COMMIT;
                       IF NOT ReserveSalesLine.DeleteLineConfirm(Rec) THEN
                         EXIT(FALSE);
                       ReserveSalesLine.DeleteLine(Rec);
                     END;
                   END;

    OnAfterGetCurrRecord=BEGIN
                           CalculateTotals;
                           UpdateEditableOnRow;
                         END;

    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1907935204;1 ;ActionGroup;
                      CaptionML=[ENU=&Line;
                                 NOR=&Linje];
                      Image=Line }
      { 1906587504;2 ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 NOR=F&unksjoner];
                      Image=Action }
      { 1903079504;3 ;Action    ;
                      AccessByPermission=TableData 7002=R;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Get &Price;
                                 NOR=Hent &pris];
                      Image=Price;
                      OnAction=BEGIN
                                 ShowPrices
                               END;
                                }
      { 1907415004;3 ;Action    ;
                      AccessByPermission=TableData 7004=R;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Get Li&ne Discount;
                                 NOR=Hent li&njerabatt];
                      Image=LineDiscount;
                      OnAction=BEGIN
                                 ShowLineDisc
                               END;
                                }
      { 1903098604;3 ;Action    ;
                      AccessByPermission=TableData 90=R;
                      CaptionML=[ENU=E&xplode BOM;
                                 NOR=U&tfold stykkliste];
                      Image=ExplodeBOM;
                      OnAction=BEGIN
                                 ExplodeBOM;
                               END;
                                }
      { 1900206204;3 ;Action    ;
                      Name=InsertExtTexts;
                      AccessByPermission=TableData 279=R;
                      CaptionML=[ENU=Insert &Ext. Texts;
                                 NOR=Sett inn &utv. tekster];
                      ToolTipML=[ENU=Insert the extended item description that is set up for the item on the sales document line.;
                                 NOR=Sett inn den utvidede varebeskrivelsen som er definert for varen p† salgsdokumentlinjen.];
                      ApplicationArea=#Suite;
                      Image=Text;
                      Scope=Repeater;
                      OnAction=BEGIN
                                 InsertExtendedText(TRUE);
                               END;
                                }
      { 1900545004;3 ;Action    ;
                      Name=GetShipmentLines;
                      AccessByPermission=TableData 110=R;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Get &Shipment Lines;
                                 NOR=Hent &leveringslinjer];
                      Image=Shipment;
                      OnAction=BEGIN
                                 GetShipment;
                               END;
                                }
      { 1905427604;2 ;ActionGroup;
                      CaptionML=[ENU=Item Availability by;
                                 NOR=Varetilgjengelighet per];
                      Image=ItemAvailability }
      { 5       ;3   ;Action    ;
                      CaptionML=[ENU=Event;
                                 NOR=Hendelse];
                      Image=Event;
                      OnAction=BEGIN
                                 ItemAvailFormsMgt.ShowItemAvailFromSalesLine(Rec,ItemAvailFormsMgt.ByEvent)
                               END;
                                }
      { 1900639404;3 ;Action    ;
                      CaptionML=[ENU=Period;
                                 NOR=Periode];
                      Image=Period;
                      OnAction=BEGIN
                                 ItemAvailFormsMgt.ShowItemAvailFromSalesLine(Rec,ItemAvailFormsMgt.ByPeriod)
                               END;
                                }
      { 1904974904;3 ;Action    ;
                      CaptionML=[ENU=Variant;
                                 NOR=Variant];
                      Image=ItemVariant;
                      OnAction=BEGIN
                                 ItemAvailFormsMgt.ShowItemAvailFromSalesLine(Rec,ItemAvailFormsMgt.ByVariant)
                               END;
                                }
      { 1904945204;3 ;Action    ;
                      AccessByPermission=TableData 14=R;
                      CaptionML=[ENU=Location;
                                 NOR=Lokasjon];
                      Image=Warehouse;
                      OnAction=BEGIN
                                 ItemAvailFormsMgt.ShowItemAvailFromSalesLine(Rec,ItemAvailFormsMgt.ByLocation)
                               END;
                                }
      { 3       ;3   ;Action    ;
                      CaptionML=[ENU=BOM Level;
                                 NOR=Stykklisteniv†];
                      Image=BOMLevel;
                      OnAction=BEGIN
                                 ItemAvailFormsMgt.ShowItemAvailFromSalesLine(Rec,ItemAvailFormsMgt.ByBOM)
                               END;
                                }
      { 23      ;2   ;ActionGroup;
                      CaptionML=[ENU=Related Information;
                                 NOR=Relatert informasjon] }
      { 1904522204;3 ;Action    ;
                      AccessByPermission=TableData 348=R;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 NOR=Dimensjoner];
                      ToolTipML=[ENU=View or edits dimensions, such as area, project, or department, that you can assign to sales and purchase documents to distribute costs and analyze transaction history.;
                                 NOR=Vis eller rediger dimensjoner, for eksempel omr†de, prosjekt eller avdeling, som du kan tilordne til salgs- og kj›psdokumenter for † distribuere kostnader og analysere transaksjonshistorikk.];
                      ApplicationArea=#Suite;
                      Image=Dimensions;
                      Scope=Repeater;
                      OnAction=BEGIN
                                 ShowDimensions;
                               END;
                                }
      { 1900948904;3 ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 NOR=&Merknader];
                      Image=ViewComments;
                      OnAction=BEGIN
                                 ShowLineComments;
                               END;
                                }
      { 1907184504;3 ;Action    ;
                      AccessByPermission=TableData 5800=R;
                      CaptionML=[ENU=Item Charge &Assignment;
                                 NOR=V&aregebyrtilordning];
                      Image=ItemCosts;
                      OnAction=BEGIN
                                 ShowItemChargeAssgnt;
                               END;
                                }
      { 1905987604;3 ;Action    ;
                      ShortCutKey=Shift+Ctrl+I;
                      CaptionML=[ENU=Item &Tracking Lines;
                                 NOR=Vare&sporingslinjer];
                      Image=ItemTrackingLines;
                      OnAction=BEGIN
                                 OpenItemTrackingLines;
                               END;
                                }
      { 17      ;3   ;Action    ;
                      Name=DeferralSchedule;
                      CaptionML=[ENU=Deferral Schedule;
                                 NOR=Tidsplan for periodisering];
                      ToolTipML=[ENU=View or edit the deferral schedule that governs how revenue made with this sales document is deferred to different accounting periods when the document is posted.;
                                 NOR=Vis eller rediger tidsplanen for periodisering som styrer hvordan inntekter fra dette salgsdokumentet periodiseres til ulike regnskapsperioder n†r dokumentet bokf›res.];
                      ApplicationArea=#Suite;
                      Enabled="Deferral Code" <> '';
                      Image=PaymentPeriod;
                      OnAction=BEGIN
                                 TotalSalesHeader.GET("Document Type","Document No.");
                                 ShowDeferrals(TotalSalesHeader."Posting Date",TotalSalesHeader."Currency Code");
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the type of entity that will be posted for this sales line, such as Item, Resource, or G/L Account.;
                           NOR=Angir enhetstypen som skal bokf›res for denne salgslinjen, for eksempel vare, ressurs eller finanskonto.];
                SourceExpr=Type;
                OnValidate=BEGIN
                             NoOnAfterValidate;

                             IF xRec."No." <> '' THEN
                               RedistributeTotalsOnAfterValidate;
                           END;
                            }

    { 4   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of a general ledger account, item, resource, additional cost, or fixed asset, depending on the contents of the Type field.;
                           NOR=Angir nummeret til en finanskonto, en vare, en ressurs, en tilleggskostnad eller aktiva, avhengig av innholdet i feltet Type.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="No.";
                OnValidate=BEGIN
                             NoOnAfterValidate;
                             UpdateEditableOnRow;
                             ShowShortcutDimCode(ShortcutDimCode);
                             IF xRec."No." <> '' THEN
                               RedistributeTotalsOnAfterValidate;
                           END;
                            }

    { 1101103000;2;Field  ;
                SourceExpr="Calculation No." }

    { 58  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the cross-referenced item number. If you enter a cross reference between yours and your vendor's or customer's item number, then this number will override the standard item number when you enter the cross-reference number on a sales or purchase document.;
                           NOR=Angir varens kryssreferansenummer. Hvis du oppgir en kryssreferanse mellom ditt og leverand›rens eller kundens varenummer, vil dette nummeret overstyre standardvarenummeret n†r du oppgir kryssreferansenummeret i et salgs- eller kj›psdokument.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Cross-Reference No.";
                Visible=FALSE;
                OnValidate=BEGIN
                             NoOnAfterValidate;
                           END;

                OnLookup=BEGIN
                           CrossReferenceNoLookUp;
                           NoOnAfterValidate;
                         END;
                          }

    { 74  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the IC partner code of the partner to whom you want to distribute the revenue of the sales line.;
                           NOR=Angi KI-partnerkoden for partneren som du vil distribuere inntektene for salgslinjen til.];
                SourceExpr="IC Partner Code";
                Visible=FALSE }

    { 46  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the item or account in your IC partner's company that corresponds to the item or account on the line.;
                           NOR=Angir varen eller kontoen i KI-partnerselskapet som tilsvarer varen eller kontoen p† linjen.];
                SourceExpr="IC Partner Ref. Type";
                Visible=FALSE }

    { 70  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the item or account in your IC partner's company that corresponds to the item or account on the line.;
                           NOR=Angir varen eller kontoen i KI-partnerselskapet som tilsvarer varen eller kontoen p† linjen.];
                SourceExpr="IC Partner Reference";
                Visible=FALSE }

    { 30  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a variant code for the item.;
                           NOR=Angir en variantkode for varen.];
                SourceExpr="Variant Code";
                Visible=FALSE }

    { 62  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies that this item is a nonstock item.;
                           NOR=Angir at denne varen er en katalogvare.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Nonstock;
                Visible=FALSE }

    { 14  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for the VAT product posting group of the item, resource, or general ledger account on this line.;
                           NOR=Angir koden for mva.-varebokf›ringsgruppen som gjelder for varen, ressursen eller finanskontoen p† linjen.];
                SourceExpr="VAT Prod. Posting Group";
                Visible=FALSE;
                OnValidate=BEGIN
                             RedistributeTotalsOnAfterValidate;
                           END;
                            }

    { 6   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a description of the entry, which is based on the contents of the Type and No. fields.;
                           NOR=Angir en beskrivelse av posten, som er basert p† innholdet i feltene Type og Nr.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Description;
                OnValidate=BEGIN
                             UpdateEditableOnRow;

                             IF "No." = xRec."No." THEN
                               EXIT;

                             NoOnAfterValidate;
                             ShowShortcutDimCode(ShortcutDimCode);
                             IF xRec."No." <> '' THEN
                               RedistributeTotalsOnAfterValidate;
                           END;

                ShowMandatory=TRUE }

    { 50  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a code that explains why the item is returned.;
                           NOR=Angir en kode som forklarer hvorfor varen ble returnert.];
                SourceExpr="Return Reason Code";
                Visible=FALSE }

    { 32  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the inventory location from which the items sold should be picked and where the inventory decrease is registered.;
                           NOR=Angir lagerlokasjonen som de solgte varene skal plukkes fra, og hvor lagerreduksjonen registreres.];
                SourceExpr="Location Code";
                Visible=LocationCodeVisible }

    { 76  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the bin from where items on the sales order line are taken from when they are shipped.;
                           NOR=Angir hvilken hylle varene p† salgsordrelinjen skal hentes fra n†r de leveres.];
                SourceExpr="Bin Code";
                Visible=FALSE }

    { 8   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies how many units are being sold.;
                           NOR=Angir hvor mange enheter som selges.];
                ApplicationArea=#Basic,#Suite;
                BlankZero=Yes;
                SourceExpr=Quantity;
                Enabled=NOT RowIsText;
                Editable=NOT RowIsText;
                OnValidate=BEGIN
                             ValidateAutoReserve;
                             RedistributeTotalsOnAfterValidate;
                           END;

                ShowMandatory="No." <> '' }

    { 34  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the unit of measure that is used to determine the value in the Unit Price field on the sales line.;
                           NOR=Angir enheten som brukes til † fastsl† verdien i feltet Salgspris p† salgslinjen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Unit of Measure Code";
                Enabled=UnitofMeasureCodeIsChangeable;
                Editable=UnitofMeasureCodeIsChangeable;
                OnValidate=BEGIN
                             ValidateAutoReserve;
                             RedistributeTotalsOnAfterValidate;
                           END;
                            }

    { 10  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the unit of measure for the item or resource on the sales line.;
                           NOR=Angir enheten for varen eller ressursen p† salgslinjen.];
                SourceExpr="Unit of Measure";
                Visible=FALSE }

    { 26  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the unit cost of the item on the line.;
                           NOR=Angir enhetskosten for varen p† linjen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Unit Cost (LCY)";
                Visible=FALSE }

    { 88  ;2   ;Field     ;
                CaptionML=[ENU=Sales Price Exists;
                           NOR=Salgspris finnes];
                ToolTipML=[ENU=Specifies that there is a specific price for this customer.;
                           NOR=Angir at det finnes en bestemt pris for denne kunden.];
                SourceExpr=PriceExists;
                Visible=FALSE;
                Editable=FALSE }

    { 12  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the price for one unit on the sales line.;
                           NOR=Angir salgsprisen for ‚n enhet p† salgslinjen.];
                ApplicationArea=#Basic,#Suite;
                BlankZero=Yes;
                SourceExpr="Unit Price";
                Enabled=NOT RowIsText;
                Editable=NOT RowIsText;
                OnValidate=BEGIN
                             RedistributeTotalsOnAfterValidate;
                           END;

                ShowMandatory="No." <> '' }

    { 16  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the line discount percentage that is valid for the item quantity on the line.;
                           NOR=Angir linjerabattprosenten som blir gitt for vareantallet p† linjen.];
                ApplicationArea=#Basic,#Suite;
                BlankZero=Yes;
                SourceExpr="Line Discount %";
                Enabled=NOT RowIsText;
                Editable=NOT RowIsText;
                OnValidate=BEGIN
                             RedistributeTotalsOnAfterValidate;
                           END;
                            }

    { 64  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the net amount (before subtracting the invoice discount amount) that must be paid for the items on the line.;
                           NOR=Angir nettobel›pet (f›r fakturarabattbel›pet trekkes fra) som skal betales for varene p† linjen.];
                ApplicationArea=#Basic,#Suite;
                BlankZero=Yes;
                SourceExpr="Line Amount";
                Enabled=NOT RowIsText;
                Editable=NOT RowIsText;
                OnValidate=BEGIN
                             RedistributeTotalsOnAfterValidate;
                           END;
                            }

    { 90  ;2   ;Field     ;
                CaptionML=[ENU=Sales Line Disc. Exists;
                           NOR=Salgslinjerab. finnes];
                ToolTipML=[ENU=Specifies that there is a specific discount for this customer.;
                           NOR=Angir at det finnes en bestemt rabatt for denne kunden.];
                SourceExpr=LineDiscExists;
                Visible=FALSE;
                Editable=FALSE }

    { 40  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the amount of the discount that will be given on the invoice line.;
                           NOR=Angir rabattbel›pet som gis p† fakturalinjen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Line Discount Amount";
                Visible=FALSE;
                OnValidate=BEGIN
                             RedistributeTotalsOnAfterValidate;
                           END;
                            }

    { 42  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies whether the invoice line is included when the invoice discount is calculated.;
                           NOR=Angir om fakturalinjen er inkludert n†r fakturarabatten beregnes.];
                SourceExpr="Allow Invoice Disc.";
                Visible=FALSE }

    { 80  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the invoice discount amount for the line.;
                           NOR=Angir fakturarabattbel›pet for linjen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Inv. Discount Amount";
                Visible=FALSE }

    { 84  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies that you can assign item charges to this line.;
                           NOR=Angir at du kan tilordne varegebyr til denne linjen.];
                SourceExpr="Allow Item Charge Assignment";
                Visible=FALSE }

    { 36  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the quantity of the item charge that will be assigned to a specified item when you post this sales line.;
                           NOR=Angir antallet av varegebyret som blir tilordnet til en bestemt vare n†r du bokf›rer salgslinjen.];
                BlankZero=Yes;
                SourceExpr="Qty. to Assign";
                Visible=FALSE;
                OnDrillDown=BEGIN
                              CurrPage.SAVERECORD;
                              ShowItemChargeAssgnt;
                              UpdatePage(FALSE);
                            END;
                             }

    { 82  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the quantity of the item charge that was assigned to a specified item when you posted this sales line.;
                           NOR=Angir antallet av varegebyret som ble tilordnet til en bestemt vare da du bokf›rte salgslinjen.];
                BlankZero=Yes;
                SourceExpr="Qty. Assigned";
                Visible=FALSE;
                OnDrillDown=BEGIN
                              CurrPage.SAVERECORD;
                              ShowItemChargeAssgnt;
                              UpdatePage(FALSE);
                            END;
                             }

    { 52  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the job number that the sales line is linked to.;
                           NOR=Angir jobbnummeret som salgslinjen er koblet til.];
                ApplicationArea=#Jobs;
                SourceExpr="Job No.";
                Visible=FALSE;
                Editable=JobRowEditable;
                OnValidate=BEGIN
                             ShowShortcutDimCode(ShortcutDimCode);
                           END;
                            }

    { 18  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the job task that the sales line is linked to.;
                           NOR=Angir nummeret for prosjektoppgaven som salgslinjen er koblet til.];
                ApplicationArea=#Jobs;
                SourceExpr="Job Task No.";
                Visible=FALSE;
                Editable=JobRowEditable }

    { 60  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the entry number of the job planning line that the sales line is linked to.;
                           NOR=Angir postnummeret for planleggingslinjen for prosjekt som salgslinjen er koblet til.];
                ApplicationArea=#Jobs;
                SourceExpr="Job Contract Entry No.";
                Visible=FALSE;
                Editable=JobRowEditable }

    { 19  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the VAT category in connection with electronic document sending. For example, when you send sales documents through the PEPPOL service, the value in this field is used to populate several fields, such as the ClassifiedTaxCategory element in the Item group. It is also used to populate the TaxCategory element in both the TaxSubtotal and AllowanceCharge group. The number is based on the UNCL5305 standard.;
                           NOR=Angir mva-kategorien i forbindelse med sending av elektroniske dokumenter. N†r du for eksempel sender salgsdokumenter via PEPPOL-servicen, brukes verdien i dette feltet til † fylle ut flere felt, for eksempel elementet ClassifiedTaxCategory i gruppen Item. Den brukes ogs† til † fylle ut elementet TaxCategory i b†de gruppen TaxSubtotal og AllowanceCharge. Nummeret er basert p† UNCL5305-standarden.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Tax Category";
                Visible=FALSE }

    { 25  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies which shipping agent is used to transport the items on the sales document to the customer.;
                           NOR=Angir hvilken transport›r som skal brukes til † transportere varene p† salgsdokumentet til kunden.];
                ApplicationArea=#Suite;
                SourceExpr="Shipping Agent Code";
                Visible=FALSE }

    { 27  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies which shipping agent service is used to transport the items on the sales document to the customer.;
                           NOR=Angir hvilken transport›rtjeneste som skal brukes til † transportere varene p† salgsdokumentet til kunden.];
                ApplicationArea=#Suite;
                SourceExpr="Shipping Agent Service Code";
                Visible=FALSE }

    { 72  ;2   ;Field     ;
                ToolTipML=[ENU=Belongs to the Job application area.;
                           NOR=H›rer til modulen Prosjekt.];
                SourceExpr="Work Type Code";
                Visible=FALSE }

    { 54  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the document number of the blanket order from which this sales line originates.;
                           NOR=Angir dokumentnummeret til rammeordren som denne ordrelinjen stammer fra.];
                SourceExpr="Blanket Order No.";
                Visible=FALSE }

    { 56  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the line number of the blanket order line from which this sales line originates.;
                           NOR=Angir linjenummeret til rammebestillingslinjen som denne salgslinjen stammer fra.];
                SourceExpr="Blanket Order Line No.";
                Visible=FALSE }

    { 24  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date that will be used as the FA posting date on FA ledger entries.;
                           NOR=Angir datoen som skal brukes som aktivabokf›ringsdatoen i aktivaposter.];
                SourceExpr="FA Posting Date";
                Visible=FALSE }

    { 44  ;2   ;Field     ;
                ToolTipML=[ENU=You can use this field if you have selected Fixed Asset in the Type field for this line.;
                           NOR=Du kan bruke dette feltet hvis du har valgt Aktiva i feltet Type for denne linjen.];
                SourceExpr="Depr. until FA Posting Date";
                Visible=FALSE }

    { 28  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for the depreciation book to which the line will be posted if you have selected Fixed Asset in the Type field for this line.;
                           NOR=Angir koden for avskrivningstabl†et som linjen skal bokf›res i hvis du har valgt Aktiva i feltet Type for denne linjen.];
                SourceExpr="Depreciation Book Code";
                Visible=FALSE }

    { 68  ;2   ;Field     ;
                ToolTipML=[ENU=You can use this field if you have selected Fixed Asset in the Type field for this line.;
                           NOR=Du kan bruke dette feltet hvis du har valgt Aktiva i feltet Type for denne linjen.];
                SourceExpr="Use Duplication List";
                Visible=FALSE }

    { 66  ;2   ;Field     ;
                ToolTipML=[ENU=You can use this field if you have selected Fixed Asset in the Type field for this line.;
                           NOR=Du kan bruke dette feltet hvis du har valgt Aktiva i feltet Type for denne linjen.];
                SourceExpr="Duplicate in Depreciation Book";
                Visible=FALSE }

    { 38  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the item ledger entry that the sales credit memo line is applied from.;
                           NOR=Angir nummeret p† vareposten som salgskreditnotalinjen er utlignet fra.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Appl.-from Item Entry";
                Visible=FALSE }

    { 48  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the item ledger entry number the line should be applied to.;
                           NOR=Angir varepostnummeret som linjen skal utlignes mot.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Appl.-to Item Entry";
                Visible=FALSE }

    { 21  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the deferral template that governs how revenue earned with this sales document is deferred to the different accounting periods when the good or service was delivered.;
                           NOR=Angir periodiseringsmalen som styrer hvordan inntekter fra dette salgsdokumentet periodiseres til de ulike regnskapsperiodene n†r varen eller servicen ble levert.];
                ApplicationArea=#Suite;
                SourceExpr="Deferral Code";
                Visible=FALSE;
                Enabled=(Type <> Type::"Fixed Asset") AND (Type <> Type::" ") }

    { 20  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for Shortcut Dimension 1.;
                           NOR=Angir koden for Snarveisdimensjon 1.];
                ApplicationArea=#Suite;
                SourceExpr="Shortcut Dimension 1 Code";
                Visible=FALSE }

    { 22  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for Shortcut Dimension 2.;
                           NOR=Angir koden for Snarveisdimensjon 2.];
                ApplicationArea=#Suite;
                SourceExpr="Shortcut Dimension 2 Code";
                Visible=FALSE }

    { 300 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[3];
                CaptionClass='1,2,3';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(3),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateSaveShortcutDimCode(3,ShortcutDimCode[3]);
                           END;
                            }

    { 302 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[4];
                CaptionClass='1,2,4';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(4),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateSaveShortcutDimCode(4,ShortcutDimCode[4]);
                           END;
                            }

    { 304 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[5];
                CaptionClass='1,2,5';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(5),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateSaveShortcutDimCode(5,ShortcutDimCode[5]);
                           END;
                            }

    { 306 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[6];
                CaptionClass='1,2,6';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(6),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateSaveShortcutDimCode(6,ShortcutDimCode[6]);
                           END;
                            }

    { 308 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[7];
                CaptionClass='1,2,7';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(7),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateSaveShortcutDimCode(7,ShortcutDimCode[7]);
                           END;
                            }

    { 310 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[8];
                CaptionClass='1,2,8';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(8),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateSaveShortcutDimCode(8,ShortcutDimCode[8]);
                           END;
                            }

    { 104 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the document number.;
                           NOR=Angir dokumentnummeret.];
                SourceExpr="Document No.";
                Visible=FALSE;
                Editable=FALSE }

    { 106 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the line number.;
                           NOR=Angir linjenummeret.];
                SourceExpr="Line No.";
                Visible=FALSE;
                Editable=FALSE }

    { 1080000;2;Field     ;
                ToolTipML=[ENU=Specifies the account code of the customer.;
                           NOR=Angir kontokoden for kunden.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Account Code" }

    { 39  ;1   ;Group     ;
                GroupType=Group }

    { 33  ;2   ;Group     ;
                GroupType=Group }

    { 7   ;3   ;Field     ;
                CaptionML=[ENU=Subtotal Excl. VAT;
                           NOR=Delsum ekskl. mva];
                ToolTipML=[ENU=Specifies the sum of the value in the Line Amount Excl. VAT field on all lines in the document.;
                           NOR=Angir summen av verdien i feltet Linjebel›p ekskl. mva p† alle linjer i dokumentet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=TotalSalesLine."Line Amount";
                AutoFormatType=1;
                AutoFormatExpr=Currency.Code;
                CaptionClass=DocumentTotals.GetTotalLineAmountWithVATAndCurrencyCaption(Currency.Code,TotalSalesHeader."Prices Including VAT");
                Editable=FALSE }

    { 31  ;3   ;Field     ;
                Name=Invoice Discount Amount;
                CaptionML=[ENU=Invoice Discount Amount;
                           NOR=Fakturarabattbel›p];
                ToolTipML=[ENU=Specifies a discount amount that is deducted from the value in the Total Incl. VAT field. You can enter or change the amount manually.;
                           NOR=Angir et rabattbel›p som blir trukket fra verdien i feltet Totalt inkl. mva. Du kan oppgi eller endre bel›pet manuelt.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=InvoiceDiscountAmount;
                AutoFormatType=1;
                AutoFormatExpr=Currency.Code;
                CaptionClass=DocumentTotals.GetInvoiceDiscAmountWithVATAndCurrencyCaption(FIELDCAPTION("Inv. Discount Amount"),Currency.Code);
                Editable=InvDiscAmountEditable;
                OnValidate=BEGIN
                             ValidateInvoiceDiscountAmount;
                           END;
                            }

    { 29  ;3   ;Field     ;
                Name=Invoice Disc. Pct.;
                CaptionML=[ENU=Invoice Discount %;
                           NOR=Fakturarabatt %];
                ToolTipML=[ENU=Specifies a discount percentage that is granted if criteria that you have set up for the customer are met.;
                           NOR=Angir en rabattprosent som gis hvis kriteriene du har definert for kunden, oppfylles.];
                ApplicationArea=#Basic,#Suite;
                DecimalPlaces=0:2;
                SourceExpr=InvoiceDiscountPct;
                Editable=InvDiscAmountEditable;
                OnValidate=BEGIN
                             InvoiceDiscountAmount := ROUND(TotalSalesLine."Line Amount" * InvoiceDiscountPct / 100,Currency."Amount Rounding Precision");
                             ValidateInvoiceDiscountAmount;
                           END;
                            }

    { 15  ;2   ;Group     ;
                GroupType=Group }

    { 13  ;3   ;Field     ;
                Name=Total Amount Excl. VAT;
                DrillDown=No;
                CaptionML=[ENU=Total Amount Excl. VAT;
                           NOR=Totalbel›p ekskl. mva];
                ToolTipML=[ENU=Specifies the sum of the value in the Line Amount Excl. VAT field on all lines in the document minus any discount amount in the Invoice Discount Amount field.;
                           NOR=Angir summen av verdien i feltet Linjebel›p ekskl. MVA p† alle linjer i dokumentet, minus eventuelle rabattbel›p i feltet Fakturarabattbel›p.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=TotalSalesLine.Amount;
                AutoFormatType=1;
                AutoFormatExpr=Currency.Code;
                CaptionClass=DocumentTotals.GetTotalExclVATCaption(Currency.Code);
                Editable=FALSE }

    { 11  ;3   ;Field     ;
                Name=Total VAT Amount;
                CaptionML=[ENU=Total VAT;
                           NOR=Total mva];
                ToolTipML=[ENU=Specifies the sum of VAT amounts on all lines in the document.;
                           NOR=Angir summen av mva-bel›pene p† alle linjene i dokumentet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=VATAmount;
                AutoFormatType=1;
                AutoFormatExpr=Currency.Code;
                CaptionClass=DocumentTotals.GetTotalVATCaption(Currency.Code);
                Editable=FALSE }

    { 9   ;3   ;Field     ;
                Name=Total Amount Incl. VAT;
                CaptionML=[ENU=Total Amount Incl. VAT;
                           NOR=Totalbel›p inkl. mva];
                ToolTipML=[ENU=Specifies the sum of the value in the Line Amount Incl. VAT field on all lines in the document minus any discount amount in the Invoice Discount Amount field.;
                           NOR=Angir summen av verdien i feltet Linjebel›p inkl. MVA p† alle linjer i dokumentet, minus eventuelle rabattbel›p i feltet Fakturarabattbel›p.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=TotalSalesLine."Amount Including VAT";
                AutoFormatType=1;
                AutoFormatExpr=Currency.Code;
                CaptionClass=DocumentTotals.GetTotalInclVATCaption(Currency.Code);
                Editable=FALSE }

  }
  CODE
  {
    VAR
      TotalSalesHeader@1014 : Record 36;
      TotalSalesLine@1013 : Record 37;
      Currency@1024 : Record 4;
      SalesSetup@1010 : Record 311;
      ApplicationAreaSetup@1008 : Record 9178;
      TransferExtendedText@1003 : Codeunit 378;
      SalesPriceCalcMgt@1005 : Codeunit 7000;
      ItemAvailFormsMgt@1001 : Codeunit 353;
      SalesCalcDiscByType@1015 : Codeunit 56;
      DocumentTotals@1016 : Codeunit 57;
      VATAmount@1017 : Decimal;
      InvoiceDiscountAmount@1009 : Decimal;
      InvoiceDiscountPct@1023 : Decimal;
      ShortcutDimCode@1004 : ARRAY [8] OF Code[20];
      UpdateAllowedVar@1002 : Boolean;
      Text000@1006 : TextConst 'ENU=Unable to run this function while in View mode.;NOR=Denne funksjonen kan ikke utf›res i visningsmodus.';
      JobRowEditable@1021 : Boolean;
      LocationCodeVisible@1007 : Boolean;
      InvDiscAmountEditable@1012 : Boolean;
      RowIsText@1000 : Boolean;
      UnitofMeasureCodeIsChangeable@1011 : Boolean;

    PROCEDURE ApproveCalcInvDisc@1();
    BEGIN
      CODEUNIT.RUN(CODEUNIT::"Sales-Disc. (Yes/No)",Rec);
    END;

    LOCAL PROCEDURE ValidateInvoiceDiscountAmount@22();
    VAR
      SalesHeader@1000 : Record 36;
    BEGIN
      SalesHeader.GET("Document Type","Document No.");
      SalesCalcDiscByType.ApplyInvDiscBasedOnAmt(InvoiceDiscountAmount,SalesHeader);
      CurrPage.UPDATE(FALSE);
    END;

    PROCEDURE CalcInvDisc@8();
    BEGIN
      CODEUNIT.RUN(CODEUNIT::"Sales-Calc. Discount",Rec);
    END;

    PROCEDURE ExplodeBOM@3();
    BEGIN
      CODEUNIT.RUN(CODEUNIT::"Sales-Explode BOM",Rec);
    END;

    PROCEDURE GetShipment@4();
    BEGIN
      CODEUNIT.RUN(CODEUNIT::"Sales-Get Shipment",Rec);
    END;

    PROCEDURE InsertExtendedText@7(Unconditionally@1000 : Boolean);
    BEGIN
      IF TransferExtendedText.SalesCheckIfAnyExtText(Rec,Unconditionally) THEN BEGIN
        CurrPage.SAVERECORD;
        COMMIT;
        TransferExtendedText.InsertSalesExtText(Rec);
      END;
      IF TransferExtendedText.MakeUpdate THEN
        UpdatePage(TRUE);
    END;

    PROCEDURE UpdatePage@12(SetSaveRecord@1000 : Boolean);
    BEGIN
      CurrPage.UPDATE(SetSaveRecord);
    END;

    PROCEDURE ShowPrices@15();
    BEGIN
      TotalSalesHeader.GET("Document Type","Document No.");
      CLEAR(SalesPriceCalcMgt);
      SalesPriceCalcMgt.GetSalesLinePrice(TotalSalesHeader,Rec);
    END;

    PROCEDURE ShowLineDisc@16();
    BEGIN
      TotalSalesHeader.GET("Document Type","Document No.");
      CLEAR(SalesPriceCalcMgt);
      SalesPriceCalcMgt.GetSalesLineLineDisc(TotalSalesHeader,Rec);
    END;

    PROCEDURE SetUpdateAllowed@5(UpdateAllowed@1000 : Boolean);
    BEGIN
      UpdateAllowedVar := UpdateAllowed;
    END;

    PROCEDURE UpdateAllowed@20() : Boolean;
    BEGIN
      IF UpdateAllowedVar = FALSE THEN BEGIN
        MESSAGE(Text000);
        EXIT(FALSE);
      END;
      EXIT(TRUE);
    END;

    LOCAL PROCEDURE NoOnAfterValidate@19066594();
    BEGIN
      IF ApplicationAreaSetup.IsFoundationEnabled THEN
        TESTFIELD(Type,Type::Item);
      InsertExtendedText(FALSE);

      IF (Type = Type::"Charge (Item)") AND ("No." <> xRec."No.") AND (xRec."No." <> '') THEN
        CurrPage.SAVERECORD;
    END;

    LOCAL PROCEDURE UpdateEditableOnRow@11();
    VAR
      SalesLine@1000 : Record 37;
    BEGIN
      JobRowEditable := "Job No." = '';
      RowIsText := ("No." = '') AND (Description <> '');
      IF NOT RowIsText THEN
        UnitofMeasureCodeIsChangeable := CanEditUnitOfMeasureCode
      ELSE
        UnitofMeasureCodeIsChangeable := FALSE;

      IF TotalSalesHeader."No." <> '' THEN BEGIN
        SalesLine.SETRANGE("Document No.",TotalSalesHeader."No.");
        SalesLine.SETRANGE("Document Type",TotalSalesHeader."Document Type");
        IF NOT SalesLine.ISEMPTY THEN
          InvDiscAmountEditable :=
            SalesCalcDiscByType.InvoiceDiscIsAllowed(TotalSalesHeader."Invoice Disc. Code") AND CurrPage.EDITABLE;
      END;
    END;

    LOCAL PROCEDURE ValidateAutoReserve@19032465();
    BEGIN
      IF Reserve = Reserve::Always THEN BEGIN
        CurrPage.SAVERECORD;
        AutoReserve;
      END;
    END;

    LOCAL PROCEDURE GetTotalSalesHeader@13();
    BEGIN
      IF NOT TotalSalesHeader.GET("Document Type","Document No.") THEN
        CLEAR(TotalSalesHeader);
      IF Currency.Code <> TotalSalesHeader."Currency Code" THEN
        IF NOT Currency.GET(TotalSalesHeader."Currency Code") THEN
          Currency.InitRoundingPrecision;
    END;

    LOCAL PROCEDURE CalculateTotals@6();
    BEGIN
      GetTotalSalesHeader;
      TotalSalesHeader.CALCFIELDS("Recalculate Invoice Disc.");

      IF SalesSetup."Calc. Inv. Discount" AND ("Document No." <> '') AND (TotalSalesHeader."Customer Posting Group" <> '') AND
         TotalSalesHeader."Recalculate Invoice Disc."
      THEN
        IF FIND THEN
          CalcInvDisc;

      DocumentTotals.CalculateSalesTotals(TotalSalesLine,VATAmount,Rec);
      InvoiceDiscountAmount := TotalSalesLine."Inv. Discount Amount";
      InvoiceDiscountPct := SalesCalcDiscByType.GetCustInvoiceDiscountPct(Rec);
    END;

    LOCAL PROCEDURE RedistributeTotalsOnAfterValidate@2();
    BEGIN
      CurrPage.SAVERECORD;

      TotalSalesHeader.GET("Document Type","Document No.");
      DocumentTotals.SalesRedistributeInvoiceDiscountAmounts(Rec,VATAmount,TotalSalesLine);
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE ValidateSaveShortcutDimCode@9(FieldNumber@1001 : Integer;VAR ShortcutDimCode@1000 : Code[20]);
    BEGIN
      ValidateShortcutDimCode(FieldNumber,ShortcutDimCode);
      CurrPage.SAVERECORD;
    END;

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 08.09.17 JAL Item Calculation (Kalkyle)
                       New field "Calulation No."
    }
    END.
  }
}

OBJECT Page 95 Sales Quote Subform
{
  OBJECT-PROPERTIES
  {
    Date=08.09.17;
    Time=09.35.08;
    Modified=Yes;
    Version List=NAVW110.00.00.15140,ICA2.01;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Lines;
               NOR=Linjer];
    MultipleNewLines=Yes;
    LinksAllowed=No;
    SourceTable=Table37;
    DelayedInsert=Yes;
    SourceTableView=WHERE(Document Type=FILTER(Quote));
    PageType=ListPart;
    AutoSplitKey=Yes;
    OnInit=BEGIN
             SalesSetup.GET;
             Currency.InitRoundingPrecision;
           END;

    OnAfterGetRecord=BEGIN
                       ShowShortcutDimCode(ShortcutDimCode);
                     END;

    OnNewRecord=VAR
                  ApplicationAreaSetup@1001 : Record 9178;
                BEGIN
                  IF ApplicationAreaSetup.IsFoundationEnabled THEN
                    Type := Type::Item
                  ELSE
                    InitType;

                  CLEAR(ShortcutDimCode);
                END;

    OnInsertRecord=VAR
                     ApplicationAreaSetup@1000 : Record 9178;
                   BEGIN
                     IF ApplicationAreaSetup.IsFoundationEnabled THEN
                       Type := Type::Item;
                   END;

    OnDeleteRecord=VAR
                     ReserveSalesLine@1000 : Codeunit 99000832;
                   BEGIN
                     IF (Quantity <> 0) AND ItemExists("No.") THEN BEGIN
                       COMMIT;
                       IF NOT ReserveSalesLine.DeleteLineConfirm(Rec) THEN
                         EXIT(FALSE);
                       ReserveSalesLine.DeleteLine(Rec);
                     END;
                   END;

    OnAfterGetCurrRecord=BEGIN
                           CalculateTotals;
                           UpdateEditableOnRow;
                         END;

    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 17      ;1   ;Action    ;
                      Name=InsertExtTexts;
                      AccessByPermission=TableData 279=R;
                      CaptionML=[ENU=Insert &Ext. Texts;
                                 NOR=Sett inn &utv. tekster];
                      ToolTipML=[ENU=Insert an extended description for the sales document.;
                                 NOR=Sett inn en utvidet beskrivelse for salgsdokumentet.];
                      ApplicationArea=#Suite;
                      Image=Text;
                      OnAction=BEGIN
                                 InsertExtendedText(TRUE);
                               END;
                                }
      { 1907075804;1 ;Action    ;
                      AccessByPermission=TableData 348=R;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 NOR=Dimensjoner];
                      ToolTipML=[ENU=View or edits dimensions, such as area, project, or department, that you can assign to sales and purchase documents to distribute costs and analyze transaction history.;
                                 NOR=Vis eller rediger dimensjoner, for eksempel omr†de, prosjekt eller avdeling, som du kan tilordne til salgs- og kj›psdokumenter for † distribuere kostnader og analysere transaksjonshistorikk.];
                      ApplicationArea=#Suite;
                      Image=Dimensions;
                      OnAction=BEGIN
                                 ShowDimensions;
                               END;
                                }
      { 1907935204;1 ;ActionGroup;
                      CaptionML=[ENU=&Line;
                                 NOR=&Linje];
                      Image=Line }
      { 1901743104;2 ;ActionGroup;
                      CaptionML=[ENU=Item Availability by;
                                 NOR=Varetilgjengelighet per];
                      Image=ItemAvailability }
      { 5       ;3   ;Action    ;
                      CaptionML=[ENU=Event;
                                 NOR=Hendelse];
                      Image=Event;
                      OnAction=BEGIN
                                 ItemAvailFormsMgt.ShowItemAvailFromSalesLine(Rec,ItemAvailFormsMgt.ByEvent)
                               END;
                                }
      { 1907981204;3 ;Action    ;
                      CaptionML=[ENU=Period;
                                 NOR=Periode];
                      Image=Period;
                      OnAction=BEGIN
                                 ItemAvailFormsMgt.ShowItemAvailFromSalesLine(Rec,ItemAvailFormsMgt.ByPeriod)
                               END;
                                }
      { 1903587104;3 ;Action    ;
                      CaptionML=[ENU=Variant;
                                 NOR=Variant];
                      Image=ItemVariant;
                      OnAction=BEGIN
                                 ItemAvailFormsMgt.ShowItemAvailFromSalesLine(Rec,ItemAvailFormsMgt.ByVariant)
                               END;
                                }
      { 1903134404;3 ;Action    ;
                      AccessByPermission=TableData 14=R;
                      CaptionML=[ENU=Location;
                                 NOR=Lokasjon];
                      Image=Warehouse;
                      OnAction=BEGIN
                                 ItemAvailFormsMgt.ShowItemAvailFromSalesLine(Rec,ItemAvailFormsMgt.ByLocation)
                               END;
                                }
      { 26      ;3   ;Action    ;
                      CaptionML=[ENU=BOM Level;
                                 NOR=Stykklisteniv†];
                      Image=BOMLevel;
                      OnAction=BEGIN
                                 ItemAvailFormsMgt.ShowItemAvailFromSalesLine(Rec,ItemAvailFormsMgt.ByBOM)
                               END;
                                }
      { 1901092104;2 ;Action    ;
                      CaptionML=[ENU=Select Item Substitution;
                                 NOR=Velg vareerstatning];
                      ToolTipML=[ENU=Select another item that has been set up to be sold instead of the original item if it is unavailable.;
                                 NOR=Velg en annen vare som har blitt definert til † bli solgt i stedet for den opprinnelige varen, hvis den er utilgjengelig.];
                      ApplicationArea=#Suite;
                      Image=SelectItemSubstitution;
                      OnAction=BEGIN
                                 ShowItemSub;
                               END;
                                }
      { 1902027204;2 ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 NOR=&Merknader];
                      Image=ViewComments;
                      OnAction=BEGIN
                                 ShowLineComments;
                               END;
                                }
      { 1907184504;2 ;Action    ;
                      AccessByPermission=TableData 5800=R;
                      CaptionML=[ENU=Item Charge &Assignment;
                                 NOR=V&aregebyrtilordning];
                      Image=ItemCosts;
                      OnAction=BEGIN
                                 ItemChargeAssgnt;
                               END;
                                }
      { 1905987604;2 ;Action    ;
                      ShortCutKey=Shift+Ctrl+I;
                      CaptionML=[ENU=Item &Tracking Lines;
                                 NOR=Vare&sporingslinjer];
                      Image=ItemTrackingLines;
                      OnAction=VAR
                                 Item@1001 : Record 27;
                               BEGIN
                                 Item.GET("No.");
                                 Item.TESTFIELD("Assembly Policy",Item."Assembly Policy"::"Assemble-to-Stock");
                                 TESTFIELD("Qty. to Asm. to Order (Base)",0);
                                 OpenItemTrackingLines;
                               END;
                                }
      { 13      ;2   ;Action    ;
                      AccessByPermission=TableData 5718=R;
                      CaptionML=[ENU=Nonstoc&k Items;
                                 NOR=&Katalogvarer];
                      ApplicationArea=#Basic,#Suite;
                      Image=NonStockItem;
                      OnAction=BEGIN
                                 ShowNonstockItems;
                               END;
                                }
      { 15      ;2   ;ActionGroup;
                      CaptionML=[ENU=Assemble to Order;
                                 NOR=Monter til ordre];
                      ActionContainerType=NewDocumentItems;
                      Image=AssemblyBOM }
      { 3       ;3   ;Action    ;
                      AccessByPermission=TableData 90=R;
                      CaptionML=[ENU=Assemble-to-Order Lines;
                                 NOR=Montere til ordre - linjer];
                      OnAction=BEGIN
                                 ShowAsmToOrderLines;
                               END;
                                }
      { 9       ;3   ;Action    ;
                      AccessByPermission=TableData 90=R;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Roll Up &Price;
                                 NOR=Oppruller &pris];
                      OnAction=BEGIN
                                 RollupAsmPrice;
                               END;
                                }
      { 7       ;3   ;Action    ;
                      AccessByPermission=TableData 90=R;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Roll Up &Cost;
                                 NOR=Oppruller &kost];
                      OnAction=BEGIN
                                 RollUpAsmCost;
                               END;
                                }
      { 25      ;1   ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 NOR=F&unksjoner];
                      Image=Action }
      { 23      ;2   ;Action    ;
                      AccessByPermission=TableData 7002=R;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Get &Price;
                                 NOR=Hent &pris];
                      Image=Price;
                      OnAction=BEGIN
                                 ShowPrices
                               END;
                                }
      { 21      ;2   ;Action    ;
                      AccessByPermission=TableData 7004=R;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Get Li&ne Discount;
                                 NOR=Hent li&njerabatt];
                      Image=LineDiscount;
                      OnAction=BEGIN
                                 ShowLineDisc
                               END;
                                }
      { 19      ;2   ;Action    ;
                      AccessByPermission=TableData 90=R;
                      CaptionML=[ENU=E&xplode BOM;
                                 NOR=U&tfold stykkliste];
                      Image=ExplodeBOM;
                      OnAction=BEGIN
                                 ExplodeBOM;
                               END;
                                }
      { 1101103002;2 ;Action    ;
                      Name=Item Calculation;
                      CaptionML=[ENU=Item Calculation;
                                 NOR=Kalkyle];
                      Promoted=Yes;
                      Image=PriceAdjustment;
                      PromotedCategory=Process }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the type of entity that will be posted for this sales line, such as Item, Resource, or G/L Account.;
                           NOR=Angir enhetstypen som skal bokf›res for denne salgslinjen, for eksempel vare, ressurs eller finanskonto.];
                SourceExpr=Type;
                OnValidate=BEGIN
                             NoOnAfterValidate;

                             IF xRec."No." <> '' THEN
                               RedistributeTotalsOnAfterValidate;
                           END;
                            }

    { 4   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of a general ledger account, item, resource, additional cost, or fixed asset, depending on the contents of the Type field.;
                           NOR=Angir nummeret til en finanskonto, en vare, en ressurs, en tilleggskostnad eller aktiva, avhengig av innholdet i feltet Type.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="No.";
                OnValidate=BEGIN
                             ShowShortcutDimCode(ShortcutDimCode);
                             NoOnAfterValidate;

                             IF xRec."No." <> '' THEN
                               RedistributeTotalsOnAfterValidate;

                             UpdateEditableOnRow;
                           END;
                            }

    { 28  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the cross-referenced item number. If you enter a cross reference between yours and your vendor's or customer's item number, then this number will override the standard item number when you enter the cross-reference number on a sales or purchase document.;
                           NOR=Angir varens kryssreferansenummer. Hvis du oppgir en kryssreferanse mellom ditt og leverand›rens eller kundens varenummer, vil dette nummeret overstyre standardvarenummeret n†r du oppgir kryssreferansenummeret i et salgs- eller kj›psdokument.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Cross-Reference No.";
                Visible=FALSE;
                OnValidate=BEGIN
                             CrossReferenceNoOnAfterValidat;
                             NoOnAfterValidate;
                           END;

                OnLookup=BEGIN
                           CrossReferenceNoLookUp;
                           InsertExtendedText(FALSE);
                           NoOnAfterValidate;
                         END;
                          }

    { 30  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a variant code for the item.;
                           NOR=Angir en variantkode for varen.];
                SourceExpr="Variant Code";
                Visible=FALSE;
                OnValidate=BEGIN
                             VariantCodeOnAfterValidate
                           END;
                            }

    { 32  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies that a substitute is available for the item on the sales line.;
                           NOR=Angir at en erstatning er tilgjengelig for varen p† salgslinjen.];
                ApplicationArea=#Suite;
                SourceExpr="Substitution Available";
                Visible=FALSE }

    { 48  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies that this item is a nonstock item.;
                           NOR=Angir at denne varen er en katalogvare.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Nonstock;
                Visible=FALSE }

    { 14  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for the VAT product posting group of the item, resource, or general ledger account on this line.;
                           NOR=Angir koden for mva.-varebokf›ringsgruppen som gjelder for varen, ressursen eller finanskontoen p† linjen.];
                SourceExpr="VAT Prod. Posting Group";
                Visible=FALSE }

    { 6   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a description of the entry, which is based on the contents of the Type and No. fields.;
                           NOR=Angir en beskrivelse av posten, som er basert p† innholdet i feltene Type og Nr.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Description;
                OnValidate=BEGIN
                             UpdateEditableOnRow;

                             IF "No." = xRec."No." THEN
                               EXIT;

                             ShowShortcutDimCode(ShortcutDimCode);
                             NoOnAfterValidate;

                             IF xRec."No." <> '' THEN
                               RedistributeTotalsOnAfterValidate;

                             UpdateEditableOnRow;
                           END;

                ShowMandatory=TRUE }

    { 24  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the inventory location from which the items sold should be picked and where the inventory decrease is registered.;
                           NOR=Angir lagerlokasjonen som de solgte varene skal plukkes fra, og hvor lagerreduksjonen registreres.];
                SourceExpr="Location Code";
                OnValidate=BEGIN
                             LocationCodeOnAfterValidate;
                           END;
                            }

    { 8   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies how many units are being sold.;
                           NOR=Angir hvor mange enheter som selges.];
                ApplicationArea=#Basic,#Suite;
                BlankZero=Yes;
                SourceExpr=Quantity;
                Enabled=NOT RowIsText;
                Editable=NOT RowIsText;
                OnValidate=BEGIN
                             QuantityOnAfterValidate;
                             RedistributeTotalsOnAfterValidate;
                           END;

                ShowMandatory="No." <> '' }

    { 11  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies how many units of the sales line quantity that you want to supply by assembly.;
                           NOR=Angir hvor mange enheter av salgslinjeantallet som du vil forsyne gjennom montering.];
                SourceExpr="Qty. to Assemble to Order";
                Enabled=NOT RowIsText;
                Editable=NOT RowIsText;
                OnValidate=BEGIN
                             CurrPage.SAVERECORD;
                             CurrPage.UPDATE(TRUE);
                           END;

                OnDrillDown=BEGIN
                              ShowAsmToOrderLines;
                            END;
                             }

    { 34  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the unit of measure that is used to determine the value in the Unit Price field on the sales line.;
                           NOR=Angir enheten som brukes til † fastsl† verdien i feltet Salgspris p† salgslinjen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Unit of Measure Code";
                Enabled=UnitofMeasureCodeIsChangeable;
                Editable=UnitofMeasureCodeIsChangeable;
                OnValidate=BEGIN
                             UnitofMeasureCodeOnAfterValida;
                             RedistributeTotalsOnAfterValidate;
                           END;
                            }

    { 10  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the unit of measure for the item or resource on the sales line.;
                           NOR=Angir enheten for varen eller ressursen p† salgslinjen.];
                SourceExpr="Unit of Measure";
                Visible=FALSE }

    { 1101103000;2;Field  ;
                SourceExpr="Calculation No." }

    { 18  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the unit cost of the item on the line.;
                           NOR=Angir enhetskosten for varen p† linjen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Unit Cost (LCY)";
                Visible=FALSE }

    { 38  ;2   ;Field     ;
                CaptionML=[ENU=Sales Price Exists;
                           NOR=Salgspris finnes];
                ToolTipML=[ENU=Specifies that there is a specific price for this customer.;
                           NOR=Angir at det finnes en bestemt pris for denne kunden.];
                SourceExpr=PriceExists;
                Visible=FALSE;
                Editable=FALSE }

    { 12  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the price for one unit on the sales line.;
                           NOR=Angir salgsprisen for ‚n enhet p† salgslinjen.];
                ApplicationArea=#Basic,#Suite;
                BlankZero=Yes;
                SourceExpr="Unit Price";
                Enabled=NOT RowIsText;
                Editable=NOT RowIsText;
                OnValidate=BEGIN
                             RedistributeTotalsOnAfterValidate;
                           END;

                ShowMandatory="No." <> '' }

    { 50  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the net amount (before subtracting the invoice discount amount) that must be paid for the items on the line.;
                           NOR=Angir nettobel›pet (f›r fakturarabattbel›pet trekkes fra) som skal betales for varene p† linjen.];
                ApplicationArea=#Basic,#Suite;
                BlankZero=Yes;
                SourceExpr="Line Amount";
                Enabled=NOT RowIsText;
                Editable=NOT RowIsText;
                OnValidate=BEGIN
                             RedistributeTotalsOnAfterValidate;
                           END;
                            }

    { 60  ;2   ;Field     ;
                CaptionML=[ENU=Sales Line Disc. Exists;
                           NOR=Salgslinjerab. finnes];
                ToolTipML=[ENU=Specifies that there is a specific discount for this customer.;
                           NOR=Angir at det finnes en bestemt rabatt for denne kunden.];
                SourceExpr=LineDiscExists;
                Visible=FALSE;
                Editable=FALSE }

    { 16  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the line discount percentage that is valid for the item quantity on the line.;
                           NOR=Angir linjerabattprosenten som blir gitt for vareantallet p† linjen.];
                ApplicationArea=#Basic,#Suite;
                BlankZero=Yes;
                SourceExpr="Line Discount %";
                Enabled=NOT RowIsText;
                Editable=NOT RowIsText;
                OnValidate=BEGIN
                             RedistributeTotalsOnAfterValidate;
                           END;
                            }

    { 64  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the amount of the discount that will be given on the invoice line.;
                           NOR=Angir rabattbel›pet som gis p† fakturalinjen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Line Discount Amount";
                Visible=FALSE;
                OnValidate=BEGIN
                             RedistributeTotalsOnAfterValidate;
                           END;
                            }

    { 62  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies whether the invoice line is included when the invoice discount is calculated.;
                           NOR=Angir om fakturalinjen er inkludert n†r fakturarabatten beregnes.];
                SourceExpr="Allow Invoice Disc.";
                Visible=FALSE }

    { 39  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the invoice discount amount for the line.;
                           NOR=Angir fakturarabattbel›pet for linjen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Inv. Discount Amount";
                Visible=FALSE;
                Editable=FALSE;
                OnValidate=BEGIN
                             UpdatePage;
                           END;
                            }

    { 54  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies that you can assign item charges to this line.;
                           NOR=Angir at du kan tilordne varegebyr til denne linjen.];
                SourceExpr="Allow Item Charge Assignment";
                Visible=FALSE }

    { 36  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the quantity of the item charge that will be assigned to a specified item when you post this sales line.;
                           NOR=Angir antallet av varegebyret som blir tilordnet til en bestemt vare n†r du bokf›rer salgslinjen.];
                BlankZero=Yes;
                SourceExpr="Qty. to Assign";
                OnDrillDown=BEGIN
                              CurrPage.SAVERECORD;
                              ShowItemChargeAssgnt;
                              UpdateForm(FALSE);
                            END;
                             }

    { 58  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the quantity of the item charge that was assigned to a specified item when you posted this sales line.;
                           NOR=Angir antallet av varegebyret som ble tilordnet til en bestemt vare da du bokf›rte salgslinjen.];
                BlankZero=Yes;
                SourceExpr="Qty. Assigned";
                OnDrillDown=BEGIN
                              CurrPage.SAVERECORD;
                              ShowItemChargeAssgnt;
                              UpdateForm(FALSE);
                            END;
                             }

    { 27  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies which shipping agent is used to transport the items on the sales document to the customer.;
                           NOR=Angir hvilken transport›r som skal brukes til † transportere varene p† salgsdokumentet til kunden.];
                ApplicationArea=#Suite;
                SourceExpr="Shipping Agent Code";
                Visible=FALSE }

    { 40  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies which shipping agent service is used to transport the items on the sales document to the customer.;
                           NOR=Angir hvilken transport›rtjeneste som skal brukes til † transportere varene p† salgsdokumentet til kunden.];
                ApplicationArea=#Suite;
                SourceExpr="Shipping Agent Service Code";
                Visible=FALSE }

    { 76  ;2   ;Field     ;
                ToolTipML=[ENU=Belongs to the Job application area.;
                           NOR=H›rer til modulen Prosjekt.];
                SourceExpr="Work Type Code";
                Visible=FALSE }

    { 42  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the document number of the blanket order from which this sales line originates.;
                           NOR=Angir dokumentnummeret til rammeordren som denne ordrelinjen stammer fra.];
                SourceExpr="Blanket Order No.";
                Visible=FALSE }

    { 46  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the line number of the blanket order line from which this sales line originates.;
                           NOR=Angir linjenummeret til rammebestillingslinjen som denne salgslinjen stammer fra.];
                SourceExpr="Blanket Order Line No.";
                Visible=FALSE }

    { 56  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the item ledger entry number the line should be applied to.;
                           NOR=Angir varepostnummeret som linjen skal utlignes mot.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Appl.-to Item Entry";
                Visible=FALSE }

    { 20  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for Shortcut Dimension 1.;
                           NOR=Angir koden for Snarveisdimensjon 1.];
                ApplicationArea=#Suite;
                SourceExpr="Shortcut Dimension 1 Code";
                Visible=FALSE }

    { 22  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for Shortcut Dimension 2.;
                           NOR=Angir koden for Snarveisdimensjon 2.];
                ApplicationArea=#Suite;
                SourceExpr="Shortcut Dimension 2 Code";
                Visible=FALSE }

    { 300 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[3];
                CaptionClass='1,2,3';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(3),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateSaveShortcutDimCode(3,ShortcutDimCode[3]);
                           END;
                            }

    { 302 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[4];
                CaptionClass='1,2,4';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(4),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateSaveShortcutDimCode(4,ShortcutDimCode[4]);
                           END;
                            }

    { 304 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[5];
                CaptionClass='1,2,5';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(5),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateSaveShortcutDimCode(5,ShortcutDimCode[5]);
                           END;
                            }

    { 306 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[6];
                CaptionClass='1,2,6';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(6),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateSaveShortcutDimCode(6,ShortcutDimCode[6]);
                           END;
                            }

    { 308 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[7];
                CaptionClass='1,2,7';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(7),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateSaveShortcutDimCode(7,ShortcutDimCode[7]);
                           END;
                            }

    { 310 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[8];
                CaptionClass='1,2,8';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(8),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateSaveShortcutDimCode(8,ShortcutDimCode[8]);
                           END;
                            }

    { 53  ;1   ;Group     ;
                GroupType=Group }

    { 49  ;2   ;Group     ;
                GroupType=Group }

    { 37  ;3   ;Field     ;
                Name=Subtotal Excl. VAT;
                CaptionML=[ENU=Subtotal Excl. VAT;
                           NOR=Delsum ekskl. mva];
                ToolTipML=[ENU=Specifies the sum of the value in the Line Amount Excl. VAT field on all lines in the document.;
                           NOR=Angir summen av verdien i feltet Linjebel›p ekskl. mva p† alle linjer i dokumentet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=TotalSalesLine."Line Amount";
                AutoFormatType=1;
                AutoFormatExpr=Currency.Code;
                CaptionClass=DocumentTotals.GetTotalLineAmountWithVATAndCurrencyCaption(Currency.Code,TotalSalesHeader."Prices Including VAT");
                Editable=FALSE }

    { 47  ;3   ;Field     ;
                Name=Invoice Discount Amount;
                CaptionML=[ENU=Invoice Discount Amount;
                           NOR=Fakturarabattbel›p];
                ToolTipML=[ENU=Specifies a discount amount that is deducted from the value in the Total Incl. VAT field. You can enter or change the amount manually.;
                           NOR=Angir et rabattbel›p som blir trukket fra verdien i feltet Totalt inkl. mva. Du kan oppgi eller endre bel›pet manuelt.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=InvoiceDiscountAmount;
                AutoFormatType=1;
                AutoFormatExpr=Currency.Code;
                Editable=InvDiscAmountEditable;
                OnValidate=BEGIN
                             ValidateInvoiceDiscountAmount;
                           END;
                            }

    { 45  ;3   ;Field     ;
                Name=Invoice Disc. Pct.;
                CaptionML=[ENU=Invoice Discount %;
                           NOR=Fakturarabatt %];
                ToolTipML=[ENU=Specifies a discount percentage that is granted if criteria that you have set up for the customer are met.;
                           NOR=Angir en rabattprosent som gis hvis kriteriene du har definert for kunden, oppfylles.];
                ApplicationArea=#Basic,#Suite;
                DecimalPlaces=0:2;
                SourceExpr=InvoiceDiscountPct;
                Editable=InvDiscAmountEditable;
                OnValidate=BEGIN
                             InvoiceDiscountAmount := ROUND(TotalSalesLine."Line Amount" * InvoiceDiscountPct / 100,Currency."Amount Rounding Precision");
                             ValidateInvoiceDiscountAmount;
                           END;
                            }

    { 35  ;2   ;Group     ;
                GroupType=Group }

    { 33  ;3   ;Field     ;
                Name=Total Amount Excl. VAT;
                DrillDown=No;
                CaptionML=[ENU=Total Amount Excl. VAT;
                           NOR=Totalbel›p ekskl. mva];
                ToolTipML=[ENU=Specifies the sum of the value in the Line Amount Excl. VAT field on all lines in the document minus any discount amount in the Invoice Discount Amount field.;
                           NOR=Angir summen av verdien i feltet Linjebel›p ekskl. MVA p† alle linjer i dokumentet, minus eventuelle rabattbel›p i feltet Fakturarabattbel›p.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=TotalSalesLine.Amount;
                AutoFormatType=1;
                AutoFormatExpr=Currency.Code;
                CaptionClass=DocumentTotals.GetTotalExclVATCaption(Currency.Code);
                Editable=FALSE }

    { 31  ;3   ;Field     ;
                Name=Total VAT Amount;
                CaptionML=[ENU=Total VAT;
                           NOR=Total mva];
                ToolTipML=[ENU=Specifies the sum of VAT amounts on all lines in the document.;
                           NOR=Angir summen av mva-bel›pene p† alle linjene i dokumentet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=VATAmount;
                AutoFormatType=1;
                AutoFormatExpr=Currency.Code;
                CaptionClass=DocumentTotals.GetTotalVATCaption(Currency.Code);
                Editable=FALSE }

    { 29  ;3   ;Field     ;
                Name=Total Amount Incl. VAT;
                CaptionML=[ENU=Total Amount Incl. VAT;
                           NOR=Totalbel›p inkl. mva];
                ToolTipML=[ENU=Specifies the sum of the value in the Line Amount Incl. VAT field on all lines in the document minus any discount amount in the Invoice Discount Amount field.;
                           NOR=Angir summen av verdien i feltet Linjebel›p inkl. MVA p† alle linjer i dokumentet, minus eventuelle rabattbel›p i feltet Fakturarabattbel›p.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=TotalSalesLine."Amount Including VAT";
                AutoFormatType=1;
                AutoFormatExpr=Currency.Code;
                CaptionClass=DocumentTotals.GetTotalInclVATCaption(Currency.Code);
                Editable=FALSE }

  }
  CODE
  {
    VAR
      TotalSalesHeader@1017 : Record 36;
      TotalSalesLine@1016 : Record 37;
      SalesHeader@1000 : Record 36;
      Currency@1005 : Record 4;
      SalesSetup@1018 : Record 311;
      TransferExtendedText@1002 : Codeunit 378;
      SalesPriceCalcMgt@1004 : Codeunit 7000;
      ItemAvailFormsMgt@1001 : Codeunit 353;
      SalesCalcDiscByType@1015 : Codeunit 56;
      DocumentTotals@1014 : Codeunit 57;
      VATAmount@1013 : Decimal;
      ShortcutDimCode@1003 : ARRAY [8] OF Code[20];
      RowIsText@1012 : Boolean;
      UnitofMeasureCodeIsChangeable@1008 : Boolean;
      InvoiceDiscountAmount@1011 : Decimal;
      InvoiceDiscountPct@1006 : Decimal;
      InvDiscAmountEditable@1007 : Boolean;

    PROCEDURE ApproveCalcInvDisc@1();
    BEGIN
      CODEUNIT.RUN(CODEUNIT::"Sales-Disc. (Yes/No)",Rec);
    END;

    LOCAL PROCEDURE ValidateInvoiceDiscountAmount@22();
    VAR
      SalesHeader@1000 : Record 36;
    BEGIN
      SalesHeader.GET("Document Type","Document No.");
      SalesCalcDiscByType.ApplyInvDiscBasedOnAmt(InvoiceDiscountAmount,SalesHeader);
      CurrPage.UPDATE(FALSE);
    END;

    PROCEDURE CalcInvDisc@17();
    BEGIN
      CODEUNIT.RUN(CODEUNIT::"Sales-Calc. Discount",Rec);
    END;

    LOCAL PROCEDURE ExplodeBOM@3();
    BEGIN
      CODEUNIT.RUN(CODEUNIT::"Sales-Explode BOM",Rec);
    END;

    LOCAL PROCEDURE InsertExtendedText@4(Unconditionally@1000 : Boolean);
    BEGIN
      IF TransferExtendedText.SalesCheckIfAnyExtText(Rec,Unconditionally) THEN BEGIN
        CurrPage.SAVERECORD;
        COMMIT;
        TransferExtendedText.InsertSalesExtText(Rec);
      END;
      IF TransferExtendedText.MakeUpdate THEN
        UpdateForm(TRUE);
    END;

    LOCAL PROCEDURE ShowItemSub@8();
    BEGIN
      ShowItemSub;
    END;

    LOCAL PROCEDURE ShowNonstockItems@10();
    BEGIN
      ShowNonstock;
    END;

    LOCAL PROCEDURE ItemChargeAssgnt@5800();
    BEGIN
      ShowItemChargeAssgnt;
    END;

    PROCEDURE UpdateForm@12(SetSaveRecord@1000 : Boolean);
    BEGIN
      CurrPage.UPDATE(SetSaveRecord);
    END;

    LOCAL PROCEDURE ShowPrices@15();
    BEGIN
      SalesHeader.GET("Document Type","Document No.");
      CLEAR(SalesPriceCalcMgt);
      SalesPriceCalcMgt.GetSalesLinePrice(SalesHeader,Rec);
    END;

    LOCAL PROCEDURE ShowLineDisc@16();
    BEGIN
      SalesHeader.GET("Document Type","Document No.");
      CLEAR(SalesPriceCalcMgt);
      SalesPriceCalcMgt.GetSalesLineLineDisc(SalesHeader,Rec);
    END;

    LOCAL PROCEDURE ShowLineComments@11();
    BEGIN
      ShowLineComments;
    END;

    LOCAL PROCEDURE NoOnAfterValidate@19066594();
    BEGIN
      InsertExtendedText(FALSE);
      IF (Type = Type::"Charge (Item)") AND ("No." <> xRec."No.") AND
         (xRec."No." <> '')
      THEN
        CurrPage.SAVERECORD;

      SaveAndAutoAsmToOrder;
    END;

    LOCAL PROCEDURE LocationCodeOnAfterValidate@2();
    BEGIN
      SaveAndAutoAsmToOrder;
    END;

    LOCAL PROCEDURE VariantCodeOnAfterValidate@9();
    BEGIN
      SaveAndAutoAsmToOrder;
    END;

    LOCAL PROCEDURE CrossReferenceNoOnAfterValidat@19048248();
    BEGIN
      InsertExtendedText(FALSE);
    END;

    LOCAL PROCEDURE QuantityOnAfterValidate@19032465();
    BEGIN
      IF Reserve = Reserve::Always THEN BEGIN
        CurrPage.SAVERECORD;
        AutoReserve;
      END;

      IF (Type = Type::Item) AND
         (Quantity <> xRec.Quantity)
      THEN
        CurrPage.UPDATE(TRUE);
    END;

    LOCAL PROCEDURE UnitofMeasureCodeOnAfterValida@19057939();
    BEGIN
      IF Reserve = Reserve::Always THEN BEGIN
        CurrPage.SAVERECORD;
        AutoReserve;
      END;
    END;

    LOCAL PROCEDURE SaveAndAutoAsmToOrder@13();
    BEGIN
      IF (Type = Type::Item) AND IsAsmToOrderRequired THEN BEGIN
        CurrPage.SAVERECORD;
        AutoAsmToOrder;
        CurrPage.UPDATE(FALSE);
      END;
    END;

    LOCAL PROCEDURE RedistributeTotalsOnAfterValidate@7();
    BEGIN
      CurrPage.SAVERECORD;

      SalesHeader.GET("Document Type","Document No.");
      DocumentTotals.SalesRedistributeInvoiceDiscountAmounts(Rec,VATAmount,TotalSalesLine);
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE ValidateSaveShortcutDimCode@18(FieldNumber@1001 : Integer;VAR ShortcutDimCode@1000 : Code[20]);
    BEGIN
      ValidateShortcutDimCode(FieldNumber,ShortcutDimCode);
      CurrPage.SAVERECORD;
    END;

    LOCAL PROCEDURE UpdateEditableOnRow@19();
    VAR
      SalesLine@1000 : Record 37;
    BEGIN
      RowIsText := ("No." = '') AND (Description <> '');
      IF NOT RowIsText THEN
        UnitofMeasureCodeIsChangeable := CanEditUnitOfMeasureCode
      ELSE
        UnitofMeasureCodeIsChangeable := FALSE;

      IF TotalSalesHeader."No." <> '' THEN BEGIN
        SalesLine.SETRANGE("Document No.",TotalSalesHeader."No.");
        SalesLine.SETRANGE("Document Type",TotalSalesHeader."Document Type");
        IF NOT SalesLine.ISEMPTY THEN
          InvDiscAmountEditable :=
            SalesCalcDiscByType.InvoiceDiscIsAllowed(TotalSalesHeader."Invoice Disc. Code") AND CurrPage.EDITABLE;
      END;
    END;

    LOCAL PROCEDURE UpdatePage@20();
    VAR
      SalesHeader@1001 : Record 36;
    BEGIN
      CurrPage.UPDATE;
      SalesHeader.GET("Document Type","Document No.");
      SalesCalcDiscByType.ApplyDefaultInvoiceDiscount(TotalSalesHeader."Invoice Discount Amount",SalesHeader);
    END;

    LOCAL PROCEDURE GetTotalSalesHeader@14();
    BEGIN
      IF NOT TotalSalesHeader.GET("Document Type","Document No.") THEN
        CLEAR(TotalSalesHeader);
      IF Currency.Code <> TotalSalesHeader."Currency Code" THEN
        IF NOT Currency.GET(TotalSalesHeader."Currency Code") THEN
          Currency.InitRoundingPrecision;
    END;

    LOCAL PROCEDURE CalculateTotals@6();
    BEGIN
      GetTotalSalesHeader;
      TotalSalesHeader.CALCFIELDS("Recalculate Invoice Disc.");

      IF SalesSetup."Calc. Inv. Discount" AND ("Document No." <> '') AND (TotalSalesHeader."Customer Posting Group" <> '') AND
         TotalSalesHeader."Recalculate Invoice Disc."
      THEN
        IF FIND THEN
          CalcInvDisc;

      DocumentTotals.CalculateSalesTotals(TotalSalesLine,VATAmount,Rec);
      InvoiceDiscountAmount := TotalSalesLine."Inv. Discount Amount";
      InvoiceDiscountPct := SalesCalcDiscByType.GetCustInvoiceDiscountPct(Rec);
    END;

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 01.09.17 JAL Item Calculation (Kalkyle)
                       New field "Calulation No."
                       New Action "Price Calculation"
    }
    END.
  }
}

OBJECT Page 131 Posted Sales Shpt. Subform
{
  OBJECT-PROPERTIES
  {
    Date=08.09.17;
    Time=13.05.14;
    Modified=Yes;
    Version List=NAVW110.00,ICA2.01;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Lines;
               NOR=Linjer];
    LinksAllowed=No;
    SourceTable=Table111;
    PageType=ListPart;
    AutoSplitKey=Yes;
    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1906587504;1 ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 NOR=F&unksjoner];
                      Image=Action }
      { 1903098504;2 ;Action    ;
                      CaptionML=[ENU=Order Tra&cking;
                                 NOR=Ordresp&oring];
                      Image=OrderTracking;
                      OnAction=BEGIN
                                 ShowTracking;
                               END;
                                }
      { 1902740304;2 ;Action    ;
                      Name=UndoShipment;
                      CaptionML=[ENU=&Undo Shipment;
                                 NOR=&Angre levering];
                      ToolTipML=[ENU=Withdraw the line from the shipment. This is useful for making corrections, because the line is not deleted. You can make changes and post it again.;
                                 NOR=Trekk linjen fra leveringen. Dette er nyttig n†r du foretar korrigeringer, fordi linjen ikke blir slettet. Du kan gj›re endringer og bokf›re linjen p† nytt.];
                      ApplicationArea=#Basic,#Suite;
                      Image=UndoShipment;
                      OnAction=BEGIN
                                 UndoShipmentPosting;
                               END;
                                }
      { 1907935204;1 ;ActionGroup;
                      CaptionML=[ENU=&Line;
                                 NOR=&Linje];
                      Image=Line }
      { 1903100004;2 ;Action    ;
                      Name=Dimensions;
                      AccessByPermission=TableData 348=R;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 NOR=Dimensjoner];
                      ToolTipML=[ENU=View or edit dimensions, such as area, project, or department, that you can assign to sales and purchase documents to distribute costs and analyze transaction history.;
                                 NOR=Vis eller rediger dimensjoner, for eksempel omr†de, prosjekt eller avdeling, som du kan tilordne til salgs- og kj›psdokumenter for † distribuere kostnader og analysere transaksjonshistorikk.];
                      ApplicationArea=#Suite;
                      Image=Dimensions;
                      OnAction=BEGIN
                                 ShowDimensions;
                               END;
                                }
      { 1901092104;2 ;Action    ;
                      Name=Comments;
                      CaptionML=[ENU=Co&mments;
                                 NOR=&Merknader];
                      Image=ViewComments;
                      OnAction=BEGIN
                                 ShowLineComments;
                               END;
                                }
      { 1905987604;2 ;Action    ;
                      Name=ItemTrackingEntries;
                      CaptionML=[ENU=Item &Tracking Entries;
                                 NOR=Varesporingspos&ter];
                      Image=ItemTrackingLedger;
                      OnAction=BEGIN
                                 ShowItemTrackingLines;
                               END;
                                }
      { 3       ;2   ;Action    ;
                      AccessByPermission=TableData 90=R;
                      CaptionML=[ENU=Assemble-to-Order;
                                 NOR=Monter til ordre];
                      OnAction=BEGIN
                                 ShowAsmToOrder;
                               END;
                                }
      { 1900609704;2 ;Action    ;
                      Name=ItemInvoiceLines;
                      CaptionML=[ENU=Item Invoice &Lines;
                                 NOR=&Varefakturalinjer];
                      Image=ItemInvoice;
                      OnAction=BEGIN
                                 PageShowItemSalesInvLines;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                SourceExpr=Type }

    { 4   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the record.;
                           NOR=Angir nummeret p† posten.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="No." }

    { 24  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the cross-referenced item number. If you enter a cross reference between yours and your vendor's or customer's item number, then this number will override the standard item number when you enter the cross-reference number on a sales or purchase document.;
                           NOR=Angir varens kryssreferansenummer. Hvis du oppgir en kryssreferanse mellom ditt og leverand›rens eller kundens varenummer, vil dette nummeret overstyre standardvarenummeret n†r du oppgir kryssreferansenummeret i et salgs- eller kj›psdokument.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Cross-Reference No.";
                Visible=FALSE }

    { 14  ;2   ;Field     ;
                SourceExpr="Variant Code";
                Visible=FALSE }

    { 6   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a description of the record.;
                           NOR=Angir en beskrivelse av posten.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Description }

    { 20  ;2   ;Field     ;
                SourceExpr="Return Reason Code";
                Visible=FALSE }

    { 46  ;2   ;Field     ;
                SourceExpr="Location Code" }

    { 54  ;2   ;Field     ;
                SourceExpr="Bin Code";
                Visible=FALSE }

    { 8   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of units of the item specified on the line.;
                           NOR=Angir antall enheter av varen som er angitt p† linjen.];
                ApplicationArea=#Basic,#Suite;
                BlankZero=Yes;
                SourceExpr=Quantity }

    { 22  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the unit of measure code for the item.;
                           NOR=Angir enhetskoden for varen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Unit of Measure Code" }

    { 10  ;2   ;Field     ;
                SourceExpr="Unit of Measure";
                Visible=FALSE }

    { 12  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies how many units of the item on the line have already been invoiced.;
                           NOR=Angir hvor mange enheter av varen som allerede er fakturert p† linjen.];
                ApplicationArea=#Basic,#Suite;
                BlankZero=Yes;
                SourceExpr="Quantity Invoiced" }

    { 44  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies how many units of the item on the line have been shipped and not yet invoiced.;
                           NOR=Angir hvor mange enheter av varen p† linjen som er levert og enn† ikke fakturert.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Qty. Shipped Not Invoiced";
                Visible=FALSE;
                Editable=FALSE }

    { 18  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date that the customer has asked for the order to be delivered.;
                           NOR=Angir p† hvilken dato kunden har bedt om at ordren skal leveres.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Requested Delivery Date";
                Visible=FALSE }

    { 28  ;2   ;Field     ;
                SourceExpr="Promised Delivery Date";
                Visible=FALSE }

    { 36  ;2   ;Field     ;
                SourceExpr="Planned Delivery Date" }

    { 40  ;2   ;Field     ;
                SourceExpr="Planned Shipment Date" }

    { 16  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date when the sales shipment was posted.;
                           NOR=Angir datoen da f›lgeseddelen ble bokf›rt.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Shipment Date";
                Visible=TRUE }

    { 32  ;2   ;Field     ;
                SourceExpr="Shipping Time";
                Visible=FALSE }

    { 38  ;2   ;Field     ;
                SourceExpr="Job No.";
                Visible=FALSE }

    { 34  ;2   ;Field     ;
                SourceExpr="Outbound Whse. Handling Time";
                Visible=FALSE }

    { 42  ;2   ;Field     ;
                SourceExpr="Appl.-to Item Entry";
                Visible=FALSE }

    { 50  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for Shortcut Dimension 1.;
                           NOR=Angir koden for Snarveisdimensjon 1.];
                ApplicationArea=#Suite;
                SourceExpr="Shortcut Dimension 1 Code";
                Visible=FALSE }

    { 48  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for Shortcut Dimension 2.;
                           NOR=Angir koden for Snarveisdimensjon 2.];
                ApplicationArea=#Suite;
                SourceExpr="Shortcut Dimension 2 Code";
                Visible=FALSE }

    { 52  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies that this sales shipment line has been posted as a corrective entry.;
                           NOR=Angir at denne salgsleveringslinjen er bokf›rt som en korreksjonspost.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Correction;
                Visible=FALSE;
                Editable=FALSE }

  }
  CODE
  {

    LOCAL PROCEDURE ShowTracking@1();
    VAR
      ItemLedgEntry@1000 : Record 32;
      TempItemLedgEntry@1002 : TEMPORARY Record 32;
      TrackingForm@1001 : Page 99000822;
    BEGIN
      TESTFIELD(Type,Type::Item);
      IF "Item Shpt. Entry No." <> 0 THEN BEGIN
        ItemLedgEntry.GET("Item Shpt. Entry No.");
        TrackingForm.SetItemLedgEntry(ItemLedgEntry);
      END ELSE
        TrackingForm.SetMultipleItemLedgEntries(TempItemLedgEntry,
          DATABASE::"Sales Shipment Line",0,"Document No.",'',0,"Line No.");

      TrackingForm.RUNMODAL;
    END;

    LOCAL PROCEDURE UndoShipmentPosting@2();
    VAR
      SalesShptLine@1000 : Record 111;
    BEGIN
      SalesShptLine.COPY(Rec);
      CurrPage.SETSELECTIONFILTER(SalesShptLine);
      CODEUNIT.RUN(CODEUNIT::"Undo Sales Shipment Line",SalesShptLine);
    END;

    LOCAL PROCEDURE PageShowItemSalesInvLines@4();
    BEGIN
      TESTFIELD(Type,Type::Item);
      ShowItemSalesInvLines;
    END;

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 08.09.17 JAL Item Calculation (Kalkyle)
                       New field "Calulation No."
    }
    END.
  }
}

OBJECT Page 133 Posted Sales Invoice Subform
{
  OBJECT-PROPERTIES
  {
    Date=08.09.17;
    Time=13.03.04;
    Modified=Yes;
    Version List=NAVW110.00,NAVNO10.00,ICA2.01;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Lines;
               NOR=Linjer];
    LinksAllowed=No;
    SourceTable=Table113;
    PageType=ListPart;
    AutoSplitKey=Yes;
    OnAfterGetCurrRecord=BEGIN
                           DocumentTotals.CalculatePostedSalesInvoiceTotals(TotalSalesInvoiceHeader,VATAmount,Rec);
                         END;

    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1907935204;1 ;ActionGroup;
                      CaptionML=[ENU=&Line;
                                 NOR=&Linje];
                      Image=Line }
      { 1901314304;2 ;Action    ;
                      Name=Dimensions;
                      AccessByPermission=TableData 348=R;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 NOR=Dimensjoner];
                      ToolTipML=[ENU=View or edit dimensions, such as area, project, or department, that you can assign to sales and purchase documents to distribute costs and analyze transaction history.;
                                 NOR=Vis eller rediger dimensjoner, for eksempel omr†de, prosjekt eller avdeling, som du kan tilordne til salgs- og kj›psdokumenter for † distribuere kostnader og analysere transaksjonshistorikk.];
                      Image=Dimensions;
                      OnAction=BEGIN
                                 ShowDimensions;
                               END;
                                }
      { 1900639404;2 ;Action    ;
                      Name=Comments;
                      CaptionML=[ENU=Co&mments;
                                 NOR=&Merknader];
                      Image=ViewComments;
                      OnAction=BEGIN
                                 ShowLineComments;
                               END;
                                }
      { 1905987604;2 ;Action    ;
                      Name=ItemTrackingEntries;
                      CaptionML=[ENU=Item &Tracking Entries;
                                 NOR=Varesporingspos&ter];
                      Image=ItemTrackingLedger;
                      OnAction=BEGIN
                                 ShowItemTrackingLines;
                               END;
                                }
      { 1905427604;2 ;Action    ;
                      Name=ItemShipmentLines;
                      CaptionML=[ENU=Item Shipment &Lines;
                                 NOR=V&areleveringslinjer];
                      Image=ShipmentLines;
                      OnAction=BEGIN
                                 IF NOT (Type IN [Type::Item,Type::"Charge (Item)"]) THEN
                                   TESTFIELD(Type);
                                 ShowItemShipmentLines;
                               END;
                                }
      { 13      ;2   ;Action    ;
                      Name=DeferralSchedule;
                      CaptionML=[ENU=Deferral Schedule;
                                 NOR=Tidsplan for periodisering];
                      ToolTipML=[ENU=View the deferral schedule that governs how revenue made with this sales document was deferred to different accounting periods when the document was posted.;
                                 NOR=Vis tidsplanen for periodisering som styrer hvordan inntekter fra dette salgsdokumentet ble periodisert til ulike regnskapsperioder da dokumentet ble bokf›rt.];
                      ApplicationArea=#Suite;
                      Enabled="Deferral Code" <> '';
                      Image=PaymentPeriod;
                      OnAction=BEGIN
                                 ShowDeferrals;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the line type.;
                           NOR=Angir linjetypen.];
                SourceExpr=Type }

    { 4   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of a general ledger account, item, resource, additional cost, or fixed asset, depending on the contents of the Type field.;
                           NOR=Angir nummeret til en finanskonto, en vare, en ressurs, en tilleggskostnad eller aktiva, avhengig av innholdet i feltet Type.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="No." }

    { 1101103000;2;Field  ;
                SourceExpr="Calculation No." }

    { 26  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the cross-referenced item number. If you enter a cross reference between yours and your vendor's or customer's item number, then this number will override the standard item number when you enter the cross-reference number on a sales or purchase document.;
                           NOR=Angir varens kryssreferansenummer. Hvis du oppgir en kryssreferanse mellom ditt og leverand›rens eller kundens varenummer, vil dette nummeret overstyre standardvarenummeret n†r du oppgir kryssreferansenummeret i et salgs- eller kj›psdokument.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Cross-Reference No.";
                Visible=FALSE }

    { 20  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code of the IC partner that the line has been distributed to.;
                           NOR=Angir koden for KI-partneren som linjen er distribuert til.];
                SourceExpr="IC Partner Code";
                Visible=FALSE }

    { 18  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the variant number of the items sold.;
                           NOR=Angir variantnummeret til de solgte varene.];
                SourceExpr="Variant Code";
                Visible=FALSE }

    { 6   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the name of the item or general ledger account, or some descriptive text.;
                           NOR=Angir navnet p† varen eller finanskontoen, eller en beskrivende tekst.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Description }

    { 14  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a code that explains why the item is returned.;
                           NOR=Angir en kode som forklarer hvorfor varen ble returnert.];
                SourceExpr="Return Reason Code";
                Visible=FALSE }

    { 8   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of units of the item specified on the line.;
                           NOR=Angir antall enheter av varen som er angitt p† linjen.];
                ApplicationArea=#Basic,#Suite;
                BlankZero=Yes;
                SourceExpr=Quantity }

    { 24  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the unit of measure code for the items sold.;
                           NOR=Angir enhetskoden til de solgte varene.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Unit of Measure Code" }

    { 10  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the unit of measure for the item (bottle or piece, for example).;
                           NOR=Angir enheten for varen (for eksempel en flaske eller et stykk).];
                SourceExpr="Unit of Measure";
                Visible=FALSE }

    { 66  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the unit cost of the item on the invoice line.;
                           NOR=Angir enhetskosten for varen p† fakturalinjen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Unit Cost (LCY)";
                Visible=FALSE }

    { 12  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the price of one unit of the item on the invoice line.;
                           NOR=Angir prisen p† ‚n enhet av varen p† fakturalinjen.];
                ApplicationArea=#Basic,#Suite;
                BlankZero=Yes;
                SourceExpr="Unit Price" }

    { 30  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the net amount (before subtracting the invoice discount amount) that must be paid for the items on the line.;
                           NOR=Angir nettobel›pet (f›r fakturarabattbel›pet trekkes fra) som skal betales for varene p† linjen.];
                ApplicationArea=#Basic,#Suite;
                BlankZero=Yes;
                SourceExpr="Line Amount" }

    { 16  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the line discount % that was given on the line.;
                           NOR=Angir linjerabattprosenten som ble gitt p† linjen.];
                ApplicationArea=#Basic,#Suite;
                BlankZero=Yes;
                SourceExpr="Line Discount %" }

    { 52  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the amount of the discount given on the line.;
                           NOR=Angir rabattbel›pet som ble gitt p† linjen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Line Discount Amount";
                Visible=FALSE }

    { 50  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies whether the invoice line could have been included in a possible invoice discount calculation.;
                           NOR=Angir om fakturalinjen kan ha v‘rt med i en eventuell beregning av fakturarabatt.];
                SourceExpr="Allow Invoice Disc.";
                Visible=FALSE }

    { 40  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the job number that the sales invoice line is linked to.;
                           NOR=Angir jobbnummeret som salgsfakturalinjen er koblet til.];
                ApplicationArea=#Jobs;
                SourceExpr="Job No.";
                Visible=FALSE }

    { 15  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the job task that the sales line is linked to.;
                           NOR=Angir nummeret for prosjektoppgaven som salgslinjen er koblet til.];
                ApplicationArea=#Jobs;
                SourceExpr="Job Task No.";
                Visible=FALSE }

    { 17  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the entry number of the job planning line that the sales line is linked to.;
                           NOR=Angir postnummeret for planleggingslinjen for prosjekt som salgslinjen er koblet til.];
                SourceExpr="Job Contract Entry No.";
                Visible=FALSE }

    { 44  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the item ledger entry this invoice line was applied to.;
                           NOR=Angir l›penummeret p† en bestemt varepost som er utlignet av fakturalinjen.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Appl.-to Item Entry";
                Visible=FALSE }

    { 11  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the deferral template that governs how revenue earned with this sales document is deferred to the different accounting periods when the good or service was delivered.;
                           NOR=Angir periodiseringsmalen som styrer hvordan inntekter fra dette salgsdokumentet periodiseres til de ulike regnskapsperiodene n†r varen eller servicen ble levert.];
                ApplicationArea=#Suite;
                SourceExpr="Deferral Code" }

    { 72  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for Shortcut Dimension 1.;
                           NOR=Angir koden for Snarveisdimensjon 1.];
                ApplicationArea=#Suite;
                SourceExpr="Shortcut Dimension 1 Code";
                Visible=FALSE }

    { 70  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for Shortcut Dimension 2.;
                           NOR=Angir koden for Snarveisdimensjon 2.];
                ApplicationArea=#Suite;
                SourceExpr="Shortcut Dimension 2 Code";
                Visible=FALSE }

    { 1080000;2;Field     ;
                ToolTipML=[ENU=Specifies the account code of the customer who will receive the invoice.;
                           NOR=Angir kontokoden for kunden som mottar fakturaen.];
                SourceExpr="Account Code";
                Visible=FALSE }

    { 28  ;1   ;Group     ;
                GroupType=Group }

    { 23  ;2   ;Group     ;
                GroupType=Group }

    { 22  ;3   ;Field     ;
                Name=Invoice Discount Amount;
                CaptionML=[ENU=Invoice Discount Amount;
                           NOR=Fakturarabattbel›p];
                ToolTipML=[ENU=Specifies a discount amount that is deducted from the value in the Total Incl. VAT field. You can enter or change the amount manually.;
                           NOR=Angir et rabattbel›p som blir trukket fra verdien i feltet Totalt inkl. mva. Du kan oppgi eller endre bel›pet manuelt.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=TotalSalesInvoiceHeader."Invoice Discount Amount";
                AutoFormatType=1;
                AutoFormatExpr=TotalSalesInvoiceHeader."Currency Code";
                CaptionClass=DocumentTotals.GetInvoiceDiscAmountWithVATCaption(TotalSalesInvoiceHeader."Prices Including VAT");
                Editable=FALSE }

    { 9   ;2   ;Group     ;
                GroupType=Group }

    { 7   ;3   ;Field     ;
                Name=Total Amount Excl. VAT;
                DrillDown=No;
                CaptionML=[ENU=Total Amount Excl. VAT;
                           NOR=Totalbel›p ekskl. mva];
                ToolTipML=[ENU=Specifies the sum of the value in the Line Amount Excl. VAT field on all lines in the document minus any discount amount in the Invoice Discount Amount field.;
                           NOR=Angir summen av verdien i feltet Linjebel›p ekskl. MVA p† alle linjer i dokumentet, minus eventuelle rabattbel›p i feltet Fakturarabattbel›p.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=TotalSalesInvoiceHeader.Amount;
                AutoFormatType=1;
                AutoFormatExpr=TotalSalesInvoiceHeader."Currency Code";
                CaptionClass=DocumentTotals.GetTotalExclVATCaption(TotalSalesInvoiceHeader."Currency Code");
                Editable=FALSE }

    { 5   ;3   ;Field     ;
                Name=Total VAT Amount;
                CaptionML=[ENU=Total VAT;
                           NOR=Total mva];
                ToolTipML=[ENU=Specifies the sum of VAT amounts on all lines in the document.;
                           NOR=Angir summen av mva-bel›pene p† alle linjene i dokumentet.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=VATAmount;
                AutoFormatType=1;
                AutoFormatExpr=TotalSalesInvoiceHeader."Currency Code";
                CaptionClass=DocumentTotals.GetTotalVATCaption(TotalSalesInvoiceHeader."Currency Code");
                Editable=FALSE }

    { 3   ;3   ;Field     ;
                Name=Total Amount Incl. VAT;
                CaptionML=[ENU=Total Amount Incl. VAT;
                           NOR=Totalbel›p inkl. mva];
                ToolTipML=[ENU=Specifies the sum of the value in the Line Amount Incl. VAT field on all lines in the document minus any discount amount in the Invoice Discount Amount field.;
                           NOR=Angir summen av verdien i feltet Linjebel›p inkl. MVA p† alle linjer i dokumentet, minus eventuelle rabattbel›p i feltet Fakturarabattbel›p.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=TotalSalesInvoiceHeader."Amount Including VAT";
                AutoFormatType=1;
                AutoFormatExpr=TotalSalesInvoiceHeader."Currency Code";
                CaptionClass=DocumentTotals.GetTotalInclVATCaption(TotalSalesInvoiceHeader."Currency Code");
                Editable=FALSE;
                Style=Strong;
                StyleExpr=TRUE }

  }
  CODE
  {
    VAR
      TotalSalesInvoiceHeader@1002 : Record 112;
      DocumentTotals@1001 : Codeunit 57;
      VATAmount@1000 : Decimal;

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 08.09.17 JAL Item Calculation (Kalkyle)
                       New field "Calulation No."
    }
    END.
  }
}

OBJECT Page 461 Inventory Setup
{
  OBJECT-PROPERTIES
  {
    Date=01.09.17;
    Time=15.06.50;
    Modified=Yes;
    Version List=NAVW110.00,ICA2.01;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Inventory Setup;
               NOR=Lageroppsett];
    InsertAllowed=No;
    DeleteAllowed=No;
    SourceTable=Table313;
    PageType=Card;
    PromotedActionCategoriesML=[ENU=New,Process,Report,General,Posting,Journal Templates;
                                NOR=Ny,Prosess,Rapport,Generelt,Bokf›ring,Kladdemaler];
    OnOpenPage=BEGIN
                 RESET;
                 IF NOT GET THEN BEGIN
                   INIT;
                   INSERT;
                 END;
               END;

    ActionList=ACTIONS
    {
      { 21      ;    ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 19      ;1   ;Action    ;
                      CaptionML=[ENU=Inventory Periods;
                                 NOR=Lagerperioder];
                      ToolTipML=[ENU=Set up periods in combinations with your accounting periods that define when you can post transactions that affect the value of your item inventory. When you close an inventory period, you cannot post any changes to the inventory value, either expected or actual value, before the ending date of the inventory period.;
                                 NOR=Definer perioder i kombinasjoner med regnskapsperiodene som definerer n†r du kan bokf›re transaksjoner som p†virker verdien av varelageret. N†r du lukker en lagerperiode, kan du ikke bokf›re endringer til lagerverdien, verken forventet eller faktisk verdi, f›r lagerperiodens sluttdato.];
                      RunObject=Page 5828;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Period;
                      PromotedCategory=Category4 }
      { 17      ;1   ;Action    ;
                      CaptionML=[ENU=Units of Measure;
                                 NOR=Enheter];
                      ToolTipML=[ENU=Set up the units of measure, such as PSC or HOUR, that you can select from in the Item Units of Measure window that you access from the item card.;
                                 NOR=Definer enhetene, for eksempel STK eller TIME, som du kan velge fra i vinduet Vareenheter som du kan †pne fra varekortet.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 209;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=UnitOfMeasure;
                      PromotedCategory=Category4 }
      { 13      ;1   ;Action    ;
                      CaptionML=[ENU=Item Discount Groups;
                                 NOR=Varerabattgrupper];
                      ToolTipML=[ENU=Set up discount group codes that you can use as criteria when you define special discounts on a customer, vendor, or item card.;
                                 NOR=Angi rabattgruppekoder du kan bruke som kriterier n†r du definerer spesielle rabatter p† et kunde-, leverand›r- eller varekort.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 513;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Discount;
                      PromotedCategory=Category4 }
      { 15      ;1   ;ActionGroup;
                      CaptionML=[ENU=Posting;
                                 NOR=Bokf›ring] }
      { 11      ;2   ;Action    ;
                      CaptionML=[ENU=Inventory Posting Setup;
                                 NOR=Lagerbokf›ringsoppsett];
                      ToolTipML=[ENU=Set up links between inventory posting groups, inventory locations, and general ledger accounts to define where transactions for inventory items are recorded in the general ledger.;
                                 NOR=Lag forbindelser mellom lagerbokf›ringsgrupper, lagerlokasjoner og finanskonti for † definere hvor lagervaretransaksjoner registreres i Finans.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 5826;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PostedInventoryPick;
                      PromotedCategory=Category5 }
      { 9       ;2   ;Action    ;
                      CaptionML=[ENU=Inventory Posting Groups;
                                 NOR=Bokf›ringsgrupper - lager];
                      ToolTipML=[ENU=Set up the posting groups that you assign to item cards to link business transactions made for the item with an inventory account in the general ledger to group amounts for that item type.;
                                 NOR=Definer bokf›ringsgruppene du knytter til varekort for † koble forretningstransaksjoner for varen til en lagerkonto i Finans, for † gruppere bel›p for den varetypen.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 112;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=ItemGroup;
                      PromotedCategory=Category5 }
      { 7       ;1   ;ActionGroup;
                      CaptionML=[ENU=Journal Templates;
                                 NOR=Kladdemaler] }
      { 5       ;2   ;Action    ;
                      CaptionML=[ENU=Item Journal Templates;
                                 NOR=Varekladdemaler];
                      ToolTipML=[ENU=Set up number series and reason codes in the journals that you use for inventory adjustment. By using different templates you can design windows with different layouts and you can assign trace codes, number series, and reports to each template.;
                                 NOR=Definer nummerserier og †rsakskoder i kladdene du bruker for lagerjustering. Ved hjelp av ulike maler kan du utforme vinduer med ulike oppsett, og du kan knytte sporingskoder, nummerserier og rapporter til hver mal.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 102;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=JournalSetup;
                      PromotedCategory=Category6 }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=[ENU=General;
                           NOR=Generelt] }

    { 2   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies that the Automatic Cost Posting function is used.;
                           NOR=Angir at funksjonen Automatisk kostbokf›ring brukes.];
                SourceExpr="Automatic Cost Posting" }

    { 24  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the ability to post expected costs to interim accounts in the general ledger.;
                           NOR=Angir muligheten til † bokf›re forventede kostnader til midlertidige konti i finans.];
                SourceExpr="Expected Cost Posting to G/L";
                Importance=Additional }

    { 36  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies whether to adjust for any cost changes when you post inventory transactions.;
                           NOR=Angir om det skal justeres for eventuelle kostendringer ved bokf›ring av lagertransaksjoner.];
                SourceExpr="Automatic Cost Adjustment" }

    { 22  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies information about the method that the program uses to calculate average cost.;
                           NOR=Angir opplysninger om hvilken metode programmet bruker ved beregning av gjennomsnittlig kost.];
                OptionCaptionML=[ENU=,Item,Item & Location & Variant;
                                 NOR=,Vare,Vare og lokasjon og variant];
                SourceExpr="Average Cost Calc. Type";
                Importance=Additional }

    { 38  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the period of time used to calculate the weighted average cost of items that apply the average costing method.;
                           NOR=Angir tidsperioden som brukes til † beregne den vektet gjennomsnittlig kost for varer som utligner den gjennomsnittlige lagermetoden.];
                OptionCaptionML=[ENU=,Day,Week,Month,,,Accounting Period;
                                 NOR=,Dag,Uke,M†ned,,,Regnskapsperiode];
                SourceExpr="Average Cost Period";
                Importance=Additional }

    { 12  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies that you want the program to copy the comments entered on the transfer order to the transfer shipment.;
                           NOR=Angir at du vil at programmet skal kopiere merknadene i overf›ringsordren til overf›ringsseddelen.];
                SourceExpr="Copy Comments Order to Shpt.";
                Importance=Additional }

    { 14  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies that you want the program to copy the comments entered on the transfer order to the transfer receipt.;
                           NOR=Angir at du vil at programmet skal kopiere merknadene i overf›ringsordren til overf›ringsmottaket.];
                SourceExpr="Copy Comments Order to Rcpt.";
                Importance=Additional }

    { 26  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a date formula for the outbound warehouse handling time for your company in general.;
                           NOR=Angir en datoformel for utg†ende lagerh†ndteringstid for selskapet generelt sett.];
                SourceExpr="Outbound Whse. Handling Time";
                Importance=Additional }

    { 28  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a date formula for the inbound warehouse handling time for your company in general.;
                           NOR=Angir en datoformel for inng†ende lagerh†ndteringstid for selskapet generelt sett.];
                SourceExpr="Inbound Whse. Handling Time";
                Importance=Additional }

    { 3   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies if you can post transactions that will bring inventory levels below zero.;
                           NOR=Angir om du kan bokf›re transaksjoner som bringer lagerniv†ene under null.];
                SourceExpr="Prevent Negative Inventory" }

    { 1904339001;1;Group  ;
                CaptionML=[ENU=Location;
                           NOR=Lokasjon] }

    { 4   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies whether items must have a location code in order to be posted.;
                           NOR=Angir om varer m† ha en lokasjonskode for † bli bokf›rt.];
                SourceExpr="Location Mandatory" }

    { 1900309501;1;Group  ;
                CaptionML=[ENU=Dimensions;
                           NOR=Dimensjoner] }

    { 34  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the dimension code that you want to use for product groups in analysis reports.;
                           NOR=Angir dimensjonskoden du vil bruke for produktgrupper i analyserapporter.];
                ApplicationArea=#Suite;
                SourceExpr="Item Group Dimension Code" }

    { 1904569201;1;Group  ;
                CaptionML=[ENU=Numbering;
                           NOR=Nummerering] }

    { 81  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number series code that will be used to assign numbers to items.;
                           NOR=Angir koden for nummerserien som skal brukes til † tilordne numre til varer.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Item Nos." }

    { 16  ;2   ;Field     ;
                CaptionML=[ENU=Non-stock Item Nos.;
                           NOR=Katalogvarenr.];
                ToolTipML=[ENU=Specifies the number series that is used for nonstock items.;
                           NOR=Angir nummerserien som brukes for katalogvarer.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Nonstock Item Nos.";
                Importance=Additional }

    { 6   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number series code that the program uses to assign numbers to transfer orders.;
                           NOR=Angir koden for nummerserien som programmet bruker til † tilordne numre til overf›ringsordrer.];
                SourceExpr="Transfer Order Nos.";
                Importance=Additional }

    { 8   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number series code that the program uses to assign numbers to posted transfer shipments.;
                           NOR=Angir koden for nummerserien som programmet bruker til † tilordne numre til bokf›rte overf›ringssedler.];
                SourceExpr="Posted Transfer Shpt. Nos.";
                Importance=Additional }

    { 10  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number series code that will be used to assign numbers to posted transfer receipt documents.;
                           NOR=Angir koden for nummerserien som skal brukes til † tilordne numre til bokf›rte dokumenter for overf›ringsmottak.];
                SourceExpr="Posted Transfer Rcpt. Nos.";
                Importance=Additional }

    { 18  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number series code to assign numbers to inventory put-always.;
                           NOR=Angir koden for nummerserien for † tilordne numre til lagerplasseringer.];
                SourceExpr="Inventory Put-away Nos.";
                Importance=Additional }

    { 30  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number series code to assign numbers to posted inventory put-always.;
                           NOR=Angir koden for nummerserien for † tilordne numre til bokf›rte lagerplasseringer.];
                SourceExpr="Posted Invt. Put-away Nos.";
                Importance=Additional }

    { 20  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number series code to assign numbers to inventory picks.;
                           NOR=Angir koden for nummerserien for † tilordne numre til lagerplukkinger.];
                SourceExpr="Inventory Pick Nos.";
                Importance=Additional }

    { 32  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number series code to assign numbers to posted inventory picks.;
                           NOR=Angir koden for nummerserien for † tilordne numre til bokf›rte lagerplukkinger.];
                SourceExpr="Posted Invt. Pick Nos.";
                Importance=Additional }

    { 40  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number series code used to assign numbers to inventory movements.;
                           NOR=Angir koden for nummerserien som skal brukes til † tilordne numre til lagerflyttinger.];
                SourceExpr="Inventory Movement Nos.";
                Importance=Additional }

    { 42  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number series code to assign numbers to registered inventory movements.;
                           NOR=Angir koden for nummerserien for † tilordne numre til registrerte lagerflyttinger.];
                SourceExpr="Registered Invt. Movement Nos.";
                Importance=Additional }

    { 44  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number series code used to assign numbers to internal movements.;
                           NOR=Angir koden for nummerserien som skal brukes til † tilordne numre til interne flyttinger.];
                SourceExpr="Internal Movement Nos.";
                Importance=Additional }

    { 1101103000;2;Field  ;
                SourceExpr="Item Calculation Nos." }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 01.09.17 JAL Item Calculation (Kalkyle)
                       New field "Price Calculation Nos."
    }
    END.
  }
}

OBJECT Page 73051 Item Calculation
{
  OBJECT-PROPERTIES
  {
    Date=08.09.17;
    Time=15.01.38;
    Modified=Yes;
    Version List=ICA2.01;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Item Calculation;
               NOR=Kalkyle];
    SourceTable=Table73051;
    PageType=Document;
    RefreshOnActivate=Yes;
    OnNewRecord=BEGIN
                  // FilterG := GETFILTER("Calc No.");
                  // IF FilterG <> '' THEN
                  //  Rec.RESET;
                  //  VALIDATE("Calc No.",'');
                END;

    ActionList=ACTIONS
    {
      { 1101103020;  ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1101103021;1 ;ActionGroup }
      { 1101103022;2 ;Action    ;
                      Name=CopyCalculationFrom;
                      CaptionML=[ENU=Copy Calculation From;
                                 NOR="Kopier fra kalkyle "];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=CopyItem;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 CalcHeaderL@1101103005 : Record 73051;
                                 CalcListL@1101103004 : Page 73053;
                                 CopyFromCalcL@1101103003 : Code[20];
                                 TXT001L@1101103000 : TextConst 'ENU=You cannot copy calculation to it self. Create a new calculation no?;NOR=Du kan ikke kopiere en kalkyle til seg selv. Opprett en ny kalkyle?';
                               BEGIN
                                 CLEAR(CalcHeaderL);
                                 CLEAR(CalcListL);
                                 CalcHeaderL.SETFILTER("No.", '<>%1', Rec."No.");
                                 CalcListL.SETTABLEVIEW(CalcHeaderL);
                                 CalcListL.LOOKUPMODE(TRUE);
                                 IF CalcListL.RUNMODAL = ACTION::LookupOK THEN BEGIN
                                   CalcListL.GETRECORD(CalcHeaderL);
                                   CopyFromCalcL := CalcHeaderL."No.";
                                 END;
                                 IF "Item No." = '' THEN BEGIN
                                   IF "No." = '' THEN
                                     VALIDATE("No.",'');
                                   CopyCalculation("No.",CopyFromCalcL);
                                 END ELSE BEGIN
                                   ERROR(TXT001L);
                                 END;
                               END;
                                }
      { 1101103006;2 ;Action    ;
                      Name=PrintCalculation;
                      CaptionML=[ENU=Print Item Price Calculation;
                                 NOR=Skriv ut kalkyle];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Print;
                      PromotedCategory=Report;
                      OnAction=VAR
                                 PriceCalcHeadL@1101103000 : Record 73051;
                                 ItemPriceCalculationL@1101103001 : Report 73050;
                               BEGIN
                                 PriceCalcHeadL.SETRANGE("No.", Rec."No.");
                                 ItemPriceCalculationL.SETTABLEVIEW(PriceCalcHeadL);
                                 ItemPriceCalculationL.RUN();
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1101103000;0;Container;
                ContainerType=ContentArea }

    { 1101103001;1;Group  ;
                Name=General;
                GroupType=Group }

    { 1101103002;2;Field  ;
                SourceExpr="No." }

    { 1101103003;2;Field  ;
                SourceExpr="Order Quantity" }

    { 1101103004;2;Field  ;
                SourceExpr="Item No.";
                OnValidate=VAR
                             ItemL@1101103000 : Record 27;
                           BEGIN
                             IF ItemL.GET("Item No.") THEN BEGIN
                               Calculate("Calc. Date");
                             END;
                           END;
                            }

    { 1101103005;2;Field  ;
                SourceExpr="Item Description" }

    { 1101103007;2;Field  ;
                SourceExpr="Project Code" }

    { 1101103014;2;Field  ;
                SourceExpr="Calc. Date" }

    { 1101103015;2;Field  ;
                SourceExpr="Calc. by" }

    { 1101103016;2;Field  ;
                SourceExpr=Locked }

    { 1101103008;2;Field  ;
                SourceExpr="Tot. Material Cost" }

    { 1101103009;2;Field  ;
                SourceExpr="Tot. Capacity Cost" }

    { 1101103010;2;Field  ;
                SourceExpr="Tot. Additional Cost" }

    { 1101103011;2;Field  ;
                SourceExpr="Tot. Cost" }

    { 1101103012;2;Field  ;
                SourceExpr="Calc. Factor" }

    { 1101103013;2;Field  ;
                SourceExpr="Sales Price" }

    { 1101103023;1;Part   ;
                Name=PriceCalcLinesMaterial;
                CaptionML=[ENU=Material;
                           NOR=Materiale];
                SubPageLink=Type=CONST(Material),
                            Calc. No.=FIELD(No.);
                PagePartID=Page73052;
                Enabled="Item No." <> '';
                PartType=Page;
                UpdatePropagation=Both }

    { 1101103024;1;Part   ;
                Name=PriceCalcRoutingLines;
                CaptionML=[ENU=Work;
                           NOR=Rutelinjer];
                SubPageLink=Type=CONST(Capacity),
                            Calc. No.=FIELD(No.);
                PagePartID=Page73054;
                Enabled="Item No." <> '';
                PartType=Page;
                UpdatePropagation=Both }

    { 1101103025;1;Part   ;
                Name=PriceCalcLinesMics;
                CaptionML=[ENU=Mics.;
                           NOR=Diverse];
                SubPageLink=Type=CONST(Additional),
                            Calc. No.=FIELD(No.);
                PagePartID=Page73052;
                Enabled="Item No." <> '';
                PartType=Page;
                UpdatePropagation=Both }

  }
  CODE
  {
    VAR
      FilterG@1101103000 : Text;

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 01.09.17 JAL Item Calculation (Kalkyle)
    }
    END.
  }
}

OBJECT Page 73052 Item Calc. Subform
{
  OBJECT-PROPERTIES
  {
    Date=08.09.17;
    Time=15.10.30;
    Modified=Yes;
    Version List=ICA2.01;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Lines;
               NOR=Kalkylelinjer];
    MultipleNewLines=Yes;
    SourceTable=Table73052;
    DelayedInsert=Yes;
    PageType=ListPart;
    OnNewRecord=BEGIN
                  "Calc. No." := xRec."Calc. No.";
                  Type := xRec.Type;
                  "Sequence No." := xRec."Sequence No." + 10;
                END;

  }
  CONTROLS
  {
    { 1101103000;0;Container;
                ContainerType=ContentArea }

    { 1101103001;1;Group  ;
                Name=Group;
                GroupType=Repeater }

    { 1101103002;2;Field  ;
                SourceExpr=Type }

    { 1101103003;2;Field  ;
                SourceExpr="No." }

    { 1101103005;2;Field  ;
                SourceExpr=Description }

    { 1101103006;2;Field  ;
                SourceExpr=Quantity;
                OnValidate=BEGIN
                             CurrPage.UPDATE();
                           END;
                            }

    { 1101103007;2;Field  ;
                SourceExpr="Unit of Measure" }

    { 1101103008;2;Field  ;
                SourceExpr="Unit Cost";
                OnValidate=BEGIN
                             CurrPage.UPDATE();
                           END;
                            }

    { 1101103009;2;Field  ;
                SourceExpr="Line Amount";
                OnValidate=BEGIN
                             CurrPage.UPDATE();
                           END;
                            }

    { 1101103011;2;Field  ;
                SourceExpr="Purchase Price" }

    { 1101103012;2;Field  ;
                SourceExpr="Vendor No." }

  }
  CODE
  {

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 01.09.17 JAL Item Calculation (Kalkyle)
    }
    END.
  }
}

OBJECT Page 73053 Item Calculation List
{
  OBJECT-PROPERTIES
  {
    Date=08.09.17;
    Time=08.27.51;
    Modified=Yes;
    Version List=ICA2.01;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Item Calculation List;
               NOR=Kalkyle oversikt];
    SourceTable=Table73051;
    PageType=List;
    CardPageID=Item Calculation;
    ActionList=ACTIONS
    {
      { 1101103014;  ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1101103013;1 ;ActionGroup }
      { 1101103012;2 ;Action    ;
                      Name=CopyCalculationFrom;
                      CaptionML=[ENU=Copy Calculation From;
                                 NOR="Kopier fra kalkyle "];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=CopyItem;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 CalcHeaderL@1101103005 : Record 73051;
                                 CalcListL@1101103004 : Page 73053;
                                 CopyFromCalcL@1101103003 : Code[20];
                                 TXT001L@1101103000 : TextConst 'ENU=You cannot copy calculation to it self. Create a new calculation no?;NOR=Du kan ikke kopiere en kalkyle til seg selv. Opprett en ny kalkyle?';
                               BEGIN
                                 CLEAR(CalcHeaderL);
                                 CLEAR(CalcListL);
                                 CalcHeaderL.SETFILTER("No.", '<>%1', Rec."No.");
                                 CalcListL.SETTABLEVIEW(CalcHeaderL);
                                 CalcListL.LOOKUPMODE(TRUE);
                                 IF CalcListL.RUNMODAL = ACTION::LookupOK THEN BEGIN
                                   CalcListL.GETRECORD(CalcHeaderL);
                                   CopyFromCalcL := CalcHeaderL."No.";
                                 END;
                                 IF "Item No." = '' THEN BEGIN
                                   IF "No." = '' THEN
                                     VALIDATE("No.",'');
                                   CopyCalculation("No.",CopyFromCalcL);
                                 END ELSE BEGIN
                                   ERROR(TXT001L);
                                 END;
                               END;
                                }
      { 1101103011;2 ;Action    ;
                      Name=PrintCalculation;
                      CaptionML=[ENU=Print Item Price Calculation;
                                 NOR=Skriv ut kalkyle];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Print;
                      PromotedCategory=Report;
                      OnAction=VAR
                                 PriceCalcHeadL@1101103000 : Record 73051;
                                 ItemPriceCalculationL@1101103001 : Report 73050;
                               BEGIN
                                 PriceCalcHeadL.SETRANGE("No.", Rec."No.");
                                 ItemPriceCalculationL.SETTABLEVIEW(PriceCalcHeadL);
                                 ItemPriceCalculationL.RUN();
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1101103000;0;Container;
                ContainerType=ContentArea }

    { 1101103001;1;Group  ;
                Name=Group;
                GroupType=Repeater }

    { 1101103002;2;Field  ;
                SourceExpr="No." }

    { 1101103003;2;Field  ;
                SourceExpr="Item No." }

    { 1101103004;2;Field  ;
                SourceExpr="Item Description" }

    { 1101103005;2;Field  ;
                SourceExpr="Order Quantity" }

    { 1101103006;2;Field  ;
                SourceExpr="Calc. Date" }

    { 1101103007;2;Field  ;
                SourceExpr="Sales Price" }

    { 1101103008;2;Field  ;
                SourceExpr="Tot. Cost" }

    { 1101103009;2;Field  ;
                SourceExpr="Calc. Factor" }

    { 1101103010;2;Field  ;
                SourceExpr="Lot Size (No. of PCS)" }

  }
  CODE
  {

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 01.09.17 JAL Item Calculation (Kalkyle)
    }
    END.
  }
}

OBJECT Page 73054 Item Calc. Routing Lines
{
  OBJECT-PROPERTIES
  {
    Date=08.09.17;
    Time=08.30.06;
    Modified=Yes;
    Version List=ICA2.01;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Item Calc. Routing Lines;
               NOR=Kalkylelinjer rutelinjer];
    MultipleNewLines=Yes;
    SourceTable=Table73052;
    DelayedInsert=Yes;
    PageType=ListPart;
    OnNewRecord=BEGIN
                  "Calc. No." := xRec."Calc. No.";
                  Type := xRec.Type;
                  "Sequence No." := xRec."Sequence No." + 10;
                END;

  }
  CONTROLS
  {
    { 1101103000;0;Container;
                ContainerType=ContentArea }

    { 1101103001;1;Group  ;
                Name=Group;
                GroupType=Repeater }

    { 1101103002;2;Field  ;
                SourceExpr=Type }

    { 1101103003;2;Field  ;
                SourceExpr="No." }

    { 1101103004;2;Field  ;
                SourceExpr="Work Center" }

    { 1101103005;2;Field  ;
                SourceExpr=Description }

    { 1101103006;2;Field  ;
                SourceExpr=Quantity;
                OnValidate=BEGIN
                             CurrPage.UPDATE();
                           END;
                            }

    { 1101103007;2;Field  ;
                SourceExpr="Unit of Measure" }

    { 1101103008;2;Field  ;
                SourceExpr="Unit Cost";
                OnValidate=BEGIN
                             CurrPage.UPDATE();
                           END;
                            }

    { 1101103009;2;Field  ;
                SourceExpr="Line Amount";
                OnValidate=BEGIN
                             CurrPage.UPDATE();
                           END;
                            }

    { 1101103010;2;Field  ;
                SourceExpr="Vendor No." }

    { 1101103011;2;Field  ;
                SourceExpr="Activity Type" }

  }
  CODE
  {

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 01.09.17 JAL Item Calculation (Kalkyle)
    }
    END.
  }
}

OBJECT Page 99000830 Firm Planned Prod. Order Lines
{
  OBJECT-PROPERTIES
  {
    Date=05.09.17;
    Time=16.13.41;
    Modified=Yes;
    Version List=NAVW110.00,ICA2.01;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Lines;
               NOR=Linjer];
    MultipleNewLines=Yes;
    LinksAllowed=No;
    SourceTable=Table5406;
    DelayedInsert=Yes;
    SourceTableView=WHERE(Status=CONST(Firm Planned));
    PageType=ListPart;
    AutoSplitKey=Yes;
    OnAfterGetRecord=BEGIN
                       DescriptionIndent := 0;
                       ShowShortcutDimCode(ShortcutDimCode);
                       DescriptionOnFormat;
                     END;

    OnNewRecord=BEGIN
                  CLEAR(ShortcutDimCode);
                END;

    OnDeleteRecord=VAR
                     ReserveProdOrderLine@1000 : Codeunit 99000837;
                   BEGIN
                     COMMIT;
                     IF NOT ReserveProdOrderLine.DeleteLineConfirm(Rec) THEN
                       EXIT(FALSE);
                   END;

    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1906587504;1 ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 NOR=F&unksjoner];
                      Image=Action }
      { 1901741804;2 ;Action    ;
                      CaptionML=[ENU=&Reserve;
                                 NOR=Re&server];
                      Image=Reserve;
                      OnAction=BEGIN
                                 PageShowReservation;
                               END;
                                }
      { 1900205904;2 ;Action    ;
                      CaptionML=[ENU=Order &Tracking;
                                 NOR=&Sporing];
                      Image=OrderTracking;
                      OnAction=BEGIN
                                 ShowTracking;
                               END;
                                }
      { 1907935204;1 ;ActionGroup;
                      CaptionML=[ENU=&Line;
                                 NOR=&Linje];
                      Image=Line }
      { 1903867004;2 ;ActionGroup;
                      CaptionML=[ENU=Item Availability by;
                                 NOR=Varetilgjengelighet per];
                      Image=ItemAvailability }
      { 5       ;3   ;Action    ;
                      CaptionML=[ENU=Event;
                                 NOR=Hendelse];
                      Image=Event;
                      OnAction=BEGIN
                                 ItemAvailFormsMgt.ShowItemAvailFromProdOrderLine(Rec,ItemAvailFormsMgt.ByEvent);
                               END;
                                }
      { 1901313404;3 ;Action    ;
                      CaptionML=[ENU=Period;
                                 NOR=Periode];
                      Image=Period;
                      OnAction=BEGIN
                                 ItemAvailFormsMgt.ShowItemAvailFromProdOrderLine(Rec,ItemAvailFormsMgt.ByPeriod);
                               END;
                                }
      { 1901652304;3 ;Action    ;
                      CaptionML=[ENU=Variant;
                                 NOR=Variant];
                      Image=ItemVariant;
                      OnAction=BEGIN
                                 ItemAvailFormsMgt.ShowItemAvailFromProdOrderLine(Rec,ItemAvailFormsMgt.ByVariant);
                               END;
                                }
      { 1901991504;3 ;Action    ;
                      AccessByPermission=TableData 14=R;
                      CaptionML=[ENU=Location;
                                 NOR=Lokasjon];
                      Image=Warehouse;
                      OnAction=BEGIN
                                 ItemAvailFormsMgt.ShowItemAvailFromProdOrderLine(Rec,ItemAvailFormsMgt.ByLocation);
                               END;
                                }
      { 3       ;3   ;Action    ;
                      CaptionML=[ENU=BOM Level;
                                 NOR=Stykklisteniv†];
                      Image=BOMLevel;
                      OnAction=BEGIN
                                 ItemAvailFormsMgt.ShowItemAvailFromProdOrderLine(Rec,ItemAvailFormsMgt.ByBOM);
                               END;
                                }
      { 1901313004;2 ;Action    ;
                      AccessByPermission=TableData 27=R;
                      CaptionML=[ENU=Reservation Entries;
                                 NOR=Reservasjonsposter];
                      Image=ReservationLedger;
                      OnAction=BEGIN
                                 ShowReservationEntries(TRUE);
                               END;
                                }
      { 1900545004;2 ;Action    ;
                      AccessByPermission=TableData 348=R;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 NOR=Dimensjoner];
                      ToolTipML=[ENU=View or edit dimensions, such as area, project, or department, that you can assign to sales and purchase documents to distribute costs and analyze transaction history.;
                                 NOR=Vis eller rediger dimensjoner, for eksempel omr†de, prosjekt eller avdeling, som du kan tilordne til salgs- og kj›psdokumenter for † distribuere kostnader og analysere transaksjonshistorikk.];
                      Image=Dimensions;
                      OnAction=BEGIN
                                 ShowDimensions;
                               END;
                                }
      { 1901652204;2 ;Action    ;
                      CaptionML=[ENU=Ro&uting;
                                 NOR=R&ute];
                      Image=Route;
                      OnAction=BEGIN
                                 ShowRouting;
                               END;
                                }
      { 1903098604;2 ;Action    ;
                      CaptionML=[ENU=Components;
                                 NOR=Komponenter];
                      Image=Components;
                      OnAction=BEGIN
                                 ShowComponents;
                               END;
                                }
      { 1905987604;2 ;Action    ;
                      ShortCutKey=Shift+Ctrl+I;
                      CaptionML=[ENU=Item &Tracking Lines;
                                 NOR=Vare&sporingslinjer];
                      Image=ItemTrackingLines;
                      OnAction=BEGIN
                                 OpenItemTrackingLines;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                IndentationColumnName=DescriptionIndent;
                IndentationControls=Description;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the item that is to be produced.;
                           NOR=Angir nummeret for varen som skal produseres.];
                SourceExpr="Item No." }

    { 4   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a code if you have set up variant codes in the Item Variants window.;
                           NOR=Angir en kode hvis du har definert variantkoder i vinduet Varevarianter.];
                SourceExpr="Variant Code";
                Visible=FALSE }

    { 8   ;2   ;Field     ;
                ToolTipML=[ENU=Copies the date in this field from the corresponding field on the production order header.;
                           NOR=Kopierer datoen i dette feltet fra tilh›rende felt i produksjonsordrehodet.];
                SourceExpr="Due Date" }

    { 46  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies whether the supply represented by this line is considered by the planning system when calculating action messages.;
                           NOR=Angir om forsyningen, som representeres denne linjen, vurderes av planleggingssystemet ved beregning av handlingsmeldinger.];
                SourceExpr="Planning Flexibility";
                Visible=FALSE }

    { 6   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the value of the Description field on the item card. If you enter a variant code, the variant description is copied to this field instead.;
                           NOR=Angir verdien i feltet Beskrivelse p† varekortet. Hvis du angir en variantkode, kopieres variantbeskrivelsen i stedet.];
                SourceExpr=Description }

    { 10  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies an additional description.;
                           NOR=Angir en tilleggsbeskrivelse.];
                SourceExpr="Description 2";
                Visible=FALSE }

    { 40  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the production BOM that is the basis for creating the Prod. Order Component list for this line.;
                           NOR=Angir nummeret p† produksjonsstykklisten som er grunnlaget for † opprette listen Prod.ordrekomponent for denne linjen.];
                SourceExpr="Production BOM No.";
                Visible=FALSE }

    { 42  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the routing used as the basis for creating the production order routing for this line.;
                           NOR=Angir nummeret p† ruten som brukes for † opprette produksjonsordrerute for denne linjen.];
                SourceExpr="Routing No.";
                Visible=FALSE }

    { 30  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the version code of the production BOM.;
                           NOR=Angir versjonskoden for produksjonsstykklisten.];
                SourceExpr="Production BOM Version Code";
                Visible=FALSE }

    { 32  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the version number of the routing.;
                           NOR=Angir versjonsnummeret for ruten.];
                SourceExpr="Routing Version Code";
                Visible=FALSE }

    { 24  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the location code, if the produced items should be stored in a specific location.;
                           NOR=Angir lokasjonskoden, hvis de produserte varene blir lagret p† en bestemt lokasjon.];
                SourceExpr="Location Code";
                Visible=FALSE }

    { 26  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the bin that the produced item is posted to as output, and from where it can be taken to storage or cross-docked.;
                           NOR=Angir hyllen som den produserte varen er postert til som avgang, og hvor den kan tas fra til lager eller kryssoverf›ring.];
                SourceExpr="Bin Code";
                Visible=FALSE }

    { 50  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the starting date and the starting time, which are combined in a format called "starting date-time".;
                           NOR=Angir startdatoen og starttidspunktet som er kombinert i et format som kalles "Startdato-tidsp.".];
                SourceExpr="Starting Date-Time" }

    { 16  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the entry's starting time, which is retrieved from the production order routing.;
                           NOR=Angir postens startklokkeslett, som hentes fra produksjonsordreruten.];
                SourceExpr="Starting Time";
                Visible=FALSE }

    { 14  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the entry's starting date, which is retrieved from the production order routing.;
                           NOR=Angir postens startdato, som hentes fra produksjonsordreruten.];
                SourceExpr="Starting Date";
                Visible=FALSE }

    { 52  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the ending date and the ending time, which are combined in a format called "ending date-time".;
                           NOR=Angir sluttdatoen og sluttidspunktet som er kombinert i et format som kalles "Sluttdato-tidsp.".];
                SourceExpr="Ending Date-Time" }

    { 20  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the entry's ending time, which is retrieved from the production order routing.;
                           NOR=Angir postens sluttklokkeslett, som hentes fra produksjonsordreruten.];
                SourceExpr="Ending Time";
                Visible=FALSE }

    { 18  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the entry's ending date, which is retrieved from the production order routing.;
                           NOR=Angir postens sluttdato, som hentes fra produksjonsordreruten.];
                SourceExpr="Ending Date";
                Visible=FALSE }

    { 1101103000;2;Field  ;
                SourceExpr="Calculation No.";
                Editable=FALSE }

    { 38  ;2   ;Field     ;
                ToolTipML=[ENU=Copies the value in this field from the Scrap Percentage field on the item card when the Item No. field is filled in.;
                           NOR=Kopierer verdien i dette feltet fra feltet Vrakprosent p† varekortet n†r feltet Varenr. fylles ut.];
                SourceExpr="Scrap %";
                Visible=FALSE }

    { 28  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the quantity to be produced if you manually fill in this line.;
                           NOR=Angir antallet som skal produseres hvis du fyller ut denne linjen manuelt.];
                SourceExpr=Quantity }

    { 44  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the base unit of measure code for the item.;
                           NOR=Angir lagerenhetskoden for varen.];
                SourceExpr="Unit of Measure Code" }

    { 48  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies how many units of this item have been reserved.;
                           NOR=Angir hvor mange enheter av denne varen som er reservert.];
                SourceExpr="Reserved Quantity";
                Visible=FALSE }

    { 34  ;2   ;Field     ;
                ToolTipML=[ENU=Calculates the unit cost, based on the cost of the components in the production order component list, and the routing, if the costing method is not standard.;
                           NOR=Beregner enhetskosten, basert p† kosten for komponenter i listen over produksjonsordrekomponenter, og ruten, hvis kostmetoden ikke er standard.];
                SourceExpr="Unit Cost" }

    { 36  ;2   ;Field     ;
                ToolTipML=[ENU=Calculates the amount by multiplying the Unit Cost by the Quantity.;
                           NOR=Beregner bel›pet ved † multiplisere enhetskosten med antallet.];
                SourceExpr="Cost Amount" }

    { 12  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a dimension value code for a dimension.;
                           NOR=Angir en dimensjonsverdikode for en dimensjon.];
                SourceExpr="Shortcut Dimension 1 Code";
                Visible=FALSE }

    { 22  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a dimension value code for a dimension.;
                           NOR=Angir en dimensjonsverdikode for en dimensjon.];
                SourceExpr="Shortcut Dimension 2 Code";
                Visible=FALSE }

    { 300 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[3];
                CaptionClass='1,2,3';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(3),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(3,ShortcutDimCode[3]);
                           END;
                            }

    { 302 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[4];
                CaptionClass='1,2,4';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(4),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(4,ShortcutDimCode[4]);
                           END;
                            }

    { 304 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[5];
                CaptionClass='1,2,5';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(5),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(5,ShortcutDimCode[5]);
                           END;
                            }

    { 306 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[6];
                CaptionClass='1,2,6';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(6),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(6,ShortcutDimCode[6]);
                           END;
                            }

    { 308 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[7];
                CaptionClass='1,2,7';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(7),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(7,ShortcutDimCode[7]);
                           END;
                            }

    { 310 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[8];
                CaptionClass='1,2,8';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(8),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(8,ShortcutDimCode[8]);
                           END;
                            }

  }
  CODE
  {
    VAR
      ItemAvailFormsMgt@1000 : Codeunit 353;
      ShortcutDimCode@1001 : ARRAY [8] OF Code[20];
      DescriptionIndent@19057867 : Integer INDATASET;

    LOCAL PROCEDURE ShowComponents@1();
    VAR
      ProdOrderComp@1000 : Record 5407;
    BEGIN
      ProdOrderComp.SETRANGE(Status,Status);
      ProdOrderComp.SETRANGE("Prod. Order No.","Prod. Order No.");
      ProdOrderComp.SETRANGE("Prod. Order Line No.","Line No.");

      PAGE.RUN(PAGE::"Prod. Order Components",ProdOrderComp);
    END;

    LOCAL PROCEDURE ShowTracking@3();
    VAR
      TrackingForm@1000 : Page 99000822;
    BEGIN
      TrackingForm.SetProdOrderLine(Rec);
      TrackingForm.RUNMODAL;
    END;

    LOCAL PROCEDURE PageShowReservation@4();
    BEGIN
      CurrPage.SAVERECORD;
      ShowReservation;
    END;

    PROCEDURE UpdateForm@6(SetSaveRecord@1000 : Boolean);
    BEGIN
      CurrPage.UPDATE(SetSaveRecord);
    END;

    LOCAL PROCEDURE DescriptionOnFormat@19023855();
    BEGIN
      DescriptionIndent := "Planning Level Code";
    END;

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 05.09.17 JAL Item Calculation (Kalkyle)
                       New field "Calulation No."
    }
    END.
  }
}

OBJECT Page 99000832 Released Prod. Order Lines
{
  OBJECT-PROPERTIES
  {
    Date=05.09.17;
    Time=16.15.23;
    Modified=Yes;
    Version List=NAVW110.00,ICA2.01;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Lines;
               NOR=Linjer];
    MultipleNewLines=Yes;
    LinksAllowed=No;
    SourceTable=Table5406;
    DelayedInsert=Yes;
    SourceTableView=WHERE(Status=CONST(Released));
    PageType=ListPart;
    AutoSplitKey=Yes;
    OnAfterGetRecord=BEGIN
                       DescriptionIndent := 0;
                       ShowShortcutDimCode(ShortcutDimCode);
                       DescriptionOnFormat;
                     END;

    OnNewRecord=BEGIN
                  CLEAR(ShortcutDimCode);
                END;

    OnDeleteRecord=VAR
                     ReserveProdOrderLine@1000 : Codeunit 99000837;
                   BEGIN
                     COMMIT;
                     IF NOT ReserveProdOrderLine.DeleteLineConfirm(Rec) THEN
                       EXIT(FALSE);
                   END;

    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1906587504;1 ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 NOR=F&unksjoner];
                      Image=Action }
      { 1902759304;2 ;Action    ;
                      CaptionML=[ENU=&Reserve;
                                 NOR=Re&server];
                      Image=Reserve;
                      OnAction=BEGIN
                                 PageShowReservation;
                               END;
                                }
      { 1900205704;2 ;Action    ;
                      CaptionML=[ENU=Order &Tracking;
                                 NOR=&Sporing];
                      Image=OrderTracking;
                      OnAction=BEGIN
                                 ShowTracking;
                               END;
                                }
      { 1907935204;1 ;ActionGroup;
                      CaptionML=[ENU=&Line;
                                 NOR=&Linje];
                      Image=Line }
      { 1901313104;2 ;ActionGroup;
                      CaptionML=[ENU=Item Availability by;
                                 NOR=Varetilgjengelighet per];
                      Image=ItemAvailability }
      { 5       ;3   ;Action    ;
                      Name=ItemAvailabilityByEvent;
                      CaptionML=[ENU=Event;
                                 NOR=Hendelse];
                      Image=Event;
                      OnAction=BEGIN
                                 ItemAvailability(ItemAvailFormsMgt.ByEvent);
                               END;
                                }
      { 1901741904;3 ;Action    ;
                      Name=ItemAvailabilityByPeriod;
                      CaptionML=[ENU=Period;
                                 NOR=Periode];
                      Image=Period;
                      OnAction=BEGIN
                                 ItemAvailability(ItemAvailFormsMgt.ByPeriod);
                               END;
                                }
      { 1903866604;3 ;Action    ;
                      Name=ItemAvailabilityByVariant;
                      CaptionML=[ENU=Variant;
                                 NOR=Variant];
                      Image=ItemVariant;
                      OnAction=BEGIN
                                 ItemAvailability(ItemAvailFormsMgt.ByVariant);
                               END;
                                }
      { 1901313004;3 ;Action    ;
                      Name=ItemAvailabilityByLocation;
                      AccessByPermission=TableData 14=R;
                      CaptionML=[ENU=Location;
                                 NOR=Lokasjon];
                      Image=Warehouse;
                      OnAction=BEGIN
                                 ItemAvailability(ItemAvailFormsMgt.ByLocation);
                               END;
                                }
      { 3       ;3   ;Action    ;
                      Name=ItemAvailabilityByBOMLevel;
                      CaptionML=[ENU=BOM Level;
                                 NOR=Stykklisteniv†];
                      Image=BOMLevel;
                      OnAction=BEGIN
                                 ItemAvailability(ItemAvailFormsMgt.ByBOM);
                               END;
                                }
      { 1900205804;2 ;Action    ;
                      Name=ReservationEntries;
                      AccessByPermission=TableData 27=R;
                      CaptionML=[ENU=Reservation Entries;
                                 NOR=Reservasjonsposter];
                      Image=ReservationLedger;
                      OnAction=BEGIN
                                 ShowReservation;
                               END;
                                }
      { 1901288104;2 ;Action    ;
                      Name=Dimensions;
                      AccessByPermission=TableData 348=R;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 NOR=Dimensjoner];
                      ToolTipML=[ENU=View or edit dimensions, such as area, project, or department, that you can assign to sales and purchase documents to distribute costs and analyze transaction history.;
                                 NOR=Vis eller rediger dimensjoner, for eksempel omr†de, prosjekt eller avdeling, som du kan tilordne til salgs- og kj›psdokumenter for † distribuere kostnader og analysere transaksjonshistorikk.];
                      Image=Dimensions;
                      OnAction=BEGIN
                                 ShowDimensions;
                               END;
                                }
      { 1903098604;2 ;Action    ;
                      Name=Routing;
                      CaptionML=[ENU=Ro&uting;
                                 NOR=R&ute];
                      Image=Route;
                      OnAction=BEGIN
                                 ShowRouting;
                               END;
                                }
      { 1901991404;2 ;Action    ;
                      Name=Components;
                      CaptionML=[ENU=Components;
                                 NOR=Komponenter];
                      Image=Components;
                      OnAction=BEGIN
                                 ShowComponents;
                               END;
                                }
      { 1905987604;2 ;Action    ;
                      Name=ItemTrackingLines;
                      ShortCutKey=Shift+Ctrl+I;
                      CaptionML=[ENU=Item &Tracking Lines;
                                 NOR=Vare&sporingslinjer];
                      Image=ItemTrackingLines;
                      OnAction=BEGIN
                                 OpenItemTrackingLines;
                               END;
                                }
      { 1902760704;2 ;Action    ;
                      Name=ProductionJournal;
                      CaptionML=[ENU=&Production Journal;
                                 NOR=&Produksjonskladd];
                      Image=Journal;
                      OnAction=BEGIN
                                 ShowProductionJournal;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                IndentationColumnName=DescriptionIndent;
                IndentationControls=Description;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the item that is to be produced.;
                           NOR=Angir nummeret for varen som skal produseres.];
                SourceExpr="Item No." }

    { 4   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a code if you have set up variant codes in the Item Variants window.;
                           NOR=Angir en kode hvis du har definert variantkoder i vinduet Varevarianter.];
                SourceExpr="Variant Code";
                Visible=FALSE }

    { 8   ;2   ;Field     ;
                ToolTipML=[ENU=Copies the date in this field from the corresponding field on the production order header.;
                           NOR=Kopierer datoen i dette feltet fra tilh›rende felt i produksjonsordrehodet.];
                SourceExpr="Due Date" }

    { 50  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies whether the supply represented by this line is considered by the planning system when calculating action messages.;
                           NOR=Angir om forsyningen, som representeres denne linjen, vurderes av planleggingssystemet ved beregning av handlingsmeldinger.];
                SourceExpr="Planning Flexibility";
                Visible=FALSE }

    { 6   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the value of the Description field on the item card. If you enter a variant code, the variant description is copied to this field instead.;
                           NOR=Angir verdien i feltet Beskrivelse p† varekortet. Hvis du angir en variantkode, kopieres variantbeskrivelsen i stedet.];
                SourceExpr=Description }

    { 10  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies an additional description.;
                           NOR=Angir en tilleggsbeskrivelse.];
                SourceExpr="Description 2";
                Visible=FALSE }

    { 46  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the production BOM that is the basis for creating the Prod. Order Component list for this line.;
                           NOR=Angir nummeret p† produksjonsstykklisten som er grunnlaget for † opprette listen Prod.ordrekomponent for denne linjen.];
                SourceExpr="Production BOM No.";
                Visible=FALSE }

    { 44  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the routing used as the basis for creating the production order routing for this line.;
                           NOR=Angir nummeret p† ruten som brukes for † opprette produksjonsordrerute for denne linjen.];
                SourceExpr="Routing No.";
                Visible=FALSE }

    { 42  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the version number of the routing.;
                           NOR=Angir versjonsnummeret for ruten.];
                SourceExpr="Routing Version Code";
                Visible=FALSE }

    { 38  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the version code of the production BOM.;
                           NOR=Angir versjonskoden for produksjonsstykklisten.];
                SourceExpr="Production BOM Version Code";
                Visible=FALSE }

    { 24  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the location code, if the produced items should be stored in a specific location.;
                           NOR=Angir lokasjonskoden, hvis de produserte varene blir lagret p† en bestemt lokasjon.];
                SourceExpr="Location Code";
                Visible=FALSE }

    { 26  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the bin that the produced item is posted to as output, and from where it can be taken to storage or cross-docked.;
                           NOR=Angir hyllen som den produserte varen er postert til som avgang, og hvor den kan tas fra til lager eller kryssoverf›ring.];
                SourceExpr="Bin Code";
                Visible=FALSE }

    { 54  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the starting date and the starting time, which are combined in a format called "starting date-time".;
                           NOR=Angir startdatoen og starttidspunktet som er kombinert i et format som kalles "Startdato-tidsp.".];
                SourceExpr="Starting Date-Time" }

    { 16  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the entry's starting time, which is retrieved from the production order routing.;
                           NOR=Angir postens startklokkeslett, som hentes fra produksjonsordreruten.];
                SourceExpr="Starting Time";
                Visible=FALSE }

    { 14  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the entry's starting date, which is retrieved from the production order routing.;
                           NOR=Angir postens startdato, som hentes fra produksjonsordreruten.];
                SourceExpr="Starting Date";
                Visible=FALSE }

    { 56  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the ending date and the ending time, which are combined in a format called "ending date-time".;
                           NOR=Angir sluttdatoen og sluttidspunktet som er kombinert i et format som kalles "Sluttdato-tidsp.".];
                SourceExpr="Ending Date-Time" }

    { 20  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the entry's ending time, which is retrieved from the production order routing.;
                           NOR=Angir postens sluttklokkeslett, som hentes fra produksjonsordreruten.];
                SourceExpr="Ending Time";
                Visible=FALSE }

    { 18  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the entry's ending date, which is retrieved from the production order routing.;
                           NOR=Angir postens sluttdato, som hentes fra produksjonsordreruten.];
                SourceExpr="Ending Date";
                Visible=FALSE }

    { 1101103000;2;Field  ;
                SourceExpr="Calculation No.";
                Editable=FALSE }

    { 40  ;2   ;Field     ;
                ToolTipML=[ENU=Copies the value in this field from the Scrap Percentage field on the item card when the Item No. field is filled in.;
                           NOR=Kopierer verdien i dette feltet fra feltet Vrakprosent p† varekortet n†r feltet Varenr. fylles ut.];
                SourceExpr="Scrap %";
                Visible=FALSE }

    { 28  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the quantity to be produced if you manually fill in this line.;
                           NOR=Angir antallet som skal produseres hvis du fyller ut denne linjen manuelt.];
                SourceExpr=Quantity }

    { 52  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies how many units of this item have been reserved.;
                           NOR=Angir hvor mange enheter av denne varen som er reservert.];
                SourceExpr="Reserved Quantity";
                Visible=FALSE }

    { 48  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the base unit of measure code for the item.;
                           NOR=Angir lagerenhetskoden for varen.];
                SourceExpr="Unit of Measure Code" }

    { 30  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies how much of the quantity on this line has been produced.;
                           NOR=Angir hvor mye av antallet p† linjen som har blitt produsert.];
                SourceExpr="Finished Quantity" }

    { 32  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the difference between the finished and planned quantities, or zero if the finished quantity is greater than the remaining quantity.;
                           NOR=Angir avviket mellom ferdig antall og planlagt antall, eller null hvis ferdig antall er st›rre enn restantall.];
                SourceExpr="Remaining Quantity" }

    { 34  ;2   ;Field     ;
                ToolTipML=[ENU=Calculates the unit cost, based on the cost of the components in the production order component list, and the routing, if the costing method is not standard.;
                           NOR=Beregner enhetskosten, basert p† kosten for komponenter i listen over produksjonsordrekomponenter, og ruten, hvis kostmetoden ikke er standard.];
                SourceExpr="Unit Cost" }

    { 36  ;2   ;Field     ;
                ToolTipML=[ENU=Calculates the amount by multiplying the Unit Cost by the Quantity.;
                           NOR=Beregner bel›pet ved † multiplisere enhetskosten med antallet.];
                SourceExpr="Cost Amount" }

    { 12  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a dimension value code for a dimension.;
                           NOR=Angir en dimensjonsverdikode for en dimensjon.];
                SourceExpr="Shortcut Dimension 1 Code";
                Visible=FALSE }

    { 22  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a dimension value code for a dimension.;
                           NOR=Angir en dimensjonsverdikode for en dimensjon.];
                SourceExpr="Shortcut Dimension 2 Code";
                Visible=FALSE }

    { 300 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[3];
                CaptionClass='1,2,3';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(3),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(3,ShortcutDimCode[3]);
                           END;
                            }

    { 302 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[4];
                CaptionClass='1,2,4';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(4),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(4,ShortcutDimCode[4]);
                           END;
                            }

    { 304 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[5];
                CaptionClass='1,2,5';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(5),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(5,ShortcutDimCode[5]);
                           END;
                            }

    { 306 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[6];
                CaptionClass='1,2,6';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(6),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(6,ShortcutDimCode[6]);
                           END;
                            }

    { 308 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[7];
                CaptionClass='1,2,7';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(7),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(7,ShortcutDimCode[7]);
                           END;
                            }

    { 310 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[8];
                CaptionClass='1,2,8';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(8),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(8,ShortcutDimCode[8]);
                           END;
                            }

  }
  CODE
  {
    VAR
      ItemAvailFormsMgt@1000 : Codeunit 353;
      ShortcutDimCode@1001 : ARRAY [8] OF Code[20];
      DescriptionIndent@19057867 : Integer INDATASET;

    LOCAL PROCEDURE ShowComponents@1();
    VAR
      ProdOrderComp@1000 : Record 5407;
    BEGIN
      ProdOrderComp.SETRANGE(Status,Status);
      ProdOrderComp.SETRANGE("Prod. Order No.","Prod. Order No.");
      ProdOrderComp.SETRANGE("Prod. Order Line No.","Line No.");

      PAGE.RUN(PAGE::"Prod. Order Components",ProdOrderComp);
    END;

    PROCEDURE ShowTracking@4();
    VAR
      TrackingForm@1000 : Page 99000822;
    BEGIN
      TrackingForm.SetProdOrderLine(Rec);
      TrackingForm.RUNMODAL;
    END;

    LOCAL PROCEDURE ItemAvailability@8(AvailabilityType@1000 : Option);
    BEGIN
      ItemAvailFormsMgt.ShowItemAvailFromProdOrderLine(Rec,AvailabilityType);
    END;

    LOCAL PROCEDURE ShowReservationEntries@9();
    BEGIN
      ShowReservationEntries(TRUE);
    END;

    LOCAL PROCEDURE ShowProductionJournal@7();
    VAR
      ProdOrder@1000 : Record 5405;
      ProductionJrnlMgt@1001 : Codeunit 5510;
    BEGIN
      CurrPage.SAVERECORD;

      ProdOrder.GET(Status,"Prod. Order No.");

      CLEAR(ProductionJrnlMgt);
      ProductionJrnlMgt.Handling(ProdOrder,"Line No.");
    END;

    PROCEDURE UpdateForm@6(SetSaveRecord@1000 : Boolean);
    BEGIN
      CurrPage.UPDATE(SetSaveRecord);
    END;

    LOCAL PROCEDURE DescriptionOnFormat@19023855();
    BEGIN
      DescriptionIndent := "Planning Level Code";
    END;

    PROCEDURE PageShowReservation@16();
    BEGIN
      CurrPage.SAVERECORD;
      ShowReservation;
    END;

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 05.09.17 JAL Item Calculation (Kalkyle)
                       New field "Calulation No."
    }
    END.
  }
}

OBJECT Page 99000868 Finished Prod. Order Lines
{
  OBJECT-PROPERTIES
  {
    Date=05.09.17;
    Time=16.15.02;
    Modified=Yes;
    Version List=NAVW110.00,ICA2.01;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Lines;
               NOR=Linjer];
    LinksAllowed=No;
    SourceTable=Table5406;
    SourceTableView=WHERE(Status=CONST(Finished));
    PageType=ListPart;
    OnAfterGetRecord=BEGIN
                       DescriptionIndent := 0;
                       DescriptionOnFormat;
                     END;

    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1907935204;1 ;ActionGroup;
                      CaptionML=[ENU=&Line;
                                 NOR=&Linje];
                      Image=Line }
      { 1901288104;2 ;Action    ;
                      AccessByPermission=TableData 348=R;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 NOR=Dimensjoner];
                      ToolTipML=[ENU=View or edit dimensions, such as area, project, or department, that you can assign to sales and purchase documents to distribute costs and analyze transaction history.;
                                 NOR=Vis eller rediger dimensjoner, for eksempel omr†de, prosjekt eller avdeling, som du kan tilordne til salgs- og kj›psdokumenter for † distribuere kostnader og analysere transaksjonshistorikk.];
                      Image=Dimensions;
                      OnAction=BEGIN
                                 ShowDimensions;
                               END;
                                }
      { 1903098604;2 ;Action    ;
                      CaptionML=[ENU=Ro&uting;
                                 NOR=R&ute];
                      Image=Route;
                      OnAction=BEGIN
                                 ShowRouting;
                               END;
                                }
      { 1901991404;2 ;Action    ;
                      CaptionML=[ENU=Components;
                                 NOR=Komponenter];
                      Image=Components;
                      OnAction=BEGIN
                                 ShowComponents;
                               END;
                                }
      { 1905987604;2 ;Action    ;
                      ShortCutKey=Shift+Ctrl+I;
                      CaptionML=[ENU=Item &Tracking Lines;
                                 NOR=Vare&sporingslinjer];
                      Image=ItemTrackingLines;
                      OnAction=BEGIN
                                 OpenItemTrackingLines;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                IndentationColumnName=DescriptionIndent;
                IndentationControls=Description;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the item that is to be produced.;
                           NOR=Angir nummeret for varen som skal produseres.];
                SourceExpr="Item No." }

    { 4   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a code if you have set up variant codes in the Item Variants window.;
                           NOR=Angir en kode hvis du har definert variantkoder i vinduet Varevarianter.];
                SourceExpr="Variant Code";
                Visible=FALSE }

    { 8   ;2   ;Field     ;
                ToolTipML=[ENU=Copies the date in this field from the corresponding field on the production order header.;
                           NOR=Kopierer datoen i dette feltet fra tilh›rende felt i produksjonsordrehodet.];
                SourceExpr="Due Date" }

    { 6   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the value of the Description field on the item card. If you enter a variant code, the variant description is copied to this field instead.;
                           NOR=Angir verdien i feltet Beskrivelse p† varekortet. Hvis du angir en variantkode, kopieres variantbeskrivelsen i stedet.];
                SourceExpr=Description }

    { 10  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies an additional description.;
                           NOR=Angir en tilleggsbeskrivelse.];
                SourceExpr="Description 2";
                Visible=FALSE }

    { 46  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the production BOM that is the basis for creating the Prod. Order Component list for this line.;
                           NOR=Angir nummeret p† produksjonsstykklisten som er grunnlaget for † opprette listen Prod.ordrekomponent for denne linjen.];
                SourceExpr="Production BOM No.";
                Visible=FALSE }

    { 44  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the routing used as the basis for creating the production order routing for this line.;
                           NOR=Angir nummeret p† ruten som brukes for † opprette produksjonsordrerute for denne linjen.];
                SourceExpr="Routing No.";
                Visible=FALSE }

    { 42  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the version number of the routing.;
                           NOR=Angir versjonsnummeret for ruten.];
                SourceExpr="Routing Version Code";
                Visible=FALSE }

    { 38  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the version code of the production BOM.;
                           NOR=Angir versjonskoden for produksjonsstykklisten.];
                SourceExpr="Production BOM Version Code";
                Visible=FALSE }

    { 24  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the location code, if the produced items should be stored in a specific location.;
                           NOR=Angir lokasjonskoden, hvis de produserte varene blir lagret p† en bestemt lokasjon.];
                SourceExpr="Location Code";
                Visible=FALSE }

    { 26  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the bin that the produced item is posted to as output, and from where it can be taken to storage or cross-docked.;
                           NOR=Angir hyllen som den produserte varen er postert til som avgang, og hvor den kan tas fra til lager eller kryssoverf›ring.];
                SourceExpr="Bin Code";
                Visible=FALSE }

    { 54  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the starting date and the starting time, which are combined in a format called "starting date-time".;
                           NOR=Angir startdatoen og starttidspunktet som er kombinert i et format som kalles "Startdato-tidsp.".];
                SourceExpr="Starting Date-Time" }

    { 16  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the entry's starting time, which is retrieved from the production order routing.;
                           NOR=Angir postens startklokkeslett, som hentes fra produksjonsordreruten.];
                SourceExpr="Starting Time";
                Visible=FALSE }

    { 14  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the entry's starting date, which is retrieved from the production order routing.;
                           NOR=Angir postens startdato, som hentes fra produksjonsordreruten.];
                SourceExpr="Starting Date";
                Visible=FALSE }

    { 56  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the ending date and the ending time, which are combined in a format called "ending date-time".;
                           NOR=Angir sluttdatoen og sluttidspunktet som er kombinert i et format som kalles "Sluttdato-tidsp.".];
                SourceExpr="Ending Date-Time" }

    { 20  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the entry's ending time, which is retrieved from the production order routing.;
                           NOR=Angir postens sluttklokkeslett, som hentes fra produksjonsordreruten.];
                SourceExpr="Ending Time";
                Visible=FALSE }

    { 18  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the entry's ending date, which is retrieved from the production order routing.;
                           NOR=Angir postens sluttdato, som hentes fra produksjonsordreruten.];
                SourceExpr="Ending Date";
                Visible=FALSE }

    { 1101103001;2;Field  ;
                SourceExpr="Calculation No.";
                Editable=FALSE }

    { 40  ;2   ;Field     ;
                ToolTipML=[ENU=Copies the value in this field from the Scrap Percentage field on the item card when the Item No. field is filled in.;
                           NOR=Kopierer verdien i dette feltet fra feltet Vrakprosent p† varekortet n†r feltet Varenr. fylles ut.];
                SourceExpr="Scrap %";
                Visible=FALSE }

    { 28  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the quantity to be produced if you manually fill in this line.;
                           NOR=Angir antallet som skal produseres hvis du fyller ut denne linjen manuelt.];
                SourceExpr=Quantity }

    { 48  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the base unit of measure code for the item.;
                           NOR=Angir lagerenhetskoden for varen.];
                SourceExpr="Unit of Measure Code" }

    { 30  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies how much of the quantity on this line has been produced.;
                           NOR=Angir hvor mye av antallet p† linjen som har blitt produsert.];
                SourceExpr="Finished Quantity" }

    { 34  ;2   ;Field     ;
                ToolTipML=[ENU=Calculates the unit cost, based on the cost of the components in the production order component list, and the routing, if the costing method is not standard.;
                           NOR=Beregner enhetskosten, basert p† kosten for komponenter i listen over produksjonsordrekomponenter, og ruten, hvis kostmetoden ikke er standard.];
                SourceExpr="Unit Cost" }

    { 36  ;2   ;Field     ;
                ToolTipML=[ENU=Calculates the amount by multiplying the Unit Cost by the Quantity.;
                           NOR=Beregner bel›pet ved † multiplisere enhetskosten med antallet.];
                SourceExpr="Cost Amount" }

    { 12  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a dimension value code for a dimension.;
                           NOR=Angir en dimensjonsverdikode for en dimensjon.];
                SourceExpr="Shortcut Dimension 1 Code";
                Visible=FALSE }

    { 22  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a dimension value code for a dimension.;
                           NOR=Angir en dimensjonsverdikode for en dimensjon.];
                SourceExpr="Shortcut Dimension 2 Code";
                Visible=FALSE }

  }
  CODE
  {
    VAR
      DescriptionIndent@19057867 : Integer INDATASET;

    LOCAL PROCEDURE ShowComponents@1();
    VAR
      ProdOrderComp@1000 : Record 5407;
    BEGIN
      ProdOrderComp.SETRANGE(Status,Status);
      ProdOrderComp.SETRANGE("Prod. Order No.","Prod. Order No.");
      ProdOrderComp.SETRANGE("Prod. Order Line No.","Line No.");

      PAGE.RUN(PAGE::"Prod. Order Components",ProdOrderComp);
    END;

    LOCAL PROCEDURE ShowRouting@2();
    VAR
      ProdOrderRtngLine@1000 : Record 5409;
    BEGIN
      ProdOrderRtngLine.SETRANGE(Status,Status);
      ProdOrderRtngLine.SETRANGE("Prod. Order No.","Prod. Order No.");
      ProdOrderRtngLine.SETRANGE("Routing Reference No.","Routing Reference No.");
      ProdOrderRtngLine.SETRANGE("Routing No.","Routing No.");

      PAGE.RUN(PAGE::"Prod. Order Routing",ProdOrderRtngLine);
    END;

    LOCAL PROCEDURE OpenItemTrackingLines@6500();
    BEGIN
      OpenItemTrackingLines;
    END;

    LOCAL PROCEDURE DescriptionOnFormat@19023855();
    BEGIN
      DescriptionIndent := "Planning Level Code";
    END;

    BEGIN
    {
      +---------------------------------------------+
      | Incadea Norge AS                            |
      +---------------------------------------------+
      No. Date     Id  Description
      01. 05.09.17 JAL Item Calculation (Kalkyle)
                       New field "Calulation No."
    }
    END.
  }
}

